!(function (a, b) {
  a(function () {
    "use strict";
    function a(a, b) {
      return null != a && null != b && a.toLowerCase() === b.toLowerCase();
    }
    function c(a, b) {
      var c,
        d,
        e = a.length;
      if (!e || !b) return !1;
      for (c = b.toLowerCase(), d = 0; d < e; ++d) if (c === a[d].toLowerCase()) return !0;
      return !1;
    }
    function d(a) {
      for (var b in a) i.call(a, b) && (a[b] = new RegExp(a[b], "i"));
    }
    function e(a) {
      return (a || "").substr(0, 500);
    }
    function f(a, b) {
      (this.ua = e(a)), (this._cache = {}), (this.maxPhoneWidth = b || 600);
    }
    var g = {};
    (g.mobileDetectRules = {
      phones: {
        iPhone: "\\biPhone\\b|\\biPod\\b",
        BlackBerry:
          "BlackBerry|\\bBB10\\b|rim[0-9]+|\\b(BBA100|BBB100|BBD100|BBE100|BBF100|STH100)\\b-[0-9]+",
        Pixel: "; \\bPixel\\b",
        HTC: "HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\\bEVO\\b|T-Mobile G1|Z520m|Android [0-9.]+; Pixel",
        Nexus:
          "Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 5X|Nexus 6",
        Dell: "Dell[;]? (Streak|Aero|Venue|Venue Pro|Flash|Smoke|Mini 3iX)|XCD28|XCD35|\\b001DL\\b|\\b101DL\\b|\\bGS01\\b",
        Motorola:
          "Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b|XT1068|XT1092|XT1052",
        Samsung:
          "\\bSamsung\\b|SM-G950F|SM-G955F|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|GT-N7105|SCH-I535|SM-N900A|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205|SM-G9350|SM-J120F|SM-G920F|SM-G920V|SM-G930F|SM-N910C|SM-A310F|GT-I9190|SM-J500FN|SM-G903F|SM-J330F|SM-G610F|SM-G981B|SM-G892A|SM-A530F",
        LG: "\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|MS323|M257)|LM-G710",
        Sony: "SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533|SOV34|601SO|F8332",
        Asus: "Asus.*Galaxy|PadFone.*Mobile",
        Xiaomi:
          "^(?!.*\\bx11\\b).*xiaomi.*$|POCOPHONE F1|MI 8|Redmi Note 9S|Redmi Note 5A Prime|N2G47H|M2001J2G|M2001J2I|M1805E10A|M2004J11G|M1902F1G|M2002J9G|M2004J19G|M2003J6A1G",
        NokiaLumia: "Lumia [0-9]{3,4}",
        Micromax:
          "Micromax.*\\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\\b",
        Palm: "PalmSource|Palm",
        Vertu:
          "Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature",
        Pantech:
          "PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|P2000|P7040|P7000|C790",
        Fly: "IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250",
        Wiko: "KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|SUNSET|GOA(?!nna)|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|CINK KING|CINK PEAX|CINK SLIM|SUBLIM",
        iMobile: "i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)",
        SimValley:
          "\\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\\b",
        Wolfgang: "AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q",
        Alcatel: "Alcatel",
        Nintendo: "Nintendo (3DS|Switch)",
        Amoi: "Amoi",
        INQ: "INQ",
        OnePlus: "ONEPLUS",
        GenericPhone:
          "Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|up.link|vodafone|\\bwap\\b|nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser",
      },
      tablets: {
        iPad: "iPad|iPad.*Mobile",
        NexusTablet: "Android.*Nexus[\\s]+(7|9|10)",
        GoogleTablet: "Android.*Pixel C",
        SamsungTablet:
          "SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|SHV-E230S|SHW-M180K|SHW-M180L|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|SM-P601|SM-P605|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T330|SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-T116BU|SM-P550|SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T815|SM-T360|SM-T533|SM-T113|SM-T335|SM-T715|SM-T560|SM-T670|SM-T677|SM-T377|SM-T567|SM-T357T|SM-T555|SM-T561|SM-T713|SM-T719|SM-T813|SM-T819|SM-T580|SM-T355Y?|SM-T280|SM-T817A|SM-T820|SM-W700|SM-P580|SM-T587|SM-P350|SM-P555M|SM-P355M|SM-T113NU|SM-T815Y|SM-T585|SM-T285|SM-T825|SM-W708|SM-T835|SM-T830|SM-T837V|SM-T720|SM-T510|SM-T387V|SM-P610|SM-T290|SM-T515|SM-T590|SM-T595|SM-T725|SM-T817P|SM-P585N0|SM-T395|SM-T295|SM-T865|SM-P610N|SM-P615|SM-T970|SM-T380|SM-T5950|SM-T905|SM-T231|SM-T500|SM-T860",
        Kindle:
          "Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI|KFARWI|KFFOWI|KFGIWI|KFMEWI)\\b|Android.*Silk/[0-9.]+ like Chrome/[0-9.]+ (?!Mobile)",
        SurfaceTablet: "Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)",
        HPTablet:
          "HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10",
        AsusTablet:
          "^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|ME560CG|ME372CG|ME302KL| K010 | K011 | K017 | K01E |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|ME581CL|ME8510C|ME181C|P01Y|PO1MA|P01Z|\\bP027\\b|\\bP024\\b|\\bP00C\\b",
        BlackBerryTablet: "PlayBook|RIM Tablet",
        HTCtablet:
          "HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410",
        MotorolaTablet:
          "xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617",
        NookTablet:
          "Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2",
        AcerTablet:
          "Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b|\\bA3-A20\\b|\\bA3-A30|A3-A40",
        ToshibaTablet:
          "Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO",
        LGTablet: "\\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\\b",
        FujitsuTablet: "Android.*\\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\\b",
        PrestigioTablet:
          "PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|PMT5887|PMT5001|PMT5002",
        LenovoTablet:
          "Lenovo TAB|Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|YT3-850M|YT3-X90L|YT3-X90F|YT3-X90X|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|B8000|B8080)(-|)(FL|F|HV|H|)|TB-X103F|TB-X304X|TB-X304F|TB-X304L|TB-X505F|TB-X505L|TB-X505X|TB-X605F|TB-X605L|TB-8703F|TB-8703X|TB-8703N|TB-8704N|TB-8704F|TB-8704X|TB-8704V|TB-7304F|TB-7304I|TB-7304X|Tab2A7-10F|Tab2A7-20F|TB2-X30L|YT3-X50L|YT3-X50F|YT3-X50M|YT-X705F|YT-X703F|YT-X703L|YT-X705L|YT-X705X|TB2-X30F|TB2-X30L|TB2-X30M|A2107A-F|A2107A-H|TB3-730F|TB3-730M|TB3-730X|TB-7504F|TB-7504X|TB-X704F|TB-X104F|TB3-X70F|TB-X705F|TB-8504F|TB3-X70L|TB3-710F|TB-X704L",
        DellTablet: "Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7",
        YarvikTablet:
          "Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b",
        MedionTablet: "Android.*\\bOYO\\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB",
        ArnovaTablet:
          "97G4|AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2",
        IntensoTablet: "INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004",
        IRUTablet: "M702pro",
        MegafonTablet: "MegaFon V9|\\bZTE V9\\b|Android.*\\bMT7A\\b",
        EbodaTablet: "E-Boda (Supreme|Impresspeed|Izzycomm|Essential)",
        AllViewTablet: "Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)",
        ArchosTablet:
          "\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|c|)(G10| Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b",
        AinolTablet: "NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark",
        NokiaLumiaTablet: "Lumia 2520",
        SonyTablet:
          "Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP641|SGP612|SOT31|SGP771|SGP611|SGP612|SGP712",
        PhilipsTablet:
          "\\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\\b",
        CubeTablet:
          "Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT",
        CobyTablet:
          "MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010",
        MIDTablet:
          "M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733|MID4X10",
        MSITablet:
          "MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b",
        SMiTTablet: "Android.*(\\bMID\\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)",
        RockChipTablet: "Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A",
        FlyTablet: "IQ310|Fly Vision",
        bqTablet:
          "Android.*(bq)?.*\\b(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|Livingstone|Cervantes|Avant|Aquaris ([E|M]10|M8))\\b|Maxwell.*Lite|Maxwell.*Plus",
        HuaweiTablet:
          "MediaPad|MediaPad 7 Youth|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|S7-201|S7-Slim|M2-A01L|BAH-L09|BAH-W09|AGS-L09|CMR-AL19",
        NecTablet: "\\bN-06D|\\bN-08D",
        PantechTablet: "Pantech.*P4100",
        BronchoTablet: "Broncho.*(N701|N708|N802|a710)",
        VersusTablet: "TOUCHPAD.*[78910]|\\bTOUCHTAB\\b",
        ZyncTablet: "z1000|Z99 2G|z930|z990|z909|Z919|z900",
        PositivoTablet: "TB07STA|TB10STA|TB07FTA|TB10FTA",
        NabiTablet: "Android.*\\bNabi",
        KoboTablet: "Kobo Touch|\\bK080\\b|\\bVox\\b Build|\\bArc\\b Build",
        DanewTablet: "DSlide.*\\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\\b",
        TexetTablet:
          "NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|TB-436|TB-416|TB-146SE|TB-126SE",
        PlaystationTablet: "Playstation.*(Portable|Vita)",
        TrekstorTablet:
          "ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab",
        PyleAudioTablet:
          "\\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\\b",
        AdvanTablet:
          "Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b ",
        DanyTechTablet:
          "Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|Genius TAB GII|Genius TAB GIII|Genius Tab S1",
        GalapadTablet: "Android [0-9.]+; [a-z-]+; \\bG1\\b",
        MicromaxTablet: "Funbook|Micromax.*\\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\\b",
        KarbonnTablet: "Android.*\\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\\b",
        AllFineTablet:
          "Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide",
        PROSCANTablet:
          "\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b",
        YONESTablet:
          "BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026",
        ChangJiaTablet:
          "TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|TPC10111|TPC10203|TPC10205|TPC10503",
        GUTablet: "TX-A1301|TX-M9002|Q702|kf026",
        PointOfViewTablet:
          "TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10",
        OvermaxTablet:
          "OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|MagicTab|Stream|TB-08|TB-09)|Qualcore 1027",
        HCLTablet:
          "HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync",
        DPSTablet: "DPS Dream 9|DPS Dual 7",
        VistureTablet: "V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10",
        CrestaTablet:
          "CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989",
        MediatekTablet: "\\bMT8125|MT8389|MT8135|MT8377\\b",
        ConcordeTablet: "Concorde([ ]+)?Tab|ConCorde ReadMan",
        GoCleverTablet:
          "GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|TAB R104|TAB R83.3|TAB A1042",
        ModecomTablet:
          "FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003",
        VoninoTablet:
          "\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b",
        ECSTablet: "V07OT2|TM105A|S10OT1|TR10CS1",
        StorexTablet: "eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab",
        VodafoneTablet: "SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7|VF-1497|VFD 1400",
        EssentielBTablet: "Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2",
        RossMoorTablet: "RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711",
        iMobileTablet: "i-mobile i-note",
        TolinoTablet: "tolino tab [0-9.]+|tolino shine",
        AudioSonicTablet: "\\bC-22Q|T7-QC|T-17B|T-17P\\b",
        AMPETablet: "Android.* A78 ",
        SkkTablet: "Android.* (SKYPAD|PHOENIX|CYCLOPS)",
        TecnoTablet: "TECNO P9|TECNO DP8D",
        JXDTablet:
          "Android.* \\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|P1000|P300|S18|S6600|S9100)\\b",
        iJoyTablet:
          "Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)",
        FX2Tablet: "FX2 PAD7|FX2 PAD10",
        XoroTablet:
          "KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151",
        ViewsonicTablet:
          "ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a",
        VerizonTablet: "QTAQZ3|QTAIR7|QTAQTZ3|QTASUN1|QTASUN2|QTAXIA1",
        OdysTablet:
          "LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\\bXELIO\\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10",
        CaptivaTablet: "CAPTIVA PAD",
        IconbitTablet:
          "NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S",
        TeclastTablet:
          "T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|\\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|\\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|\\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|\\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|\\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|\\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|\\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|\\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi",
        OndaTablet:
          "\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|Vi40)\\b[\\s]+|V10 \\b4G\\b",
        JaytechTablet: "TPC-PA762",
        BlaupunktTablet: "Endeavour 800NG|Endeavour 1010",
        DigmaTablet:
          "\\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\\b",
        EvolioTablet:
          "ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\\bEvotab\\b|\\bNeura\\b",
        LavaTablet: "QPAD E704|\\bIvoryS\\b|E-TAB IVORY|\\bE-TAB\\b",
        AocTablet: "MW0811|MW0812|MW0922|MTK8382|MW1031|MW0831|MW0821|MW0931|MW0712",
        MpmanTablet:
          "MP11 OCTA|MP10 OCTA|MPQC1114|MPQC1004|MPQC994|MPQC974|MPQC973|MPQC804|MPQC784|MPQC780|\\bMPG7\\b|MPDCG75|MPDCG71|MPDC1006|MP101DC|MPDC9000|MPDC905|MPDC706HD|MPDC706|MPDC705|MPDC110|MPDC100|MPDC99|MPDC97|MPDC88|MPDC8|MPDC77|MP709|MID701|MID711|MID170|MPDC703|MPQC1010",
        CelkonTablet:
          "CT695|CT888|CT[\\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\\bCT-1\\b",
        WolderTablet:
          "miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b",
        MediacomTablet:
          "M-MPI10C3G|M-SP10EG|M-SP10EGP|M-SP10HXAH|M-SP7HXAH|M-SP10HXBH|M-SP8HXAH|M-SP8MXA",
        MiTablet: "\\bMI PAD\\b|\\bHM NOTE 1W\\b",
        NibiruTablet: "Nibiru M1|Nibiru Jupiter One",
        NexoTablet:
          "NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI",
        LeaderTablet:
          "TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100",
        UbislateTablet: "UbiSlate[\\s]?7C",
        PocketBookTablet: "Pocketbook",
        KocasoTablet: "\\b(TB-1207)\\b",
        HisenseTablet: "\\b(F5281|E2371)\\b",
        Hudl: "Hudl HT7S3|Hudl 2",
        TelstraTablet: "T-Hub2",
        GenericTablet:
          "Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bTP750\\b|\\bQTAQZ3\\b|WVT101|TM1088|KT107",
      },
      oss: {
        AndroidOS: "Android",
        BlackBerryOS: "blackberry|\\bBB10\\b|rim tablet os",
        PalmOS: "PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino",
        SymbianOS: "Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\\bS60\\b",
        WindowsMobileOS:
          "Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Windows Mobile|Windows Phone [0-9.]+|WCE;",
        WindowsPhoneOS:
          "Windows Phone 10.0|Windows Phone 8.1|Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7|Windows NT 6.[23]; ARM;",
        iOS: "\\biPhone.*Mobile|\\biPod|\\biPad|AppleCoreMedia",
        iPadOS: "CPU OS 13",
        SailfishOS: "Sailfish",
        MeeGoOS: "MeeGo",
        MaemoOS: "Maemo",
        JavaOS: "J2ME/|\\bMIDP\\b|\\bCLDC\\b",
        webOS: "webOS|hpwOS",
        badaOS: "\\bBada\\b",
        BREWOS: "BREW",
      },
      uas: {
        Chrome: "\\bCrMo\\b|CriOS|Android.*Chrome/[.0-9]* (Mobile)?",
        Dolfin: "\\bDolfin\\b",
        Opera: "Opera.*Mini|Opera.*Mobi|Android.*Opera|Mobile.*OPR/[0-9.]+$|Coast/[0-9.]+",
        Skyfire: "Skyfire",
        Edge: "\\bEdgiOS\\b|Mobile Safari/[.0-9]* Edge",
        IE: "IEMobile|MSIEMobile",
        Firefox: "fennec|firefox.*maemo|(Mobile|Tablet).*Firefox|Firefox.*Mobile|FxiOS",
        Bolt: "bolt",
        TeaShark: "teashark",
        Blazer: "Blazer",
        Safari: "Version((?!\\bEdgiOS\\b).)*Mobile.*Safari|Safari.*Mobile|MobileSafari",
        WeChat: "\\bMicroMessenger\\b",
        UCBrowser: "UC.*Browser|UCWEB",
        baiduboxapp: "baiduboxapp",
        baidubrowser: "baidubrowser",
        DiigoBrowser: "DiigoBrowser",
        Mercury: "\\bMercury\\b",
        ObigoBrowser: "Obigo",
        NetFront: "NF-Browser",
        GenericBrowser:
          "NokiaBrowser|OviBrowser|OneBrowser|TwonkyBeamBrowser|SEMC.*Browser|FlyFlow|Minimo|NetFront|Novarra-Vision|MQQBrowser|MicroMessenger",
        PaleMoon: "Android.*PaleMoon|Mobile.*PaleMoon",
      },
      props: {
        Mobile: "Mobile/[VER]",
        Build: "Build/[VER]",
        Version: "Version/[VER]",
        VendorID: "VendorID/[VER]",
        iPad: "iPad.*CPU[a-z ]+[VER]",
        iPhone: "iPhone.*CPU[a-z ]+[VER]",
        iPod: "iPod.*CPU[a-z ]+[VER]",
        Kindle: "Kindle/[VER]",
        Chrome: ["Chrome/[VER]", "CriOS/[VER]", "CrMo/[VER]"],
        Coast: ["Coast/[VER]"],
        Dolfin: "Dolfin/[VER]",
        Firefox: ["Firefox/[VER]", "FxiOS/[VER]"],
        Fennec: "Fennec/[VER]",
        Edge: "Edge/[VER]",
        IE: ["IEMobile/[VER];", "IEMobile [VER]", "MSIE [VER];", "Trident/[0-9.]+;.*rv:[VER]"],
        NetFront: "NetFront/[VER]",
        NokiaBrowser: "NokiaBrowser/[VER]",
        Opera: [" OPR/[VER]", "Opera Mini/[VER]", "Version/[VER]"],
        "Opera Mini": "Opera Mini/[VER]",
        "Opera Mobi": "Version/[VER]",
        UCBrowser: ["UCWEB[VER]", "UC.*Browser/[VER]"],
        MQQBrowser: "MQQBrowser/[VER]",
        MicroMessenger: "MicroMessenger/[VER]",
        baiduboxapp: "baiduboxapp/[VER]",
        baidubrowser: "baidubrowser/[VER]",
        SamsungBrowser: "SamsungBrowser/[VER]",
        Iron: "Iron/[VER]",
        Safari: ["Version/[VER]", "Safari/[VER]"],
        Skyfire: "Skyfire/[VER]",
        Tizen: "Tizen/[VER]",
        Webkit: "webkit[ /][VER]",
        PaleMoon: "PaleMoon/[VER]",
        SailfishBrowser: "SailfishBrowser/[VER]",
        Gecko: "Gecko/[VER]",
        Trident: "Trident/[VER]",
        Presto: "Presto/[VER]",
        Goanna: "Goanna/[VER]",
        iOS: " \\bi?OS\\b [VER][ ;]{1}",
        Android: "Android [VER]",
        Sailfish: "Sailfish [VER]",
        BlackBerry: ["BlackBerry[\\w]+/[VER]", "BlackBerry.*Version/[VER]", "Version/[VER]"],
        BREW: "BREW [VER]",
        Java: "Java/[VER]",
        "Windows Phone OS": ["Windows Phone OS [VER]", "Windows Phone [VER]"],
        "Windows Phone": "Windows Phone [VER]",
        "Windows CE": "Windows CE/[VER]",
        "Windows NT": "Windows NT [VER]",
        Symbian: ["SymbianOS/[VER]", "Symbian/[VER]"],
        webOS: ["webOS/[VER]", "hpwOS/[VER];"],
      },
      utils: {
        Bot: "Googlebot|facebookexternalhit|Google-AMPHTML|s~amp-validator|AdsBot-Google|Google Keyword Suggestion|Facebot|YandexBot|YandexMobileBot|bingbot|ia_archiver|AhrefsBot|Ezooms|GSLFbot|WBSearchBot|Twitterbot|TweetmemeBot|Twikle|PaperLiBot|Wotbox|UnwindFetchor|Exabot|MJ12bot|YandexImages|TurnitinBot|Pingdom|contentkingapp|AspiegelBot",
        MobileBot: "Googlebot-Mobile|AdsBot-Google-Mobile|YahooSeeker/M1A1-R2D2",
        DesktopMode: "WPDesktop",
        TV: "SonyDTV|HbbTV",
        WebKit: "(webkit)[ /]([\\w.]+)",
        Console: "\\b(Nintendo|Nintendo WiiU|Nintendo 3DS|Nintendo Switch|PLAYSTATION|Xbox)\\b",
        Watch: "SM-V700",
      },
    }),
      (g.detectMobileBrowsers = {
        fullPattern:
          /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,
        shortPattern:
          /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
        tabletPattern: /android|ipad|playbook|silk/i,
      });
    var h,
      i = Object.prototype.hasOwnProperty;
    return (
      (g.FALLBACK_PHONE = "UnknownPhone"),
      (g.FALLBACK_TABLET = "UnknownTablet"),
      (g.FALLBACK_MOBILE = "UnknownMobile"),
      (h =
        "isArray" in Array
          ? Array.isArray
          : function (a) {
              return "[object Array]" === Object.prototype.toString.call(a);
            }),
      (function () {
        var a,
          b,
          c,
          e,
          f,
          j,
          k = g.mobileDetectRules;
        for (a in k.props)
          if (i.call(k.props, a)) {
            for (b = k.props[a], h(b) || (b = [b]), f = b.length, e = 0; e < f; ++e)
              (c = b[e]),
                (j = c.indexOf("[VER]")),
                j >= 0 && (c = c.substring(0, j) + "([\\w._\\+]+)" + c.substring(j + 5)),
                (b[e] = new RegExp(c, "i"));
            k.props[a] = b;
          }
        d(k.oss),
          d(k.phones),
          d(k.tablets),
          d(k.uas),
          d(k.utils),
          (k.oss0 = {
            WindowsPhoneOS: k.oss.WindowsPhoneOS,
            WindowsMobileOS: k.oss.WindowsMobileOS,
          });
      })(),
      (g.findMatch = function (a, b) {
        for (var c in a) if (i.call(a, c) && a[c].test(b)) return c;
        return null;
      }),
      (g.findMatches = function (a, b) {
        var c = [];
        for (var d in a) i.call(a, d) && a[d].test(b) && c.push(d);
        return c;
      }),
      (g.getVersionStr = function (a, b) {
        var c,
          d,
          e,
          f,
          h = g.mobileDetectRules.props;
        if (i.call(h, a))
          for (c = h[a], e = c.length, d = 0; d < e; ++d)
            if (((f = c[d].exec(b)), null !== f)) return f[1];
        return null;
      }),
      (g.getVersion = function (a, b) {
        var c = g.getVersionStr(a, b);
        return c ? g.prepareVersionNo(c) : NaN;
      }),
      (g.prepareVersionNo = function (a) {
        var b;
        return (
          (b = a.split(/[a-z._ \/\-]/i)),
          1 === b.length && (a = b[0]),
          b.length > 1 && ((a = b[0] + "."), b.shift(), (a += b.join(""))),
          Number(a)
        );
      }),
      (g.isMobileFallback = function (a) {
        return (
          g.detectMobileBrowsers.fullPattern.test(a) ||
          g.detectMobileBrowsers.shortPattern.test(a.substr(0, 4))
        );
      }),
      (g.isTabletFallback = function (a) {
        return g.detectMobileBrowsers.tabletPattern.test(a);
      }),
      (g.prepareDetectionCache = function (a, c, d) {
        if (a.mobile === b) {
          var e, h, i;
          return (h = g.findMatch(g.mobileDetectRules.tablets, c))
            ? ((a.mobile = a.tablet = h), void (a.phone = null))
            : (e = g.findMatch(g.mobileDetectRules.phones, c))
            ? ((a.mobile = a.phone = e), void (a.tablet = null))
            : void (g.isMobileFallback(c)
                ? ((i = f.isPhoneSized(d)),
                  i === b
                    ? ((a.mobile = g.FALLBACK_MOBILE), (a.tablet = a.phone = null))
                    : i
                    ? ((a.mobile = a.phone = g.FALLBACK_PHONE), (a.tablet = null))
                    : ((a.mobile = a.tablet = g.FALLBACK_TABLET), (a.phone = null)))
                : g.isTabletFallback(c)
                ? ((a.mobile = a.tablet = g.FALLBACK_TABLET), (a.phone = null))
                : (a.mobile = a.tablet = a.phone = null));
        }
      }),
      (g.mobileGrade = function (a) {
        var b = null !== a.mobile();
        return (a.os("iOS") && a.version("iPad") >= 4.3) ||
          (a.os("iOS") && a.version("iPhone") >= 3.1) ||
          (a.os("iOS") && a.version("iPod") >= 3.1) ||
          (a.version("Android") > 2.1 && a.is("Webkit")) ||
          a.version("Windows Phone OS") >= 7 ||
          (a.is("BlackBerry") && a.version("BlackBerry") >= 6) ||
          a.match("Playbook.*Tablet") ||
          (a.version("webOS") >= 1.4 && a.match("Palm|Pre|Pixi")) ||
          a.match("hp.*TouchPad") ||
          (a.is("Firefox") && a.version("Firefox") >= 12) ||
          (a.is("Chrome") && a.is("AndroidOS") && a.version("Android") >= 4) ||
          (a.is("Skyfire") &&
            a.version("Skyfire") >= 4.1 &&
            a.is("AndroidOS") &&
            a.version("Android") >= 2.3) ||
          (a.is("Opera") && a.version("Opera Mobi") > 11 && a.is("AndroidOS")) ||
          a.is("MeeGoOS") ||
          a.is("Tizen") ||
          (a.is("Dolfin") && a.version("Bada") >= 2) ||
          ((a.is("UC Browser") || a.is("Dolfin")) && a.version("Android") >= 2.3) ||
          a.match("Kindle Fire") ||
          (a.is("Kindle") && a.version("Kindle") >= 3) ||
          (a.is("AndroidOS") && a.is("NookTablet")) ||
          (a.version("Chrome") >= 11 && !b) ||
          (a.version("Safari") >= 5 && !b) ||
          (a.version("Firefox") >= 4 && !b) ||
          (a.version("MSIE") >= 7 && !b) ||
          (a.version("Opera") >= 10 && !b)
          ? "A"
          : (a.os("iOS") && a.version("iPad") < 4.3) ||
            (a.os("iOS") && a.version("iPhone") < 3.1) ||
            (a.os("iOS") && a.version("iPod") < 3.1) ||
            (a.is("Blackberry") && a.version("BlackBerry") >= 5 && a.version("BlackBerry") < 6) ||
            (a.version("Opera Mini") >= 5 &&
              a.version("Opera Mini") <= 6.5 &&
              (a.version("Android") >= 2.3 || a.is("iOS"))) ||
            a.match("NokiaN8|NokiaC7|N97.*Series60|Symbian/3") ||
            (a.version("Opera Mobi") >= 11 && a.is("SymbianOS"))
          ? "B"
          : (a.version("BlackBerry") < 5 ||
              a.match("MSIEMobile|Windows CE.*Mobile") ||
              a.version("Windows Mobile") <= 5.2,
            "C");
      }),
      (g.detectOS = function (a) {
        return g.findMatch(g.mobileDetectRules.oss0, a) || g.findMatch(g.mobileDetectRules.oss, a);
      }),
      (g.getDeviceSmallerSide = function () {
        return window.screen.width < window.screen.height
          ? window.screen.width
          : window.screen.height;
      }),
      (f.prototype = {
        constructor: f,
        mobile: function () {
          return (
            g.prepareDetectionCache(this._cache, this.ua, this.maxPhoneWidth), this._cache.mobile
          );
        },
        phone: function () {
          return (
            g.prepareDetectionCache(this._cache, this.ua, this.maxPhoneWidth), this._cache.phone
          );
        },
        tablet: function () {
          return (
            g.prepareDetectionCache(this._cache, this.ua, this.maxPhoneWidth), this._cache.tablet
          );
        },
        userAgent: function () {
          return (
            this._cache.userAgent === b &&
              (this._cache.userAgent = g.findMatch(g.mobileDetectRules.uas, this.ua)),
            this._cache.userAgent
          );
        },
        userAgents: function () {
          return (
            this._cache.userAgents === b &&
              (this._cache.userAgents = g.findMatches(g.mobileDetectRules.uas, this.ua)),
            this._cache.userAgents
          );
        },
        os: function () {
          return this._cache.os === b && (this._cache.os = g.detectOS(this.ua)), this._cache.os;
        },
        version: function (a) {
          return g.getVersion(a, this.ua);
        },
        versionStr: function (a) {
          return g.getVersionStr(a, this.ua);
        },
        is: function (b) {
          return (
            c(this.userAgents(), b) ||
            a(b, this.os()) ||
            a(b, this.phone()) ||
            a(b, this.tablet()) ||
            c(g.findMatches(g.mobileDetectRules.utils, this.ua), b)
          );
        },
        match: function (a) {
          return a instanceof RegExp || (a = new RegExp(a, "i")), a.test(this.ua);
        },
        isPhoneSized: function (a) {
          return f.isPhoneSized(a || this.maxPhoneWidth);
        },
        mobileGrade: function () {
          return (
            this._cache.grade === b && (this._cache.grade = g.mobileGrade(this)), this._cache.grade
          );
        },
      }),
      "undefined" != typeof window && window.screen
        ? (f.isPhoneSized = function (a) {
            return a < 0 ? b : g.getDeviceSmallerSide() <= a;
          })
        : (f.isPhoneSized = function () {}),
      (f._impl = g),
      (f.version = "1.4.5 2021-03-13"),
      f
    );
  });
})(
  (function (a) {
    if ("undefined" != typeof module && module.exports)
      return function (a) {
        module.exports = a();
      };
    if ("function" == typeof define && define.amd) return define;
    if ("undefined" != typeof window)
      return function (a) {
        window.MobileDetect = a();
      };
    throw new Error("unknown environment");
  })()
); /*! howler.js v2.1.3 | (c) 2013-2019, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
!(function () {
  "use strict";
  var e = function () {
    this.init();
  };
  e.prototype = {
    init: function () {
      var e = this || n;
      return (
        (e._counter = 1e3),
        (e._html5AudioPool = []),
        (e.html5PoolSize = 10),
        (e._codecs = {}),
        (e._howls = []),
        (e._muted = !1),
        (e._volume = 1),
        (e._canPlayEvent = "canplaythrough"),
        (e._navigator = "undefined" != typeof window && window.navigator ? window.navigator : null),
        (e.masterGain = null),
        (e.noAudio = !1),
        (e.usingWebAudio = !0),
        (e.autoSuspend = !0),
        (e.ctx = null),
        (e.autoUnlock = !0),
        e._setup(),
        e
      );
    },
    volume: function (e) {
      var o = this || n;
      if (((e = parseFloat(e)), o.ctx || _(), void 0 !== e && e >= 0 && e <= 1)) {
        if (((o._volume = e), o._muted)) return o;
        o.usingWebAudio && o.masterGain.gain.setValueAtTime(e, n.ctx.currentTime);
        for (var t = 0; t < o._howls.length; t++)
          if (!o._howls[t]._webAudio)
            for (var r = o._howls[t]._getSoundIds(), a = 0; a < r.length; a++) {
              var u = o._howls[t]._soundById(r[a]);
              u && u._node && (u._node.volume = u._volume * e);
            }
        return o;
      }
      return o._volume;
    },
    mute: function (e) {
      var o = this || n;
      o.ctx || _(),
        (o._muted = e),
        o.usingWebAudio && o.masterGain.gain.setValueAtTime(e ? 0 : o._volume, n.ctx.currentTime);
      for (var t = 0; t < o._howls.length; t++)
        if (!o._howls[t]._webAudio)
          for (var r = o._howls[t]._getSoundIds(), a = 0; a < r.length; a++) {
            var u = o._howls[t]._soundById(r[a]);
            u && u._node && (u._node.muted = !!e || u._muted);
          }
      return o;
    },
    unload: function () {
      for (var e = this || n, o = e._howls.length - 1; o >= 0; o--) e._howls[o].unload();
      return (
        e.usingWebAudio && e.ctx && void 0 !== e.ctx.close && (e.ctx.close(), (e.ctx = null), _()),
        e
      );
    },
    codecs: function (e) {
      return (this || n)._codecs[e.replace(/^x-/, "")];
    },
    _setup: function () {
      var e = this || n;
      if (
        ((e.state = e.ctx ? e.ctx.state || "suspended" : "suspended"),
        e._autoSuspend(),
        !e.usingWebAudio)
      )
        if ("undefined" != typeof Audio)
          try {
            var o = new Audio();
            void 0 === o.oncanplaythrough && (e._canPlayEvent = "canplay");
          } catch (n) {
            e.noAudio = !0;
          }
        else e.noAudio = !0;
      try {
        var o = new Audio();
        o.muted && (e.noAudio = !0);
      } catch (e) {}
      return e.noAudio || e._setupCodecs(), e;
    },
    _setupCodecs: function () {
      var e = this || n,
        o = null;
      try {
        o = "undefined" != typeof Audio ? new Audio() : null;
      } catch (n) {
        return e;
      }
      if (!o || "function" != typeof o.canPlayType) return e;
      var t = o.canPlayType("audio/mpeg;").replace(/^no$/, ""),
        r = e._navigator && e._navigator.userAgent.match(/OPR\/([0-6].)/g),
        a = r && parseInt(r[0].split("/")[1], 10) < 33;
      return (
        (e._codecs = {
          mp3: !(a || (!t && !o.canPlayType("audio/mp3;").replace(/^no$/, ""))),
          mpeg: !!t,
          opus: !!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/, ""),
          ogg: !!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, ""),
          oga: !!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, ""),
          wav: !!o.canPlayType('audio/wav; codecs="1"').replace(/^no$/, ""),
          aac: !!o.canPlayType("audio/aac;").replace(/^no$/, ""),
          caf: !!o.canPlayType("audio/x-caf;").replace(/^no$/, ""),
          m4a: !!(
            o.canPlayType("audio/x-m4a;") ||
            o.canPlayType("audio/m4a;") ||
            o.canPlayType("audio/aac;")
          ).replace(/^no$/, ""),
          mp4: !!(
            o.canPlayType("audio/x-mp4;") ||
            o.canPlayType("audio/mp4;") ||
            o.canPlayType("audio/aac;")
          ).replace(/^no$/, ""),
          weba: !!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, ""),
          webm: !!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, ""),
          dolby: !!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/, ""),
          flac: !!(o.canPlayType("audio/x-flac;") || o.canPlayType("audio/flac;")).replace(
            /^no$/,
            ""
          ),
        }),
        e
      );
    },
    _unlockAudio: function () {
      var e = this || n;
      if (!e._audioUnlocked && e.ctx) {
        (e._audioUnlocked = !1),
          (e.autoUnlock = !1),
          e._mobileUnloaded || 44100 === e.ctx.sampleRate || ((e._mobileUnloaded = !0), e.unload()),
          (e._scratchBuffer = e.ctx.createBuffer(1, 1, 22050));
        var o = function (n) {
          for (var t = 0; t < e.html5PoolSize; t++)
            try {
              var r = new Audio();
              (r._unlocked = !0), e._releaseHtml5Audio(r);
            } catch (n) {
              e.noAudio = !0;
            }
          for (var t = 0; t < e._howls.length; t++)
            if (!e._howls[t]._webAudio)
              for (var a = e._howls[t]._getSoundIds(), u = 0; u < a.length; u++) {
                var i = e._howls[t]._soundById(a[u]);
                i && i._node && !i._node._unlocked && ((i._node._unlocked = !0), i._node.load());
              }
          e._autoResume();
          var d = e.ctx.createBufferSource();
          (d.buffer = e._scratchBuffer),
            d.connect(e.ctx.destination),
            void 0 === d.start ? d.noteOn(0) : d.start(0),
            "function" == typeof e.ctx.resume && e.ctx.resume(),
            (d.onended = function () {
              d.disconnect(0),
                (e._audioUnlocked = !0),
                document.removeEventListener("touchstart", o, !0),
                document.removeEventListener("touchend", o, !0),
                document.removeEventListener("click", o, !0);
              for (var n = 0; n < e._howls.length; n++) e._howls[n]._emit("unlock");
            });
        };
        return (
          document.addEventListener("touchstart", o, !0),
          document.addEventListener("touchend", o, !0),
          document.addEventListener("click", o, !0),
          e
        );
      }
    },
    _obtainHtml5Audio: function () {
      var e = this || n;
      if (e._html5AudioPool.length) return e._html5AudioPool.pop();
      var o = new Audio().play();
      return (
        o &&
          "undefined" != typeof Promise &&
          (o instanceof Promise || "function" == typeof o.then) &&
          o.catch(function () {
            console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.");
          }),
        new Audio()
      );
    },
    _releaseHtml5Audio: function (e) {
      var o = this || n;
      return e._unlocked && o._html5AudioPool.push(e), o;
    },
    _autoSuspend: function () {
      var e = this;
      if (e.autoSuspend && e.ctx && void 0 !== e.ctx.suspend && n.usingWebAudio) {
        for (var o = 0; o < e._howls.length; o++)
          if (e._howls[o]._webAudio)
            for (var t = 0; t < e._howls[o]._sounds.length; t++)
              if (!e._howls[o]._sounds[t]._paused) return e;
        return (
          e._suspendTimer && clearTimeout(e._suspendTimer),
          (e._suspendTimer = setTimeout(function () {
            e.autoSuspend &&
              ((e._suspendTimer = null),
              (e.state = "suspending"),
              e.ctx.suspend().then(function () {
                (e.state = "suspended"),
                  e._resumeAfterSuspend && (delete e._resumeAfterSuspend, e._autoResume());
              }));
          }, 3e4)),
          e
        );
      }
    },
    _autoResume: function () {
      var e = this;
      if (e.ctx && void 0 !== e.ctx.resume && n.usingWebAudio)
        return (
          "running" === e.state && e._suspendTimer
            ? (clearTimeout(e._suspendTimer), (e._suspendTimer = null))
            : "suspended" === e.state
            ? (e.ctx.resume().then(function () {
                e.state = "running";
                for (var n = 0; n < e._howls.length; n++) e._howls[n]._emit("resume");
              }),
              e._suspendTimer && (clearTimeout(e._suspendTimer), (e._suspendTimer = null)))
            : "suspending" === e.state && (e._resumeAfterSuspend = !0),
          e
        );
    },
  };
  var n = new e(),
    o = function (e) {
      var n = this;
      if (!e.src || 0 === e.src.length)
        return void console.error("An array of source files must be passed with any new Howl.");
      n.init(e);
    };
  o.prototype = {
    init: function (e) {
      var o = this;
      return (
        n.ctx || _(),
        (o._autoplay = e.autoplay || !1),
        (o._format = "string" != typeof e.format ? e.format : [e.format]),
        (o._html5 = e.html5 || !1),
        (o._muted = e.mute || !1),
        (o._loop = e.loop || !1),
        (o._pool = e.pool || 5),
        (o._preload = "boolean" != typeof e.preload || e.preload),
        (o._rate = e.rate || 1),
        (o._sprite = e.sprite || {}),
        (o._src = "string" != typeof e.src ? e.src : [e.src]),
        (o._volume = void 0 !== e.volume ? e.volume : 1),
        (o._xhrWithCredentials = e.xhrWithCredentials || !1),
        (o._duration = 0),
        (o._state = "unloaded"),
        (o._sounds = []),
        (o._endTimers = {}),
        (o._queue = []),
        (o._playLock = !1),
        (o._onend = e.onend ? [{ fn: e.onend }] : []),
        (o._onfade = e.onfade ? [{ fn: e.onfade }] : []),
        (o._onload = e.onload ? [{ fn: e.onload }] : []),
        (o._onloaderror = e.onloaderror ? [{ fn: e.onloaderror }] : []),
        (o._onplayerror = e.onplayerror ? [{ fn: e.onplayerror }] : []),
        (o._onpause = e.onpause ? [{ fn: e.onpause }] : []),
        (o._onplay = e.onplay ? [{ fn: e.onplay }] : []),
        (o._onstop = e.onstop ? [{ fn: e.onstop }] : []),
        (o._onmute = e.onmute ? [{ fn: e.onmute }] : []),
        (o._onvolume = e.onvolume ? [{ fn: e.onvolume }] : []),
        (o._onrate = e.onrate ? [{ fn: e.onrate }] : []),
        (o._onseek = e.onseek ? [{ fn: e.onseek }] : []),
        (o._onunlock = e.onunlock ? [{ fn: e.onunlock }] : []),
        (o._onresume = []),
        (o._webAudio = n.usingWebAudio && !o._html5),
        void 0 !== n.ctx && n.ctx && n.autoUnlock && n._unlockAudio(),
        n._howls.push(o),
        o._autoplay &&
          o._queue.push({
            event: "play",
            action: function () {
              o.play();
            },
          }),
        o._preload && o.load(),
        o
      );
    },
    load: function () {
      var e = this,
        o = null;
      if (n.noAudio) return void e._emit("loaderror", null, "No audio support.");
      "string" == typeof e._src && (e._src = [e._src]);
      for (var r = 0; r < e._src.length; r++) {
        var u, i;
        if (e._format && e._format[r]) u = e._format[r];
        else {
          if ("string" != typeof (i = e._src[r])) {
            e._emit("loaderror", null, "Non-string found in selected audio sources - ignoring.");
            continue;
          }
          (u = /^data:audio\/([^;,]+);/i.exec(i)),
            u || (u = /\.([^.]+)$/.exec(i.split("?", 1)[0])),
            u && (u = u[1].toLowerCase());
        }
        if (
          (u ||
            console.warn(
              'No file extension was found. Consider using the "format" property or specify an extension.'
            ),
          u && n.codecs(u))
        ) {
          o = e._src[r];
          break;
        }
      }
      return o
        ? ((e._src = o),
          (e._state = "loading"),
          "https:" === window.location.protocol &&
            "http:" === o.slice(0, 5) &&
            ((e._html5 = !0), (e._webAudio = !1)),
          new t(e),
          e._webAudio && a(e),
          e)
        : void e._emit("loaderror", null, "No codec support for selected audio sources.");
    },
    play: function (e, o) {
      var t = this,
        r = null;
      if ("number" == typeof e) (r = e), (e = null);
      else {
        if ("string" == typeof e && "loaded" === t._state && !t._sprite[e]) return null;
        if (void 0 === e && ((e = "__default"), !t._playLock)) {
          for (var a = 0, u = 0; u < t._sounds.length; u++)
            t._sounds[u]._paused && !t._sounds[u]._ended && (a++, (r = t._sounds[u]._id));
          1 === a ? (e = null) : (r = null);
        }
      }
      var i = r ? t._soundById(r) : t._inactiveSound();
      if (!i) return null;
      if ((r && !e && (e = i._sprite || "__default"), "loaded" !== t._state)) {
        (i._sprite = e), (i._ended = !1);
        var d = i._id;
        return (
          t._queue.push({
            event: "play",
            action: function () {
              t.play(d);
            },
          }),
          d
        );
      }
      if (r && !i._paused) return o || t._loadQueue("play"), i._id;
      t._webAudio && n._autoResume();
      var _ = Math.max(0, i._seek > 0 ? i._seek : t._sprite[e][0] / 1e3),
        s = Math.max(0, (t._sprite[e][0] + t._sprite[e][1]) / 1e3 - _),
        l = (1e3 * s) / Math.abs(i._rate),
        c = t._sprite[e][0] / 1e3,
        f = (t._sprite[e][0] + t._sprite[e][1]) / 1e3;
      (i._sprite = e), (i._ended = !1);
      var p = function () {
        (i._paused = !1),
          (i._seek = _),
          (i._start = c),
          (i._stop = f),
          (i._loop = !(!i._loop && !t._sprite[e][2]));
      };
      if (_ >= f) return void t._ended(i);
      var m = i._node;
      if (t._webAudio) {
        var v = function () {
          (t._playLock = !1), p(), t._refreshBuffer(i);
          var e = i._muted || t._muted ? 0 : i._volume;
          m.gain.setValueAtTime(e, n.ctx.currentTime),
            (i._playStart = n.ctx.currentTime),
            void 0 === m.bufferSource.start
              ? i._loop
                ? m.bufferSource.noteGrainOn(0, _, 86400)
                : m.bufferSource.noteGrainOn(0, _, s)
              : i._loop
              ? m.bufferSource.start(0, _, 86400)
              : m.bufferSource.start(0, _, s),
            l !== 1 / 0 && (t._endTimers[i._id] = setTimeout(t._ended.bind(t, i), l)),
            o ||
              setTimeout(function () {
                t._emit("play", i._id), t._loadQueue();
              }, 0);
        };
        "running" === n.state
          ? v()
          : ((t._playLock = !0), t.once("resume", v), t._clearTimer(i._id));
      } else {
        var h = function () {
          (m.currentTime = _),
            (m.muted = i._muted || t._muted || n._muted || m.muted),
            (m.volume = i._volume * n.volume()),
            (m.playbackRate = i._rate);
          try {
            var r = m.play();
            if (
              (r &&
              "undefined" != typeof Promise &&
              (r instanceof Promise || "function" == typeof r.then)
                ? ((t._playLock = !0),
                  p(),
                  r
                    .then(function () {
                      (t._playLock = !1),
                        (m._unlocked = !0),
                        o || (t._emit("play", i._id), t._loadQueue());
                    })
                    .catch(function () {
                      (t._playLock = !1),
                        t._emit(
                          "playerror",
                          i._id,
                          "Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."
                        ),
                        (i._ended = !0),
                        (i._paused = !0);
                    }))
                : o || ((t._playLock = !1), p(), t._emit("play", i._id), t._loadQueue()),
              (m.playbackRate = i._rate),
              m.paused)
            )
              return void t._emit(
                "playerror",
                i._id,
                "Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."
              );
            "__default" !== e || i._loop
              ? (t._endTimers[i._id] = setTimeout(t._ended.bind(t, i), l))
              : ((t._endTimers[i._id] = function () {
                  t._ended(i), m.removeEventListener("ended", t._endTimers[i._id], !1);
                }),
                m.addEventListener("ended", t._endTimers[i._id], !1));
          } catch (e) {
            t._emit("playerror", i._id, e);
          }
        };
        "data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA" ===
          m.src && ((m.src = t._src), m.load());
        var y = (window && window.ejecta) || (!m.readyState && n._navigator.isCocoonJS);
        if (m.readyState >= 3 || y) h();
        else {
          t._playLock = !0;
          var g = function () {
            h(), m.removeEventListener(n._canPlayEvent, g, !1);
          };
          m.addEventListener(n._canPlayEvent, g, !1), t._clearTimer(i._id);
        }
      }
      return i._id;
    },
    pause: function (e) {
      var n = this;
      if ("loaded" !== n._state || n._playLock)
        return (
          n._queue.push({
            event: "pause",
            action: function () {
              n.pause(e);
            },
          }),
          n
        );
      for (var o = n._getSoundIds(e), t = 0; t < o.length; t++) {
        n._clearTimer(o[t]);
        var r = n._soundById(o[t]);
        if (
          r &&
          !r._paused &&
          ((r._seek = n.seek(o[t])),
          (r._rateSeek = 0),
          (r._paused = !0),
          n._stopFade(o[t]),
          r._node)
        )
          if (n._webAudio) {
            if (!r._node.bufferSource) continue;
            void 0 === r._node.bufferSource.stop
              ? r._node.bufferSource.noteOff(0)
              : r._node.bufferSource.stop(0),
              n._cleanBuffer(r._node);
          } else (isNaN(r._node.duration) && r._node.duration !== 1 / 0) || r._node.pause();
        arguments[1] || n._emit("pause", r ? r._id : null);
      }
      return n;
    },
    stop: function (e, n) {
      var o = this;
      if ("loaded" !== o._state || o._playLock)
        return (
          o._queue.push({
            event: "stop",
            action: function () {
              o.stop(e);
            },
          }),
          o
        );
      for (var t = o._getSoundIds(e), r = 0; r < t.length; r++) {
        o._clearTimer(t[r]);
        var a = o._soundById(t[r]);
        a &&
          ((a._seek = a._start || 0),
          (a._rateSeek = 0),
          (a._paused = !0),
          (a._ended = !0),
          o._stopFade(t[r]),
          a._node &&
            (o._webAudio
              ? a._node.bufferSource &&
                (void 0 === a._node.bufferSource.stop
                  ? a._node.bufferSource.noteOff(0)
                  : a._node.bufferSource.stop(0),
                o._cleanBuffer(a._node))
              : (isNaN(a._node.duration) && a._node.duration !== 1 / 0) ||
                ((a._node.currentTime = a._start || 0),
                a._node.pause(),
                a._node.duration === 1 / 0 && o._clearSound(a._node))),
          n || o._emit("stop", a._id));
      }
      return o;
    },
    mute: function (e, o) {
      var t = this;
      if ("loaded" !== t._state || t._playLock)
        return (
          t._queue.push({
            event: "mute",
            action: function () {
              t.mute(e, o);
            },
          }),
          t
        );
      if (void 0 === o) {
        if ("boolean" != typeof e) return t._muted;
        t._muted = e;
      }
      for (var r = t._getSoundIds(o), a = 0; a < r.length; a++) {
        var u = t._soundById(r[a]);
        u &&
          ((u._muted = e),
          u._interval && t._stopFade(u._id),
          t._webAudio && u._node
            ? u._node.gain.setValueAtTime(e ? 0 : u._volume, n.ctx.currentTime)
            : u._node && (u._node.muted = !!n._muted || e),
          t._emit("mute", u._id));
      }
      return t;
    },
    volume: function () {
      var e,
        o,
        t = this,
        r = arguments;
      if (0 === r.length) return t._volume;
      if (1 === r.length || (2 === r.length && void 0 === r[1])) {
        t._getSoundIds().indexOf(r[0]) >= 0 ? (o = parseInt(r[0], 10)) : (e = parseFloat(r[0]));
      } else r.length >= 2 && ((e = parseFloat(r[0])), (o = parseInt(r[1], 10)));
      var a;
      if (!(void 0 !== e && e >= 0 && e <= 1))
        return (a = o ? t._soundById(o) : t._sounds[0]), a ? a._volume : 0;
      if ("loaded" !== t._state || t._playLock)
        return (
          t._queue.push({
            event: "volume",
            action: function () {
              t.volume.apply(t, r);
            },
          }),
          t
        );
      void 0 === o && (t._volume = e), (o = t._getSoundIds(o));
      for (var u = 0; u < o.length; u++)
        (a = t._soundById(o[u])) &&
          ((a._volume = e),
          r[2] || t._stopFade(o[u]),
          t._webAudio && a._node && !a._muted
            ? a._node.gain.setValueAtTime(e, n.ctx.currentTime)
            : a._node && !a._muted && (a._node.volume = e * n.volume()),
          t._emit("volume", a._id));
      return t;
    },
    fade: function (e, o, t, r) {
      var a = this;
      if ("loaded" !== a._state || a._playLock)
        return (
          a._queue.push({
            event: "fade",
            action: function () {
              a.fade(e, o, t, r);
            },
          }),
          a
        );
      (e = parseFloat(e)), (o = parseFloat(o)), (t = parseFloat(t)), a.volume(e, r);
      for (var u = a._getSoundIds(r), i = 0; i < u.length; i++) {
        var d = a._soundById(u[i]);
        if (d) {
          if ((r || a._stopFade(u[i]), a._webAudio && !d._muted)) {
            var _ = n.ctx.currentTime,
              s = _ + t / 1e3;
            (d._volume = e),
              d._node.gain.setValueAtTime(e, _),
              d._node.gain.linearRampToValueAtTime(o, s);
          }
          a._startFadeInterval(d, e, o, t, u[i], void 0 === r);
        }
      }
      return a;
    },
    _startFadeInterval: function (e, n, o, t, r, a) {
      var u = this,
        i = n,
        d = o - n,
        _ = Math.abs(d / 0.01),
        s = Math.max(4, _ > 0 ? t / _ : t),
        l = Date.now();
      (e._fadeTo = o),
        (e._interval = setInterval(function () {
          var r = (Date.now() - l) / t;
          (l = Date.now()),
            (i += d * r),
            (i = Math.max(0, i)),
            (i = Math.min(1, i)),
            (i = Math.round(100 * i) / 100),
            u._webAudio ? (e._volume = i) : u.volume(i, e._id, !0),
            a && (u._volume = i),
            ((o < n && i <= o) || (o > n && i >= o)) &&
              (clearInterval(e._interval),
              (e._interval = null),
              (e._fadeTo = null),
              u.volume(o, e._id),
              u._emit("fade", e._id));
        }, s));
    },
    _stopFade: function (e) {
      var o = this,
        t = o._soundById(e);
      return (
        t &&
          t._interval &&
          (o._webAudio && t._node.gain.cancelScheduledValues(n.ctx.currentTime),
          clearInterval(t._interval),
          (t._interval = null),
          o.volume(t._fadeTo, e),
          (t._fadeTo = null),
          o._emit("fade", e)),
        o
      );
    },
    loop: function () {
      var e,
        n,
        o,
        t = this,
        r = arguments;
      if (0 === r.length) return t._loop;
      if (1 === r.length) {
        if ("boolean" != typeof r[0]) return !!(o = t._soundById(parseInt(r[0], 10))) && o._loop;
        (e = r[0]), (t._loop = e);
      } else 2 === r.length && ((e = r[0]), (n = parseInt(r[1], 10)));
      for (var a = t._getSoundIds(n), u = 0; u < a.length; u++)
        (o = t._soundById(a[u])) &&
          ((o._loop = e),
          t._webAudio &&
            o._node &&
            o._node.bufferSource &&
            ((o._node.bufferSource.loop = e),
            e &&
              ((o._node.bufferSource.loopStart = o._start || 0),
              (o._node.bufferSource.loopEnd = o._stop))));
      return t;
    },
    rate: function () {
      var e,
        o,
        t = this,
        r = arguments;
      if (0 === r.length) o = t._sounds[0]._id;
      else if (1 === r.length) {
        var a = t._getSoundIds(),
          u = a.indexOf(r[0]);
        u >= 0 ? (o = parseInt(r[0], 10)) : (e = parseFloat(r[0]));
      } else 2 === r.length && ((e = parseFloat(r[0])), (o = parseInt(r[1], 10)));
      var i;
      if ("number" != typeof e) return (i = t._soundById(o)), i ? i._rate : t._rate;
      if ("loaded" !== t._state || t._playLock)
        return (
          t._queue.push({
            event: "rate",
            action: function () {
              t.rate.apply(t, r);
            },
          }),
          t
        );
      void 0 === o && (t._rate = e), (o = t._getSoundIds(o));
      for (var d = 0; d < o.length; d++)
        if ((i = t._soundById(o[d]))) {
          t.playing(o[d]) &&
            ((i._rateSeek = t.seek(o[d])),
            (i._playStart = t._webAudio ? n.ctx.currentTime : i._playStart)),
            (i._rate = e),
            t._webAudio && i._node && i._node.bufferSource
              ? i._node.bufferSource.playbackRate.setValueAtTime(e, n.ctx.currentTime)
              : i._node && (i._node.playbackRate = e);
          var _ = t.seek(o[d]),
            s = (t._sprite[i._sprite][0] + t._sprite[i._sprite][1]) / 1e3 - _,
            l = (1e3 * s) / Math.abs(i._rate);
          (!t._endTimers[o[d]] && i._paused) ||
            (t._clearTimer(o[d]), (t._endTimers[o[d]] = setTimeout(t._ended.bind(t, i), l))),
            t._emit("rate", i._id);
        }
      return t;
    },
    seek: function () {
      var e,
        o,
        t = this,
        r = arguments;
      if (0 === r.length) o = t._sounds[0]._id;
      else if (1 === r.length) {
        var a = t._getSoundIds(),
          u = a.indexOf(r[0]);
        u >= 0
          ? (o = parseInt(r[0], 10))
          : t._sounds.length && ((o = t._sounds[0]._id), (e = parseFloat(r[0])));
      } else 2 === r.length && ((e = parseFloat(r[0])), (o = parseInt(r[1], 10)));
      if (void 0 === o) return t;
      if ("loaded" !== t._state || t._playLock)
        return (
          t._queue.push({
            event: "seek",
            action: function () {
              t.seek.apply(t, r);
            },
          }),
          t
        );
      var i = t._soundById(o);
      if (i) {
        if (!("number" == typeof e && e >= 0)) {
          if (t._webAudio) {
            var d = t.playing(o) ? n.ctx.currentTime - i._playStart : 0,
              _ = i._rateSeek ? i._rateSeek - i._seek : 0;
            return i._seek + (_ + d * Math.abs(i._rate));
          }
          return i._node.currentTime;
        }
        var s = t.playing(o);
        s && t.pause(o, !0),
          (i._seek = e),
          (i._ended = !1),
          t._clearTimer(o),
          t._webAudio || !i._node || isNaN(i._node.duration) || (i._node.currentTime = e);
        var l = function () {
          t._emit("seek", o), s && t.play(o, !0);
        };
        if (s && !t._webAudio) {
          var c = function () {
            t._playLock ? setTimeout(c, 0) : l();
          };
          setTimeout(c, 0);
        } else l();
      }
      return t;
    },
    playing: function (e) {
      var n = this;
      if ("number" == typeof e) {
        var o = n._soundById(e);
        return !!o && !o._paused;
      }
      for (var t = 0; t < n._sounds.length; t++) if (!n._sounds[t]._paused) return !0;
      return !1;
    },
    duration: function (e) {
      var n = this,
        o = n._duration,
        t = n._soundById(e);
      return t && (o = n._sprite[t._sprite][1] / 1e3), o;
    },
    state: function () {
      return this._state;
    },
    unload: function () {
      for (var e = this, o = e._sounds, t = 0; t < o.length; t++)
        o[t]._paused || e.stop(o[t]._id),
          e._webAudio ||
            (e._clearSound(o[t]._node),
            o[t]._node.removeEventListener("error", o[t]._errorFn, !1),
            o[t]._node.removeEventListener(n._canPlayEvent, o[t]._loadFn, !1),
            n._releaseHtml5Audio(o[t]._node)),
          delete o[t]._node,
          e._clearTimer(o[t]._id);
      var a = n._howls.indexOf(e);
      a >= 0 && n._howls.splice(a, 1);
      var u = !0;
      for (t = 0; t < n._howls.length; t++)
        if (n._howls[t]._src === e._src || e._src.indexOf(n._howls[t]._src) >= 0) {
          u = !1;
          break;
        }
      return (
        r && u && delete r[e._src],
        (n.noAudio = !1),
        (e._state = "unloaded"),
        (e._sounds = []),
        (e = null),
        null
      );
    },
    on: function (e, n, o, t) {
      var r = this,
        a = r["_on" + e];
      return "function" == typeof n && a.push(t ? { id: o, fn: n, once: t } : { id: o, fn: n }), r;
    },
    off: function (e, n, o) {
      var t = this,
        r = t["_on" + e],
        a = 0;
      if (("number" == typeof n && ((o = n), (n = null)), n || o))
        for (a = 0; a < r.length; a++) {
          var u = o === r[a].id;
          if ((n === r[a].fn && u) || (!n && u)) {
            r.splice(a, 1);
            break;
          }
        }
      else if (e) t["_on" + e] = [];
      else {
        var i = Object.keys(t);
        for (a = 0; a < i.length; a++)
          0 === i[a].indexOf("_on") && Array.isArray(t[i[a]]) && (t[i[a]] = []);
      }
      return t;
    },
    once: function (e, n, o) {
      var t = this;
      return t.on(e, n, o, 1), t;
    },
    _emit: function (e, n, o) {
      for (var t = this, r = t["_on" + e], a = r.length - 1; a >= 0; a--)
        (r[a].id && r[a].id !== n && "load" !== e) ||
          (setTimeout(
            function (e) {
              e.call(this, n, o);
            }.bind(t, r[a].fn),
            0
          ),
          r[a].once && t.off(e, r[a].fn, r[a].id));
      return t._loadQueue(e), t;
    },
    _loadQueue: function (e) {
      var n = this;
      if (n._queue.length > 0) {
        var o = n._queue[0];
        o.event === e && (n._queue.shift(), n._loadQueue()), e || o.action();
      }
      return n;
    },
    _ended: function (e) {
      var o = this,
        t = e._sprite;
      if (
        !o._webAudio &&
        e._node &&
        !e._node.paused &&
        !e._node.ended &&
        e._node.currentTime < e._stop
      )
        return setTimeout(o._ended.bind(o, e), 100), o;
      var r = !(!e._loop && !o._sprite[t][2]);
      if (
        (o._emit("end", e._id),
        !o._webAudio && r && o.stop(e._id, !0).play(e._id),
        o._webAudio && r)
      ) {
        o._emit("play", e._id),
          (e._seek = e._start || 0),
          (e._rateSeek = 0),
          (e._playStart = n.ctx.currentTime);
        var a = (1e3 * (e._stop - e._start)) / Math.abs(e._rate);
        o._endTimers[e._id] = setTimeout(o._ended.bind(o, e), a);
      }
      return (
        o._webAudio &&
          !r &&
          ((e._paused = !0),
          (e._ended = !0),
          (e._seek = e._start || 0),
          (e._rateSeek = 0),
          o._clearTimer(e._id),
          o._cleanBuffer(e._node),
          n._autoSuspend()),
        o._webAudio || r || o.stop(e._id, !0),
        o
      );
    },
    _clearTimer: function (e) {
      var n = this;
      if (n._endTimers[e]) {
        if ("function" != typeof n._endTimers[e]) clearTimeout(n._endTimers[e]);
        else {
          var o = n._soundById(e);
          o && o._node && o._node.removeEventListener("ended", n._endTimers[e], !1);
        }
        delete n._endTimers[e];
      }
      return n;
    },
    _soundById: function (e) {
      for (var n = this, o = 0; o < n._sounds.length; o++)
        if (e === n._sounds[o]._id) return n._sounds[o];
      return null;
    },
    _inactiveSound: function () {
      var e = this;
      e._drain();
      for (var n = 0; n < e._sounds.length; n++)
        if (e._sounds[n]._ended) return e._sounds[n].reset();
      return new t(e);
    },
    _drain: function () {
      var e = this,
        n = e._pool,
        o = 0,
        t = 0;
      if (!(e._sounds.length < n)) {
        for (t = 0; t < e._sounds.length; t++) e._sounds[t]._ended && o++;
        for (t = e._sounds.length - 1; t >= 0; t--) {
          if (o <= n) return;
          e._sounds[t]._ended &&
            (e._webAudio && e._sounds[t]._node && e._sounds[t]._node.disconnect(0),
            e._sounds.splice(t, 1),
            o--);
        }
      }
    },
    _getSoundIds: function (e) {
      var n = this;
      if (void 0 === e) {
        for (var o = [], t = 0; t < n._sounds.length; t++) o.push(n._sounds[t]._id);
        return o;
      }
      return [e];
    },
    _refreshBuffer: function (e) {
      var o = this;
      return (
        (e._node.bufferSource = n.ctx.createBufferSource()),
        (e._node.bufferSource.buffer = r[o._src]),
        e._panner ? e._node.bufferSource.connect(e._panner) : e._node.bufferSource.connect(e._node),
        (e._node.bufferSource.loop = e._loop),
        e._loop &&
          ((e._node.bufferSource.loopStart = e._start || 0),
          (e._node.bufferSource.loopEnd = e._stop || 0)),
        e._node.bufferSource.playbackRate.setValueAtTime(e._rate, n.ctx.currentTime),
        o
      );
    },
    _cleanBuffer: function (e) {
      var o = this,
        t = n._navigator && n._navigator.vendor.indexOf("Apple") >= 0;
      if (
        n._scratchBuffer &&
        e.bufferSource &&
        ((e.bufferSource.onended = null), e.bufferSource.disconnect(0), t)
      )
        try {
          e.bufferSource.buffer = n._scratchBuffer;
        } catch (e) {}
      return (e.bufferSource = null), o;
    },
    _clearSound: function (e) {
      /MSIE |Trident\//.test(n._navigator && n._navigator.userAgent) ||
        (e.src =
          "data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA");
    },
  };
  var t = function (e) {
    (this._parent = e), this.init();
  };
  t.prototype = {
    init: function () {
      var e = this,
        o = e._parent;
      return (
        (e._muted = o._muted),
        (e._loop = o._loop),
        (e._volume = o._volume),
        (e._rate = o._rate),
        (e._seek = 0),
        (e._paused = !0),
        (e._ended = !0),
        (e._sprite = "__default"),
        (e._id = ++n._counter),
        o._sounds.push(e),
        e.create(),
        e
      );
    },
    create: function () {
      var e = this,
        o = e._parent,
        t = n._muted || e._muted || e._parent._muted ? 0 : e._volume;
      return (
        o._webAudio
          ? ((e._node = void 0 === n.ctx.createGain ? n.ctx.createGainNode() : n.ctx.createGain()),
            e._node.gain.setValueAtTime(t, n.ctx.currentTime),
            (e._node.paused = !0),
            e._node.connect(n.masterGain))
          : n.noAudio ||
            ((e._node = n._obtainHtml5Audio()),
            (e._errorFn = e._errorListener.bind(e)),
            e._node.addEventListener("error", e._errorFn, !1),
            (e._loadFn = e._loadListener.bind(e)),
            e._node.addEventListener(n._canPlayEvent, e._loadFn, !1),
            (e._node.src = o._src),
            (e._node.preload = "auto"),
            (e._node.volume = t * n.volume()),
            e._node.load()),
        e
      );
    },
    reset: function () {
      var e = this,
        o = e._parent;
      return (
        (e._muted = o._muted),
        (e._loop = o._loop),
        (e._volume = o._volume),
        (e._rate = o._rate),
        (e._seek = 0),
        (e._rateSeek = 0),
        (e._paused = !0),
        (e._ended = !0),
        (e._sprite = "__default"),
        (e._id = ++n._counter),
        e
      );
    },
    _errorListener: function () {
      var e = this;
      e._parent._emit("loaderror", e._id, e._node.error ? e._node.error.code : 0),
        e._node.removeEventListener("error", e._errorFn, !1);
    },
    _loadListener: function () {
      var e = this,
        o = e._parent;
      (o._duration = Math.ceil(10 * e._node.duration) / 10),
        0 === Object.keys(o._sprite).length && (o._sprite = { __default: [0, 1e3 * o._duration] }),
        "loaded" !== o._state && ((o._state = "loaded"), o._emit("load"), o._loadQueue()),
        e._node.removeEventListener(n._canPlayEvent, e._loadFn, !1);
    },
  };
  var r = {},
    a = function (e) {
      var n = e._src;
      if (r[n]) return (e._duration = r[n].duration), void d(e);
      if (/^data:[^;]+;base64,/.test(n)) {
        for (var o = atob(n.split(",")[1]), t = new Uint8Array(o.length), a = 0; a < o.length; ++a)
          t[a] = o.charCodeAt(a);
        i(t.buffer, e);
      } else {
        var _ = new XMLHttpRequest();
        _.open("GET", n, !0),
          (_.withCredentials = e._xhrWithCredentials),
          (_.responseType = "arraybuffer"),
          (_.onload = function () {
            var n = (_.status + "")[0];
            if ("0" !== n && "2" !== n && "3" !== n)
              return void e._emit(
                "loaderror",
                null,
                "Failed loading audio file with status: " + _.status + "."
              );
            i(_.response, e);
          }),
          (_.onerror = function () {
            e._webAudio &&
              ((e._html5 = !0), (e._webAudio = !1), (e._sounds = []), delete r[n], e.load());
          }),
          u(_);
      }
    },
    u = function (e) {
      try {
        e.send();
      } catch (n) {
        e.onerror();
      }
    },
    i = function (e, o) {
      var t = function () {
          o._emit("loaderror", null, "Decoding audio data failed.");
        },
        a = function (e) {
          e && o._sounds.length > 0 ? ((r[o._src] = e), d(o, e)) : t();
        };
      "undefined" != typeof Promise && 1 === n.ctx.decodeAudioData.length
        ? n.ctx.decodeAudioData(e).then(a).catch(t)
        : n.ctx.decodeAudioData(e, a, t);
    },
    d = function (e, n) {
      n && !e._duration && (e._duration = n.duration),
        0 === Object.keys(e._sprite).length && (e._sprite = { __default: [0, 1e3 * e._duration] }),
        "loaded" !== e._state && ((e._state = "loaded"), e._emit("load"), e._loadQueue());
    },
    _ = function () {
      if (n.usingWebAudio) {
        try {
          "undefined" != typeof AudioContext
            ? (n.ctx = new AudioContext())
            : "undefined" != typeof webkitAudioContext
            ? (n.ctx = new webkitAudioContext())
            : (n.usingWebAudio = !1);
        } catch (e) {
          n.usingWebAudio = !1;
        }
        n.ctx || (n.usingWebAudio = !1);
        var e = /iP(hone|od|ad)/.test(n._navigator && n._navigator.platform),
          o = n._navigator && n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),
          t = o ? parseInt(o[1], 10) : null;
        if (e && t && t < 9) {
          var r = /safari/.test(n._navigator && n._navigator.userAgent.toLowerCase());
          ((n._navigator && n._navigator.standalone && !r) ||
            (n._navigator && !n._navigator.standalone && !r)) &&
            (n.usingWebAudio = !1);
        }
        n.usingWebAudio &&
          ((n.masterGain =
            void 0 === n.ctx.createGain ? n.ctx.createGainNode() : n.ctx.createGain()),
          n.masterGain.gain.setValueAtTime(n._muted ? 0 : n._volume, n.ctx.currentTime),
          n.masterGain.connect(n.ctx.destination)),
          n._setup();
      }
    };
  "function" == typeof define &&
    define.amd &&
    define([], function () {
      return { Howler: n, Howl: o };
    }),
    "undefined" != typeof exports && ((exports.Howler = n), (exports.Howl = o)),
    "undefined" != typeof window
      ? ((window.HowlerGlobal = e), (window.Howler = n), (window.Howl = o), (window.Sound = t))
      : "undefined" != typeof global &&
        ((global.HowlerGlobal = e), (global.Howler = n), (global.Howl = o), (global.Sound = t));
})();
/*! Spatial Plugin */
!(function () {
  "use strict";
  (HowlerGlobal.prototype._pos = [0, 0, 0]),
    (HowlerGlobal.prototype._orientation = [0, 0, -1, 0, 1, 0]),
    (HowlerGlobal.prototype.stereo = function (e) {
      var n = this;
      if (!n.ctx || !n.ctx.listener) return n;
      for (var t = n._howls.length - 1; t >= 0; t--) n._howls[t].stereo(e);
      return n;
    }),
    (HowlerGlobal.prototype.pos = function (e, n, t) {
      var r = this;
      return r.ctx && r.ctx.listener
        ? ((n = "number" != typeof n ? r._pos[1] : n),
          (t = "number" != typeof t ? r._pos[2] : t),
          "number" != typeof e
            ? r._pos
            : ((r._pos = [e, n, t]),
              void 0 !== r.ctx.listener.positionX
                ? (r.ctx.listener.positionX.setTargetAtTime(r._pos[0], Howler.ctx.currentTime, 0.1),
                  r.ctx.listener.positionY.setTargetAtTime(r._pos[1], Howler.ctx.currentTime, 0.1),
                  r.ctx.listener.positionZ.setTargetAtTime(r._pos[2], Howler.ctx.currentTime, 0.1))
                : r.ctx.listener.setPosition(r._pos[0], r._pos[1], r._pos[2]),
              r))
        : r;
    }),
    (HowlerGlobal.prototype.orientation = function (e, n, t, r, o, i) {
      var a = this;
      if (!a.ctx || !a.ctx.listener) return a;
      var s = a._orientation;
      return (
        (n = "number" != typeof n ? s[1] : n),
        (t = "number" != typeof t ? s[2] : t),
        (r = "number" != typeof r ? s[3] : r),
        (o = "number" != typeof o ? s[4] : o),
        (i = "number" != typeof i ? s[5] : i),
        "number" != typeof e
          ? s
          : ((a._orientation = [e, n, t, r, o, i]),
            void 0 !== a.ctx.listener.forwardX
              ? (a.ctx.listener.forwardX.setTargetAtTime(e, Howler.ctx.currentTime, 0.1),
                a.ctx.listener.forwardY.setTargetAtTime(n, Howler.ctx.currentTime, 0.1),
                a.ctx.listener.forwardZ.setTargetAtTime(t, Howler.ctx.currentTime, 0.1),
                a.ctx.listener.upX.setTargetAtTime(r, Howler.ctx.currentTime, 0.1),
                a.ctx.listener.upY.setTargetAtTime(o, Howler.ctx.currentTime, 0.1),
                a.ctx.listener.upZ.setTargetAtTime(i, Howler.ctx.currentTime, 0.1))
              : a.ctx.listener.setOrientation(e, n, t, r, o, i),
            a)
      );
    }),
    (Howl.prototype.init = (function (e) {
      return function (n) {
        var t = this;
        return (
          (t._orientation = n.orientation || [1, 0, 0]),
          (t._stereo = n.stereo || null),
          (t._pos = n.pos || null),
          (t._pannerAttr = {
            coneInnerAngle: void 0 !== n.coneInnerAngle ? n.coneInnerAngle : 360,
            coneOuterAngle: void 0 !== n.coneOuterAngle ? n.coneOuterAngle : 360,
            coneOuterGain: void 0 !== n.coneOuterGain ? n.coneOuterGain : 0,
            distanceModel: void 0 !== n.distanceModel ? n.distanceModel : "inverse",
            maxDistance: void 0 !== n.maxDistance ? n.maxDistance : 1e4,
            panningModel: void 0 !== n.panningModel ? n.panningModel : "HRTF",
            refDistance: void 0 !== n.refDistance ? n.refDistance : 1,
            rolloffFactor: void 0 !== n.rolloffFactor ? n.rolloffFactor : 1,
          }),
          (t._onstereo = n.onstereo ? [{ fn: n.onstereo }] : []),
          (t._onpos = n.onpos ? [{ fn: n.onpos }] : []),
          (t._onorientation = n.onorientation ? [{ fn: n.onorientation }] : []),
          e.call(this, n)
        );
      };
    })(Howl.prototype.init)),
    (Howl.prototype.stereo = function (n, t) {
      var r = this;
      if (!r._webAudio) return r;
      if ("loaded" !== r._state)
        return (
          r._queue.push({
            event: "stereo",
            action: function () {
              r.stereo(n, t);
            },
          }),
          r
        );
      var o = void 0 === Howler.ctx.createStereoPanner ? "spatial" : "stereo";
      if (void 0 === t) {
        if ("number" != typeof n) return r._stereo;
        (r._stereo = n), (r._pos = [n, 0, 0]);
      }
      for (var i = r._getSoundIds(t), a = 0; a < i.length; a++) {
        var s = r._soundById(i[a]);
        if (s) {
          if ("number" != typeof n) return s._stereo;
          (s._stereo = n),
            (s._pos = [n, 0, 0]),
            s._node &&
              ((s._pannerAttr.panningModel = "equalpower"),
              (s._panner && s._panner.pan) || e(s, o),
              "spatial" === o
                ? void 0 !== s._panner.positionX
                  ? (s._panner.positionX.setValueAtTime(n, Howler.ctx.currentTime),
                    s._panner.positionY.setValueAtTime(0, Howler.ctx.currentTime),
                    s._panner.positionZ.setValueAtTime(0, Howler.ctx.currentTime))
                  : s._panner.setPosition(n, 0, 0)
                : s._panner.pan.setValueAtTime(n, Howler.ctx.currentTime)),
            r._emit("stereo", s._id);
        }
      }
      return r;
    }),
    (Howl.prototype.pos = function (n, t, r, o) {
      var i = this;
      if (!i._webAudio) return i;
      if ("loaded" !== i._state)
        return (
          i._queue.push({
            event: "pos",
            action: function () {
              i.pos(n, t, r, o);
            },
          }),
          i
        );
      if (
        ((t = "number" != typeof t ? 0 : t), (r = "number" != typeof r ? -0.5 : r), void 0 === o)
      ) {
        if ("number" != typeof n) return i._pos;
        i._pos = [n, t, r];
      }
      for (var a = i._getSoundIds(o), s = 0; s < a.length; s++) {
        var p = i._soundById(a[s]);
        if (p) {
          if ("number" != typeof n) return p._pos;
          (p._pos = [n, t, r]),
            p._node &&
              ((p._panner && !p._panner.pan) || e(p, "spatial"),
              void 0 !== p._panner.positionX
                ? (p._panner.positionX.setValueAtTime(n, Howler.ctx.currentTime),
                  p._panner.positionY.setValueAtTime(t, Howler.ctx.currentTime),
                  p._panner.positionZ.setValueAtTime(r, Howler.ctx.currentTime))
                : p._panner.setPosition(n, t, r)),
            i._emit("pos", p._id);
        }
      }
      return i;
    }),
    (Howl.prototype.orientation = function (n, t, r, o) {
      var i = this;
      if (!i._webAudio) return i;
      if ("loaded" !== i._state)
        return (
          i._queue.push({
            event: "orientation",
            action: function () {
              i.orientation(n, t, r, o);
            },
          }),
          i
        );
      if (
        ((t = "number" != typeof t ? i._orientation[1] : t),
        (r = "number" != typeof r ? i._orientation[2] : r),
        void 0 === o)
      ) {
        if ("number" != typeof n) return i._orientation;
        i._orientation = [n, t, r];
      }
      for (var a = i._getSoundIds(o), s = 0; s < a.length; s++) {
        var p = i._soundById(a[s]);
        if (p) {
          if ("number" != typeof n) return p._orientation;
          (p._orientation = [n, t, r]),
            p._node &&
              (p._panner || (p._pos || (p._pos = i._pos || [0, 0, -0.5]), e(p, "spatial")),
              void 0 !== p._panner.orientationX
                ? (p._panner.orientationX.setValueAtTime(n, Howler.ctx.currentTime),
                  p._panner.orientationY.setValueAtTime(t, Howler.ctx.currentTime),
                  p._panner.orientationZ.setValueAtTime(r, Howler.ctx.currentTime))
                : p._panner.setOrientation(n, t, r)),
            i._emit("orientation", p._id);
        }
      }
      return i;
    }),
    (Howl.prototype.pannerAttr = function () {
      var n,
        t,
        r,
        o = this,
        i = arguments;
      if (!o._webAudio) return o;
      if (0 === i.length) return o._pannerAttr;
      if (1 === i.length) {
        if ("object" != typeof i[0])
          return (r = o._soundById(parseInt(i[0], 10))), r ? r._pannerAttr : o._pannerAttr;
        (n = i[0]),
          void 0 === t &&
            (n.pannerAttr ||
              (n.pannerAttr = {
                coneInnerAngle: n.coneInnerAngle,
                coneOuterAngle: n.coneOuterAngle,
                coneOuterGain: n.coneOuterGain,
                distanceModel: n.distanceModel,
                maxDistance: n.maxDistance,
                refDistance: n.refDistance,
                rolloffFactor: n.rolloffFactor,
                panningModel: n.panningModel,
              }),
            (o._pannerAttr = {
              coneInnerAngle:
                void 0 !== n.pannerAttr.coneInnerAngle
                  ? n.pannerAttr.coneInnerAngle
                  : o._coneInnerAngle,
              coneOuterAngle:
                void 0 !== n.pannerAttr.coneOuterAngle
                  ? n.pannerAttr.coneOuterAngle
                  : o._coneOuterAngle,
              coneOuterGain:
                void 0 !== n.pannerAttr.coneOuterGain
                  ? n.pannerAttr.coneOuterGain
                  : o._coneOuterGain,
              distanceModel:
                void 0 !== n.pannerAttr.distanceModel
                  ? n.pannerAttr.distanceModel
                  : o._distanceModel,
              maxDistance:
                void 0 !== n.pannerAttr.maxDistance ? n.pannerAttr.maxDistance : o._maxDistance,
              refDistance:
                void 0 !== n.pannerAttr.refDistance ? n.pannerAttr.refDistance : o._refDistance,
              rolloffFactor:
                void 0 !== n.pannerAttr.rolloffFactor
                  ? n.pannerAttr.rolloffFactor
                  : o._rolloffFactor,
              panningModel:
                void 0 !== n.pannerAttr.panningModel ? n.pannerAttr.panningModel : o._panningModel,
            }));
      } else 2 === i.length && ((n = i[0]), (t = parseInt(i[1], 10)));
      for (var a = o._getSoundIds(t), s = 0; s < a.length; s++)
        if ((r = o._soundById(a[s]))) {
          var p = r._pannerAttr;
          p = {
            coneInnerAngle: void 0 !== n.coneInnerAngle ? n.coneInnerAngle : p.coneInnerAngle,
            coneOuterAngle: void 0 !== n.coneOuterAngle ? n.coneOuterAngle : p.coneOuterAngle,
            coneOuterGain: void 0 !== n.coneOuterGain ? n.coneOuterGain : p.coneOuterGain,
            distanceModel: void 0 !== n.distanceModel ? n.distanceModel : p.distanceModel,
            maxDistance: void 0 !== n.maxDistance ? n.maxDistance : p.maxDistance,
            refDistance: void 0 !== n.refDistance ? n.refDistance : p.refDistance,
            rolloffFactor: void 0 !== n.rolloffFactor ? n.rolloffFactor : p.rolloffFactor,
            panningModel: void 0 !== n.panningModel ? n.panningModel : p.panningModel,
          };
          var c = r._panner;
          c
            ? ((c.coneInnerAngle = p.coneInnerAngle),
              (c.coneOuterAngle = p.coneOuterAngle),
              (c.coneOuterGain = p.coneOuterGain),
              (c.distanceModel = p.distanceModel),
              (c.maxDistance = p.maxDistance),
              (c.refDistance = p.refDistance),
              (c.rolloffFactor = p.rolloffFactor),
              (c.panningModel = p.panningModel))
            : (r._pos || (r._pos = o._pos || [0, 0, -0.5]), e(r, "spatial"));
        }
      return o;
    }),
    (Sound.prototype.init = (function (e) {
      return function () {
        var n = this,
          t = n._parent;
        (n._orientation = t._orientation),
          (n._stereo = t._stereo),
          (n._pos = t._pos),
          (n._pannerAttr = t._pannerAttr),
          e.call(this),
          n._stereo ? t.stereo(n._stereo) : n._pos && t.pos(n._pos[0], n._pos[1], n._pos[2], n._id);
      };
    })(Sound.prototype.init)),
    (Sound.prototype.reset = (function (e) {
      return function () {
        var n = this,
          t = n._parent;
        return (
          (n._orientation = t._orientation),
          (n._stereo = t._stereo),
          (n._pos = t._pos),
          (n._pannerAttr = t._pannerAttr),
          n._stereo
            ? t.stereo(n._stereo)
            : n._pos
            ? t.pos(n._pos[0], n._pos[1], n._pos[2], n._id)
            : n._panner && (n._panner.disconnect(0), (n._panner = void 0), t._refreshBuffer(n)),
          e.call(this)
        );
      };
    })(Sound.prototype.reset));
  var e = function (e, n) {
    (n = n || "spatial"),
      "spatial" === n
        ? ((e._panner = Howler.ctx.createPanner()),
          (e._panner.coneInnerAngle = e._pannerAttr.coneInnerAngle),
          (e._panner.coneOuterAngle = e._pannerAttr.coneOuterAngle),
          (e._panner.coneOuterGain = e._pannerAttr.coneOuterGain),
          (e._panner.distanceModel = e._pannerAttr.distanceModel),
          (e._panner.maxDistance = e._pannerAttr.maxDistance),
          (e._panner.refDistance = e._pannerAttr.refDistance),
          (e._panner.rolloffFactor = e._pannerAttr.rolloffFactor),
          (e._panner.panningModel = e._pannerAttr.panningModel),
          void 0 !== e._panner.positionX
            ? (e._panner.positionX.setValueAtTime(e._pos[0], Howler.ctx.currentTime),
              e._panner.positionY.setValueAtTime(e._pos[1], Howler.ctx.currentTime),
              e._panner.positionZ.setValueAtTime(e._pos[2], Howler.ctx.currentTime))
            : e._panner.setPosition(e._pos[0], e._pos[1], e._pos[2]),
          void 0 !== e._panner.orientationX
            ? (e._panner.orientationX.setValueAtTime(e._orientation[0], Howler.ctx.currentTime),
              e._panner.orientationY.setValueAtTime(e._orientation[1], Howler.ctx.currentTime),
              e._panner.orientationZ.setValueAtTime(e._orientation[2], Howler.ctx.currentTime))
            : e._panner.setOrientation(e._orientation[0], e._orientation[1], e._orientation[2]))
        : ((e._panner = Howler.ctx.createStereoPanner()),
          e._panner.pan.setValueAtTime(e._stereo, Howler.ctx.currentTime)),
      e._panner.connect(e._node),
      e._paused || e._parent.pause(e._id, !0).play(e._id, !0);
  };
})();
!(function (t, i) {
  "object" == typeof exports && "undefined" != typeof module
    ? (module.exports = i())
    : "function" == typeof define && define.amd
    ? define(i)
    : ((t = "undefined" != typeof globalThis ? globalThis : t || self).Flatbush = i());
})(this, function () {
  "use strict";
  var t = function () {
    (this.ids = []), (this.values = []), (this.length = 0);
  };
  (t.prototype.clear = function () {
    this.length = 0;
  }),
    (t.prototype.push = function (t, i) {
      var s = this.length++;
      for (this.ids[s] = t, this.values[s] = i; s > 0; ) {
        var e = (s - 1) >> 1,
          h = this.values[e];
        if (i >= h) break;
        (this.ids[s] = this.ids[e]), (this.values[s] = h), (s = e);
      }
      (this.ids[s] = t), (this.values[s] = i);
    }),
    (t.prototype.pop = function () {
      if (0 !== this.length) {
        var t = this.ids[0];
        if ((this.length--, this.length > 0)) {
          for (
            var i = (this.ids[0] = this.ids[this.length]),
              s = (this.values[0] = this.values[this.length]),
              e = this.length >> 1,
              h = 0;
            h < e;

          ) {
            var r = 1 + (h << 1),
              n = r + 1,
              o = this.ids[r],
              a = this.values[r],
              u = this.values[n];
            if ((n < this.length && u < a && ((r = n), (o = this.ids[n]), (a = u)), a >= s)) break;
            (this.ids[h] = o), (this.values[h] = a), (h = r);
          }
          (this.ids[h] = i), (this.values[h] = s);
        }
        return t;
      }
    }),
    (t.prototype.peek = function () {
      if (0 !== this.length) return this.ids[0];
    }),
    (t.prototype.peekValue = function () {
      if (0 !== this.length) return this.values[0];
    });
  var i = [
      Int8Array,
      Uint8Array,
      Uint8ClampedArray,
      Int16Array,
      Uint16Array,
      Int32Array,
      Uint32Array,
      Float32Array,
      Float64Array,
    ],
    s = function (s, e, h, r) {
      if ((void 0 === e && (e = 16), void 0 === h && (h = Float64Array), void 0 === s))
        throw new Error("Missing required argument: numItems.");
      if (isNaN(s) || s <= 0) throw new Error("Unpexpected numItems value: " + s + ".");
      (this.numItems = +s), (this.nodeSize = Math.min(Math.max(+e, 2), 65535));
      var n = s,
        o = n;
      this._levelBounds = [4 * n];
      do {
        (o += n = Math.ceil(n / this.nodeSize)), this._levelBounds.push(4 * o);
      } while (1 !== n);
      (this.ArrayType = h || Float64Array),
        (this.IndexArrayType = o < 16384 ? Uint16Array : Uint32Array);
      var a = i.indexOf(this.ArrayType),
        u = 4 * o * this.ArrayType.BYTES_PER_ELEMENT;
      if (a < 0) throw new Error("Unexpected typed array class: " + h + ".");
      r && r instanceof ArrayBuffer
        ? ((this.data = r),
          (this._boxes = new this.ArrayType(this.data, 8, 4 * o)),
          (this._indices = new this.IndexArrayType(this.data, 8 + u, o)),
          (this._pos = 4 * o),
          (this.minX = this._boxes[this._pos - 4]),
          (this.minY = this._boxes[this._pos - 3]),
          (this.maxX = this._boxes[this._pos - 2]),
          (this.maxY = this._boxes[this._pos - 1]))
        : ((this.data = new ArrayBuffer(8 + u + o * this.IndexArrayType.BYTES_PER_ELEMENT)),
          (this._boxes = new this.ArrayType(this.data, 8, 4 * o)),
          (this._indices = new this.IndexArrayType(this.data, 8 + u, o)),
          (this._pos = 0),
          (this.minX = 1 / 0),
          (this.minY = 1 / 0),
          (this.maxX = -1 / 0),
          (this.maxY = -1 / 0),
          new Uint8Array(this.data, 0, 2).set([251, 48 + a]),
          (new Uint16Array(this.data, 2, 1)[0] = e),
          (new Uint32Array(this.data, 4, 1)[0] = s)),
        (this._queue = new t());
    };
  function e(t, i, s) {
    return t < i ? i - t : t <= s ? 0 : t - s;
  }
  function h(t, i) {
    for (var s = 0, e = i.length - 1; s < e; ) {
      var h = (s + e) >> 1;
      i[h] > t ? (e = h) : (s = h + 1);
    }
    return i[s];
  }
  function r(t, i, s, e, h, o) {
    if (!(Math.floor(e / o) >= Math.floor(h / o))) {
      for (var a = t[(e + h) >> 1], u = e - 1, d = h + 1; ; ) {
        do {
          u++;
        } while (t[u] < a);
        do {
          d--;
        } while (t[d] > a);
        if (u >= d) break;
        n(t, i, s, u, d);
      }
      r(t, i, s, e, d, o), r(t, i, s, d + 1, h, o);
    }
  }
  function n(t, i, s, e, h) {
    var r = t[e];
    (t[e] = t[h]), (t[h] = r);
    var n = 4 * e,
      o = 4 * h,
      a = i[n],
      u = i[n + 1],
      d = i[n + 2],
      p = i[n + 3];
    (i[n] = i[o]),
      (i[n + 1] = i[o + 1]),
      (i[n + 2] = i[o + 2]),
      (i[n + 3] = i[o + 3]),
      (i[o] = a),
      (i[o + 1] = u),
      (i[o + 2] = d),
      (i[o + 3] = p);
    var f = s[e];
    (s[e] = s[h]), (s[h] = f);
  }
  function o(t, i) {
    var s = t ^ i,
      e = 65535 ^ s,
      h = 65535 ^ (t | i),
      r = t & (65535 ^ i),
      n = s | (e >> 1),
      o = (s >> 1) ^ s,
      a = (h >> 1) ^ (e & (r >> 1)) ^ h,
      u = (s & (h >> 1)) ^ (r >> 1) ^ r;
    (o = ((s = n) & ((e = o) >> 2)) ^ (e & ((s ^ e) >> 2))),
      (a ^= (s & ((h = a) >> 2)) ^ (e & ((r = u) >> 2))),
      (u ^= (e & (h >> 2)) ^ ((s ^ e) & (r >> 2))),
      (o = ((s = n = (s & (s >> 2)) ^ (e & (e >> 2))) & ((e = o) >> 4)) ^ (e & ((s ^ e) >> 4))),
      (a ^= (s & ((h = a) >> 4)) ^ (e & ((r = u) >> 4))),
      (u ^= (e & (h >> 4)) ^ ((s ^ e) & (r >> 4))),
      (a ^=
        ((s = n = (s & (s >> 4)) ^ (e & (e >> 4))) & ((h = a) >> 8)) ^ ((e = o) & ((r = u) >> 8)));
    var d = t ^ i,
      p =
        (e = (u ^= (e & (h >> 8)) ^ ((s ^ e) & (r >> 8))) ^ (u >> 1)) |
        (65535 ^ (d | (s = a ^ (a >> 1))));
    return (
      (((p =
        1431655765 &
        ((p =
          858993459 & ((p = 252645135 & ((p = 16711935 & (p | (p << 8))) | (p << 4))) | (p << 2))) |
          (p << 1))) <<
        1) |
        (d =
          1431655765 &
          ((d =
            858993459 &
            ((d = 252645135 & ((d = 16711935 & (d | (d << 8))) | (d << 4))) | (d << 2))) |
            (d << 1)))) >>>
      0
    );
  }
  return (
    (s.from = function (t) {
      if (!(t instanceof ArrayBuffer)) throw new Error("Data must be an instance of ArrayBuffer.");
      var e = new Uint8Array(t, 0, 2),
        h = e[0],
        r = e[1];
      if (251 !== h) throw new Error("Data does not appear to be in a Flatbush format.");
      if (r >> 4 != 3) throw new Error("Got v" + (r >> 4) + " data when expected v3.");
      var n = new Uint16Array(t, 2, 1)[0],
        o = new Uint32Array(t, 4, 1)[0];
      return new s(o, n, i[15 & r], t);
    }),
    (s.prototype.add = function (t, i, s, e) {
      var h = this._pos >> 2;
      return (
        (this._indices[h] = h),
        (this._boxes[this._pos++] = t),
        (this._boxes[this._pos++] = i),
        (this._boxes[this._pos++] = s),
        (this._boxes[this._pos++] = e),
        t < this.minX && (this.minX = t),
        i < this.minY && (this.minY = i),
        s > this.maxX && (this.maxX = s),
        e > this.maxY && (this.maxY = e),
        h
      );
    }),
    (s.prototype.finish = function () {
      if (this._pos >> 2 !== this.numItems)
        throw new Error(
          "Added " + (this._pos >> 2) + " items when expected " + this.numItems + "."
        );
      if (this.numItems <= this.nodeSize)
        return (
          (this._boxes[this._pos++] = this.minX),
          (this._boxes[this._pos++] = this.minY),
          (this._boxes[this._pos++] = this.maxX),
          void (this._boxes[this._pos++] = this.maxY)
        );
      for (
        var t = this.maxX - this.minX || 1,
          i = this.maxY - this.minY || 1,
          s = new Uint32Array(this.numItems),
          e = 0;
        e < this.numItems;
        e++
      ) {
        var h = 4 * e,
          n = this._boxes[h++],
          a = this._boxes[h++],
          u = this._boxes[h++],
          d = this._boxes[h++],
          p = Math.floor((65535 * ((n + u) / 2 - this.minX)) / t),
          f = Math.floor((65535 * ((a + d) / 2 - this.minY)) / i);
        s[e] = o(p, f);
      }
      r(s, this._boxes, this._indices, 0, this.numItems - 1, this.nodeSize);
      for (var _ = 0, l = 0; _ < this._levelBounds.length - 1; _++)
        for (var x = this._levelBounds[_]; l < x; ) {
          for (
            var m = l, v = 1 / 0, y = 1 / 0, b = -1 / 0, c = -1 / 0, w = 0;
            w < this.nodeSize && l < x;
            w++
          )
            (v = Math.min(v, this._boxes[l++])),
              (y = Math.min(y, this._boxes[l++])),
              (b = Math.max(b, this._boxes[l++])),
              (c = Math.max(c, this._boxes[l++]));
          (this._indices[this._pos >> 2] = m),
            (this._boxes[this._pos++] = v),
            (this._boxes[this._pos++] = y),
            (this._boxes[this._pos++] = b),
            (this._boxes[this._pos++] = c);
        }
    }),
    (s.prototype.search = function (t, i, s, e, r) {
      if (this._pos !== this._boxes.length)
        throw new Error("Data not yet indexed - call index.finish().");
      for (var n = this._boxes.length - 4, o = [], a = []; void 0 !== n; ) {
        for (
          var u = Math.min(n + 4 * this.nodeSize, h(n, this._levelBounds)), d = n;
          d < u;
          d += 4
        ) {
          var p = 0 | this._indices[d >> 2];
          s < this._boxes[d] ||
            e < this._boxes[d + 1] ||
            t > this._boxes[d + 2] ||
            i > this._boxes[d + 3] ||
            (n < 4 * this.numItems ? (void 0 === r || r(p)) && a.push(p) : o.push(p));
        }
        n = o.pop();
      }
      return a;
    }),
    (s.prototype.neighbors = function (t, i, s, r, n) {
      if (
        (void 0 === s && (s = 1 / 0), void 0 === r && (r = 1 / 0), this._pos !== this._boxes.length)
      )
        throw new Error("Data not yet indexed - call index.finish().");
      for (var o = this._boxes.length - 4, a = this._queue, u = [], d = r * r; void 0 !== o; ) {
        for (
          var p = Math.min(o + 4 * this.nodeSize, h(o, this._levelBounds)), f = o;
          f < p;
          f += 4
        ) {
          var _ = 0 | this._indices[f >> 2],
            l = e(t, this._boxes[f], this._boxes[f + 2]),
            x = e(i, this._boxes[f + 1], this._boxes[f + 3]),
            m = l * l + x * x;
          o < 4 * this.numItems
            ? (void 0 === n || n(_)) && a.push(1 + (_ << 1), m)
            : a.push(_ << 1, m);
        }
        for (; a.length && 1 & a.peek(); ) {
          if (a.peekValue() > d) return a.clear(), u;
          if ((u.push(a.pop() >> 1), u.length === s)) return a.clear(), u;
        }
        o = a.pop() >> 1;
      }
      return a.clear(), u;
    }),
    s
  );
});
var LZString = (function () {
  function o(o, r) {
    if (!t[o]) {
      t[o] = {};
      for (var n = 0; n < o.length; n++) t[o][o.charAt(n)] = n;
    }
    return t[o][r];
  }
  var r = String.fromCharCode,
    n = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
    e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",
    t = {},
    i = {
      compressToBase64: function (o) {
        if (null == o) return "";
        var r = i._compress(o, 6, function (o) {
          return n.charAt(o);
        });
        switch (r.length % 4) {
          default:
          case 0:
            return r;
          case 1:
            return r + "===";
          case 2:
            return r + "==";
          case 3:
            return r + "=";
        }
      },
      decompressFromBase64: function (r) {
        return null == r
          ? ""
          : "" == r
          ? null
          : i._decompress(r.length, 32, function (e) {
              return o(n, r.charAt(e));
            });
      },
      compressToUTF16: function (o) {
        return null == o
          ? ""
          : i._compress(o, 15, function (o) {
              return r(o + 32);
            }) + " ";
      },
      decompressFromUTF16: function (o) {
        return null == o
          ? ""
          : "" == o
          ? null
          : i._decompress(o.length, 16384, function (r) {
              return o.charCodeAt(r) - 32;
            });
      },
      compressToUint8Array: function (o) {
        for (
          var r = i.compress(o), n = new Uint8Array(2 * r.length), e = 0, t = r.length;
          t > e;
          e++
        ) {
          var s = r.charCodeAt(e);
          (n[2 * e] = s >>> 8), (n[2 * e + 1] = s % 256);
        }
        return n;
      },
      decompressFromUint8Array: function (o) {
        if (null === o || void 0 === o) return i.decompress(o);
        for (var n = new Array(o.length / 2), e = 0, t = n.length; t > e; e++)
          n[e] = 256 * o[2 * e] + o[2 * e + 1];
        var s = [];
        return (
          n.forEach(function (o) {
            s.push(r(o));
          }),
          i.decompress(s.join(""))
        );
      },
      compressToEncodedURIComponent: function (o) {
        return null == o
          ? ""
          : i._compress(o, 6, function (o) {
              return e.charAt(o);
            });
      },
      decompressFromEncodedURIComponent: function (r) {
        return null == r
          ? ""
          : "" == r
          ? null
          : ((r = r.replace(/ /g, "+")),
            i._decompress(r.length, 32, function (n) {
              return o(e, r.charAt(n));
            }));
      },
      compress: function (o) {
        return i._compress(o, 16, function (o) {
          return r(o);
        });
      },
      _compress: function (o, r, n) {
        if (null == o) return "";
        var e,
          t,
          i,
          s = {},
          p = {},
          u = "",
          c = "",
          a = "",
          l = 2,
          f = 3,
          h = 2,
          d = [],
          m = 0,
          v = 0;
        for (i = 0; i < o.length; i += 1)
          if (
            ((u = o.charAt(i)),
            Object.prototype.hasOwnProperty.call(s, u) || ((s[u] = f++), (p[u] = !0)),
            (c = a + u),
            Object.prototype.hasOwnProperty.call(s, c))
          )
            a = c;
          else {
            if (Object.prototype.hasOwnProperty.call(p, a)) {
              if (a.charCodeAt(0) < 256) {
                for (e = 0; h > e; e++)
                  (m <<= 1), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++;
                for (t = a.charCodeAt(0), e = 0; 8 > e; e++)
                  (m = (m << 1) | (1 & t)),
                    v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,
                    (t >>= 1);
              } else {
                for (t = 1, e = 0; h > e; e++)
                  (m = (m << 1) | t), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++, (t = 0);
                for (t = a.charCodeAt(0), e = 0; 16 > e; e++)
                  (m = (m << 1) | (1 & t)),
                    v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,
                    (t >>= 1);
              }
              l--, 0 == l && ((l = Math.pow(2, h)), h++), delete p[a];
            } else
              for (t = s[a], e = 0; h > e; e++)
                (m = (m << 1) | (1 & t)),
                  v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,
                  (t >>= 1);
            l--, 0 == l && ((l = Math.pow(2, h)), h++), (s[c] = f++), (a = String(u));
          }
        if ("" !== a) {
          if (Object.prototype.hasOwnProperty.call(p, a)) {
            if (a.charCodeAt(0) < 256) {
              for (e = 0; h > e; e++)
                (m <<= 1), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++;
              for (t = a.charCodeAt(0), e = 0; 8 > e; e++)
                (m = (m << 1) | (1 & t)),
                  v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,
                  (t >>= 1);
            } else {
              for (t = 1, e = 0; h > e; e++)
                (m = (m << 1) | t), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++, (t = 0);
              for (t = a.charCodeAt(0), e = 0; 16 > e; e++)
                (m = (m << 1) | (1 & t)),
                  v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,
                  (t >>= 1);
            }
            l--, 0 == l && ((l = Math.pow(2, h)), h++), delete p[a];
          } else
            for (t = s[a], e = 0; h > e; e++)
              (m = (m << 1) | (1 & t)),
                v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,
                (t >>= 1);
          l--, 0 == l && ((l = Math.pow(2, h)), h++);
        }
        for (t = 2, e = 0; h > e; e++)
          (m = (m << 1) | (1 & t)), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++, (t >>= 1);
        for (;;) {
          if (((m <<= 1), v == r - 1)) {
            d.push(n(m));
            break;
          }
          v++;
        }
        return d.join("");
      },
      decompress: function (o) {
        return null == o
          ? ""
          : "" == o
          ? null
          : i._decompress(o.length, 32768, function (r) {
              return o.charCodeAt(r);
            });
      },
      _decompress: function (o, n, e) {
        var t,
          i,
          s,
          p,
          u,
          c,
          a,
          l,
          f = [],
          h = 4,
          d = 4,
          m = 3,
          v = "",
          w = [],
          A = { val: e(0), position: n, index: 1 };
        for (i = 0; 3 > i; i += 1) f[i] = i;
        for (p = 0, c = Math.pow(2, 2), a = 1; a != c; )
          (u = A.val & A.position),
            (A.position >>= 1),
            0 == A.position && ((A.position = n), (A.val = e(A.index++))),
            (p |= (u > 0 ? 1 : 0) * a),
            (a <<= 1);
        switch ((t = p)) {
          case 0:
            for (p = 0, c = Math.pow(2, 8), a = 1; a != c; )
              (u = A.val & A.position),
                (A.position >>= 1),
                0 == A.position && ((A.position = n), (A.val = e(A.index++))),
                (p |= (u > 0 ? 1 : 0) * a),
                (a <<= 1);
            l = r(p);
            break;
          case 1:
            for (p = 0, c = Math.pow(2, 16), a = 1; a != c; )
              (u = A.val & A.position),
                (A.position >>= 1),
                0 == A.position && ((A.position = n), (A.val = e(A.index++))),
                (p |= (u > 0 ? 1 : 0) * a),
                (a <<= 1);
            l = r(p);
            break;
          case 2:
            return "";
        }
        for (f[3] = l, s = l, w.push(l); ; ) {
          if (A.index > o) return "";
          for (p = 0, c = Math.pow(2, m), a = 1; a != c; )
            (u = A.val & A.position),
              (A.position >>= 1),
              0 == A.position && ((A.position = n), (A.val = e(A.index++))),
              (p |= (u > 0 ? 1 : 0) * a),
              (a <<= 1);
          switch ((l = p)) {
            case 0:
              for (p = 0, c = Math.pow(2, 8), a = 1; a != c; )
                (u = A.val & A.position),
                  (A.position >>= 1),
                  0 == A.position && ((A.position = n), (A.val = e(A.index++))),
                  (p |= (u > 0 ? 1 : 0) * a),
                  (a <<= 1);
              (f[d++] = r(p)), (l = d - 1), h--;
              break;
            case 1:
              for (p = 0, c = Math.pow(2, 16), a = 1; a != c; )
                (u = A.val & A.position),
                  (A.position >>= 1),
                  0 == A.position && ((A.position = n), (A.val = e(A.index++))),
                  (p |= (u > 0 ? 1 : 0) * a),
                  (a <<= 1);
              (f[d++] = r(p)), (l = d - 1), h--;
              break;
            case 2:
              return w.join("");
          }
          if ((0 == h && ((h = Math.pow(2, m)), m++), f[l])) v = f[l];
          else {
            if (l !== d) return null;
            v = s + s.charAt(0);
          }
          w.push(v),
            (f[d++] = s + v.charAt(0)),
            h--,
            (s = v),
            0 == h && ((h = Math.pow(2, m)), m++);
        }
      },
    };
  return i;
})();
"function" == typeof define && define.amd
  ? define(function () {
      return LZString;
    })
  : "undefined" != typeof module && null != module && (module.exports = LZString);
let Box2D = {};
!(function (t) {
  function i() {}
  (t.inherit = function (t, o) {
    let e = t;
    (i.prototype = o.prototype), (t.prototype = new i()), (t.prototype.constructor = e);
  }),
    (t.NVector = function (t) {
      return 4 === t
        ? [0, 0, 0, 0]
        : 3 === t
        ? [0, 0, 0]
        : 2 === t
        ? [0, 0]
        : 1 === t
        ? [0]
        : new Array(t).fill(0);
    }),
    (t.is = function (t, i) {
      return (
        null != t &&
        ((i instanceof Function && t instanceof i) ||
          !(void 0 === t.constructor.__implements || !t.constructor.__implements[i]))
      );
    }),
    (t.parseUInt = function (t) {
      return Math.abs(parseInt(t, 10));
    });
})(Box2D),
  void 0 === Box2D && (Box2D = {}),
  void 0 === Box2D.Collision && (Box2D.Collision = {}),
  void 0 === Box2D.Collision.Shapes && (Box2D.Collision.Shapes = {}),
  void 0 === Box2D.Common && (Box2D.Common = {}),
  void 0 === Box2D.Common.Math && (Box2D.Common.Math = {}),
  void 0 === Box2D.Dynamics && (Box2D.Dynamics = {}),
  void 0 === Box2D.Dynamics.Contacts && (Box2D.Dynamics.Contacts = {}),
  void 0 === Box2D.Dynamics.Controllers && (Box2D.Dynamics.Controllers = {}),
  void 0 === Box2D.Dynamics.Joints && (Box2D.Dynamics.Joints = {}),
  (function () {
    function t() {
      (this.features = new i()), this.constructor === t && this.b2ContactID.apply(this, arguments);
    }

    function i() {
      i.Features.apply(this, arguments);
    }

    function o() {
      (this.col1 = new b2Vec2()),
        (this.col2 = new b2Vec2()),
        this.constructor === o && this.b2Mat22.apply(this, arguments);
    }

    function e() {
      e.b2Mat33.apply(this, arguments),
        this.constructor === e && this.b2Mat33.apply(this, arguments);
    }

    function n() {
      this.b2Vec3.apply(this, arguments);
    }

    function s() {
      (this.categoryBits = 1), (this.maskBits = 65535), (this.groupIndex = 0);
    }

    function l() {
      l.b2Joint.apply(this, arguments),
        this.constructor === l && this.b2Joint.apply(this, arguments);
    }

    function m() {
      m.b2JointDef.apply(this, arguments),
        this.constructor === m && this.b2JointDef.apply(this, arguments);
    }
    (Box2D.Collision.IBroadPhase = "Box2D.Collision.IBroadPhase"),
      (b2Vec2 = Box2D.Common.Math.b2Vec2 =
        function (t, i) {
          (this.x = t || 0), (this.y = i || 0);
        }),
      (Box2D.Collision.b2AABB = function () {
        (this.lowerBound = new b2Vec2()), (this.upperBound = new b2Vec2());
      }),
      (Box2D.Collision.b2Bound = function t() {
        t.b2Bound.apply(this, arguments);
      }),
      (Box2D.Collision.b2BoundValues = function t() {
        t.b2BoundValues.apply(this, arguments),
          this.constructor === t && this.b2BoundValues.apply(this, arguments);
      }),
      (Box2D.Collision.b2Collision = function t() {
        t.b2Collision.apply(this, arguments);
      }),
      (Box2D.Collision.b2ContactID = t),
      (Box2D.Collision.b2ContactPoint = function t() {
        t.b2ContactPoint.apply(this, arguments);
      }),
      (Box2D.Collision.b2Distance = function t() {
        t.b2Distance.apply(this, arguments);
      }),
      (Box2D.Collision.b2DistanceInput = function t() {
        t.b2DistanceInput.apply(this, arguments);
      }),
      (Box2D.Collision.b2DistanceOutput = function t() {
        t.b2DistanceOutput.apply(this, arguments);
      }),
      (Box2D.Collision.b2DistanceProxy = function () {}),
      (Box2D.Collision.b2DynamicTree = function t() {
        t.b2DynamicTree.apply(this, arguments),
          this.constructor === t && this.b2DynamicTree.apply(this, arguments);
      }),
      (Box2D.Collision.b2DynamicTreeBroadPhase = function t() {
        t.b2DynamicTreeBroadPhase.apply(this, arguments);
      }),
      (Box2D.Collision.b2DynamicTreeNode = function t() {
        t.b2DynamicTreeNode.apply(this, arguments);
      }),
      (Box2D.Collision.b2DynamicTreePair = function t() {
        t.b2DynamicTreePair.apply(this, arguments);
      }),
      (Box2D.Collision.b2Manifold = function t() {
        (this.m_pointCount = 0), this.constructor === t && this.b2Manifold.apply(this, arguments);
      }),
      (Box2D.Collision.b2ManifoldPoint = function () {
        (this.m_localPoint = new b2Vec2()), (this.m_id = new t());
      }),
      (Box2D.Collision.b2Point = function t() {
        t.b2Point.apply(this, arguments);
      }),
      (Box2D.Collision.b2RayCastInput = function t() {
        (this.p1 = new b2Vec2()),
          (this.p2 = new b2Vec2()),
          this.constructor === t && this.b2RayCastInput.apply(this, arguments);
      }),
      (Box2D.Collision.b2RayCastOutput = function () {
        this.normal = new b2Vec2();
      }),
      (Box2D.Collision.b2Segment = function t() {
        t.b2Segment.apply(this, arguments);
      }),
      (Box2D.Collision.b2SeparationFunction = function t() {
        t.b2SeparationFunction.apply(this, arguments);
      }),
      (Box2D.Collision.b2Simplex = function t() {
        t.b2Simplex.apply(this, arguments),
          this.constructor === t && this.b2Simplex.apply(this, arguments);
      }),
      (Box2D.Collision.b2SimplexCache = function t() {
        t.b2SimplexCache.apply(this, arguments);
      }),
      (Box2D.Collision.b2SimplexVertex = function t() {
        t.b2SimplexVertex.apply(this, arguments);
      }),
      (Box2D.Collision.b2TimeOfImpact = function t() {
        t.b2TimeOfImpact.apply(this, arguments);
      }),
      (Box2D.Collision.b2TOIInput = function t() {
        t.b2TOIInput.apply(this, arguments);
      }),
      (Box2D.Collision.b2WorldManifold = function t() {
        t.b2WorldManifold.apply(this, arguments),
          this.constructor === t && this.b2WorldManifold.apply(this, arguments);
      }),
      (Box2D.Collision.ClipVertex = function t() {
        t.ClipVertex.apply(this, arguments);
      }),
      (Box2D.Collision.Features = i),
      (Box2D.Collision.Shapes.b2CircleShape = function () {
        (this.m_p = new b2Vec2()), this.b2CircleShape.apply(this, arguments);
      }),
      (Box2D.Collision.Shapes.b2EdgeChainDef = function t() {
        t.b2EdgeChainDef.apply(this, arguments),
          this.constructor === t && this.b2EdgeChainDef.apply(this, arguments);
      }),
      (Box2D.Collision.Shapes.b2EdgeShape = function t() {
        t.b2EdgeShape.apply(this, arguments),
          this.constructor === t && this.b2EdgeShape.apply(this, arguments);
      }),
      (Box2D.Collision.Shapes.b2MassData = function () {
        (this.mass = 0), (this.center = new b2Vec2()), (this.I = 0);
      }),
      (Box2D.Collision.Shapes.b2PolygonShape = function t() {
        Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments),
          this.constructor === t && this.b2PolygonShape.apply(this, arguments);
      }),
      (Box2D.Collision.Shapes.b2Shape = function t() {
        t.b2Shape.apply(this, arguments),
          this.constructor === t && this.b2Shape.apply(this, arguments);
      }),
      (Box2D.Common.b2internal = "Box2D.Common.b2internal"),
      (Box2D.Common.b2Color = function t() {
        t.b2Color.apply(this, arguments),
          this.constructor === t && this.b2Color.apply(this, arguments);
      }),
      (Box2D.Common.b2Settings = function t() {
        t.b2Settings.apply(this, arguments);
      }),
      (Box2D.Common.Math.b2Mat22 = o),
      (Box2D.Common.Math.b2Mat33 = e),
      (Box2D.Common.Math.b2Math = function t() {
        t.b2Math.apply(this, arguments);
      }),
      (Box2D.Common.Math.b2Sweep = function () {
        (this.localCenter = new b2Vec2()), (this.c0 = new b2Vec2()), (this.c = new b2Vec2());
      }),
      (Box2D.Common.Math.b2Transform = function (t) {
        (this.position = new b2Vec2()), (this.R = new o()), this.position.SetV(t);
      }),
      (Box2D.Common.Math.b2Vec3 = n),
      (Box2D.Dynamics.b2Body = function () {
        (this.m_xf = new Box2D.Common.Math.b2Transform(new Box2D.Common.Math.b2Vec2(0, 0))),
          (this.m_sweep = new Box2D.Common.Math.b2Sweep()),
          (this.m_linearVelocity = new Box2D.Common.Math.b2Vec2()),
          (this.m_force = new Box2D.Common.Math.b2Vec2()),
          (this.m_gravityScale = 1),
          this.b2Body.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2BodyDef = function () {
        (this.position = new b2Vec2()),
          (this.linearVelocity = new b2Vec2()),
          this.b2BodyDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2ContactFilter = function t() {
        t.b2ContactFilter.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2ContactImpulse = function t() {
        t.b2ContactImpulse.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2ContactListener = function t() {
        t.b2ContactListener.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2ContactManager = function t() {
        t.b2ContactManager.apply(this, arguments), this.b2ContactManager.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2DestructionListener = function t() {
        t.b2DestructionListener.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2FilterData = s),
      (Box2D.Dynamics.b2Fixture = function () {
        this.b2Fixture.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2FixtureDef = function t() {
        (this.filter = new s()), this.constructor === t && this.b2FixtureDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2Island = function t() {
        t.b2Island.apply(this, arguments),
          this.constructor === t && this.b2Island.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2TimeStep = function t() {
        t.b2TimeStep.apply(this, arguments);
      }),
      (Box2D.Dynamics.b2World = function t() {
        t.b2World.apply(this, arguments),
          this.constructor === t && this.b2World.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2CircleContact = function t() {
        t.b2CircleContact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2Contact = function t() {
        t.b2Contact.apply(this, arguments),
          this.constructor === t && this.b2Contact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2ContactConstraint = function t() {
        (this.localPlaneNormal = new b2Vec2()),
          (this.localPoint = new b2Vec2()),
          (this.normal = new b2Vec2()),
          (this.normalMass = new o()),
          (this.K = new o()),
          this.constructor === t && this.b2ContactConstraint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2ContactConstraintPoint = function () {
        (this.localPoint = new b2Vec2()), (this.rA = new b2Vec2()), (this.rB = new b2Vec2());
      }),
      (Box2D.Dynamics.Contacts.b2ContactEdge = function () {}),
      (Box2D.Dynamics.Contacts.b2ContactFactory = function t() {
        t.b2ContactFactory.apply(this, arguments),
          this.constructor === t && this.b2ContactFactory.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2ContactRegister = function t() {
        t.b2ContactRegister.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2ContactResult = function t() {
        t.b2ContactResult.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2ContactSolver = function t() {
        t.b2ContactSolver.apply(this, arguments),
          this.constructor === t && this.b2ContactSolver.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2EdgeAndCircleContact = function t() {
        t.b2EdgeAndCircleContact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2NullContact = function t() {
        t.b2NullContact.apply(this, arguments),
          this.constructor === t && this.b2NullContact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2PolyAndCircleContact = function () {
        Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2PolyAndEdgeContact = function t() {
        t.b2PolyAndEdgeContact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2PolygonContact = function t() {
        t.b2PolygonContact.apply(this, arguments);
      }),
      (Box2D.Dynamics.Contacts.b2PositionSolverManifold = function t() {
        t.b2PositionSolverManifold.apply(this, arguments),
          this.constructor === t && this.b2PositionSolverManifold.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2BuoyancyController = function t() {
        t.b2BuoyancyController.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2ConstantAccelController = function t() {
        t.b2ConstantAccelController.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2ConstantForceController = function t() {
        t.b2ConstantForceController.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2Controller = function t() {
        t.b2Controller.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2ControllerEdge = function t() {
        t.b2ControllerEdge.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2GravityController = function t() {
        t.b2GravityController.apply(this, arguments);
      }),
      (Box2D.Dynamics.Controllers.b2TensorDampingController = function t() {
        t.b2TensorDampingController.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2DistanceJoint = function t() {
        t.b2DistanceJoint.apply(this, arguments),
          this.constructor === t && this.b2DistanceJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2DistanceJointDef = function t() {
        t.b2DistanceJointDef.apply(this, arguments),
          this.constructor === t && this.b2DistanceJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2FrictionJoint = function t() {
        t.b2FrictionJoint.apply(this, arguments),
          this.constructor === t && this.b2FrictionJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2FrictionJointDef = function t() {
        t.b2FrictionJointDef.apply(this, arguments),
          this.constructor === t && this.b2FrictionJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2GearJoint = function t() {
        t.b2GearJoint.apply(this, arguments),
          this.constructor === t && this.b2GearJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2GearJointDef = function t() {
        t.b2GearJointDef.apply(this, arguments),
          this.constructor === t && this.b2GearJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2Jacobian = function t() {
        t.b2Jacobian.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2Joint = l),
      (Box2D.Dynamics.Joints.b2JointDef = m),
      (Box2D.Dynamics.Joints.b2JointEdge = function () {}),
      (Box2D.Dynamics.Joints.b2LineJoint = function t() {
        t.b2LineJoint.apply(this, arguments),
          this.constructor === t && this.b2LineJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2LineJointDef = function t() {
        t.b2LineJointDef.apply(this, arguments),
          this.constructor === t && this.b2LineJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2MouseJoint = function t() {
        t.b2MouseJoint.apply(this, arguments),
          this.constructor === t && this.b2MouseJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2MouseJointDef = function t() {
        t.b2MouseJointDef.apply(this, arguments),
          this.constructor === t && this.b2MouseJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2PrismaticJoint = function t() {
        t.b2PrismaticJoint.apply(this, arguments),
          this.constructor === t && this.b2PrismaticJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2PrismaticJointDef = function t() {
        t.b2PrismaticJointDef.apply(this, arguments),
          this.constructor === t && this.b2PrismaticJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2PulleyJoint = function t() {
        t.b2PulleyJoint.apply(this, arguments),
          this.constructor === t && this.b2PulleyJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2PulleyJointDef = function t() {
        t.b2PulleyJointDef.apply(this, arguments),
          this.constructor === t && this.b2PulleyJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2RevoluteJoint = function t() {
        l.apply(this, arguments),
          (this.K = new o()),
          (this.impulse3 = new n(0, 0, 0)),
          (this.impulse2 = new b2Vec2()),
          (this.reduced = new b2Vec2()),
          (this.m_localAnchor1 = new b2Vec2()),
          (this.m_localAnchor2 = new b2Vec2()),
          (this.m_impulse = new n(0, 0, 0)),
          (this.m_mass = new e()),
          this.constructor === t && this.b2RevoluteJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2RevoluteJointDef = function t() {
        m.apply(this, arguments),
          (this.localAnchorA = new b2Vec2()),
          (this.localAnchorB = new b2Vec2()),
          this.constructor === t && this.b2RevoluteJointDef.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2WeldJoint = function t() {
        l.apply(this, arguments),
          (this.m_localAnchorA = new b2Vec2()),
          (this.m_localAnchorB = new b2Vec2()),
          (this.m_impulse = new n(0, 0, 0)),
          (this.m_mass = new e()),
          this.constructor === t && this.b2WeldJoint.apply(this, arguments);
      }),
      (Box2D.Dynamics.Joints.b2WeldJointDef = function t() {
        m.apply(this, arguments),
          (this.localAnchorA = new b2Vec2()),
          (this.localAnchorB = new b2Vec2()),
          this.constructor === t && this.b2WeldJointDef.apply(this, arguments);
      });
  })(),
  (Box2D.postDefs = []),
  (function () {
    Box2D.Collision.Shapes.b2CircleShape,
      Box2D.Collision.Shapes.b2EdgeChainDef,
      Box2D.Collision.Shapes.b2EdgeShape,
      Box2D.Collision.Shapes.b2MassData,
      Box2D.Collision.Shapes.b2PolygonShape;
    let t = Box2D.Collision.Shapes.b2Shape,
      i = (Box2D.Common.b2Color, Box2D.Common.b2internal, Box2D.Common.b2Settings),
      o = (Box2D.Common.Math.b2Mat22, Box2D.Common.Math.b2Mat33, Box2D.Common.Math.b2Math),
      e = Box2D.Common.Math.b2Sweep,
      n = Box2D.Common.Math.b2Transform,
      s = Box2D.Common.Math.b2Vec2,
      l = (Box2D.Common.Math.b2Vec3, Box2D.Collision.b2AABB),
      m = Box2D.Collision.b2Bound,
      r = Box2D.Collision.b2BoundValues,
      a = Box2D.Collision.b2Collision,
      c = Box2D.Collision.b2ContactID,
      _ = Box2D.Collision.b2ContactPoint,
      h = Box2D.Collision.b2Distance,
      p = Box2D.Collision.b2DistanceInput,
      y = Box2D.Collision.b2DistanceOutput,
      u = Box2D.Collision.b2DistanceProxy,
      x = Box2D.Collision.b2DynamicTree,
      f = Box2D.Collision.b2DynamicTreeBroadPhase,
      b = Box2D.Collision.b2DynamicTreeNode,
      d = Box2D.Collision.b2DynamicTreePair,
      B = Box2D.Collision.b2Manifold,
      D = Box2D.Collision.b2ManifoldPoint,
      C = Box2D.Collision.b2Point,
      A = Box2D.Collision.b2RayCastInput,
      S = (Box2D.Collision.b2RayCastOutput, Box2D.Collision.b2Segment),
      w = Box2D.Collision.b2SeparationFunction,
      g = Box2D.Collision.b2Simplex,
      M = Box2D.Collision.b2SimplexCache,
      V = Box2D.Collision.b2SimplexVertex,
      I = Box2D.Collision.b2TimeOfImpact,
      L = Box2D.Collision.b2TOIInput,
      J = Box2D.Collision.b2WorldManifold,
      G = Box2D.Collision.ClipVertex,
      R = Box2D.Collision.Features,
      P = Box2D.Collision.IBroadPhase;
    (l.prototype.IsValid = function () {
      let t = this.upperBound.x - this.lowerBound.x,
        i = this.upperBound.y - this.lowerBound.y,
        o = t >= 0 && i >= 0;
      return (o = o && this.lowerBound.IsValid() && this.upperBound.IsValid());
    }),
      (l.prototype.GetCenter = function () {
        return new s(
          (this.lowerBound.x + this.upperBound.x) / 2,
          (this.lowerBound.y + this.upperBound.y) / 2
        );
      }),
      (l.prototype.GetExtents = function () {
        return new s(
          (this.upperBound.x - this.lowerBound.x) / 2,
          (this.upperBound.y - this.lowerBound.y) / 2
        );
      }),
      (l.prototype.Contains = function (t) {
        let i = !0;
        return (i =
          (i =
            (i =
              (i = i && this.lowerBound.x <= t.lowerBound.x) &&
              this.lowerBound.y <= t.lowerBound.y) && t.upperBound.x <= this.upperBound.x) &&
          t.upperBound.y <= this.upperBound.y);
      }),
      (l.prototype.RayCast = function (t, i) {
        let o = -Number.MAX_VALUE,
          e = Number.MAX_VALUE,
          n = i.p1.x,
          s = i.p1.y,
          l = i.p2.x - i.p1.x,
          m = i.p2.y - i.p1.y,
          r = Math.abs(l),
          a = Math.abs(m),
          c = t.normal,
          _ = 0,
          h = 0,
          p = 0,
          y = 0,
          u = 0;
        if (r < Number.MIN_VALUE) {
          if (n < this.lowerBound.x || this.upperBound.x < n) return !1;
        } else if (
          ((_ = 1 / l),
          (u = -1),
          (h = (this.lowerBound.x - n) * _) > (p = (this.upperBound.x - n) * _) &&
            ((y = h), (h = p), (p = y), (u = 1)),
          h > o && ((c.x = u), (c.y = 0), (o = h)),
          o > (e = Math.min(e, p)))
        )
          return !1;
        if (a < Number.MIN_VALUE) {
          if (s < this.lowerBound.y || this.upperBound.y < s) return !1;
        } else if (
          ((_ = 1 / m),
          (u = -1),
          (h = (this.lowerBound.y - s) * _) > (p = (this.upperBound.y - s) * _) &&
            ((y = h), (h = p), (p = y), (u = 1)),
          h > o && ((c.y = u), (c.x = 0), (o = h)),
          o > (e = Math.min(e, p)))
        )
          return !1;
        return (t.fraction = o), !0;
      }),
      (l.prototype.TestOverlap = function (t) {
        let i = t.lowerBound.x - this.upperBound.x,
          o = t.lowerBound.y - this.upperBound.y,
          e = this.lowerBound.x - t.upperBound.x,
          n = this.lowerBound.y - t.upperBound.y;
        return !(i > 0 || o > 0) && !(e > 0 || n > 0);
      }),
      (l.Combine = function (t, i) {
        let o = new l();
        return o.Combine(t, i), o;
      }),
      (l.prototype.Combine = function (t, i) {
        (this.lowerBound.x = Math.min(t.lowerBound.x, i.lowerBound.x)),
          (this.lowerBound.y = Math.min(t.lowerBound.y, i.lowerBound.y)),
          (this.upperBound.x = Math.max(t.upperBound.x, i.upperBound.x)),
          (this.upperBound.y = Math.max(t.upperBound.y, i.upperBound.y));
      }),
      (l.prototype.Free = function () {}),
      (m.b2Bound = function () {}),
      (m.prototype.IsLower = function () {
        return 0 == (1 & this.value);
      }),
      (m.prototype.IsUpper = function () {
        return 1 == (1 & this.value);
      }),
      (m.prototype.Swap = function (t) {
        let i = this.value,
          o = this.proxy,
          e = this.stabbingCount;
        (this.value = t.value),
          (this.proxy = t.proxy),
          (this.stabbingCount = t.stabbingCount),
          (t.value = i),
          (t.proxy = o),
          (t.stabbingCount = e);
      }),
      (r.b2BoundValues = function () {}),
      (r.prototype.b2BoundValues = function () {
        (this.lowerValues = [0, 0]), (this.upperValues = [0, 0]);
      }),
      (a.b2Collision = function () {}),
      (a.ClipSegmentToLine = function (t, i, o, e) {
        let n = 0,
          s = i[0],
          l = s.v,
          m = (s = i[1]).v,
          r = o.x * l.x + o.y * l.y - e,
          a = o.x * m.x + o.y * m.y - e;
        if ((r <= 0 && t[n++].Set(i[0]), a <= 0 && t[n++].Set(i[1]), r * a < 0)) {
          let o,
            e = r / (r - a),
            c = (s = t[n]).v;
          (c.x = l.x + e * (m.x - l.x)),
            (c.y = l.y + e * (m.y - l.y)),
            (s = t[n]),
            r > 0 ? ((o = i[0]), (s.id = o.id)) : ((o = i[1]), (s.id = o.id)),
            ++n;
        }
        return n;
      }),
      (a.EdgeSeparation = function (t, i, o, e, n) {
        let s = e.m_vertices,
          l = i.R,
          m = t.m_normals[o],
          r = l.col1.x * m.x + l.col2.x * m.y,
          a = l.col1.y * m.x + l.col2.y * m.y,
          c = (l = n.R).col1.x * r + l.col1.y * a,
          _ = l.col2.x * r + l.col2.y * a,
          h = 0,
          p = Number.MAX_VALUE,
          y = e.m_vertexCount;
        for (; y > 0; ) {
          let t = (m = s[--y]).x * c + m.y * _;
          t < p && ((p = t), (h = y));
        }
        (m = t.m_vertices[o]), (l = i.R);
        let u = i.position.x + (l.col1.x * m.x + l.col2.x * m.y),
          x = i.position.y + (l.col1.y * m.x + l.col2.y * m.y);
        return (
          (m = s[h]),
          (l = n.R),
          (n.position.x + (l.col1.x * m.x + l.col2.x * m.y) - u) * r +
            (n.position.y + (l.col1.y * m.x + l.col2.y * m.y) - x) * a
        );
      }),
      (a.FindMaxSeparation = function (t, i, o, e, n) {
        let s = i.m_vertexCount,
          l = i.m_normals,
          m = n.R,
          r = e.m_centroid,
          c = n.position.x + (m.col1.x * r.x + m.col2.x * r.y),
          _ = n.position.y + (m.col1.y * r.x + m.col2.y * r.y);
        (m = o.R),
          (r = i.m_centroid),
          (c -= o.position.x + (m.col1.x * r.x + m.col2.x * r.y)),
          (_ -= o.position.y + (m.col1.y * r.x + m.col2.y * r.y));
        let h = c * o.R.col1.x + _ * o.R.col1.y,
          p = c * o.R.col2.x + _ * o.R.col2.y,
          y = 0,
          u = -Number.MAX_VALUE,
          x = s;
        for (; x > 0; ) {
          let t = (r = l[--x]).x * h + r.y * p;
          t > u && ((u = t), (y = x));
        }
        let f = a.EdgeSeparation(i, o, y, e, n),
          b = y - 1 >= 0 ? y - 1 : s - 1,
          d = a.EdgeSeparation(i, o, b, e, n),
          B = y + 1 < s ? y + 1 : 0,
          D = a.EdgeSeparation(i, o, B, e, n),
          C = 0,
          A = 0,
          S = 0;
        if (d > f && d > D) (S = -1), (C = b), (A = d);
        else {
          if (!(D > f)) return (t[0] = y), f;
          (S = 1), (C = B), (A = D);
        }
        for (
          ;
          (y = -1 === S ? (C - 1 >= 0 ? C - 1 : s - 1) : C + 1 < s ? C + 1 : 0),
            (f = a.EdgeSeparation(i, o, y, e, n)) > A;

        )
          (C = y), (A = f);
        return (t[0] = C), A;
      }),
      (a.FindIncidentEdge = function (t, i, o, e, n, s) {
        let l = n.m_normals,
          m = o.R,
          r = i.m_normals[e],
          a = m.col1.x * r.x + m.col2.x * r.y,
          c = m.col1.y * r.x + m.col2.y * r.y,
          _ = (m = s.R).col1.x * a + m.col1.y * c;
        (c = m.col2.x * a + m.col2.y * c), (a = _);
        let h = 0,
          p = Number.MAX_VALUE,
          y = n.m_vertexCount;
        for (; y > 0; ) {
          let t = a * (r = l[--y]).x + c * r.y;
          t < p && ((p = t), (h = y));
        }
        let u = h + 1 < n.m_vertexCount ? h + 1 : 0,
          x = t[0];
        (r = n.m_vertices[h]),
          (m = s.R),
          (x.v.x = s.position.x + (m.col1.x * r.x + m.col2.x * r.y)),
          (x.v.y = s.position.y + (m.col1.y * r.x + m.col2.y * r.y)),
          (x.id.features.referenceEdge = e),
          (x.id.features.incidentEdge = h),
          (x.id.features.incidentVertex = 0),
          (x = t[1]),
          (r = n.m_vertices[u]),
          (m = s.R),
          (x.v.x = s.position.x + (m.col1.x * r.x + m.col2.x * r.y)),
          (x.v.y = s.position.y + (m.col1.y * r.x + m.col2.y * r.y)),
          (x.id.features.referenceEdge = e),
          (x.id.features.incidentEdge = u),
          (x.id.features.incidentVertex = 1);
      }),
      (a.MakeClipPointVector = function () {
        return [new G(), new G()];
      }),
      (a.CollidePolygons = function (t, o, e, n, s) {
        let l;
        t.m_pointCount = 0;
        let m = o.m_radius + n.m_radius,
          r = 0;
        a.s_edgeAO[0] = r;
        let c = a.FindMaxSeparation(a.s_edgeAO, o, e, n, s);
        if (((r = a.s_edgeAO[0]), c > m)) return;
        let _ = 0;
        a.s_edgeBO[0] = _;
        let h,
          p,
          y,
          u,
          x = a.FindMaxSeparation(a.s_edgeBO, n, s, o, e);
        if (((_ = a.s_edgeBO[0]), x > m)) return;
        let f = 0,
          b = 0;
        x > 0.98 * c + 0.001
          ? ((h = n), (p = o), (y = s), (u = e), (f = _), (t.m_type = B.e_faceB), (b = 1))
          : ((h = o), (p = n), (y = e), (u = s), (f = r), (t.m_type = B.e_faceA), (b = 0));
        let d = a.s_incidentEdge;
        a.FindIncidentEdge(d, h, y, f, p, u);
        let D,
          C = h.m_vertexCount,
          A = h.m_vertices,
          S = A[f];
        D = f + 1 < C ? A[f + 1] : A[0];
        let w = a.s_localTangent;
        w.Set(D.x - S.x, D.y - S.y), w.Normalize();
        let v = a.s_localNormal;
        (v.x = w.y), (v.y = -w.x);
        let g = a.s_planePoint;
        g.Set(0.5 * (S.x + D.x), 0.5 * (S.y + D.y));
        let M = a.s_tangent,
          V = y.R;
        (M.x = V.col1.x * w.x + V.col2.x * w.y), (M.y = V.col1.y * w.x + V.col2.y * w.y);
        let I = a.s_tangent2;
        (I.x = -M.x), (I.y = -M.y);
        let L = a.s_normal;
        (L.x = M.y), (L.y = -M.x);
        let J = a.s_v11,
          G = a.s_v12;
        (J.x = y.position.x + (V.col1.x * S.x + V.col2.x * S.y)),
          (J.y = y.position.y + (V.col1.y * S.x + V.col2.y * S.y)),
          (G.x = y.position.x + (V.col1.x * D.x + V.col2.x * D.y)),
          (G.y = y.position.y + (V.col1.y * D.x + V.col2.y * D.y));
        let R = a.s_clipPoints2,
          P = 0;
        if ((P = a.ClipSegmentToLine(a.s_clipPoints1, d, I, -M.x * J.x - M.y * J.y + m)) < 2)
          return;
        if ((P = a.ClipSegmentToLine(R, a.s_clipPoints1, M, M.x * G.x + M.y * G.y + m)) < 2) return;
        t.m_localPlaneNormal.SetV(v), t.m_localPoint.SetV(g);
        let F = 0;
        for (let o = 0; o < i.b2_maxManifoldPoints; ++o) {
          if (((l = R[o]), L.x * l.v.x + L.y * l.v.y - (L.x * J.x + L.y * J.y) <= m)) {
            let i = t.m_points[F];
            V = u.R;
            let o = l.v.x - u.position.x,
              e = l.v.y - u.position.y;
            (i.m_localPoint.x = o * V.col1.x + e * V.col1.y),
              (i.m_localPoint.y = o * V.col2.x + e * V.col2.y),
              i.m_id.Set(l.id),
              (i.m_id.features.flip = b),
              ++F;
          }
        }
        t.m_pointCount = F;
      }),
      (a.CollideCircles = function (t, i, o, e, n) {
        let s = o.R,
          l = i.m_p,
          m = o.position.x + (s.col1.x * l.x + s.col2.x * l.y),
          r = o.position.y + (s.col1.y * l.x + s.col2.y * l.y);
        (s = n.R), (l = e.m_p);
        let a = n.position.x + (s.col1.x * l.x + s.col2.x * l.y) - m,
          c = n.position.y + (s.col1.y * l.x + s.col2.y * l.y) - r,
          _ = a * a + c * c,
          h = i.m_radius + e.m_radius;
        _ > h * h
          ? (t.m_pointCount = 0)
          : ((t.m_type = B.e_circles),
            t.m_localPoint.SetV(i.m_p),
            t.m_localPlaneNormal.SetZero(),
            (t.m_pointCount = 1),
            t.m_points[0].m_localPoint.SetV(e.m_p),
            (t.m_points[0].m_id.key = 0));
      }),
      (a.CollidePolygonAndCircle = function (t, i, o, e, n) {
        t.m_pointCount = 0;
        let s = n.R,
          l = e.m_p,
          m = n.position.x + (s.col1.x * l.x + s.col2.x * l.y),
          r = n.position.y + (s.col1.y * l.x + s.col2.y * l.y),
          a = m - o.position.x,
          c = r - o.position.y,
          _ = a * (s = o.R).col1.x + c * s.col1.y,
          h = a * s.col2.x + c * s.col2.y,
          p = 0,
          y = -Number.MAX_VALUE,
          u = i.m_radius + e.m_radius,
          x = i.m_vertexCount,
          f = i.m_vertices,
          b = i.m_normals;
        for (let t = 0; t < x; ++t) {
          (a = _ - (l = f[t]).x), (c = h - l.y);
          let i = (l = b[t]).x * a + l.y * c;
          if (i > u) return;
          i > y && ((y = i), (p = t));
        }
        let d = p,
          D = d + 1 < x ? d + 1 : 0,
          C = f[d],
          A = f[D];
        if (y < Number.MIN_VALUE)
          return (
            (t.m_pointCount = 1),
            (t.m_type = B.e_faceA),
            t.m_localPlaneNormal.SetV(b[p]),
            (t.m_localPoint.x = 0.5 * (C.x + A.x)),
            (t.m_localPoint.y = 0.5 * (C.y + A.y)),
            t.m_points[0].m_localPoint.SetV(e.m_p),
            void (t.m_points[0].m_id.key = 0)
          );
        let S = (_ - C.x) * (A.x - C.x) + (h - C.y) * (A.y - C.y),
          w = (_ - A.x) * (C.x - A.x) + (h - A.y) * (C.y - A.y);
        if (S <= 0) {
          if ((_ - C.x) * (_ - C.x) + (h - C.y) * (h - C.y) > u * u) return;
          (t.m_pointCount = 1),
            (t.m_type = B.e_faceA),
            (t.m_localPlaneNormal.x = _ - C.x),
            (t.m_localPlaneNormal.y = h - C.y),
            t.m_localPlaneNormal.Normalize(),
            t.m_localPoint.SetV(C),
            t.m_points[0].m_localPoint.SetV(e.m_p),
            (t.m_points[0].m_id.key = 0);
        } else if (w <= 0) {
          if ((_ - A.x) * (_ - A.x) + (h - A.y) * (h - A.y) > u * u) return;
          (t.m_pointCount = 1),
            (t.m_type = B.e_faceA),
            (t.m_localPlaneNormal.x = _ - A.x),
            (t.m_localPlaneNormal.y = h - A.y),
            t.m_localPlaneNormal.Normalize(),
            t.m_localPoint.SetV(A),
            t.m_points[0].m_localPoint.SetV(e.m_p),
            (t.m_points[0].m_id.key = 0);
        } else {
          let i = 0.5 * (C.x + A.x),
            o = 0.5 * (C.y + A.y);
          if ((y = (_ - i) * b[d].x + (h - o) * b[d].y) > u) return;
          (t.m_pointCount = 1),
            (t.m_type = B.e_faceA),
            (t.m_localPlaneNormal.x = b[d].x),
            (t.m_localPlaneNormal.y = b[d].y),
            t.m_localPlaneNormal.Normalize(),
            t.m_localPoint.Set(i, o),
            t.m_points[0].m_localPoint.SetV(e.m_p),
            (t.m_points[0].m_id.key = 0);
        }
      }),
      (a.TestOverlap = function (t, i) {
        let o = i.lowerBound,
          e = t.upperBound,
          n = o.x - e.x,
          s = o.y - e.y;
        (o = t.lowerBound), (e = i.upperBound);
        let l = o.x - e.x,
          m = o.y - e.y;
        return !(n > 0 || s > 0) && !(l > 0 || m > 0);
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Collision.b2Collision.s_incidentEdge = a.MakeClipPointVector()),
          (Box2D.Collision.b2Collision.s_clipPoints1 = a.MakeClipPointVector()),
          (Box2D.Collision.b2Collision.s_clipPoints2 = a.MakeClipPointVector()),
          (Box2D.Collision.b2Collision.s_edgeAO = [0]),
          (Box2D.Collision.b2Collision.s_edgeBO = [0]),
          (Box2D.Collision.b2Collision.s_localTangent = new s()),
          (Box2D.Collision.b2Collision.s_localNormal = new s()),
          (Box2D.Collision.b2Collision.s_planePoint = new s()),
          (Box2D.Collision.b2Collision.s_normal = new s()),
          (Box2D.Collision.b2Collision.s_tangent = new s()),
          (Box2D.Collision.b2Collision.s_tangent2 = new s()),
          (Box2D.Collision.b2Collision.s_v11 = new s()),
          (Box2D.Collision.b2Collision.s_v12 = new s()),
          (Box2D.Collision.b2Collision.b2CollidePolyTempVec = new s()),
          (Box2D.Collision.b2Collision.b2_nullFeature = 255);
      }),
      (c.prototype.b2ContactID = function () {
        this.features._m_id = this;
      }),
      (c.prototype.Set = function (t) {
        this.key = t._key;
      }),
      (c.prototype.Copy = function () {
        let t = new c();
        return (t.key = this.key), t;
      }),
      Object.defineProperty(c.prototype, "key", {
        enumerable: !1,
        configurable: !0,
        get: function () {
          return this._key;
        },
      }),
      Object.defineProperty(c.prototype, "key", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          (this._key = t),
            (this.features._referenceEdge = 255 & this._key),
            (this.features._incidentEdge = ((65280 & this._key) >> 8) & 255),
            (this.features._incidentVertex = ((16711680 & this._key) >> 16) & 255),
            (this.features._flip = ((4278190080 & this._key) >> 24) & 255);
        },
      }),
      (_.b2ContactPoint = function () {
        (this.position = new s()),
          (this.velocity = new s()),
          (this.normal = new s()),
          (this.id = new c());
      }),
      (h.b2Distance = function () {}),
      (h.Distance = function (t, i, e) {
        let n = e.proxyA,
          l = e.proxyB,
          m = e.transformA,
          r = e.transformB,
          a = h.s_simplex;
        a.ReadCache(i, n, m, l, r);
        let c = a.m_vertices,
          _ = h.s_saveA,
          p = h.s_saveB,
          y = 0,
          u = 0,
          x = 0;
        for (; x < 20; ) {
          for (y = a.m_count, u = 0; u < y; u++) (_[u] = c[u].indexA), (p[u] = c[u].indexB);
          switch (a.m_count) {
            case 1:
              break;
            case 2:
              a.Solve2();
              break;
            case 3:
              a.Solve3();
          }
          if (3 === a.m_count) break;
          let t = a.GetSearchDirection();
          if (t.LengthSquared() < Number.MIN_VALUE * Number.MIN_VALUE) break;
          let i = c[a.m_count],
            e = new s(-t.x, -t.y),
            h = o.MulTMV(m.R, e);
          if (
            ((i.indexA = n.GetSupport(h)),
            (h = o.MulTMV(r.R, t)),
            (i.indexB = l.GetSupport(h)),
            void 0 !== i.w)
          ) {
            let t = n.GetVertex(i.indexA);
            (i.wA.x = m.R.col1.x * t.x + m.R.col2.x * t.y + m.position.x),
              (i.wA.y = m.R.col1.y * t.x + m.R.col2.y * t.y + m.position.y);
            let o = l.GetVertex(i.indexB);
            (i.wB.x = r.R.col1.x * o.x + r.R.col2.x * o.y + r.position.x),
              (i.wB.y = r.R.col1.y * o.x + r.R.col2.y * o.y + r.position.y),
              (i.w.x = i.wB.x - i.wA.x),
              (i.w.y = i.wB.y - i.wA.y);
          } else
            (i.wA = o.MulX(m, n.GetVertex(i.indexA))),
              (i.wB = o.MulX(r, l.GetVertex(i.indexB))),
              (i.w = o.SubtractVV(i.wB, i.wA));
          ++x;
          let f = !1;
          for (u = 0; u < y; u++)
            if (i.indexA === _[u] && i.indexB === p[u]) {
              f = !0;
              break;
            }
          if (f) break;
          ++a.m_count;
        }
        (h.b2_gjkMaxIters = o.Max(h.b2_gjkMaxIters, x)), a.GetWitnessPoints(t.pointA, t.pointB);
        let f = o.SubtractVV(t.pointA, t.pointB);
        if (((t.distance = f.Length()), (t.iterations = x), a.WriteCache(i), e.useRadii)) {
          let i = n.m_radius,
            e = l.m_radius;
          if (t.distance > i + e && t.distance > Number.MIN_VALUE) {
            t.distance -= i + e;
            let n = o.SubtractVV(t.pointB, t.pointA);
            n.Normalize(),
              (t.pointA.x += i * n.x),
              (t.pointA.y += i * n.y),
              (t.pointB.x -= e * n.x),
              (t.pointB.y -= e * n.y);
          } else {
            let i = new s(0.5 * (t.pointA.x + t.pointB.x), 0.5 * (t.pointA.y + t.pointB.y));
            (t.pointA.x = t.pointB.x = i.x), (t.pointA.y = t.pointB.y = i.y), (t.distance = 0);
          }
        }
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Collision.b2Distance.s_simplex = new g()),
          (Box2D.Collision.b2Distance.s_saveA = [0, 0, 0]),
          (Box2D.Collision.b2Distance.s_saveB = [0, 0, 0]);
      }),
      (p.b2DistanceInput = function () {}),
      (y.b2DistanceOutput = function () {
        (this.pointA = new s()), (this.pointB = new s());
      }),
      (u.prototype.Set = function (i) {
        switch (i.GetType()) {
          case t.e_circleShape:
            (this.m_vertices = [i.m_p, !0]), (this.m_count = 1), (this.m_radius = i.m_radius);
            break;
          case t.e_polygonShape:
            (this.m_vertices = i.m_vertices),
              (this.m_count = i.m_vertexCount),
              (this.m_radius = i.m_radius);
        }
      }),
      (u.prototype.GetSupport = function (t) {
        let i = 0,
          o = this.m_vertices[0].x * t.x + this.m_vertices[0].y * t.y;
        for (let e = 1; e < this.m_count; ++e) {
          let n = this.m_vertices[e].x * t.x + this.m_vertices[e].y * t.y;
          n > o && ((i = e), (o = n));
        }
        return i;
      }),
      (u.prototype.GetSupportVertex = function (t) {
        let i = 0,
          o = this.m_vertices[0].x * t.x + this.m_vertices[0].y * t.y;
        for (let e = 1; e < this.m_count; ++e) {
          let n = this.m_vertices[e].x * t.x + this.m_vertices[e].y * t.y;
          n > o && ((i = e), (o = n));
        }
        return this.m_vertices[i];
      }),
      (u.prototype.GetVertexCount = function () {
        return this.m_count;
      }),
      (u.prototype.GetVertex = function (t) {
        return this.m_vertices[t];
      }),
      (x.b2DynamicTree = function () {}),
      (x.prototype.b2DynamicTree = function () {
        (this.m_root = null),
          (this.m_freeList = null),
          (this.m_path = 0),
          (this.m_insertionCount = 0);
      }),
      (x.prototype.CreateProxy = function (t, o) {
        let e = this.AllocateNode(),
          n = i.b2_aabbExtension,
          s = i.b2_aabbExtension;
        return (
          (e.aabb.lowerBound.x = t.lowerBound.x - n),
          (e.aabb.lowerBound.y = t.lowerBound.y - s),
          (e.aabb.upperBound.x = t.upperBound.x + n),
          (e.aabb.upperBound.y = t.upperBound.y + s),
          (e.userData = o),
          this.InsertLeaf(e),
          e
        );
      }),
      (x.prototype.DestroyProxy = function (t) {
        this.RemoveLeaf(t), this.FreeNode(t);
      }),
      (x.prototype.MoveProxy = function (t, o, e) {
        if (t.aabb.Contains(o)) return !1;
        this.RemoveLeaf(t);
        let n = i.b2_aabbExtension + i.b2_aabbMultiplier * (e.x > 0 ? e.x : -e.x),
          s = i.b2_aabbExtension + i.b2_aabbMultiplier * (e.y > 0 ? e.y : -e.y);
        return (
          (t.aabb.lowerBound.x = o.lowerBound.x - n),
          (t.aabb.lowerBound.y = o.lowerBound.y - s),
          (t.aabb.upperBound.x = o.upperBound.x + n),
          (t.aabb.upperBound.y = o.upperBound.y + s),
          this.InsertLeaf(t),
          !0
        );
      }),
      (x.prototype.Rebalance = function (t) {
        if (null !== this.m_root)
          for (let i = 0; i < t; i++) {
            let t = this.m_root,
              i = 0;
            for (; !1 === t.IsLeaf(); )
              (t = (this.m_path >> i) & 1 ? t.child2 : t.child1), (i = (i + 1) & 31);
            ++this.m_path, this.RemoveLeaf(t), this.InsertLeaf(t);
          }
      }),
      (x.prototype.GetFatAABB = function (t) {
        return t.aabb;
      }),
      (x.prototype.GetUserData = function (t) {
        return t.userData;
      }),
      (x.prototype.Query = function (t, i, o, e) {
        if (null === this.m_root) return;
        let n = [this.m_root],
          s = 1;
        for (; s > 0; ) {
          let l = n[--s];
          if (l.aabb.TestOverlap(i))
            if (l.IsLeaf()) {
              if (!t(l, o, e)) return;
            } else (n[s++] = l.child1), (n[s++] = l.child2);
        }
      }),
      (x.prototype.RayCast = function (t, i) {
        let e = i.p1,
          n = i.p2,
          s = o.SubtractVV(e, n);
        s.Normalize();
        let m = o.CrossFV(1, s),
          r = o.AbsV(m),
          a = i.maxFraction,
          c = new l(),
          _ = 0,
          h = 0;
        (_ = e.x + a * (n.x - e.x)),
          (h = e.y + a * (n.y - e.y)),
          (c.lowerBound.x = Math.min(e.x, _)),
          (c.lowerBound.y = Math.min(e.y, h)),
          (c.upperBound.x = Math.max(e.x, _)),
          (c.upperBound.y = Math.max(e.y, h));
        let p = [this.m_root],
          y = 1;
        for (; y > 0; ) {
          let o = p[--y];
          if (!o) continue;
          if (!o.aabb.TestOverlap(c)) continue;
          let s = o.aabb.GetCenter(),
            l = o.aabb.GetExtents();
          if (!(Math.abs(m.x * (e.x - s.x) + m.y * (e.y - s.y)) - r.x * l.x - r.y * l.y > 0))
            if (o.IsLeaf()) {
              let s = new A();
              (s.p1 = i.p1), (s.p2 = i.p2), (s.maxFraction = a);
              let l = t(s, o);
              if (0 === l) return;
              l > 0 &&
                ((a = l),
                (_ = e.x + a * (n.x - e.x)),
                (h = e.y + a * (n.y - e.y)),
                (c.lowerBound.x = Math.min(e.x, _)),
                (c.lowerBound.y = Math.min(e.y, h)),
                (c.upperBound.x = Math.max(e.x, _)),
                (c.upperBound.y = Math.max(e.y, h)));
            } else (p[y++] = o.child1), (p[y++] = o.child2);
        }
      }),
      (x.prototype.AllocateNode = function () {
        if (this.m_freeList) {
          let t = this.m_freeList;
          return (
            (this.m_freeList = t.parent), (t.parent = null), (t.child1 = null), (t.child2 = null), t
          );
        }
        return new b();
      }),
      (x.prototype.FreeNode = function (t) {
        (t.parent = this.m_freeList), (this.m_freeList = t);
      }),
      (x.prototype.InsertLeaf = function (t) {
        if ((++this.m_insertionCount, null == this.m_root))
          return (this.m_root = t), void (this.m_root.parent = null);
        let i = t.aabb.GetCenter(),
          o = this.m_root;
        if (!1 === o.IsLeaf())
          do {
            let t = o.child1,
              e = o.child2;
            o =
              Math.abs((t.aabb.lowerBound.x + t.aabb.upperBound.x) / 2 - i.x) +
                Math.abs((t.aabb.lowerBound.y + t.aabb.upperBound.y) / 2 - i.y) <
              Math.abs((e.aabb.lowerBound.x + e.aabb.upperBound.x) / 2 - i.x) +
                Math.abs((e.aabb.lowerBound.y + e.aabb.upperBound.y) / 2 - i.y)
                ? t
                : e;
          } while (!1 === o.IsLeaf());
        let e = o.parent,
          n = this.AllocateNode();
        if (((n.parent = e), (n.userData = null), n.aabb.Combine(t.aabb, o.aabb), e)) {
          o.parent.child1 === o ? (e.child1 = n) : (e.child2 = n),
            (n.child1 = o),
            (n.child2 = t),
            (o.parent = n),
            (t.parent = n);
          do {
            if (e.aabb.Contains(n.aabb)) break;
            e.aabb.Combine(e.child1.aabb, e.child2.aabb), (n = e), (e = e.parent);
          } while (e);
        } else (n.child1 = o), (n.child2 = t), (o.parent = n), (t.parent = n), (this.m_root = n);
      }),
      (x.prototype.RemoveLeaf = function (t) {
        if (t === this.m_root) return void (this.m_root = null);
        let i,
          o = t.parent,
          e = o.parent;
        if (((i = o.child1 === t ? o.child2 : o.child1), e))
          for (
            e.child1 === o ? (e.child1 = i) : (e.child2 = i), i.parent = e, this.FreeNode(o);
            e;

          ) {
            let t = e.aabb;
            if (((e.aabb = l.Combine(e.child1.aabb, e.child2.aabb)), t.Contains(e.aabb))) break;
            e = e.parent;
          }
        else (this.m_root = i), (i.parent = null), this.FreeNode(o);
      }),
      (f.b2DynamicTreeBroadPhase = function () {
        (this.m_tree = new x()),
          (this.m_moveBuffer = []),
          (this.m_pairBuffer = []),
          (this.m_pairCount = 0),
          (this.m_proxyCount = 0);
      }),
      (f.prototype.CreateProxy = function (t, i) {
        let o = this.m_tree.CreateProxy(t, i);
        return ++this.m_proxyCount, this.BufferMove(o), o;
      }),
      (f.prototype.DestroyProxy = function (t) {
        this.UnBufferMove(t), --this.m_proxyCount, this.m_tree.DestroyProxy(t);
      }),
      (f.prototype.MoveProxy = function (t, i, o) {
        this.m_tree.MoveProxy(t, i, o) && this.BufferMove(t);
      }),
      (f.prototype.TestOverlap = function (t, i) {
        let o = this.m_tree.GetFatAABB(t),
          e = this.m_tree.GetFatAABB(i);
        return o.TestOverlap(e);
      }),
      (f.prototype.GetUserData = function (t) {
        return this.m_tree.GetUserData(t);
      }),
      (f.prototype.GetFatAABB = function (t) {
        return this.m_tree.GetFatAABB(t);
      }),
      (f.prototype.GetProxyCount = function () {
        return this.m_proxyCount;
      }),
      (f.prototype.QueryCallback = function (t, i, o) {
        if (t === i) return !0;
        o.m_pairCount === o.m_pairBuffer.length && (o.m_pairBuffer[o.m_pairCount] = new d());
        let e = o.m_pairBuffer[o.m_pairCount];
        return (e.proxyA = i), (e.proxyB = t), ++o.m_pairCount, !0;
      }),
      (f.prototype.UpdatePairs = function (t) {
        this.m_pairCount = 0;
        for (let t = 0, i = this.m_moveBuffer.length; t < i; ++t) {
          let i = this.m_moveBuffer[t];
          this.m_tree.Query(this.QueryCallback, this.m_tree.GetFatAABB(i), i, this);
        }
        this.m_moveBuffer.length = 0;
        for (let i = 0; i < this.m_pairCount; ) {
          let o = this.m_pairBuffer[i];
          for (
            t.AddPair(this.m_tree.GetUserData(o.proxyA), this.m_tree.GetUserData(o.proxyB)), ++i;
            i < this.m_pairCount &&
            this.m_pairBuffer[i].proxyA === o.proxyA &&
            this.m_pairBuffer[i].proxyB === o.proxyB;

          )
            ++i;
        }
      }),
      (f.prototype.Query = function (t, i, o) {
        this.m_tree.Query(t, i, o);
      }),
      (f.prototype.RayCast = function (t, i) {
        this.m_tree.RayCast(t, i);
      }),
      (f.prototype.Validate = function () {}),
      (f.prototype.Rebalance = function (t) {
        this.m_tree.Rebalance(t);
      }),
      (f.prototype.BufferMove = function (t) {
        this.m_moveBuffer[this.m_moveBuffer.length] = t;
      }),
      (f.prototype.UnBufferMove = function (t) {
        for (let i = 0, o = this.m_moveBuffer.length; i < o; i++)
          this.m_moveBuffer[i] === t && this.m_moveBuffer.splice(i--, 1);
      }),
      (f.__implements = {}),
      (f.__implements[P] = !0),
      (b.b2DynamicTreeNode = function () {
        this.aabb = new l();
      }),
      (b.prototype.IsLeaf = function () {
        return null == this.child1;
      }),
      (d.b2DynamicTreePair = function () {}),
      (B.prototype.b2Manifold = function () {
        (this.m_points = [new D(), new D()]),
          (this.m_localPlaneNormal = new s()),
          (this.m_localPoint = new s());
      }),
      (B.prototype.Reset = function () {
        for (let t = 0; t < i.b2_maxManifoldPoints; t++)
          (this.m_points[t] instanceof D ? this.m_points[t] : null).Reset();
        this.m_localPlaneNormal.SetZero(),
          this.m_localPoint.SetZero(),
          (this.m_type = 0),
          (this.m_pointCount = 0);
      }),
      (B.prototype.Set = function (t) {
        this.m_pointCount = t.m_pointCount;
        for (let o = 0; o < i.b2_maxManifoldPoints; o++)
          (this.m_points[o] instanceof D ? this.m_points[o] : null).Set(t.m_points[o]);
        this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),
          this.m_localPoint.SetV(t.m_localPoint),
          (this.m_type = t.m_type);
      }),
      (B.prototype.Copy = function () {
        let t = new B();
        return t.Set(this), t;
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Collision.b2Manifold.e_circles = 1),
          (Box2D.Collision.b2Manifold.e_faceA = 2),
          (Box2D.Collision.b2Manifold.e_faceB = 4);
      }),
      (D.b2ManifoldPoint = function () {
        (this.m_localPoint = new s()), (this.m_id = new c());
      }),
      (D.prototype.b2ManifoldPoint = function () {
        this.Reset();
      }),
      (D.prototype.Reset = function () {
        this.m_localPoint.SetZero(),
          (this.m_normalImpulse = 0),
          (this.m_tangentImpulse = 0),
          (this.m_id.key = 0);
      }),
      (D.prototype.Set = function (t) {
        this.m_localPoint.SetV(t.m_localPoint),
          (this.m_normalImpulse = t.m_normalImpulse),
          (this.m_tangentImpulse = t.m_tangentImpulse),
          this.m_id.Set(t.m_id);
      }),
      (C.b2Point = function () {
        this.p = new s();
      }),
      (C.prototype.Support = function (t, i, o) {
        return void 0 === i && (i = 0), void 0 === o && (o = 0), this.p;
      }),
      (C.prototype.GetFirstVertex = function (t) {
        return this.p;
      }),
      (A.prototype.b2RayCastInput = function (t, i, o) {
        void 0 === o && (o = 1), t && this.p1.SetV(t), i && this.p2.SetV(i), (this.maxFraction = o);
      }),
      (S.b2Segment = function () {
        (this.p1 = new s()), (this.p2 = new s());
      }),
      (S.prototype.TestSegment = function (t, i, o, e) {
        let n = o.p1,
          s = o.p2.x - n.x,
          l = o.p2.y - n.y,
          m = this.p2.x - this.p1.x,
          r = this.p2.y - this.p1.y,
          a = -m,
          c = 100 * Number.MIN_VALUE,
          _ = -(s * r + l * a);
        if (_ > c) {
          let o = n.x - this.p1.x,
            m = n.y - this.p1.y,
            h = o * r + m * a;
          if (0 <= h && h <= e * _) {
            let e = -s * m + l * o;
            if (-c * _ <= e && e <= _ * (1 + c)) {
              h /= _;
              let o = Math.sqrt(r * r + a * a);
              return (r /= o), (a /= o), (t[0] = h), i.Set(r, a), !0;
            }
          }
        }
        return !1;
      }),
      (S.prototype.Extend = function (t) {
        this.ExtendForward(t), this.ExtendBackward(t);
      }),
      (S.prototype.ExtendForward = function (t) {
        let i = this.p2.x - this.p1.x,
          o = this.p2.y - this.p1.y,
          e = Math.min(
            i > 0
              ? (t.upperBound.x - this.p1.x) / i
              : i < 0
              ? (t.lowerBound.x - this.p1.x) / i
              : Number.POSITIVE_INFINITY,
            o > 0
              ? (t.upperBound.y - this.p1.y) / o
              : o < 0
              ? (t.lowerBound.y - this.p1.y) / o
              : Number.POSITIVE_INFINITY
          );
        (this.p2.x = this.p1.x + i * e), (this.p2.y = this.p1.y + o * e);
      }),
      (S.prototype.ExtendBackward = function (t) {
        let i = -this.p2.x + this.p1.x,
          o = -this.p2.y + this.p1.y,
          e = Math.min(
            i > 0
              ? (t.upperBound.x - this.p2.x) / i
              : i < 0
              ? (t.lowerBound.x - this.p2.x) / i
              : Number.POSITIVE_INFINITY,
            o > 0
              ? (t.upperBound.y - this.p2.y) / o
              : o < 0
              ? (t.lowerBound.y - this.p2.y) / o
              : Number.POSITIVE_INFINITY
          );
        (this.p1.x = this.p2.x + i * e), (this.p1.y = this.p2.y + o * e);
      }),
      (w.b2SeparationFunction = function () {
        (this.m_localPoint = new s()), (this.m_axis = new s());
      }),
      (w.prototype.Initialize = function (t, i, e, n, l) {
        if (((this.m_proxyA = i), (this.m_proxyB = n), 1 === t.count)) {
          this.m_type = w.e_points;
          let i = this.m_proxyA.GetVertex(t.indexA[0]),
            o = this.m_proxyB.GetVertex(t.indexB[0]),
            n = i,
            s = e.R,
            m = e.position.x + (s.col1.x * n.x + s.col2.x * n.y),
            r = e.position.y + (s.col1.y * n.x + s.col2.y * n.y);
          (n = o), (s = l.R);
          let a = l.position.x + (s.col1.x * n.x + s.col2.x * n.y),
            c = l.position.y + (s.col1.y * n.x + s.col2.y * n.y);
          (this.m_axis.x = a - m), (this.m_axis.y = c - r), this.m_axis.Normalize();
        } else if (t.indexB[0] === t.indexB[1]) {
          this.m_type = w.e_faceA;
          let i = this.m_proxyA.GetVertex(t.indexA[0]),
            o = this.m_proxyA.GetVertex(t.indexA[1]),
            n = this.m_proxyB.GetVertex(t.indexB[0]);
          (this.m_localPoint.x = 0.5 * (i.x + o.x)),
            (this.m_localPoint.y = 0.5 * (i.y + o.y)),
            (this.m_axis.x = o.y - i.y),
            (this.m_axis.y = -1 * (o.x - i.x)),
            this.m_axis.Normalize();
          let s = this.m_axis,
            m = e.R,
            r = m.col1.x * s.x + m.col2.x * s.y,
            a = m.col1.y * s.x + m.col2.y * s.y;
          (s = this.m_localPoint), (m = e.R);
          let c = e.position.x + (m.col1.x * s.x + m.col2.x * s.y),
            _ = e.position.y + (m.col1.y * s.x + m.col2.y * s.y);
          (s = n),
            (m = l.R),
            (l.position.x + (m.col1.x * s.x + m.col2.x * s.y) - c) * r +
              (l.position.y + (m.col1.y * s.x + m.col2.y * s.y) - _) * a <
              0 && this.m_axis.NegativeSelf();
        } else if (t.indexA[0] == t.indexA[0]) {
          this.m_type = w.e_faceB;
          let i = this.m_proxyB.GetVertex(t.indexB[0]),
            o = this.m_proxyB.GetVertex(t.indexB[1]),
            n = this.m_proxyA.GetVertex(t.indexA[0]);
          (this.m_localPoint.x = 0.5 * (i.x + o.x)),
            (this.m_localPoint.y = 0.5 * (i.y + o.y)),
            (this.m_axis.x = o.y - i.y),
            (this.m_axis.y = -1 * (o.x - i.x)),
            this.m_axis.Normalize();
          let s = this.m_axis,
            m = l.R,
            r = m.col1.x * s.x + m.col2.x * s.y,
            a = m.col1.y * s.x + m.col2.y * s.y;
          (s = this.m_localPoint), (m = l.R);
          let c = l.position.x + (m.col1.x * s.x + m.col2.x * s.y),
            _ = l.position.y + (m.col1.y * s.x + m.col2.y * s.y);
          (s = n),
            (m = e.R),
            (e.position.x + (m.col1.x * s.x + m.col2.x * s.y) - c) * r +
              (e.position.y + (m.col1.y * s.x + m.col2.y * s.y) - _) * a <
              0 && this.m_axis.NegativeSelf();
        } else {
          let i = this.m_proxyA.GetVertex(t.indexA[0]),
            n = this.m_proxyA.GetVertex(t.indexA[1]),
            m = this.m_proxyB.GetVertex(t.indexB[0]),
            r = this.m_proxyB.GetVertex(t.indexB[1]),
            a = o.SubtractVV(n, i),
            c = o.SubtractVV(r, m),
            _ = o.MulMV(e.R, a),
            h = o.MulMV(l.R, c),
            p = _.x * _.x + _.y * _.y,
            y = h.x * h.x + h.y * h.y,
            u = o.SubtractVV(h, _),
            x = _.x * u.x + _.y * u.y,
            f = h.x * u.x + h.y * u.y,
            b = _.x * h.x + _.y * h.y,
            d = p * y - b * b,
            B = 0;
          0 !== d && (B = o.Clamp((b * f - x * y) / d, 0, 1));
          let D = (b * B + f) / y;
          D < 0 && ((D = 0), (B = o.Clamp((b - x) / p, 0, 1)));
          let C = new s();
          (C.x = i.x + B * (n.x - i.x)), (C.y = i.y + B * (n.y - i.y));
          let A = new s();
          (A.x = m.x + B * (r.x - m.x)),
            (A.y = m.y + B * (r.y - m.y)),
            0 === B || 1 === B
              ? ((this.m_type = w.e_faceB),
                (this.m_axis.x = r.y - m.y),
                (this.m_axis.y = -1 * (r.x - m.x)),
                this.m_axis.Normalize(),
                (this.m_localPoint = A),
                B < 0 && this.m_axis.NegativeSelf())
              : ((this.m_type = w.e_faceA),
                (this.m_axis.x = n.y - i.y),
                (this.m_axis.y = -1 * (n.x - i.x)),
                (this.m_localPoint = C),
                B < 0 && this.m_axis.NegativeSelf());
        }
      }),
      (w.prototype.Evaluate = function (t, i) {
        let e, n, s, l, m, r, a;
        switch (this.m_type) {
          case w.e_points:
            e = o.MulTMV(t.R, this.m_axis);
            var c = this.m_axis.GetNegative();
            return (
              void 0 !== n
                ? ((n.x = o.Dot(c, i.R.col1)), (n.y = o.Dot(c, i.R.col2)))
                : (n = o.MulTMV(i.R, c)),
              (s = this.m_proxyA.GetSupportVertex(e)),
              (l = this.m_proxyB.GetSupportVertex(n)),
              (m = o.MulX(t, s)),
              ((r = o.MulX(i, l)).x - m.x) * this.m_axis.x + (r.y - m.y) * this.m_axis.y
            );
          case w.e_faceA:
            (a = o.MulMV(t.R, this.m_axis)), (m = o.MulX(t, this.m_localPoint));
            c = a.GetNegative();
            return (
              void 0 !== n
                ? ((n.x = o.Dot(c, i.R.col1)), (n.y = o.Dot(c, i.R.col2)))
                : (n = o.MulTMV(i.R, c)),
              (l = this.m_proxyB.GetSupportVertex(n)),
              ((r = o.MulX(i, l)).x - m.x) * a.x + (r.y - m.y) * a.y
            );
          case w.e_faceB:
            (a = o.MulMV(i.R, this.m_axis)), (r = o.MulX(i, this.m_localPoint));
            c = a.GetNegative();
            return (
              void 0 !== e
                ? ((e.x = o.Dot(c, t.R.col1)), (e.y = o.Dot(c, t.R.col2)))
                : (e = o.MulTMV(t.R, c)),
              (s = this.m_proxyA.GetSupportVertex(e)),
              ((m = o.MulX(t, s)).x - r.x) * a.x + (m.y - r.y) * a.y
            );
          default:
            return 0;
        }
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Collision.b2SeparationFunction.e_points = 1),
          (Box2D.Collision.b2SeparationFunction.e_faceA = 2),
          (Box2D.Collision.b2SeparationFunction.e_faceB = 4);
      }),
      (g.b2Simplex = function () {
        (this.m_v1 = new V()),
          (this.m_v2 = new V()),
          (this.m_v3 = new V()),
          (this.m_vertices = [0, 0, 0]);
      }),
      (g.prototype.b2Simplex = function () {
        (this.m_vertices[0] = this.m_v1),
          (this.m_vertices[1] = this.m_v2),
          (this.m_vertices[2] = this.m_v3);
      }),
      (g.prototype.ReadCache = function (t, i, e, n, s) {
        this.m_count = t.count;
        let l = this.m_vertices,
          m = this.m_count;
        for (; m > 0; ) {
          let o = l[--m];
          (o.indexA = t.indexA[m]), (o.indexB = t.indexB[m]);
          let r = i.GetVertex(o.indexA),
            a = n.GetVertex(o.indexB);
          (o.wA.x = e.R.col1.x * r.x + e.R.col2.x * r.y + e.position.x),
            (o.wA.y = e.R.col1.y * r.x + e.R.col2.y * r.y + e.position.y),
            (o.wB.x = s.R.col1.x * a.x + s.R.col2.x * a.y + s.position.x),
            (o.wB.y = s.R.col1.y * a.x + s.R.col2.y * a.y + s.position.y),
            (o.w.x = o.wB.x - o.wA.x),
            (o.w.y = o.wB.y - o.wA.y),
            (o.a = 0);
        }
        if (this.m_count > 1) {
          let i = t.metric,
            o = this.GetMetric();
          (o < 0.5 * i || 2 * i < o || o < Number.MIN_VALUE) && (this.m_count = 0);
        }
        if (0 === this.m_count) {
          if (((v = l[0]), (v.indexA = 0), (v.indexB = 0), void 0 !== v.w)) {
            let t = i.GetVertex(0),
              o = n.GetVertex(0);
            (v.wA.x = e.R.col1.x * t.x + e.R.col2.x * t.y + e.position.x),
              (v.wA.y = e.R.col1.y * t.x + e.R.col2.y * t.y + e.position.y),
              (v.wB.x = s.R.col1.x * o.x + s.R.col2.x * o.y + s.position.x),
              (v.wB.y = s.R.col1.y * o.x + s.R.col2.y * o.y + s.position.y),
              (v.w.x = v.wB.x - v.wA.x),
              (v.w.y = v.wB.y - v.wA.y);
          } else
            (v.wA = o.MulX(e, i.GetVertex(0))),
              (v.wB = o.MulX(s, n.GetVertex(0))),
              (v.w = o.SubtractVV(v.wB, v.wA));
          this.m_count = 1;
        }
      }),
      (g.prototype.WriteCache = function (t) {
        (t.metric = this.GetMetric()), (t.count = this.m_count);
        let i = this.m_vertices,
          o = this.m_count;
        for (; o--; ) (t.indexA[o] = i[o].indexA), (t.indexB[o] = i[o].indexB);
      }),
      (g.prototype.GetSearchDirection = function () {
        switch (this.m_count) {
          case 1:
            return this.m_v1.w.GetNegative();
          case 2: {
            let t = new s(this.m_v2.w.x - this.m_v1.w.x, this.m_v2.w.y - this.m_v1.w.y),
              i = new s(-this.m_v1.w.x, -this.m_v1.w.y);
            if (o.CrossVV(t, i) > 0) {
              return o.CrossFV(1, t);
            }
            return o.CrossVF(t, 1);
          }
          default:
            return new s();
        }
      }),
      (g.prototype.GetClosestPoint = function () {
        switch (this.m_count) {
          case 1:
            return this.m_v1.w;
          case 2:
            return new s(
              this.m_v1.a * this.m_v1.w.x + this.m_v2.a * this.m_v2.w.x,
              this.m_v1.a * this.m_v1.w.y + this.m_v2.a * this.m_v2.w.y
            );
          default:
            return new s();
        }
      }),
      (g.prototype.GetWitnessPoints = function (t, i) {
        switch (this.m_count) {
          case 1:
            t.SetV(this.m_v1.wA), i.SetV(this.m_v1.wB);
            break;
          case 2:
            (t.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x),
              (t.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y),
              (i.x = this.m_v1.a * this.m_v1.wB.x + this.m_v2.a * this.m_v2.wB.x),
              (i.y = this.m_v1.a * this.m_v1.wB.y + this.m_v2.a * this.m_v2.wB.y);
            break;
          case 3:
            (i.x = t.x =
              this.m_v1.a * this.m_v1.wA.x +
              this.m_v2.a * this.m_v2.wA.x +
              this.m_v3.a * this.m_v3.wA.x),
              (i.y = t.y =
                this.m_v1.a * this.m_v1.wA.y +
                this.m_v2.a * this.m_v2.wA.y +
                this.m_v3.a * this.m_v3.wA.y);
        }
      }),
      (g.prototype.GetMetric = function () {
        switch (this.m_count) {
          case 1:
            return 0;
          case 2:
            return o.SubtractVV(this.m_v1.w, this.m_v2.w).Length();
          case 3:
            let t = o.SubtractVV(this.m_v2.w, this.m_v1.w),
              i = o.SubtractVV(this.m_v3.w, this.m_v1.w);
            return o.CrossVV(t, i);
        }
      }),
      (g.prototype.Solve2 = function () {
        let t = this.m_v1.w,
          i = this.m_v2.w,
          e = o.SubtractVV(i, t),
          n = -(t.x * e.x + t.y * e.y);
        if (n <= 0) return (this.m_v1.a = 1), void (this.m_count = 1);
        let s = i.x * e.x + i.y * e.y;
        if (s <= 0) return (this.m_v2.a = 1), (this.m_count = 1), void this.m_v1.Set(this.m_v2);
        let l = 1 / (s + n);
        (this.m_v1.a = s * l), (this.m_v2.a = n * l), (this.m_count = 2);
      }),
      (g.prototype.Solve3 = function () {
        let t = this.m_v1.w,
          i = this.m_v2.w,
          e = this.m_v3.w,
          n = o.SubtractVV(i, t),
          s = o.Dot(t, n),
          l = o.Dot(i, n),
          m = -s,
          r = o.SubtractVV(e, t),
          a = o.Dot(t, r),
          c = o.Dot(e, r),
          _ = -a,
          h = o.SubtractVV(e, i),
          p = o.Dot(i, h),
          y = o.Dot(e, h),
          u = -p,
          x = o.CrossVV(n, r),
          f = x * o.CrossVV(i, e),
          b = x * o.CrossVV(e, t),
          d = x * o.CrossVV(t, i);
        if (m <= 0 && _ <= 0) return (this.m_v1.a = 1), void (this.m_count = 1);
        if (l > 0 && m > 0 && d <= 0) {
          let t = 1 / (l + m);
          return (this.m_v1.a = l * t), (this.m_v2.a = m * t), void (this.m_count = 2);
        }
        if (c > 0 && _ > 0 && b <= 0) {
          let t = 1 / (c + _);
          return (
            (this.m_v1.a = c * t),
            (this.m_v3.a = _ * t),
            (this.m_count = 2),
            void this.m_v2.Set(this.m_v3)
          );
        }
        if (l <= 0 && u <= 0)
          return (this.m_v2.a = 1), (this.m_count = 1), void this.m_v1.Set(this.m_v2);
        if (c <= 0 && y <= 0)
          return (this.m_v3.a = 1), (this.m_count = 1), void this.m_v1.Set(this.m_v3);
        if (y > 0 && u > 0 && f <= 0) {
          let t = 1 / (y + u);
          return (
            (this.m_v2.a = y * t),
            (this.m_v3.a = u * t),
            (this.m_count = 2),
            void this.m_v1.Set(this.m_v3)
          );
        }
        let B = 1 / (f + b + d);
        (this.m_v1.a = f * B), (this.m_v2.a = b * B), (this.m_v3.a = d * B), (this.m_count = 3);
      }),
      (M.b2SimplexCache = function () {
        (this.indexA = [0, 0, 0]), (this.indexB = [0, 0, 0]);
      }),
      (V.b2SimplexVertex = function () {}),
      (V.prototype.Set = function (t) {
        this.wA.SetV(t.wA),
          this.wB.SetV(t.wB),
          this.w.SetV(t.w),
          (this.a = t.a),
          (this.indexA = t.indexA),
          (this.indexB = t.indexB);
      }),
      (I.b2TimeOfImpact = function () {}),
      (I.TimeOfImpact = function (t) {
        ++I.b2_toiCalls;
        let i = t.proxyA,
          e = t.proxyB,
          n = t.sweepA,
          s = t.sweepB,
          l = i.m_radius + e.m_radius,
          m = t.tolerance,
          r = 0,
          a = 0,
          c = 0;
        for (I.s_cache.count = 0, I.s_distanceInput.useRadii = !1; ; ) {
          if (
            (n.GetTransform(I.s_xfA, r),
            s.GetTransform(I.s_xfB, r),
            (I.s_distanceInput.proxyA = i),
            (I.s_distanceInput.proxyB = e),
            (I.s_distanceInput.transformA = I.s_xfA),
            (I.s_distanceInput.transformB = I.s_xfB),
            h.Distance(I.s_distanceOutput, I.s_cache, I.s_distanceInput),
            I.s_distanceOutput.distance <= 0)
          ) {
            r = 1;
            break;
          }
          I.s_fcn.Initialize(I.s_cache, i, I.s_xfA, e, I.s_xfB);
          let t = I.s_fcn.Evaluate(I.s_xfA, I.s_xfB);
          if (t <= 0) {
            r = 1;
            break;
          }
          if (
            (0 === a && (c = t > l ? o.Max(l - m, 0.75 * l) : o.Max(t - m, 0.02 * l)),
            t - c < 0.5 * m)
          ) {
            0 === a && (r = 1);
            break;
          }
          let _ = r,
            p = r,
            y = 1,
            u = t;
          n.GetTransform(I.s_xfA, y), s.GetTransform(I.s_xfB, y);
          let x = I.s_fcn.Evaluate(I.s_xfA, I.s_xfB);
          if (x >= c) {
            r = 1;
            break;
          }
          let f = 0,
            b = 0;
          for (;;) {
            (b = 1 & f ? p + ((c - u) * (y - p)) / (x - u) : 0.5 * (p + y)),
              n.GetTransform(I.s_xfA, b),
              s.GetTransform(I.s_xfB, b);
            let t = I.s_fcn.Evaluate(I.s_xfA, I.s_xfB);
            if (o.Abs(t - c) < 0.025 * m) {
              _ = b;
              break;
            }
            if ((t > c ? ((p = b), (u = t)) : ((y = b), (x = t)), ++I.b2_toiRootIters, 50 == ++f))
              break;
          }
          if (
            ((I.b2_toiMaxRootIters = o.Max(I.b2_toiMaxRootIters, f)),
            _ < (1 + 100 * Number.MIN_VALUE) * r)
          )
            break;
          if (((r = _), a++, ++I.b2_toiIters, 1e3 === a)) break;
        }
        return (I.b2_toiMaxIters = o.Max(I.b2_toiMaxIters, a)), r;
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Collision.b2TimeOfImpact.b2_toiCalls = 0),
          (Box2D.Collision.b2TimeOfImpact.b2_toiIters = 0),
          (Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters = 0),
          (Box2D.Collision.b2TimeOfImpact.b2_toiRootIters = 0),
          (Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters = 0),
          (Box2D.Collision.b2TimeOfImpact.s_cache = new M()),
          (Box2D.Collision.b2TimeOfImpact.s_distanceInput = new p()),
          (Box2D.Collision.b2TimeOfImpact.s_xfA = new n(new s())),
          (Box2D.Collision.b2TimeOfImpact.s_xfB = new n(new s())),
          (Box2D.Collision.b2TimeOfImpact.s_fcn = new w()),
          (Box2D.Collision.b2TimeOfImpact.s_distanceOutput = new y());
      }),
      (L.b2TOIInput = function () {
        (this.proxyA = new u()),
          (this.proxyB = new u()),
          (this.sweepA = new e()),
          (this.sweepB = new e());
      }),
      (J.b2WorldManifold = function () {
        this.m_normal = new s();
      }),
      (J.Free = function (t) {}),
      (J.prototype.b2WorldManifold = function () {
        this.m_points = [new s(), new s()];
      }),
      (J.prototype.Initialize = function (t, i, o, e, n) {
        this.m_points;
        switch (t.m_type) {
          case B.e_circles:
            {
              let s = i.R,
                l = t.m_localPoint,
                m = i.position.x + s.col1.x * l.x + s.col2.x * l.y,
                r = i.position.y + s.col1.y * l.x + s.col2.y * l.y;
              (s = e.R), (l = t.m_points[0].m_localPoint);
              let a = e.position.x + s.col1.x * l.x + s.col2.x * l.y,
                c = e.position.y + s.col1.y * l.x + s.col2.y * l.y,
                _ = a - m,
                h = c - r,
                p = _ * _ + h * h;
              if (p > Number.MIN_VALUE * Number.MIN_VALUE) {
                let t = Math.sqrt(p);
                (this.m_normal.x = _ / t), (this.m_normal.y = h / t);
              } else (this.m_normal.x = 1), (this.m_normal.y = 0);
              let y = m + o * this.m_normal.x,
                u = r + o * this.m_normal.y,
                x = a - n * this.m_normal.x,
                f = c - n * this.m_normal.y;
              (this.m_points[0].x = 0.5 * (y + x)), (this.m_points[0].y = 0.5 * (u + f));
            }
            break;
          case B.e_faceA:
            {
              let s = i.R,
                l = t.m_localPlaneNormal,
                m = s.col1.x * l.x + s.col2.x * l.y,
                r = s.col1.y * l.x + s.col2.y * l.y;
              (s = i.R), (l = t.m_localPoint);
              let a = i.position.x + s.col1.x * l.x + s.col2.x * l.y,
                c = i.position.y + s.col1.y * l.x + s.col2.y * l.y;
              (this.m_normal.x = m), (this.m_normal.y = r);
              let _ = t.m_pointCount;
              for (; _ > 0; ) {
                (s = e.R), (l = t.m_points[--_].m_localPoint);
                let i = e.position.x + s.col1.x * l.x + s.col2.x * l.y,
                  h = e.position.y + s.col1.y * l.x + s.col2.y * l.y;
                (this.m_points[_].x = i + 0.5 * (o - (i - a) * m - (h - c) * r - n) * m),
                  (this.m_points[_].y = h + 0.5 * (o - (i - a) * m - (h - c) * r - n) * r);
              }
            }
            break;
          case B.e_faceB: {
            let s = e.R,
              l = t.m_localPlaneNormal,
              m = s.col1.x * l.x + s.col2.x * l.y,
              r = s.col1.y * l.x + s.col2.y * l.y;
            (s = e.R), (l = t.m_localPoint);
            let a = e.position.x + s.col1.x * l.x + s.col2.x * l.y,
              c = e.position.y + s.col1.y * l.x + s.col2.y * l.y;
            (this.m_normal.x = -m), (this.m_normal.y = -r);
            let _ = t.m_pointCount;
            for (; _ > 0; ) {
              (s = i.R), (l = t.m_points[--_].m_localPoint);
              let e = i.position.x + s.col1.x * l.x + s.col2.x * l.y,
                h = i.position.y + s.col1.y * l.x + s.col2.y * l.y;
              (this.m_points[_].x = e + 0.5 * (n - (e - a) * m - (h - c) * r - o) * m),
                (this.m_points[_].y = h + 0.5 * (n - (e - a) * m - (h - c) * r - o) * r);
            }
          }
        }
      }),
      (G.ClipVertex = function () {
        (this.v = new s()), (this.id = new c());
      }),
      (G.prototype.Set = function (t) {
        this.v.SetV(t.v), this.id.Set(t.id);
      }),
      (R.Features = function () {}),
      Object.defineProperty(R.prototype, "referenceEdge", {
        enumerable: !1,
        configurable: !0,
        get: function () {
          return this._referenceEdge;
        },
      }),
      Object.defineProperty(R.prototype, "referenceEdge", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          (this._referenceEdge = t),
            (this._m_id._key = (4294967040 & this._m_id._key) | (255 & this._referenceEdge));
        },
      }),
      Object.defineProperty(R.prototype, "incidentEdge", {
        enumerable: !1,
        configurable: !0,
        get: function () {
          return this._incidentEdge;
        },
      }),
      Object.defineProperty(R.prototype, "incidentEdge", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          (this._incidentEdge = t),
            (this._m_id._key =
              (4294902015 & this._m_id._key) | ((this._incidentEdge << 8) & 65280));
        },
      }),
      Object.defineProperty(R.prototype, "incidentVertex", {
        enumerable: !1,
        configurable: !0,
        get: function () {
          return this._incidentVertex;
        },
      }),
      Object.defineProperty(R.prototype, "incidentVertex", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          (this._incidentVertex = t),
            (this._m_id._key =
              (4278255615 & this._m_id._key) | ((this._incidentVertex << 16) & 16711680));
        },
      }),
      Object.defineProperty(R.prototype, "flip", {
        enumerable: !1,
        configurable: !0,
        get: function () {
          return this._flip;
        },
      }),
      Object.defineProperty(R.prototype, "flip", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          (this._flip = t),
            (this._m_id._key = (16777215 & this._m_id._key) | ((this._flip << 24) & 4278190080));
        },
      });
  })(),
  (function () {
    Box2D.Common.b2Color, Box2D.Common.b2internal;
    let t = Box2D.Common.b2Settings,
      i = Box2D.Collision.Shapes.b2CircleShape,
      o = Box2D.Collision.Shapes.b2EdgeChainDef,
      e = Box2D.Collision.Shapes.b2EdgeShape,
      n = Box2D.Collision.Shapes.b2MassData,
      s = Box2D.Collision.Shapes.b2PolygonShape,
      l = Box2D.Collision.Shapes.b2Shape,
      m = Box2D.Common.Math.b2Mat22,
      r = (Box2D.Common.Math.b2Mat33, Box2D.Common.Math.b2Math),
      a = (Box2D.Common.Math.b2Sweep, Box2D.Common.Math.b2Transform),
      c = Box2D.Common.Math.b2Vec2,
      _ =
        (Box2D.Common.Math.b2Vec3,
        Box2D.Dynamics.b2Body,
        Box2D.Dynamics.b2BodyDef,
        Box2D.Dynamics.b2ContactFilter,
        Box2D.Dynamics.b2ContactImpulse,
        Box2D.Dynamics.b2ContactListener,
        Box2D.Dynamics.b2ContactManager,
        Box2D.Dynamics.b2DestructionListener,
        Box2D.Dynamics.b2FilterData,
        Box2D.Dynamics.b2Fixture,
        Box2D.Dynamics.b2FixtureDef,
        Box2D.Dynamics.b2Island,
        Box2D.Dynamics.b2TimeStep,
        Box2D.Dynamics.b2World,
        Box2D.Collision.b2AABB,
        Box2D.Collision.b2Bound,
        Box2D.Collision.b2BoundValues,
        Box2D.Collision.b2Collision,
        Box2D.Collision.b2ContactID,
        Box2D.Collision.b2ContactPoint,
        Box2D.Collision.b2Distance),
      h = Box2D.Collision.b2DistanceInput,
      p = Box2D.Collision.b2DistanceOutput,
      y = Box2D.Collision.b2DistanceProxy,
      u =
        (Box2D.Collision.b2DynamicTree,
        Box2D.Collision.b2DynamicTreeBroadPhase,
        Box2D.Collision.b2DynamicTreeNode,
        Box2D.Collision.b2DynamicTreePair,
        Box2D.Collision.b2Manifold,
        Box2D.Collision.b2ManifoldPoint,
        Box2D.Collision.b2Point,
        Box2D.Collision.b2RayCastInput,
        Box2D.Collision.b2RayCastOutput,
        Box2D.Collision.b2Segment,
        Box2D.Collision.b2SeparationFunction,
        Box2D.Collision.b2Simplex,
        Box2D.Collision.b2SimplexCache);
    Box2D.Collision.b2SimplexVertex,
      Box2D.Collision.b2TimeOfImpact,
      Box2D.Collision.b2TOIInput,
      Box2D.Collision.b2WorldManifold,
      Box2D.Collision.ClipVertex,
      Box2D.Collision.Features,
      Box2D.Collision.IBroadPhase;
    Box2D.inherit(i, Box2D.Collision.Shapes.b2Shape),
      (i.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype),
      (i.prototype.Copy = function () {
        let t = new i();
        return t.Set(this), t;
      }),
      (i.prototype.Set = function (t) {
        if ((this.__super.Set.call(this, t), Box2D.is(t, i))) {
          let o = t instanceof i ? t : null;
          this.m_p.SetV(o.m_p);
        }
      }),
      (i.prototype.TestPoint = function (t, i) {
        let o = t.R,
          e = t.position.x + (o.col1.x * this.m_p.x + o.col2.x * this.m_p.y),
          n = t.position.y + (o.col1.y * this.m_p.x + o.col2.y * this.m_p.y);
        return (e = i.x - e) * e + (n = i.y - n) * n <= this.m_radius * this.m_radius;
      }),
      (i.prototype.RayCast = function (t, i, o) {
        let e = o.R,
          n = o.position.x + (e.col1.x * this.m_p.x + e.col2.x * this.m_p.y),
          s = o.position.y + (e.col1.y * this.m_p.x + e.col2.y * this.m_p.y),
          l = i.p1.x - n,
          m = i.p1.y - s,
          r = l * l + m * m - this.m_radius * this.m_radius,
          a = i.p2.x - i.p1.x,
          c = i.p2.y - i.p1.y,
          _ = l * a + m * c,
          h = a * a + c * c,
          p = _ * _ - h * r;
        if (p < 0 || h < Number.MIN_VALUE) return !1;
        let y = -(_ + Math.sqrt(p));
        return (
          0 <= y &&
          y <= i.maxFraction * h &&
          ((y /= h),
          (t.fraction = y),
          (t.normal.x = l + y * a),
          (t.normal.y = m + y * c),
          t.normal.Normalize(),
          !0)
        );
      }),
      (i.prototype.ComputeAABB = function (t, i) {
        let o = i.R,
          e = i.position.x + (o.col1.x * this.m_p.x + o.col2.x * this.m_p.y),
          n = i.position.y + (o.col1.y * this.m_p.x + o.col2.y * this.m_p.y);
        t.lowerBound.Set(e - this.m_radius, n - this.m_radius),
          t.upperBound.Set(e + this.m_radius, n + this.m_radius);
      }),
      (i.prototype.ComputeMass = function (i, o) {
        (i.mass = o * t.b2_pi * this.m_radius * this.m_radius),
          i.center.SetV(this.m_p),
          (i.I =
            i.mass *
            (0.5 * this.m_radius * this.m_radius +
              (this.m_p.x * this.m_p.x + this.m_p.y * this.m_p.y)));
      }),
      (i.prototype.ComputeSubmergedArea = function (t, i, o, e) {
        let n = r.MulX(o, this.m_p),
          s = -(r.Dot(t, n) - i);
        if (s < -this.m_radius + Number.MIN_VALUE) return 0;
        if (s > this.m_radius) return e.SetV(n), Math.PI * this.m_radius * this.m_radius;
        let l = this.m_radius * this.m_radius,
          m = s * s,
          a = l * (Math.asin(s / this.m_radius) + Math.PI / 2) + s * Math.sqrt(l - m),
          c = ((-2 / 3) * Math.pow(l - m, 1.5)) / a;
        return (e.x = n.x + t.x * c), (e.y = n.y + t.y * c), a;
      }),
      (i.prototype.GetLocalPosition = function () {
        return this.m_p;
      }),
      (i.prototype.SetLocalPosition = function (t) {
        this.m_p.SetV(t);
      }),
      (i.prototype.GetRadius = function () {
        return this.m_radius;
      }),
      (i.prototype.SetRadius = function (t) {
        this.m_radius = t;
      }),
      (i.prototype.b2CircleShape = function (t) {
        void 0 === t && (t = 0),
          this.__super.b2Shape.call(this),
          (this.m_type = l.e_circleShape),
          (this.m_radius = t);
      }),
      (o.b2EdgeChainDef = function () {}),
      (o.prototype.b2EdgeChainDef = function () {
        (this.vertexCount = 0), (this.isALoop = !0), (this.vertices = []);
      }),
      Box2D.inherit(e, Box2D.Collision.Shapes.b2Shape),
      (e.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype),
      (e.b2EdgeShape = function () {
        Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments),
          (this.s_supportVec = new c()),
          (this.m_v1 = new c()),
          (this.m_v2 = new c()),
          (this.m_coreV1 = new c()),
          (this.m_coreV2 = new c()),
          (this.m_normal = new c()),
          (this.m_direction = new c()),
          (this.m_cornerDir1 = new c()),
          (this.m_cornerDir2 = new c());
      }),
      (e.prototype.TestPoint = function (t, i) {
        return !1;
      }),
      (e.prototype.RayCast = function (t, i, o) {
        let e = i.p2.x - i.p1.x,
          n = i.p2.y - i.p1.y,
          s = o.R,
          l = o.position.x + (s.col1.x * this.m_v1.x + s.col2.x * this.m_v1.y),
          m = o.position.y + (s.col1.y * this.m_v1.x + s.col2.y * this.m_v1.y),
          r = o.position.y + (s.col1.y * this.m_v2.x + s.col2.y * this.m_v2.y) - m,
          a = -(o.position.x + (s.col1.x * this.m_v2.x + s.col2.x * this.m_v2.y) - l),
          c = 100 * Number.MIN_VALUE,
          _ = -(e * r + n * a);
        if (_ > c) {
          let o = i.p1.x - l,
            s = i.p1.y - m,
            h = o * r + s * a;
          if (0 <= h && h <= i.maxFraction * _) {
            let i = -e * s + n * o;
            if (-c * _ <= i && i <= _ * (1 + c)) {
              (h /= _), (t.fraction = h);
              let i = Math.sqrt(r * r + a * a);
              return (t.normal.x = r / i), (t.normal.y = a / i), !0;
            }
          }
        }
        return !1;
      }),
      (e.prototype.ComputeAABB = function (t, i) {
        let o = i.R,
          e = i.position.x + (o.col1.x * this.m_v1.x + o.col2.x * this.m_v1.y),
          n = i.position.y + (o.col1.y * this.m_v1.x + o.col2.y * this.m_v1.y),
          s = i.position.x + (o.col1.x * this.m_v2.x + o.col2.x * this.m_v2.y),
          l = i.position.y + (o.col1.y * this.m_v2.x + o.col2.y * this.m_v2.y);
        e < s
          ? ((t.lowerBound.x = e), (t.upperBound.x = s))
          : ((t.lowerBound.x = s), (t.upperBound.x = e)),
          n < l
            ? ((t.lowerBound.y = n), (t.upperBound.y = l))
            : ((t.lowerBound.y = l), (t.upperBound.y = n));
      }),
      (e.prototype.ComputeMass = function (t, i) {
        void 0 === i && (i = 0), (t.mass = 0), t.center.SetV(this.m_v1), (t.I = 0);
      }),
      (e.prototype.ComputeSubmergedArea = function (t, i, o, e) {
        let n = new c(t.x * i, t.y * i),
          s = r.MulX(o, this.m_v1),
          l = r.MulX(o, this.m_v2),
          m = r.Dot(t, s) - i,
          a = r.Dot(t, l) - i;
        if (m > 0) {
          if (a > 0) return 0;
          (s.x = (-a / (m - a)) * s.x + (m / (m - a)) * l.x),
            (s.y = (-a / (m - a)) * s.y + (m / (m - a)) * l.y);
        } else
          a > 0 &&
            ((l.x = (-a / (m - a)) * s.x + (m / (m - a)) * l.x),
            (l.y = (-a / (m - a)) * s.y + (m / (m - a)) * l.y));
        return (
          (e.x = (n.x + s.x + l.x) / 3),
          (e.y = (n.y + s.y + l.y) / 3),
          0.5 * ((s.x - n.x) * (l.y - n.y) - (s.y - n.y) * (l.x - n.x))
        );
      }),
      (e.prototype.GetLength = function () {
        return this.m_length;
      }),
      (e.prototype.GetVertex1 = function () {
        return this.m_v1;
      }),
      (e.prototype.GetVertex2 = function () {
        return this.m_v2;
      }),
      (e.prototype.GetCoreVertex1 = function () {
        return this.m_coreV1;
      }),
      (e.prototype.GetCoreVertex2 = function () {
        return this.m_coreV2;
      }),
      (e.prototype.GetNormalVector = function () {
        return this.m_normal;
      }),
      (e.prototype.GetDirectionVector = function () {
        return this.m_direction;
      }),
      (e.prototype.GetCorner1Vector = function () {
        return this.m_cornerDir1;
      }),
      (e.prototype.GetCorner2Vector = function () {
        return this.m_cornerDir2;
      }),
      (e.prototype.Corner1IsConvex = function () {
        return this.m_cornerConvex1;
      }),
      (e.prototype.Corner2IsConvex = function () {
        return this.m_cornerConvex2;
      }),
      (e.prototype.GetFirstVertex = function (t) {
        let i = t.R;
        return new c(
          t.position.x + (i.col1.x * this.m_coreV1.x + i.col2.x * this.m_coreV1.y),
          t.position.y + (i.col1.y * this.m_coreV1.x + i.col2.y * this.m_coreV1.y)
        );
      }),
      (e.prototype.GetNextEdge = function () {
        return this.m_nextEdge;
      }),
      (e.prototype.GetPrevEdge = function () {
        return this.m_prevEdge;
      }),
      (e.prototype.Support = function (t, i, o) {
        void 0 === i && (i = 0), void 0 === o && (o = 0);
        let e = t.R,
          n = t.position.x + (e.col1.x * this.m_coreV1.x + e.col2.x * this.m_coreV1.y),
          s = t.position.y + (e.col1.y * this.m_coreV1.x + e.col2.y * this.m_coreV1.y),
          l = t.position.x + (e.col1.x * this.m_coreV2.x + e.col2.x * this.m_coreV2.y),
          m = t.position.y + (e.col1.y * this.m_coreV2.x + e.col2.y * this.m_coreV2.y);
        return (
          n * i + s * o > l * i + m * o
            ? ((this.s_supportVec.x = n), (this.s_supportVec.y = s))
            : ((this.s_supportVec.x = l), (this.s_supportVec.y = m)),
          this.s_supportVec
        );
      }),
      (e.prototype.b2EdgeShape = function (i, o) {
        this.__super.b2Shape.call(this),
          (this.m_type = l.e_edgeShape),
          (this.m_prevEdge = null),
          (this.m_nextEdge = null),
          (this.m_v1 = i),
          (this.m_v2 = o),
          this.m_direction.Set(this.m_v2.x - this.m_v1.x, this.m_v2.y - this.m_v1.y),
          (this.m_length = this.m_direction.Normalize()),
          this.m_normal.Set(this.m_direction.y, -this.m_direction.x),
          this.m_coreV1.Set(
            -t.b2_toiSlop * (this.m_normal.x - this.m_direction.x) + this.m_v1.x,
            -t.b2_toiSlop * (this.m_normal.y - this.m_direction.y) + this.m_v1.y
          ),
          this.m_coreV2.Set(
            -t.b2_toiSlop * (this.m_normal.x + this.m_direction.x) + this.m_v2.x,
            -t.b2_toiSlop * (this.m_normal.y + this.m_direction.y) + this.m_v2.y
          ),
          (this.m_cornerDir1 = this.m_normal),
          this.m_cornerDir2.Set(-this.m_normal.x, -this.m_normal.y);
      }),
      (e.prototype.SetPrevEdge = function (t, i, o, e) {
        (this.m_prevEdge = t),
          (this.m_coreV1 = i),
          (this.m_cornerDir1 = o),
          (this.m_cornerConvex1 = e);
      }),
      (e.prototype.SetNextEdge = function (t, i, o, e) {
        (this.m_nextEdge = t),
          (this.m_coreV2 = i),
          (this.m_cornerDir2 = o),
          (this.m_cornerConvex2 = e);
      }),
      Box2D.inherit(s, Box2D.Collision.Shapes.b2Shape),
      (s.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype),
      (s.prototype.Copy = function () {
        let t = new s();
        return t.Set(this), t;
      }),
      (s.prototype.Set = function (t) {
        if ((this.__super.Set.call(this, t), Box2D.is(t, s))) {
          let i = t instanceof s ? t : null;
          this.m_centroid.SetV(i.m_centroid),
            (this.m_vertexCount = i.m_vertexCount),
            this.Reserve(this.m_vertexCount);
          for (let t = 0; t < this.m_vertexCount; t++)
            this.m_vertices[t].SetV(i.m_vertices[t]), this.m_normals[t].SetV(i.m_normals[t]);
        }
      }),
      (s.prototype.SetAsArray = function (t, i) {
        let o,
          e = [],
          n = 0;
        for (n = 0; n < t.length; ++n) (o = t[n]), e.push(o);
        this.SetAsVector(e, i);
      }),
      (s.AsArray = function (t, i) {
        void 0 === i && (i = 0);
        let o = new s();
        return o.SetAsArray(t, i), o;
      }),
      (s.prototype.SetAsVector = function (t, i) {
        void 0 === i && (i = 0),
          0 === i && (i = t.length),
          (this.m_vertexCount = i),
          this.Reserve(i);
        let o = 0;
        for (o = 0; o < this.m_vertexCount; o++) this.m_vertices[o].SetV(t[o]);
        for (o = 0; o < this.m_vertexCount; ++o) {
          let t = o + 1 < this.m_vertexCount ? o + 1 : 0,
            i = r.SubtractVV(this.m_vertices[t], this.m_vertices[o]),
            e = r.CrossVF(i, 1);
          this.m_normals[o].SetV(e), this.m_normals[o].Normalize();
        }
        this.m_centroid = s.ComputeCentroid(this.m_vertices, this.m_vertexCount);
      }),
      (s.AsVector = function (t, i) {
        void 0 === i && (i = 0);
        let o = new s();
        return o.SetAsVector(t, i), o;
      }),
      (s.prototype.SetAsBox = function (t, i) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          (this.m_vertexCount = 4),
          this.Reserve(4),
          this.m_vertices[0].Set(-t, -i),
          this.m_vertices[1].Set(t, -i),
          this.m_vertices[2].Set(t, i),
          this.m_vertices[3].Set(-t, i),
          this.m_normals[0].Set(0, -1),
          this.m_normals[1].Set(1, 0),
          this.m_normals[2].Set(0, 1),
          this.m_normals[3].Set(-1, 0),
          this.m_centroid.SetZero();
      }),
      (s.AsBox = function (t, i) {
        void 0 === t && (t = 0), void 0 === i && (i = 0);
        let o = new s();
        return o.SetAsBox(t, i), o;
      }),
      (s.prototype.SetAsOrientedBox = function (t, i, o, e) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          void 0 === o && (o = null),
          void 0 === e && (e = 0),
          (this.m_vertexCount = 4),
          this.Reserve(4),
          this.m_vertices[0].Set(-t, -i),
          this.m_vertices[1].Set(t, -i),
          this.m_vertices[2].Set(t, i),
          this.m_vertices[3].Set(-t, i),
          this.m_normals[0].Set(0, -1),
          this.m_normals[1].Set(1, 0),
          this.m_normals[2].Set(0, 1),
          this.m_normals[3].Set(-1, 0),
          (this.m_centroid = o);
        let n = new c(),
          s = new a(n);
        (s.position = o), s.R.Set(e);
        for (let t = 0; t < this.m_vertexCount; ++t)
          (this.m_vertices[t] = r.MulX(s, this.m_vertices[t])),
            (this.m_normals[t] = r.MulMV(s.R, this.m_normals[t]));
      }),
      (s.AsOrientedBox = function (t, i, o, e) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          void 0 === o && (o = null),
          void 0 === e && (e = 0);
        let n = new s();
        return n.SetAsOrientedBox(t, i, o, e), n;
      }),
      (s.prototype.SetAsEdge = function (t, i) {
        (this.m_vertexCount = 2),
          this.Reserve(2),
          this.m_vertices[0].SetV(t),
          this.m_vertices[1].SetV(i),
          (this.m_centroid.x = 0.5 * (t.x + i.x)),
          (this.m_centroid.y = 0.5 * (t.y + i.y));
        let o = new c(i.x - t.x, i.y - t.y);
        (this.m_normals[0] = r.CrossVF(o, 1)),
          this.m_normals[0].Normalize(),
          (this.m_normals[1].x = -this.m_normals[0].x),
          (this.m_normals[1].y = -this.m_normals[0].y);
      }),
      (s.AsEdge = function (t, i) {
        let o = new s();
        return o.SetAsEdge(t, i), o;
      }),
      (s.prototype.TestPoint = function (t, i) {
        let o,
          e = t.R,
          n = i.x - t.position.x,
          s = i.y - t.position.y,
          l = n * e.col1.x + s * e.col1.y,
          m = n * e.col2.x + s * e.col2.y;
        for (let t = 0; t < this.m_vertexCount; ++t) {
          if (
            ((n = l - (o = this.m_vertices[t]).x),
            (s = m - o.y),
            (o = this.m_normals[t]).x * n + o.y * s > 0)
          )
            return !1;
        }
        return !0;
      }),
      (s.prototype.RayCast = function (t, i, o) {
        let e,
          n = 0,
          s = i.maxFraction,
          l = i.p1.x - o.position.x,
          m = i.p1.y - o.position.y,
          r = o.R,
          a = l * r.col1.x + m * r.col1.y,
          c = l * r.col2.x + m * r.col2.y;
        (l = i.p2.x - o.position.x), (m = i.p2.y - o.position.y);
        let _ = l * (r = o.R).col1.x + m * r.col1.y - a,
          h = l * r.col2.x + m * r.col2.y - c,
          p = -1;
        for (let t = 0; t < this.m_vertexCount; ++t) {
          (l = (e = this.m_vertices[t]).x - a), (m = e.y - c);
          let i = (e = this.m_normals[t]).x * l + e.y * m,
            o = e.x * _ + e.y * h;
          if (0 === o) {
            if (i < 0) return !1;
          } else o < 0 && i < n * o ? ((n = i / o), (p = t)) : o > 0 && i < s * o && (s = i / o);
          if (s < n - 1.1920929e-7) return !1;
        }
        return (
          p >= 0 &&
          ((t.fraction = n),
          (r = o.R),
          (e = this.m_normals[p]),
          (t.normal.x = r.col1.x * e.x + r.col2.x * e.y),
          (t.normal.y = r.col1.y * e.x + r.col2.y * e.y),
          !0)
        );
      }),
      (s.prototype.ComputeAABB = function (t, i) {
        let o = i.R,
          e = this.m_vertices[0],
          n = i.position.x + (o.col1.x * e.x + o.col2.x * e.y),
          s = i.position.y + (o.col1.y * e.x + o.col2.y * e.y),
          l = n,
          m = s;
        for (let t = 1; t < this.m_vertexCount; ++t) {
          e = this.m_vertices[t];
          let r = i.position.x + (o.col1.x * e.x + o.col2.x * e.y),
            a = i.position.y + (o.col1.y * e.x + o.col2.y * e.y);
          (n = n < r ? n : r), (s = s < a ? s : a), (l = l > r ? l : r), (m = m > a ? m : a);
        }
        (t.lowerBound.x = n - this.m_radius),
          (t.lowerBound.y = s - this.m_radius),
          (t.upperBound.x = l + this.m_radius),
          (t.upperBound.y = m + this.m_radius);
      }),
      (s.prototype.ComputeMass = function (t, i) {
        if ((void 0 === i && (i = 0), 2 === this.m_vertexCount))
          return (
            (t.center.x = 0.5 * (this.m_vertices[0].x + this.m_vertices[1].x)),
            (t.center.y = 0.5 * (this.m_vertices[0].y + this.m_vertices[1].y)),
            (t.mass = 0),
            void (t.I = 0)
          );
        let o = 0,
          e = 0,
          n = 0,
          s = 0;
        for (let t = 0; t < this.m_vertexCount; ++t) {
          let i = this.m_vertices[t],
            l = t + 1 < this.m_vertexCount ? this.m_vertices[t + 1] : this.m_vertices[0],
            m = i.x - 0,
            r = i.y - 0,
            a = l.x - 0,
            c = l.y - 0,
            _ = m * c - r * a,
            h = 0.5 * _;
          (n += h), (o += h * (1 / 3) * (0 + i.x + l.x)), (e += h * (1 / 3) * (0 + i.y + l.y));
          let p = 0,
            y = 0;
          s +=
            _ *
            ((1 / 3) * (0.25 * (m * m + a * m + a * a) + (p * m + p * a)) +
              0.5 * p * p +
              ((1 / 3) * (0.25 * (r * r + c * r + c * c) + (y * r + y * c)) + 0.5 * y * y));
        }
        (t.mass = i * n), (o *= 1 / n), (e *= 1 / n), t.center.Set(o, e), (t.I = i * s);
      }),
      (s.prototype.ComputeSubmergedArea = function (t, i, o, e) {
        let s = r.MulTMV(o.R, t),
          l = i - r.Dot(t, o.position),
          m = [],
          a = 0,
          _ = -1,
          h = -1,
          p = !1,
          y = 0;
        for (y = 0; y < this.m_vertexCount; ++y) {
          m[y] = r.Dot(s, this.m_vertices[y]) - l;
          let t = m[y] < -Number.MIN_VALUE;
          y > 0 && (t ? p || ((_ = y - 1), a++) : p && ((h = y - 1), a++)), (p = t);
        }
        switch (a) {
          case 0:
            if (p) {
              let t = new n();
              return this.ComputeMass(t, 1), e.SetV(r.MulX(o, t.center)), t.mass;
            }
            return 0;
          case 1:
            -1 === _ ? (_ = this.m_vertexCount - 1) : (h = this.m_vertexCount - 1);
        }
        let u,
          x = (_ + 1) % this.m_vertexCount,
          f = (h + 1) % this.m_vertexCount,
          b = (0 - m[_]) / (m[x] - m[_]),
          d = (0 - m[h]) / (m[f] - m[h]),
          B = new c(
            this.m_vertices[_].x * (1 - b) + this.m_vertices[x].x * b,
            this.m_vertices[_].y * (1 - b) + this.m_vertices[x].y * b
          ),
          D = new c(
            this.m_vertices[h].x * (1 - d) + this.m_vertices[f].x * d,
            this.m_vertices[h].y * (1 - d) + this.m_vertices[f].y * d
          ),
          C = 0,
          A = new c(),
          S = this.m_vertices[x];
        for (y = x; y !== f; ) {
          u = (y = (y + 1) % this.m_vertexCount) === f ? D : this.m_vertices[y];
          let t = 0.5 * ((S.x - B.x) * (u.y - B.y) - (S.y - B.y) * (u.x - B.x));
          (C += t),
            (A.x += (t * (B.x + S.x + u.x)) / 3),
            (A.y += (t * (B.y + S.y + u.y)) / 3),
            (S = u);
        }
        return A.Multiply(1 / C), e.SetV(r.MulX(o, A)), C;
      }),
      (s.prototype.GetVertexCount = function () {
        return this.m_vertexCount;
      }),
      (s.prototype.GetVertices = function () {
        return this.m_vertices;
      }),
      (s.prototype.GetNormals = function () {
        return this.m_normals;
      }),
      (s.prototype.GetSupport = function (t) {
        let i = 0,
          o = this.m_vertices[0].x * t.x + this.m_vertices[0].y * t.y;
        for (let e = 1; e < this.m_vertexCount; ++e) {
          let n = this.m_vertices[e].x * t.x + this.m_vertices[e].y * t.y;
          n > o && ((i = e), (o = n));
        }
        return i;
      }),
      (s.prototype.GetSupportVertex = function (t) {
        let i = 0,
          o = this.m_vertices[0].x * t.x + this.m_vertices[0].y * t.y;
        for (let e = 1; e < this.m_vertexCount; ++e) {
          let n = this.m_vertices[e].x * t.x + this.m_vertices[e].y * t.y;
          n > o && ((i = e), (o = n));
        }
        return this.m_vertices[i];
      }),
      (s.prototype.Validate = function () {
        return !1;
      }),
      (s.prototype.b2PolygonShape = function () {
        this.__super.b2Shape.call(this),
          (this.m_type = l.e_polygonShape),
          (this.m_centroid = new c()),
          (this.m_vertices = []),
          (this.m_normals = []);
      }),
      (s.prototype.Reserve = function (t) {
        for (let i = this.m_vertices.length; i < t; i++)
          (this.m_vertices[i] = new c()), (this.m_normals[i] = new c());
      }),
      (s.ComputeCentroid = function (t, i) {
        let o = new c(),
          e = 0;
        for (let n = 0; n < i; ++n) {
          let s = t[n],
            l = n + 1 < i ? t[n + 1] : t[0],
            m = s.x - 0,
            r = s.y - 0,
            a = l.x - 0,
            c = 0.5 * (m * (l.y - 0) - r * a);
          (e += c), (o.x += c * (1 / 3) * (0 + s.x + l.x)), (o.y += c * (1 / 3) * (0 + s.y + l.y));
        }
        return (o.x *= 1 / e), (o.y *= 1 / e), o;
      }),
      (s.ComputeOBB = function (t, i, o) {
        void 0 === o && (o = 0);
        let e = 0,
          n = [];
        for (e = 0; e < o; ++e) n.push(i[e]);
        n[o] = n[0];
        let s = Number.MAX_VALUE;
        for (e = 1; e <= o; ++e) {
          let i = n[e - 1],
            l = n[e].x - i.x,
            m = n[e].y - i.y,
            r = Math.sqrt(l * l + m * m),
            a = -(m /= r),
            c = (l /= r),
            _ = Number.MAX_VALUE,
            h = Number.MAX_VALUE,
            p = -Number.MAX_VALUE,
            y = -Number.MAX_VALUE;
          for (let t = 0; t < o; ++t) {
            let o = n[t].x - i.x,
              e = n[t].y - i.y,
              s = l * o + m * e,
              r = a * o + c * e;
            s < _ && (_ = s), r < h && (h = r), s > p && (p = s), r > y && (y = r);
          }
          let u = (p - _) * (y - h);
          if (u < 0.95 * s) {
            (s = u), (t.R.col1.x = l), (t.R.col1.y = m), (t.R.col2.x = a), (t.R.col2.y = c);
            let o = 0.5 * (_ + p),
              e = 0.5 * (h + y),
              n = t.R;
            (t.center.x = i.x + (n.col1.x * o + n.col2.x * e)),
              (t.center.y = i.y + (n.col1.y * o + n.col2.y * e)),
              (t.extents.x = 0.5 * (p - _)),
              (t.extents.y = 0.5 * (y - h));
          }
        }
      }),
      Box2D.postDefs.push(function () {
        Box2D.Collision.Shapes.b2PolygonShape.s_mat = new m();
      }),
      (l.b2Shape = function () {}),
      (l.prototype.Copy = function () {
        return null;
      }),
      (l.prototype.Set = function (t) {
        this.m_radius = t.m_radius;
      }),
      (l.prototype.GetType = function () {
        return this.m_type;
      }),
      (l.prototype.TestPoint = function (t, i) {
        return !1;
      }),
      (l.prototype.RayCast = function (t, i, o) {
        return !1;
      }),
      (l.prototype.ComputeAABB = function (t, i) {}),
      (l.prototype.ComputeMass = function (t, i) {}),
      (l.prototype.ComputeSubmergedArea = function (t, i, o, e) {
        return 0;
      }),
      (l.TestOverlap = function (t, i, o, e) {
        let n = new h();
        (n.proxyA = new y()),
          n.proxyA.Set(t),
          (n.proxyB = new y()),
          n.proxyB.Set(o),
          (n.transformA = i),
          (n.transformB = e),
          (n.useRadii = !0);
        let s = new u();
        s.count = 0;
        let l = new p();
        return _.Distance(l, s, n), l.distance < 10 * Number.MIN_VALUE;
      }),
      (l.prototype.b2Shape = function () {
        (this.m_type = l.e_unknownShape), (this.m_radius = t.b2_linearSlop);
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Collision.Shapes.b2Shape.e_unknownShape = -1),
          (Box2D.Collision.Shapes.b2Shape.e_circleShape = 0),
          (Box2D.Collision.Shapes.b2Shape.e_polygonShape = 1),
          (Box2D.Collision.Shapes.b2Shape.e_edgeShape = 2),
          (Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount = 3),
          (Box2D.Collision.Shapes.b2Shape.e_hitCollide = 1),
          (Box2D.Collision.Shapes.b2Shape.e_missCollide = 0),
          (Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide = -1);
      });
  })(),
  (function () {
    let t = Box2D.Common.b2Color,
      i = Box2D.Common.b2Settings,
      o = Box2D.Common.Math.b2Math;
    (t.b2Color = function () {
      (this._r = 0), (this._g = 0), (this._b = 0);
    }),
      (t.prototype.b2Color = function (t, i, e) {
        (this._r = Box2D.parseUInt(255 * o.Clamp(t, 0, 1))),
          (this._g = Box2D.parseUInt(255 * o.Clamp(i, 0, 1))),
          (this._b = Box2D.parseUInt(255 * o.Clamp(e, 0, 1)));
      }),
      (t.prototype.Set = function (t, i, e) {
        (this._r = Box2D.parseUInt(255 * o.Clamp(t, 0, 1))),
          (this._g = Box2D.parseUInt(255 * o.Clamp(i, 0, 1))),
          (this._b = Box2D.parseUInt(255 * o.Clamp(e, 0, 1)));
      }),
      Object.defineProperty(t.prototype, "r", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          void 0 === t && (t = 0), (this._r = Box2D.parseUInt(255 * o.Clamp(t, 0, 1)));
        },
      }),
      Object.defineProperty(t.prototype, "g", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          void 0 === t && (t = 0), (this._g = Box2D.parseUInt(255 * o.Clamp(t, 0, 1)));
        },
      }),
      Object.defineProperty(t.prototype, "b", {
        enumerable: !1,
        configurable: !0,
        set: function (t) {
          void 0 === t && (t = 0), (this._b = Box2D.parseUInt(255 * o.Clamp(t, 0, 1)));
        },
      }),
      Object.defineProperty(t.prototype, "color", {
        enumerable: !1,
        configurable: !0,
        get: function () {
          return (this._r << 16) | (this._g << 8) | this._b;
        },
      }),
      (i.b2Settings = function () {}),
      (i.b2MixFriction = function (t, i) {
        return Math.sqrt(t * i);
      }),
      (i.b2MixRestitution = function (t, i) {
        return t > i ? t : i;
      }),
      (i.b2MixRestitutionMin = function (t, i) {
        return t > 1 ? t : i;
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Common.b2Settings.VERSION = "2.1alpha custom"),
          (Box2D.Common.b2Settings.USHRT_MAX = 65535),
          (Box2D.Common.b2Settings.b2_pi = Math.PI),
          (Box2D.Common.b2Settings.b2_maxManifoldPoints = 2),
          (Box2D.Common.b2Settings.b2_aabbExtension = 0.1),
          (Box2D.Common.b2Settings.b2_aabbMultiplier = 2),
          (Box2D.Common.b2Settings.b2_linearSlop = 0.005),
          (Box2D.Common.b2Settings.b2_polygonRadius = 2 * i.b2_linearSlop),
          (Box2D.Common.b2Settings.b2_angularSlop = (2 / 180) * i.b2_pi),
          (Box2D.Common.b2Settings.b2_toiSlop = 8 * i.b2_linearSlop),
          (Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland = 32),
          (Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland = 32),
          (Box2D.Common.b2Settings.b2_velocityThreshold = 1),
          (Box2D.Common.b2Settings.b2_maxLinearCorrection = 0.2),
          (Box2D.Common.b2Settings.b2_maxAngularCorrection = (8 / 180) * i.b2_pi),
          (Box2D.Common.b2Settings.b2_maxTranslation = 6),
          (Box2D.Common.b2Settings.b2_maxTranslationSquared =
            i.b2_maxTranslation * i.b2_maxTranslation),
          (Box2D.Common.b2Settings.b2_maxRotation = 0.5 * i.b2_pi),
          (Box2D.Common.b2Settings.b2_maxRotationSquared = i.b2_maxRotation * i.b2_maxRotation),
          (Box2D.Common.b2Settings.b2_contactBaumgarte = 0.2),
          (Box2D.Common.b2Settings.b2_timeToSleep = 0.5),
          (Box2D.Common.b2Settings.b2_linearSleepTolerance = 0.01),
          (Box2D.Common.b2Settings.b2_angularSleepTolerance = (2 / 180) * i.b2_pi);
      });
  })(),
  (function () {
    let t = Box2D.Common.Math.b2Mat22,
      i = Box2D.Common.Math.b2Mat33,
      o = Box2D.Common.Math.b2Math,
      e = Box2D.Common.Math.b2Sweep,
      n = Box2D.Common.Math.b2Transform,
      s = Box2D.Common.Math.b2Vec2,
      l = Box2D.Common.Math.b2Vec3;
    (t.prototype.b2Mat22 = function () {
      this.SetIdentity();
    }),
      (t.FromAngle = function (i) {
        let o = new t();
        return o.Set(i), o;
      }),
      (t.FromVV = function (i, o) {
        let e = new t();
        return e.SetVV(i, o), e;
      }),
      (t.prototype.Set = function (t) {
        let i = Math.cos(t),
          o = Math.sin(t);
        (this.col1.x = i), (this.col2.x = -o), (this.col1.y = o), (this.col2.y = i);
      }),
      (t.prototype.SetVV = function (t, i) {
        this.col1.SetV(t), this.col2.SetV(i);
      }),
      (t.prototype.Copy = function () {
        let i = new t();
        return i.SetM(this), i;
      }),
      (t.prototype.SetM = function (t) {
        this.col1.SetV(t.col1), this.col2.SetV(t.col2);
      }),
      (t.prototype.AddM = function (t) {
        (this.col1.x += t.col1.x),
          (this.col1.y += t.col1.y),
          (this.col2.x += t.col2.x),
          (this.col2.y += t.col2.y);
      }),
      (t.prototype.SetIdentity = function () {
        (this.col1.x = 1), (this.col2.x = 0), (this.col1.y = 0), (this.col2.y = 1);
      }),
      (t.prototype.SetZero = function () {
        (this.col1.x = 0), (this.col2.x = 0), (this.col1.y = 0), (this.col2.y = 0);
      }),
      (t.prototype.GetAngle = function () {
        return Math.atan2(this.col1.y, this.col1.x);
      }),
      (t.prototype.GetInverse = function (t) {
        let i = this.col1.x,
          o = this.col2.x,
          e = this.col1.y,
          n = this.col2.y,
          s = i * n - o * e;
        return (
          0 !== s && (s = 1 / s),
          (t.col1.x = s * n),
          (t.col2.x = -s * o),
          (t.col1.y = -s * e),
          (t.col2.y = s * i),
          t
        );
      }),
      (t.prototype.Solve = function (t, i, o) {
        let e = this.col1.x,
          n = this.col2.x,
          s = this.col1.y,
          l = this.col2.y,
          m = e * l - n * s;
        return 0 !== m && (m = 1 / m), (t.x = m * (l * i - n * o)), (t.y = m * (e * o - s * i)), t;
      }),
      (t.prototype.Abs = function () {
        this.col1.Abs(), this.col2.Abs();
      }),
      (i.b2Mat33 = function () {
        (this.col1 = new l(0, 0, 0)), (this.col2 = new l(0, 0, 0)), (this.col3 = new l(0, 0, 0));
      }),
      (i.prototype.b2Mat33 = function (t, i, o) {
        t || i || o
          ? (this.col1.SetV(t), this.col2.SetV(i), this.col3.SetV(o))
          : (this.col1.SetZero(), this.col2.SetZero(), this.col3.SetZero());
      }),
      (i.prototype.SetVVV = function (t, i, o) {
        this.col1.SetV(t), this.col2.SetV(i), this.col3.SetV(o);
      }),
      (i.prototype.Copy = function () {
        return new i(this.col1, this.col2, this.col3);
      }),
      (i.prototype.SetM = function (t) {
        this.col1.SetV(t.col1), this.col2.SetV(t.col2), this.col3.SetV(t.col3);
      }),
      (i.prototype.AddM = function (t) {
        (this.col1.x += t.col1.x),
          (this.col1.y += t.col1.y),
          (this.col1.z += t.col1.z),
          (this.col2.x += t.col2.x),
          (this.col2.y += t.col2.y),
          (this.col2.z += t.col2.z),
          (this.col3.x += t.col3.x),
          (this.col3.y += t.col3.y),
          (this.col3.z += t.col3.z);
      }),
      (i.prototype.SetIdentity = function () {
        (this.col1.x = 1),
          (this.col2.x = 0),
          (this.col3.x = 0),
          (this.col1.y = 0),
          (this.col2.y = 1),
          (this.col3.y = 0),
          (this.col1.z = 0),
          (this.col2.z = 0),
          (this.col3.z = 1);
      }),
      (i.prototype.SetZero = function () {
        (this.col1.x = 0),
          (this.col2.x = 0),
          (this.col3.x = 0),
          (this.col1.y = 0),
          (this.col2.y = 0),
          (this.col3.y = 0),
          (this.col1.z = 0),
          (this.col2.z = 0),
          (this.col3.z = 0);
      }),
      (i.prototype.Solve22 = function (t, i, o) {
        let e = this.col1.x,
          n = this.col2.x,
          s = this.col1.y,
          l = this.col2.y,
          m = e * l - n * s;
        return 0 !== m && (m = 1 / m), (t.x = m * (l * i - n * o)), (t.y = m * (e * o - s * i)), t;
      }),
      (i.prototype.Solve33 = function (t, i, o, e) {
        let n = this.col1.x,
          s = this.col1.y,
          l = this.col1.z,
          m = this.col2.x,
          r = this.col2.y,
          a = this.col2.z,
          c = this.col3.x,
          _ = this.col3.y,
          h = this.col3.z,
          p = n * (r * h - a * _) + s * (a * c - m * h) + l * (m * _ - r * c);
        return (
          0 !== p && (p = 1 / p),
          (t.x = p * (i * (r * h - a * _) + o * (a * c - m * h) + e * (m * _ - r * c))),
          (t.y = p * (n * (o * h - e * _) + s * (e * c - i * h) + l * (i * _ - o * c))),
          (t.z = p * (n * (r * e - a * o) + s * (a * i - m * e) + l * (m * o - r * i))),
          t
        );
      }),
      (o.b2Math = function () {}),
      (o.IsValid = function (t) {
        return isFinite(t);
      }),
      (o.Dot = function (t, i) {
        return t.x * i.x + t.y * i.y;
      }),
      (o.CrossVV = function (t, i) {
        return t.x * i.y - t.y * i.x;
      }),
      (o.CrossVF = function (t, i) {
        return new s(i * t.y, -i * t.x);
      }),
      (o.CrossFV = function (t, i) {
        return new s(-t * i.y, t * i.x);
      }),
      (o.MulMV = function (t, i) {
        return new s(t.col1.x * i.x + t.col2.x * i.y, t.col1.y * i.x + t.col2.y * i.y);
      }),
      (o.MulTMV = function (t, i) {
        return new s(o.Dot(i, t.col1), o.Dot(i, t.col2));
      }),
      (o.MulX = function (t, i) {
        return new s(
          t.R.col1.x * i.x + t.R.col2.x * i.y + t.position.x,
          t.R.col1.y * i.x + t.R.col2.y * i.y + t.position.y
        );
      }),
      (o.MulXT = function (t, i) {
        let e = o.SubtractVV(i, t.position),
          n = e.x * t.R.col1.x + e.y * t.R.col1.y;
        return (e.y = e.x * t.R.col2.x + e.y * t.R.col2.y), (e.x = n), e;
      }),
      (o.AddVV = function (t, i) {
        return new s(t.x + i.x, t.y + i.y);
      }),
      (o.SubtractVV = function (t, i) {
        return new s(t.x - i.x, t.y - i.y);
      }),
      (o.Distance = function (t, i) {
        let o = t.x - i.x,
          e = t.y - i.y;
        return Math.sqrt(o * o + e * e);
      }),
      (o.DistanceSquared = function (t, i) {
        let o = t.x - i.x,
          e = t.y - i.y;
        return o * o + e * e;
      }),
      (o.MulFV = function (t, i) {
        return new s(t * i.x, t * i.y);
      }),
      (o.AddMM = function (i, e) {
        return t.FromVV(o.AddVV(i.col1, e.col1), o.AddVV(i.col2, e.col2));
      }),
      (o.MulMM = function (i, e) {
        return t.FromVV(o.MulMV(i, e.col1), o.MulMV(i, e.col2));
      }),
      (o.MulTMM = function (i, e) {
        let n = new s(o.Dot(i.col1, e.col1), o.Dot(i.col2, e.col1)),
          l = new s(o.Dot(i.col1, e.col2), o.Dot(i.col2, e.col2));
        return t.FromVV(n, l);
      }),
      (o.Abs = function (t) {
        return t > 0 ? t : -t;
      }),
      (o.AbsV = function (t) {
        return new s(o.Abs(t.x), o.Abs(t.y));
      }),
      (o.AbsM = function (i) {
        return t.FromVV(o.AbsV(i.col1), o.AbsV(i.col2));
      }),
      (o.Min = function (t, i) {
        return t < i ? t : i;
      }),
      (o.MinV = function (t, i) {
        return new s(o.Min(t.x, i.x), o.Min(t.y, i.y));
      }),
      (o.Max = function (t, i) {
        return t > i ? t : i;
      }),
      (o.MaxV = function (t, i) {
        return new s(o.Max(t.x, i.x), o.Max(t.y, i.y));
      }),
      (o.Clamp = function (t, i, o) {
        return t < i ? i : t > o ? o : t;
      }),
      (o.ClampV = function (t, i, e) {
        return o.MaxV(i, o.MinV(t, e));
      }),
      (o.Swap = function (t, i) {
        let o = t[0];
        (t[0] = i[0]), (i[0] = o);
      }),
      (o.Random = function () {
        return 2 * Math.random() - 1;
      }),
      (o.RandomRange = function (t, i) {
        return (i - t) * Math.random() + t;
      }),
      (o.NextPowerOfTwo = function (t) {
        return (
          (t |= (t >> 1) & 2147483647),
          (t |= (t >> 2) & 1073741823),
          (t |= (t >> 4) & 268435455),
          (t |= (t >> 8) & 16777215),
          (t |= (t >> 16) & 65535) + 1
        );
      }),
      (o.IsPowerOfTwo = function (t) {
        return t > 0 && 0 == (t & (t - 1));
      }),
      (e.prototype.Set = function (t) {
        this.localCenter.SetV(t.localCenter),
          this.c0.SetV(t.c0),
          this.c.SetV(t.c),
          (this.a0 = t.a0),
          (this.a = t.a),
          (this.t0 = t.t0);
      }),
      (e.prototype.Copy = function () {
        let t = new e();
        return (
          t.localCenter.SetV(this.localCenter),
          t.c0.SetV(this.c0),
          t.c.SetV(this.c),
          (t.a0 = this.a0),
          (t.a = this.a),
          (t.t0 = this.t0),
          t
        );
      }),
      (e.prototype.GetTransform = function (t, i) {
        (t.position.x = (1 - i) * this.c0.x + i * this.c.x),
          (t.position.y = (1 - i) * this.c0.y + i * this.c.y),
          t.R.Set((1 - i) * this.a0 + i * this.a);
        let o = t.R;
        (t.position.x -= o.col1.x * this.localCenter.x + o.col2.x * this.localCenter.y),
          (t.position.y -= o.col1.y * this.localCenter.x + o.col2.y * this.localCenter.y);
      }),
      (e.prototype.Advance = function (t) {
        if (this.t0 < t && 1 - this.t0 > Number.MIN_VALUE) {
          let i = (t - this.t0) / (1 - this.t0);
          (this.c0.x = (1 - i) * this.c0.x + i * this.c.x),
            (this.c0.y = (1 - i) * this.c0.y + i * this.c.y),
            (this.a0 = (1 - i) * this.a0 + i * this.a),
            (this.t0 = t);
        }
      }),
      (n.prototype.Initialize = function (t, i) {
        this.position.SetV(t), this.R.SetM(i);
      }),
      (n.prototype.SetIdentity = function () {
        this.position.SetZero(), this.R.SetIdentity();
      }),
      (n.prototype.Set = function (t) {
        this.position.SetV(t.position), this.R.SetM(t.R);
      }),
      (n.prototype.GetAngle = function () {
        return Math.atan2(this.R.col1.y, this.R.col1.x);
      }),
      (s.prototype.SetZero = function () {
        (this.x = 0), (this.y = 0);
      }),
      (s.prototype.Set = function (t, i) {
        (this.x = t), (this.y = i);
      }),
      (s.prototype.SetV = function (t) {
        (this.x = t.x), (this.y = t.y);
      }),
      (s.prototype.GetNegative = function () {
        return new s(-this.x, -this.y);
      }),
      (s.prototype.NegativeSelf = function () {
        (this.x = -this.x), (this.y = -this.y);
      }),
      (s.Make = function (t, i) {
        return new s(t, i);
      }),
      (s.prototype.Copy = function () {
        return new s(this.x, this.y);
      }),
      (s.prototype.Add = function (t) {
        (this.x += t.x), (this.y += t.y);
      }),
      (s.prototype.Subtract = function (t) {
        (this.x -= t.x), (this.y -= t.y);
      }),
      (s.prototype.Multiply = function (t) {
        (this.x *= t), (this.y *= t);
      }),
      (s.prototype.MulM = function (t) {
        let i = this.x;
        (this.x = t.col1.x * i + t.col2.x * this.y), (this.y = t.col1.y * i + t.col2.y * this.y);
      }),
      (s.prototype.MulTM = function (t) {
        let i = o.Dot(this, t.col1);
        (this.y = o.Dot(this, t.col2)), (this.x = i);
      }),
      (s.prototype.CrossVF = function (t) {
        let i = this.x;
        (this.x = t * this.y), (this.y = -t * i);
      }),
      (s.prototype.CrossFV = function (t) {
        let i = this.x;
        (this.x = -t * this.y), (this.y = t * i);
      }),
      (s.prototype.MinV = function (t) {
        (this.x = this.x < t.x ? this.x : t.x), (this.y = this.y < t.y ? this.y : t.y);
      }),
      (s.prototype.MaxV = function (t) {
        (this.x = this.x > t.x ? this.x : t.x), (this.y = this.y > t.y ? this.y : t.y);
      }),
      (s.prototype.Abs = function () {
        this.x < 0 && (this.x = -this.x), this.y < 0 && (this.y = -this.y);
      }),
      (s.prototype.Length = function () {
        return Math.sqrt(this.x * this.x + this.y * this.y);
      }),
      (s.prototype.LengthSquared = function () {
        return this.x * this.x + this.y * this.y;
      }),
      (s.prototype.Normalize = function () {
        let t = Math.sqrt(this.x * this.x + this.y * this.y);
        if (t < Number.MIN_VALUE) return 0;
        let i = 1 / t;
        return (this.x *= i), (this.y *= i), t;
      }),
      (s.prototype.IsValid = function () {
        return o.IsValid(this.x) && o.IsValid(this.y);
      }),
      (l.prototype.b2Vec3 = function (t, i, o) {
        (this.x = t), (this.y = i), (this.z = o);
      }),
      (l.prototype.SetZero = function () {
        this.x = this.y = this.z = 0;
      }),
      (l.prototype.Set = function (t, i, o) {
        void 0 === t && (t = i = o = 0), (this.x = t), (this.y = i), (this.z = o);
      }),
      (l.prototype.SetV = function (t) {
        (this.x = t.x), (this.y = t.y), (this.z = t.z);
      }),
      (l.prototype.GetNegative = function () {
        return new l(-this.x, -this.y, -this.z);
      }),
      (l.prototype.NegativeSelf = function () {
        (this.x = -this.x), (this.y = -this.y), (this.z = -this.z);
      }),
      (l.prototype.Copy = function () {
        return new l(this.x, this.y, this.z);
      }),
      (l.prototype.Add = function (t) {
        (this.x += t.x), (this.y += t.y), (this.z += t.z);
      }),
      (l.prototype.Subtract = function (t) {
        (this.x -= t.x), (this.y -= t.y), (this.z -= t.z);
      }),
      (l.prototype.Multiply = function (t) {
        void 0 === t && (t = 0), (this.x *= t), (this.y *= t), (this.z *= t);
      });
  })(),
  (function () {
    Box2D.Dynamics.Controllers.b2ControllerEdge,
      Box2D.Common.Math.b2Mat22,
      Box2D.Common.Math.b2Mat33;
    let t = Box2D.Common.Math.b2Math,
      i = Box2D.Common.Math.b2Sweep,
      o = Box2D.Common.Math.b2Transform,
      e = Box2D.Common.Math.b2Vec2,
      n = (Box2D.Common.Math.b2Vec3, Box2D.Common.b2Color),
      s = (Box2D.Common.b2internal, Box2D.Common.b2Settings),
      l = Box2D.Collision.b2AABB,
      m =
        (Box2D.Collision.b2Bound,
        Box2D.Collision.b2BoundValues,
        Box2D.Collision.b2Collision,
        Box2D.Collision.b2ContactID,
        Box2D.Collision.b2ContactPoint),
      r =
        (Box2D.Collision.b2Distance,
        Box2D.Collision.b2DistanceInput,
        Box2D.Collision.b2DistanceOutput,
        Box2D.Collision.b2DistanceProxy,
        Box2D.Collision.b2DynamicTree,
        Box2D.Collision.b2DynamicTreeBroadPhase),
      a =
        (Box2D.Collision.b2DynamicTreeNode,
        Box2D.Collision.b2DynamicTreePair,
        Box2D.Collision.b2Manifold,
        Box2D.Collision.b2ManifoldPoint,
        Box2D.Collision.b2Point,
        Box2D.Collision.b2RayCastInput),
      c = Box2D.Collision.b2RayCastOutput,
      _ =
        (Box2D.Collision.b2Segment,
        Box2D.Collision.b2SeparationFunction,
        Box2D.Collision.b2Simplex,
        Box2D.Collision.b2SimplexCache,
        Box2D.Collision.b2SimplexVertex,
        Box2D.Collision.b2TimeOfImpact,
        Box2D.Collision.b2TOIInput,
        Box2D.Collision.b2WorldManifold,
        Box2D.Collision.ClipVertex,
        Box2D.Collision.Features,
        Box2D.Collision.IBroadPhase,
        Box2D.Collision.Shapes.b2CircleShape,
        Box2D.Collision.Shapes.b2EdgeChainDef,
        Box2D.Collision.Shapes.b2EdgeShape,
        Box2D.Collision.Shapes.b2MassData),
      h = (Box2D.Collision.Shapes.b2PolygonShape, Box2D.Collision.Shapes.b2Shape),
      p = Box2D.Dynamics.b2Body,
      y = Box2D.Dynamics.b2BodyDef,
      u = Box2D.Dynamics.b2ContactFilter,
      x = Box2D.Dynamics.b2ContactImpulse,
      f = Box2D.Dynamics.b2ContactListener,
      b = Box2D.Dynamics.b2ContactManager,
      d = Box2D.Dynamics.b2DestructionListener,
      B = Box2D.Dynamics.b2FilterData,
      D = Box2D.Dynamics.b2Fixture,
      C = Box2D.Dynamics.b2FixtureDef,
      A = Box2D.Dynamics.b2Island,
      S = Box2D.Dynamics.b2TimeStep,
      w = Box2D.Dynamics.b2World,
      v = (Box2D.Dynamics.Contacts.b2CircleContact, Box2D.Dynamics.Contacts.b2Contact),
      g =
        (Box2D.Dynamics.Contacts.b2ContactConstraint,
        Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
        Box2D.Dynamics.Contacts.b2ContactEdge,
        Box2D.Dynamics.Contacts.b2ContactFactory),
      M =
        (Box2D.Dynamics.Contacts.b2ContactRegister,
        Box2D.Dynamics.Contacts.b2ContactResult,
        Box2D.Dynamics.Contacts.b2ContactSolver),
      V =
        (Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
        Box2D.Dynamics.Contacts.b2NullContact,
        Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
        Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
        Box2D.Dynamics.Contacts.b2PolygonContact,
        Box2D.Dynamics.Contacts.b2PositionSolverManifold,
        Box2D.Dynamics.Controllers.b2Controller,
        Box2D.Dynamics.Joints.b2DistanceJoint,
        Box2D.Dynamics.Joints.b2DistanceJointDef,
        Box2D.Dynamics.Joints.b2FrictionJoint,
        Box2D.Dynamics.Joints.b2FrictionJointDef,
        Box2D.Dynamics.Joints.b2GearJoint,
        Box2D.Dynamics.Joints.b2GearJointDef,
        Box2D.Dynamics.Joints.b2Jacobian,
        Box2D.Dynamics.Joints.b2Joint);
    Box2D.Dynamics.Joints.b2JointDef,
      Box2D.Dynamics.Joints.b2JointEdge,
      Box2D.Dynamics.Joints.b2LineJoint,
      Box2D.Dynamics.Joints.b2LineJointDef,
      Box2D.Dynamics.Joints.b2MouseJoint,
      Box2D.Dynamics.Joints.b2MouseJointDef,
      Box2D.Dynamics.Joints.b2PrismaticJoint,
      Box2D.Dynamics.Joints.b2PrismaticJointDef,
      Box2D.Dynamics.Joints.b2PulleyJoint,
      Box2D.Dynamics.Joints.b2PulleyJointDef,
      Box2D.Dynamics.Joints.b2RevoluteJoint,
      Box2D.Dynamics.Joints.b2RevoluteJointDef,
      Box2D.Dynamics.Joints.b2WeldJoint,
      Box2D.Dynamics.Joints.b2WeldJointDef;
    (p.b2Body = function () {
      (this.m_xf = new o(new e())),
        (this.m_sweep = new i()),
        (this.m_linearVelocity = new e()),
        (this.m_force = new e()),
        (this.m_gravityScale = 1);
    }),
      (p.prototype.connectEdges = function (i, o, e) {
        void 0 === e && (e = 0);
        let n = Math.atan2(o.GetDirectionVector().y, o.GetDirectionVector().x),
          l = Math.tan(0.5 * (n - e)),
          m = t.MulFV(l, o.GetDirectionVector());
        (m = t.SubtractVV(m, o.GetNormalVector())),
          (m = t.MulFV(s.b2_toiSlop, m)),
          (m = t.AddVV(m, o.GetVertex1()));
        let r = t.AddVV(i.GetDirectionVector(), o.GetDirectionVector());
        r.Normalize();
        let a = t.Dot(i.GetDirectionVector(), o.GetNormalVector()) > 0;
        return i.SetNextEdge(o, m, r, a), o.SetPrevEdge(i, m, r, a), n;
      }),
      (p.prototype.CreateFixture = function (t) {
        if (this.m_world.IsLocked()) return null;
        let i = new D();
        if ((i.Create(this, this.m_xf, t), this.m_flags & p.e_activeFlag)) {
          let t = this.m_world.m_contactManager.m_broadPhase;
          i.CreateProxy(t, this.m_xf);
        }
        return (
          (i.m_next = this.m_fixtureList),
          (this.m_fixtureList = i),
          ++this.m_fixtureCount,
          (i.m_body = this),
          i.m_density > 0 && this.ResetMassData(),
          (this.m_world.m_flags |= w.e_newFixture),
          i
        );
      }),
      (p.prototype.CreateFixture2 = function (t, i) {
        void 0 === i && (i = 0);
        let o = new C();
        return (o.shape = t), (o.density = i), this.CreateFixture(o);
      }),
      (p.prototype.DestroyFixture = function (t) {
        if (!0 === this.m_world.IsLocked()) return;
        let i = this.m_fixtureList,
          o = null;
        for (; null !== i; ) {
          if (i === t) {
            o ? (o.m_next = t.m_next) : (this.m_fixtureList = t.m_next);
            break;
          }
          (o = i), (i = i.m_next);
        }
        let e = this.m_contactList;
        for (; e; ) {
          let i = e.contact;
          e = e.next;
          let o = i.m_fixtureA,
            n = i.m_fixtureB;
          (t !== o && t !== n) || this.m_world.m_contactManager.Destroy(i);
        }
        if (this.m_flags & p.e_activeFlag) {
          let i = this.m_world.m_contactManager.m_broadPhase;
          t.DestroyProxy(i);
        }
        t.Destroy(),
          (t.m_body = null),
          (t.m_next = null),
          --this.m_fixtureCount,
          this.ResetMassData();
      }),
      (p.prototype.SetPositionAndAngle = function (t, i) {
        let o;
        this.m_xf.R.Set(i), this.m_xf.position.SetV(t);
        let e = this.m_xf.R,
          n = this.m_sweep.localCenter;
        (this.m_sweep.c.x = e.col1.x * n.x + e.col2.x * n.y),
          (this.m_sweep.c.y = e.col1.y * n.x + e.col2.y * n.y),
          (this.m_sweep.c.x += this.m_xf.position.x),
          (this.m_sweep.c.y += this.m_xf.position.y),
          this.m_sweep.c0.SetV(this.m_sweep.c),
          (this.m_sweep.a0 = this.m_sweep.a = i);
        let s = this.m_world.m_contactManager.m_broadPhase;
        for (o = this.m_fixtureList; o; o = o.m_next) o.Synchronize(s, this.m_xf, this.m_xf);
        this.m_world.m_contactManager.FindNewContacts();
      }),
      (p.prototype.SetTransform = function (t) {
        this.SetPositionAndAngle(t.position, t.GetAngle());
      }),
      (p.prototype.GetTransform = function () {
        return this.m_xf;
      }),
      (p.prototype.GetPosition = function () {
        return this.m_xf.position;
      }),
      (p.prototype.SetPosition = function (t) {
        this.SetPositionAndAngle(t, this.GetAngle());
      }),
      (p.prototype.GetAngle = function () {
        return this.m_sweep.a;
      }),
      (p.prototype.SetAngle = function (t) {
        this.SetPositionAndAngle(this.GetPosition(), t);
      }),
      (p.prototype.SetGravityScale = function (t) {
        this.m_gravityScale = t;
      }),
      (p.prototype.GetGravityScale = function () {
        return this.m_gravityScale;
      }),
      (p.prototype.GetWorldCenter = function () {
        return this.m_sweep.c;
      }),
      (p.prototype.GetLocalCenter = function () {
        return this.m_sweep.localCenter;
      }),
      (p.prototype.SetLinearVelocity = function (t) {
        this.m_type !== p.b2_staticBody && this.m_linearVelocity.SetV(t);
      }),
      (p.prototype.GetLinearVelocity = function () {
        return this.m_linearVelocity;
      }),
      (p.prototype.SetAngularVelocity = function (t) {
        this.m_type !== p.b2_staticBody && (void 0 === t && (t = 0), (this.m_angularVelocity = t));
      }),
      (p.prototype.GetAngularVelocity = function () {
        return this.m_angularVelocity;
      }),
      (p.prototype.GetDefinition = function () {
        let t = new y();
        return (
          (t.type = this.m_type),
          (t.allowSleep = (this.m_flags & p.e_allowSleepFlag) === p.e_allowSleepFlag),
          (t.angle = this.GetAngle()),
          (t.angularDamping = this.m_angularDamping),
          (t.angularVelocity = this.m_angularVelocity),
          (t.fixedRotation = (this.m_flags & p.e_fixedRotationFlag) === p.e_fixedRotationFlag),
          (t.bullet = (this.m_flags & p.e_bulletFlag) === p.e_bulletFlag),
          (t.awake = (this.m_flags & p.e_awakeFlag) === p.e_awakeFlag),
          (t.linearDamping = this.m_linearDamping),
          t.linearVelocity.SetV(this.m_linearVelocity),
          (t.position = this.GetPosition()),
          (t.userData = this.GetUserData()),
          t
        );
      }),
      (p.prototype.ApplyForce = function (t, i) {
        this.m_type === p.b2_dynamicBody &&
          (this.m_isAwake || this.SetAwake(!0),
          (this.m_force.x += t.x),
          (this.m_force.y += t.y),
          (this.m_torque += (i.x - this.m_sweep.c.x) * t.y - (i.y - this.m_sweep.c.y) * t.x));
      }),
      (p.prototype.ApplyTorque = function (t) {
        this.m_type === p.b2_dynamicBody &&
          (void 0 === t && (t = 0), this.m_isAwake || this.SetAwake(!0), (this.m_torque += t));
      }),
      (p.prototype.ApplyImpulse = function (t, i) {
        this.m_type === p.b2_dynamicBody &&
          (this.m_isAwake || this.SetAwake(!0),
          (this.m_linearVelocity.x += this.m_invMass * t.x),
          (this.m_linearVelocity.y += this.m_invMass * t.y),
          (this.m_angularVelocity +=
            this.m_invI * ((i.x - this.m_sweep.c.x) * t.y - (i.y - this.m_sweep.c.y) * t.x)));
      }),
      (p.prototype.Split = function (i) {
        let o,
          e = this.m_linearVelocity.Copy(),
          n = this.m_angularVelocity,
          s = this.m_sweep.c,
          l = this,
          m = this.m_world.CreateBody(this.GetDefinition());
        for (let t = l.m_fixtureList; t; )
          if (i(t)) {
            let i = t.m_next;
            o ? (o.m_next = i) : (l.m_fixtureList = i),
              l.m_fixtureCount--,
              (t.m_next = m.m_fixtureList),
              (m.m_fixtureList = t),
              m.m_fixtureCount++,
              (t.m_body = m),
              (t = i);
          } else (o = t), (t = t.m_next);
        l.ResetMassData(), m.ResetMassData();
        let r = l.m_sweep.c,
          a = m.m_sweep.c,
          c = t.CrossFV(n, t.SubtractVV(r, s)),
          _ = t.CrossFV(n, t.SubtractVV(a, s)),
          h = t.AddVV(e, c),
          p = t.AddVV(e, _);
        return (
          l.SetLinearVelocity(h),
          m.SetLinearVelocity(p),
          l.SetAngularVelocity(n),
          m.SetAngularVelocity(n),
          l.SynchronizeFixtures(),
          m.SynchronizeFixtures(),
          m
        );
      }),
      (p.prototype.Merge = function (t) {
        let i;
        for (i = t.m_fixtureList; i; ) {
          let e = i.m_next;
          t.m_fixtureCount--,
            (i.m_next = this.m_fixtureList),
            (this.m_fixtureList = i),
            this.m_fixtureCount++,
            (i.m_body = o),
            (i = e);
        }
        this.m_fixtureCount = 0;
        let o = t;
        this.ResetMassData(), this.SynchronizeFixtures();
      }),
      (p.prototype.GetMass = function () {
        return this.m_mass;
      }),
      (p.prototype.GetInertia = function () {
        return this.m_I;
      }),
      (p.prototype.GetMassData = function (t) {
        (t.mass = this.m_mass), (t.I = this.m_I), t.center.SetV(this.m_sweep.localCenter);
      }),
      (p.prototype.SetMassData = function (i) {
        if (!0 === this.m_world.IsLocked()) return;
        if (this.m_type !== p.b2_dynamicBody) return;
        (this.m_invMass = 0),
          (this.m_I = 0),
          (this.m_invI = 0),
          (this.m_mass = i.mass),
          this.m_mass <= 0 && (this.m_mass = 1),
          (this.m_invMass = 1 / this.m_mass),
          i.I > 0 &&
            0 == (this.m_flags & p.e_fixedRotationFlag) &&
            ((this.m_I = i.I - this.m_mass * (i.center.x * i.center.x + i.center.y * i.center.y)),
            (this.m_invI = 1 / this.m_I));
        let o = this.m_sweep.c.Copy();
        this.m_sweep.localCenter.SetV(i.center),
          this.m_sweep.c0.SetV(t.MulX(this.m_xf, this.m_sweep.localCenter)),
          this.m_sweep.c.SetV(this.m_sweep.c0),
          (this.m_linearVelocity.x += this.m_angularVelocity * -(this.m_sweep.c.y - o.y)),
          (this.m_linearVelocity.y += this.m_angularVelocity * +(this.m_sweep.c.x - o.x));
      }),
      (p.prototype.ResetMassData = function () {
        if (
          ((this.m_mass = 0),
          (this.m_invMass = 0),
          (this.m_I = 0),
          (this.m_invI = 0),
          this.m_sweep.localCenter.SetZero(),
          this.m_type === p.b2_staticBody || this.m_type === p.b2_kinematicBody)
        )
          return;
        let i = e.Make(0, 0);
        for (let t = this.m_fixtureList; t; t = t.m_next) {
          if (0 === t.m_density) continue;
          let o = t.GetMassData();
          (this.m_mass += o.mass),
            (i.x += o.center.x * o.mass),
            (i.y += o.center.y * o.mass),
            (this.m_I += o.I);
        }
        this.m_mass > 0
          ? ((this.m_invMass = 1 / this.m_mass), (i.x *= this.m_invMass), (i.y *= this.m_invMass))
          : ((this.m_mass = 1), (this.m_invMass = 1)),
          this.m_I > 0 && 0 == (this.m_flags & p.e_fixedRotationFlag)
            ? ((this.m_I -= this.m_mass * (i.x * i.x + i.y * i.y)),
              (this.m_I *= this.m_inertiaScale),
              (this.m_invI = 1 / this.m_I))
            : ((this.m_I = 0), (this.m_invI = 0));
        let o = this.m_sweep.c.Copy();
        this.m_sweep.localCenter.SetV(i);
        let n = t.MulX(this.m_xf, this.m_sweep.localCenter);
        this.m_sweep.c0.SetV(n),
          this.m_sweep.c.SetV(this.m_sweep.c0),
          (this.m_linearVelocity.x += this.m_angularVelocity * -(this.m_sweep.c.y - o.y)),
          (this.m_linearVelocity.y += this.m_angularVelocity * +(this.m_sweep.c.x - o.x));
      }),
      (p.prototype.GetWorldPoint = function (t) {
        let i = this.m_xf.R,
          o = new e(i.col1.x * t.x + i.col2.x * t.y, i.col1.y * t.x + i.col2.y * t.y);
        return (o.x += this.m_xf.position.x), (o.y += this.m_xf.position.y), o;
      }),
      (p.prototype.GetWorldVector = function (i) {
        return t.MulMV(this.m_xf.R, i);
      }),
      (p.prototype.GetLocalPoint = function (i) {
        return t.MulXT(this.m_xf, i);
      }),
      (p.prototype.GetLocalVector = function (i) {
        return t.MulTMV(this.m_xf.R, i);
      }),
      (p.prototype.GetLinearVelocityFromWorldPoint = function (t) {
        return new e(
          this.m_linearVelocity.x - this.m_angularVelocity * (t.y - this.m_sweep.c.y),
          this.m_linearVelocity.y + this.m_angularVelocity * (t.x - this.m_sweep.c.x)
        );
      }),
      (p.prototype.GetLinearVelocityFromLocalPoint = function (t) {
        let i = this.m_xf.R,
          o = new e(i.col1.x * t.x + i.col2.x * t.y, i.col1.y * t.x + i.col2.y * t.y);
        return (
          (o.x += this.m_xf.position.x),
          (o.y += this.m_xf.position.y),
          new e(
            this.m_linearVelocity.x - this.m_angularVelocity * (o.y - this.m_sweep.c.y),
            this.m_linearVelocity.y + this.m_angularVelocity * (o.x - this.m_sweep.c.x)
          )
        );
      }),
      (p.prototype.GetLinearDamping = function () {
        return this.m_linearDamping;
      }),
      (p.prototype.SetLinearDamping = function (t) {
        void 0 === t && (t = 0), (this.m_linearDamping = t);
      }),
      (p.prototype.GetAngularDamping = function () {
        return this.m_angularDamping;
      }),
      (p.prototype.SetAngularDamping = function (t) {
        void 0 === t && (t = 0), (this.m_angularDamping = t);
      }),
      (p.prototype.SetType = function (t) {
        if ((void 0 === t && (t = 0), this.m_type !== t)) {
          (this.m_type = t),
            this.ResetMassData(),
            this.m_type === p.b2_staticBody &&
              (this.m_linearVelocity.SetZero(), (this.m_angularVelocity = 0)),
            this.SetAwake(!0),
            this.m_force.SetZero(),
            (this.m_torque = 0);
          for (let t = this.m_contactList; t; t = t.next) t.contact.m_isFiltered = !0;
        }
      }),
      (p.prototype.GetType = function () {
        return this.m_type;
      }),
      (p.prototype.SetBullet = function (t) {
        t ? (this.m_flags |= p.e_bulletFlag) : (this.m_flags &= ~p.e_bulletFlag);
      }),
      (p.prototype.IsBullet = function () {
        return (this.m_flags & p.e_bulletFlag) === p.e_bulletFlag;
      }),
      (p.prototype.SetSleepingAllowed = function (t) {
        t
          ? (this.m_flags |= p.e_allowSleepFlag)
          : ((this.m_flags &= ~p.e_allowSleepFlag), this.SetAwake(!0));
      }),
      (p.prototype.SetAwake = function (t) {
        (this.m_isAwake = t),
          t
            ? (this.m_sleepTime = 0)
            : ((this.m_sleepTime = 0),
              this.m_linearVelocity.SetZero(),
              (this.m_angularVelocity = 0),
              this.m_force.SetZero(),
              (this.m_torque = 0));
      }),
      (p.prototype.IsAwake = function () {
        return this.m_isAwake;
      }),
      (p.prototype.SetFixedRotation = function (t) {
        t ? (this.m_flags |= p.e_fixedRotationFlag) : (this.m_flags &= ~p.e_fixedRotationFlag),
          this.ResetMassData();
      }),
      (p.prototype.IsFixedRotation = function () {
        return (this.m_flags & p.e_fixedRotationFlag) === p.e_fixedRotationFlag;
      }),
      (p.prototype.SetActive = function (t) {
        if (t === this.IsActive()) return;
        let i, o;
        if (t)
          for (
            this.m_flags |= p.e_activeFlag,
              i = this.m_world.m_contactManager.m_broadPhase,
              o = this.m_fixtureList;
            o;
            o = o.m_next
          )
            o.CreateProxy(i, this.m_xf);
        else {
          for (
            this.m_flags &= ~p.e_activeFlag,
              i = this.m_world.m_contactManager.m_broadPhase,
              o = this.m_fixtureList;
            o;
            o = o.m_next
          )
            o.DestroyProxy(i);
          let t = this.m_contactList;
          for (; t; ) {
            let i = t;
            (t = t.next), this.m_world.m_contactManager.Destroy(i.contact);
          }
          this.m_contactList = null;
        }
      }),
      (p.prototype.IsActive = function () {
        return (this.m_flags & p.e_activeFlag) === p.e_activeFlag;
      }),
      (p.prototype.IsSleepingAllowed = function () {
        return (this.m_flags & p.e_allowSleepFlag) === p.e_allowSleepFlag;
      }),
      (p.prototype.GetFixtureList = function () {
        return this.m_fixtureList;
      }),
      (p.prototype.GetJointList = function () {
        return this.m_jointList;
      }),
      (p.prototype.GetControllerList = function () {
        return this.m_controllerList;
      }),
      (p.prototype.GetContactList = function () {
        return this.m_contactList;
      }),
      (p.prototype.GetNext = function () {
        return this.m_next;
      }),
      (p.prototype.GetUserData = function () {
        return this.m_userData;
      }),
      (p.prototype.SetUserData = function (t) {
        this.m_userData = t;
      }),
      (p.prototype.GetWorld = function () {
        return this.m_world;
      }),
      (p.prototype.b2Body = function (t, i) {
        (this.m_flags = 0),
          t.bullet && (this.m_flags |= p.e_bulletFlag),
          t.fixedRotation && (this.m_flags |= p.e_fixedRotationFlag),
          t.allowSleep && (this.m_flags |= p.e_allowSleepFlag),
          t.awake
            ? ((this.m_flags |= p.e_awakeFlag), (this.m_isAwake = !0))
            : (this.m_isAwake = !1),
          t.active && (this.m_flags |= p.e_activeFlag),
          (this.m_world = i),
          this.m_xf.position.SetV(t.position),
          this.m_xf.R.Set(t.angle),
          this.m_sweep.localCenter.SetZero(),
          (this.m_sweep.t0 = 1),
          (this.m_sweep.a0 = this.m_sweep.a = t.angle);
        let o = this.m_xf.R,
          e = this.m_sweep.localCenter;
        (this.m_sweep.c.x = o.col1.x * e.x + o.col2.x * e.y),
          (this.m_sweep.c.y = o.col1.y * e.x + o.col2.y * e.y),
          (this.m_sweep.c.x += this.m_xf.position.x),
          (this.m_sweep.c.y += this.m_xf.position.y),
          this.m_sweep.c0.SetV(this.m_sweep.c),
          (this.m_jointList = null),
          (this.m_controllerList = null),
          (this.m_contactList = null),
          (this.m_controllerCount = 0),
          (this.m_prev = null),
          (this.m_next = null),
          this.m_linearVelocity.SetV(t.linearVelocity),
          (this.m_angularVelocity = t.angularVelocity),
          (this.m_linearDamping = t.linearDamping),
          (this.m_angularDamping = t.angularDamping),
          this.m_force.Set(0, 0),
          (this.m_torque = 0),
          (this.m_sleepTime = 0),
          (this.m_type = t.type),
          this.m_type === p.b2_dynamicBody
            ? ((this.m_mass = 1), (this.m_invMass = 1))
            : ((this.m_mass = 0), (this.m_invMass = 0)),
          (this.m_I = 0),
          (this.m_invI = 0),
          (this.m_inertiaScale = t.inertiaScale),
          (this.m_userData = t.userData),
          (this.m_fixtureList = null),
          (this.m_fixtureCount = 0);
      }),
      (p.prototype.SynchronizeFixtures = function () {
        let t = p.s_xf1;
        t.R.Set(this.m_sweep.a0);
        let i,
          o = t.R,
          e = this.m_sweep.localCenter;
        (t.position.x = this.m_sweep.c0.x - (o.col1.x * e.x + o.col2.x * e.y)),
          (t.position.y = this.m_sweep.c0.y - (o.col1.y * e.x + o.col2.y * e.y));
        let n = this.m_world.m_contactManager.m_broadPhase;
        for (i = this.m_fixtureList; i; i = i.m_next) i.Synchronize(n, t, this.m_xf);
      }),
      (p.prototype.SynchronizeTransform = function () {
        this.m_xf.R.Set(this.m_sweep.a);
        let t = this.m_xf.R,
          i = this.m_sweep.localCenter;
        (this.m_xf.position.x = this.m_sweep.c.x - (t.col1.x * i.x + t.col2.x * i.y)),
          (this.m_xf.position.y = this.m_sweep.c.y - (t.col1.y * i.x + t.col2.y * i.y));
      }),
      (p.prototype.ShouldCollide = function (t) {
        if (this.m_type !== p.b2_dynamicBody && t.m_type !== p.b2_dynamicBody) return !1;
        for (let i = this.m_jointList; i; i = i.next)
          if (i.other === t && !i.joint.m_collideConnected) return !1;
        return !0;
      }),
      (p.prototype.Advance = function (t) {
        this.m_sweep.Advance(t),
          this.m_sweep.c.SetV(this.m_sweep.c0),
          (this.m_sweep.a = this.m_sweep.a0),
          this.SynchronizeTransform();
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Dynamics.b2Body.s_xf1 = new o(new e())),
          (Box2D.Dynamics.b2Body.e_islandFlag = 1),
          (Box2D.Dynamics.b2Body.e_awakeFlag = 2),
          (Box2D.Dynamics.b2Body.e_allowSleepFlag = 4),
          (Box2D.Dynamics.b2Body.e_bulletFlag = 8),
          (Box2D.Dynamics.b2Body.e_fixedRotationFlag = 16),
          (Box2D.Dynamics.b2Body.e_activeFlag = 32),
          (Box2D.Dynamics.b2Body.b2_staticBody = 0),
          (Box2D.Dynamics.b2Body.b2_kinematicBody = 1),
          (Box2D.Dynamics.b2Body.b2_dynamicBody = 2);
      }),
      (y.prototype.b2BodyDef = function () {
        (this.userData = null),
          this.position.Set(0, 0),
          (this.angle = 0),
          this.linearVelocity.Set(0, 0),
          (this.angularVelocity = 0),
          (this.linearDamping = 0),
          (this.angularDamping = 0),
          (this.allowSleep = !0),
          (this.awake = !0),
          (this.fixedRotation = !1),
          (this.bullet = !1),
          (this.type = p.b2_staticBody),
          (this.active = !0),
          (this.inertiaScale = 1);
      }),
      (u.b2ContactFilter = function () {}),
      (u.prototype.ShouldCollide = function (t, i) {
        let o = t.GetFilterData(),
          e = i.GetFilterData();
        return o.groupIndex === e.groupIndex && 0 !== o.groupIndex
          ? o.groupIndex > 0
          : 0 != (o.maskBits & e.categoryBits) && 0 != (o.categoryBits & e.maskBits);
      }),
      (u.prototype.RayCollide = function (t, i) {
        return !t || this.ShouldCollide(t instanceof D ? t : null, i);
      }),
      Box2D.postDefs.push(function () {
        Box2D.Dynamics.b2ContactFilter.b2_defaultFilter = new u();
      }),
      (x.b2ContactImpulse = function () {
        (this.normalImpulses = [0, 0]), (this.tangentImpulses = [0, 0]);
      }),
      (f.b2ContactListener = function () {}),
      (f.prototype.BeginContact = function (t) {}),
      (f.prototype.EndContact = function (t) {}),
      (f.prototype.PreSolve = function (t, i) {}),
      (f.prototype.PostSolve = function (t, i) {}),
      Box2D.postDefs.push(function () {
        Box2D.Dynamics.b2ContactListener.b2_defaultListener = new f();
      }),
      (b.b2ContactManager = function () {}),
      (b.prototype.b2ContactManager = function () {
        (this.m_world = null),
          (this.m_contactCount = 0),
          (this.m_contactFilter = u.b2_defaultFilter),
          (this.m_contactListener = f.b2_defaultListener),
          (this.m_contactFactory = new g(this.m_allocator)),
          (this.m_broadPhase = new r());
      }),
      (b.prototype.AddPair = function (t, i) {
        let o = t instanceof D ? t : null,
          e = i instanceof D ? i : null,
          n = o.GetBody(),
          s = e.GetBody();
        if (n === s) return;
        let l = s.GetContactList();
        for (; l; ) {
          if (l.other === n) {
            let t = l.contact.m_fixtureA,
              i = l.contact.m_fixtureB;
            if (t === o && i === e) return;
            if (t === e && i === o) return;
          }
          l = l.next;
        }
        if (!1 === s.ShouldCollide(n)) return;
        if (!1 === this.m_contactFilter.ShouldCollide(o, e)) return;
        let m = this.m_contactFactory.Create(o, e);
        (o = m.m_fixtureA),
          (e = m.m_fixtureB),
          (n = o.m_body),
          (s = e.m_body),
          (m.m_prev = null),
          (m.m_next = this.m_world.m_contactList),
          null !== this.m_world.m_contactList && (this.m_world.m_contactList.m_prev = m),
          (this.m_world.m_contactList = m),
          (m.m_nodeA.contact = m),
          (m.m_nodeA.other = s),
          (m.m_nodeA.prev = null),
          (m.m_nodeA.next = n.m_contactList),
          null !== n.m_contactList && (n.m_contactList.prev = m.m_nodeA),
          (n.m_contactList = m.m_nodeA),
          (m.m_nodeB.contact = m),
          (m.m_nodeB.other = n),
          (m.m_nodeB.prev = null),
          (m.m_nodeB.next = s.m_contactList),
          null !== s.m_contactList && (s.m_contactList.prev = m.m_nodeB),
          (s.m_contactList = m.m_nodeB),
          ++this.m_world.m_contactCount;
      }),
      (b.prototype.FindNewContacts = function () {
        this.m_broadPhase.UpdatePairs(this);
      }),
      (b.prototype.Destroy = function (t) {
        let i = t.m_fixtureA,
          o = t.m_fixtureB,
          e = i.GetBody(),
          n = o.GetBody();
        t.m_isTouching && this.m_contactListener.EndContact(t),
          t.m_prev && (t.m_prev.m_next = t.m_next),
          t.m_next && (t.m_next.m_prev = t.m_prev),
          t === this.m_world.m_contactList && (this.m_world.m_contactList = t.m_next),
          t.m_nodeA.prev && (t.m_nodeA.prev.next = t.m_nodeA.next),
          t.m_nodeA.next && (t.m_nodeA.next.prev = t.m_nodeA.prev),
          t.m_nodeA === e.m_contactList && (e.m_contactList = t.m_nodeA.next),
          t.m_nodeB.prev && (t.m_nodeB.prev.next = t.m_nodeB.next),
          t.m_nodeB.next && (t.m_nodeB.next.prev = t.m_nodeB.prev),
          t.m_nodeB === n.m_contactList && (n.m_contactList = t.m_nodeB.next),
          this.m_contactFactory.Destroy(t),
          --this.m_contactCount;
      }),
      (b.prototype.Collide = function () {
        let t = this.m_world.m_contactList;
        for (; t; ) {
          let i = t.m_fixtureA,
            o = t.m_fixtureB;
          if (null === i || null === o) continue;
          let e = i.GetBody(),
            n = o.GetBody();
          if (e.m_isAwake || n.m_isAwake) {
            if (t.m_isFiltered) {
              if (!n.ShouldCollide(e)) {
                let i = t;
                (t = i.GetNext()), this.Destroy(i);
                continue;
              }
              if (!this.m_contactFilter.ShouldCollide(i, o)) {
                (cNuke = t), (t = cNuke.GetNext()), this.Destroy(cNuke);
                continue;
              }
              t.m_isFiltered = !1;
            }
            this.m_broadPhase.TestOverlap(i.m_proxy, o.m_proxy)
              ? (t.Update(this.m_contactListener), (t = t.GetNext()))
              : ((cNuke = t), (t = cNuke.GetNext()), this.Destroy(cNuke));
          } else t = t.GetNext();
        }
      }),
      Box2D.postDefs.push(function () {
        Box2D.Dynamics.b2ContactManager.s_evalCP = new m();
      }),
      (d.b2DestructionListener = function () {}),
      (d.prototype.SayGoodbyeJoint = function (t) {}),
      (d.prototype.SayGoodbyeFixture = function (t) {}),
      (B.prototype.Copy = function () {
        let t = new B();
        return (
          (t.categoryBits = this.categoryBits),
          (t.maskBits = this.maskBits),
          (t.groupIndex = this.groupIndex),
          t
        );
      }),
      (D.b2Fixture = function () {
        this.m_filter = new B();
      }),
      (D.prototype.GetType = function () {
        return this.m_shape.GetType();
      }),
      (D.prototype.GetShape = function () {
        return this.m_shape;
      }),
      (D.prototype.SetSensor = function (t) {
        if (this.m_isSensor === t) return;
        if (((this.m_isSensor = t), null === this.m_body)) return;
        let i = this.m_body.GetContactList();
        for (; i; ) {
          let t = i.contact,
            o = t.m_fixtureA,
            e = t.m_fixtureB;
          (o !== this && e !== this) || t.SetSensor(o.IsSensor() || e.IsSensor()), (i = i.next);
        }
      }),
      (D.prototype.IsSensor = function () {
        return this.m_isSensor;
      }),
      (D.prototype.SetFilterData = function (t) {
        if (((this.m_filter = t.Copy()), this.m_body)) return;
        let i = this.m_body.GetContactList();
        for (; i; ) {
          let t = i.contact,
            o = t.m_fixtureA,
            e = t.m_fixtureB;
          (o !== this && e !== this) || (t.m_isFiltered = !0), (i = i.next);
        }
      }),
      (D.prototype.GetFilterData = function () {
        return this.m_filter.Copy();
      }),
      (D.prototype.GetBody = function () {
        return this.m_body;
      }),
      (D.prototype.GetNext = function () {
        return this.m_next;
      }),
      (D.prototype.GetUserData = function () {
        return this.m_userData;
      }),
      (D.prototype.SetUserData = function (t) {
        this.m_userData = t;
      }),
      (D.prototype.TestPoint = function (t) {
        return this.m_shape.TestPoint(this.m_body.GetTransform(), t);
      }),
      (D.prototype.RayCast = function (t, i) {
        return this.m_shape.RayCast(t, i, this.m_body.GetTransform());
      }),
      (D.prototype.GetMassData = function (t) {
        return void 0 === t && (t = new _()), this.m_shape.ComputeMass(t, this.m_density), t;
      }),
      (D.prototype.SetDensity = function (t) {
        this.m_density = t;
      }),
      (D.prototype.GetDensity = function () {
        return this.m_density;
      }),
      (D.prototype.GetFriction = function () {
        return this.m_friction;
      }),
      (D.prototype.SetFriction = function (t) {
        this.m_friction = t;
      }),
      (D.prototype.GetRestitution = function () {
        return this.m_restitution;
      }),
      (D.prototype.SetRestitution = function (t) {
        this.m_restitution = t;
      }),
      (D.prototype.GetAABB = function () {
        return this.m_aabb;
      }),
      (D.prototype.b2Fixture = function () {
        (this.m_aabb = new l()),
          (this.m_userData = null),
          (this.m_body = null),
          (this.m_next = null),
          (this.m_shape = null),
          (this.m_density = 0),
          (this.m_friction = 0),
          (this.m_restitution = 0);
      }),
      (D.prototype.Create = function (t, i, o) {
        (this.m_userData = o.userData),
          (this.m_friction = o.friction),
          (this.m_restitution = o.restitution),
          (this.m_body = t),
          (this.m_next = null),
          (this.m_filter = o.filter.Copy()),
          (this.m_isSensor = o.isSensor),
          (this.m_shape = o.shape.Copy()),
          (this.m_density = o.density);
      }),
      (D.prototype.Destroy = function () {
        (this.m_shape = null), this.m_aabb.Free();
      }),
      (D.prototype.CreateProxy = function (t, i) {
        this.m_shape.ComputeAABB(this.m_aabb, i), (this.m_proxy = t.CreateProxy(this.m_aabb, this));
      }),
      (D.prototype.DestroyProxy = function (t) {
        null != this.m_proxy && (t.DestroyProxy(this.m_proxy), (this.m_proxy = null));
      }),
      (D.prototype.Synchronize = function (i, o, e) {
        if (!this.m_proxy) return;
        let n = new l(),
          s = new l();
        this.m_shape.ComputeAABB(n, o),
          this.m_shape.ComputeAABB(s, e),
          this.m_aabb.Combine(n, s),
          n.Free(),
          s.Free();
        let m = t.SubtractVV(e.position, o.position);
        i.MoveProxy(this.m_proxy, this.m_aabb, m);
      }),
      (C.prototype.b2FixtureDef = function () {
        (this.shape = null),
          (this.userData = null),
          (this.friction = 0.2),
          (this.restitution = 0),
          (this.density = 0),
          (this.filter.categoryBits = 1),
          (this.filter.maskBits = 65535),
          (this.filter.groupIndex = 0),
          (this.isSensor = !1);
      }),
      (A.b2Island = function () {}),
      (A.prototype.b2Island = function () {
        (this.m_bodies = []), (this.m_contacts = []), (this.m_joints = []);
      }),
      (A.prototype.Initialize = function (t, i, o, e, n, s) {
        (this.m_bodyCapacity = t),
          (this.m_contactCapacity = i),
          (this.m_jointCapacity = o),
          (this.m_bodyCount = 0),
          (this.m_contactCount = 0),
          (this.m_jointCount = 0),
          (this.m_allocator = e),
          (this.m_listener = n),
          (this.m_contactSolver = s);
        let l = 0;
        for (l = this.m_bodies.length; l < t; l++) this.m_bodies[l] = null;
        for (l = this.m_contacts.length; l < i; l++) this.m_contacts[l] = null;
        for (l = this.m_joints.length; l < o; l++) this.m_joints[l] = null;
      }),
      (A.prototype.Clear = function () {
        (this.m_bodyCount = 0), (this.m_contactCount = 0), (this.m_jointCount = 0);
      }),
      (A.prototype.Solve = function (i, o, e) {
        let n,
          l = 0,
          m = 0;
        for (l = 0; l < this.m_bodyCount; ++l)
          (n = this.m_bodies[l]).m_type === p.b2_dynamicBody &&
            ((n.m_linearVelocity.x += i.dt * (o.x * n.m_gravityScale + n.m_invMass * n.m_force.x)),
            (n.m_linearVelocity.y += i.dt * (o.y * n.m_gravityScale + n.m_invMass * n.m_force.y)),
            (n.m_angularVelocity += i.dt * n.m_invI * n.m_torque),
            n.m_linearVelocity.Multiply(t.Clamp(1 - i.dt * n.m_linearDamping, 0, 1)),
            (n.m_angularVelocity *= t.Clamp(1 - i.dt * n.m_angularDamping, 0, 1)));
        this.m_contactSolver.Initialize(i, this.m_contacts, this.m_contactCount, this.m_allocator);
        let r = this.m_contactSolver;
        for (r.InitVelocityConstraints(i), l = 0; l < this.m_jointCount; ++l)
          this.m_joints[l].InitVelocityConstraints(i);
        for (l = 0; l < i.velocityIterations; ++l) {
          for (m = 0; m < this.m_jointCount; ++m) this.m_joints[m].SolveVelocityConstraints(i);
          r.SolveVelocityConstraints();
        }
        for (l = 0; l < this.m_jointCount; ++l) this.m_joints[l].FinalizeVelocityConstraints();
        for (r.FinalizeVelocityConstraints(), l = 0; l < this.m_bodyCount; ++l) {
          if (this.m_bodies[l].m_type === p.b2_staticBody) continue;
          n = this.m_bodies[l];
          let t = i.dt * n.m_linearVelocity.x,
            o = i.dt * n.m_linearVelocity.y;
          t * t + o * o > s.b2_maxTranslationSquared &&
            (n.m_linearVelocity.Normalize(),
            (n.m_linearVelocity.x *= s.b2_maxTranslation * i.inv_dt),
            (n.m_linearVelocity.y *= s.b2_maxTranslation * i.inv_dt));
          let e = i.dt * n.m_angularVelocity;
          e * e > s.b2_maxRotationSquared &&
            (n.m_angularVelocity =
              (n.m_angularVelocity < 0 ? -s.b2_maxRotation : s.b2_maxRotation) * i.inv_dt),
            n.m_sweep.c0.SetV(n.m_sweep.c),
            (n.m_sweep.a0 = n.m_sweep.a),
            (n.m_sweep.c.x += i.dt * n.m_linearVelocity.x),
            (n.m_sweep.c.y += i.dt * n.m_linearVelocity.y),
            (n.m_sweep.a += i.dt * n.m_angularVelocity),
            n.SynchronizeTransform();
        }
        for (l = 0; l < i.positionIterations; ++l) {
          let t = r.SolvePositionConstraints(s.b2_contactBaumgarte),
            i = !0;
          for (m = 0; m < this.m_jointCount; ++m) {
            let t = this.m_joints[m].SolvePositionConstraints(s.b2_contactBaumgarte);
            i = i && t;
          }
          if (t && i) break;
        }
        if ((this.Report(r.m_constraints), e)) {
          let o = Number.MAX_VALUE,
            e = s.b2_linearSleepTolerance * s.b2_linearSleepTolerance,
            m = s.b2_angularSleepTolerance * s.b2_angularSleepTolerance;
          for (l = 0; l < this.m_bodyCount; ++l)
            (n = this.m_bodies[l]).m_type !== p.b2_staticBody &&
              (0 == (n.m_flags & p.e_allowSleepFlag) && ((n.m_sleepTime = 0), (o = 0)),
              0 == (n.m_flags & p.e_allowSleepFlag) ||
              n.m_angularVelocity * n.m_angularVelocity > m ||
              t.Dot(n.m_linearVelocity, n.m_linearVelocity) > e
                ? ((n.m_sleepTime = 0), (o = 0))
                : ((n.m_sleepTime += i.dt), (o = t.Min(o, n.m_sleepTime))));
          if (o >= s.b2_timeToSleep)
            for (l = 0; l < this.m_bodyCount; ++l) this.m_bodies[l].SetAwake(!1);
        }
      }),
      (A.prototype.SolveTOI = function (t) {
        let i, o;
        this.m_contactSolver.Initialize(t, this.m_contacts, this.m_contactCount, this.m_allocator);
        let e = this.m_contactSolver;
        for (i = 0; i < this.m_jointCount; ++i) this.m_joints[i].InitVelocityConstraints(t);
        for (i = 0; i < t.velocityIterations; ++i)
          for (e.SolveVelocityConstraints(), o = 0; o < this.m_jointCount; ++o)
            this.m_joints[o].SolveVelocityConstraints(t);
        for (i = 0; i < this.m_bodyCount; ++i) {
          if (this.m_bodies[i].m_type === p.b2_staticBody) continue;
          let o = this.m_bodies[i],
            e = t.dt * o.m_linearVelocity.x,
            n = t.dt * o.m_linearVelocity.y;
          e * e + n * n > s.b2_maxTranslationSquared &&
            (o.m_linearVelocity.Normalize(),
            (o.m_linearVelocity.x *= s.b2_maxTranslation * t.inv_dt),
            (o.m_linearVelocity.y *= s.b2_maxTranslation * t.inv_dt));
          let l = t.dt * o.m_angularVelocity;
          l * l > s.b2_maxRotationSquared &&
            (o.m_angularVelocity < 0
              ? (o.m_angularVelocity = -s.b2_maxRotation * t.inv_dt)
              : (o.m_angularVelocity = s.b2_maxRotation * t.inv_dt)),
            o.m_sweep.c0.SetV(o.m_sweep.c),
            (o.m_sweep.a0 = o.m_sweep.a),
            (o.m_sweep.c.x += t.dt * o.m_linearVelocity.x),
            (o.m_sweep.c.y += t.dt * o.m_linearVelocity.y),
            (o.m_sweep.a += t.dt * o.m_angularVelocity),
            o.SynchronizeTransform();
        }
        for (i = 0; i < t.positionIterations; ++i) {
          let t = e.SolvePositionConstraints(0.75),
            i = !0;
          for (o = 0; o < this.m_jointCount; ++o) {
            let t = this.m_joints[o].SolvePositionConstraints(s.b2_contactBaumgarte);
            i = i && t;
          }
          if (t && i) break;
        }
        this.Report(e.m_constraints);
      }),
      (A.prototype.Report = function (t) {
        if (null != this.m_listener)
          for (let i = 0; i < this.m_contactCount; ++i) {
            let o = t[i];
            A.s_impulse.normalImpulses.length > o.pointCount &&
              ((A.s_impulse.normalImpulses.length = o.pointCount),
              (A.s_impulse.tangentImpulses.length = o.pointCount));
            for (let t = 0; t < o.pointCount; ++t)
              (A.s_impulse.normalImpulses[t] = o.points[t].normalImpulse),
                (A.s_impulse.tangentImpulses[t] = o.points[t].tangentImpulse);
            this.m_listener.PostSolve(this.m_contacts[i], A.s_impulse);
          }
      }),
      (A.prototype.AddBody = function (t) {
        (t.m_islandIndex = this.m_bodyCount), (this.m_bodies[this.m_bodyCount++] = t);
      }),
      (A.prototype.AddContact = function (t) {
        this.m_contacts[this.m_contactCount++] = t;
      }),
      (A.prototype.AddJoint = function (t) {
        this.m_joints[this.m_jointCount++] = t;
      }),
      Box2D.postDefs.push(function () {
        Box2D.Dynamics.b2Island.s_impulse = new x();
      }),
      (S.b2TimeStep = function () {}),
      (S.prototype.Set = function (t) {
        (this.dt = t.dt),
          (this.inv_dt = t.inv_dt),
          (this.positionIterations = t.positionIterations),
          (this.velocityIterations = t.velocityIterations),
          (this.warmStarting = t.warmStarting);
      }),
      (w.b2World = function () {
        (this.s_stack = []),
          (this.m_contactManager = new b()),
          (this.m_contactSolver = new M()),
          (this.m_island = new A());
      }),
      (w.prototype.b2World = function (t, i) {
        (this.m_destructionListener = null),
          (this.m_bodyList = null),
          (this.m_contactList = null),
          (this.m_jointList = null),
          (this.m_controllerList = null),
          (this.m_bodyCount = 0),
          (this.m_contactCount = 0),
          (this.m_jointCount = 0),
          (this.m_controllerCount = 0),
          (w.m_warmStarting = !0),
          (w.m_continuousPhysics = !0),
          (this.m_allowSleep = i),
          (this.m_gravity = t),
          (this.m_inv_dt0 = 0),
          (this.m_contactManager.m_world = this);
        let o = new y();
        this.m_groundBody = this.CreateBody(o);
      }),
      (w.prototype.SetDestructionListener = function (t) {
        this.m_destructionListener = t;
      }),
      (w.prototype.SetContactFilter = function (t) {
        this.m_contactManager.m_contactFilter = t;
      }),
      (w.prototype.SetContactListener = function (t) {
        this.m_contactManager.m_contactListener = t;
      }),
      (w.prototype.SetBroadPhase = function (t) {
        let i = this.m_contactManager.m_broadPhase;
        this.m_contactManager.m_broadPhase = t;
        for (let o = this.m_bodyList; o; o = o.m_next)
          for (let e = o.m_fixtureList; e; e = e.m_next)
            e.m_proxy = t.CreateProxy(i.GetFatAABB(e.m_proxy), e);
      }),
      (w.prototype.Validate = function () {
        this.m_contactManager.m_broadPhase.Validate();
      }),
      (w.prototype.GetProxyCount = function () {
        return this.m_contactManager.m_broadPhase.GetProxyCount();
      }),
      (w.prototype.CreateBody = function (t) {
        if (this.IsLocked()) return null;
        let i = new p(t, this);
        return (
          (i.m_prev = null),
          (i.m_next = this.m_bodyList),
          this.m_bodyList && (this.m_bodyList.m_prev = i),
          (this.m_bodyList = i),
          ++this.m_bodyCount,
          i
        );
      }),
      (w.prototype.DestroyBody = function (t) {
        if (this.IsLocked()) return;
        let i = t.m_jointList;
        for (; i; ) {
          let t = i;
          (i = i.next),
            this.m_destructionListener && this.m_destructionListener.SayGoodbyeJoint(t.joint),
            null != t.joint && this.DestroyJoint(t.joint);
        }
        let o = t.m_controllerList;
        for (; o; ) {
          let i = o;
          (o = o.nextController), i.controller.RemoveBody(t);
        }
        let e = t.m_contactList;
        for (; e; ) {
          let t = e;
          (e = e.next), this.m_contactManager.Destroy(t.contact);
        }
        t.m_contactList = null;
        let n = t.m_fixtureList;
        for (; n; ) {
          let t = n;
          (n = n.m_next),
            this.m_destructionListener && this.m_destructionListener.SayGoodbyeFixture(t),
            t.DestroyProxy(this.m_contactManager.m_broadPhase),
            t.Destroy();
        }
        (t.m_fixtureList = null),
          (t.m_fixtureCount = 0),
          t.m_prev && (t.m_prev.m_next = t.m_next),
          t.m_next && (t.m_next.m_prev = t.m_prev),
          t === this.m_bodyList && (this.m_bodyList = t.m_next),
          (t.m_userData = null),
          (t.m_sweep = null),
          (t.m_xf = null),
          (t.m_linearVelocity = null),
          (t.m_force = null),
          (t.m_world = null),
          (t.m_prev = null),
          (t.m_next = null),
          (t.m_controllerList = null),
          (t.m_jointList = null),
          (t.m_type = 0),
          (t.m_flags &= ~p.e_activeFlag),
          (t.m_isAwake = !1),
          --this.m_bodyCount;
      }),
      (w.prototype.CreateJoint = function (t) {
        let i = V.Create(t, null);
        (i.m_prev = null),
          (i.m_next = this.m_jointList),
          this.m_jointList && (this.m_jointList.m_prev = i),
          (this.m_jointList = i),
          ++this.m_jointCount,
          (i.m_edgeA.joint = i),
          (i.m_edgeA.other = i.m_bodyB),
          (i.m_edgeA.prev = null),
          (i.m_edgeA.next = i.m_bodyA.m_jointList),
          i.m_bodyA.m_jointList && (i.m_bodyA.m_jointList.prev = i.m_edgeA),
          (i.m_bodyA.m_jointList = i.m_edgeA),
          (i.m_edgeB.joint = i),
          (i.m_edgeB.other = i.m_bodyA),
          (i.m_edgeB.prev = null),
          (i.m_edgeB.next = i.m_bodyB.m_jointList),
          i.m_bodyB.m_jointList && (i.m_bodyB.m_jointList.prev = i.m_edgeB),
          (i.m_bodyB.m_jointList = i.m_edgeB);
        let o = t.bodyA,
          e = t.bodyB;
        if (!t.collideConnected) {
          let t = e.GetContactList();
          for (; t; ) t.other === o && (t.contact.m_isFiltered = !0), (t = t.next);
        }
        return i;
      }),
      (w.prototype.DestroyJoint = function (t) {
        let i = t.m_collideConnected;
        t.m_prev && (t.m_prev.m_next = t.m_next),
          t.m_next && (t.m_next.m_prev = t.m_prev),
          t === this.m_jointList && (this.m_jointList = t.m_next);
        let o = t.m_bodyA,
          e = t.m_bodyB;
        if (
          (o.SetAwake(!0),
          e.SetAwake(!0),
          t.m_edgeA.prev && (t.m_edgeA.prev.next = t.m_edgeA.next),
          t.m_edgeA.next && (t.m_edgeA.next.prev = t.m_edgeA.prev),
          t.m_edgeA === o.m_jointList && (o.m_jointList = t.m_edgeA.next),
          (t.m_edgeA.prev = null),
          (t.m_edgeA.next = null),
          t.m_edgeB.prev && (t.m_edgeB.prev.next = t.m_edgeB.next),
          t.m_edgeB.next && (t.m_edgeB.next.prev = t.m_edgeB.prev),
          t.m_edgeB === e.m_jointList && (e.m_jointList = t.m_edgeB.next),
          (t.m_edgeB.prev = null),
          (t.m_edgeB.next = null),
          V.Destroy(t, null),
          --this.m_jointCount,
          !1 === i)
        ) {
          let t = e.GetContactList();
          for (; t; ) t.other === o && (t.contact.m_isFiltered = !0), (t = t.next);
        }
      }),
      (w.prototype.AddController = function (t) {
        return (
          (t.m_next = this.m_controllerList),
          (t.m_prev = null),
          (this.m_controllerList = t),
          (t.m_world = this),
          this.m_controllerCount++,
          t
        );
      }),
      (w.prototype.RemoveController = function (t) {
        t.m_prev && (t.m_prev.m_next = t.m_next),
          t.m_next && (t.m_next.m_prev = t.m_prev),
          this.m_controllerList === t && (this.m_controllerList = t.m_next),
          this.m_controllerCount--;
      }),
      (w.prototype.CreateController = function (t) {
        if (t.m_world !== this) throw new Error("Controller can only be a member of one world");
        return (
          (t.m_next = this.m_controllerList),
          (t.m_prev = null),
          this.m_controllerList && (this.m_controllerList.m_prev = t),
          (this.m_controllerList = t),
          ++this.m_controllerCount,
          (t.m_world = this),
          t
        );
      }),
      (w.prototype.DestroyController = function (t) {
        t.Clear(),
          t.m_next && (t.m_next.m_prev = t.m_prev),
          t.m_prev && (t.m_prev.m_next = t.m_next),
          t === this.m_controllerList && (this.m_controllerList = t.m_next),
          --this.m_controllerCount;
      }),
      (w.prototype.SetWarmStarting = function (t) {
        w.m_warmStarting = t;
      }),
      (w.prototype.SetContinuousPhysics = function (t) {
        w.m_continuousPhysics = t;
      }),
      (w.prototype.GetBodyCount = function () {
        return this.m_bodyCount;
      }),
      (w.prototype.GetJointCount = function () {
        return this.m_jointCount;
      }),
      (w.prototype.GetContactCount = function () {
        return this.m_contactCount;
      }),
      (w.prototype.SetGravity = function (t) {
        this.m_gravity = t;
      }),
      (w.prototype.GetGravity = function () {
        return this.m_gravity;
      }),
      (w.prototype.GetGroundBody = function () {
        return this.m_groundBody;
      }),
      (w.prototype.Step = function (t, i, o) {
        this.m_flags & w.e_newFixture &&
          (this.m_contactManager.FindNewContacts(), (this.m_flags &= ~w.e_newFixture)),
          (this.m_flags |= w.e_locked);
        let e = w.s_timestep2;
        (e.dt = t),
          (e.velocityIterations = i),
          (e.positionIterations = o),
          (e.inv_dt = 1 / t),
          (e.dtRatio = this.m_inv_dt0 * t),
          (e.warmStarting = w.m_warmStarting),
          this.m_contactManager.Collide(),
          this.Solve(e),
          w.m_continuousPhysics && this.SolveTOI(e),
          (this.m_inv_dt0 = e.inv_dt),
          (this.m_flags &= ~w.e_locked);
      }),
      (w.prototype.ClearForces = function () {
        for (let t = this.m_bodyList; t; t = t.m_next) t.m_force.SetZero(), (t.m_torque = 0);
      }),
      (w.prototype.QueryAABB = function (t, i) {
        let o = this.m_contactManager.m_broadPhase;
        o.Query(function (i) {
          return t(o.GetUserData(i));
        }, i);
      }),
      (w.prototype.QueryShape = function (t, i, n) {
        n || (n = new o(new e())).SetIdentity();
        let s = this.m_contactManager.m_broadPhase;
        let m = new l();
        i.ComputeAABB(m, n),
          s.Query(function (o) {
            let e = s.GetUserData(o) instanceof D ? s.GetUserData(o) : null;
            return !h.TestOverlap(i, n, e.GetShape(), e.GetBody().GetTransform()) || t(e);
          }, m),
          m.Free();
      }),
      (w.prototype.QueryPoint = function (t, i) {
        let o = this.m_contactManager.m_broadPhase;
        let e = new l();
        e.lowerBound.Set(i.x - s.b2_linearSlop, i.y - s.b2_linearSlop),
          e.upperBound.Set(i.x + s.b2_linearSlop, i.y + s.b2_linearSlop),
          o.Query(function (e) {
            let n = o.GetUserData(e) instanceof D ? o.GetUserData(e) : null;
            return !n.TestPoint(i) || t(n);
          }, e),
          e.Free();
      }),
      (w.prototype.RayCast = function (t, i, o) {
        let n = this.m_contactManager.m_broadPhase,
          s = new c();
        let l = new a(i, o);
        n.RayCast(function (l, m) {
          let r = n.GetUserData(m),
            a = r instanceof D ? r : null;
          if (a.RayCast(s, l)) {
            let n = s.fraction,
              l = new e((1 - n) * i.x + n * o.x, (1 - n) * i.y + n * o.y);
            return t.ReportFixture(a, l, s.normal, n);
          }
          return l.maxFraction;
        }, l);
      }),
      (w.prototype.RayCastOne = function (t, i) {
        let o;
        return (
          this.RayCast(
            function (t, i, e, n) {
              return void 0 === n && (n = 0), (o = t), n;
            },
            t,
            i
          ),
          o
        );
      }),
      (w.prototype.RayCastAll = function (t, i) {
        let o = [];
        return (
          this.RayCast(
            function (t, i, e, n) {
              return void 0 === n && (n = 0), (o[o.length] = t), 1;
            },
            t,
            i
          ),
          o
        );
      }),
      (w.prototype.GetBodyList = function () {
        return this.m_bodyList;
      }),
      (w.prototype.GetJointList = function () {
        return this.m_jointList;
      }),
      (w.prototype.GetContactList = function () {
        return this.m_contactList;
      }),
      (w.prototype.IsLocked = function () {
        return (this.m_flags & w.e_locked) > 0;
      }),
      (w.prototype.Solve = function (t) {
        let i;
        for (let i = this.m_controllerList; i; i = i.m_next) i.Step(t);
        let o,
          e = this.m_island;
        for (
          e.Initialize(
            this.m_bodyCount,
            this.m_contactCount,
            this.m_jointCount,
            null,
            this.m_contactManager.m_contactListener,
            this.m_contactSolver
          ),
            i = this.m_bodyList;
          i;
          i = i.m_next
        )
          i.m_flags &= ~p.e_islandFlag;
        for (let t = this.m_contactList; t; t = t.m_next) t.m_flags &= ~v.e_islandFlag;
        for (let t = this.m_jointList; t; t = t.m_next) t.m_islandFlag = !1;
        let n = this.s_stack;
        for (let s = this.m_bodyList; s; s = s.m_next) {
          if (s.m_type === p.b2_staticBody) continue;
          if (s.m_flags & p.e_islandFlag) continue;
          if (!s.m_isAwake || !s.IsActive()) continue;
          e.Clear();
          let l = 0;
          for (n[l++] = s, s.m_flags |= p.e_islandFlag; 0 !== l; ) {
            if (((i = n[--l]), e.AddBody(i), i.m_type === p.b2_staticBody)) continue;
            let t;
            i.m_isAwake || i.SetAwake(!0);
            for (let o = i.m_contactList; o; o = o.next)
              o.contact.m_flags & v.e_islandFlag ||
                (o.contact.m_isTouching &&
                  !o.contact.m_isSensor &&
                  o.contact.m_isEnabled &&
                  (e.AddContact(o.contact),
                  (o.contact.m_flags |= v.e_islandFlag),
                  (t = o.other).m_flags & p.e_islandFlag ||
                    ((n[l++] = t), (t.m_flags |= p.e_islandFlag))));
            for (let o = i.m_jointList; o; o = o.next)
              o.joint.m_islandFlag ||
                ((t = o.other).IsActive() &&
                  (e.AddJoint(o.joint),
                  (o.joint.m_islandFlag = !0),
                  t.m_flags & p.e_islandFlag || ((n[l++] = t), (t.m_flags |= p.e_islandFlag))));
          }
          for (e.Solve(t, this.m_gravity, this.m_allowSleep), o = 0; o < e.m_bodyCount; ++o)
            (i = e.m_bodies[o]).m_type === p.b2_staticBody && (i.m_flags &= ~p.e_islandFlag);
        }
        for (o = 0; n[o]; ) n[o++] = null;
        for (i = this.m_bodyList; i; i = i.m_next)
          i.m_type !== p.b2_staticBody && i.m_isAwake && i.IsActive() && i.SynchronizeFixtures();
        this.m_contactManager.FindNewContacts();
      }),
      (w.prototype.SolveTOI = function (t) {
        let i,
          o,
          e,
          n,
          l = this.m_island;
        l.Initialize(
          this.m_bodyCount,
          s.b2_maxTOIContactsPerIsland,
          s.b2_maxTOIJointsPerIsland,
          null,
          this.m_contactManager.m_contactListener,
          this.m_contactSolver
        );
        let m,
          r,
          a,
          c = w.s_queue;
        for (let t = this.m_bodyList; t; t = t.m_next)
          (t.m_flags &= ~p.e_islandFlag), (t.m_sweep.t0 = 0);
        for (m = this.m_contactList; m; m = m.m_next) m.m_flags &= ~(v.e_toiFlag | v.e_islandFlag);
        for (let t = this.m_jointList; t; t = t.m_next) t.m_islandFlag = !1;
        let _ = 50;
        for (; _-- > 0; ) {
          let s = null,
            _ = 1;
          for (m = this.m_contactList; m; m = m.m_next) {
            if (!m.m_isContinuous || m.m_isSensor || !m.m_isEnabled) continue;
            let t = 1;
            if (m.m_flags & v.e_toiFlag) t = m.m_toi;
            else {
              if (
                ((i = m.m_fixtureA),
                (o = m.m_fixtureB),
                (e = i.m_body),
                (n = o.m_body),
                !(
                  (e.m_type === p.b2_dynamicBody && e.m_isAwake) ||
                  (n.m_type === p.b2_dynamicBody && n.m_isAwake)
                ))
              )
                continue;
              let s = e.m_sweep.t0;
              e.m_sweep.t0 < n.m_sweep.t0
                ? ((s = n.m_sweep.t0), e.m_sweep.Advance(s))
                : n.m_sweep.t0 < e.m_sweep.t0 && ((s = e.m_sweep.t0), n.m_sweep.Advance(s)),
                (t = m.ComputeTOI(e.m_sweep, n.m_sweep)) > 0 &&
                  t < 1 &&
                  (t = (1 - t) * s + t) > 1 &&
                  (t = 1),
                (m.m_toi = t),
                (m.m_flags |= v.e_toiFlag);
            }
            Number.MIN_VALUE < t && t < _ && ((s = m), (_ = t));
          }
          if (null === s || 1 - 100 * Number.MIN_VALUE < _) break;
          if (
            ((i = s.m_fixtureA),
            (o = s.m_fixtureB),
            (e = i.m_body),
            (n = o.m_body),
            w.s_backupA.Set(e.m_sweep),
            w.s_backupB.Set(n.m_sweep),
            e.Advance(_),
            n.Advance(_),
            s.Update(this.m_contactManager.m_contactListener),
            (s.m_flags &= ~v.e_toiFlag),
            s.m_isSensor || !s.m_isEnabled)
          ) {
            e.m_sweep.Set(w.s_backupA),
              n.m_sweep.Set(w.s_backupB),
              e.SynchronizeTransform(),
              n.SynchronizeTransform();
            continue;
          }
          if (!s.m_isTouching) continue;
          let h = e.m_type !== p.b2_dynamicBody ? n : e;
          l.Clear();
          let y = 0,
            u = 1;
          for (c[0] = h, h.m_flags |= p.e_islandFlag; 0 != u--; )
            if (
              ((r = c[y++]),
              l.AddBody(r),
              r.m_isAwake || r.SetAwake(!0),
              r.m_type === p.b2_dynamicBody)
            ) {
              for (
                let t = r.m_contactList;
                t && l.m_contactCount !== l.m_contactCapacity;
                t = t.next
              ) {
                if (t.contact.m_flags & v.e_islandFlag) continue;
                if (!t.contact.m_isTouching || t.contact.m_isSensor || !t.contact.m_isEnabled)
                  continue;
                l.AddContact(t.contact), (t.contact.m_flags |= v.e_islandFlag);
                let i = t.other;
                t.other.m_flags & p.e_islandFlag ||
                  (i.m_type !== p.b2_staticBody && (i.Advance(_), i.SetAwake(!0)),
                  (c[y + u++] = i),
                  (i.m_flags |= p.e_islandFlag));
              }
              for (let t = r.m_jointList; t; t = t.next)
                l.m_jointCount !== l.m_jointCapacity &&
                  (t.joint.m_islandFlag ||
                    ((other = t.other),
                    other.IsActive() &&
                      (l.AddJoint(t.joint),
                      (t.joint.m_islandFlag = !0),
                      other.m_flags & p.e_islandFlag ||
                        (other.m_type !== p.b2_staticBody && (other.Advance(_), other.SetAwake(!0)),
                        (c[y + u++] = other),
                        (other.m_flags |= p.e_islandFlag)))));
            }
          let x = w.s_timestep;
          (x.warmStarting = !1),
            (x.dt = (1 - _) * t.dt),
            (x.inv_dt = 1 / x.dt),
            (x.dtRatio = 0),
            (x.velocityIterations = t.velocityIterations),
            (x.positionIterations = t.positionIterations),
            l.SolveTOI(x);
          let f = l.m_bodyCount;
          for (; f > 0; )
            if (
              (((r = l.m_bodies[--f]).m_flags &= ~p.e_islandFlag),
              r.m_type === p.b2_dynamicBody && r.m_isAwake)
            )
              for (r.SynchronizeFixtures(), a = r.m_contactList; a; a = a.next)
                a.contact.m_flags &= ~v.e_toiFlag;
          for (f = l.m_contactCount; f > 0; )
            l.m_contacts[--f].m_flags &= ~(v.e_toiFlag | v.e_islandFlag);
          for (f = l.m_jointCount; f > 0; ) l.m_joints[--f].m_islandFlag = !1;
          this.m_contactManager.FindNewContacts();
        }
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Dynamics.b2World.s_timestep2 = new S()),
          (Box2D.Dynamics.b2World.s_xf = new o(new e())),
          (Box2D.Dynamics.b2World.s_backupA = new i()),
          (Box2D.Dynamics.b2World.s_backupB = new i()),
          (Box2D.Dynamics.b2World.s_timestep = new S()),
          (Box2D.Dynamics.b2World.s_queue = []),
          (Box2D.Dynamics.b2World.s_jointColor = new n(0.5, 0.8, 0.8)),
          (Box2D.Dynamics.b2World.e_newFixture = 1),
          (Box2D.Dynamics.b2World.e_locked = 2);
      });
  })(),
  (function () {
    let t = Box2D.Collision.Shapes.b2CircleShape,
      i = (Box2D.Collision.Shapes.b2EdgeChainDef, Box2D.Collision.Shapes.b2EdgeShape),
      o = (Box2D.Collision.Shapes.b2MassData, Box2D.Collision.Shapes.b2PolygonShape),
      e = Box2D.Collision.Shapes.b2Shape,
      n = Box2D.Dynamics.Contacts.b2CircleContact,
      s = Box2D.Dynamics.Contacts.b2Contact,
      l = Box2D.Dynamics.Contacts.b2ContactConstraint,
      m = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      r = Box2D.Dynamics.Contacts.b2ContactEdge,
      a = Box2D.Dynamics.Contacts.b2ContactFactory,
      c = Box2D.Dynamics.Contacts.b2ContactRegister,
      _ = Box2D.Dynamics.Contacts.b2ContactResult,
      h = Box2D.Dynamics.Contacts.b2ContactSolver,
      p = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      y = Box2D.Dynamics.Contacts.b2NullContact,
      u = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      x = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      f = Box2D.Dynamics.Contacts.b2PolygonContact,
      b = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      d = Box2D.Dynamics.b2Body,
      B =
        (Box2D.Dynamics.b2BodyDef,
        Box2D.Dynamics.b2ContactFilter,
        Box2D.Dynamics.b2ContactImpulse,
        Box2D.Dynamics.b2ContactListener,
        Box2D.Dynamics.b2ContactManager,
        Box2D.Dynamics.b2DestructionListener,
        Box2D.Dynamics.b2FilterData,
        Box2D.Dynamics.b2Fixture,
        Box2D.Dynamics.b2FixtureDef,
        Box2D.Dynamics.b2Island,
        Box2D.Dynamics.b2TimeStep),
      D =
        (Box2D.Dynamics.b2World,
        Box2D.Common.b2Color,
        Box2D.Common.b2internal,
        Box2D.Common.b2Settings),
      C = (Box2D.Common.Math.b2Mat22, Box2D.Common.Math.b2Mat33, Box2D.Common.Math.b2Math),
      A = (Box2D.Common.Math.b2Sweep, Box2D.Common.Math.b2Transform, Box2D.Common.Math.b2Vec2),
      S =
        (Box2D.Common.Math.b2Vec3,
        Box2D.Collision.b2AABB,
        Box2D.Collision.b2Bound,
        Box2D.Collision.b2BoundValues,
        Box2D.Collision.b2Collision),
      w = Box2D.Collision.b2ContactID,
      v =
        (Box2D.Collision.b2ContactPoint,
        Box2D.Collision.b2Distance,
        Box2D.Collision.b2DistanceInput,
        Box2D.Collision.b2DistanceOutput,
        Box2D.Collision.b2DistanceProxy,
        Box2D.Collision.b2DynamicTree,
        Box2D.Collision.b2DynamicTreeBroadPhase,
        Box2D.Collision.b2DynamicTreeNode,
        Box2D.Collision.b2DynamicTreePair,
        Box2D.Collision.b2Manifold),
      g =
        (Box2D.Collision.b2ManifoldPoint,
        Box2D.Collision.b2Point,
        Box2D.Collision.b2RayCastInput,
        Box2D.Collision.b2RayCastOutput,
        Box2D.Collision.b2Segment,
        Box2D.Collision.b2SeparationFunction,
        Box2D.Collision.b2Simplex,
        Box2D.Collision.b2SimplexCache,
        Box2D.Collision.b2SimplexVertex,
        Box2D.Collision.b2TimeOfImpact),
      M = Box2D.Collision.b2TOIInput,
      V = Box2D.Collision.b2WorldManifold;
    Box2D.Collision.ClipVertex, Box2D.Collision.Features, Box2D.Collision.IBroadPhase;
    Box2D.inherit(n, Box2D.Dynamics.Contacts.b2Contact),
      (n.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype),
      (n.b2CircleContact = function () {
        Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
      }),
      (n.Create = function (t) {
        return new n();
      }),
      (n.Destroy = function (t, i) {}),
      (n.prototype.Reset = function (t, i) {
        this.__super.Reset.call(this, t, i);
      }),
      (n.prototype.Evaluate = function () {
        let i = this.m_fixtureA.GetBody(),
          o = this.m_fixtureB.GetBody();
        S.CollideCircles(
          this.m_manifold,
          this.m_fixtureA.GetShape() instanceof t ? this.m_fixtureA.GetShape() : null,
          i.m_xf,
          this.m_fixtureB.GetShape() instanceof t ? this.m_fixtureB.GetShape() : null,
          o.m_xf
        );
      }),
      (s.b2Contact = function () {
        (this.m_nodeA = new r()),
          (this.m_nodeB = new r()),
          (this.m_manifold = new v()),
          (this.m_oldManifold = new v()),
          (this.m_swapped = !1);
      }),
      (s.prototype.GetManifold = function () {
        return this.m_manifold;
      }),
      (s.prototype.GetWorldManifold = function (t) {
        let i = this.m_fixtureA.GetBody(),
          o = this.m_fixtureB.GetBody(),
          e = this.m_fixtureA.GetShape(),
          n = this.m_fixtureB.GetShape();
        t.Initialize(this.m_manifold, i.GetTransform(), e.m_radius, o.GetTransform(), n.m_radius);
      }),
      (s.prototype.IsTouching = function () {
        return this.m_isTouching;
      }),
      (s.prototype.IsContinuous = function () {
        return this.m_isContinuous;
      }),
      (s.prototype.SetSensor = function (t) {
        this.m_isSensor = t;
      }),
      (s.prototype.IsSensor = function () {
        return this.m_isSensor;
      }),
      (s.prototype.SetEnabled = function (t) {
        this.m_isEnabled = t;
      }),
      (s.prototype.IsEnabled = function () {
        return this.m_isEnabled;
      }),
      (s.prototype.GetNext = function () {
        return this.m_next;
      }),
      (s.prototype.GetFixtureA = function () {
        return this.m_fixtureA;
      }),
      (s.prototype.GetFixtureB = function () {
        return this.m_fixtureB;
      }),
      (s.prototype.FlagForFiltering = function () {
        this.m_isFiltered = !0;
      }),
      (s.prototype.b2Contact = function () {}),
      (s.prototype.Reset = function (t, i) {
        if (((this.m_flags = s.e_enabledFlag), !t || !i))
          return (this.m_fixtureA = null), void (this.m_fixtureB = null);
        (this.m_isSensor = t.IsSensor() || i.IsSensor()),
          (this.m_isEnabled = !0),
          (this.m_isFiltered = !1),
          (this.m_isTouching = !1);
        let o = t.GetBody(),
          e = i.GetBody();
        (this.m_isContinuous =
          o.m_type !== d.b2_dynamicBody ||
          o.IsBullet() ||
          e.m_type !== d.b2_dynamicBody ||
          e.IsBullet()),
          (this.m_fixtureA = t),
          (this.m_fixtureB = i),
          (this.m_manifold.m_pointCount = 0),
          (this.m_prev = null),
          (this.m_next = null),
          (this.m_nodeA.contact = null),
          (this.m_nodeA.prev = null),
          (this.m_nodeA.next = null),
          (this.m_nodeA.other = null),
          (this.m_nodeB.contact = null),
          (this.m_nodeB.prev = null),
          (this.m_nodeB.next = null),
          (this.m_nodeB.other = null);
      }),
      (s.prototype.Update = function (t) {
        let i = this.m_oldManifold;
        (this.m_oldManifold = this.m_manifold), (this.m_manifold = i), (this.m_isEnabled = !0);
        let o = !1,
          n = this.m_isTouching,
          s = this.m_fixtureA.m_body,
          l = this.m_fixtureB.m_body,
          m = this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);
        if (this.m_isSensor) {
          if (m) {
            let t = this.m_fixtureA.m_shape,
              i = this.m_fixtureB.m_shape,
              n = s.m_xf,
              m = l.m_xf;
            o = e.TestOverlap(t, n, i, m);
          }
          this.m_manifold.m_pointCount = 0;
        } else {
          if (
            ((this.m_isContinuous =
              s.m_type !== d.b2_dynamicBody ||
              s.IsBullet() ||
              l.m_type !== d.b2_dynamicBody ||
              l.IsBullet()),
            m)
          ) {
            this.Evaluate(), (o = this.m_manifold.m_pointCount > 0);
            for (let t = 0; t < this.m_manifold.m_pointCount; ++t) {
              let i = this.m_manifold.m_points[t];
              (i.m_normalImpulse = 0), (i.m_tangentImpulse = 0);
              let o = i.m_id;
              for (let t = 0; t < this.m_oldManifold.m_pointCount; ++t) {
                let e = this.m_oldManifold.m_points[t];
                if (e.m_id.key === o.key) {
                  (i.m_normalImpulse = e.m_normalImpulse),
                    (i.m_tangentImpulse = e.m_tangentImpulse);
                  break;
                }
              }
            }
          } else this.m_manifold.m_pointCount = 0;
          o !== n && (s.SetAwake(!0), l.SetAwake(!0));
        }
        (this.m_isTouching = o),
          !n && o && t.BeginContact(this),
          n && !o && t.EndContact(this),
          this.m_isSensor || t.PreSolve(this, this.m_oldManifold);
      }),
      (s.prototype.Evaluate = function () {}),
      (s.prototype.ComputeTOI = function (t, i) {
        return (
          s.s_input.proxyA.Set(this.m_fixtureA.m_shape),
          s.s_input.proxyB.Set(this.m_fixtureB.m_shape),
          (s.s_input.sweepA = t),
          (s.s_input.sweepB = i),
          (s.s_input.tolerance = D.b2_linearSlop),
          g.TimeOfImpact(s.s_input)
        );
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag = 1),
          (Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag = 2),
          (Box2D.Dynamics.Contacts.b2Contact.e_islandFlag = 4),
          (Box2D.Dynamics.Contacts.b2Contact.e_toiFlag = 8),
          (Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag = 16),
          (Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag = 32),
          (Box2D.Dynamics.Contacts.b2Contact.e_filterFlag = 64),
          (Box2D.Dynamics.Contacts.b2Contact.s_input = new M());
      }),
      (l.prototype.b2ContactConstraint = function () {
        this.points = [new m(), new m()];
      }),
      (a.b2ContactFactory = function () {}),
      (a.prototype.b2ContactFactory = function (t) {
        (this.m_allocator = t), this.InitializeRegisters();
      }),
      (a.prototype.AddType = function (t, i, o, e) {
        void 0 === o && (o = 0),
          void 0 === e && (e = 0),
          (this.m_registers[o][e].createFcn = t),
          (this.m_registers[o][e].destroyFcn = i),
          (this.m_registers[o][e].primary = !0),
          o !== e &&
            ((this.m_registers[e][o].createFcn = t),
            (this.m_registers[e][o].destroyFcn = i),
            (this.m_registers[e][o].primary = !1));
      }),
      (a.prototype.InitializeRegisters = function () {
        (this.m_registers = [
          [new c(), new c(), new c()],
          [new c(), new c(), new c()],
          [new c(), new c(), new c()],
        ]),
          this.AddType(n.Create, n.Destroy, e.e_circleShape, e.e_circleShape),
          this.AddType(u.Create, u.Destroy, e.e_polygonShape, e.e_circleShape),
          this.AddType(f.Create, f.Destroy, e.e_polygonShape, e.e_polygonShape),
          this.AddType(p.Create, p.Destroy, e.e_edgeShape, e.e_circleShape),
          this.AddType(x.Create, x.Destroy, e.e_polygonShape, e.e_edgeShape);
      }),
      (a.prototype.Create = function (t, i) {
        let o,
          e = t.GetType(),
          n = i.GetType(),
          s = this.m_registers[e][n];
        if (s.pool)
          return (o = s.pool), (s.pool = o.m_next), o.m_swapped ? o.Reset(i, t) : o.Reset(t, i), o;
        let l = s.createFcn;
        return l
          ? s.primary
            ? ((o = l(this.m_allocator)).Reset(t, i), (o.m_swapped = !1), o)
            : ((o = l(this.m_allocator)).Reset(i, t), (o.m_swapped = !0), o)
          : null;
      }),
      (a.prototype.Destroy = function (t) {
        t.m_manifold.m_pointCount > 0 &&
          (t.m_fixtureA.m_body.SetAwake(!0), t.m_fixtureB.m_body.SetAwake(!0));
        let i = t.m_fixtureA.GetType(),
          o = t.m_fixtureB.GetType(),
          e = null;
        (e = t.m_swapped ? this.m_registers[o][i] : this.m_registers[i][o]),
          t.Reset(null, null),
          (t.m_next = e.pool),
          (e.pool = t),
          (0, e.destroyFcn)(t, this.m_allocator);
      }),
      (c.b2ContactRegister = function () {}),
      (_.b2ContactResult = function () {
        (this.position = new A()), (this.normal = new A()), (this.id = new w());
      }),
      (h.b2ContactSolver = function () {
        (this.m_step = new B()), (this.m_constraints = []);
      }),
      (h.prototype.b2ContactSolver = function () {}),
      (h.prototype.Initialize = function (t, i, o, e) {
        for (
          this.m_step.Set(t), this.m_allocator = e, this.m_constraintCount = o;
          this.m_constraints.length < this.m_constraintCount;

        )
          this.m_constraints[this.m_constraints.length] = new l();
        let n;
        for (let t = 0; t < o; ++t) {
          let o = (n = i[t]).m_fixtureA,
            e = n.m_fixtureB,
            s = o.m_shape,
            l = e.m_shape,
            m = s.m_radius,
            r = l.m_radius,
            a = o.m_body,
            c = e.m_body,
            _ = n.GetManifold(),
            p = D.b2MixFriction(o.GetFriction(), e.GetFriction()),
            y =
              o.minRestitution || e.minRestitution
                ? D.b2MixRestitutionMin(o.GetRestitution(), e.GetRestitution())
                : D.b2MixRestitution(o.GetRestitution(), e.GetRestitution()),
            u = a.m_linearVelocity.x,
            x = a.m_linearVelocity.y,
            f = c.m_linearVelocity.x,
            b = c.m_linearVelocity.y,
            d = a.m_angularVelocity,
            B = c.m_angularVelocity;
          h.s_worldManifold.Initialize(_, a.m_xf, m, c.m_xf, r);
          let C = h.s_worldManifold.m_normal.x,
            A = h.s_worldManifold.m_normal.y,
            S = this.m_constraints[t];
          (S.bodyA = a),
            (S.bodyB = c),
            (S.manifold = _),
            (S.normal.x = C),
            (S.normal.y = A),
            (S.pointCount = _.m_pointCount),
            (S.friction = p),
            (S.restitution = y),
            (S.localPlaneNormal.x = _.m_localPlaneNormal.x),
            (S.localPlaneNormal.y = _.m_localPlaneNormal.y),
            (S.localPoint.x = _.m_localPoint.x),
            (S.localPoint.y = _.m_localPoint.y),
            (S.radius = m + r),
            (S.type = _.m_type);
          for (let t = 0; t < S.pointCount; ++t) {
            let i = _.m_points[t],
              o = S.points[t];
            (o.normalImpulse = i.m_normalImpulse),
              (o.tangentImpulse = i.m_tangentImpulse),
              o.localPoint.SetV(i.m_localPoint);
            let e = (o.rA.x = h.s_worldManifold.m_points[t].x - a.m_sweep.c.x),
              n = (o.rA.y = h.s_worldManifold.m_points[t].y - a.m_sweep.c.y),
              s = (o.rB.x = h.s_worldManifold.m_points[t].x - c.m_sweep.c.x),
              l = (o.rB.y = h.s_worldManifold.m_points[t].y - c.m_sweep.c.y),
              m = e * A - n * C,
              r = s * A - l * C;
            (m *= m), (r *= r);
            let p = a.m_invMass + c.m_invMass + a.m_invI * m + c.m_invI * r;
            o.normalMass = 1 / p;
            let y = a.m_mass * a.m_invMass + c.m_mass * c.m_invMass;
            (y += a.m_mass * a.m_invI * m + c.m_mass * c.m_invI * r), (o.equalizedMass = 1 / y);
            let w = -C,
              v = e * w - n * A,
              g = s * w - l * A;
            (v *= v), (g *= g);
            let M = a.m_invMass + c.m_invMass + a.m_invI * v + c.m_invI * g;
            (o.tangentMass = 1 / M), (o.velocityBias = 0);
            let V = f + -B * l - u - -d * n,
              I = b + B * s - x - d * e,
              L = S.normal.x * V + S.normal.y * I;
            L < -D.b2_velocityThreshold && (o.velocityBias += -S.restitution * L);
          }
          if (2 === S.pointCount) {
            let t = S.points[0],
              i = S.points[1],
              o = a.m_invMass,
              e = a.m_invI,
              n = c.m_invMass,
              s = c.m_invI,
              l = t.rA.x * A - t.rA.y * C,
              m = t.rB.x * A - t.rB.y * C,
              r = i.rA.x * A - i.rA.y * C,
              _ = i.rB.x * A - i.rB.y * C,
              h = o + n + e * l * l + s * m * m,
              p = o + n + e * r * r + s * _ * _,
              y = o + n + e * l * r + s * m * _;
            h * h < 100 * (h * p - y * y)
              ? (S.K.col1.Set(h, y), S.K.col2.Set(y, p), S.K.GetInverse(S.normalMass))
              : (S.pointCount = 1);
          }
        }
      }),
      (h.prototype.InitVelocityConstraints = function (t) {
        for (let i = 0; i < this.m_constraintCount; ++i) {
          let o = this.m_constraints[i],
            e = o.bodyA,
            n = o.bodyB,
            s = e.m_invMass,
            l = e.m_invI,
            m = n.m_invMass,
            r = n.m_invI,
            a = o.normal.x,
            c = o.normal.y,
            _ = c,
            h = -a,
            p = 0,
            y = 0;
          if (t.warmStarting)
            for (y = o.pointCount, p = 0; p < y; ++p) {
              let i = o.points[p];
              (i.normalImpulse *= t.dtRatio), (i.tangentImpulse *= t.dtRatio);
              let y = i.normalImpulse * a + i.tangentImpulse * _,
                u = i.normalImpulse * c + i.tangentImpulse * h;
              (e.m_angularVelocity -= l * (i.rA.x * u - i.rA.y * y)),
                (e.m_linearVelocity.x -= s * y),
                (e.m_linearVelocity.y -= s * u),
                (n.m_angularVelocity += r * (i.rB.x * u - i.rB.y * y)),
                (n.m_linearVelocity.x += m * y),
                (n.m_linearVelocity.y += m * u);
            }
          else
            for (y = o.pointCount, p = 0; p < y; ++p) {
              let t = o.points[p];
              (t.normalImpulse = 0), (t.tangentImpulse = 0);
            }
        }
      }),
      (h.prototype.SolveVelocityConstraints = function () {
        let t,
          i = 0,
          o = 0,
          e = 0,
          n = 0,
          s = 0,
          l = 0,
          m = 0,
          r = 0,
          a = 0,
          c = 0,
          _ = 0,
          h = 0,
          p = 0,
          y = 0,
          u = 0,
          x = 0,
          f = this.m_constraintCount;
        for (; f > 0; ) {
          let b = this.m_constraints[--f],
            d = b.bodyA,
            B = b.bodyB,
            D = d.m_angularVelocity,
            A = B.m_angularVelocity,
            S = d.m_linearVelocity,
            w = B.m_linearVelocity,
            v = d.m_invMass,
            g = d.m_invI,
            M = B.m_invMass,
            V = B.m_invI,
            I = b.normal.x,
            L = b.normal.y,
            J = L,
            G = -I,
            R = b.friction;
          for (i = b.pointCount; i > 0; )
            (t = b.points[--i]),
              (s =
                (o = w.x - A * t.rB.y - S.x + D * t.rA.y) * J +
                (e = w.y + A * t.rB.x - S.y - D * t.rA.x) * G),
              (l = t.tangentMass * -s),
              (m = R * t.normalImpulse),
              (a = (l = (r = C.Clamp(t.tangentImpulse + l, -m, m)) - t.tangentImpulse) * J),
              (c = l * G),
              (S.x -= v * a),
              (S.y -= v * c),
              (D -= g * (t.rA.x * c - t.rA.y * a)),
              (w.x += M * a),
              (w.y += M * c),
              (A += V * (t.rB.x * c - t.rB.y * a)),
              (t.tangentImpulse = r);
          if (1 === b.pointCount)
            (t = b.points[0]),
              (n =
                (o = w.x + -A * t.rB.y - S.x - -D * t.rA.y) * I +
                (e = w.y + A * t.rB.x - S.y - D * t.rA.x) * L),
              (l = -t.normalMass * (n - t.velocityBias)),
              (a = (l = (r = (r = t.normalImpulse + l) > 0 ? r : 0) - t.normalImpulse) * I),
              (c = l * L),
              (S.x -= v * a),
              (S.y -= v * c),
              (D -= g * (t.rA.x * c - t.rA.y * a)),
              (w.x += M * a),
              (w.y += M * c),
              (A += V * (t.rB.x * c - t.rB.y * a)),
              (t.normalImpulse = r);
          else {
            let t = b.points[0],
              i = b.points[1],
              o = t.normalImpulse,
              e = i.normalImpulse,
              n =
                (w.x - A * t.rB.y - S.x + D * t.rA.y) * I +
                (w.y + A * t.rB.x - S.y - D * t.rA.x) * L,
              s =
                (w.x - A * i.rB.y - S.x + D * i.rA.y) * I +
                (w.y + A * i.rB.x - S.y - D * i.rA.x) * L,
              l = n - t.velocityBias,
              m = s - i.velocityBias,
              r = b.K;
            for (l -= r.col1.x * o + r.col2.x * e, m -= r.col1.y * o + r.col2.y * e; ; ) {
              let a = -((r = b.normalMass).col1.x * l + r.col2.x * m),
                c = -(r.col1.y * l + r.col2.y * m);
              if (a >= 0 && c >= 0) {
                (p = (_ = a - o) * I),
                  (y = _ * L),
                  (u = (h = c - e) * I),
                  (x = h * L),
                  (S.x -= v * (p + u)),
                  (S.y -= v * (y + x)),
                  (D -= g * (t.rA.x * y - t.rA.y * p + i.rA.x * x - i.rA.y * u)),
                  (w.x += M * (p + u)),
                  (w.y += M * (y + x)),
                  (A += V * (t.rB.x * y - t.rB.y * p + i.rB.x * x - i.rB.y * u)),
                  (t.normalImpulse = a),
                  (i.normalImpulse = c);
                break;
              }
              if (
                ((a = -t.normalMass * l),
                (c = 0),
                (n = 0),
                (s = b.K.col1.y * a + m),
                a >= 0 && s >= 0)
              ) {
                (p = (_ = a - o) * I),
                  (y = _ * L),
                  (u = (h = c - e) * I),
                  (x = h * L),
                  (S.x -= v * (p + u)),
                  (S.y -= v * (y + x)),
                  (D -= g * (t.rA.x * y - t.rA.y * p + i.rA.x * x - i.rA.y * u)),
                  (w.x += M * (p + u)),
                  (w.y += M * (y + x)),
                  (A += V * (t.rB.x * y - t.rB.y * p + i.rB.x * x - i.rB.y * u)),
                  (t.normalImpulse = a),
                  (i.normalImpulse = c);
                break;
              }
              if (
                ((a = 0),
                (c = -i.normalMass * m),
                (n = b.K.col2.x * c + l),
                (s = 0),
                c >= 0 && n >= 0)
              ) {
                (p = (_ = a - o) * I),
                  (y = _ * L),
                  (u = (h = c - e) * I),
                  (x = h * L),
                  (S.x -= v * (p + u)),
                  (S.y -= v * (y + x)),
                  (D -= g * (t.rA.x * y - t.rA.y * p + i.rA.x * x - i.rA.y * u)),
                  (w.x += M * (p + u)),
                  (w.y += M * (y + x)),
                  (A += V * (t.rB.x * y - t.rB.y * p + i.rB.x * x - i.rB.y * u)),
                  (t.normalImpulse = a),
                  (i.normalImpulse = c);
                break;
              }
              if (((a = 0), (c = 0), (s = m), (n = l) >= 0 && s >= 0)) {
                (p = (_ = a - o) * I),
                  (y = _ * L),
                  (u = (h = c - e) * I),
                  (x = h * L),
                  (S.x -= v * (p + u)),
                  (S.y -= v * (y + x)),
                  (D -= g * (t.rA.x * y - t.rA.y * p + i.rA.x * x - i.rA.y * u)),
                  (w.x += M * (p + u)),
                  (w.y += M * (y + x)),
                  (A += V * (t.rB.x * y - t.rB.y * p + i.rB.x * x - i.rB.y * u)),
                  (t.normalImpulse = a),
                  (i.normalImpulse = c);
                break;
              }
              break;
            }
          }
          (d.m_angularVelocity = D), (B.m_angularVelocity = A);
        }
      }),
      (h.prototype.FinalizeVelocityConstraints = function () {
        for (let t = 0; t < this.m_constraintCount; ++t) {
          let i = this.m_constraints[t],
            o = i.manifold;
          for (let t = 0; t < i.pointCount; ++t) {
            let e = o.m_points[t],
              n = i.points[t];
            (e.m_normalImpulse = n.normalImpulse), (e.m_tangentImpulse = n.tangentImpulse);
          }
        }
      }),
      (h.prototype.SolvePositionConstraints = function (t) {
        let i = 0;
        for (let o = 0; o < this.m_constraintCount; o++) {
          let e = this.m_constraints[o],
            n = e.bodyA,
            s = e.bodyB,
            l = n.m_mass * n.m_invMass,
            m = n.m_mass * n.m_invI,
            r = s.m_mass * s.m_invMass,
            a = s.m_mass * s.m_invI;
          h.s_psm.Initialize(e);
          let c = h.s_psm.m_normal;
          for (let o = 0; o < e.pointCount; o++) {
            let _ = h.s_psm.m_points[o],
              p = h.s_psm.m_separations[o],
              y = _.x - n.m_sweep.c.x,
              u = _.y - n.m_sweep.c.y,
              x = _.x - s.m_sweep.c.x,
              f = _.y - s.m_sweep.c.y;
            i = i < p ? i : p;
            let b = C.Clamp(t * (p + D.b2_linearSlop), -D.b2_maxLinearCorrection, 0),
              d = -e.points[o].equalizedMass * b,
              B = d * c.x,
              A = d * c.y;
            (n.m_sweep.c.x -= l * B),
              (n.m_sweep.c.y -= l * A),
              (n.m_sweep.a -= m * (y * A - u * B)),
              (s.m_sweep.c.x += r * B),
              (s.m_sweep.c.y += r * A),
              (s.m_sweep.a += a * (x * A - f * B));
          }
          n.SynchronizeTransform(), s.SynchronizeTransform();
        }
        return i > -1.5 * D.b2_linearSlop;
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold = new V()),
          (Box2D.Dynamics.Contacts.b2ContactSolver.s_psm = new b());
      }),
      Box2D.inherit(p, Box2D.Dynamics.Contacts.b2Contact),
      (p.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype),
      (p.b2EdgeAndCircleContact = function () {
        Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
      }),
      (p.Create = function (t) {
        return new p();
      }),
      (p.Destroy = function (t, i) {}),
      (p.prototype.Reset = function (t, i) {
        this.__super.Reset.call(this, t, i);
      }),
      (p.prototype.Evaluate = function () {
        let o = this.m_fixtureA.GetBody(),
          e = this.m_fixtureB.GetBody();
        this.b2CollideEdgeAndCircle(
          this.m_manifold,
          this.m_fixtureA.GetShape() instanceof i ? this.m_fixtureA.GetShape() : null,
          o.m_xf,
          this.m_fixtureB.GetShape() instanceof t ? this.m_fixtureB.GetShape() : null,
          e.m_xf
        );
      }),
      (p.prototype.b2CollideEdgeAndCircle = function (t, i, o, e, n) {}),
      Box2D.inherit(y, Box2D.Dynamics.Contacts.b2Contact),
      (y.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype),
      (y.b2NullContact = function () {
        Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
      }),
      (y.prototype.b2NullContact = function () {
        this.__super.b2Contact.call(this);
      }),
      (y.prototype.Evaluate = function () {}),
      Box2D.inherit(u, Box2D.Dynamics.Contacts.b2Contact),
      (u.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype),
      (u.Create = function (t) {
        return new u();
      }),
      (u.Destroy = function (t, i) {}),
      (u.prototype.Reset = function (t, i) {
        this.__super.Reset.call(this, t, i);
      }),
      (u.prototype.Evaluate = function () {
        let i = this.m_fixtureA.m_body,
          e = this.m_fixtureB.m_body;
        S.CollidePolygonAndCircle(
          this.m_manifold,
          this.m_fixtureA.GetShape() instanceof o ? this.m_fixtureA.GetShape() : null,
          i.m_xf,
          this.m_fixtureB.GetShape() instanceof t ? this.m_fixtureB.GetShape() : null,
          e.m_xf
        );
      }),
      Box2D.inherit(x, Box2D.Dynamics.Contacts.b2Contact),
      (x.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype),
      (x.b2PolyAndEdgeContact = function () {
        s.b2Contact.apply(this, arguments);
      }),
      (x.Create = function (t) {
        return new x();
      }),
      (x.Destroy = function (t, i) {}),
      (x.prototype.Reset = function (t, i) {
        this.__super.Reset.call(this, t, i);
      }),
      (x.prototype.Evaluate = function () {
        let t = this.m_fixtureA.GetBody(),
          e = this.m_fixtureB.GetBody();
        this.b2CollidePolyAndEdge(
          this.m_manifold,
          this.m_fixtureA.GetShape() instanceof o ? this.m_fixtureA.GetShape() : null,
          t.m_xf,
          this.m_fixtureB.GetShape() instanceof i ? this.m_fixtureB.GetShape() : null,
          e.m_xf
        );
      }),
      (x.prototype.b2CollidePolyAndEdge = function (t, i, o, e, n) {}),
      Box2D.inherit(f, Box2D.Dynamics.Contacts.b2Contact),
      (f.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype),
      (f.b2PolygonContact = function () {
        s.b2Contact.apply(this, arguments);
      }),
      (f.Create = function (t) {
        return new f();
      }),
      (f.Destroy = function (t, i) {}),
      (f.prototype.Reset = function (t, i) {
        this.__super.Reset.call(this, t, i);
      }),
      (f.prototype.Evaluate = function () {
        let t = this.m_fixtureA.GetBody(),
          i = this.m_fixtureB.GetBody();
        S.CollidePolygons(
          this.m_manifold,
          this.m_fixtureA.m_shape instanceof o ? this.m_fixtureA.m_shape : null,
          t.m_xf,
          this.m_fixtureB.m_shape instanceof o ? this.m_fixtureB.m_shape : null,
          i.m_xf
        );
      }),
      (b.b2PositionSolverManifold = function () {}),
      (b.prototype.b2PositionSolverManifold = function () {
        (this.m_normal = new A()),
          (this.m_separations = [0, 0]),
          (this.m_points = [new A(), new A()]);
      }),
      (b.prototype.Initialize = function (t) {
        let i,
          o,
          e = 0,
          n = 0,
          s = 0,
          l = 0,
          m = 0;
        switch (t.type) {
          case v.e_circles:
            {
              (i = t.bodyA.m_xf.R), (o = t.localPoint);
              let e = t.bodyA.m_xf.position.x + (i.col1.x * o.x + i.col2.x * o.y),
                n = t.bodyA.m_xf.position.y + (i.col1.y * o.x + i.col2.y * o.y);
              (i = t.bodyB.m_xf.R), (o = t.points[0].localPoint);
              let s = t.bodyB.m_xf.position.x + (i.col1.x * o.x + i.col2.x * o.y),
                l = t.bodyB.m_xf.position.y + (i.col1.y * o.x + i.col2.y * o.y),
                m = s - e,
                r = l - n,
                a = m * m + r * r;
              if (a > Number.MIN_VALUE * Number.MIN_VALUE) {
                let t = Math.sqrt(a);
                (this.m_normal.x = m / t), (this.m_normal.y = r / t);
              } else (this.m_normal.x = 1), (this.m_normal.y = 0);
              (this.m_points[0].x = 0.5 * (e + s)),
                (this.m_points[0].y = 0.5 * (n + l)),
                (this.m_separations[0] = m * this.m_normal.x + r * this.m_normal.y - t.radius);
            }
            break;
          case v.e_faceA:
            for (
              i = t.bodyA.m_xf.R,
                o = t.localPlaneNormal,
                this.m_normal.x = i.col1.x * o.x + i.col2.x * o.y,
                this.m_normal.y = i.col1.y * o.x + i.col2.y * o.y,
                i = t.bodyA.m_xf.R,
                o = t.localPoint,
                l = t.bodyA.m_xf.position.x + (i.col1.x * o.x + i.col2.x * o.y),
                m = t.bodyA.m_xf.position.y + (i.col1.y * o.x + i.col2.y * o.y),
                i = t.bodyB.m_xf.R,
                e = t.pointCount;
              e > 0;

            )
              (o = t.points[--e].localPoint),
                (n = t.bodyB.m_xf.position.x + (i.col1.x * o.x + i.col2.x * o.y)),
                (s = t.bodyB.m_xf.position.y + (i.col1.y * o.x + i.col2.y * o.y)),
                (this.m_separations[e] =
                  (n - l) * this.m_normal.x + (s - m) * this.m_normal.y - t.radius),
                (this.m_points[e].x = n),
                (this.m_points[e].y = s);
            break;
          case v.e_faceB:
            for (
              i = t.bodyB.m_xf.R,
                o = t.localPlaneNormal,
                this.m_normal.x = i.col1.x * o.x + i.col2.x * o.y,
                this.m_normal.y = i.col1.y * o.x + i.col2.y * o.y,
                i = t.bodyB.m_xf.R,
                o = t.localPoint,
                l = t.bodyB.m_xf.position.x + (i.col1.x * o.x + i.col2.x * o.y),
                m = t.bodyB.m_xf.position.y + (i.col1.y * o.x + i.col2.y * o.y),
                i = t.bodyA.m_xf.R,
                e = t.pointCount;
              e > 0;

            )
              (o = t.points[--e].localPoint),
                (n = t.bodyA.m_xf.position.x + (i.col1.x * o.x + i.col2.x * o.y)),
                (s = t.bodyA.m_xf.position.y + (i.col1.y * o.x + i.col2.y * o.y)),
                (this.m_separations[e] =
                  (n - l) * this.m_normal.x + (s - m) * this.m_normal.y - t.radius),
                this.m_points[e].Set(n, s);
            (this.m_normal.x *= -1), (this.m_normal.y *= -1);
        }
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA = new A()),
          (Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB = new A());
      });
  })(),
  (function () {
    let t = Box2D.Common.Math.b2Mat22,
      i = Box2D.Common.Math.b2Math,
      o = Box2D.Common.Math.b2Vec2,
      e = Box2D.Dynamics.Controllers.b2BuoyancyController,
      n = Box2D.Dynamics.Controllers.b2ConstantAccelController,
      s = Box2D.Dynamics.Controllers.b2ConstantForceController,
      l = Box2D.Dynamics.Controllers.b2Controller,
      m = Box2D.Dynamics.Controllers.b2ControllerEdge,
      r = Box2D.Dynamics.Controllers.b2GravityController,
      a = Box2D.Dynamics.Controllers.b2TensorDampingController;
    Box2D.inherit(e, Box2D.Dynamics.Controllers.b2Controller),
      (e.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype),
      (e.b2BuoyancyController = function () {
        Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments),
          (this.normal = new o(0, -1)),
          (this.offset = 0),
          (this.density = 0),
          (this.velocity = new o()),
          (this.linearDrag = 2),
          (this.angularDrag = 1),
          (this.useDensity = !1),
          (this.useWorldGravity = !0),
          (this.gravity = null);
      }),
      (e.prototype.Step = function (t) {
        if (this.m_bodyList) {
          this.useWorldGravity && (this.gravity = this.GetWorld().GetGravity().Copy());
          for (let t = this.m_bodyList; t; t = t.nextBody) {
            let i = t.body;
            if (!i.m_isAwake) continue;
            let e = new o(),
              n = new o(),
              s = 0,
              l = 0;
            for (let t = i.GetFixtureList(); t; t = t.GetNext()) {
              let m = new o(),
                r = t
                  .GetShape()
                  .ComputeSubmergedArea(this.normal, this.offset, i.GetTransform(), m);
              (s += r), (e.x += r * m.x), (e.y += r * m.y);
              let a = 0;
              (l += r * (a = (this.useDensity, 1))), (n.x += r * m.x * a), (n.y += r * m.y * a);
            }
            if (((e.x /= s), (e.y /= s), (n.x /= l), (n.y /= l), s < Number.MIN_VALUE)) continue;
            let m = this.gravity.GetNegative();
            m.Multiply(this.density * s), i.ApplyForce(m, n);
            let r = i.GetLinearVelocityFromWorldPoint(e);
            r.Subtract(this.velocity),
              r.Multiply(-this.linearDrag * s),
              i.ApplyForce(r, e),
              i.ApplyTorque((-i.m_I / i.m_mass) * s * i.m_angularVelocity * this.angularDrag);
          }
        }
      }),
      Box2D.inherit(n, Box2D.Dynamics.Controllers.b2Controller),
      (n.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype),
      (n.b2ConstantAccelController = function () {
        Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments),
          (this.A = new o());
      }),
      (n.prototype.Step = function (t) {
        let i = new o(this.A.x * t.dt, this.A.y * t.dt);
        for (let t = this.m_bodyList; t; t = t.nextBody) {
          let e = t.body;
          if (!e.m_isAwake) continue;
          let n = new o(e.m_linearVelocity.x + i.x, e.m_linearVelocity.y + i.y);
          e.SetLinearVelocity(n);
        }
      }),
      Box2D.inherit(s, Box2D.Dynamics.Controllers.b2Controller),
      (s.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype),
      (s.b2ConstantForceController = function () {
        Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments),
          (this.F = new o());
      }),
      (s.prototype.Step = function (t) {
        for (let t = this.m_bodyList; t; t = t.nextBody) {
          let i = t.body;
          i.m_isAwake && i.ApplyForce(this.F, i.m_sweep.c);
        }
      }),
      (l.b2Controller = function () {}),
      (l.prototype.Step = function (t) {}),
      (l.prototype.AddBody = function (t) {
        let i = new m();
        (i.controller = this),
          (i.body = t),
          (i.nextBody = this.m_bodyList),
          (i.prevBody = null),
          (this.m_bodyList = i),
          i.nextBody && (i.nextBody.prevBody = i),
          this.m_bodyCount++,
          (i.nextController = t.m_controllerList),
          (i.prevController = null),
          (t.m_controllerList = i),
          i.nextController && (i.nextController.prevController = i),
          t.m_controllerCount++;
      }),
      (l.prototype.RemoveBody = function (t) {
        let i = t.m_controllerList;
        for (; i && i.controller !== this; ) i = i.nextController;
        i.prevBody && (i.prevBody.nextBody = i.nextBody),
          i.nextBody && (i.nextBody.prevBody = i.prevBody),
          i.nextController && (i.nextController.prevController = i.prevController),
          i.prevController && (i.prevController.nextController = i.nextController),
          this.m_bodyList === i && (this.m_bodyList = i.nextBody),
          t.m_controllerList === i && (t.m_controllerList = i.nextController),
          t.m_controllerCount--,
          this.m_bodyCount--;
      }),
      (l.prototype.Clear = function () {
        for (; this.m_bodyList; ) this.RemoveBody(this.m_bodyList.body);
      }),
      (l.prototype.GetNext = function () {
        return this.m_next;
      }),
      (l.prototype.GetWorld = function () {
        return this.m_world;
      }),
      (l.prototype.GetBodyList = function () {
        return this.m_bodyList;
      }),
      (m.b2ControllerEdge = function () {}),
      Box2D.inherit(r, Box2D.Dynamics.Controllers.b2Controller),
      (r.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype),
      (r.b2GravityController = function () {
        Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments),
          (this.G = 1),
          (this.invSqr = !0);
      }),
      (r.prototype.Step = function (t) {
        let i = null,
          e = null,
          n = null,
          s = 0,
          l = null,
          m = null,
          r = null,
          a = 0,
          c = 0,
          _ = 0,
          h = null;
        if (this.invSqr)
          for (i = this.m_bodyList; i; i = i.nextBody)
            for (
              n = (e = i.body).m_sweep.c, s = e.m_mass, l = this.m_bodyList;
              l !== i;
              l = l.nextBody
            )
              (_ = (a = (r = (m = l.body).m_sweep.c).x - n.x) * a + (c = r.y - n.y) * c) <
                Number.MIN_VALUE ||
                ((h = new o(a, c)).Multiply((this.G / _ / Math.sqrt(_)) * s * m.m_mass),
                e.m_isAwake && e.ApplyForce(h, n),
                h.Multiply(-1),
                m.m_isAwake && m.ApplyForce(h, r));
        else
          for (i = this.m_bodyList; i; i = i.nextBody)
            for (
              n = (e = i.body).m_sweep.c, s = e.m_mass, l = this.m_bodyList;
              l !== i;
              l = l.nextBody
            )
              (_ = (a = (r = (m = l.body).m_sweep.c).x - n.x) * a + (c = r.y - n.y) * c) <
                Number.MIN_VALUE ||
                ((h = new o(a, c)).Multiply((this.G / _) * s * m.m_mass),
                e.m_isAwake && e.ApplyForce(h, n),
                h.Multiply(-1),
                m.m_isAwake && m.ApplyForce(h, r));
      }),
      Box2D.inherit(a, Box2D.Dynamics.Controllers.b2Controller),
      (a.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype),
      (a.b2TensorDampingController = function () {
        Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments),
          (this.T = new t()),
          (this.maxTimestep = 0);
      }),
      (a.prototype.SetAxisAligned = function (t, i) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          (this.T.col1.x = -t),
          (this.T.col1.y = 0),
          (this.T.col2.x = 0),
          (this.T.col2.y = -i),
          (this.maxTimestep = t > 0 || i > 0 ? 1 / Math.max(t, i) : 0);
      }),
      (a.prototype.Step = function (t) {
        let e = t.dt;
        if (!(e <= Number.MIN_VALUE)) {
          e > this.maxTimestep && this.maxTimestep > 0 && (e = this.maxTimestep);
          for (let t = this.m_bodyList; t; t = t.nextBody) {
            let n = t.body;
            if (!n.m_isAwake) continue;
            let s = i.MulMV(this.T, n.GetLocalVector(n.m_linearVelocity)),
              l = n.GetWorldVector(s),
              m = new o(n.m_linearVelocity.x + l.x * e, n.m_linearVelocity.y + l.y * e);
            n.SetLinearVelocity(m);
          }
        }
      });
  })(),
  (function () {
    Box2D.Common.b2Color, Box2D.Common.b2internal;
    let t = Box2D.Common.b2Settings,
      i = Box2D.Common.Math.b2Mat22,
      o = Box2D.Common.Math.b2Mat33,
      e = Box2D.Common.Math.b2Math,
      n = (Box2D.Common.Math.b2Sweep, Box2D.Common.Math.b2Transform, Box2D.Common.Math.b2Vec2),
      s = Box2D.Common.Math.b2Vec3,
      l = Box2D.Dynamics.Joints.b2DistanceJoint,
      m = Box2D.Dynamics.Joints.b2DistanceJointDef,
      r = Box2D.Dynamics.Joints.b2FrictionJoint,
      a = Box2D.Dynamics.Joints.b2FrictionJointDef,
      c = Box2D.Dynamics.Joints.b2GearJoint,
      _ = Box2D.Dynamics.Joints.b2GearJointDef,
      h = Box2D.Dynamics.Joints.b2Jacobian,
      p = Box2D.Dynamics.Joints.b2Joint,
      y = Box2D.Dynamics.Joints.b2JointDef,
      u = Box2D.Dynamics.Joints.b2JointEdge,
      x = Box2D.Dynamics.Joints.b2LineJoint,
      f = Box2D.Dynamics.Joints.b2LineJointDef,
      b = Box2D.Dynamics.Joints.b2MouseJoint,
      d = Box2D.Dynamics.Joints.b2MouseJointDef,
      B = Box2D.Dynamics.Joints.b2PrismaticJoint,
      D = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      C = Box2D.Dynamics.Joints.b2PulleyJoint,
      A = Box2D.Dynamics.Joints.b2PulleyJointDef,
      S = Box2D.Dynamics.Joints.b2RevoluteJoint,
      w = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      v = Box2D.Dynamics.Joints.b2WeldJoint,
      g = Box2D.Dynamics.Joints.b2WeldJointDef;
    Box2D.Dynamics.b2Body,
      Box2D.Dynamics.b2BodyDef,
      Box2D.Dynamics.b2ContactFilter,
      Box2D.Dynamics.b2ContactImpulse,
      Box2D.Dynamics.b2ContactListener,
      Box2D.Dynamics.b2ContactManager,
      Box2D.Dynamics.b2DestructionListener,
      Box2D.Dynamics.b2FilterData,
      Box2D.Dynamics.b2Fixture,
      Box2D.Dynamics.b2FixtureDef,
      Box2D.Dynamics.b2Island,
      Box2D.Dynamics.b2TimeStep,
      Box2D.Dynamics.b2World;
    Box2D.inherit(l, Box2D.Dynamics.Joints.b2Joint),
      (l.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (l.b2DistanceJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.m_localAnchor1 = new n()),
          (this.m_localAnchor2 = new n()),
          (this.m_u = new n());
      }),
      (l.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      }),
      (l.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      }),
      (l.prototype.GetReactionForce = function (t) {
        return new n(t * this.m_impulse * this.m_u.x, t * this.m_impulse * this.m_u.y);
      }),
      (l.prototype.GetReactionTorque = function (t) {
        return 0;
      }),
      (l.prototype.GetLength = function () {
        return this.m_length;
      }),
      (l.prototype.SetLength = function (t) {
        void 0 === t && (t = 0), (this.m_length = t);
      }),
      (l.prototype.GetFrequency = function () {
        return this.m_frequencyHz;
      }),
      (l.prototype.SetFrequency = function (t) {
        void 0 === t && (t = 0), (this.m_frequencyHz = t);
      }),
      (l.prototype.GetDampingRatio = function () {
        return this.m_dampingRatio;
      }),
      (l.prototype.SetDampingRatio = function (t) {
        this.m_dampingRatio = t;
      }),
      (l.prototype.b2DistanceJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          this.m_localAnchor1.SetV(t.localAnchorA),
          this.m_localAnchor2.SetV(t.localAnchorB),
          (this.m_length = t.length),
          (this.m_frequencyHz = t.frequencyHz),
          (this.m_dampingRatio = t.dampingRatio),
          (this.m_impulse = 0),
          (this.m_gamma = 0),
          (this.m_bias = 0);
      }),
      (l.prototype.InitVelocityConstraints = function (i) {
        let o = this.m_bodyA,
          e = this.m_bodyB,
          n = o.m_xf.R,
          s = this.m_localAnchor1.x - o.m_sweep.localCenter.x,
          l = this.m_localAnchor1.y - o.m_sweep.localCenter.y,
          m = n.col1.x * s + n.col2.x * l;
        (l = n.col1.y * s + n.col2.y * l), (s = m), (n = e.m_xf.R);
        let r = this.m_localAnchor2.x - e.m_sweep.localCenter.x,
          a = this.m_localAnchor2.y - e.m_sweep.localCenter.y;
        (m = n.col1.x * r + n.col2.x * a),
          (a = n.col1.y * r + n.col2.y * a),
          (r = m),
          (this.m_u.x = e.m_sweep.c.x + r - o.m_sweep.c.x - s),
          (this.m_u.y = e.m_sweep.c.y + a - o.m_sweep.c.y - l);
        let c = Math.sqrt(this.m_u.x * this.m_u.x + this.m_u.y * this.m_u.y);
        c > t.b2_linearSlop ? this.m_u.Multiply(1 / c) : this.m_u.SetZero();
        let _ = s * this.m_u.y - l * this.m_u.x,
          h = r * this.m_u.y - a * this.m_u.x,
          p = o.m_invMass + o.m_invI * _ * _ + e.m_invMass + e.m_invI * h * h;
        if (((this.m_mass = 0 !== p ? 1 / p : 0), this.m_frequencyHz > 0)) {
          let t = c - this.m_length,
            o = 2 * Math.PI * this.m_frequencyHz,
            e = 2 * this.m_mass * this.m_dampingRatio * o,
            n = this.m_mass * o * o;
          (this.m_gamma = i.dt * (e + i.dt * n)),
            (this.m_gamma = 0 !== this.m_gamma ? 1 / this.m_gamma : 0),
            (this.m_bias = t * i.dt * n * this.m_gamma),
            (this.m_mass = p + this.m_gamma),
            (this.m_mass = 0 !== this.m_mass ? 1 / this.m_mass : 0);
        }
        if (i.warmStarting) {
          this.m_impulse *= i.dtRatio;
          let t = this.m_impulse * this.m_u.x,
            n = this.m_impulse * this.m_u.y;
          (o.m_linearVelocity.x -= o.m_invMass * t),
            (o.m_linearVelocity.y -= o.m_invMass * n),
            (o.m_angularVelocity -= o.m_invI * (s * n - l * t)),
            (e.m_linearVelocity.x += e.m_invMass * t),
            (e.m_linearVelocity.y += e.m_invMass * n),
            (e.m_angularVelocity += e.m_invI * (r * n - a * t));
        } else this.m_impulse = 0;
      }),
      (l.prototype.SolveVelocityConstraints = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = t.m_xf.R,
          e = this.m_localAnchor1.x - t.m_sweep.localCenter.x,
          n = this.m_localAnchor1.y - t.m_sweep.localCenter.y,
          s = o.col1.x * e + o.col2.x * n;
        (n = o.col1.y * e + o.col2.y * n), (e = s), (o = i.m_xf.R);
        let l = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
          m = this.m_localAnchor2.y - i.m_sweep.localCenter.y;
        (s = o.col1.x * l + o.col2.x * m), (m = o.col1.y * l + o.col2.y * m), (l = s);
        let r = t.m_linearVelocity.x + -t.m_angularVelocity * n,
          a = t.m_linearVelocity.y + t.m_angularVelocity * e,
          c = i.m_linearVelocity.x + -i.m_angularVelocity * m,
          _ = i.m_linearVelocity.y + i.m_angularVelocity * l,
          h = this.m_u.x * (c - r) + this.m_u.y * (_ - a),
          p = -this.m_mass * (h + this.m_bias + this.m_gamma * this.m_impulse);
        this.m_impulse += p;
        let y = p * this.m_u.x,
          u = p * this.m_u.y;
        (t.m_linearVelocity.x -= t.m_invMass * y),
          (t.m_linearVelocity.y -= t.m_invMass * u),
          (t.m_angularVelocity -= t.m_invI * (e * u - n * y)),
          (i.m_linearVelocity.x += i.m_invMass * y),
          (i.m_linearVelocity.y += i.m_invMass * u),
          (i.m_angularVelocity += i.m_invI * (l * u - m * y));
      }),
      (l.prototype.SolvePositionConstraints = function () {
        if (this.m_frequencyHz > 0) return !0;
        let i = this.m_bodyA,
          o = this.m_bodyB,
          n = i.m_xf.R,
          s = this.m_localAnchor1.x - i.m_sweep.localCenter.x,
          l = this.m_localAnchor1.y - i.m_sweep.localCenter.y,
          m = n.col1.x * s + n.col2.x * l;
        (l = n.col1.y * s + n.col2.y * l), (s = m), (n = o.m_xf.R);
        let r = this.m_localAnchor2.x - o.m_sweep.localCenter.x,
          a = this.m_localAnchor2.y - o.m_sweep.localCenter.y;
        (m = n.col1.x * r + n.col2.x * a), (a = n.col1.y * r + n.col2.y * a), (r = m);
        let c = o.m_sweep.c.x + r - i.m_sweep.c.x - s,
          _ = o.m_sweep.c.y + a - i.m_sweep.c.y - l,
          h = Math.sqrt(c * c + _ * _);
        (c /= h), (_ /= h);
        let p = h - this.m_length;
        p = e.Clamp(p, -t.b2_maxLinearCorrection, t.b2_maxLinearCorrection);
        let y = -this.m_mass * p;
        this.m_u.Set(c, _);
        let u = y * this.m_u.x,
          x = y * this.m_u.y;
        return (
          (i.m_sweep.c.x -= i.m_invMass * u),
          (i.m_sweep.c.y -= i.m_invMass * x),
          (i.m_sweep.a -= i.m_invI * (s * x - l * u)),
          (o.m_sweep.c.x += o.m_invMass * u),
          (o.m_sweep.c.y += o.m_invMass * x),
          (o.m_sweep.a += o.m_invI * (r * x - a * u)),
          i.SynchronizeTransform(),
          o.SynchronizeTransform(),
          e.Abs(p) < t.b2_linearSlop
        );
      }),
      Box2D.inherit(m, Box2D.Dynamics.Joints.b2JointDef),
      (m.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (m.b2DistanceJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments),
          (this.localAnchorA = new n()),
          (this.localAnchorB = new n());
      }),
      (m.prototype.b2DistanceJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_distanceJoint),
          (this.length = 1),
          (this.frequencyHz = 0),
          (this.dampingRatio = 0);
      }),
      (m.prototype.Initialize = function (t, i, o, e) {
        (this.bodyA = t),
          (this.bodyB = i),
          this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o)),
          this.localAnchorB.SetV(this.bodyB.GetLocalPoint(e));
        let n = e.x - o.x,
          s = e.y - o.y;
        (this.length = Math.sqrt(n * n + s * s)), (this.frequencyHz = 0), (this.dampingRatio = 0);
      }),
      Box2D.inherit(r, Box2D.Dynamics.Joints.b2Joint),
      (r.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (r.b2FrictionJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.m_localAnchorA = new n()),
          (this.m_localAnchorB = new n()),
          (this.m_linearMass = new i()),
          (this.m_linearImpulse = new n());
      }),
      (r.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
      }),
      (r.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
      }),
      (r.prototype.GetReactionForce = function (t) {
        return new n(t * this.m_linearImpulse.x, t * this.m_linearImpulse.y);
      }),
      (r.prototype.GetReactionTorque = function (t) {
        return t * this.m_angularImpulse;
      }),
      (r.prototype.SetMaxForce = function (t) {
        this.m_maxForce = t;
      }),
      (r.prototype.GetMaxForce = function () {
        return this.m_maxForce;
      }),
      (r.prototype.SetMaxTorque = function (t) {
        this.m_maxTorque = t;
      }),
      (r.prototype.GetMaxTorque = function () {
        return this.m_maxTorque;
      }),
      (r.prototype.b2FrictionJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          this.m_localAnchorA.SetV(t.localAnchorA),
          this.m_localAnchorB.SetV(t.localAnchorB),
          this.m_linearMass.SetZero(),
          (this.m_angularMass = 0),
          this.m_linearImpulse.SetZero(),
          (this.m_angularImpulse = 0),
          (this.m_maxForce = t.maxForce),
          (this.m_maxTorque = t.maxTorque);
      }),
      (r.prototype.InitVelocityConstraints = function (t) {
        let o = this.m_bodyA,
          e = this.m_bodyB,
          n = o.m_xf.R,
          s = this.m_localAnchorA.x - o.m_sweep.localCenter.x,
          l = this.m_localAnchorA.y - o.m_sweep.localCenter.y,
          m = n.col1.x * s + n.col2.x * l;
        (l = n.col1.y * s + n.col2.y * l), (s = m), (n = e.m_xf.R);
        let r = this.m_localAnchorB.x - e.m_sweep.localCenter.x,
          a = this.m_localAnchorB.y - e.m_sweep.localCenter.y;
        (m = n.col1.x * r + n.col2.x * a), (a = n.col1.y * r + n.col2.y * a), (r = m);
        let c = o.m_invMass,
          _ = e.m_invMass,
          h = o.m_invI,
          p = e.m_invI,
          y = new i();
        if (
          ((y.col1.x = c + _),
          (y.col2.x = 0),
          (y.col1.y = 0),
          (y.col2.y = c + _),
          (y.col1.x += h * l * l),
          (y.col2.x += -h * s * l),
          (y.col1.y += -h * s * l),
          (y.col2.y += h * s * s),
          (y.col1.x += p * a * a),
          (y.col2.x += -p * r * a),
          (y.col1.y += -p * r * a),
          (y.col2.y += p * r * r),
          y.GetInverse(this.m_linearMass),
          (this.m_angularMass = h + p),
          this.m_angularMass > 0 && (this.m_angularMass = 1 / this.m_angularMass),
          t.warmStarting)
        ) {
          (this.m_linearImpulse.x *= t.dtRatio),
            (this.m_linearImpulse.y *= t.dtRatio),
            (this.m_angularImpulse *= t.dtRatio);
          let i = this.m_linearImpulse;
          (o.m_linearVelocity.x -= c * i.x),
            (o.m_linearVelocity.y -= c * i.y),
            (o.m_angularVelocity -= h * (s * i.y - l * i.x + this.m_angularImpulse)),
            (e.m_linearVelocity.x += _ * i.x),
            (e.m_linearVelocity.y += _ * i.y),
            (e.m_angularVelocity += p * (r * i.y - a * i.x + this.m_angularImpulse));
        } else this.m_linearImpulse.SetZero(), (this.m_angularImpulse = 0);
      }),
      (r.prototype.SolveVelocityConstraints = function (t) {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          s = i.m_linearVelocity,
          l = i.m_angularVelocity,
          m = o.m_linearVelocity,
          r = o.m_angularVelocity,
          a = i.m_invMass,
          c = o.m_invMass,
          _ = i.m_invI,
          h = o.m_invI,
          p = i.m_xf.R,
          y = this.m_localAnchorA.x - i.m_sweep.localCenter.x,
          u = this.m_localAnchorA.y - i.m_sweep.localCenter.y,
          x = p.col1.x * y + p.col2.x * u;
        (u = p.col1.y * y + p.col2.y * u), (y = x), (p = o.m_xf.R);
        let f = this.m_localAnchorB.x - o.m_sweep.localCenter.x,
          b = this.m_localAnchorB.y - o.m_sweep.localCenter.y;
        (x = p.col1.x * f + p.col2.x * b), (b = p.col1.y * f + p.col2.y * b), (f = x);
        let d = 0;
        {
          let i = -this.m_angularMass * (r - l),
            o = this.m_angularImpulse;
          (d = t.dt * this.m_maxTorque),
            (this.m_angularImpulse = e.Clamp(this.m_angularImpulse + i, -d, d)),
            (l -= _ * (i = this.m_angularImpulse - o)),
            (r += h * i);
        }
        {
          let i = m.x - r * b - s.x + l * u,
            o = m.y + r * f - s.y - l * y,
            p = new n(-i, -o),
            x = e.MulMV(this.m_linearMass, p),
            B = this.m_linearImpulse.Copy();
          this.m_linearImpulse.Add(x),
            (d = t.dt * this.m_maxForce),
            this.m_linearImpulse.LengthSquared() > d * d &&
              (this.m_linearImpulse.Normalize(), this.m_linearImpulse.Multiply(d)),
            (x = new n(this.m_linearImpulse.x - B.x, this.m_linearImpulse.y - B.y)),
            (s.x -= a * x.x),
            (s.y -= a * x.y),
            (l -= _ * (y * x.y - u * x.x)),
            (m.x += c * x.x),
            (m.y += c * x.y),
            (r += h * (f * x.y - b * x.x));
        }
        (i.m_angularVelocity = l), (o.m_angularVelocity = r);
      }),
      (r.prototype.SolvePositionConstraints = function () {
        return !0;
      }),
      Box2D.inherit(a, Box2D.Dynamics.Joints.b2JointDef),
      (a.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (a.b2FrictionJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments),
          (this.localAnchorA = new n()),
          (this.localAnchorB = new n());
      }),
      (a.prototype.b2FrictionJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_frictionJoint),
          (this.maxForce = 0),
          (this.maxTorque = 0);
      }),
      (a.prototype.Initialize = function (t, i, o) {
        (this.bodyA = t),
          (this.bodyB = i),
          this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o)),
          this.localAnchorB.SetV(this.bodyB.GetLocalPoint(o));
      }),
      Box2D.inherit(c, Box2D.Dynamics.Joints.b2Joint),
      (c.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (c.b2GearJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.m_groundAnchor1 = new n()),
          (this.m_groundAnchor2 = new n()),
          (this.m_localAnchor1 = new n()),
          (this.m_localAnchor2 = new n()),
          (this.m_J = new h());
      }),
      (c.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      }),
      (c.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      }),
      (c.prototype.GetReactionForce = function (t) {
        return new n(
          t * this.m_impulse * this.m_J.linearB.x,
          t * this.m_impulse * this.m_J.linearB.y
        );
      }),
      (c.prototype.GetReactionTorque = function (t) {
        void 0 === t && (t = 0);
        let i = this.m_bodyB.m_xf.R,
          o = this.m_localAnchor1.x - this.m_bodyB.m_sweep.localCenter.x,
          e = this.m_localAnchor1.y - this.m_bodyB.m_sweep.localCenter.y,
          n = i.col1.x * o + i.col2.x * e;
        (e = i.col1.y * o + i.col2.y * e), (o = n);
        let s = this.m_impulse * this.m_J.linearB.x,
          l = this.m_impulse * this.m_J.linearB.y;
        return t * (this.m_impulse * this.m_J.angularB - o * l + e * s);
      }),
      (c.prototype.GetRatio = function () {
        return this.m_ratio;
      }),
      (c.prototype.SetRatio = function (t) {
        void 0 === t && (t = 0), (this.m_ratio = t);
      }),
      (c.prototype.b2GearJoint = function (t) {
        this.__super.b2Joint.call(this, t);
        let i = t.joint1.m_type,
          o = t.joint2.m_type;
        (this.m_revolute1 = null),
          (this.m_prismatic1 = null),
          (this.m_revolute2 = null),
          (this.m_prismatic2 = null);
        let e = 0,
          n = 0;
        (this.m_ground1 = t.joint1.GetBodyA()),
          (this.m_bodyA = t.joint1.GetBodyB()),
          i === p.e_revoluteJoint
            ? ((this.m_revolute1 = t.joint1 instanceof S ? t.joint1 : null),
              this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),
              this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),
              (e = this.m_revolute1.GetJointAngle()))
            : ((this.m_prismatic1 = t.joint1 instanceof B ? t.joint1 : null),
              this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),
              this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),
              (e = this.m_prismatic1.GetJointTranslation())),
          (this.m_ground2 = t.joint2.GetBodyA()),
          (this.m_bodyB = t.joint2.GetBodyB()),
          o === p.e_revoluteJoint
            ? ((this.m_revolute2 = t.joint2 instanceof S ? t.joint2 : null),
              this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),
              this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),
              (n = this.m_revolute2.GetJointAngle()))
            : ((this.m_prismatic2 = t.joint2 instanceof B ? t.joint2 : null),
              this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),
              this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),
              (n = this.m_prismatic2.GetJointTranslation())),
          (this.m_ratio = t.ratio),
          (this.m_constant = e + this.m_ratio * n),
          (this.m_impulse = 0);
      }),
      (c.prototype.InitVelocityConstraints = function (t) {
        let i,
          o,
          e = this.m_ground1,
          n = this.m_ground2,
          s = this.m_bodyA,
          l = this.m_bodyB,
          m = 0,
          r = 0,
          a = 0,
          c = 0,
          _ = 0,
          h = 0,
          p = 0;
        this.m_J.SetZero(),
          this.m_revolute1
            ? ((this.m_J.angularA = -1), (p += s.m_invI))
            : ((i = e.m_xf.R),
              (o = this.m_prismatic1.m_localXAxis1),
              (m = i.col1.x * o.x + i.col2.x * o.y),
              (r = i.col1.y * o.x + i.col2.y * o.y),
              (i = s.m_xf.R),
              (a = this.m_localAnchor1.x - s.m_sweep.localCenter.x),
              (c = this.m_localAnchor1.y - s.m_sweep.localCenter.y),
              (h = i.col1.x * a + i.col2.x * c),
              (c = i.col1.y * a + i.col2.y * c),
              (_ = (a = h) * r - c * m),
              this.m_J.linearA.Set(-m, -r),
              (this.m_J.angularA = -_),
              (p += s.m_invMass + s.m_invI * _ * _)),
          this.m_revolute2
            ? ((this.m_J.angularB = -this.m_ratio), (p += this.m_ratio * this.m_ratio * l.m_invI))
            : ((i = n.m_xf.R),
              (o = this.m_prismatic2.m_localXAxis1),
              (m = i.col1.x * o.x + i.col2.x * o.y),
              (r = i.col1.y * o.x + i.col2.y * o.y),
              (i = l.m_xf.R),
              (a = this.m_localAnchor2.x - l.m_sweep.localCenter.x),
              (c = this.m_localAnchor2.y - l.m_sweep.localCenter.y),
              (h = i.col1.x * a + i.col2.x * c),
              (c = i.col1.y * a + i.col2.y * c),
              (_ = (a = h) * r - c * m),
              this.m_J.linearB.Set(-this.m_ratio * m, -this.m_ratio * r),
              (this.m_J.angularB = -this.m_ratio * _),
              (p += this.m_ratio * this.m_ratio * (l.m_invMass + l.m_invI * _ * _))),
          (this.m_mass = p > 0 ? 1 / p : 0),
          t.warmStarting
            ? ((s.m_linearVelocity.x += s.m_invMass * this.m_impulse * this.m_J.linearA.x),
              (s.m_linearVelocity.y += s.m_invMass * this.m_impulse * this.m_J.linearA.y),
              (s.m_angularVelocity += s.m_invI * this.m_impulse * this.m_J.angularA),
              (l.m_linearVelocity.x += l.m_invMass * this.m_impulse * this.m_J.linearB.x),
              (l.m_linearVelocity.y += l.m_invMass * this.m_impulse * this.m_J.linearB.y),
              (l.m_angularVelocity += l.m_invI * this.m_impulse * this.m_J.angularB))
            : (this.m_impulse = 0);
      }),
      (c.prototype.SolveVelocityConstraints = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = this.m_J.Compute(
            t.m_linearVelocity,
            t.m_angularVelocity,
            i.m_linearVelocity,
            i.m_angularVelocity
          ),
          e = -this.m_mass * o;
        (this.m_impulse += e),
          (t.m_linearVelocity.x += t.m_invMass * e * this.m_J.linearA.x),
          (t.m_linearVelocity.y += t.m_invMass * e * this.m_J.linearA.y),
          (t.m_angularVelocity += t.m_invI * e * this.m_J.angularA),
          (i.m_linearVelocity.x += i.m_invMass * e * this.m_J.linearB.x),
          (i.m_linearVelocity.y += i.m_invMass * e * this.m_J.linearB.y),
          (i.m_angularVelocity += i.m_invI * e * this.m_J.angularB);
      }),
      (c.prototype.SolvePositionConstraints = function () {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          e = 0,
          n = 0;
        (e = this.m_revolute1
          ? this.m_revolute1.GetJointAngle()
          : this.m_prismatic1.GetJointTranslation()),
          (n = this.m_revolute2
            ? this.m_revolute2.GetJointAngle()
            : this.m_prismatic2.GetJointTranslation());
        let s = -this.m_mass * (this.m_constant - (e + this.m_ratio * n));
        return (
          (i.m_sweep.c.x += i.m_invMass * s * this.m_J.linearA.x),
          (i.m_sweep.c.y += i.m_invMass * s * this.m_J.linearA.y),
          (i.m_sweep.a += i.m_invI * s * this.m_J.angularA),
          (o.m_sweep.c.x += o.m_invMass * s * this.m_J.linearB.x),
          (o.m_sweep.c.y += o.m_invMass * s * this.m_J.linearB.y),
          (o.m_sweep.a += o.m_invI * s * this.m_J.angularB),
          i.SynchronizeTransform(),
          o.SynchronizeTransform(),
          0 < t.b2_linearSlop
        );
      }),
      Box2D.inherit(_, Box2D.Dynamics.Joints.b2JointDef),
      (_.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (_.b2GearJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      }),
      (_.prototype.b2GearJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_gearJoint),
          (this.joint1 = null),
          (this.joint2 = null),
          (this.ratio = 1);
      }),
      (h.b2Jacobian = function () {
        (this.linearA = new n()), (this.linearB = new n());
      }),
      (h.prototype.SetZero = function () {
        this.linearA.SetZero(), (this.angularA = 0), this.linearB.SetZero(), (this.angularB = 0);
      }),
      (h.prototype.Set = function (t, i, o, e) {
        void 0 === i && (i = e = 0),
          this.linearA.SetV(t),
          (this.angularA = i),
          this.linearB.SetV(o),
          (this.angularB = e);
      }),
      (h.prototype.Compute = function (t, i, o, e) {
        return (
          void 0 === i && (i = 0),
          void 0 === e && (e = 0),
          this.linearA.x * t.x +
            this.linearA.y * t.y +
            this.angularA * i +
            (this.linearB.x * o.x + this.linearB.y * o.y) +
            this.angularB * e
        );
      }),
      (p.b2Joint = function () {
        (this.m_edgeA = new u()),
          (this.m_edgeB = new u()),
          (this.m_localCenterA = new n()),
          (this.m_localCenterB = new n());
      }),
      (p.prototype.GetType = function () {
        return this.m_type;
      }),
      (p.prototype.GetAnchorA = function () {
        return null;
      }),
      (p.prototype.GetAnchorB = function () {
        return null;
      }),
      (p.prototype.GetReactionForce = function (t) {
        return null;
      }),
      (p.prototype.GetReactionTorque = function (t) {
        return void 0 === t && (t = 0), 0;
      }),
      (p.prototype.GetBodyA = function () {
        return this.m_bodyA;
      }),
      (p.prototype.GetBodyB = function () {
        return this.m_bodyB;
      }),
      (p.prototype.GetNext = function () {
        return this.m_next;
      }),
      (p.prototype.GetUserData = function () {
        return this.m_userData;
      }),
      (p.prototype.SetUserData = function (t) {
        this.m_userData = t;
      }),
      (p.prototype.IsActive = function () {
        return this.m_bodyA.IsActive() && this.m_bodyB.IsActive();
      }),
      (p.Create = function (t) {
        let i = null;
        switch (t.type) {
          case p.e_distanceJoint:
            i = new l(t instanceof m ? t : null);
            break;
          case p.e_mouseJoint:
            i = new b(t instanceof d ? t : null);
            break;
          case p.e_prismaticJoint:
            i = new B(t instanceof D ? t : null);
            break;
          case p.e_revoluteJoint:
            i = new S(t instanceof w ? t : null);
            break;
          case p.e_pulleyJoint:
            i = new C(t instanceof A ? t : null);
            break;
          case p.e_gearJoint:
            i = new c(t instanceof _ ? t : null);
            break;
          case p.e_lineJoint:
            i = new x(t instanceof f ? t : null);
            break;
          case p.e_weldJoint:
            i = new v(t instanceof g ? t : null);
            break;
          case p.e_frictionJoint:
            i = new r(t instanceof a ? t : null);
        }
        return i;
      }),
      (p.Destroy = function () {}),
      (p.prototype.b2Joint = function (t) {
        (this.m_type = t.type),
          (this.m_prev = null),
          (this.m_next = null),
          (this.m_bodyA = t.bodyA),
          (this.m_bodyB = t.bodyB),
          (this.m_collideConnected = t.collideConnected),
          (this.m_islandFlag = !1),
          (this.m_userData = t.userData);
      }),
      (p.prototype.InitVelocityConstraints = function (t) {}),
      (p.prototype.SolveVelocityConstraints = function (t) {}),
      (p.prototype.FinalizeVelocityConstraints = function () {}),
      (p.prototype.SolvePositionConstraints = function (t) {
        return !1;
      }),
      Box2D.postDefs.push(function () {
        (Box2D.Dynamics.Joints.b2Joint.e_unknownJoint = 0),
          (Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint = 1),
          (Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint = 2),
          (Box2D.Dynamics.Joints.b2Joint.e_distanceJoint = 3),
          (Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint = 4),
          (Box2D.Dynamics.Joints.b2Joint.e_mouseJoint = 5),
          (Box2D.Dynamics.Joints.b2Joint.e_gearJoint = 6),
          (Box2D.Dynamics.Joints.b2Joint.e_lineJoint = 7),
          (Box2D.Dynamics.Joints.b2Joint.e_weldJoint = 8),
          (Box2D.Dynamics.Joints.b2Joint.e_frictionJoint = 9),
          (Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit = 0),
          (Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit = 1),
          (Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit = 2),
          (Box2D.Dynamics.Joints.b2Joint.e_equalLimits = 3);
      }),
      (y.b2JointDef = function () {}),
      (y.prototype.b2JointDef = function () {
        (this.type = p.e_unknownJoint),
          (this.userData = null),
          (this.bodyA = null),
          (this.bodyB = null),
          (this.collideConnected = !1);
      }),
      Box2D.inherit(x, Box2D.Dynamics.Joints.b2Joint),
      (x.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (x.b2LineJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.m_localAnchor1 = new n()),
          (this.m_localAnchor2 = new n()),
          (this.m_localXAxis1 = new n()),
          (this.m_localYAxis1 = new n()),
          (this.m_axis = new n()),
          (this.m_perp = new n()),
          (this.m_K = new i()),
          (this.m_impulse = new n());
      }),
      (x.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      }),
      (x.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      }),
      (x.prototype.GetReactionForce = function (t) {
        return new n(
          t *
            (this.m_impulse.x * this.m_perp.x +
              (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x),
          t *
            (this.m_impulse.x * this.m_perp.y +
              (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y)
        );
      }),
      (x.prototype.GetReactionTorque = function (t) {
        return t * this.m_impulse.y;
      }),
      (x.prototype.GetJointTranslation = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = t.GetWorldPoint(this.m_localAnchor1),
          e = i.GetWorldPoint(this.m_localAnchor2),
          n = e.x - o.x,
          s = e.y - o.y,
          l = t.GetWorldVector(this.m_localXAxis1);
        return l.x * n + l.y * s;
      }),
      (x.prototype.GetJointSpeed = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = t.m_xf.R,
          e = this.m_localAnchor1.x - t.m_sweep.localCenter.x,
          n = this.m_localAnchor1.y - t.m_sweep.localCenter.y,
          s = o.col1.x * e + o.col2.x * n;
        (n = o.col1.y * e + o.col2.y * n), (e = s), (o = i.m_xf.R);
        let l = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
          m = this.m_localAnchor2.y - i.m_sweep.localCenter.y;
        (s = o.col1.x * l + o.col2.x * m), (m = o.col1.y * l + o.col2.y * m), (l = s);
        let r = t.m_sweep.c.x + e,
          a = t.m_sweep.c.y + n,
          c = i.m_sweep.c.x + l - r,
          _ = i.m_sweep.c.y + m - a,
          h = t.GetWorldVector(this.m_localXAxis1),
          p = t.m_linearVelocity,
          y = i.m_linearVelocity,
          u = t.m_angularVelocity,
          x = i.m_angularVelocity;
        return (
          c * (-u * h.y) +
          _ * (u * h.x) +
          (h.x * (y.x + -x * m - p.x - -u * n) + h.y * (y.y + x * l - p.y - u * e))
        );
      }),
      (x.prototype.IsLimitEnabled = function () {
        return this.m_enableLimit;
      }),
      (x.prototype.EnableLimit = function (t) {
        this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), (this.m_enableLimit = t);
      }),
      (x.prototype.GetLowerLimit = function () {
        return this.m_lowerTranslation;
      }),
      (x.prototype.GetUpperLimit = function () {
        return this.m_upperTranslation;
      }),
      (x.prototype.SetLimits = function (t, i) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          this.m_bodyA.SetAwake(!0),
          this.m_bodyB.SetAwake(!0),
          (this.m_lowerTranslation = t),
          (this.m_upperTranslation = i);
      }),
      (x.prototype.IsMotorEnabled = function () {
        return this.m_enableMotor;
      }),
      (x.prototype.EnableMotor = function (t) {
        this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), (this.m_enableMotor = t);
      }),
      (x.prototype.SetMotorSpeed = function (t) {
        void 0 === t && (t = 0),
          this.m_bodyA.SetAwake(!0),
          this.m_bodyB.SetAwake(!0),
          (this.m_motorSpeed = t);
      }),
      (x.prototype.GetMotorSpeed = function () {
        return this.m_motorSpeed;
      }),
      (x.prototype.SetMaxMotorForce = function (t) {
        void 0 === t && (t = 0),
          this.m_bodyA.SetAwake(!0),
          this.m_bodyB.SetAwake(!0),
          (this.m_maxMotorForce = t);
      }),
      (x.prototype.GetMaxMotorForce = function () {
        return this.m_maxMotorForce;
      }),
      (x.prototype.GetMotorForce = function () {
        return this.m_motorImpulse;
      }),
      (x.prototype.b2LineJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          this.m_localAnchor1.SetV(t.localAnchorA),
          this.m_localAnchor2.SetV(t.localAnchorB),
          this.m_localXAxis1.SetV(t.localAxisA),
          (this.m_localYAxis1.x = -this.m_localXAxis1.y),
          (this.m_localYAxis1.y = this.m_localXAxis1.x),
          this.m_impulse.SetZero(),
          (this.m_motorMass = 0),
          (this.m_motorImpulse = 0),
          (this.m_lowerTranslation = t.lowerTranslation),
          (this.m_upperTranslation = t.upperTranslation),
          (this.m_maxMotorForce = t.maxMotorForce),
          (this.m_motorSpeed = t.motorSpeed),
          (this.m_enableLimit = t.enableLimit),
          (this.m_enableMotor = t.enableMotor),
          (this.m_limitState = p.e_inactiveLimit),
          this.m_axis.SetZero(),
          this.m_perp.SetZero();
      }),
      (x.prototype.InitVelocityConstraints = function (i) {
        let o = this.m_bodyA,
          n = this.m_bodyB;
        this.m_localCenterA.SetV(o.this.m_sweep.localCenter),
          this.m_localCenterB.SetV(n.this.m_sweep.localCenter);
        let s = o.GetTransform(),
          l = o.m_xf.R,
          m = this.m_localAnchor1.x - this.m_localCenterA.x,
          r = this.m_localAnchor1.y - this.m_localCenterA.y,
          a = l.col1.x * m + l.col2.x * r;
        (r = l.col1.y * m + l.col2.y * r), (m = a), (l = n.m_xf.R);
        let c = this.m_localAnchor2.x - this.m_localCenterB.x,
          _ = this.m_localAnchor2.y - this.m_localCenterB.y;
        (a = l.col1.x * c + l.col2.x * _), (_ = l.col1.y * c + l.col2.y * _), (c = a);
        let h = n.m_sweep.c.x + c - o.m_sweep.c.x - m,
          y = n.m_sweep.c.y + _ - o.m_sweep.c.y - r;
        (this.m_invMassA = o.m_invMass),
          (this.m_invMassB = n.m_invMass),
          (this.m_invIA = o.m_invI),
          (this.m_invIB = n.m_invI);
        {
          let t = e.MulMV(s.R, this.m_localXAxis1);
          this.m_axis.SetV(t),
            (this.m_a1 = (h + m) * this.m_axis.y - (y + r) * this.m_axis.x),
            (this.m_a2 = c * this.m_axis.y - _ * this.m_axis.x),
            (this.m_motorMass =
              this.m_invMassA +
              this.m_invMassB +
              this.m_invIA * this.m_a1 * this.m_a1 +
              this.m_invIB * this.m_a2 * this.m_a2),
            (this.m_motorMass = this.m_motorMass > Number.MIN_VALUE ? 1 / this.m_motorMass : 0);
        }
        {
          let t = e.MulMV(s.R, this.m_localYAxis1);
          this.m_perp.SetV(t),
            (this.m_s1 = (h + m) * this.m_perp.y - (y + r) * this.m_perp.x),
            (this.m_s2 = c * this.m_perp.y - _ * this.m_perp.x);
          let i = this.m_invMassA,
            o = this.m_invMassB,
            n = this.m_invIA,
            l = this.m_invIB;
          (this.m_K.col1.x = i + o + n * this.m_s1 * this.m_s1 + l * this.m_s2 * this.m_s2),
            (this.m_K.col1.y = n * this.m_s1 * this.m_a1 + l * this.m_s2 * this.m_a2),
            (this.m_K.col2.x = this.m_K.col1.y),
            (this.m_K.col2.y = i + o + n * this.m_a1 * this.m_a1 + l * this.m_a2 * this.m_a2);
        }
        if (this.m_enableLimit) {
          let i = this.m_axis.x * h + this.m_axis.y * y;
          e.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2 * t.b2_linearSlop
            ? (this.m_limitState = p.e_equalLimits)
            : i <= this.m_lowerTranslation
            ? this.m_limitState !== p.e_atLowerLimit &&
              ((this.m_limitState = p.e_atLowerLimit), (this.m_impulse.y = 0))
            : i >= this.m_upperTranslation
            ? this.m_limitState !== p.e_atUpperLimit &&
              ((this.m_limitState = p.e_atUpperLimit), (this.m_impulse.y = 0))
            : ((this.m_limitState = p.e_inactiveLimit), (this.m_impulse.y = 0));
        } else this.m_limitState = p.e_inactiveLimit;
        if ((!1 === this.m_enableMotor && (this.m_motorImpulse = 0), i.warmStarting)) {
          (this.m_impulse.x *= i.dtRatio),
            (this.m_impulse.y *= i.dtRatio),
            (this.m_motorImpulse *= i.dtRatio);
          let t =
              this.m_impulse.x * this.m_perp.x +
              (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x,
            e =
              this.m_impulse.x * this.m_perp.y +
              (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y,
            s = this.m_impulse.x * this.m_s1 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a1,
            l = this.m_impulse.x * this.m_s2 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a2;
          (o.m_linearVelocity.x -= this.m_invMassA * t),
            (o.m_linearVelocity.y -= this.m_invMassA * e),
            (o.m_angularVelocity -= this.m_invIA * s),
            (n.m_linearVelocity.x += this.m_invMassB * t),
            (n.m_linearVelocity.y += this.m_invMassB * e),
            (n.m_angularVelocity += this.m_invIB * l);
        } else this.m_impulse.SetZero(), (this.m_motorImpulse = 0);
      }),
      (x.prototype.SolveVelocityConstraints = function (t) {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          s = i.m_linearVelocity,
          l = i.m_angularVelocity,
          m = o.m_linearVelocity,
          r = o.m_angularVelocity,
          a = 0,
          c = 0,
          _ = 0,
          h = 0;
        if (this.m_enableMotor && this.m_limitState !== p.e_equalLimits) {
          let i =
              this.m_axis.x * (m.x - s.x) +
              this.m_axis.y * (m.y - s.y) +
              this.m_a2 * r -
              this.m_a1 * l,
            o = this.m_motorMass * (this.m_motorSpeed - i),
            n = this.m_motorImpulse,
            p = t.dt * this.m_maxMotorForce;
          (this.m_motorImpulse = e.Clamp(this.m_motorImpulse + o, -p, p)),
            (a = (o = this.m_motorImpulse - n) * this.m_axis.x),
            (c = o * this.m_axis.y),
            (_ = o * this.m_a1),
            (h = o * this.m_a2),
            (s.x -= this.m_invMassA * a),
            (s.y -= this.m_invMassA * c),
            (l -= this.m_invIA * _),
            (m.x += this.m_invMassB * a),
            (m.y += this.m_invMassB * c),
            (r += this.m_invIB * h);
        }
        let y =
          this.m_perp.x * (m.x - s.x) + this.m_perp.y * (m.y - s.y) + this.m_s2 * r - this.m_s1 * l;
        if (this.m_enableLimit && this.m_limitState !== p.e_inactiveLimit) {
          let t =
              this.m_axis.x * (m.x - s.x) +
              this.m_axis.y * (m.y - s.y) +
              this.m_a2 * r -
              this.m_a1 * l,
            i = this.m_impulse.Copy(),
            o = new n(),
            u = this.m_K.Solve(o, -y, -t);
          this.m_impulse.Add(u),
            this.m_limitState === p.e_atLowerLimit
              ? (this.m_impulse.y = e.Max(this.m_impulse.y, 0))
              : this.m_limitState === p.e_atUpperLimit &&
                (this.m_impulse.y = e.Min(this.m_impulse.y, 0));
          let x = -y - (this.m_impulse.y - i.y) * this.m_K.col2.x,
            f = 0;
          (f = 0 !== this.m_K.col1.x ? x / this.m_K.col1.x + i.x : i.x),
            (this.m_impulse.x = f),
            (u.x = this.m_impulse.x - i.x),
            (u.y = this.m_impulse.y - i.y),
            (a = u.x * this.m_perp.x + u.y * this.m_axis.x),
            (c = u.x * this.m_perp.y + u.y * this.m_axis.y),
            (_ = u.x * this.m_s1 + u.y * this.m_a1),
            (h = u.x * this.m_s2 + u.y * this.m_a2),
            (s.x -= this.m_invMassA * a),
            (s.y -= this.m_invMassA * c),
            (l -= this.m_invIA * _),
            (m.x += this.m_invMassB * a),
            (m.y += this.m_invMassB * c),
            (r += this.m_invIB * h);
        } else {
          let t = 0;
          (t = 0 !== this.m_K.col1.x ? -y / this.m_K.col1.x : 0),
            (this.m_impulse.x += t),
            (a = t * this.m_perp.x),
            (c = t * this.m_perp.y),
            (_ = t * this.m_s1),
            (h = t * this.m_s2),
            (s.x -= this.m_invMassA * a),
            (s.y -= this.m_invMassA * c),
            (l -= this.m_invIA * _),
            (m.x += this.m_invMassB * a),
            (m.y += this.m_invMassB * c),
            (r += this.m_invIB * h);
        }
        i.m_linearVelocity.SetV(s),
          (i.m_angularVelocity = l),
          o.m_linearVelocity.SetV(m),
          (o.m_angularVelocity = r);
      }),
      (x.prototype.SolvePositionConstraints = function () {
        let o = this.m_bodyA,
          s = this.m_bodyB,
          l = o.m_sweep.c,
          m = o.m_sweep.a,
          r = s.m_sweep.c,
          a = s.m_sweep.a,
          c = 0,
          _ = 0,
          h = 0,
          p = 0,
          y = 0,
          u = 0,
          x = !1,
          f = 0,
          b = i.FromAngle(m),
          d = i.FromAngle(a),
          B = b,
          D = this.m_localAnchor1.x - this.m_localCenterA.x,
          C = this.m_localAnchor1.y - this.m_localCenterA.y,
          A = B.col1.x * D + B.col2.x * C;
        (C = B.col1.y * D + B.col2.y * C), (D = A), (B = d);
        let S = this.m_localAnchor2.x - this.m_localCenterB.x,
          w = this.m_localAnchor2.y - this.m_localCenterB.y;
        (A = B.col1.x * S + B.col2.x * w), (w = B.col1.y * S + B.col2.y * w), (S = A);
        let v = r.x + S - l.x - D,
          g = r.y + w - l.y - C;
        if (this.m_enableLimit) {
          (this.m_axis = e.MulMV(b, this.m_localXAxis1)),
            (this.m_a1 = (v + D) * this.m_axis.y - (g + C) * this.m_axis.x),
            (this.m_a2 = S * this.m_axis.y - w * this.m_axis.x);
          let i = this.m_axis.x * v + this.m_axis.y * g;
          e.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2 * t.b2_linearSlop
            ? ((f = e.Clamp(i, -t.b2_maxLinearCorrection, t.b2_maxLinearCorrection)),
              (y = e.Abs(i)),
              (x = !0))
            : i <= this.m_lowerTranslation
            ? ((f = e.Clamp(
                i - this.m_lowerTranslation + t.b2_linearSlop,
                -t.b2_maxLinearCorrection,
                0
              )),
              (y = this.m_lowerTranslation - i),
              (x = !0))
            : i >= this.m_upperTranslation &&
              ((f = e.Clamp(
                i - this.m_upperTranslation + t.b2_linearSlop,
                0,
                t.b2_maxLinearCorrection
              )),
              (y = i - this.m_upperTranslation),
              (x = !0));
        }
        (this.m_perp = e.MulMV(b, this.m_localYAxis1)),
          (this.m_s1 = (v + D) * this.m_perp.y - (g + C) * this.m_perp.x),
          (this.m_s2 = S * this.m_perp.y - w * this.m_perp.x);
        let M = new n(),
          V = this.m_perp.x * v + this.m_perp.y * g;
        if (((y = e.Max(y, e.Abs(V))), (u = 0), x))
          (c = this.m_invMassA),
            (_ = this.m_invMassB),
            (h = this.m_invIA),
            (p = this.m_invIB),
            (this.m_K.col1.x = c + _ + h * this.m_s1 * this.m_s1 + p * this.m_s2 * this.m_s2),
            (this.m_K.col1.y = h * this.m_s1 * this.m_a1 + p * this.m_s2 * this.m_a2),
            (this.m_K.col2.x = this.m_K.col1.y),
            (this.m_K.col2.y = c + _ + h * this.m_a1 * this.m_a1 + p * this.m_a2 * this.m_a2),
            this.m_K.Solve(M, -V, -f);
        else {
          (c = this.m_invMassA), (_ = this.m_invMassB), (h = this.m_invIA), (p = this.m_invIB);
          let t = c + _ + h * this.m_s1 * this.m_s1 + p * this.m_s2 * this.m_s2,
            i = 0;
          (i = 0 !== t ? -V / t : 0), (M.x = i), (M.y = 0);
        }
        let I = M.x * this.m_perp.x + M.y * this.m_axis.x,
          L = M.x * this.m_perp.y + M.y * this.m_axis.y,
          J = M.x * this.m_s1 + M.y * this.m_a1,
          G = M.x * this.m_s2 + M.y * this.m_a2;
        return (
          (l.x -= this.m_invMassA * I),
          (l.y -= this.m_invMassA * L),
          (m -= this.m_invIA * J),
          (r.x += this.m_invMassB * I),
          (r.y += this.m_invMassB * L),
          (a += this.m_invIB * G),
          (o.m_sweep.a = m),
          (s.m_sweep.a = a),
          o.SynchronizeTransform(),
          s.SynchronizeTransform(),
          y <= t.b2_linearSlop && 0 <= t.b2_angularSlop
        );
      }),
      Box2D.inherit(f, Box2D.Dynamics.Joints.b2JointDef),
      (f.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (f.b2LineJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments),
          (this.localAnchorA = new n()),
          (this.localAnchorB = new n()),
          (this.localAxisA = new n());
      }),
      (f.prototype.b2LineJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_lineJoint),
          this.localAxisA.Set(1, 0),
          (this.enableLimit = !1),
          (this.lowerTranslation = 0),
          (this.upperTranslation = 0),
          (this.enableMotor = !1),
          (this.maxMotorForce = 0),
          (this.motorSpeed = 0);
      }),
      (f.prototype.Initialize = function (t, i, o, e) {
        (this.bodyA = t),
          (this.bodyB = i),
          (this.localAnchorA = this.bodyA.GetLocalPoint(o)),
          (this.localAnchorB = this.bodyB.GetLocalPoint(o)),
          (this.localAxisA = this.bodyA.GetLocalVector(e));
      }),
      Box2D.inherit(b, Box2D.Dynamics.Joints.b2Joint),
      (b.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (b.b2MouseJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.K = new i()),
          (this.K1 = new i()),
          (this.K2 = new i()),
          (this.m_localAnchor = new n()),
          (this.m_target = new n()),
          (this.m_impulse = new n()),
          (this.m_mass = new i()),
          (this.m_C = new n());
      }),
      (b.prototype.GetAnchorA = function () {
        return this.m_target;
      }),
      (b.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor);
      }),
      (b.prototype.GetReactionForce = function (t) {
        return new n(t * this.m_impulse.x, t * this.m_impulse.y);
      }),
      (b.prototype.GetReactionTorque = function (t) {
        return 0;
      }),
      (b.prototype.GetTarget = function () {
        return this.m_target;
      }),
      (b.prototype.SetTarget = function (t) {
        this.m_bodyB.m_isAwake || this.m_bodyB.SetAwake(!0), (this.m_target = t);
      }),
      (b.prototype.GetMaxForce = function () {
        return this.m_maxForce;
      }),
      (b.prototype.SetMaxForce = function (t) {
        void 0 === t && (t = 0), (this.m_maxForce = t);
      }),
      (b.prototype.GetFrequency = function () {
        return this.m_frequencyHz;
      }),
      (b.prototype.SetFrequency = function (t) {
        void 0 === t && (t = 0), (this.m_frequencyHz = t);
      }),
      (b.prototype.GetDampingRatio = function () {
        return this.m_dampingRatio;
      }),
      (b.prototype.SetDampingRatio = function (t) {
        void 0 === t && (t = 0), (this.m_dampingRatio = t);
      }),
      (b.prototype.b2MouseJoint = function (t) {
        this.__super.b2Joint.call(this, t), this.m_target.SetV(t.target);
        let i = this.m_target.x - this.m_bodyB.m_xf.position.x,
          o = this.m_target.y - this.m_bodyB.m_xf.position.y,
          e = this.m_bodyB.m_xf.R;
        (this.m_localAnchor.x = i * e.col1.x + o * e.col1.y),
          (this.m_localAnchor.y = i * e.col2.x + o * e.col2.y),
          (this.m_maxForce = t.maxForce),
          this.m_impulse.SetZero(),
          (this.m_frequencyHz = t.frequencyHz),
          (this.m_dampingRatio = t.dampingRatio),
          (this.m_beta = 0),
          (this.m_gamma = 0);
      }),
      (b.prototype.InitVelocityConstraints = function (t) {
        let i,
          o = this.m_bodyB,
          e = o.m_mass,
          n = 2 * Math.PI * this.m_frequencyHz,
          s = 2 * e * this.m_dampingRatio * n,
          l = e * n * n;
        (this.m_gamma = t.dt * (s + t.dt * l)),
          (this.m_gamma = 0 !== this.m_gamma ? 1 / this.m_gamma : 0),
          (this.m_beta = t.dt * l * this.m_gamma),
          (i = o.m_xf.R);
        let m = this.m_localAnchor.x - o.m_sweep.localCenter.x,
          r = this.m_localAnchor.y - o.m_sweep.localCenter.y,
          a = i.col1.x * m + i.col2.x * r;
        (r = i.col1.y * m + i.col2.y * r), (m = a);
        let c = o.m_invMass,
          _ = o.m_invI;
        (this.K1.col1.x = c),
          (this.K1.col2.x = 0),
          (this.K1.col1.y = 0),
          (this.K1.col2.y = c),
          (this.K2.col1.x = _ * r * r),
          (this.K2.col2.x = -_ * m * r),
          (this.K2.col1.y = -_ * m * r),
          (this.K2.col2.y = _ * m * m),
          this.K.SetM(this.K1),
          this.K.AddM(this.K2),
          (this.K.col1.x += this.m_gamma),
          (this.K.col2.y += this.m_gamma),
          this.K.GetInverse(this.m_mass),
          (this.m_C.x = o.m_sweep.c.x + m - this.m_target.x),
          (this.m_C.y = o.m_sweep.c.y + r - this.m_target.y),
          (o.m_angularVelocity *= 0.98),
          (this.m_impulse.x *= t.dtRatio),
          (this.m_impulse.y *= t.dtRatio),
          (o.m_linearVelocity.x += c * this.m_impulse.x),
          (o.m_linearVelocity.y += c * this.m_impulse.y),
          (o.m_angularVelocity += _ * (m * this.m_impulse.y - r * this.m_impulse.x));
      }),
      (b.prototype.SolveVelocityConstraints = function (t) {
        let i = this.m_bodyB,
          o = i.m_xf.R,
          e = this.m_localAnchor.x - i.m_sweep.localCenter.x,
          n = this.m_localAnchor.y - i.m_sweep.localCenter.y,
          s = o.col1.x * e + o.col2.x * n;
        (n = o.col1.y * e + o.col2.y * n), (e = s);
        let l = i.m_linearVelocity.x + -i.m_angularVelocity * n,
          m = i.m_linearVelocity.y + i.m_angularVelocity * e;
        (o = this.m_mass), (s = l + this.m_beta * this.m_C.x + this.m_gamma * this.m_impulse.x);
        let r = m + this.m_beta * this.m_C.y + this.m_gamma * this.m_impulse.y,
          a = -(o.col1.x * s + o.col2.x * r),
          c = -(o.col1.y * s + o.col2.y * r),
          _ = this.m_impulse.x,
          h = this.m_impulse.y;
        (this.m_impulse.x += a), (this.m_impulse.y += c);
        let p = t.dt * this.m_maxForce;
        this.m_impulse.LengthSquared() > p * p &&
          this.m_impulse.Multiply(p / this.m_impulse.Length()),
          (a = this.m_impulse.x - _),
          (c = this.m_impulse.y - h),
          (i.m_linearVelocity.x += i.m_invMass * a),
          (i.m_linearVelocity.y += i.m_invMass * c),
          (i.m_angularVelocity += i.m_invI * (e * c - n * a));
      }),
      (b.prototype.SolvePositionConstraints = function (t) {
        return !0;
      }),
      Box2D.inherit(d, Box2D.Dynamics.Joints.b2JointDef),
      (d.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (d.b2MouseJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments), (this.target = new n());
      }),
      (d.prototype.b2MouseJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_mouseJoint),
          (this.maxForce = 0),
          (this.frequencyHz = 5),
          (this.dampingRatio = 0.7);
      }),
      Box2D.inherit(B, Box2D.Dynamics.Joints.b2Joint),
      (B.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (B.b2PrismaticJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.m_localAnchor1 = new n()),
          (this.m_localAnchor2 = new n()),
          (this.m_localXAxis1 = new n()),
          (this.m_localYAxis1 = new n()),
          (this.m_axis = new n()),
          (this.m_perp = new n()),
          (this.m_K = new o()),
          (this.m_impulse = new s(0, 0, 0));
      }),
      (B.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      }),
      (B.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      }),
      (B.prototype.GetReactionForce = function (t) {
        return new n(
          t *
            (this.m_impulse.x * this.m_perp.x +
              (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x),
          t *
            (this.m_impulse.x * this.m_perp.y +
              (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y)
        );
      }),
      (B.prototype.GetReactionTorque = function (t) {
        return t * this.m_impulse.y;
      }),
      (B.prototype.GetJointTranslation = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = t.GetWorldPoint(this.m_localAnchor1),
          e = i.GetWorldPoint(this.m_localAnchor2),
          n = e.x - o.x,
          s = e.y - o.y,
          l = t.GetWorldVector(this.m_localXAxis1);
        return l.x * n + l.y * s;
      }),
      (B.prototype.GetJointSpeed = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = t.m_xf.R,
          e = this.m_localAnchor1.x - t.m_sweep.localCenter.x,
          n = this.m_localAnchor1.y - t.m_sweep.localCenter.y,
          s = o.col1.x * e + o.col2.x * n;
        (n = o.col1.y * e + o.col2.y * n), (e = s), (o = i.m_xf.R);
        let l = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
          m = this.m_localAnchor2.y - i.m_sweep.localCenter.y;
        (s = o.col1.x * l + o.col2.x * m), (m = o.col1.y * l + o.col2.y * m), (l = s);
        let r = t.m_sweep.c.x + e,
          a = t.m_sweep.c.y + n,
          c = i.m_sweep.c.x + l - r,
          _ = i.m_sweep.c.y + m - a,
          h = t.GetWorldVector(this.m_localXAxis1),
          p = t.m_linearVelocity,
          y = i.m_linearVelocity,
          u = t.m_angularVelocity,
          x = i.m_angularVelocity;
        return (
          c * (-u * h.y) +
          _ * (u * h.x) +
          (h.x * (y.x + -x * m - p.x - -u * n) + h.y * (y.y + x * l - p.y - u * e))
        );
      }),
      (B.prototype.IsLimitEnabled = function () {
        return this.m_enableLimit;
      }),
      (B.prototype.EnableLimit = function (t) {
        this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), (this.m_enableLimit = t);
      }),
      (B.prototype.GetLowerLimit = function () {
        return this.m_lowerTranslation;
      }),
      (B.prototype.GetUpperLimit = function () {
        return this.m_upperTranslation;
      }),
      (B.prototype.SetLimits = function (t, i) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          this.m_bodyA.SetAwake(!0),
          this.m_bodyB.SetAwake(!0),
          (this.m_lowerTranslation = t),
          (this.m_upperTranslation = i);
      }),
      (B.prototype.IsMotorEnabled = function () {
        return this.m_enableMotor;
      }),
      (B.prototype.EnableMotor = function (t) {
        this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), (this.m_enableMotor = t);
      }),
      (B.prototype.SetMotorSpeed = function (t) {
        void 0 === t && (t = 0),
          this.m_bodyA.SetAwake(!0),
          this.m_bodyB.SetAwake(!0),
          (this.m_motorSpeed = t);
      }),
      (B.prototype.GetMotorSpeed = function () {
        return this.m_motorSpeed;
      }),
      (B.prototype.SetMaxMotorForce = function (t) {
        void 0 === t && (t = 0),
          this.m_bodyA.SetAwake(!0),
          this.m_bodyB.SetAwake(!0),
          (this.m_maxMotorForce = t);
      }),
      (B.prototype.GetMotorForce = function () {
        return this.m_motorImpulse;
      }),
      (B.prototype.b2PrismaticJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          this.m_localAnchor1.SetV(t.localAnchorA),
          this.m_localAnchor2.SetV(t.localAnchorB),
          this.m_localXAxis1.SetV(t.localAxisA),
          (this.m_localYAxis1.x = -this.m_localXAxis1.y),
          (this.m_localYAxis1.y = this.m_localXAxis1.x),
          (this.m_refAngle = t.referenceAngle),
          this.m_impulse.SetZero(),
          (this.m_motorMass = 0),
          (this.m_motorImpulse = 0),
          (this.m_lowerTranslation = t.lowerTranslation),
          (this.m_upperTranslation = t.upperTranslation),
          (this.m_maxMotorForce = t.maxMotorForce),
          (this.m_motorSpeed = t.motorSpeed),
          (this.m_enableLimit = t.enableLimit),
          (this.m_enableMotor = t.enableMotor),
          (this.m_limitState = p.e_inactiveLimit),
          this.m_axis.SetZero(),
          this.m_perp.SetZero();
      }),
      (B.prototype.InitVelocityConstraints = function (i) {
        let o = this.m_bodyA,
          n = this.m_bodyB;
        this.m_localCenterA.SetV(o.this.m_sweep.localCenter),
          this.m_localCenterB.SetV(n.this.m_sweep.localCenter);
        let s = o.GetTransform(),
          l = o.m_xf.R,
          m = this.m_localAnchor1.x - this.m_localCenterA.x,
          r = this.m_localAnchor1.y - this.m_localCenterA.y,
          a = l.col1.x * m + l.col2.x * r;
        (r = l.col1.y * m + l.col2.y * r), (m = a), (l = n.m_xf.R);
        let c = this.m_localAnchor2.x - this.m_localCenterB.x,
          _ = this.m_localAnchor2.y - this.m_localCenterB.y;
        (a = l.col1.x * c + l.col2.x * _), (_ = l.col1.y * c + l.col2.y * _), (c = a);
        let h = n.m_sweep.c.x + c - o.m_sweep.c.x - m,
          y = n.m_sweep.c.y + _ - o.m_sweep.c.y - r;
        (this.m_invMassA = o.m_invMass),
          (this.m_invMassB = n.m_invMass),
          (this.m_invIA = o.m_invI),
          (this.m_invIB = n.m_invI);
        {
          let t = e.MulMV(s.R, this.m_localXAxis1);
          this.m_axis.SetV(t),
            (this.m_a1 = (h + m) * this.m_axis.y - (y + r) * this.m_axis.x),
            (this.m_a2 = c * this.m_axis.y - _ * this.m_axis.x),
            (this.m_motorMass =
              this.m_invMassA +
              this.m_invMassB +
              this.m_invIA * this.m_a1 * this.m_a1 +
              this.m_invIB * this.m_a2 * this.m_a2),
            this.m_motorMass > Number.MIN_VALUE && (this.m_motorMass = 1 / this.m_motorMass);
        }
        {
          let t = e.MulMV(s.R, this.m_localYAxis1);
          this.m_perp.SetV(t),
            (this.m_s1 = (h + m) * this.m_perp.y - (y + r) * this.m_perp.x),
            (this.m_s2 = c * this.m_perp.y - _ * this.m_perp.x);
          let i = this.m_invMassA,
            o = this.m_invMassB,
            n = this.m_invIA,
            l = this.m_invIB;
          (this.m_K.col1.x = i + o + n * this.m_s1 * this.m_s1 + l * this.m_s2 * this.m_s2),
            (this.m_K.col1.y = n * this.m_s1 + l * this.m_s2),
            (this.m_K.col1.z = n * this.m_s1 * this.m_a1 + l * this.m_s2 * this.m_a2),
            (this.m_K.col2.x = this.m_K.col1.y),
            (this.m_K.col2.y = n + l),
            (this.m_K.col2.z = n * this.m_a1 + l * this.m_a2),
            (this.m_K.col3.x = this.m_K.col1.z),
            (this.m_K.col3.y = this.m_K.col2.z),
            (this.m_K.col3.z = i + o + n * this.m_a1 * this.m_a1 + l * this.m_a2 * this.m_a2);
        }
        if (this.m_enableLimit) {
          let i = this.m_axis.x * h + this.m_axis.y * y;
          e.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2 * t.b2_linearSlop
            ? (this.m_limitState = p.e_equalLimits)
            : i <= this.m_lowerTranslation
            ? this.m_limitState !== p.e_atLowerLimit &&
              ((this.m_limitState = p.e_atLowerLimit), (this.m_impulse.z = 0))
            : i >= this.m_upperTranslation
            ? this.m_limitState !== p.e_atUpperLimit &&
              ((this.m_limitState = p.e_atUpperLimit), (this.m_impulse.z = 0))
            : ((this.m_limitState = p.e_inactiveLimit), (this.m_impulse.z = 0));
        } else this.m_limitState = p.e_inactiveLimit;
        if ((this.m_enableMotor || (this.m_motorImpulse = 0), i.warmStarting)) {
          (this.m_impulse.x *= i.dtRatio),
            (this.m_impulse.y *= i.dtRatio),
            (this.m_motorImpulse *= i.dtRatio);
          let t =
              this.m_impulse.x * this.m_perp.x +
              (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x,
            e =
              this.m_impulse.x * this.m_perp.y +
              (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y,
            s =
              this.m_impulse.x * this.m_s1 +
              this.m_impulse.y +
              (this.m_motorImpulse + this.m_impulse.z) * this.m_a1,
            l =
              this.m_impulse.x * this.m_s2 +
              this.m_impulse.y +
              (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
          (o.m_linearVelocity.x -= this.m_invMassA * t),
            (o.m_linearVelocity.y -= this.m_invMassA * e),
            (o.m_angularVelocity -= this.m_invIA * s),
            (n.m_linearVelocity.x += this.m_invMassB * t),
            (n.m_linearVelocity.y += this.m_invMassB * e),
            (n.m_angularVelocity += this.m_invIB * l);
        } else this.m_impulse.SetZero(), (this.m_motorImpulse = 0);
      }),
      (B.prototype.SolveVelocityConstraints = function (t) {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          l = i.m_linearVelocity,
          m = i.m_angularVelocity,
          r = o.m_linearVelocity,
          a = o.m_angularVelocity,
          c = 0,
          _ = 0,
          h = 0,
          y = 0;
        if (this.m_enableMotor && this.m_limitState !== p.e_equalLimits) {
          let i =
              this.m_axis.x * (r.x - l.x) +
              this.m_axis.y * (r.y - l.y) +
              this.m_a2 * a -
              this.m_a1 * m,
            o = this.m_motorMass * (this.m_motorSpeed - i),
            n = this.m_motorImpulse,
            s = t.dt * this.m_maxMotorForce;
          (this.m_motorImpulse = e.Clamp(this.m_motorImpulse + o, -s, s)),
            (c = (o = this.m_motorImpulse - n) * this.m_axis.x),
            (_ = o * this.m_axis.y),
            (h = o * this.m_a1),
            (y = o * this.m_a2),
            (l.x -= this.m_invMassA * c),
            (l.y -= this.m_invMassA * _),
            (m -= this.m_invIA * h),
            (r.x += this.m_invMassB * c),
            (r.y += this.m_invMassB * _),
            (a += this.m_invIB * y);
        }
        let u =
            this.m_perp.x * (r.x - l.x) +
            this.m_perp.y * (r.y - l.y) +
            this.m_s2 * a -
            this.m_s1 * m,
          x = a - m;
        if (this.m_enableLimit && this.m_limitState !== p.e_inactiveLimit) {
          let t =
              this.m_axis.x * (r.x - l.x) +
              this.m_axis.y * (r.y - l.y) +
              this.m_a2 * a -
              this.m_a1 * m,
            i = this.m_impulse.Copy(),
            o = this.m_K.Solve33(new s(0, 0, 0), -u, -x, -t);
          this.m_impulse.Add(o),
            this.m_limitState === p.e_atLowerLimit
              ? (this.m_impulse.z = e.Max(this.m_impulse.z, 0))
              : this.m_limitState === p.e_atUpperLimit &&
                (this.m_impulse.z = e.Min(this.m_impulse.z, 0));
          let f = -u - (this.m_impulse.z - i.z) * this.m_K.col3.x,
            b = -x - (this.m_impulse.z - i.z) * this.m_K.col3.y,
            d = new n(),
            B = this.m_K.Solve22(d, f, b);
          (B.x += i.x),
            (B.y += i.y),
            (this.m_impulse.x = B.x),
            (this.m_impulse.y = B.y),
            (o.x = this.m_impulse.x - i.x),
            (o.y = this.m_impulse.y - i.y),
            (o.z = this.m_impulse.z - i.z),
            (c = o.x * this.m_perp.x + o.z * this.m_axis.x),
            (_ = o.x * this.m_perp.y + o.z * this.m_axis.y),
            (h = o.x * this.m_s1 + o.y + o.z * this.m_a1),
            (y = o.x * this.m_s2 + o.y + o.z * this.m_a2),
            (l.x -= this.m_invMassA * c),
            (l.y -= this.m_invMassA * _),
            (m -= this.m_invIA * h),
            (r.x += this.m_invMassB * c),
            (r.y += this.m_invMassB * _),
            (a += this.m_invIB * y);
        } else {
          let t = new n(),
            i = this.m_K.Solve22(t, -u, -x);
          (this.m_impulse.x += i.x),
            (this.m_impulse.y += i.y),
            (c = i.x * this.m_perp.x),
            (_ = i.x * this.m_perp.y),
            (h = i.x * this.m_s1 + i.y),
            (y = i.x * this.m_s2 + i.y),
            (l.x -= this.m_invMassA * c),
            (l.y -= this.m_invMassA * _),
            (m -= this.m_invIA * h),
            (r.x += this.m_invMassB * c),
            (r.y += this.m_invMassB * _),
            (a += this.m_invIB * y);
        }
        i.m_linearVelocity.SetV(l),
          (i.m_angularVelocity = m),
          o.m_linearVelocity.SetV(r),
          (o.m_angularVelocity = a);
      }),
      (B.prototype.SolvePositionConstraints = function () {
        let o = this.m_bodyA,
          l = this.m_bodyB,
          m = o.m_sweep.c,
          r = o.m_sweep.a,
          a = l.m_sweep.c,
          c = l.m_sweep.a,
          _ = 0,
          h = 0,
          p = 0,
          y = 0,
          u = 0,
          x = 0,
          f = !1,
          b = 0,
          d = i.FromAngle(r),
          B = i.FromAngle(c),
          D = d,
          C = this.m_localAnchor1.x - this.m_localCenterA.x,
          A = this.m_localAnchor1.y - this.m_localCenterA.y,
          S = D.col1.x * C + D.col2.x * A;
        (A = D.col1.y * C + D.col2.y * A), (C = S), (D = B);
        let w = this.m_localAnchor2.x - this.m_localCenterB.x,
          v = this.m_localAnchor2.y - this.m_localCenterB.y;
        (S = D.col1.x * w + D.col2.x * v), (v = D.col1.y * w + D.col2.y * v), (w = S);
        let g = a.x + w - m.x - C,
          M = a.y + v - m.y - A;
        if (this.m_enableLimit) {
          (this.m_axis = e.MulMV(d, this.m_localXAxis1)),
            (this.m_a1 = (g + C) * this.m_axis.y - (M + A) * this.m_axis.x),
            (this.m_a2 = w * this.m_axis.y - v * this.m_axis.x);
          let i = this.m_axis.x * g + this.m_axis.y * M;
          e.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2 * t.b2_linearSlop
            ? ((b = e.Clamp(i, -t.b2_maxLinearCorrection, t.b2_maxLinearCorrection)),
              (u = e.Abs(i)),
              (f = !0))
            : i <= this.m_lowerTranslation
            ? ((b = e.Clamp(
                i - this.m_lowerTranslation + t.b2_linearSlop,
                -t.b2_maxLinearCorrection,
                0
              )),
              (u = this.m_lowerTranslation - i),
              (f = !0))
            : i >= this.m_upperTranslation &&
              ((b = e.Clamp(
                i - this.m_upperTranslation + t.b2_linearSlop,
                0,
                t.b2_maxLinearCorrection
              )),
              (u = i - this.m_upperTranslation),
              (f = !0));
        }
        (this.m_perp = e.MulMV(d, this.m_localYAxis1)),
          (this.m_s1 = (g + C) * this.m_perp.y - (M + A) * this.m_perp.x),
          (this.m_s2 = w * this.m_perp.y - v * this.m_perp.x);
        let V = new s(0, 0, 0),
          I = this.m_perp.x * g + this.m_perp.y * M,
          L = c - r - this.m_refAngle;
        if (((u = e.Max(u, e.Abs(I))), (x = e.Abs(L)), f))
          (_ = this.m_invMassA),
            (h = this.m_invMassB),
            (p = this.m_invIA),
            (y = this.m_invIB),
            (this.m_K.col1.x = _ + h + p * this.m_s1 * this.m_s1 + y * this.m_s2 * this.m_s2),
            (this.m_K.col1.y = p * this.m_s1 + y * this.m_s2),
            (this.m_K.col1.z = p * this.m_s1 * this.m_a1 + y * this.m_s2 * this.m_a2),
            (this.m_K.col2.x = this.m_K.col1.y),
            (this.m_K.col2.y = p + y),
            (this.m_K.col2.z = p * this.m_a1 + y * this.m_a2),
            (this.m_K.col3.x = this.m_K.col1.z),
            (this.m_K.col3.y = this.m_K.col2.z),
            (this.m_K.col3.z = _ + h + p * this.m_a1 * this.m_a1 + y * this.m_a2 * this.m_a2),
            this.m_K.Solve33(V, -I, -L, -b);
        else {
          (_ = this.m_invMassA), (h = this.m_invMassB), (p = this.m_invIA), (y = this.m_invIB);
          let t = _ + h + p * this.m_s1 * this.m_s1 + y * this.m_s2 * this.m_s2,
            i = p * this.m_s1 + y * this.m_s2,
            o = p + y;
          this.m_K.col1.Set(t, i, 0), this.m_K.col2.Set(i, o, 0);
          let e = new n(),
            s = this.m_K.Solve22(e, -I, -L);
          (V.x = s.x), (V.y = s.y), (V.z = 0);
        }
        let J = V.x * this.m_perp.x + V.z * this.m_axis.x,
          G = V.x * this.m_perp.y + V.z * this.m_axis.y,
          R = V.x * this.m_s1 + V.y + V.z * this.m_a1,
          P = V.x * this.m_s2 + V.y + V.z * this.m_a2;
        return (
          (m.x -= this.m_invMassA * J),
          (m.y -= this.m_invMassA * G),
          (r -= this.m_invIA * R),
          (a.x += this.m_invMassB * J),
          (a.y += this.m_invMassB * G),
          (c += this.m_invIB * P),
          (o.m_sweep.a = r),
          (l.m_sweep.a = c),
          o.SynchronizeTransform(),
          l.SynchronizeTransform(),
          u <= t.b2_linearSlop && x <= t.b2_angularSlop
        );
      }),
      Box2D.inherit(D, Box2D.Dynamics.Joints.b2JointDef),
      (D.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (D.b2PrismaticJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments),
          (this.localAnchorA = new n()),
          (this.localAnchorB = new n()),
          (this.localAxisA = new n());
      }),
      (D.prototype.b2PrismaticJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_prismaticJoint),
          this.localAxisA.Set(1, 0),
          (this.referenceAngle = 0),
          (this.enableLimit = !1),
          (this.lowerTranslation = 0),
          (this.upperTranslation = 0),
          (this.enableMotor = !1),
          (this.maxMotorForce = 0),
          (this.motorSpeed = 0);
      }),
      (D.prototype.Initialize = function (t, i, o, e) {
        (this.bodyA = t),
          (this.bodyB = i),
          (this.localAnchorA = this.bodyA.GetLocalPoint(o)),
          (this.localAnchorB = this.bodyB.GetLocalPoint(o)),
          (this.localAxisA = this.bodyA.GetLocalVector(e)),
          (this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle());
      }),
      Box2D.inherit(C, Box2D.Dynamics.Joints.b2Joint),
      (C.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (C.b2PulleyJoint = function () {
        Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments),
          (this.m_groundAnchor1 = new n()),
          (this.m_groundAnchor2 = new n()),
          (this.m_localAnchor1 = new n()),
          (this.m_localAnchor2 = new n()),
          (this.m_u1 = new n()),
          (this.m_u2 = new n());
      }),
      (C.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      }),
      (C.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      }),
      (C.prototype.GetReactionForce = function (t) {
        return new n(t * this.m_impulse * this.m_u2.x, t * this.m_impulse * this.m_u2.y);
      }),
      (C.prototype.GetReactionTorque = function (t) {
        return 0;
      }),
      (C.prototype.GetGroundAnchorA = function () {
        let t = this.m_ground.m_xf.position.Copy();
        return t.Add(this.m_groundAnchor1), t;
      }),
      (C.prototype.GetGroundAnchorB = function () {
        let t = this.m_ground.m_xf.position.Copy();
        return t.Add(this.m_groundAnchor2), t;
      }),
      (C.prototype.GetLength1 = function () {
        let t = this.m_bodyA.GetWorldPoint(this.m_localAnchor1),
          i = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x,
          o = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y,
          e = t.x - i,
          n = t.y - o;
        return Math.sqrt(e * e + n * n);
      }),
      (C.prototype.GetLength2 = function () {
        let t = this.m_bodyB.GetWorldPoint(this.m_localAnchor2),
          i = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x,
          o = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y,
          e = t.x - i,
          n = t.y - o;
        return Math.sqrt(e * e + n * n);
      }),
      (C.prototype.GetRatio = function () {
        return this.m_ratio;
      }),
      (C.prototype.b2PulleyJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          (this.m_ground = this.m_bodyA.m_world.m_groundBody),
          (this.m_groundAnchor1.x = t.groundAnchorA.x - this.m_ground.m_xf.position.x),
          (this.m_groundAnchor1.y = t.groundAnchorA.y - this.m_ground.m_xf.position.y),
          (this.m_groundAnchor2.x = t.groundAnchorB.x - this.m_ground.m_xf.position.x),
          (this.m_groundAnchor2.y = t.groundAnchorB.y - this.m_ground.m_xf.position.y),
          this.m_localAnchor1.SetV(t.localAnchorA),
          this.m_localAnchor2.SetV(t.localAnchorB),
          (this.m_ratio = t.ratio),
          (this.m_constant = t.lengthA + this.m_ratio * t.lengthB),
          (this.m_maxLength1 = e.Min(
            t.maxLengthA,
            this.m_constant - this.m_ratio * C.b2_minPulleyLength
          )),
          (this.m_maxLength2 = e.Min(
            t.maxLengthB,
            (this.m_constant - C.b2_minPulleyLength) / this.m_ratio
          )),
          (this.m_impulse = 0),
          (this.m_limitImpulse1 = 0),
          (this.m_limitImpulse2 = 0);
      }),
      (C.prototype.InitVelocityConstraints = function (i) {
        let o = this.m_bodyA,
          e = this.m_bodyB,
          n = o.m_xf.R,
          s = this.m_localAnchor1.x - o.m_sweep.localCenter.x,
          l = this.m_localAnchor1.y - o.m_sweep.localCenter.y,
          m = n.col1.x * s + n.col2.x * l;
        (l = n.col1.y * s + n.col2.y * l), (s = m), (n = e.m_xf.R);
        let r = this.m_localAnchor2.x - e.m_sweep.localCenter.x,
          a = this.m_localAnchor2.y - e.m_sweep.localCenter.y;
        (m = n.col1.x * r + n.col2.x * a), (a = n.col1.y * r + n.col2.y * a), (r = m);
        let c = o.m_sweep.c.x + s,
          _ = o.m_sweep.c.y + l,
          h = e.m_sweep.c.x + r,
          y = e.m_sweep.c.y + a,
          u = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x,
          x = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y,
          f = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x,
          b = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
        this.m_u1.Set(c - u, _ - x), this.m_u2.Set(h - f, y - b);
        let d = this.m_u1.Length(),
          B = this.m_u2.Length();
        d > t.b2_linearSlop ? this.m_u1.Multiply(1 / d) : this.m_u1.SetZero(),
          B > t.b2_linearSlop ? this.m_u2.Multiply(1 / B) : this.m_u2.SetZero(),
          this.m_constant - d - this.m_ratio * B > 0
            ? ((this.m_state = p.e_inactiveLimit), (this.m_impulse = 0))
            : (this.m_state = p.e_atUpperLimit),
          d < this.m_maxLength1
            ? ((this.m_limitState1 = p.e_inactiveLimit), (this.m_limitImpulse1 = 0))
            : (this.m_limitState1 = p.e_atUpperLimit),
          B < this.m_maxLength2
            ? ((this.m_limitState2 = p.e_inactiveLimit), (this.m_limitImpulse2 = 0))
            : (this.m_limitState2 = p.e_atUpperLimit);
        let D = s * this.m_u1.y - l * this.m_u1.x,
          C = r * this.m_u2.y - a * this.m_u2.x;
        if (
          ((this.m_limitMass1 = o.m_invMass + o.m_invI * D * D),
          (this.m_limitMass2 = e.m_invMass + e.m_invI * C * C),
          (this.m_pulleyMass = this.m_limitMass1 + this.m_ratio * this.m_ratio * this.m_limitMass2),
          (this.m_limitMass1 = 1 / this.m_limitMass1),
          (this.m_limitMass2 = 1 / this.m_limitMass2),
          (this.m_pulleyMass = 1 / this.m_pulleyMass),
          i.warmStarting)
        ) {
          (this.m_impulse *= i.dtRatio),
            (this.m_limitImpulse1 *= i.dtRatio),
            (this.m_limitImpulse2 *= i.dtRatio);
          let t = (-this.m_impulse - this.m_limitImpulse1) * this.m_u1.x,
            n = (-this.m_impulse - this.m_limitImpulse1) * this.m_u1.y,
            m = (-this.m_ratio * this.m_impulse - this.m_limitImpulse2) * this.m_u2.x,
            c = (-this.m_ratio * this.m_impulse - this.m_limitImpulse2) * this.m_u2.y;
          (o.m_linearVelocity.x += o.m_invMass * t),
            (o.m_linearVelocity.y += o.m_invMass * n),
            (o.m_angularVelocity += o.m_invI * (s * n - l * t)),
            (e.m_linearVelocity.x += e.m_invMass * m),
            (e.m_linearVelocity.y += e.m_invMass * c),
            (e.m_angularVelocity += e.m_invI * (r * c - a * m));
        } else (this.m_impulse = 0), (this.m_limitImpulse1 = 0), (this.m_limitImpulse2 = 0);
      }),
      (C.prototype.SolveVelocityConstraints = function (t) {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          n = i.m_xf.R,
          s = this.m_localAnchor1.x - i.m_sweep.localCenter.x,
          l = this.m_localAnchor1.y - i.m_sweep.localCenter.y,
          m = n.col1.x * s + n.col2.x * l;
        (l = n.col1.y * s + n.col2.y * l), (s = m), (n = o.m_xf.R);
        let r = this.m_localAnchor2.x - o.m_sweep.localCenter.x,
          a = this.m_localAnchor2.y - o.m_sweep.localCenter.y;
        (m = n.col1.x * r + n.col2.x * a), (a = n.col1.y * r + n.col2.y * a), (r = m);
        let c = 0,
          _ = 0,
          h = 0,
          y = 0,
          u = 0,
          x = 0,
          f = 0,
          b = 0,
          d = 0,
          B = 0,
          D = 0;
        this.m_state === p.e_atUpperLimit &&
          ((c = i.m_linearVelocity.x + -i.m_angularVelocity * l),
          (_ = i.m_linearVelocity.y + i.m_angularVelocity * s),
          (h = o.m_linearVelocity.x + -o.m_angularVelocity * a),
          (y = o.m_linearVelocity.y + o.m_angularVelocity * r),
          (d =
            -(this.m_u1.x * c + this.m_u1.y * _) -
            this.m_ratio * (this.m_u2.x * h + this.m_u2.y * y)),
          (B = this.m_pulleyMass * -d),
          (D = this.m_impulse),
          (this.m_impulse = e.Max(0, this.m_impulse + B)),
          (u = -(B = this.m_impulse - D) * this.m_u1.x),
          (x = -B * this.m_u1.y),
          (f = -this.m_ratio * B * this.m_u2.x),
          (b = -this.m_ratio * B * this.m_u2.y),
          (i.m_linearVelocity.x += i.m_invMass * u),
          (i.m_linearVelocity.y += i.m_invMass * x),
          (i.m_angularVelocity += i.m_invI * (s * x - l * u)),
          (o.m_linearVelocity.x += o.m_invMass * f),
          (o.m_linearVelocity.y += o.m_invMass * b),
          (o.m_angularVelocity += o.m_invI * (r * b - a * f))),
          this.m_limitState1 === p.e_atUpperLimit &&
            ((c = i.m_linearVelocity.x + -i.m_angularVelocity * l),
            (_ = i.m_linearVelocity.y + i.m_angularVelocity * s),
            (d = -(this.m_u1.x * c + this.m_u1.y * _)),
            (B = -this.m_limitMass1 * d),
            (D = this.m_limitImpulse1),
            (this.m_limitImpulse1 = e.Max(0, this.m_limitImpulse1 + B)),
            (u = -(B = this.m_limitImpulse1 - D) * this.m_u1.x),
            (x = -B * this.m_u1.y),
            (i.m_linearVelocity.x += i.m_invMass * u),
            (i.m_linearVelocity.y += i.m_invMass * x),
            (i.m_angularVelocity += i.m_invI * (s * x - l * u))),
          this.m_limitState2 === p.e_atUpperLimit &&
            ((h = o.m_linearVelocity.x + -o.m_angularVelocity * a),
            (y = o.m_linearVelocity.y + o.m_angularVelocity * r),
            (d = -(this.m_u2.x * h + this.m_u2.y * y)),
            (B = -this.m_limitMass2 * d),
            (D = this.m_limitImpulse2),
            (this.m_limitImpulse2 = e.Max(0, this.m_limitImpulse2 + B)),
            (f = -(B = this.m_limitImpulse2 - D) * this.m_u2.x),
            (b = -B * this.m_u2.y),
            (o.m_linearVelocity.x += o.m_invMass * f),
            (o.m_linearVelocity.y += o.m_invMass * b),
            (o.m_angularVelocity += o.m_invI * (r * b - a * f)));
      }),
      (C.prototype.SolvePositionConstraints = function (i) {
        let o,
          n,
          s,
          l,
          m,
          r,
          a,
          c,
          _,
          h,
          y,
          u,
          x,
          f,
          b,
          d = this.m_bodyA,
          B = this.m_bodyB,
          D = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x,
          C = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y,
          A = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x,
          S = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
        return (
          this.m_state === p.e_atUpperLimit &&
            ((o = d.m_xf.R),
            (n = this.m_localAnchor1.x - d.m_sweep.localCenter.x),
            (s = this.m_localAnchor1.y - d.m_sweep.localCenter.y),
            (f = o.col1.x * n + o.col2.x * s),
            (s = o.col1.y * n + o.col2.y * s),
            (n = f),
            (o = B.m_xf.R),
            (l = this.m_localAnchor2.x - B.m_sweep.localCenter.x),
            (m = this.m_localAnchor2.y - B.m_sweep.localCenter.y),
            (f = o.col1.x * l + o.col2.x * m),
            (m = o.col1.y * l + o.col2.y * m),
            (l = f),
            (r = d.m_sweep.c.x + n),
            (a = d.m_sweep.c.y + s),
            (c = B.m_sweep.c.x + l),
            (_ = B.m_sweep.c.y + m),
            this.m_u1.Set(r - D, a - C),
            this.m_u2.Set(c - A, _ - S),
            (h = this.m_u1.Length()),
            (y = this.m_u2.Length()),
            h > t.b2_linearSlop ? this.m_u1.Multiply(1 / h) : this.m_u1.SetZero(),
            y > t.b2_linearSlop ? this.m_u2.Multiply(1 / y) : this.m_u2.SetZero(),
            (u = this.m_constant - h - this.m_ratio * y),
            (b = e.Max(b, -u)),
            (u = e.Clamp(u + t.b2_linearSlop, -t.b2_maxLinearCorrection, 0)),
            (r = -(x = -this.m_pulleyMass * u) * this.m_u1.x),
            (a = -x * this.m_u1.y),
            (c = -this.m_ratio * x * this.m_u2.x),
            (_ = -this.m_ratio * x * this.m_u2.y),
            (d.m_sweep.c.x += d.m_invMass * r),
            (d.m_sweep.c.y += d.m_invMass * a),
            (d.m_sweep.a += d.m_invI * (n * a - s * r)),
            (B.m_sweep.c.x += B.m_invMass * c),
            (B.m_sweep.c.y += B.m_invMass * _),
            (B.m_sweep.a += B.m_invI * (l * _ - m * c)),
            d.SynchronizeTransform(),
            B.SynchronizeTransform()),
          this.m_limitState1 === p.e_atUpperLimit &&
            ((o = d.m_xf.R),
            (n = this.m_localAnchor1.x - d.m_sweep.localCenter.x),
            (s = this.m_localAnchor1.y - d.m_sweep.localCenter.y),
            (f = o.col1.x * n + o.col2.x * s),
            (s = o.col1.y * n + o.col2.y * s),
            (n = f),
            (r = d.m_sweep.c.x + n),
            (a = d.m_sweep.c.y + s),
            this.m_u1.Set(r - D, a - C),
            (h = this.m_u1.Length()) > t.b2_linearSlop
              ? ((this.m_u1.x *= 1 / h), (this.m_u1.y *= 1 / h))
              : this.m_u1.SetZero(),
            (u = this.m_maxLength1 - h),
            (b = e.Max(b, -u)),
            (u = e.Clamp(u + t.b2_linearSlop, -t.b2_maxLinearCorrection, 0)),
            (r = -(x = -this.m_limitMass1 * u) * this.m_u1.x),
            (a = -x * this.m_u1.y),
            (d.m_sweep.c.x += d.m_invMass * r),
            (d.m_sweep.c.y += d.m_invMass * a),
            (d.m_sweep.a += d.m_invI * (n * a - s * r)),
            d.SynchronizeTransform()),
          this.m_limitState2 === p.e_atUpperLimit &&
            ((o = B.m_xf.R),
            (l = this.m_localAnchor2.x - B.m_sweep.localCenter.x),
            (m = this.m_localAnchor2.y - B.m_sweep.localCenter.y),
            (f = o.col1.x * l + o.col2.x * m),
            (m = o.col1.y * l + o.col2.y * m),
            (l = f),
            (c = B.m_sweep.c.x + l),
            (_ = B.m_sweep.c.y + m),
            this.m_u2.Set(c - A, _ - S),
            (y = this.m_u2.Length()) > t.b2_linearSlop
              ? ((this.m_u2.x *= 1 / y), (this.m_u2.y *= 1 / y))
              : this.m_u2.SetZero(),
            (u = this.m_maxLength2 - y),
            (b = e.Max(b, -u)),
            (u = e.Clamp(u + t.b2_linearSlop, -t.b2_maxLinearCorrection, 0)),
            (c = -(x = -this.m_limitMass2 * u) * this.m_u2.x),
            (_ = -x * this.m_u2.y),
            (B.m_sweep.c.x += B.m_invMass * c),
            (B.m_sweep.c.y += B.m_invMass * _),
            (B.m_sweep.a += B.m_invI * (l * _ - m * c)),
            B.SynchronizeTransform()),
          b < t.b2_linearSlop
        );
      }),
      Box2D.postDefs.push(function () {
        Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength = 2;
      }),
      Box2D.inherit(A, Box2D.Dynamics.Joints.b2JointDef),
      (A.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (A.b2PulleyJointDef = function () {
        Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments),
          (this.groundAnchorA = new n()),
          (this.groundAnchorB = new n()),
          (this.localAnchorA = new n()),
          (this.localAnchorB = new n());
      }),
      (A.prototype.b2PulleyJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_pulleyJoint),
          this.groundAnchorA.Set(-1, 1),
          this.groundAnchorB.Set(1, 1),
          this.localAnchorA.Set(-1, 0),
          this.localAnchorB.Set(1, 0),
          (this.lengthA = 0),
          (this.maxLengthA = 0),
          (this.lengthB = 0),
          (this.maxLengthB = 0),
          (this.ratio = 1),
          (this.collideConnected = !0);
      }),
      (A.prototype.Initialize = function (t, i, o, e, n, s, l) {
        void 0 === l && (l = 0),
          (this.bodyA = t),
          (this.bodyB = i),
          this.groundAnchorA.SetV(o),
          this.groundAnchorB.SetV(e),
          (this.localAnchorA = this.bodyA.GetLocalPoint(n)),
          (this.localAnchorB = this.bodyB.GetLocalPoint(s));
        let m = n.x - o.x,
          r = n.y - o.y;
        this.lengthA = Math.sqrt(m * m + r * r);
        let a = s.x - e.x,
          c = s.y - e.y;
        (this.lengthB = Math.sqrt(a * a + c * c)), (this.ratio = l);
        let _ = this.lengthA + this.ratio * this.lengthB;
        (this.maxLengthA = _ - this.ratio * C.b2_minPulleyLength),
          (this.maxLengthB = (_ - C.b2_minPulleyLength) / this.ratio);
      }),
      Box2D.inherit(S, Box2D.Dynamics.Joints.b2Joint),
      (S.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (S.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      }),
      (S.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      }),
      (S.prototype.GetReactionForce = function (t) {
        return new n(t * this.m_impulse.x, t * this.m_impulse.y);
      }),
      (S.prototype.GetReactionTorque = function (t) {
        return t * this.m_impulse.z;
      }),
      (S.prototype.GetJointAngle = function () {
        return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a - this.m_referenceAngle;
      }),
      (S.prototype.GetJointSpeed = function () {
        return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity;
      }),
      (S.prototype.IsLimitEnabled = function () {
        return this.m_enableLimit;
      }),
      (S.prototype.EnableLimit = function (t) {
        this.m_enableLimit = t;
      }),
      (S.prototype.GetLowerLimit = function () {
        return this.m_lowerAngle;
      }),
      (S.prototype.GetUpperLimit = function () {
        return this.m_upperAngle;
      }),
      (S.prototype.SetLimits = function (t, i) {
        void 0 === t && (t = 0),
          void 0 === i && (i = 0),
          (this.m_lowerAngle = t),
          (this.m_upperAngle = i);
      }),
      (S.prototype.IsMotorEnabled = function () {
        return this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), this.m_enableMotor;
      }),
      (S.prototype.EnableMotor = function (t) {
        this.m_enableMotor = t;
      }),
      (S.prototype.SetMotorSpeed = function (t) {
        this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), (this.m_motorSpeed = t);
      }),
      (S.prototype.GetMotorSpeed = function () {
        return this.m_motorSpeed;
      }),
      (S.prototype.SetMaxMotorTorque = function (t) {
        this.m_maxMotorTorque = t;
      }),
      (S.prototype.GetMotorTorque = function () {
        return this.m_maxMotorTorque;
      }),
      (S.prototype.b2RevoluteJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          this.m_localAnchor1.SetV(t.localAnchorA),
          this.m_localAnchor2.SetV(t.localAnchorB),
          (this.m_referenceAngle = t.referenceAngle),
          this.m_impulse.SetZero(),
          (this.m_motorImpulse = 0),
          (this.m_lowerAngle = t.lowerAngle),
          (this.m_upperAngle = t.upperAngle),
          (this.m_maxMotorTorque = t.maxMotorTorque),
          (this.m_motorSpeed = t.motorSpeed),
          (this.m_enableLimit = t.enableLimit),
          (this.m_enableMotor = t.enableMotor),
          (this.m_limitState = p.e_inactiveLimit);
      }),
      (S.prototype.InitVelocityConstraints = function (i) {
        let o = this.m_bodyA,
          n = this.m_bodyB,
          s = o.m_xf.R,
          l = this.m_localAnchor1.x - o.m_sweep.localCenter.x,
          m = this.m_localAnchor1.y - o.m_sweep.localCenter.y,
          r = s.col1.x * l + s.col2.x * m;
        (m = s.col1.y * l + s.col2.y * m), (l = r), (s = n.m_xf.R);
        let a = this.m_localAnchor2.x - n.m_sweep.localCenter.x,
          c = this.m_localAnchor2.y - n.m_sweep.localCenter.y;
        (r = s.col1.x * a + s.col2.x * c), (c = s.col1.y * a + s.col2.y * c), (a = r);
        let _ = o.m_invMass,
          h = n.m_invMass,
          y = o.m_invI,
          u = n.m_invI;
        if (
          ((this.m_mass.col1.x = _ + h + m * m * y + c * c * u),
          (this.m_mass.col2.x = -m * l * y - c * a * u),
          (this.m_mass.col3.x = -m * y - c * u),
          (this.m_mass.col1.y = this.m_mass.col2.x),
          (this.m_mass.col2.y = _ + h + l * l * y + a * a * u),
          (this.m_mass.col3.y = l * y + a * u),
          (this.m_mass.col1.z = this.m_mass.col3.x),
          (this.m_mass.col2.z = this.m_mass.col3.y),
          (this.m_mass.col3.z = y + u),
          (this.m_motorMass = 1 / (y + u)),
          this.m_enableMotor || (this.m_motorImpulse = 0),
          this.m_enableLimit)
        ) {
          let i = n.m_sweep.a - o.m_sweep.a - this.m_referenceAngle;
          e.Abs(this.m_upperAngle - this.m_lowerAngle) < 2 * t.b2_angularSlop
            ? (this.m_limitState = p.e_equalLimits)
            : i <= this.m_lowerAngle
            ? (this.m_limitState !== p.e_atLowerLimit && (this.m_impulse.z = 0),
              (this.m_limitState = p.e_atLowerLimit))
            : i >= this.m_upperAngle
            ? (this.m_limitState !== p.e_atUpperLimit && (this.m_impulse.z = 0),
              (this.m_limitState = p.e_atUpperLimit))
            : ((this.m_limitState = p.e_inactiveLimit), (this.m_impulse.z = 0));
        } else this.m_limitState = p.e_inactiveLimit;
        if (i.warmStarting) {
          (this.m_impulse.x *= i.dtRatio),
            (this.m_impulse.y *= i.dtRatio),
            (this.m_motorImpulse *= i.dtRatio);
          let t = this.m_impulse.x,
            e = this.m_impulse.y;
          (o.m_linearVelocity.x -= _ * t),
            (o.m_linearVelocity.y -= _ * e),
            (o.m_angularVelocity -= y * (l * e - m * t + this.m_motorImpulse + this.m_impulse.z)),
            (n.m_linearVelocity.x += h * t),
            (n.m_linearVelocity.y += h * e),
            (n.m_angularVelocity += u * (a * e - c * t + this.m_motorImpulse + this.m_impulse.z));
        } else this.m_impulse.SetZero(), (this.m_motorImpulse = 0);
      }),
      (S.prototype.SolveVelocityConstraints = function (t) {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          n = i.m_linearVelocity,
          s = i.m_angularVelocity,
          l = o.m_linearVelocity,
          m = o.m_angularVelocity,
          r = i.m_invMass,
          a = o.m_invMass,
          c = i.m_invI,
          _ = o.m_invI;
        if (this.m_enableMotor && this.m_limitState !== p.e_equalLimits) {
          let i = m - s - this.m_motorSpeed,
            o = this.m_motorMass * -i,
            n = this.m_motorImpulse,
            l = t.dt * this.m_maxMotorTorque;
          (this.m_motorImpulse = e.Clamp(this.m_motorImpulse + o, -l, l)),
            (s -= c * (o = this.m_motorImpulse - n)),
            (m += _ * o);
        }
        if (this.m_enableLimit && this.m_limitState !== p.e_inactiveLimit) {
          let t = i.m_xf.R,
            e = this.m_localAnchor1.x - i.m_sweep.localCenter.x,
            h = this.m_localAnchor1.y - i.m_sweep.localCenter.y,
            y = t.col1.x * e + t.col2.x * h;
          (h = t.col1.y * e + t.col2.y * h), (e = y), (t = o.m_xf.R);
          let u = this.m_localAnchor2.x - o.m_sweep.localCenter.x,
            x = this.m_localAnchor2.y - o.m_sweep.localCenter.y;
          (y = t.col1.x * u + t.col2.x * x), (x = t.col1.y * u + t.col2.y * x), (u = y);
          let f = l.x + -m * x - n.x - -s * h,
            b = l.y + m * u - n.y - s * e,
            d = m - s;
          if (
            (this.m_mass.Solve33(this.impulse3, -f, -b, -d), this.m_limitState === p.e_equalLimits)
          )
            this.m_impulse.Add(this.impulse3);
          else if (this.m_limitState === p.e_atLowerLimit) {
            this.m_impulse.z + this.impulse3.z < 0 &&
              (this.m_mass.Solve22(this.reduced, -f, -b),
              (this.impulse3.x = this.reduced.x),
              (this.impulse3.y = this.reduced.y),
              (this.impulse3.z = -this.m_impulse.z),
              (this.m_impulse.x += this.reduced.x),
              (this.m_impulse.y += this.reduced.y),
              (this.m_impulse.z = 0));
          } else if (this.m_limitState === p.e_atUpperLimit) {
            this.m_impulse.z + this.impulse3.z > 0 &&
              (this.m_mass.Solve22(this.reduced, -f, -b),
              (this.impulse3.x = this.reduced.x),
              (this.impulse3.y = this.reduced.y),
              (this.impulse3.z = -this.m_impulse.z),
              (this.m_impulse.x += this.reduced.x),
              (this.m_impulse.y += this.reduced.y),
              (this.m_impulse.z = 0));
          }
          (n.x -= r * this.impulse3.x),
            (n.y -= r * this.impulse3.y),
            (s -= c * (e * this.impulse3.y - h * this.impulse3.x + this.impulse3.z)),
            (l.x += a * this.impulse3.x),
            (l.y += a * this.impulse3.y),
            (m += _ * (u * this.impulse3.y - x * this.impulse3.x + this.impulse3.z));
        } else {
          let t = i.m_xf.R,
            e = this.m_localAnchor1.x - i.m_sweep.localCenter.x,
            h = this.m_localAnchor1.y - i.m_sweep.localCenter.y,
            p = t.col1.x * e + t.col2.x * h;
          (h = t.col1.y * e + t.col2.y * h), (e = p), (t = o.m_xf.R);
          let y = this.m_localAnchor2.x - o.m_sweep.localCenter.x,
            u = this.m_localAnchor2.y - o.m_sweep.localCenter.y;
          (p = t.col1.x * y + t.col2.x * u), (u = t.col1.y * y + t.col2.y * u), (y = p);
          let x = l.x + -m * u - n.x - -s * h,
            f = l.y + m * y - n.y - s * e;
          this.m_mass.Solve22(this.impulse2, -x, -f),
            (this.m_impulse.x += this.impulse2.x),
            (this.m_impulse.y += this.impulse2.y),
            (n.x -= r * this.impulse2.x),
            (n.y -= r * this.impulse2.y),
            (s -= c * (e * this.impulse2.y - h * this.impulse2.x)),
            (l.x += a * this.impulse2.x),
            (l.y += a * this.impulse2.y),
            (m += _ * (y * this.impulse2.y - u * this.impulse2.x));
        }
        i.m_linearVelocity.SetV(n),
          (i.m_angularVelocity = s),
          o.m_linearVelocity.SetV(l),
          (o.m_angularVelocity = m);
      }),
      (S.prototype.SolvePositionConstraints = function () {
        let i = 0,
          o = this.m_bodyA,
          n = this.m_bodyB,
          s = 0,
          l = 0;
        if (this.m_enableLimit && this.m_limitState !== p.e_inactiveLimit) {
          let l = n.m_sweep.a - o.m_sweep.a - this.m_referenceAngle,
            m = 0;
          this.m_limitState === p.e_equalLimits
            ? ((i = e.Clamp(
                l - this.m_lowerAngle,
                -t.b2_maxAngularCorrection,
                t.b2_maxAngularCorrection
              )),
              (m = -this.m_motorMass * i),
              (s = e.Abs(i)))
            : this.m_limitState === p.e_atLowerLimit
            ? ((s = -(i = l - this.m_lowerAngle)),
              (i = e.Clamp(i + t.b2_angularSlop, -t.b2_maxAngularCorrection, 0)),
              (m = -this.m_motorMass * i))
            : this.m_limitState === p.e_atUpperLimit &&
              ((s = i = l - this.m_upperAngle),
              (i = e.Clamp(i - t.b2_angularSlop, 0, t.b2_maxAngularCorrection)),
              (m = -this.m_motorMass * i)),
            (o.m_sweep.a -= o.m_invI * m),
            (n.m_sweep.a += n.m_invI * m);
        }
        {
          let i = o.m_xf.R,
            e = this.m_localAnchor1.x - o.m_sweep.localCenter.x,
            s = this.m_localAnchor1.y - o.m_sweep.localCenter.y,
            m = i.col1.x * e + i.col2.x * s;
          (s = i.col1.y * e + i.col2.y * s), (e = m), (i = n.m_xf.R);
          let r = this.m_localAnchor2.x - n.m_sweep.localCenter.x,
            a = this.m_localAnchor2.y - n.m_sweep.localCenter.y;
          (m = i.col1.x * r + i.col2.x * a), (a = i.col1.y * r + i.col2.y * a), (r = m);
          let c = n.m_sweep.c.x + r - o.m_sweep.c.x - e,
            _ = n.m_sweep.c.y + a - o.m_sweep.c.y - s;
          l = c * c + _ * _;
          let h,
            p,
            y = o.m_invMass,
            u = n.m_invMass,
            x = o.m_invI,
            f = n.m_invI,
            b = 10 * t.b2_linearSlop;
          if (l > b * b) {
            let t = 1 / (y + u);
            (h = t * -c),
              (p = t * -_),
              (o.m_sweep.c.x -= 0.5 * y * h),
              (o.m_sweep.c.y -= 0.5 * y * p),
              (n.m_sweep.c.x += 0.5 * u * h),
              (n.m_sweep.c.y += 0.5 * u * p),
              (c = n.m_sweep.c.x + r - o.m_sweep.c.x - e),
              (_ = n.m_sweep.c.y + a - o.m_sweep.c.y - s);
          }
          let d = this.K;
          (d.col1.x = y + u + x * s * s + f * a * a),
            (d.col1.y = -x * e * s + -f * r * a),
            (d.col2.x = d.col1.y),
            (d.col2.y = y + u + x * e * e + f * r * r),
            d.Solve(S.tImpulse, -c, -_),
            (h = S.tImpulse.x),
            (p = S.tImpulse.y),
            (o.m_sweep.c.x -= o.m_invMass * h),
            (o.m_sweep.c.y -= o.m_invMass * p),
            (o.m_sweep.a -= o.m_invI * (e * p - s * h)),
            (n.m_sweep.c.x += n.m_invMass * h),
            (n.m_sweep.c.y += n.m_invMass * p),
            (n.m_sweep.a += n.m_invI * (r * p - a * h));
        }
        return (
          o.SynchronizeTransform(),
          n.SynchronizeTransform(),
          l <= t.b2_linearSlop * t.b2_linearSlop && s <= t.b2_angularSlop
        );
      }),
      Box2D.postDefs.push(function () {
        Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse = new n();
      }),
      Box2D.inherit(w, Box2D.Dynamics.Joints.b2JointDef),
      (w.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (w.prototype.b2RevoluteJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_revoluteJoint),
          this.localAnchorA.Set(0, 0),
          this.localAnchorB.Set(0, 0),
          (this.referenceAngle = 0),
          (this.lowerAngle = 0),
          (this.upperAngle = 0),
          (this.maxMotorTorque = 0),
          (this.motorSpeed = 0),
          (this.enableLimit = !1),
          (this.enableMotor = !1);
      }),
      (w.prototype.Initialize = function (t, i, o) {
        (this.bodyA = t),
          (this.bodyB = i),
          (this.localAnchorA = this.bodyA.GetLocalPoint(o)),
          (this.localAnchorB = this.bodyB.GetLocalPoint(o)),
          (this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle());
      }),
      Box2D.inherit(v, Box2D.Dynamics.Joints.b2Joint),
      (w.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (w.prototype.b2RevoluteJointDef = function () {
        this.__super.b2JointDef.call(this),
          (this.type = p.e_revoluteJoint),
          this.localAnchorA.Set(0, 0),
          this.localAnchorB.Set(0, 0),
          (this.referenceAngle = 0),
          (this.lowerAngle = 0),
          (this.upperAngle = 0),
          (this.maxMotorTorque = 0),
          (this.motorSpeed = 0),
          (this.enableLimit = !1),
          (this.enableMotor = !1);
      }),
      (w.prototype.Initialize = function (t, i, o) {
        (this.bodyA = t),
          (this.bodyB = i),
          (this.localAnchorA = this.bodyA.GetLocalPoint(o)),
          (this.localAnchorB = this.bodyB.GetLocalPoint(o)),
          (this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle());
      }),
      Box2D.inherit(v, Box2D.Dynamics.Joints.b2Joint),
      (v.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
      (v.prototype.GetAnchorA = function () {
        return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
      }),
      (v.prototype.GetAnchorB = function () {
        return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
      }),
      (v.prototype.GetReactionForce = function (t) {
        return new n(t * this.m_impulse.x, t * this.m_impulse.y);
      }),
      (v.prototype.GetReactionTorque = function (t) {
        return t * this.m_impulse.z;
      }),
      (v.prototype.b2WeldJoint = function (t) {
        this.__super.b2Joint.call(this, t),
          this.m_localAnchorA.SetV(t.localAnchorA),
          this.m_localAnchorB.SetV(t.localAnchorB),
          (this.m_referenceAngle = t.referenceAngle),
          this.m_impulse.SetZero(),
          (this.m_mass = new o());
      }),
      (v.prototype.InitVelocityConstraints = function (t) {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          e = i.m_xf.R,
          n = this.m_localAnchorA.x - i.m_sweep.localCenter.x,
          s = this.m_localAnchorA.y - i.m_sweep.localCenter.y,
          l = e.col1.x * n + e.col2.x * s;
        (s = e.col1.y * n + e.col2.y * s), (n = l), (e = o.m_xf.R);
        let m = this.m_localAnchorB.x - o.m_sweep.localCenter.x,
          r = this.m_localAnchorB.y - o.m_sweep.localCenter.y;
        (l = e.col1.x * m + e.col2.x * r), (r = e.col1.y * m + e.col2.y * r), (m = l);
        let a = i.m_invMass,
          c = o.m_invMass,
          _ = i.m_invI,
          h = o.m_invI;
        (this.m_mass.col1.x = a + c + s * s * _ + r * r * h),
          (this.m_mass.col2.x = -s * n * _ - r * m * h),
          (this.m_mass.col3.x = -s * _ - r * h),
          (this.m_mass.col1.y = this.m_mass.col2.x),
          (this.m_mass.col2.y = a + c + n * n * _ + m * m * h),
          (this.m_mass.col3.y = n * _ + m * h),
          (this.m_mass.col1.z = this.m_mass.col3.x),
          (this.m_mass.col2.z = this.m_mass.col3.y),
          (this.m_mass.col3.z = _ + h),
          t.warmStarting
            ? ((this.m_impulse.x *= t.dtRatio),
              (this.m_impulse.y *= t.dtRatio),
              (this.m_impulse.z *= t.dtRatio),
              (i.m_linearVelocity.x -= a * this.m_impulse.x),
              (i.m_linearVelocity.y -= a * this.m_impulse.y),
              (i.m_angularVelocity -=
                _ * (n * this.m_impulse.y - s * this.m_impulse.x + this.m_impulse.z)),
              (o.m_linearVelocity.x += c * this.m_impulse.x),
              (o.m_linearVelocity.y += c * this.m_impulse.y),
              (o.m_angularVelocity +=
                h * (m * this.m_impulse.y - r * this.m_impulse.x + this.m_impulse.z)))
            : this.m_impulse.SetZero();
      }),
      (v.prototype.SolveVelocityConstraints = function () {
        let t = this.m_bodyA,
          i = this.m_bodyB,
          o = t.m_linearVelocity,
          e = t.m_angularVelocity,
          n = i.m_linearVelocity,
          l = i.m_angularVelocity,
          m = t.m_invMass,
          r = i.m_invMass,
          a = t.m_invI,
          c = i.m_invI,
          _ = t.m_xf.R,
          h = this.m_localAnchorA.x - t.m_sweep.localCenter.x,
          p = this.m_localAnchorA.y - t.m_sweep.localCenter.y,
          y = _.col1.x * h + _.col2.x * p;
        (p = _.col1.y * h + _.col2.y * p), (h = y), (_ = i.m_xf.R);
        let u = this.m_localAnchorB.x - i.m_sweep.localCenter.x,
          x = this.m_localAnchorB.y - i.m_sweep.localCenter.y;
        (y = _.col1.x * u + _.col2.x * x), (x = _.col1.y * u + _.col2.y * x), (u = y);
        let f = n.x - l * x - o.x + e * p,
          b = n.y + l * u - o.y - e * h,
          d = l - e,
          B = new s(0, 0, 0);
        this.m_mass.Solve33(B, -f, -b, -d),
          this.m_impulse.Add(B),
          (o.x -= m * B.x),
          (o.y -= m * B.y),
          (e -= a * (h * B.y - p * B.x + B.z)),
          (n.x += r * B.x),
          (n.y += r * B.y),
          (l += c * (u * B.y - x * B.x + B.z)),
          (t.m_angularVelocity = e),
          (i.m_angularVelocity = l);
      }),
      (v.prototype.SolvePositionConstraints = function () {
        let i = this.m_bodyA,
          o = this.m_bodyB,
          n = i.m_xf.R,
          l = this.m_localAnchorA.x - i.m_sweep.localCenter.x,
          m = this.m_localAnchorA.y - i.m_sweep.localCenter.y,
          r = n.col1.x * l + n.col2.x * m;
        (m = n.col1.y * l + n.col2.y * m), (l = r), (n = o.m_xf.R);
        let a = this.m_localAnchorB.x - o.m_sweep.localCenter.x,
          c = this.m_localAnchorB.y - o.m_sweep.localCenter.y;
        (r = n.col1.x * a + n.col2.x * c), (c = n.col1.y * a + n.col2.y * c), (a = r);
        let _ = i.m_invMass,
          h = o.m_invMass,
          p = i.m_invI,
          y = o.m_invI,
          u = o.m_sweep.c.x + a - i.m_sweep.c.x - l,
          x = o.m_sweep.c.y + c - i.m_sweep.c.y - m,
          f = o.m_sweep.a - i.m_sweep.a - this.m_referenceAngle,
          b = 10 * t.b2_linearSlop,
          d = u * u + x * x,
          B = e.Abs(f);
        d > b * b && ((p *= 1), (y *= 1)),
          (this.m_mass.col1.x = _ + h + m * m * p + c * c * y),
          (this.m_mass.col2.x = -m * l * p - c * a * y),
          (this.m_mass.col3.x = -m * p - c * y),
          (this.m_mass.col1.y = this.m_mass.col2.x),
          (this.m_mass.col2.y = _ + h + l * l * p + a * a * y),
          (this.m_mass.col3.y = l * p + a * y),
          (this.m_mass.col1.z = this.m_mass.col3.x),
          (this.m_mass.col2.z = this.m_mass.col3.y),
          (this.m_mass.col3.z = p + y);
        let D = new s(0, 0, 0);
        return (
          this.m_mass.Solve33(D, -u, -x, -f),
          (i.m_sweep.c.x -= _ * D.x),
          (i.m_sweep.c.y -= _ * D.y),
          (i.m_sweep.a -= p * (l * D.y - m * D.x + D.z)),
          (o.m_sweep.c.x += h * D.x),
          (o.m_sweep.c.y += h * D.y),
          (o.m_sweep.a += y * (a * D.y - c * D.x + D.z)),
          i.SynchronizeTransform(),
          o.SynchronizeTransform(),
          d <= t.b2_linearSlop * t.b2_linearSlop && B <= t.b2_angularSlop
        );
      }),
      Box2D.inherit(g, Box2D.Dynamics.Joints.b2JointDef),
      (g.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype),
      (g.prototype.b2WeldJointDef = function () {
        this.__super.b2JointDef.call(this), (this.type = p.e_weldJoint), (this.referenceAngle = 0);
      }),
      (g.prototype.Initialize = function (t, i, o) {
        (this.bodyA = t),
          (this.bodyB = i),
          this.localAnchorA.SetV(this.bodyA.GetLocalPoint(o)),
          this.localAnchorB.SetV(this.bodyB.GetLocalPoint(o)),
          (this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle());
      });
  })();
for (let t = 0; t < Box2D.postDefs.length; ++t) Box2D.postDefs[t]();
delete Box2D.postDefs,
  (Box2D.b2AABB = Box2D.Collision.b2AABB),
  (Box2D.b2BodyDef = Box2D.Dynamics.b2BodyDef),
  (Box2D.b2Body = Box2D.Dynamics.b2Body),
  (Box2D.b2FixtureDef = Box2D.Dynamics.b2FixtureDef),
  (Box2D.b2Fixture = Box2D.Dynamics.b2Fixture),
  (Box2D.b2World = Box2D.Dynamics.b2World),
  (Box2D.b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape),
  (Box2D.b2CircleShape = Box2D.Collision.Shapes.b2CircleShape),
  (Box2D.b2ContactListener = Box2D.Dynamics.b2ContactListener),
  (Box2D.b2DestructionListener = Box2D.Dynamics.b2DestructionListener),
  (Box2D.b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape),
  (Box2D.b2CircleShape = Box2D.Collision.Shapes.b2CircleShape),
  (Box2D.b2FilterData = Box2D.Dynamics.b2FixtureDef),
  (Box2D.b2Joint = Box2D.Dynamics.Joints.b2Joint),
  (Box2D.b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef),
  (Box2D.b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef),
  (Box2D.b2Vec2 = Box2D.Common.Math.b2Vec2),
  (Box2D.b2Transform = Box2D.Common.Math.b2Transform),
  (Box2D.b2BodyType = {
    b2_staticBody: Box2D.b2Body.b2_staticBody,
    b2_kinematicBody: Box2D.b2Body.b2_kinematicBody,
    b2_dynamicBody: Box2D.b2Body.b2_dynamicBody,
  });
var PIXI = (function (t) {
  "use strict";
  var e = setTimeout;
  function r(t) {
    return Boolean(t && void 0 !== t.length);
  }
  function i() {}
  function n(t) {
    if (!(this instanceof n)) throw new TypeError("Promises must be constructed via new");
    if ("function" != typeof t) throw new TypeError("not a function");
    (this._state = 0),
      (this._handled = !1),
      (this._value = void 0),
      (this._deferreds = []),
      l(t, this);
  }
  function o(t, e) {
    for (; 3 === t._state; ) t = t._value;
    0 !== t._state
      ? ((t._handled = !0),
        n._immediateFn(function () {
          var r = 1 === t._state ? e.onFulfilled : e.onRejected;
          if (null !== r) {
            var i;
            try {
              i = r(t._value);
            } catch (t) {
              return void a(e.promise, t);
            }
            s(e.promise, i);
          } else (1 === t._state ? s : a)(e.promise, t._value);
        }))
      : t._deferreds.push(e);
  }
  function s(t, e) {
    try {
      if (e === t) throw new TypeError("A promise cannot be resolved with itself.");
      if (e && ("object" == typeof e || "function" == typeof e)) {
        var r = e.then;
        if (e instanceof n) return (t._state = 3), (t._value = e), void h(t);
        if ("function" == typeof r)
          return void l(
            ((i = r),
            (o = e),
            function () {
              i.apply(o, arguments);
            }),
            t
          );
      }
      (t._state = 1), (t._value = e), h(t);
    } catch (e) {
      a(t, e);
    }
    var i, o;
  }
  function a(t, e) {
    (t._state = 2), (t._value = e), h(t);
  }
  function h(t) {
    2 === t._state &&
      0 === t._deferreds.length &&
      n._immediateFn(function () {
        t._handled || n._unhandledRejectionFn(t._value);
      });
    for (var e = 0, r = t._deferreds.length; e < r; e++) o(t, t._deferreds[e]);
    t._deferreds = null;
  }
  function u(t, e, r) {
    (this.onFulfilled = "function" == typeof t ? t : null),
      (this.onRejected = "function" == typeof e ? e : null),
      (this.promise = r);
  }
  function l(t, e) {
    var r = !1;
    try {
      t(
        function (t) {
          r || ((r = !0), s(e, t));
        },
        function (t) {
          r || ((r = !0), a(e, t));
        }
      );
    } catch (t) {
      if (r) return;
      (r = !0), a(e, t);
    }
  }
  (n.prototype.catch = function (t) {
    return this.then(null, t);
  }),
    (n.prototype.then = function (t, e) {
      var r = new this.constructor(i);
      return o(this, new u(t, e, r)), r;
    }),
    (n.prototype.finally = function (t) {
      var e = this.constructor;
      return this.then(
        function (r) {
          return e.resolve(t()).then(function () {
            return r;
          });
        },
        function (r) {
          return e.resolve(t()).then(function () {
            return e.reject(r);
          });
        }
      );
    }),
    (n.all = function (t) {
      return new n(function (e, i) {
        if (!r(t)) return i(new TypeError("Promise.all accepts an array"));
        var n = Array.prototype.slice.call(t);
        if (0 === n.length) return e([]);
        var o = n.length;
        function s(t, r) {
          try {
            if (r && ("object" == typeof r || "function" == typeof r)) {
              var a = r.then;
              if ("function" == typeof a)
                return void a.call(
                  r,
                  function (e) {
                    s(t, e);
                  },
                  i
                );
            }
            (n[t] = r), 0 == --o && e(n);
          } catch (t) {
            i(t);
          }
        }
        for (var a = 0; a < n.length; a++) s(a, n[a]);
      });
    }),
    (n.allSettled = function (t) {
      return new this(function (e, r) {
        if (!t || void 0 === t.length)
          return r(
            new TypeError(
              typeof t + " " + t + " is not iterable(cannot read property Symbol(Symbol.iterator))"
            )
          );
        var i = Array.prototype.slice.call(t);
        if (0 === i.length) return e([]);
        var n = i.length;
        function o(t, r) {
          if (r && ("object" == typeof r || "function" == typeof r)) {
            var s = r.then;
            if ("function" == typeof s)
              return void s.call(
                r,
                function (e) {
                  o(t, e);
                },
                function (r) {
                  (i[t] = { status: "rejected", reason: r }), 0 == --n && e(i);
                }
              );
          }
          (i[t] = { status: "fulfilled", value: r }), 0 == --n && e(i);
        }
        for (var s = 0; s < i.length; s++) o(s, i[s]);
      });
    }),
    (n.resolve = function (t) {
      return t && "object" == typeof t && t.constructor === n
        ? t
        : new n(function (e) {
            e(t);
          });
    }),
    (n.reject = function (t) {
      return new n(function (e, r) {
        r(t);
      });
    }),
    (n.race = function (t) {
      return new n(function (e, i) {
        if (!r(t)) return i(new TypeError("Promise.race accepts an array"));
        for (var o = 0, s = t.length; o < s; o++) n.resolve(t[o]).then(e, i);
      });
    }),
    (n._immediateFn =
      ("function" == typeof setImmediate &&
        function (t) {
          setImmediate(t);
        }) ||
      function (t) {
        e(t, 0);
      }),
    (n._unhandledRejectionFn = function (t) {
      "undefined" != typeof console &&
        console &&
        console.warn("Possible Unhandled Promise Rejection:", t);
    });
  var c = Object.getOwnPropertySymbols,
    d = Object.prototype.hasOwnProperty,
    f = Object.prototype.propertyIsEnumerable;
  var p = (function () {
    try {
      if (!Object.assign) return !1;
      var t = new String("abc");
      if (((t[5] = "de"), "5" === Object.getOwnPropertyNames(t)[0])) return !1;
      for (var e = {}, r = 0; r < 10; r++) e["_" + String.fromCharCode(r)] = r;
      if (
        "0123456789" !==
        Object.getOwnPropertyNames(e)
          .map(function (t) {
            return e[t];
          })
          .join("")
      )
        return !1;
      var i = {};
      return (
        "abcdefghijklmnopqrst".split("").forEach(function (t) {
          i[t] = t;
        }),
        "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, i)).join("")
      );
    } catch (t) {
      return !1;
    }
  })()
    ? Object.assign
    : function (t, e) {
        for (
          var r,
            i,
            n = arguments,
            o = (function (t) {
              if (null == t)
                throw new TypeError("Object.assign cannot be called with null or undefined");
              return Object(t);
            })(t),
            s = 1;
          s < arguments.length;
          s++
        ) {
          for (var a in (r = Object(n[s]))) d.call(r, a) && (o[a] = r[a]);
          if (c) {
            i = c(r);
            for (var h = 0; h < i.length; h++) f.call(r, i[h]) && (o[i[h]] = r[i[h]]);
          }
        }
        return o;
      };
  if (
    ("undefined" == typeof globalThis &&
      ("undefined" != typeof self
        ? (self.globalThis = self)
        : "undefined" != typeof global && (global.globalThis = global)),
    globalThis.Promise || (globalThis.Promise = n),
    Object.assign || (Object.assign = p),
    (Date.now && Date.prototype.getTime) ||
      (Date.now = function () {
        return new Date().getTime();
      }),
    !globalThis.performance || !globalThis.performance.now)
  ) {
    var _ = Date.now();
    globalThis.performance || (globalThis.performance = {}),
      (globalThis.performance.now = function () {
        return Date.now() - _;
      });
  }
  for (
    var m = Date.now(), v = ["ms", "moz", "webkit", "o"], E = 0;
    E < v.length && !globalThis.requestAnimationFrame;
    ++E
  ) {
    var T = v[E];
    (globalThis.requestAnimationFrame = globalThis[T + "RequestAnimationFrame"]),
      (globalThis.cancelAnimationFrame =
        globalThis[T + "CancelAnimationFrame"] || globalThis[T + "CancelRequestAnimationFrame"]);
  }
  globalThis.requestAnimationFrame ||
    (globalThis.requestAnimationFrame = function (t) {
      if ("function" != typeof t) throw new TypeError(t + "is not a function");
      var e = Date.now(),
        r = 16 + m - e;
      return (
        r < 0 && (r = 0),
        (m = e),
        globalThis.self.setTimeout(function () {
          (m = Date.now()), t(performance.now());
        }, r)
      );
    }),
    globalThis.cancelAnimationFrame ||
      (globalThis.cancelAnimationFrame = function (t) {
        return clearTimeout(t);
      }),
    Math.sign ||
      (Math.sign = function (t) {
        return 0 === (t = Number(t)) || isNaN(t) ? t : t > 0 ? 1 : -1;
      }),
    Number.isInteger ||
      (Number.isInteger = function (t) {
        return "number" == typeof t && isFinite(t) && Math.floor(t) === t;
      }),
    globalThis.ArrayBuffer || (globalThis.ArrayBuffer = Array),
    globalThis.Float32Array || (globalThis.Float32Array = Array),
    globalThis.Uint32Array || (globalThis.Uint32Array = Array),
    globalThis.Uint16Array || (globalThis.Uint16Array = Array),
    globalThis.Uint8Array || (globalThis.Uint8Array = Array),
    globalThis.Int32Array || (globalThis.Int32Array = Array);
  var y = /iPhone/i,
    g = /iPod/i,
    R = /iPad/i,
    b = /\biOS-universal(?:.+)Mac\b/i,
    A = /\bAndroid(?:.+)Mobile\b/i,
    x = /Android/i,
    S = /(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,
    O = /Silk/i,
    I = /Windows Phone/i,
    P = /\bWindows(?:.+)ARM\b/i,
    M = /BlackBerry/i,
    N = /BB10/i,
    D = /Opera Mini/i,
    C = /\b(CriOS|Chrome)(?:.+)Mobile/i,
    L = /Mobile(?:.+)Firefox\b/i,
    w = function (t) {
      return (
        void 0 !== t &&
        "MacIntel" === t.platform &&
        "number" == typeof t.maxTouchPoints &&
        t.maxTouchPoints > 1 &&
        "undefined" == typeof MSStream
      );
    };
  var F,
    U,
    B,
    G,
    X,
    k,
    H,
    Y,
    j,
    V,
    W,
    z,
    q,
    K,
    Z,
    Q,
    J,
    $,
    tt,
    et = (function (t) {
      var e = { userAgent: "", platform: "", maxTouchPoints: 0 };
      t || "undefined" == typeof navigator
        ? "string" == typeof t
          ? (e.userAgent = t)
          : t &&
            t.userAgent &&
            (e = {
              userAgent: t.userAgent,
              platform: t.platform,
              maxTouchPoints: t.maxTouchPoints || 0,
            })
        : (e = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            maxTouchPoints: navigator.maxTouchPoints || 0,
          });
      var r = e.userAgent,
        i = r.split("[FBAN");
      void 0 !== i[1] && (r = i[0]), void 0 !== (i = r.split("Twitter"))[1] && (r = i[0]);
      var n = (function (t) {
          return function (e) {
            return e.test(t);
          };
        })(r),
        o = {
          apple: {
            phone: n(y) && !n(I),
            ipod: n(g),
            tablet: !n(y) && (n(R) || w(e)) && !n(I),
            universal: n(b),
            device: (n(y) || n(g) || n(R) || n(b) || w(e)) && !n(I),
          },
          amazon: { phone: n(S), tablet: !n(S) && n(O), device: n(S) || n(O) },
          android: {
            phone: (!n(I) && n(S)) || (!n(I) && n(A)),
            tablet: !n(I) && !n(S) && !n(A) && (n(O) || n(x)),
            device: (!n(I) && (n(S) || n(O) || n(A) || n(x))) || n(/\bokhttp\b/i),
          },
          windows: { phone: n(I), tablet: n(P), device: n(I) || n(P) },
          other: {
            blackberry: n(M),
            blackberry10: n(N),
            opera: n(D),
            firefox: n(L),
            chrome: n(C),
            device: n(M) || n(N) || n(D) || n(L) || n(C),
          },
          any: !1,
          phone: !1,
          tablet: !1,
        };
      return (
        (o.any = o.apple.device || o.android.device || o.windows.device || o.other.device),
        (o.phone = o.apple.phone || o.android.phone || o.windows.phone),
        (o.tablet = o.apple.tablet || o.android.tablet || o.windows.tablet),
        o
      );
    })(globalThis.navigator);
  !(function (t) {
    (t[(t.WEBGL_LEGACY = 0)] = "WEBGL_LEGACY"),
      (t[(t.WEBGL = 1)] = "WEBGL"),
      (t[(t.WEBGL2 = 2)] = "WEBGL2");
  })(F || (F = {})),
    (function (t) {
      (t[(t.UNKNOWN = 0)] = "UNKNOWN"),
        (t[(t.WEBGL = 1)] = "WEBGL"),
        (t[(t.CANVAS = 2)] = "CANVAS");
    })(U || (U = {})),
    (function (t) {
      (t[(t.COLOR = 16384)] = "COLOR"),
        (t[(t.DEPTH = 256)] = "DEPTH"),
        (t[(t.STENCIL = 1024)] = "STENCIL");
    })(B || (B = {})),
    (function (t) {
      (t[(t.NORMAL = 0)] = "NORMAL"),
        (t[(t.ADD = 1)] = "ADD"),
        (t[(t.MULTIPLY = 2)] = "MULTIPLY"),
        (t[(t.SCREEN = 3)] = "SCREEN"),
        (t[(t.OVERLAY = 4)] = "OVERLAY"),
        (t[(t.DARKEN = 5)] = "DARKEN"),
        (t[(t.LIGHTEN = 6)] = "LIGHTEN"),
        (t[(t.COLOR_DODGE = 7)] = "COLOR_DODGE"),
        (t[(t.COLOR_BURN = 8)] = "COLOR_BURN"),
        (t[(t.HARD_LIGHT = 9)] = "HARD_LIGHT"),
        (t[(t.SOFT_LIGHT = 10)] = "SOFT_LIGHT"),
        (t[(t.DIFFERENCE = 11)] = "DIFFERENCE"),
        (t[(t.EXCLUSION = 12)] = "EXCLUSION"),
        (t[(t.HUE = 13)] = "HUE"),
        (t[(t.SATURATION = 14)] = "SATURATION"),
        (t[(t.COLOR = 15)] = "COLOR"),
        (t[(t.LUMINOSITY = 16)] = "LUMINOSITY"),
        (t[(t.NORMAL_NPM = 17)] = "NORMAL_NPM"),
        (t[(t.ADD_NPM = 18)] = "ADD_NPM"),
        (t[(t.SCREEN_NPM = 19)] = "SCREEN_NPM"),
        (t[(t.NONE = 20)] = "NONE"),
        (t[(t.SRC_OVER = 0)] = "SRC_OVER"),
        (t[(t.SRC_IN = 21)] = "SRC_IN"),
        (t[(t.SRC_OUT = 22)] = "SRC_OUT"),
        (t[(t.SRC_ATOP = 23)] = "SRC_ATOP"),
        (t[(t.DST_OVER = 24)] = "DST_OVER"),
        (t[(t.DST_IN = 25)] = "DST_IN"),
        (t[(t.DST_OUT = 26)] = "DST_OUT"),
        (t[(t.DST_ATOP = 27)] = "DST_ATOP"),
        (t[(t.ERASE = 26)] = "ERASE"),
        (t[(t.SUBTRACT = 28)] = "SUBTRACT"),
        (t[(t.XOR = 29)] = "XOR");
    })(G || (G = {})),
    (function (t) {
      (t[(t.POINTS = 0)] = "POINTS"),
        (t[(t.LINES = 1)] = "LINES"),
        (t[(t.LINE_LOOP = 2)] = "LINE_LOOP"),
        (t[(t.LINE_STRIP = 3)] = "LINE_STRIP"),
        (t[(t.TRIANGLES = 4)] = "TRIANGLES"),
        (t[(t.TRIANGLE_STRIP = 5)] = "TRIANGLE_STRIP"),
        (t[(t.TRIANGLE_FAN = 6)] = "TRIANGLE_FAN");
    })(X || (X = {})),
    (function (t) {
      (t[(t.RGBA = 6408)] = "RGBA"),
        (t[(t.RGB = 6407)] = "RGB"),
        (t[(t.RG = 33319)] = "RG"),
        (t[(t.RED = 6403)] = "RED"),
        (t[(t.RGBA_INTEGER = 36249)] = "RGBA_INTEGER"),
        (t[(t.RGB_INTEGER = 36248)] = "RGB_INTEGER"),
        (t[(t.RG_INTEGER = 33320)] = "RG_INTEGER"),
        (t[(t.RED_INTEGER = 36244)] = "RED_INTEGER"),
        (t[(t.ALPHA = 6406)] = "ALPHA"),
        (t[(t.LUMINANCE = 6409)] = "LUMINANCE"),
        (t[(t.LUMINANCE_ALPHA = 6410)] = "LUMINANCE_ALPHA"),
        (t[(t.DEPTH_COMPONENT = 6402)] = "DEPTH_COMPONENT"),
        (t[(t.DEPTH_STENCIL = 34041)] = "DEPTH_STENCIL");
    })(k || (k = {})),
    (function (t) {
      (t[(t.TEXTURE_2D = 3553)] = "TEXTURE_2D"),
        (t[(t.TEXTURE_CUBE_MAP = 34067)] = "TEXTURE_CUBE_MAP"),
        (t[(t.TEXTURE_2D_ARRAY = 35866)] = "TEXTURE_2D_ARRAY"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_X = 34069)] = "TEXTURE_CUBE_MAP_POSITIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070)] = "TEXTURE_CUBE_MAP_NEGATIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071)] = "TEXTURE_CUBE_MAP_POSITIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072)] = "TEXTURE_CUBE_MAP_NEGATIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073)] = "TEXTURE_CUBE_MAP_POSITIVE_Z"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074)] = "TEXTURE_CUBE_MAP_NEGATIVE_Z");
    })(H || (H = {})),
    (function (t) {
      (t[(t.UNSIGNED_BYTE = 5121)] = "UNSIGNED_BYTE"),
        (t[(t.UNSIGNED_SHORT = 5123)] = "UNSIGNED_SHORT"),
        (t[(t.UNSIGNED_SHORT_5_6_5 = 33635)] = "UNSIGNED_SHORT_5_6_5"),
        (t[(t.UNSIGNED_SHORT_4_4_4_4 = 32819)] = "UNSIGNED_SHORT_4_4_4_4"),
        (t[(t.UNSIGNED_SHORT_5_5_5_1 = 32820)] = "UNSIGNED_SHORT_5_5_5_1"),
        (t[(t.UNSIGNED_INT = 5125)] = "UNSIGNED_INT"),
        (t[(t.UNSIGNED_INT_10F_11F_11F_REV = 35899)] = "UNSIGNED_INT_10F_11F_11F_REV"),
        (t[(t.UNSIGNED_INT_2_10_10_10_REV = 33640)] = "UNSIGNED_INT_2_10_10_10_REV"),
        (t[(t.UNSIGNED_INT_24_8 = 34042)] = "UNSIGNED_INT_24_8"),
        (t[(t.UNSIGNED_INT_5_9_9_9_REV = 35902)] = "UNSIGNED_INT_5_9_9_9_REV"),
        (t[(t.BYTE = 5120)] = "BYTE"),
        (t[(t.SHORT = 5122)] = "SHORT"),
        (t[(t.INT = 5124)] = "INT"),
        (t[(t.FLOAT = 5126)] = "FLOAT"),
        (t[(t.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269)] = "FLOAT_32_UNSIGNED_INT_24_8_REV"),
        (t[(t.HALF_FLOAT = 36193)] = "HALF_FLOAT");
    })(Y || (Y = {})),
    (function (t) {
      (t[(t.FLOAT = 0)] = "FLOAT"), (t[(t.INT = 1)] = "INT"), (t[(t.UINT = 2)] = "UINT");
    })(j || (j = {})),
    (function (t) {
      (t[(t.NEAREST = 0)] = "NEAREST"), (t[(t.LINEAR = 1)] = "LINEAR");
    })(V || (V = {})),
    (function (t) {
      (t[(t.CLAMP = 33071)] = "CLAMP"),
        (t[(t.REPEAT = 10497)] = "REPEAT"),
        (t[(t.MIRRORED_REPEAT = 33648)] = "MIRRORED_REPEAT");
    })(W || (W = {})),
    (function (t) {
      (t[(t.OFF = 0)] = "OFF"),
        (t[(t.POW2 = 1)] = "POW2"),
        (t[(t.ON = 2)] = "ON"),
        (t[(t.ON_MANUAL = 3)] = "ON_MANUAL");
    })(z || (z = {})),
    (function (t) {
      (t[(t.NPM = 0)] = "NPM"),
        (t[(t.UNPACK = 1)] = "UNPACK"),
        (t[(t.PMA = 2)] = "PMA"),
        (t[(t.NO_PREMULTIPLIED_ALPHA = 0)] = "NO_PREMULTIPLIED_ALPHA"),
        (t[(t.PREMULTIPLY_ON_UPLOAD = 1)] = "PREMULTIPLY_ON_UPLOAD"),
        (t[(t.PREMULTIPLY_ALPHA = 2)] = "PREMULTIPLY_ALPHA"),
        (t[(t.PREMULTIPLIED_ALPHA = 2)] = "PREMULTIPLIED_ALPHA");
    })(q || (q = {})),
    (function (t) {
      (t[(t.NO = 0)] = "NO"),
        (t[(t.YES = 1)] = "YES"),
        (t[(t.AUTO = 2)] = "AUTO"),
        (t[(t.BLEND = 0)] = "BLEND"),
        (t[(t.CLEAR = 1)] = "CLEAR"),
        (t[(t.BLIT = 2)] = "BLIT");
    })(K || (K = {})),
    (function (t) {
      (t[(t.AUTO = 0)] = "AUTO"), (t[(t.MANUAL = 1)] = "MANUAL");
    })(Z || (Z = {})),
    (function (t) {
      (t.LOW = "lowp"), (t.MEDIUM = "mediump"), (t.HIGH = "highp");
    })(Q || (Q = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.SCISSOR = 1)] = "SCISSOR"),
        (t[(t.STENCIL = 2)] = "STENCIL"),
        (t[(t.SPRITE = 3)] = "SPRITE");
    })(J || (J = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.LOW = 2)] = "LOW"),
        (t[(t.MEDIUM = 4)] = "MEDIUM"),
        (t[(t.HIGH = 8)] = "HIGH");
    })($ || ($ = {})),
    (function (t) {
      (t[(t.ELEMENT_ARRAY_BUFFER = 34963)] = "ELEMENT_ARRAY_BUFFER"),
        (t[(t.ARRAY_BUFFER = 34962)] = "ARRAY_BUFFER"),
        (t[(t.UNIFORM_BUFFER = 35345)] = "UNIFORM_BUFFER");
    })(tt || (tt = {}));
  var rt = {
      MIPMAP_TEXTURES: z.POW2,
      ANISOTROPIC_LEVEL: 0,
      RESOLUTION: 1,
      FILTER_RESOLUTION: 1,
      FILTER_MULTISAMPLE: $.NONE,
      SPRITE_MAX_TEXTURES: (function (t) {
        var e,
          r = !0;
        (et.tablet || et.phone) &&
          (et.apple.device &&
            (e = navigator.userAgent.match(/OS (\d+)_(\d+)?/)) &&
            parseInt(e[1], 10) < 11 &&
            (r = !1),
          et.android.device &&
            (e = navigator.userAgent.match(/Android\s([0-9.]*)/)) &&
            parseInt(e[1], 10) < 7 &&
            (r = !1));
        return r ? 32 : 4;
      })(),
      SPRITE_BATCH_SIZE: 4096,
      RENDER_OPTIONS: {
        view: null,
        antialias: !1,
        autoDensity: !1,
        backgroundColor: 0,
        backgroundAlpha: 1,
        useContextAlpha: !0,
        clearBeforeRender: !0,
        preserveDrawingBuffer: !1,
        width: 800,
        height: 600,
        legacy: !1,
      },
      GC_MODE: Z.AUTO,
      GC_MAX_IDLE: 3600,
      GC_MAX_CHECK_COUNT: 600,
      WRAP_MODE: W.CLAMP,
      SCALE_MODE: V.LINEAR,
      PRECISION_VERTEX: Q.HIGH,
      PRECISION_FRAGMENT: et.apple.device ? Q.HIGH : Q.MEDIUM,
      CAN_UPLOAD_SAME_BUFFER: !et.apple.device,
      CREATE_IMAGE_BITMAP: !1,
      ROUND_PIXELS: !1,
    },
    it =
      "undefined" != typeof globalThis
        ? globalThis
        : "undefined" != typeof window
        ? window
        : "undefined" != typeof global
        ? global
        : "undefined" != typeof self
        ? self
        : {};
  function nt(t, e, r) {
    return (
      t(
        (r = {
          path: e,
          exports: {},
          require: function (t, e) {
            return (function () {
              throw new Error(
                "Dynamic requires are not currently supported by @rollup/plugin-commonjs"
              );
            })(null == e && r.path);
          },
        }),
        r.exports
      ),
      r.exports
    );
  }
  var ot = nt(function (t) {
      var e = Object.prototype.hasOwnProperty,
        r = "~";
      function i() {}
      function n(t, e, r) {
        (this.fn = t), (this.context = e), (this.once = r || !1);
      }
      function o(t, e, i, o, s) {
        if ("function" != typeof i) throw new TypeError("The listener must be a function");
        var a = new n(i, o || t, s),
          h = r ? r + e : e;
        return (
          t._events[h]
            ? t._events[h].fn
              ? (t._events[h] = [t._events[h], a])
              : t._events[h].push(a)
            : ((t._events[h] = a), t._eventsCount++),
          t
        );
      }
      function s(t, e) {
        0 == --t._eventsCount ? (t._events = new i()) : delete t._events[e];
      }
      function a() {
        (this._events = new i()), (this._eventsCount = 0);
      }
      Object.create && ((i.prototype = Object.create(null)), new i().__proto__ || (r = !1)),
        (a.prototype.eventNames = function () {
          var t,
            i,
            n = [];
          if (0 === this._eventsCount) return n;
          for (i in (t = this._events)) e.call(t, i) && n.push(r ? i.slice(1) : i);
          return Object.getOwnPropertySymbols ? n.concat(Object.getOwnPropertySymbols(t)) : n;
        }),
        (a.prototype.listeners = function (t) {
          var e = r ? r + t : t,
            i = this._events[e];
          if (!i) return [];
          if (i.fn) return [i.fn];
          for (var n = 0, o = i.length, s = new Array(o); n < o; n++) s[n] = i[n].fn;
          return s;
        }),
        (a.prototype.listenerCount = function (t) {
          var e = r ? r + t : t,
            i = this._events[e];
          return i ? (i.fn ? 1 : i.length) : 0;
        }),
        (a.prototype.emit = function (t, e, i, n, o, s) {
          var a = arguments,
            h = r ? r + t : t;
          if (!this._events[h]) return !1;
          var u,
            l,
            c = this._events[h],
            d = arguments.length;
          if (c.fn) {
            switch ((c.once && this.removeListener(t, c.fn, void 0, !0), d)) {
              case 1:
                return c.fn.call(c.context), !0;
              case 2:
                return c.fn.call(c.context, e), !0;
              case 3:
                return c.fn.call(c.context, e, i), !0;
              case 4:
                return c.fn.call(c.context, e, i, n), !0;
              case 5:
                return c.fn.call(c.context, e, i, n, o), !0;
              case 6:
                return c.fn.call(c.context, e, i, n, o, s), !0;
            }
            for (l = 1, u = new Array(d - 1); l < d; l++) u[l - 1] = a[l];
            c.fn.apply(c.context, u);
          } else {
            var f,
              p = c.length;
            for (l = 0; l < p; l++)
              switch ((c[l].once && this.removeListener(t, c[l].fn, void 0, !0), d)) {
                case 1:
                  c[l].fn.call(c[l].context);
                  break;
                case 2:
                  c[l].fn.call(c[l].context, e);
                  break;
                case 3:
                  c[l].fn.call(c[l].context, e, i);
                  break;
                case 4:
                  c[l].fn.call(c[l].context, e, i, n);
                  break;
                default:
                  if (!u) for (f = 1, u = new Array(d - 1); f < d; f++) u[f - 1] = a[f];
                  c[l].fn.apply(c[l].context, u);
              }
          }
          return !0;
        }),
        (a.prototype.on = function (t, e, r) {
          return o(this, t, e, r, !1);
        }),
        (a.prototype.once = function (t, e, r) {
          return o(this, t, e, r, !0);
        }),
        (a.prototype.removeListener = function (t, e, i, n) {
          var o = r ? r + t : t;
          if (!this._events[o]) return this;
          if (!e) return s(this, o), this;
          var a = this._events[o];
          if (a.fn) a.fn !== e || (n && !a.once) || (i && a.context !== i) || s(this, o);
          else {
            for (var h = 0, u = [], l = a.length; h < l; h++)
              (a[h].fn !== e || (n && !a[h].once) || (i && a[h].context !== i)) && u.push(a[h]);
            u.length ? (this._events[o] = 1 === u.length ? u[0] : u) : s(this, o);
          }
          return this;
        }),
        (a.prototype.removeAllListeners = function (t) {
          var e;
          return (
            t
              ? ((e = r ? r + t : t), this._events[e] && s(this, e))
              : ((this._events = new i()), (this._eventsCount = 0)),
            this
          );
        }),
        (a.prototype.off = a.prototype.removeListener),
        (a.prototype.addListener = a.prototype.on),
        (a.prefixed = r),
        (a.EventEmitter = a),
        (t.exports = a);
    }),
    st = ht,
    at = ht;
  function ht(t, e, r) {
    r = r || 2;
    var i,
      n,
      o,
      s,
      a,
      h,
      u,
      l = e && e.length,
      c = l ? e[0] * r : t.length,
      d = ut(t, 0, c, r, !0),
      f = [];
    if (!d || d.next === d.prev) return f;
    if (
      (l &&
        (d = (function (t, e, r, i) {
          var n,
            o,
            s,
            a,
            h,
            u = [];
          for (n = 0, o = e.length; n < o; n++)
            (s = e[n] * i),
              (a = n < o - 1 ? e[n + 1] * i : t.length),
              (h = ut(t, s, a, i, !1)) === h.next && (h.steiner = !0),
              u.push(yt(h));
          for (u.sort(mt), n = 0; n < u.length; n++) vt(u[n], r), (r = lt(r, r.next));
          return r;
        })(t, e, d, r)),
      t.length > 80 * r)
    ) {
      (i = o = t[0]), (n = s = t[1]);
      for (var p = r; p < c; p += r)
        (a = t[p]) < i && (i = a),
          (h = t[p + 1]) < n && (n = h),
          a > o && (o = a),
          h > s && (s = h);
      u = 0 !== (u = Math.max(o - i, s - n)) ? 1 / u : 0;
    }
    return ct(d, f, r, i, n, u), f;
  }
  function ut(t, e, r, i, n) {
    var o, s;
    if (n === Ct(t, e, r, i) > 0) for (o = e; o < r; o += i) s = Mt(o, t[o], t[o + 1], s);
    else for (o = r - i; o >= e; o -= i) s = Mt(o, t[o], t[o + 1], s);
    return s && At(s, s.next) && (Nt(s), (s = s.next)), s;
  }
  function lt(t, e) {
    if (!t) return t;
    e || (e = t);
    var r,
      i = t;
    do {
      if (((r = !1), i.steiner || (!At(i, i.next) && 0 !== bt(i.prev, i, i.next)))) i = i.next;
      else {
        if ((Nt(i), (i = e = i.prev) === i.next)) break;
        r = !0;
      }
    } while (r || i !== e);
    return e;
  }
  function ct(t, e, r, i, n, o, s) {
    if (t) {
      !s &&
        o &&
        (function (t, e, r, i) {
          var n = t;
          do {
            null === n.z && (n.z = Tt(n.x, n.y, e, r, i)),
              (n.prevZ = n.prev),
              (n.nextZ = n.next),
              (n = n.next);
          } while (n !== t);
          (n.prevZ.nextZ = null),
            (n.prevZ = null),
            (function (t) {
              var e,
                r,
                i,
                n,
                o,
                s,
                a,
                h,
                u = 1;
              do {
                for (r = t, t = null, o = null, s = 0; r; ) {
                  for (s++, i = r, a = 0, e = 0; e < u && (a++, (i = i.nextZ)); e++);
                  for (h = u; a > 0 || (h > 0 && i); )
                    0 !== a && (0 === h || !i || r.z <= i.z)
                      ? ((n = r), (r = r.nextZ), a--)
                      : ((n = i), (i = i.nextZ), h--),
                      o ? (o.nextZ = n) : (t = n),
                      (n.prevZ = o),
                      (o = n);
                  r = i;
                }
                (o.nextZ = null), (u *= 2);
              } while (s > 1);
            })(n);
        })(t, i, n, o);
      for (var a, h, u = t; t.prev !== t.next; )
        if (((a = t.prev), (h = t.next), o ? ft(t, i, n, o) : dt(t)))
          e.push(a.i / r), e.push(t.i / r), e.push(h.i / r), Nt(t), (t = h.next), (u = h.next);
        else if ((t = h) === u) {
          s
            ? 1 === s
              ? ct((t = pt(lt(t), e, r)), e, r, i, n, o, 2)
              : 2 === s && _t(t, e, r, i, n, o)
            : ct(lt(t), e, r, i, n, o, 1);
          break;
        }
    }
  }
  function dt(t) {
    var e = t.prev,
      r = t,
      i = t.next;
    if (bt(e, r, i) >= 0) return !1;
    for (var n = t.next.next; n !== t.prev; ) {
      if (gt(e.x, e.y, r.x, r.y, i.x, i.y, n.x, n.y) && bt(n.prev, n, n.next) >= 0) return !1;
      n = n.next;
    }
    return !0;
  }
  function ft(t, e, r, i) {
    var n = t.prev,
      o = t,
      s = t.next;
    if (bt(n, o, s) >= 0) return !1;
    for (
      var a = n.x < o.x ? (n.x < s.x ? n.x : s.x) : o.x < s.x ? o.x : s.x,
        h = n.y < o.y ? (n.y < s.y ? n.y : s.y) : o.y < s.y ? o.y : s.y,
        u = n.x > o.x ? (n.x > s.x ? n.x : s.x) : o.x > s.x ? o.x : s.x,
        l = n.y > o.y ? (n.y > s.y ? n.y : s.y) : o.y > s.y ? o.y : s.y,
        c = Tt(a, h, e, r, i),
        d = Tt(u, l, e, r, i),
        f = t.prevZ,
        p = t.nextZ;
      f && f.z >= c && p && p.z <= d;

    ) {
      if (
        f !== t.prev &&
        f !== t.next &&
        gt(n.x, n.y, o.x, o.y, s.x, s.y, f.x, f.y) &&
        bt(f.prev, f, f.next) >= 0
      )
        return !1;
      if (
        ((f = f.prevZ),
        p !== t.prev &&
          p !== t.next &&
          gt(n.x, n.y, o.x, o.y, s.x, s.y, p.x, p.y) &&
          bt(p.prev, p, p.next) >= 0)
      )
        return !1;
      p = p.nextZ;
    }
    for (; f && f.z >= c; ) {
      if (
        f !== t.prev &&
        f !== t.next &&
        gt(n.x, n.y, o.x, o.y, s.x, s.y, f.x, f.y) &&
        bt(f.prev, f, f.next) >= 0
      )
        return !1;
      f = f.prevZ;
    }
    for (; p && p.z <= d; ) {
      if (
        p !== t.prev &&
        p !== t.next &&
        gt(n.x, n.y, o.x, o.y, s.x, s.y, p.x, p.y) &&
        bt(p.prev, p, p.next) >= 0
      )
        return !1;
      p = p.nextZ;
    }
    return !0;
  }
  function pt(t, e, r) {
    var i = t;
    do {
      var n = i.prev,
        o = i.next.next;
      !At(n, o) &&
        xt(n, i, i.next, o) &&
        It(n, o) &&
        It(o, n) &&
        (e.push(n.i / r), e.push(i.i / r), e.push(o.i / r), Nt(i), Nt(i.next), (i = t = o)),
        (i = i.next);
    } while (i !== t);
    return lt(i);
  }
  function _t(t, e, r, i, n, o) {
    var s = t;
    do {
      for (var a = s.next.next; a !== s.prev; ) {
        if (s.i !== a.i && Rt(s, a)) {
          var h = Pt(s, a);
          return (
            (s = lt(s, s.next)),
            (h = lt(h, h.next)),
            ct(s, e, r, i, n, o),
            void ct(h, e, r, i, n, o)
          );
        }
        a = a.next;
      }
      s = s.next;
    } while (s !== t);
  }
  function mt(t, e) {
    return t.x - e.x;
  }
  function vt(t, e) {
    if (
      (e = (function (t, e) {
        var r,
          i = e,
          n = t.x,
          o = t.y,
          s = -1 / 0;
        do {
          if (o <= i.y && o >= i.next.y && i.next.y !== i.y) {
            var a = i.x + ((o - i.y) * (i.next.x - i.x)) / (i.next.y - i.y);
            if (a <= n && a > s) {
              if (((s = a), a === n)) {
                if (o === i.y) return i;
                if (o === i.next.y) return i.next;
              }
              r = i.x < i.next.x ? i : i.next;
            }
          }
          i = i.next;
        } while (i !== e);
        if (!r) return null;
        if (n === s) return r;
        var h,
          u = r,
          l = r.x,
          c = r.y,
          d = 1 / 0;
        i = r;
        do {
          n >= i.x &&
            i.x >= l &&
            n !== i.x &&
            gt(o < c ? n : s, o, l, c, o < c ? s : n, o, i.x, i.y) &&
            ((h = Math.abs(o - i.y) / (n - i.x)),
            It(i, t) &&
              (h < d || (h === d && (i.x > r.x || (i.x === r.x && Et(r, i))))) &&
              ((r = i), (d = h))),
            (i = i.next);
        } while (i !== u);
        return r;
      })(t, e))
    ) {
      var r = Pt(e, t);
      lt(e, e.next), lt(r, r.next);
    }
  }
  function Et(t, e) {
    return bt(t.prev, t, e.prev) < 0 && bt(e.next, t, t.next) < 0;
  }
  function Tt(t, e, r, i, n) {
    return (
      (t =
        1431655765 &
        ((t =
          858993459 &
          ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - r) * n) | (t << 8))) | (t << 4))) |
            (t << 2))) |
          (t << 1))) |
      ((e =
        1431655765 &
        ((e =
          858993459 &
          ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - i) * n) | (e << 8))) | (e << 4))) |
            (e << 2))) |
          (e << 1))) <<
        1)
    );
  }
  function yt(t) {
    var e = t,
      r = t;
    do {
      (e.x < r.x || (e.x === r.x && e.y < r.y)) && (r = e), (e = e.next);
    } while (e !== t);
    return r;
  }
  function gt(t, e, r, i, n, o, s, a) {
    return (
      (n - s) * (e - a) - (t - s) * (o - a) >= 0 &&
      (t - s) * (i - a) - (r - s) * (e - a) >= 0 &&
      (r - s) * (o - a) - (n - s) * (i - a) >= 0
    );
  }
  function Rt(t, e) {
    return (
      t.next.i !== e.i &&
      t.prev.i !== e.i &&
      !(function (t, e) {
        var r = t;
        do {
          if (
            r.i !== t.i &&
            r.next.i !== t.i &&
            r.i !== e.i &&
            r.next.i !== e.i &&
            xt(r, r.next, t, e)
          )
            return !0;
          r = r.next;
        } while (r !== t);
        return !1;
      })(t, e) &&
      ((It(t, e) &&
        It(e, t) &&
        (function (t, e) {
          var r = t,
            i = !1,
            n = (t.x + e.x) / 2,
            o = (t.y + e.y) / 2;
          do {
            r.y > o != r.next.y > o &&
              r.next.y !== r.y &&
              n < ((r.next.x - r.x) * (o - r.y)) / (r.next.y - r.y) + r.x &&
              (i = !i),
              (r = r.next);
          } while (r !== t);
          return i;
        })(t, e) &&
        (bt(t.prev, t, e.prev) || bt(t, e.prev, e))) ||
        (At(t, e) && bt(t.prev, t, t.next) > 0 && bt(e.prev, e, e.next) > 0))
    );
  }
  function bt(t, e, r) {
    return (e.y - t.y) * (r.x - e.x) - (e.x - t.x) * (r.y - e.y);
  }
  function At(t, e) {
    return t.x === e.x && t.y === e.y;
  }
  function xt(t, e, r, i) {
    var n = Ot(bt(t, e, r)),
      o = Ot(bt(t, e, i)),
      s = Ot(bt(r, i, t)),
      a = Ot(bt(r, i, e));
    return (
      (n !== o && s !== a) ||
      !(0 !== n || !St(t, r, e)) ||
      !(0 !== o || !St(t, i, e)) ||
      !(0 !== s || !St(r, t, i)) ||
      !(0 !== a || !St(r, e, i))
    );
  }
  function St(t, e, r) {
    return (
      e.x <= Math.max(t.x, r.x) &&
      e.x >= Math.min(t.x, r.x) &&
      e.y <= Math.max(t.y, r.y) &&
      e.y >= Math.min(t.y, r.y)
    );
  }
  function Ot(t) {
    return t > 0 ? 1 : t < 0 ? -1 : 0;
  }
  function It(t, e) {
    return bt(t.prev, t, t.next) < 0
      ? bt(t, e, t.next) >= 0 && bt(t, t.prev, e) >= 0
      : bt(t, e, t.prev) < 0 || bt(t, t.next, e) < 0;
  }
  function Pt(t, e) {
    var r = new Dt(t.i, t.x, t.y),
      i = new Dt(e.i, e.x, e.y),
      n = t.next,
      o = e.prev;
    return (
      (t.next = e),
      (e.prev = t),
      (r.next = n),
      (n.prev = r),
      (i.next = r),
      (r.prev = i),
      (o.next = i),
      (i.prev = o),
      i
    );
  }
  function Mt(t, e, r, i) {
    var n = new Dt(t, e, r);
    return (
      i
        ? ((n.next = i.next), (n.prev = i), (i.next.prev = n), (i.next = n))
        : ((n.prev = n), (n.next = n)),
      n
    );
  }
  function Nt(t) {
    (t.next.prev = t.prev),
      (t.prev.next = t.next),
      t.prevZ && (t.prevZ.nextZ = t.nextZ),
      t.nextZ && (t.nextZ.prevZ = t.prevZ);
  }
  function Dt(t, e, r) {
    (this.i = t),
      (this.x = e),
      (this.y = r),
      (this.prev = null),
      (this.next = null),
      (this.z = null),
      (this.prevZ = null),
      (this.nextZ = null),
      (this.steiner = !1);
  }
  function Ct(t, e, r, i) {
    for (var n = 0, o = e, s = r - i; o < r; o += i)
      (n += (t[s] - t[o]) * (t[o + 1] + t[s + 1])), (s = o);
    return n;
  }
  (ht.deviation = function (t, e, r, i) {
    var n = e && e.length,
      o = n ? e[0] * r : t.length,
      s = Math.abs(Ct(t, 0, o, r));
    if (n)
      for (var a = 0, h = e.length; a < h; a++) {
        var u = e[a] * r,
          l = a < h - 1 ? e[a + 1] * r : t.length;
        s -= Math.abs(Ct(t, u, l, r));
      }
    var c = 0;
    for (a = 0; a < i.length; a += 3) {
      var d = i[a] * r,
        f = i[a + 1] * r,
        p = i[a + 2] * r;
      c += Math.abs((t[d] - t[p]) * (t[f + 1] - t[d + 1]) - (t[d] - t[f]) * (t[p + 1] - t[d + 1]));
    }
    return 0 === s && 0 === c ? 0 : Math.abs((c - s) / s);
  }),
    (ht.flatten = function (t) {
      for (
        var e = t[0][0].length, r = { vertices: [], holes: [], dimensions: e }, i = 0, n = 0;
        n < t.length;
        n++
      ) {
        for (var o = 0; o < t[n].length; o++)
          for (var s = 0; s < e; s++) r.vertices.push(t[n][o][s]);
        n > 0 && ((i += t[n - 1].length), r.holes.push(i));
      }
      return r;
    }),
    (st.default = at);
  var Lt = nt(function (t, e) {
      !(function (r) {
        var i = e && !e.nodeType && e,
          n = t && !t.nodeType && t,
          o = "object" == typeof it && it;
        (o.global !== o && o.window !== o && o.self !== o) || (r = o);
        var s,
          a,
          h = 2147483647,
          u = 36,
          l = 1,
          c = 26,
          d = 38,
          f = 700,
          p = 72,
          _ = 128,
          m = "-",
          v = /^xn--/,
          E = /[^\x20-\x7E]/,
          T = /[\x2E\u3002\uFF0E\uFF61]/g,
          y = {
            overflow: "Overflow: input needs wider integers to process",
            "not-basic": "Illegal input >= 0x80 (not a basic code point)",
            "invalid-input": "Invalid input",
          },
          g = u - l,
          R = Math.floor,
          b = String.fromCharCode;
        function A(t) {
          throw RangeError(y[t]);
        }
        function x(t, e) {
          for (var r = t.length, i = []; r--; ) i[r] = e(t[r]);
          return i;
        }
        function S(t, e) {
          var r = t.split("@"),
            i = "";
          return (
            r.length > 1 && ((i = r[0] + "@"), (t = r[1])),
            i + x((t = t.replace(T, ".")).split("."), e).join(".")
          );
        }
        function O(t) {
          for (var e, r, i = [], n = 0, o = t.length; n < o; )
            (e = t.charCodeAt(n++)) >= 55296 && e <= 56319 && n < o
              ? 56320 == (64512 & (r = t.charCodeAt(n++)))
                ? i.push(((1023 & e) << 10) + (1023 & r) + 65536)
                : (i.push(e), n--)
              : i.push(e);
          return i;
        }
        function I(t) {
          return x(t, function (t) {
            var e = "";
            return (
              t > 65535 &&
                ((e += b((((t -= 65536) >>> 10) & 1023) | 55296)), (t = 56320 | (1023 & t))),
              (e += b(t))
            );
          }).join("");
        }
        function P(t, e) {
          return t + 22 + 75 * (t < 26) - ((0 != e) << 5);
        }
        function M(t, e, r) {
          var i = 0;
          for (t = r ? R(t / f) : t >> 1, t += R(t / e); t > (g * c) >> 1; i += u) t = R(t / g);
          return R(i + ((g + 1) * t) / (t + d));
        }
        function N(t) {
          var e,
            r,
            i,
            n,
            o,
            s,
            a,
            d,
            f,
            v,
            E,
            T = [],
            y = t.length,
            g = 0,
            b = _,
            x = p;
          for ((r = t.lastIndexOf(m)) < 0 && (r = 0), i = 0; i < r; ++i)
            t.charCodeAt(i) >= 128 && A("not-basic"), T.push(t.charCodeAt(i));
          for (n = r > 0 ? r + 1 : 0; n < y; ) {
            for (
              o = g, s = 1, a = u;
              n >= y && A("invalid-input"),
                ((d =
                  (E = t.charCodeAt(n++)) - 48 < 10
                    ? E - 22
                    : E - 65 < 26
                    ? E - 65
                    : E - 97 < 26
                    ? E - 97
                    : u) >= u ||
                  d > R((h - g) / s)) &&
                  A("overflow"),
                (g += d * s),
                !(d < (f = a <= x ? l : a >= x + c ? c : a - x));
              a += u
            )
              s > R(h / (v = u - f)) && A("overflow"), (s *= v);
            (x = M(g - o, (e = T.length + 1), 0 == o)),
              R(g / e) > h - b && A("overflow"),
              (b += R(g / e)),
              (g %= e),
              T.splice(g++, 0, b);
          }
          return I(T);
        }
        function D(t) {
          var e,
            r,
            i,
            n,
            o,
            s,
            a,
            d,
            f,
            v,
            E,
            T,
            y,
            g,
            x,
            S = [];
          for (T = (t = O(t)).length, e = _, r = 0, o = p, s = 0; s < T; ++s)
            (E = t[s]) < 128 && S.push(b(E));
          for (i = n = S.length, n && S.push(m); i < T; ) {
            for (a = h, s = 0; s < T; ++s) (E = t[s]) >= e && E < a && (a = E);
            for (
              a - e > R((h - r) / (y = i + 1)) && A("overflow"), r += (a - e) * y, e = a, s = 0;
              s < T;
              ++s
            )
              if (((E = t[s]) < e && ++r > h && A("overflow"), E == e)) {
                for (d = r, f = u; !(d < (v = f <= o ? l : f >= o + c ? c : f - o)); f += u)
                  (x = d - v), (g = u - v), S.push(b(P(v + (x % g), 0))), (d = R(x / g));
                S.push(b(P(d, 0))), (o = M(r, y, i == n)), (r = 0), ++i;
              }
            ++r, ++e;
          }
          return S.join("");
        }
        if (
          ((s = {
            version: "1.3.2",
            ucs2: { decode: O, encode: I },
            decode: N,
            encode: D,
            toASCII: function (t) {
              return S(t, function (t) {
                return E.test(t) ? "xn--" + D(t) : t;
              });
            },
            toUnicode: function (t) {
              return S(t, function (t) {
                return v.test(t) ? N(t.slice(4).toLowerCase()) : t;
              });
            },
          }),
          i && n)
        )
          if (t.exports == i) n.exports = s;
          else for (a in s) s.hasOwnProperty(a) && (i[a] = s[a]);
        else r.punycode = s;
      })(it);
    }),
    wt = {
      isString: function (t) {
        return "string" == typeof t;
      },
      isObject: function (t) {
        return "object" == typeof t && null !== t;
      },
      isNull: function (t) {
        return null === t;
      },
      isNullOrUndefined: function (t) {
        return null == t;
      },
    };
  function Ft(t, e) {
    return Object.prototype.hasOwnProperty.call(t, e);
  }
  var Ut = function (t, e, r, i) {
      (e = e || "&"), (r = r || "=");
      var n = {};
      if ("string" != typeof t || 0 === t.length) return n;
      var o = /\+/g;
      t = t.split(e);
      var s = 1e3;
      i && "number" == typeof i.maxKeys && (s = i.maxKeys);
      var a = t.length;
      s > 0 && a > s && (a = s);
      for (var h = 0; h < a; ++h) {
        var u,
          l,
          c,
          d,
          f = t[h].replace(o, "%20"),
          p = f.indexOf(r);
        p >= 0 ? ((u = f.substr(0, p)), (l = f.substr(p + 1))) : ((u = f), (l = "")),
          (c = decodeURIComponent(u)),
          (d = decodeURIComponent(l)),
          Ft(n, c) ? (Array.isArray(n[c]) ? n[c].push(d) : (n[c] = [n[c], d])) : (n[c] = d);
      }
      return n;
    },
    Bt = function (t) {
      switch (typeof t) {
        case "string":
          return t;
        case "boolean":
          return t ? "true" : "false";
        case "number":
          return isFinite(t) ? t : "";
        default:
          return "";
      }
    },
    Gt = function (t, e, r, i) {
      return (
        (e = e || "&"),
        (r = r || "="),
        null === t && (t = void 0),
        "object" == typeof t
          ? Object.keys(t)
              .map(function (i) {
                var n = encodeURIComponent(Bt(i)) + r;
                return Array.isArray(t[i])
                  ? t[i]
                      .map(function (t) {
                        return n + encodeURIComponent(Bt(t));
                      })
                      .join(e)
                  : n + encodeURIComponent(Bt(t[i]));
              })
              .join(e)
          : i
          ? encodeURIComponent(Bt(i)) + r + encodeURIComponent(Bt(t))
          : ""
      );
    },
    Xt = nt(function (t, e) {
      (e.decode = e.parse = Ut), (e.encode = e.stringify = Gt);
    }),
    kt = ie,
    Ht = function (t, e) {
      return ie(t, !1, !0).resolve(e);
    },
    Yt = function (t) {
      wt.isString(t) && (t = ie(t));
      if (!(t instanceof jt)) return jt.prototype.format.call(t);
      return t.format();
    };
  function jt() {
    (this.protocol = null),
      (this.slashes = null),
      (this.auth = null),
      (this.host = null),
      (this.port = null),
      (this.hostname = null),
      (this.hash = null),
      (this.search = null),
      (this.query = null),
      (this.pathname = null),
      (this.path = null),
      (this.href = null);
  }
  var Vt = /^([a-z0-9.+-]+:)/i,
    Wt = /:[0-9]*$/,
    zt = /^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,
    qt = ["{", "}", "|", "\\", "^", "`"].concat(["<", ">", '"', "`", " ", "\r", "\n", "\t"]),
    Kt = ["'"].concat(qt),
    Zt = ["%", "/", "?", ";", "#"].concat(Kt),
    Qt = ["/", "?", "#"],
    Jt = /^[+a-z0-9A-Z_-]{0,63}$/,
    $t = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,
    te = { javascript: !0, "javascript:": !0 },
    ee = { javascript: !0, "javascript:": !0 },
    re = {
      http: !0,
      https: !0,
      ftp: !0,
      gopher: !0,
      file: !0,
      "http:": !0,
      "https:": !0,
      "ftp:": !0,
      "gopher:": !0,
      "file:": !0,
    };
  function ie(t, e, r) {
    if (t && wt.isObject(t) && t instanceof jt) return t;
    var i = new jt();
    return i.parse(t, e, r), i;
  }
  (jt.prototype.parse = function (t, e, r) {
    if (!wt.isString(t)) throw new TypeError("Parameter 'url' must be a string, not " + typeof t);
    var i = t.indexOf("?"),
      n = -1 !== i && i < t.indexOf("#") ? "?" : "#",
      o = t.split(n);
    o[0] = o[0].replace(/\\/g, "/");
    var s = (t = o.join(n));
    if (((s = s.trim()), !r && 1 === t.split("#").length)) {
      var a = zt.exec(s);
      if (a)
        return (
          (this.path = s),
          (this.href = s),
          (this.pathname = a[1]),
          a[2]
            ? ((this.search = a[2]),
              (this.query = e ? Xt.parse(this.search.substr(1)) : this.search.substr(1)))
            : e && ((this.search = ""), (this.query = {})),
          this
        );
    }
    var h = Vt.exec(s);
    if (h) {
      var u = (h = h[0]).toLowerCase();
      (this.protocol = u), (s = s.substr(h.length));
    }
    if (r || h || s.match(/^\/\/[^@\/]+@[^@\/]+/)) {
      var l = "//" === s.substr(0, 2);
      !l || (h && ee[h]) || ((s = s.substr(2)), (this.slashes = !0));
    }
    if (!ee[h] && (l || (h && !re[h]))) {
      for (var c, d, f = -1, p = 0; p < Qt.length; p++) {
        -1 !== (_ = s.indexOf(Qt[p])) && (-1 === f || _ < f) && (f = _);
      }
      -1 !== (d = -1 === f ? s.lastIndexOf("@") : s.lastIndexOf("@", f)) &&
        ((c = s.slice(0, d)), (s = s.slice(d + 1)), (this.auth = decodeURIComponent(c))),
        (f = -1);
      for (p = 0; p < Zt.length; p++) {
        var _;
        -1 !== (_ = s.indexOf(Zt[p])) && (-1 === f || _ < f) && (f = _);
      }
      -1 === f && (f = s.length),
        (this.host = s.slice(0, f)),
        (s = s.slice(f)),
        this.parseHost(),
        (this.hostname = this.hostname || "");
      var m = "[" === this.hostname[0] && "]" === this.hostname[this.hostname.length - 1];
      if (!m)
        for (var v = this.hostname.split(/\./), E = ((p = 0), v.length); p < E; p++) {
          var T = v[p];
          if (T && !T.match(Jt)) {
            for (var y = "", g = 0, R = T.length; g < R; g++)
              T.charCodeAt(g) > 127 ? (y += "x") : (y += T[g]);
            if (!y.match(Jt)) {
              var b = v.slice(0, p),
                A = v.slice(p + 1),
                x = T.match($t);
              x && (b.push(x[1]), A.unshift(x[2])),
                A.length && (s = "/" + A.join(".") + s),
                (this.hostname = b.join("."));
              break;
            }
          }
        }
      this.hostname.length > 255
        ? (this.hostname = "")
        : (this.hostname = this.hostname.toLowerCase()),
        m || (this.hostname = Lt.toASCII(this.hostname));
      var S = this.port ? ":" + this.port : "",
        O = this.hostname || "";
      (this.host = O + S),
        (this.href += this.host),
        m &&
          ((this.hostname = this.hostname.substr(1, this.hostname.length - 2)),
          "/" !== s[0] && (s = "/" + s));
    }
    if (!te[u])
      for (p = 0, E = Kt.length; p < E; p++) {
        var I = Kt[p];
        if (-1 !== s.indexOf(I)) {
          var P = encodeURIComponent(I);
          P === I && (P = escape(I)), (s = s.split(I).join(P));
        }
      }
    var M = s.indexOf("#");
    -1 !== M && ((this.hash = s.substr(M)), (s = s.slice(0, M)));
    var N = s.indexOf("?");
    if (
      (-1 !== N
        ? ((this.search = s.substr(N)),
          (this.query = s.substr(N + 1)),
          e && (this.query = Xt.parse(this.query)),
          (s = s.slice(0, N)))
        : e && ((this.search = ""), (this.query = {})),
      s && (this.pathname = s),
      re[u] && this.hostname && !this.pathname && (this.pathname = "/"),
      this.pathname || this.search)
    ) {
      S = this.pathname || "";
      var D = this.search || "";
      this.path = S + D;
    }
    return (this.href = this.format()), this;
  }),
    (jt.prototype.format = function () {
      var t = this.auth || "";
      t && ((t = (t = encodeURIComponent(t)).replace(/%3A/i, ":")), (t += "@"));
      var e = this.protocol || "",
        r = this.pathname || "",
        i = this.hash || "",
        n = !1,
        o = "";
      this.host
        ? (n = t + this.host)
        : this.hostname &&
          ((n =
            t + (-1 === this.hostname.indexOf(":") ? this.hostname : "[" + this.hostname + "]")),
          this.port && (n += ":" + this.port)),
        this.query &&
          wt.isObject(this.query) &&
          Object.keys(this.query).length &&
          (o = Xt.stringify(this.query));
      var s = this.search || (o && "?" + o) || "";
      return (
        e && ":" !== e.substr(-1) && (e += ":"),
        this.slashes || ((!e || re[e]) && !1 !== n)
          ? ((n = "//" + (n || "")), r && "/" !== r.charAt(0) && (r = "/" + r))
          : n || (n = ""),
        i && "#" !== i.charAt(0) && (i = "#" + i),
        s && "?" !== s.charAt(0) && (s = "?" + s),
        e +
          n +
          (r = r.replace(/[?#]/g, function (t) {
            return encodeURIComponent(t);
          })) +
          (s = s.replace("#", "%23")) +
          i
      );
    }),
    (jt.prototype.resolve = function (t) {
      return this.resolveObject(ie(t, !1, !0)).format();
    }),
    (jt.prototype.resolveObject = function (t) {
      if (wt.isString(t)) {
        var e = new jt();
        e.parse(t, !1, !0), (t = e);
      }
      for (var r = new jt(), i = Object.keys(this), n = 0; n < i.length; n++) {
        var o = i[n];
        r[o] = this[o];
      }
      if (((r.hash = t.hash), "" === t.href)) return (r.href = r.format()), r;
      if (t.slashes && !t.protocol) {
        for (var s = Object.keys(t), a = 0; a < s.length; a++) {
          var h = s[a];
          "protocol" !== h && (r[h] = t[h]);
        }
        return (
          re[r.protocol] && r.hostname && !r.pathname && (r.path = r.pathname = "/"),
          (r.href = r.format()),
          r
        );
      }
      if (t.protocol && t.protocol !== r.protocol) {
        if (!re[t.protocol]) {
          for (var u = Object.keys(t), l = 0; l < u.length; l++) {
            var c = u[l];
            r[c] = t[c];
          }
          return (r.href = r.format()), r;
        }
        if (((r.protocol = t.protocol), t.host || ee[t.protocol])) r.pathname = t.pathname;
        else {
          for (var d = (t.pathname || "").split("/"); d.length && !(t.host = d.shift()); );
          t.host || (t.host = ""),
            t.hostname || (t.hostname = ""),
            "" !== d[0] && d.unshift(""),
            d.length < 2 && d.unshift(""),
            (r.pathname = d.join("/"));
        }
        if (
          ((r.search = t.search),
          (r.query = t.query),
          (r.host = t.host || ""),
          (r.auth = t.auth),
          (r.hostname = t.hostname || t.host),
          (r.port = t.port),
          r.pathname || r.search)
        ) {
          var f = r.pathname || "",
            p = r.search || "";
          r.path = f + p;
        }
        return (r.slashes = r.slashes || t.slashes), (r.href = r.format()), r;
      }
      var _ = r.pathname && "/" === r.pathname.charAt(0),
        m = t.host || (t.pathname && "/" === t.pathname.charAt(0)),
        v = m || _ || (r.host && t.pathname),
        E = v,
        T = (r.pathname && r.pathname.split("/")) || [],
        y = ((d = (t.pathname && t.pathname.split("/")) || []), r.protocol && !re[r.protocol]);
      if (
        (y &&
          ((r.hostname = ""),
          (r.port = null),
          r.host && ("" === T[0] ? (T[0] = r.host) : T.unshift(r.host)),
          (r.host = ""),
          t.protocol &&
            ((t.hostname = null),
            (t.port = null),
            t.host && ("" === d[0] ? (d[0] = t.host) : d.unshift(t.host)),
            (t.host = null)),
          (v = v && ("" === d[0] || "" === T[0]))),
        m)
      )
        (r.host = t.host || "" === t.host ? t.host : r.host),
          (r.hostname = t.hostname || "" === t.hostname ? t.hostname : r.hostname),
          (r.search = t.search),
          (r.query = t.query),
          (T = d);
      else if (d.length)
        T || (T = []), T.pop(), (T = T.concat(d)), (r.search = t.search), (r.query = t.query);
      else if (!wt.isNullOrUndefined(t.search)) {
        if (y)
          (r.hostname = r.host = T.shift()),
            (x = !!(r.host && r.host.indexOf("@") > 0) && r.host.split("@")) &&
              ((r.auth = x.shift()), (r.host = r.hostname = x.shift()));
        return (
          (r.search = t.search),
          (r.query = t.query),
          (wt.isNull(r.pathname) && wt.isNull(r.search)) ||
            (r.path = (r.pathname ? r.pathname : "") + (r.search ? r.search : "")),
          (r.href = r.format()),
          r
        );
      }
      if (!T.length)
        return (
          (r.pathname = null),
          r.search ? (r.path = "/" + r.search) : (r.path = null),
          (r.href = r.format()),
          r
        );
      for (
        var g = T.slice(-1)[0],
          R = ((r.host || t.host || T.length > 1) && ("." === g || ".." === g)) || "" === g,
          b = 0,
          A = T.length;
        A >= 0;
        A--
      )
        "." === (g = T[A])
          ? T.splice(A, 1)
          : ".." === g
          ? (T.splice(A, 1), b++)
          : b && (T.splice(A, 1), b--);
      if (!v && !E) for (; b--; b) T.unshift("..");
      !v || "" === T[0] || (T[0] && "/" === T[0].charAt(0)) || T.unshift(""),
        R && "/" !== T.join("/").substr(-1) && T.push("");
      var x,
        S = "" === T[0] || (T[0] && "/" === T[0].charAt(0));
      y &&
        ((r.hostname = r.host = S ? "" : T.length ? T.shift() : ""),
        (x = !!(r.host && r.host.indexOf("@") > 0) && r.host.split("@")) &&
          ((r.auth = x.shift()), (r.host = r.hostname = x.shift())));
      return (
        (v = v || (r.host && T.length)) && !S && T.unshift(""),
        T.length ? (r.pathname = T.join("/")) : ((r.pathname = null), (r.path = null)),
        (wt.isNull(r.pathname) && wt.isNull(r.search)) ||
          (r.path = (r.pathname ? r.pathname : "") + (r.search ? r.search : "")),
        (r.auth = t.auth || r.auth),
        (r.slashes = r.slashes || t.slashes),
        (r.href = r.format()),
        r
      );
    }),
    (jt.prototype.parseHost = function () {
      var t = this.host,
        e = Wt.exec(t);
      e &&
        (":" !== (e = e[0]) && (this.port = e.substr(1)), (t = t.substr(0, t.length - e.length))),
        t && (this.hostname = t);
    });
  !(function (t) {
    (t[(t.WEBGL_LEGACY = 0)] = "WEBGL_LEGACY"),
      (t[(t.WEBGL = 1)] = "WEBGL"),
      (t[(t.WEBGL2 = 2)] = "WEBGL2");
  })(t.ENV || (t.ENV = {})),
    (function (t) {
      (t[(t.UNKNOWN = 0)] = "UNKNOWN"),
        (t[(t.WEBGL = 1)] = "WEBGL"),
        (t[(t.CANVAS = 2)] = "CANVAS");
    })(t.RENDERER_TYPE || (t.RENDERER_TYPE = {})),
    (function (t) {
      (t[(t.COLOR = 16384)] = "COLOR"),
        (t[(t.DEPTH = 256)] = "DEPTH"),
        (t[(t.STENCIL = 1024)] = "STENCIL");
    })(t.BUFFER_BITS || (t.BUFFER_BITS = {})),
    (function (t) {
      (t[(t.NORMAL = 0)] = "NORMAL"),
        (t[(t.ADD = 1)] = "ADD"),
        (t[(t.MULTIPLY = 2)] = "MULTIPLY"),
        (t[(t.SCREEN = 3)] = "SCREEN"),
        (t[(t.OVERLAY = 4)] = "OVERLAY"),
        (t[(t.DARKEN = 5)] = "DARKEN"),
        (t[(t.LIGHTEN = 6)] = "LIGHTEN"),
        (t[(t.COLOR_DODGE = 7)] = "COLOR_DODGE"),
        (t[(t.COLOR_BURN = 8)] = "COLOR_BURN"),
        (t[(t.HARD_LIGHT = 9)] = "HARD_LIGHT"),
        (t[(t.SOFT_LIGHT = 10)] = "SOFT_LIGHT"),
        (t[(t.DIFFERENCE = 11)] = "DIFFERENCE"),
        (t[(t.EXCLUSION = 12)] = "EXCLUSION"),
        (t[(t.HUE = 13)] = "HUE"),
        (t[(t.SATURATION = 14)] = "SATURATION"),
        (t[(t.COLOR = 15)] = "COLOR"),
        (t[(t.LUMINOSITY = 16)] = "LUMINOSITY"),
        (t[(t.NORMAL_NPM = 17)] = "NORMAL_NPM"),
        (t[(t.ADD_NPM = 18)] = "ADD_NPM"),
        (t[(t.SCREEN_NPM = 19)] = "SCREEN_NPM"),
        (t[(t.NONE = 20)] = "NONE"),
        (t[(t.SRC_OVER = 0)] = "SRC_OVER"),
        (t[(t.SRC_IN = 21)] = "SRC_IN"),
        (t[(t.SRC_OUT = 22)] = "SRC_OUT"),
        (t[(t.SRC_ATOP = 23)] = "SRC_ATOP"),
        (t[(t.DST_OVER = 24)] = "DST_OVER"),
        (t[(t.DST_IN = 25)] = "DST_IN"),
        (t[(t.DST_OUT = 26)] = "DST_OUT"),
        (t[(t.DST_ATOP = 27)] = "DST_ATOP"),
        (t[(t.ERASE = 26)] = "ERASE"),
        (t[(t.SUBTRACT = 28)] = "SUBTRACT"),
        (t[(t.XOR = 29)] = "XOR");
    })(t.BLEND_MODES || (t.BLEND_MODES = {})),
    (function (t) {
      (t[(t.POINTS = 0)] = "POINTS"),
        (t[(t.LINES = 1)] = "LINES"),
        (t[(t.LINE_LOOP = 2)] = "LINE_LOOP"),
        (t[(t.LINE_STRIP = 3)] = "LINE_STRIP"),
        (t[(t.TRIANGLES = 4)] = "TRIANGLES"),
        (t[(t.TRIANGLE_STRIP = 5)] = "TRIANGLE_STRIP"),
        (t[(t.TRIANGLE_FAN = 6)] = "TRIANGLE_FAN");
    })(t.DRAW_MODES || (t.DRAW_MODES = {})),
    (function (t) {
      (t[(t.RGBA = 6408)] = "RGBA"),
        (t[(t.RGB = 6407)] = "RGB"),
        (t[(t.RG = 33319)] = "RG"),
        (t[(t.RED = 6403)] = "RED"),
        (t[(t.RGBA_INTEGER = 36249)] = "RGBA_INTEGER"),
        (t[(t.RGB_INTEGER = 36248)] = "RGB_INTEGER"),
        (t[(t.RG_INTEGER = 33320)] = "RG_INTEGER"),
        (t[(t.RED_INTEGER = 36244)] = "RED_INTEGER"),
        (t[(t.ALPHA = 6406)] = "ALPHA"),
        (t[(t.LUMINANCE = 6409)] = "LUMINANCE"),
        (t[(t.LUMINANCE_ALPHA = 6410)] = "LUMINANCE_ALPHA"),
        (t[(t.DEPTH_COMPONENT = 6402)] = "DEPTH_COMPONENT"),
        (t[(t.DEPTH_STENCIL = 34041)] = "DEPTH_STENCIL");
    })(t.FORMATS || (t.FORMATS = {})),
    (function (t) {
      (t[(t.TEXTURE_2D = 3553)] = "TEXTURE_2D"),
        (t[(t.TEXTURE_CUBE_MAP = 34067)] = "TEXTURE_CUBE_MAP"),
        (t[(t.TEXTURE_2D_ARRAY = 35866)] = "TEXTURE_2D_ARRAY"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_X = 34069)] = "TEXTURE_CUBE_MAP_POSITIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070)] = "TEXTURE_CUBE_MAP_NEGATIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071)] = "TEXTURE_CUBE_MAP_POSITIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072)] = "TEXTURE_CUBE_MAP_NEGATIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073)] = "TEXTURE_CUBE_MAP_POSITIVE_Z"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074)] = "TEXTURE_CUBE_MAP_NEGATIVE_Z");
    })(t.TARGETS || (t.TARGETS = {})),
    (function (t) {
      (t[(t.UNSIGNED_BYTE = 5121)] = "UNSIGNED_BYTE"),
        (t[(t.UNSIGNED_SHORT = 5123)] = "UNSIGNED_SHORT"),
        (t[(t.UNSIGNED_SHORT_5_6_5 = 33635)] = "UNSIGNED_SHORT_5_6_5"),
        (t[(t.UNSIGNED_SHORT_4_4_4_4 = 32819)] = "UNSIGNED_SHORT_4_4_4_4"),
        (t[(t.UNSIGNED_SHORT_5_5_5_1 = 32820)] = "UNSIGNED_SHORT_5_5_5_1"),
        (t[(t.UNSIGNED_INT = 5125)] = "UNSIGNED_INT"),
        (t[(t.UNSIGNED_INT_10F_11F_11F_REV = 35899)] = "UNSIGNED_INT_10F_11F_11F_REV"),
        (t[(t.UNSIGNED_INT_2_10_10_10_REV = 33640)] = "UNSIGNED_INT_2_10_10_10_REV"),
        (t[(t.UNSIGNED_INT_24_8 = 34042)] = "UNSIGNED_INT_24_8"),
        (t[(t.UNSIGNED_INT_5_9_9_9_REV = 35902)] = "UNSIGNED_INT_5_9_9_9_REV"),
        (t[(t.BYTE = 5120)] = "BYTE"),
        (t[(t.SHORT = 5122)] = "SHORT"),
        (t[(t.INT = 5124)] = "INT"),
        (t[(t.FLOAT = 5126)] = "FLOAT"),
        (t[(t.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269)] = "FLOAT_32_UNSIGNED_INT_24_8_REV"),
        (t[(t.HALF_FLOAT = 36193)] = "HALF_FLOAT");
    })(t.TYPES || (t.TYPES = {})),
    (function (t) {
      (t[(t.FLOAT = 0)] = "FLOAT"), (t[(t.INT = 1)] = "INT"), (t[(t.UINT = 2)] = "UINT");
    })(t.SAMPLER_TYPES || (t.SAMPLER_TYPES = {})),
    (function (t) {
      (t[(t.NEAREST = 0)] = "NEAREST"), (t[(t.LINEAR = 1)] = "LINEAR");
    })(t.SCALE_MODES || (t.SCALE_MODES = {})),
    (function (t) {
      (t[(t.CLAMP = 33071)] = "CLAMP"),
        (t[(t.REPEAT = 10497)] = "REPEAT"),
        (t[(t.MIRRORED_REPEAT = 33648)] = "MIRRORED_REPEAT");
    })(t.WRAP_MODES || (t.WRAP_MODES = {})),
    (function (t) {
      (t[(t.OFF = 0)] = "OFF"),
        (t[(t.POW2 = 1)] = "POW2"),
        (t[(t.ON = 2)] = "ON"),
        (t[(t.ON_MANUAL = 3)] = "ON_MANUAL");
    })(t.MIPMAP_MODES || (t.MIPMAP_MODES = {})),
    (function (t) {
      (t[(t.NPM = 0)] = "NPM"),
        (t[(t.UNPACK = 1)] = "UNPACK"),
        (t[(t.PMA = 2)] = "PMA"),
        (t[(t.NO_PREMULTIPLIED_ALPHA = 0)] = "NO_PREMULTIPLIED_ALPHA"),
        (t[(t.PREMULTIPLY_ON_UPLOAD = 1)] = "PREMULTIPLY_ON_UPLOAD"),
        (t[(t.PREMULTIPLY_ALPHA = 2)] = "PREMULTIPLY_ALPHA"),
        (t[(t.PREMULTIPLIED_ALPHA = 2)] = "PREMULTIPLIED_ALPHA");
    })(t.ALPHA_MODES || (t.ALPHA_MODES = {})),
    (function (t) {
      (t[(t.NO = 0)] = "NO"),
        (t[(t.YES = 1)] = "YES"),
        (t[(t.AUTO = 2)] = "AUTO"),
        (t[(t.BLEND = 0)] = "BLEND"),
        (t[(t.CLEAR = 1)] = "CLEAR"),
        (t[(t.BLIT = 2)] = "BLIT");
    })(t.CLEAR_MODES || (t.CLEAR_MODES = {})),
    (function (t) {
      (t[(t.AUTO = 0)] = "AUTO"), (t[(t.MANUAL = 1)] = "MANUAL");
    })(t.GC_MODES || (t.GC_MODES = {})),
    (function (t) {
      (t.LOW = "lowp"), (t.MEDIUM = "mediump"), (t.HIGH = "highp");
    })(t.PRECISION || (t.PRECISION = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.SCISSOR = 1)] = "SCISSOR"),
        (t[(t.STENCIL = 2)] = "STENCIL"),
        (t[(t.SPRITE = 3)] = "SPRITE");
    })(t.MASK_TYPES || (t.MASK_TYPES = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.LOW = 2)] = "LOW"),
        (t[(t.MEDIUM = 4)] = "MEDIUM"),
        (t[(t.HIGH = 8)] = "HIGH");
    })(t.MSAA_QUALITY || (t.MSAA_QUALITY = {})),
    (function (t) {
      (t[(t.ELEMENT_ARRAY_BUFFER = 34963)] = "ELEMENT_ARRAY_BUFFER"),
        (t[(t.ARRAY_BUFFER = 34962)] = "ARRAY_BUFFER"),
        (t[(t.UNIFORM_BUFFER = 35345)] = "UNIFORM_BUFFER");
    })(t.BUFFER_TYPE || (t.BUFFER_TYPE = {}));
  var ne = { parse: kt, format: Yt, resolve: Ht };
  (rt.RETINA_PREFIX = /@([0-9\.]+)x/), (rt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT = !1);
  var oe,
    se = !1,
    ae = "6.3.0";
  function he(t) {
    var e;
    if (!se) {
      if (navigator.userAgent.toLowerCase().indexOf("chrome") > -1) {
        var r = [
          "\n %c %c %c PixiJS " +
            ae +
            " -  " +
            t +
            "   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n",
          "background: #ff66a5; padding:5px 0;",
          "background: #ff66a5; padding:5px 0;",
          "color: #ff66a5; background: #030307; padding:5px 0;",
          "background: #ff66a5; padding:5px 0;",
          "background: #ffc3dc; padding:5px 0;",
          "background: #ff66a5; padding:5px 0;",
          "color: #ff2424; background: #fff; padding:5px 0;",
          "color: #ff2424; background: #fff; padding:5px 0;",
          "color: #ff2424; background: #fff; padding:5px 0;",
        ];
        (e = globalThis.console).log.apply(e, r);
      } else
        globalThis.console &&
          globalThis.console.log("PixiJS " + ae + " - " + t + " - http://www.pixijs.com/");
      se = !0;
    }
  }
  function ue() {
    return (
      void 0 === oe &&
        (oe = (function () {
          var t = {
            stencil: !0,
            failIfMajorPerformanceCaveat: rt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT,
          };
          try {
            if (!globalThis.WebGLRenderingContext) return !1;
            var e = document.createElement("canvas"),
              r = e.getContext("webgl", t) || e.getContext("experimental-webgl", t),
              i = !(!r || !r.getContextAttributes().stencil);
            if (r) {
              var n = r.getExtension("WEBGL_lose_context");
              n && n.loseContext();
            }
            return (r = null), i;
          } catch (t) {
            return !1;
          }
        })()),
      oe
    );
  }
  var le = {
    aliceblue: "#f0f8ff",
    antiquewhite: "#faebd7",
    aqua: "#00ffff",
    aquamarine: "#7fffd4",
    azure: "#f0ffff",
    beige: "#f5f5dc",
    bisque: "#ffe4c4",
    black: "#000000",
    blanchedalmond: "#ffebcd",
    blue: "#0000ff",
    blueviolet: "#8a2be2",
    brown: "#a52a2a",
    burlywood: "#deb887",
    cadetblue: "#5f9ea0",
    chartreuse: "#7fff00",
    chocolate: "#d2691e",
    coral: "#ff7f50",
    cornflowerblue: "#6495ed",
    cornsilk: "#fff8dc",
    crimson: "#dc143c",
    cyan: "#00ffff",
    darkblue: "#00008b",
    darkcyan: "#008b8b",
    darkgoldenrod: "#b8860b",
    darkgray: "#a9a9a9",
    darkgreen: "#006400",
    darkgrey: "#a9a9a9",
    darkkhaki: "#bdb76b",
    darkmagenta: "#8b008b",
    darkolivegreen: "#556b2f",
    darkorange: "#ff8c00",
    darkorchid: "#9932cc",
    darkred: "#8b0000",
    darksalmon: "#e9967a",
    darkseagreen: "#8fbc8f",
    darkslateblue: "#483d8b",
    darkslategray: "#2f4f4f",
    darkslategrey: "#2f4f4f",
    darkturquoise: "#00ced1",
    darkviolet: "#9400d3",
    deeppink: "#ff1493",
    deepskyblue: "#00bfff",
    dimgray: "#696969",
    dimgrey: "#696969",
    dodgerblue: "#1e90ff",
    firebrick: "#b22222",
    floralwhite: "#fffaf0",
    forestgreen: "#228b22",
    fuchsia: "#ff00ff",
    gainsboro: "#dcdcdc",
    ghostwhite: "#f8f8ff",
    goldenrod: "#daa520",
    gold: "#ffd700",
    gray: "#808080",
    green: "#008000",
    greenyellow: "#adff2f",
    grey: "#808080",
    honeydew: "#f0fff0",
    hotpink: "#ff69b4",
    indianred: "#cd5c5c",
    indigo: "#4b0082",
    ivory: "#fffff0",
    khaki: "#f0e68c",
    lavenderblush: "#fff0f5",
    lavender: "#e6e6fa",
    lawngreen: "#7cfc00",
    lemonchiffon: "#fffacd",
    lightblue: "#add8e6",
    lightcoral: "#f08080",
    lightcyan: "#e0ffff",
    lightgoldenrodyellow: "#fafad2",
    lightgray: "#d3d3d3",
    lightgreen: "#90ee90",
    lightgrey: "#d3d3d3",
    lightpink: "#ffb6c1",
    lightsalmon: "#ffa07a",
    lightseagreen: "#20b2aa",
    lightskyblue: "#87cefa",
    lightslategray: "#778899",
    lightslategrey: "#778899",
    lightsteelblue: "#b0c4de",
    lightyellow: "#ffffe0",
    lime: "#00ff00",
    limegreen: "#32cd32",
    linen: "#faf0e6",
    magenta: "#ff00ff",
    maroon: "#800000",
    mediumaquamarine: "#66cdaa",
    mediumblue: "#0000cd",
    mediumorchid: "#ba55d3",
    mediumpurple: "#9370db",
    mediumseagreen: "#3cb371",
    mediumslateblue: "#7b68ee",
    mediumspringgreen: "#00fa9a",
    mediumturquoise: "#48d1cc",
    mediumvioletred: "#c71585",
    midnightblue: "#191970",
    mintcream: "#f5fffa",
    mistyrose: "#ffe4e1",
    moccasin: "#ffe4b5",
    navajowhite: "#ffdead",
    navy: "#000080",
    oldlace: "#fdf5e6",
    olive: "#808000",
    olivedrab: "#6b8e23",
    orange: "#ffa500",
    orangered: "#ff4500",
    orchid: "#da70d6",
    palegoldenrod: "#eee8aa",
    palegreen: "#98fb98",
    paleturquoise: "#afeeee",
    palevioletred: "#db7093",
    papayawhip: "#ffefd5",
    peachpuff: "#ffdab9",
    peru: "#cd853f",
    pink: "#ffc0cb",
    plum: "#dda0dd",
    powderblue: "#b0e0e6",
    purple: "#800080",
    rebeccapurple: "#663399",
    red: "#ff0000",
    rosybrown: "#bc8f8f",
    royalblue: "#4169e1",
    saddlebrown: "#8b4513",
    salmon: "#fa8072",
    sandybrown: "#f4a460",
    seagreen: "#2e8b57",
    seashell: "#fff5ee",
    sienna: "#a0522d",
    silver: "#c0c0c0",
    skyblue: "#87ceeb",
    slateblue: "#6a5acd",
    slategray: "#708090",
    slategrey: "#708090",
    snow: "#fffafa",
    springgreen: "#00ff7f",
    steelblue: "#4682b4",
    tan: "#d2b48c",
    teal: "#008080",
    thistle: "#d8bfd8",
    tomato: "#ff6347",
    turquoise: "#40e0d0",
    violet: "#ee82ee",
    wheat: "#f5deb3",
    white: "#ffffff",
    whitesmoke: "#f5f5f5",
    yellow: "#ffff00",
    yellowgreen: "#9acd32",
  };
  function ce(t, e) {
    return (
      void 0 === e && (e = []),
      (e[0] = ((t >> 16) & 255) / 255),
      (e[1] = ((t >> 8) & 255) / 255),
      (e[2] = (255 & t) / 255),
      e
    );
  }
  function de(t) {
    var e = t.toString(16);
    return "#" + ("000000".substring(0, 6 - e.length) + e);
  }
  function fe(t) {
    return (
      "string" == typeof t && "#" === (t = le[t.toLowerCase()] || t)[0] && (t = t.slice(1)),
      parseInt(t, 16)
    );
  }
  var pe = (function () {
    for (var e = [], r = [], i = 0; i < 32; i++) (e[i] = i), (r[i] = i);
    (e[t.BLEND_MODES.NORMAL_NPM] = t.BLEND_MODES.NORMAL),
      (e[t.BLEND_MODES.ADD_NPM] = t.BLEND_MODES.ADD),
      (e[t.BLEND_MODES.SCREEN_NPM] = t.BLEND_MODES.SCREEN),
      (r[t.BLEND_MODES.NORMAL] = t.BLEND_MODES.NORMAL_NPM),
      (r[t.BLEND_MODES.ADD] = t.BLEND_MODES.ADD_NPM),
      (r[t.BLEND_MODES.SCREEN] = t.BLEND_MODES.SCREEN_NPM);
    var n = [];
    return n.push(r), n.push(e), n;
  })();
  function _e(t, e) {
    return pe[e ? 1 : 0][t];
  }
  function me(t, e, r, i) {
    return (
      (r = r || new Float32Array(4)),
      i || void 0 === i
        ? ((r[0] = t[0] * e), (r[1] = t[1] * e), (r[2] = t[2] * e))
        : ((r[0] = t[0]), (r[1] = t[1]), (r[2] = t[2])),
      (r[3] = e),
      r
    );
  }
  function ve(t, e) {
    if (1 === e) return ((255 * e) << 24) + t;
    if (0 === e) return 0;
    var r = (t >> 16) & 255,
      i = (t >> 8) & 255,
      n = 255 & t;
    return (
      ((255 * e) << 24) +
      ((r = (r * e + 0.5) | 0) << 16) +
      ((i = (i * e + 0.5) | 0) << 8) +
      ((n * e + 0.5) | 0)
    );
  }
  function Ee(t, e, r, i) {
    return (
      ((r = r || new Float32Array(4))[0] = ((t >> 16) & 255) / 255),
      (r[1] = ((t >> 8) & 255) / 255),
      (r[2] = (255 & t) / 255),
      (i || void 0 === i) && ((r[0] *= e), (r[1] *= e), (r[2] *= e)),
      (r[3] = e),
      r
    );
  }
  function Te(t, e) {
    void 0 === e && (e = null);
    var r = 6 * t;
    if ((e = e || new Uint16Array(r)).length !== r)
      throw new Error("Out buffer length is incorrect, got " + e.length + " and expected " + r);
    for (var i = 0, n = 0; i < r; i += 6, n += 4)
      (e[i + 0] = n + 0),
        (e[i + 1] = n + 1),
        (e[i + 2] = n + 2),
        (e[i + 3] = n + 0),
        (e[i + 4] = n + 2),
        (e[i + 5] = n + 3);
    return e;
  }
  function ye(t) {
    if (4 === t.BYTES_PER_ELEMENT)
      return t instanceof Float32Array
        ? "Float32Array"
        : t instanceof Uint32Array
        ? "Uint32Array"
        : "Int32Array";
    if (2 === t.BYTES_PER_ELEMENT) {
      if (t instanceof Uint16Array) return "Uint16Array";
    } else if (1 === t.BYTES_PER_ELEMENT && t instanceof Uint8Array) return "Uint8Array";
    return null;
  }
  var ge = {
    Float32Array: Float32Array,
    Uint32Array: Uint32Array,
    Int32Array: Int32Array,
    Uint8Array: Uint8Array,
  };
  function Re(t) {
    return (
      (t += 0 === t ? 1 : 0),
      --t,
      (t |= t >>> 1),
      (t |= t >>> 2),
      (t |= t >>> 4),
      (t |= t >>> 8),
      1 + (t |= t >>> 16)
    );
  }
  function be(t) {
    return !(t & (t - 1) || !t);
  }
  function Ae(t) {
    var e = (t > 65535 ? 1 : 0) << 4,
      r = ((t >>>= e) > 255 ? 1 : 0) << 3;
    return (
      (e |= r),
      (e |= r = ((t >>>= r) > 15 ? 1 : 0) << 2),
      (e |= r = ((t >>>= r) > 3 ? 1 : 0) << 1) | ((t >>>= r) >> 1)
    );
  }
  function xe(t, e, r) {
    var i,
      n = t.length;
    if (!(e >= n || 0 === r)) {
      var o = n - (r = e + r > n ? n - e : r);
      for (i = e; i < o; ++i) t[i] = t[i + r];
      t.length = o;
    }
  }
  function Se(t) {
    return 0 === t ? 0 : t < 0 ? -1 : 1;
  }
  var Oe = 0;
  function Ie() {
    return ++Oe;
  }
  var Pe = {};
  var Me = {},
    Ne = Object.create(null),
    De = Object.create(null);
  var Ce = (function () {
    function t(t, e, r) {
      (this.canvas = document.createElement("canvas")),
        (this.context = this.canvas.getContext("2d")),
        (this.resolution = r || rt.RESOLUTION),
        this.resize(t, e);
    }
    return (
      (t.prototype.clear = function () {
        this.context.setTransform(1, 0, 0, 1, 0, 0),
          this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
      }),
      (t.prototype.resize = function (t, e) {
        (this.canvas.width = Math.round(t * this.resolution)),
          (this.canvas.height = Math.round(e * this.resolution));
      }),
      (t.prototype.destroy = function () {
        (this.context = null), (this.canvas = null);
      }),
      Object.defineProperty(t.prototype, "width", {
        get: function () {
          return this.canvas.width;
        },
        set: function (t) {
          this.canvas.width = Math.round(t);
        },
        enumerable: !1,
        configurable: !0,
      }),
      Object.defineProperty(t.prototype, "height", {
        get: function () {
          return this.canvas.height;
        },
        set: function (t) {
          this.canvas.height = Math.round(t);
        },
        enumerable: !1,
        configurable: !0,
      }),
      t
    );
  })();
  function Le(t) {
    var e,
      r,
      i,
      n = t.width,
      o = t.height,
      s = t.getContext("2d"),
      a = s.getImageData(0, 0, n, o).data,
      h = a.length,
      u = { top: null, left: null, right: null, bottom: null },
      l = null;
    for (e = 0; e < h; e += 4)
      0 !== a[e + 3] &&
        ((r = (e / 4) % n),
        (i = ~~(e / 4 / n)),
        null === u.top && (u.top = i),
        null === u.left ? (u.left = r) : r < u.left && (u.left = r),
        null === u.right ? (u.right = r + 1) : u.right < r && (u.right = r + 1),
        null === u.bottom ? (u.bottom = i) : u.bottom < i && (u.bottom = i));
    return (
      null !== u.top &&
        ((n = u.right - u.left),
        (o = u.bottom - u.top + 1),
        (l = s.getImageData(u.left, u.top, n, o))),
      { height: o, width: n, data: l }
    );
  }
  var we,
    Fe = /^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;
  function Ue(t, e) {
    if ((void 0 === e && (e = globalThis.location), 0 === t.indexOf("data:"))) return "";
    (e = e || globalThis.location), we || (we = document.createElement("a")), (we.href = t);
    var r = ne.parse(we.href),
      i = (!r.port && "" === e.port) || r.port === e.port;
    return r.hostname === e.hostname && i && r.protocol === e.protocol ? "" : "anonymous";
  }
  function Be(t, e) {
    var r = rt.RETINA_PREFIX.exec(t);
    return r ? parseFloat(r[1]) : void 0 !== e ? e : 1;
  }
  var Ge = {
      __proto__: null,
      BaseTextureCache: De,
      CanvasRenderTarget: Ce,
      DATA_URI: Fe,
      ProgramCache: Me,
      TextureCache: Ne,
      clearTextureCache: function () {
        var t;
        for (t in Ne) delete Ne[t];
        for (t in De) delete De[t];
      },
      correctBlendMode: _e,
      createIndicesForQuads: Te,
      decomposeDataUri: function (t) {
        var e = Fe.exec(t);
        if (e)
          return {
            mediaType: e[1] ? e[1].toLowerCase() : void 0,
            subType: e[2] ? e[2].toLowerCase() : void 0,
            charset: e[3] ? e[3].toLowerCase() : void 0,
            encoding: e[4] ? e[4].toLowerCase() : void 0,
            data: e[5],
          };
      },
      deprecation: function (t, e, r) {
        if ((void 0 === r && (r = 3), !Pe[e])) {
          var i = new Error().stack;
          void 0 === i
            ? console.warn("PixiJS Deprecation Warning: ", e + "\nDeprecated since v" + t)
            : ((i = i.split("\n").splice(r).join("\n")),
              console.groupCollapsed
                ? (console.groupCollapsed(
                    "%cPixiJS Deprecation Warning: %c%s",
                    "color:#614108;background:#fffbe6",
                    "font-weight:normal;color:#614108;background:#fffbe6",
                    e + "\nDeprecated since v" + t
                  ),
                  console.warn(i),
                  console.groupEnd())
                : (console.warn("PixiJS Deprecation Warning: ", e + "\nDeprecated since v" + t),
                  console.warn(i))),
            (Pe[e] = !0);
        }
      },
      destroyTextureCache: function () {
        var t;
        for (t in Ne) Ne[t].destroy();
        for (t in De) De[t].destroy();
      },
      determineCrossOrigin: Ue,
      getBufferType: ye,
      getResolutionOfUrl: Be,
      hex2rgb: ce,
      hex2string: de,
      interleaveTypedArrays: function (t, e) {
        for (var r = 0, i = 0, n = {}, o = 0; o < t.length; o++) (i += e[o]), (r += t[o].length);
        var s = new ArrayBuffer(4 * r),
          a = null,
          h = 0;
        for (o = 0; o < t.length; o++) {
          var u = e[o],
            l = t[o],
            c = ye(l);
          n[c] || (n[c] = new ge[c](s)), (a = n[c]);
          for (var d = 0; d < l.length; d++) a[((d / u) | 0) * i + h + (d % u)] = l[d];
          h += u;
        }
        return new Float32Array(s);
      },
      isPow2: be,
      isWebGLSupported: ue,
      log2: Ae,
      nextPow2: Re,
      premultiplyBlendMode: pe,
      premultiplyRgba: me,
      premultiplyTint: ve,
      premultiplyTintToRgba: Ee,
      removeItems: xe,
      rgb2hex: function (t) {
        return ((255 * t[0]) << 16) + ((255 * t[1]) << 8) + ((255 * t[2]) | 0);
      },
      sayHello: he,
      sign: Se,
      skipHello: function () {
        se = !0;
      },
      string2hex: fe,
      trimCanvas: Le,
      uid: Ie,
      url: ne,
      isMobile: et,
      EventEmitter: ot,
      earcut: st,
    },
    Xe = 2 * Math.PI,
    ke = 180 / Math.PI,
    He = Math.PI / 180;
  !(function (t) {
    (t[(t.POLY = 0)] = "POLY"),
      (t[(t.RECT = 1)] = "RECT"),
      (t[(t.CIRC = 2)] = "CIRC"),
      (t[(t.ELIP = 3)] = "ELIP"),
      (t[(t.RREC = 4)] = "RREC");
  })(t.SHAPES || (t.SHAPES = {}));
  var Ye = (function () {
      function t(t, e) {
        void 0 === t && (t = 0),
          void 0 === e && (e = 0),
          (this.x = 0),
          (this.y = 0),
          (this.x = t),
          (this.y = e);
      }
      return (
        (t.prototype.clone = function () {
          return new t(this.x, this.y);
        }),
        (t.prototype.copyFrom = function (t) {
          return this.set(t.x, t.y), this;
        }),
        (t.prototype.copyTo = function (t) {
          return t.set(this.x, this.y), t;
        }),
        (t.prototype.equals = function (t) {
          return t.x === this.x && t.y === this.y;
        }),
        (t.prototype.set = function (t, e) {
          return void 0 === t && (t = 0), void 0 === e && (e = t), (this.x = t), (this.y = e), this;
        }),
        t
      );
    })(),
    je = [new Ye(), new Ye(), new Ye(), new Ye()],
    Ve = (function () {
      function e(e, r, i, n) {
        void 0 === e && (e = 0),
          void 0 === r && (r = 0),
          void 0 === i && (i = 0),
          void 0 === n && (n = 0),
          (this.x = Number(e)),
          (this.y = Number(r)),
          (this.width = Number(i)),
          (this.height = Number(n)),
          (this.type = t.SHAPES.RECT);
      }
      return (
        Object.defineProperty(e.prototype, "left", {
          get: function () {
            return this.x;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "right", {
          get: function () {
            return this.x + this.width;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "top", {
          get: function () {
            return this.y;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "bottom", {
          get: function () {
            return this.y + this.height;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e, "EMPTY", {
          get: function () {
            return new e(0, 0, 0, 0);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.clone = function () {
          return new e(this.x, this.y, this.width, this.height);
        }),
        (e.prototype.copyFrom = function (t) {
          return (
            (this.x = t.x), (this.y = t.y), (this.width = t.width), (this.height = t.height), this
          );
        }),
        (e.prototype.copyTo = function (t) {
          return (
            (t.x = this.x), (t.y = this.y), (t.width = this.width), (t.height = this.height), t
          );
        }),
        (e.prototype.contains = function (t, e) {
          return (
            !(this.width <= 0 || this.height <= 0) &&
            t >= this.x &&
            t < this.x + this.width &&
            e >= this.y &&
            e < this.y + this.height
          );
        }),
        (e.prototype.intersects = function (t, e) {
          if (!e) {
            var r = this.x < t.x ? t.x : this.x;
            if ((this.right > t.right ? t.right : this.right) <= r) return !1;
            var i = this.y < t.y ? t.y : this.y;
            return (this.bottom > t.bottom ? t.bottom : this.bottom) > i;
          }
          var n = this.left,
            o = this.right,
            s = this.top,
            a = this.bottom;
          if (o <= n || a <= s) return !1;
          var h = je[0].set(t.left, t.top),
            u = je[1].set(t.left, t.bottom),
            l = je[2].set(t.right, t.top),
            c = je[3].set(t.right, t.bottom);
          if (l.x <= h.x || u.y <= h.y) return !1;
          var d = Math.sign(e.a * e.d - e.b * e.c);
          if (0 === d) return !1;
          if (
            (e.apply(h, h),
            e.apply(u, u),
            e.apply(l, l),
            e.apply(c, c),
            Math.max(h.x, u.x, l.x, c.x) <= n ||
              Math.min(h.x, u.x, l.x, c.x) >= o ||
              Math.max(h.y, u.y, l.y, c.y) <= s ||
              Math.min(h.y, u.y, l.y, c.y) >= a)
          )
            return !1;
          var f = d * (u.y - h.y),
            p = d * (h.x - u.x),
            _ = f * n + p * s,
            m = f * o + p * s,
            v = f * n + p * a,
            E = f * o + p * a;
          if (
            Math.max(_, m, v, E) <= f * h.x + p * h.y ||
            Math.min(_, m, v, E) >= f * c.x + p * c.y
          )
            return !1;
          var T = d * (h.y - l.y),
            y = d * (l.x - h.x),
            g = T * n + y * s,
            R = T * o + y * s,
            b = T * n + y * a,
            A = T * o + y * a;
          return !(
            Math.max(g, R, b, A) <= T * h.x + y * h.y || Math.min(g, R, b, A) >= T * c.x + y * c.y
          );
        }),
        (e.prototype.pad = function (t, e) {
          return (
            void 0 === t && (t = 0),
            void 0 === e && (e = t),
            (this.x -= t),
            (this.y -= e),
            (this.width += 2 * t),
            (this.height += 2 * e),
            this
          );
        }),
        (e.prototype.fit = function (t) {
          var e = Math.max(this.x, t.x),
            r = Math.min(this.x + this.width, t.x + t.width),
            i = Math.max(this.y, t.y),
            n = Math.min(this.y + this.height, t.y + t.height);
          return (
            (this.x = e),
            (this.width = Math.max(r - e, 0)),
            (this.y = i),
            (this.height = Math.max(n - i, 0)),
            this
          );
        }),
        (e.prototype.ceil = function (t, e) {
          void 0 === t && (t = 1), void 0 === e && (e = 0.001);
          var r = Math.ceil((this.x + this.width - e) * t) / t,
            i = Math.ceil((this.y + this.height - e) * t) / t;
          return (
            (this.x = Math.floor((this.x + e) * t) / t),
            (this.y = Math.floor((this.y + e) * t) / t),
            (this.width = r - this.x),
            (this.height = i - this.y),
            this
          );
        }),
        (e.prototype.enlarge = function (t) {
          var e = Math.min(this.x, t.x),
            r = Math.max(this.x + this.width, t.x + t.width),
            i = Math.min(this.y, t.y),
            n = Math.max(this.y + this.height, t.y + t.height);
          return (this.x = e), (this.width = r - e), (this.y = i), (this.height = n - i), this;
        }),
        e
      );
    })(),
    We = (function () {
      function e(e, r, i) {
        void 0 === e && (e = 0),
          void 0 === r && (r = 0),
          void 0 === i && (i = 0),
          (this.x = e),
          (this.y = r),
          (this.radius = i),
          (this.type = t.SHAPES.CIRC);
      }
      return (
        (e.prototype.clone = function () {
          return new e(this.x, this.y, this.radius);
        }),
        (e.prototype.contains = function (t, e) {
          if (this.radius <= 0) return !1;
          var r = this.radius * this.radius,
            i = this.x - t,
            n = this.y - e;
          return (i *= i) + (n *= n) <= r;
        }),
        (e.prototype.getBounds = function () {
          return new Ve(
            this.x - this.radius,
            this.y - this.radius,
            2 * this.radius,
            2 * this.radius
          );
        }),
        e
      );
    })(),
    ze = (function () {
      function e(e, r, i, n) {
        void 0 === e && (e = 0),
          void 0 === r && (r = 0),
          void 0 === i && (i = 0),
          void 0 === n && (n = 0),
          (this.x = e),
          (this.y = r),
          (this.width = i),
          (this.height = n),
          (this.type = t.SHAPES.ELIP);
      }
      return (
        (e.prototype.clone = function () {
          return new e(this.x, this.y, this.width, this.height);
        }),
        (e.prototype.contains = function (t, e) {
          if (this.width <= 0 || this.height <= 0) return !1;
          var r = (t - this.x) / this.width,
            i = (e - this.y) / this.height;
          return (r *= r) + (i *= i) <= 1;
        }),
        (e.prototype.getBounds = function () {
          return new Ve(this.x - this.width, this.y - this.height, this.width, this.height);
        }),
        e
      );
    })(),
    qe = (function () {
      function e() {
        for (var e = arguments, r = [], i = 0; i < arguments.length; i++) r[i] = e[i];
        var n = Array.isArray(r[0]) ? r[0] : r;
        if ("number" != typeof n[0]) {
          for (var o = [], s = 0, a = n.length; s < a; s++) o.push(n[s].x, n[s].y);
          n = o;
        }
        (this.points = n), (this.type = t.SHAPES.POLY), (this.closeStroke = !0);
      }
      return (
        (e.prototype.clone = function () {
          var t = new e(this.points.slice());
          return (t.closeStroke = this.closeStroke), t;
        }),
        (e.prototype.contains = function (t, e) {
          for (var r = !1, i = this.points.length / 2, n = 0, o = i - 1; n < i; o = n++) {
            var s = this.points[2 * n],
              a = this.points[2 * n + 1],
              h = this.points[2 * o],
              u = this.points[2 * o + 1];
            a > e != u > e && t < ((e - a) / (u - a)) * (h - s) + s && (r = !r);
          }
          return r;
        }),
        e
      );
    })(),
    Ke = (function () {
      function e(e, r, i, n, o) {
        void 0 === e && (e = 0),
          void 0 === r && (r = 0),
          void 0 === i && (i = 0),
          void 0 === n && (n = 0),
          void 0 === o && (o = 20),
          (this.x = e),
          (this.y = r),
          (this.width = i),
          (this.height = n),
          (this.radius = o),
          (this.type = t.SHAPES.RREC);
      }
      return (
        (e.prototype.clone = function () {
          return new e(this.x, this.y, this.width, this.height, this.radius);
        }),
        (e.prototype.contains = function (t, e) {
          if (this.width <= 0 || this.height <= 0) return !1;
          if (t >= this.x && t <= this.x + this.width && e >= this.y && e <= this.y + this.height) {
            var r = Math.max(0, Math.min(this.radius, Math.min(this.width, this.height) / 2));
            if (
              (e >= this.y + r && e <= this.y + this.height - r) ||
              (t >= this.x + r && t <= this.x + this.width - r)
            )
              return !0;
            var i = t - (this.x + r),
              n = e - (this.y + r),
              o = r * r;
            if (i * i + n * n <= o) return !0;
            if ((i = t - (this.x + this.width - r)) * i + n * n <= o) return !0;
            if (i * i + (n = e - (this.y + this.height - r)) * n <= o) return !0;
            if ((i = t - (this.x + r)) * i + n * n <= o) return !0;
          }
          return !1;
        }),
        e
      );
    })(),
    Ze = (function () {
      function t(t, e, r, i) {
        void 0 === r && (r = 0),
          void 0 === i && (i = 0),
          (this._x = r),
          (this._y = i),
          (this.cb = t),
          (this.scope = e);
      }
      return (
        (t.prototype.clone = function (e, r) {
          return (
            void 0 === e && (e = this.cb),
            void 0 === r && (r = this.scope),
            new t(e, r, this._x, this._y)
          );
        }),
        (t.prototype.set = function (t, e) {
          return (
            void 0 === t && (t = 0),
            void 0 === e && (e = t),
            (this._x === t && this._y === e) ||
              ((this._x = t), (this._y = e), this.cb.call(this.scope)),
            this
          );
        }),
        (t.prototype.copyFrom = function (t) {
          return (
            (this._x === t.x && this._y === t.y) ||
              ((this._x = t.x), (this._y = t.y), this.cb.call(this.scope)),
            this
          );
        }),
        (t.prototype.copyTo = function (t) {
          return t.set(this._x, this._y), t;
        }),
        (t.prototype.equals = function (t) {
          return t.x === this._x && t.y === this._y;
        }),
        Object.defineProperty(t.prototype, "x", {
          get: function () {
            return this._x;
          },
          set: function (t) {
            this._x !== t && ((this._x = t), this.cb.call(this.scope));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "y", {
          get: function () {
            return this._y;
          },
          set: function (t) {
            this._y !== t && ((this._y = t), this.cb.call(this.scope));
          },
          enumerable: !1,
          configurable: !0,
        }),
        t
      );
    })(),
    Qe = (function () {
      function t(t, e, r, i, n, o) {
        void 0 === t && (t = 1),
          void 0 === e && (e = 0),
          void 0 === r && (r = 0),
          void 0 === i && (i = 1),
          void 0 === n && (n = 0),
          void 0 === o && (o = 0),
          (this.array = null),
          (this.a = t),
          (this.b = e),
          (this.c = r),
          (this.d = i),
          (this.tx = n),
          (this.ty = o);
      }
      return (
        (t.prototype.fromArray = function (t) {
          (this.a = t[0]),
            (this.b = t[1]),
            (this.c = t[3]),
            (this.d = t[4]),
            (this.tx = t[2]),
            (this.ty = t[5]);
        }),
        (t.prototype.set = function (t, e, r, i, n, o) {
          return (
            (this.a = t),
            (this.b = e),
            (this.c = r),
            (this.d = i),
            (this.tx = n),
            (this.ty = o),
            this
          );
        }),
        (t.prototype.toArray = function (t, e) {
          this.array || (this.array = new Float32Array(9));
          var r = e || this.array;
          return (
            t
              ? ((r[0] = this.a),
                (r[1] = this.b),
                (r[2] = 0),
                (r[3] = this.c),
                (r[4] = this.d),
                (r[5] = 0),
                (r[6] = this.tx),
                (r[7] = this.ty),
                (r[8] = 1))
              : ((r[0] = this.a),
                (r[1] = this.c),
                (r[2] = this.tx),
                (r[3] = this.b),
                (r[4] = this.d),
                (r[5] = this.ty),
                (r[6] = 0),
                (r[7] = 0),
                (r[8] = 1)),
            r
          );
        }),
        (t.prototype.apply = function (t, e) {
          e = e || new Ye();
          var r = t.x,
            i = t.y;
          return (
            (e.x = this.a * r + this.c * i + this.tx), (e.y = this.b * r + this.d * i + this.ty), e
          );
        }),
        (t.prototype.applyInverse = function (t, e) {
          e = e || new Ye();
          var r = 1 / (this.a * this.d + this.c * -this.b),
            i = t.x,
            n = t.y;
          return (
            (e.x = this.d * r * i + -this.c * r * n + (this.ty * this.c - this.tx * this.d) * r),
            (e.y = this.a * r * n + -this.b * r * i + (-this.ty * this.a + this.tx * this.b) * r),
            e
          );
        }),
        (t.prototype.translate = function (t, e) {
          return (this.tx += t), (this.ty += e), this;
        }),
        (t.prototype.scale = function (t, e) {
          return (
            (this.a *= t),
            (this.d *= e),
            (this.c *= t),
            (this.b *= e),
            (this.tx *= t),
            (this.ty *= e),
            this
          );
        }),
        (t.prototype.rotate = function (t) {
          var e = Math.cos(t),
            r = Math.sin(t),
            i = this.a,
            n = this.c,
            o = this.tx;
          return (
            (this.a = i * e - this.b * r),
            (this.b = i * r + this.b * e),
            (this.c = n * e - this.d * r),
            (this.d = n * r + this.d * e),
            (this.tx = o * e - this.ty * r),
            (this.ty = o * r + this.ty * e),
            this
          );
        }),
        (t.prototype.append = function (t) {
          var e = this.a,
            r = this.b,
            i = this.c,
            n = this.d;
          return (
            (this.a = t.a * e + t.b * i),
            (this.b = t.a * r + t.b * n),
            (this.c = t.c * e + t.d * i),
            (this.d = t.c * r + t.d * n),
            (this.tx = t.tx * e + t.ty * i + this.tx),
            (this.ty = t.tx * r + t.ty * n + this.ty),
            this
          );
        }),
        (t.prototype.setTransform = function (t, e, r, i, n, o, s, a, h) {
          return (
            (this.a = Math.cos(s + h) * n),
            (this.b = Math.sin(s + h) * n),
            (this.c = -Math.sin(s - a) * o),
            (this.d = Math.cos(s - a) * o),
            (this.tx = t - (r * this.a + i * this.c)),
            (this.ty = e - (r * this.b + i * this.d)),
            this
          );
        }),
        (t.prototype.prepend = function (t) {
          var e = this.tx;
          if (1 !== t.a || 0 !== t.b || 0 !== t.c || 1 !== t.d) {
            var r = this.a,
              i = this.c;
            (this.a = r * t.a + this.b * t.c),
              (this.b = r * t.b + this.b * t.d),
              (this.c = i * t.a + this.d * t.c),
              (this.d = i * t.b + this.d * t.d);
          }
          return (
            (this.tx = e * t.a + this.ty * t.c + t.tx),
            (this.ty = e * t.b + this.ty * t.d + t.ty),
            this
          );
        }),
        (t.prototype.decompose = function (t) {
          var e = this.a,
            r = this.b,
            i = this.c,
            n = this.d,
            o = t.pivot,
            s = -Math.atan2(-i, n),
            a = Math.atan2(r, e),
            h = Math.abs(s + a);
          return (
            h < 1e-5 || Math.abs(Xe - h) < 1e-5
              ? ((t.rotation = a), (t.skew.x = t.skew.y = 0))
              : ((t.rotation = 0), (t.skew.x = s), (t.skew.y = a)),
            (t.scale.x = Math.sqrt(e * e + r * r)),
            (t.scale.y = Math.sqrt(i * i + n * n)),
            (t.position.x = this.tx + (o.x * e + o.y * i)),
            (t.position.y = this.ty + (o.x * r + o.y * n)),
            t
          );
        }),
        (t.prototype.invert = function () {
          var t = this.a,
            e = this.b,
            r = this.c,
            i = this.d,
            n = this.tx,
            o = t * i - e * r;
          return (
            (this.a = i / o),
            (this.b = -e / o),
            (this.c = -r / o),
            (this.d = t / o),
            (this.tx = (r * this.ty - i * n) / o),
            (this.ty = -(t * this.ty - e * n) / o),
            this
          );
        }),
        (t.prototype.identity = function () {
          return (
            (this.a = 1),
            (this.b = 0),
            (this.c = 0),
            (this.d = 1),
            (this.tx = 0),
            (this.ty = 0),
            this
          );
        }),
        (t.prototype.clone = function () {
          var e = new t();
          return (
            (e.a = this.a),
            (e.b = this.b),
            (e.c = this.c),
            (e.d = this.d),
            (e.tx = this.tx),
            (e.ty = this.ty),
            e
          );
        }),
        (t.prototype.copyTo = function (t) {
          return (
            (t.a = this.a),
            (t.b = this.b),
            (t.c = this.c),
            (t.d = this.d),
            (t.tx = this.tx),
            (t.ty = this.ty),
            t
          );
        }),
        (t.prototype.copyFrom = function (t) {
          return (
            (this.a = t.a),
            (this.b = t.b),
            (this.c = t.c),
            (this.d = t.d),
            (this.tx = t.tx),
            (this.ty = t.ty),
            this
          );
        }),
        Object.defineProperty(t, "IDENTITY", {
          get: function () {
            return new t();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t, "TEMP_MATRIX", {
          get: function () {
            return new t();
          },
          enumerable: !1,
          configurable: !0,
        }),
        t
      );
    })(),
    Je = [1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1],
    $e = [0, 1, 1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1],
    tr = [0, -1, -1, -1, 0, 1, 1, 1, 0, 1, 1, 1, 0, -1, -1, -1],
    er = [1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, 1, 1, 1, 0, -1],
    rr = [],
    ir = [],
    nr = Math.sign;
  !(function () {
    for (var t = 0; t < 16; t++) {
      var e = [];
      rr.push(e);
      for (var r = 0; r < 16; r++)
        for (
          var i = nr(Je[t] * Je[r] + tr[t] * $e[r]),
            n = nr($e[t] * Je[r] + er[t] * $e[r]),
            o = nr(Je[t] * tr[r] + tr[t] * er[r]),
            s = nr($e[t] * tr[r] + er[t] * er[r]),
            a = 0;
          a < 16;
          a++
        )
          if (Je[a] === i && $e[a] === n && tr[a] === o && er[a] === s) {
            e.push(a);
            break;
          }
    }
    for (t = 0; t < 16; t++) {
      var h = new Qe();
      h.set(Je[t], $e[t], tr[t], er[t], 0, 0), ir.push(h);
    }
  })();
  var or = {
      E: 0,
      SE: 1,
      S: 2,
      SW: 3,
      W: 4,
      NW: 5,
      N: 6,
      NE: 7,
      MIRROR_VERTICAL: 8,
      MAIN_DIAGONAL: 10,
      MIRROR_HORIZONTAL: 12,
      REVERSE_DIAGONAL: 14,
      uX: function (t) {
        return Je[t];
      },
      uY: function (t) {
        return $e[t];
      },
      vX: function (t) {
        return tr[t];
      },
      vY: function (t) {
        return er[t];
      },
      inv: function (t) {
        return 8 & t ? 15 & t : 7 & -t;
      },
      add: function (t, e) {
        return rr[t][e];
      },
      sub: function (t, e) {
        return rr[t][or.inv(e)];
      },
      rotate180: function (t) {
        return 4 ^ t;
      },
      isVertical: function (t) {
        return 2 == (3 & t);
      },
      byDirection: function (t, e) {
        return 2 * Math.abs(t) <= Math.abs(e)
          ? e >= 0
            ? or.S
            : or.N
          : 2 * Math.abs(e) <= Math.abs(t)
          ? t > 0
            ? or.E
            : or.W
          : e > 0
          ? t > 0
            ? or.SE
            : or.SW
          : t > 0
          ? or.NE
          : or.NW;
      },
      matrixAppendRotationInv: function (t, e, r, i) {
        void 0 === r && (r = 0), void 0 === i && (i = 0);
        var n = ir[or.inv(e)];
        (n.tx = r), (n.ty = i), t.append(n);
      },
    },
    sr = (function () {
      function t() {
        (this.worldTransform = new Qe()),
          (this.localTransform = new Qe()),
          (this.position = new Ze(this.onChange, this, 0, 0)),
          (this.scale = new Ze(this.onChange, this, 1, 1)),
          (this.pivot = new Ze(this.onChange, this, 0, 0)),
          (this.skew = new Ze(this.updateSkew, this, 0, 0)),
          (this._rotation = 0),
          (this._cx = 1),
          (this._sx = 0),
          (this._cy = 0),
          (this._sy = 1),
          (this._localID = 0),
          (this._currentLocalID = 0),
          (this._worldID = 0),
          (this._parentID = 0);
      }
      return (
        (t.prototype.onChange = function () {
          this._localID++;
        }),
        (t.prototype.updateSkew = function () {
          (this._cx = Math.cos(this._rotation + this.skew.y)),
            (this._sx = Math.sin(this._rotation + this.skew.y)),
            (this._cy = -Math.sin(this._rotation - this.skew.x)),
            (this._sy = Math.cos(this._rotation - this.skew.x)),
            this._localID++;
        }),
        (t.prototype.updateLocalTransform = function () {
          var t = this.localTransform;
          this._localID !== this._currentLocalID &&
            ((t.a = this._cx * this.scale.x),
            (t.b = this._sx * this.scale.x),
            (t.c = this._cy * this.scale.y),
            (t.d = this._sy * this.scale.y),
            (t.tx = this.position.x - (this.pivot.x * t.a + this.pivot.y * t.c)),
            (t.ty = this.position.y - (this.pivot.x * t.b + this.pivot.y * t.d)),
            (this._currentLocalID = this._localID),
            (this._parentID = -1));
        }),
        (t.prototype.updateTransform = function (t) {
          var e = this.localTransform;
          if (
            (this._localID !== this._currentLocalID &&
              ((e.a = this._cx * this.scale.x),
              (e.b = this._sx * this.scale.x),
              (e.c = this._cy * this.scale.y),
              (e.d = this._sy * this.scale.y),
              (e.tx = this.position.x - (this.pivot.x * e.a + this.pivot.y * e.c)),
              (e.ty = this.position.y - (this.pivot.x * e.b + this.pivot.y * e.d)),
              (this._currentLocalID = this._localID),
              (this._parentID = -1)),
            this._parentID !== t._worldID)
          ) {
            var r = t.worldTransform,
              i = this.worldTransform;
            (i.a = e.a * r.a + e.b * r.c),
              (i.b = e.a * r.b + e.b * r.d),
              (i.c = e.c * r.a + e.d * r.c),
              (i.d = e.c * r.b + e.d * r.d),
              (i.tx = e.tx * r.a + e.ty * r.c + r.tx),
              (i.ty = e.tx * r.b + e.ty * r.d + r.ty),
              (this._parentID = t._worldID),
              this._worldID++;
          }
        }),
        (t.prototype.setFromMatrix = function (t) {
          t.decompose(this), this._localID++;
        }),
        Object.defineProperty(t.prototype, "rotation", {
          get: function () {
            return this._rotation;
          },
          set: function (t) {
            this._rotation !== t && ((this._rotation = t), this.updateSkew());
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.IDENTITY = new t()),
        t
      );
    })();
  rt.SORTABLE_CHILDREN = !1;
  var ar = (function () {
      function t() {
        (this.minX = 1 / 0),
          (this.minY = 1 / 0),
          (this.maxX = -1 / 0),
          (this.maxY = -1 / 0),
          (this.rect = null),
          (this.updateID = -1);
      }
      return (
        (t.prototype.isEmpty = function () {
          return this.minX > this.maxX || this.minY > this.maxY;
        }),
        (t.prototype.clear = function () {
          (this.minX = 1 / 0), (this.minY = 1 / 0), (this.maxX = -1 / 0), (this.maxY = -1 / 0);
        }),
        (t.prototype.getRectangle = function (t) {
          return this.minX > this.maxX || this.minY > this.maxY
            ? Ve.EMPTY
            : (((t = t || new Ve(0, 0, 1, 1)).x = this.minX),
              (t.y = this.minY),
              (t.width = this.maxX - this.minX),
              (t.height = this.maxY - this.minY),
              t);
        }),
        (t.prototype.addPoint = function (t) {
          (this.minX = Math.min(this.minX, t.x)),
            (this.maxX = Math.max(this.maxX, t.x)),
            (this.minY = Math.min(this.minY, t.y)),
            (this.maxY = Math.max(this.maxY, t.y));
        }),
        (t.prototype.addPointMatrix = function (t, e) {
          var r = t.a,
            i = t.b,
            n = t.c,
            o = t.d,
            s = t.tx,
            a = t.ty,
            h = r * e.x + n * e.y + s,
            u = i * e.x + o * e.y + a;
          (this.minX = Math.min(this.minX, h)),
            (this.maxX = Math.max(this.maxX, h)),
            (this.minY = Math.min(this.minY, u)),
            (this.maxY = Math.max(this.maxY, u));
        }),
        (t.prototype.addQuad = function (t) {
          var e = this.minX,
            r = this.minY,
            i = this.maxX,
            n = this.maxY,
            o = t[0],
            s = t[1];
          (e = o < e ? o : e),
            (r = s < r ? s : r),
            (i = o > i ? o : i),
            (n = s > n ? s : n),
            (e = (o = t[2]) < e ? o : e),
            (r = (s = t[3]) < r ? s : r),
            (i = o > i ? o : i),
            (n = s > n ? s : n),
            (e = (o = t[4]) < e ? o : e),
            (r = (s = t[5]) < r ? s : r),
            (i = o > i ? o : i),
            (n = s > n ? s : n),
            (e = (o = t[6]) < e ? o : e),
            (r = (s = t[7]) < r ? s : r),
            (i = o > i ? o : i),
            (n = s > n ? s : n),
            (this.minX = e),
            (this.minY = r),
            (this.maxX = i),
            (this.maxY = n);
        }),
        (t.prototype.addFrame = function (t, e, r, i, n) {
          this.addFrameMatrix(t.worldTransform, e, r, i, n);
        }),
        (t.prototype.addFrameMatrix = function (t, e, r, i, n) {
          var o = t.a,
            s = t.b,
            a = t.c,
            h = t.d,
            u = t.tx,
            l = t.ty,
            c = this.minX,
            d = this.minY,
            f = this.maxX,
            p = this.maxY,
            _ = o * e + a * r + u,
            m = s * e + h * r + l;
          (c = _ < c ? _ : c),
            (d = m < d ? m : d),
            (f = _ > f ? _ : f),
            (p = m > p ? m : p),
            (c = (_ = o * i + a * r + u) < c ? _ : c),
            (d = (m = s * i + h * r + l) < d ? m : d),
            (f = _ > f ? _ : f),
            (p = m > p ? m : p),
            (c = (_ = o * e + a * n + u) < c ? _ : c),
            (d = (m = s * e + h * n + l) < d ? m : d),
            (f = _ > f ? _ : f),
            (p = m > p ? m : p),
            (c = (_ = o * i + a * n + u) < c ? _ : c),
            (d = (m = s * i + h * n + l) < d ? m : d),
            (f = _ > f ? _ : f),
            (p = m > p ? m : p),
            (this.minX = c),
            (this.minY = d),
            (this.maxX = f),
            (this.maxY = p);
        }),
        (t.prototype.addVertexData = function (t, e, r) {
          for (
            var i = this.minX, n = this.minY, o = this.maxX, s = this.maxY, a = e;
            a < r;
            a += 2
          ) {
            var h = t[a],
              u = t[a + 1];
            (i = h < i ? h : i), (n = u < n ? u : n), (o = h > o ? h : o), (s = u > s ? u : s);
          }
          (this.minX = i), (this.minY = n), (this.maxX = o), (this.maxY = s);
        }),
        (t.prototype.addVertices = function (t, e, r, i) {
          this.addVerticesMatrix(t.worldTransform, e, r, i);
        }),
        (t.prototype.addVerticesMatrix = function (t, e, r, i, n, o) {
          void 0 === n && (n = 0), void 0 === o && (o = n);
          for (
            var s = t.a,
              a = t.b,
              h = t.c,
              u = t.d,
              l = t.tx,
              c = t.ty,
              d = this.minX,
              f = this.minY,
              p = this.maxX,
              _ = this.maxY,
              m = r;
            m < i;
            m += 2
          ) {
            var v = e[m],
              E = e[m + 1],
              T = s * v + h * E + l,
              y = u * E + a * v + c;
            (d = Math.min(d, T - n)),
              (p = Math.max(p, T + n)),
              (f = Math.min(f, y - o)),
              (_ = Math.max(_, y + o));
          }
          (this.minX = d), (this.minY = f), (this.maxX = p), (this.maxY = _);
        }),
        (t.prototype.addBounds = function (t) {
          var e = this.minX,
            r = this.minY,
            i = this.maxX,
            n = this.maxY;
          (this.minX = t.minX < e ? t.minX : e),
            (this.minY = t.minY < r ? t.minY : r),
            (this.maxX = t.maxX > i ? t.maxX : i),
            (this.maxY = t.maxY > n ? t.maxY : n);
        }),
        (t.prototype.addBoundsMask = function (t, e) {
          var r = t.minX > e.minX ? t.minX : e.minX,
            i = t.minY > e.minY ? t.minY : e.minY,
            n = t.maxX < e.maxX ? t.maxX : e.maxX,
            o = t.maxY < e.maxY ? t.maxY : e.maxY;
          if (r <= n && i <= o) {
            var s = this.minX,
              a = this.minY,
              h = this.maxX,
              u = this.maxY;
            (this.minX = r < s ? r : s),
              (this.minY = i < a ? i : a),
              (this.maxX = n > h ? n : h),
              (this.maxY = o > u ? o : u);
          }
        }),
        (t.prototype.addBoundsMatrix = function (t, e) {
          this.addFrameMatrix(e, t.minX, t.minY, t.maxX, t.maxY);
        }),
        (t.prototype.addBoundsArea = function (t, e) {
          var r = t.minX > e.x ? t.minX : e.x,
            i = t.minY > e.y ? t.minY : e.y,
            n = t.maxX < e.x + e.width ? t.maxX : e.x + e.width,
            o = t.maxY < e.y + e.height ? t.maxY : e.y + e.height;
          if (r <= n && i <= o) {
            var s = this.minX,
              a = this.minY,
              h = this.maxX,
              u = this.maxY;
            (this.minX = r < s ? r : s),
              (this.minY = i < a ? i : a),
              (this.maxX = n > h ? n : h),
              (this.maxY = o > u ? o : u);
          }
        }),
        (t.prototype.pad = function (t, e) {
          void 0 === t && (t = 0),
            void 0 === e && (e = t),
            this.isEmpty() ||
              ((this.minX -= t), (this.maxX += t), (this.minY -= e), (this.maxY += e));
        }),
        (t.prototype.addFramePad = function (t, e, r, i, n, o) {
          (t -= n),
            (e -= o),
            (r += n),
            (i += o),
            (this.minX = this.minX < t ? this.minX : t),
            (this.maxX = this.maxX > r ? this.maxX : r),
            (this.minY = this.minY < e ? this.minY : e),
            (this.maxY = this.maxY > i ? this.maxY : i);
        }),
        t
      );
    })(),
    hr = function (t, e) {
      return (hr =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function ur(t, e) {
    function r() {
      this.constructor = t;
    }
    hr(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var lr,
    cr,
    dr,
    fr,
    pr,
    _r,
    mr,
    vr,
    Er,
    Tr,
    yr,
    gr,
    Rr,
    br,
    Ar,
    xr,
    Sr,
    Or,
    Ir,
    Pr = (function (t) {
      function e() {
        var e = t.call(this) || this;
        return (
          (e.tempDisplayObjectParent = null),
          (e.transform = new sr()),
          (e.alpha = 1),
          (e.visible = !0),
          (e.renderable = !0),
          (e.cullable = !1),
          (e.cullArea = null),
          (e.parent = null),
          (e.worldAlpha = 1),
          (e._lastSortedIndex = 0),
          (e._zIndex = 0),
          (e.filterArea = null),
          (e.filters = null),
          (e._enabledFilters = null),
          (e._bounds = new ar()),
          (e._localBounds = null),
          (e._boundsID = 0),
          (e._boundsRect = null),
          (e._localBoundsRect = null),
          (e._mask = null),
          (e._maskRefCount = 0),
          (e._destroyed = !1),
          (e.isSprite = !1),
          (e.isMask = !1),
          e
        );
      }
      return (
        ur(e, t),
        (e.mixin = function (t) {
          for (var r = Object.keys(t), i = 0; i < r.length; ++i) {
            var n = r[i];
            Object.defineProperty(e.prototype, n, Object.getOwnPropertyDescriptor(t, n));
          }
        }),
        Object.defineProperty(e.prototype, "destroyed", {
          get: function () {
            return this._destroyed;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype._recursivePostUpdateTransform = function () {
          this.parent
            ? (this.parent._recursivePostUpdateTransform(),
              this.transform.updateTransform(this.parent.transform))
            : this.transform.updateTransform(this._tempDisplayObjectParent.transform);
        }),
        (e.prototype.updateTransform = function () {
          this._boundsID++,
            this.transform.updateTransform(this.parent.transform),
            (this.worldAlpha = this.alpha * this.parent.worldAlpha);
        }),
        (e.prototype.getBounds = function (t, e) {
          return (
            t ||
              (this.parent
                ? (this._recursivePostUpdateTransform(), this.updateTransform())
                : ((this.parent = this._tempDisplayObjectParent),
                  this.updateTransform(),
                  (this.parent = null))),
            this._bounds.updateID !== this._boundsID &&
              (this.calculateBounds(), (this._bounds.updateID = this._boundsID)),
            e || (this._boundsRect || (this._boundsRect = new Ve()), (e = this._boundsRect)),
            this._bounds.getRectangle(e)
          );
        }),
        (e.prototype.getLocalBounds = function (t) {
          t ||
            (this._localBoundsRect || (this._localBoundsRect = new Ve()),
            (t = this._localBoundsRect)),
            this._localBounds || (this._localBounds = new ar());
          var e = this.transform,
            r = this.parent;
          (this.parent = null), (this.transform = this._tempDisplayObjectParent.transform);
          var i = this._bounds,
            n = this._boundsID;
          this._bounds = this._localBounds;
          var o = this.getBounds(!1, t);
          return (
            (this.parent = r),
            (this.transform = e),
            (this._bounds = i),
            (this._bounds.updateID += this._boundsID - n),
            o
          );
        }),
        (e.prototype.toGlobal = function (t, e, r) {
          return (
            void 0 === r && (r = !1),
            r ||
              (this._recursivePostUpdateTransform(),
              this.parent
                ? this.displayObjectUpdateTransform()
                : ((this.parent = this._tempDisplayObjectParent),
                  this.displayObjectUpdateTransform(),
                  (this.parent = null))),
            this.worldTransform.apply(t, e)
          );
        }),
        (e.prototype.toLocal = function (t, e, r, i) {
          return (
            e && (t = e.toGlobal(t, r, i)),
            i ||
              (this._recursivePostUpdateTransform(),
              this.parent
                ? this.displayObjectUpdateTransform()
                : ((this.parent = this._tempDisplayObjectParent),
                  this.displayObjectUpdateTransform(),
                  (this.parent = null))),
            this.worldTransform.applyInverse(t, r)
          );
        }),
        (e.prototype.setParent = function (t) {
          if (!t || !t.addChild) throw new Error("setParent: Argument must be a Container");
          return t.addChild(this), t;
        }),
        (e.prototype.setTransform = function (t, e, r, i, n, o, s, a, h) {
          return (
            void 0 === t && (t = 0),
            void 0 === e && (e = 0),
            void 0 === r && (r = 1),
            void 0 === i && (i = 1),
            void 0 === n && (n = 0),
            void 0 === o && (o = 0),
            void 0 === s && (s = 0),
            void 0 === a && (a = 0),
            void 0 === h && (h = 0),
            (this.position.x = t),
            (this.position.y = e),
            (this.scale.x = r || 1),
            (this.scale.y = i || 1),
            (this.rotation = n),
            (this.skew.x = o),
            (this.skew.y = s),
            (this.pivot.x = a),
            (this.pivot.y = h),
            this
          );
        }),
        (e.prototype.destroy = function (t) {
          this.parent && this.parent.removeChild(this),
            this.emit("destroyed"),
            this.removeAllListeners(),
            (this.transform = null),
            (this.parent = null),
            (this._bounds = null),
            (this.mask = null),
            (this.cullArea = null),
            (this.filters = null),
            (this.filterArea = null),
            (this.hitArea = null),
            (this.interactive = !1),
            (this.interactiveChildren = !1),
            (this._destroyed = !0);
        }),
        Object.defineProperty(e.prototype, "_tempDisplayObjectParent", {
          get: function () {
            return (
              null === this.tempDisplayObjectParent && (this.tempDisplayObjectParent = new Mr()),
              this.tempDisplayObjectParent
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.enableTempParent = function () {
          var t = this.parent;
          return (this.parent = this._tempDisplayObjectParent), t;
        }),
        (e.prototype.disableTempParent = function (t) {
          this.parent = t;
        }),
        Object.defineProperty(e.prototype, "x", {
          get: function () {
            return this.position.x;
          },
          set: function (t) {
            this.transform.position.x = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "y", {
          get: function () {
            return this.position.y;
          },
          set: function (t) {
            this.transform.position.y = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "worldTransform", {
          get: function () {
            return this.transform.worldTransform;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "localTransform", {
          get: function () {
            return this.transform.localTransform;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "position", {
          get: function () {
            return this.transform.position;
          },
          set: function (t) {
            this.transform.position.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "scale", {
          get: function () {
            return this.transform.scale;
          },
          set: function (t) {
            this.transform.scale.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "pivot", {
          get: function () {
            return this.transform.pivot;
          },
          set: function (t) {
            this.transform.pivot.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "skew", {
          get: function () {
            return this.transform.skew;
          },
          set: function (t) {
            this.transform.skew.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "rotation", {
          get: function () {
            return this.transform.rotation;
          },
          set: function (t) {
            this.transform.rotation = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "angle", {
          get: function () {
            return this.transform.rotation * ke;
          },
          set: function (t) {
            this.transform.rotation = t * He;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "zIndex", {
          get: function () {
            return this._zIndex;
          },
          set: function (t) {
            (this._zIndex = t), this.parent && (this.parent.sortDirty = !0);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "worldVisible", {
          get: function () {
            var t = this;
            do {
              if (!t.visible) return !1;
              t = t.parent;
            } while (t);
            return !0;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "mask", {
          get: function () {
            return this._mask;
          },
          set: function (t) {
            var e;
            this._mask !== t &&
              (this._mask &&
                ((e = this._mask.maskObject || this._mask)._maskRefCount--,
                0 === e._maskRefCount && ((e.renderable = !0), (e.isMask = !1))),
              (this._mask = t),
              this._mask &&
                (0 === (e = this._mask.maskObject || this._mask)._maskRefCount &&
                  ((e.renderable = !1), (e.isMask = !0)),
                e._maskRefCount++));
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(ot),
    Mr = (function (t) {
      function e() {
        var e = (null !== t && t.apply(this, arguments)) || this;
        return (e.sortDirty = null), e;
      }
      return ur(e, t), e;
    })(Pr);
  function Nr(t, e) {
    return t.zIndex === e.zIndex ? t._lastSortedIndex - e._lastSortedIndex : t.zIndex - e.zIndex;
  }
  (Pr.prototype.displayObjectUpdateTransform = Pr.prototype.updateTransform),
    (function (t) {
      (t[(t.WEBGL_LEGACY = 0)] = "WEBGL_LEGACY"),
        (t[(t.WEBGL = 1)] = "WEBGL"),
        (t[(t.WEBGL2 = 2)] = "WEBGL2");
    })(lr || (lr = {})),
    (function (t) {
      (t[(t.UNKNOWN = 0)] = "UNKNOWN"),
        (t[(t.WEBGL = 1)] = "WEBGL"),
        (t[(t.CANVAS = 2)] = "CANVAS");
    })(cr || (cr = {})),
    (function (t) {
      (t[(t.COLOR = 16384)] = "COLOR"),
        (t[(t.DEPTH = 256)] = "DEPTH"),
        (t[(t.STENCIL = 1024)] = "STENCIL");
    })(dr || (dr = {})),
    (function (t) {
      (t[(t.NORMAL = 0)] = "NORMAL"),
        (t[(t.ADD = 1)] = "ADD"),
        (t[(t.MULTIPLY = 2)] = "MULTIPLY"),
        (t[(t.SCREEN = 3)] = "SCREEN"),
        (t[(t.OVERLAY = 4)] = "OVERLAY"),
        (t[(t.DARKEN = 5)] = "DARKEN"),
        (t[(t.LIGHTEN = 6)] = "LIGHTEN"),
        (t[(t.COLOR_DODGE = 7)] = "COLOR_DODGE"),
        (t[(t.COLOR_BURN = 8)] = "COLOR_BURN"),
        (t[(t.HARD_LIGHT = 9)] = "HARD_LIGHT"),
        (t[(t.SOFT_LIGHT = 10)] = "SOFT_LIGHT"),
        (t[(t.DIFFERENCE = 11)] = "DIFFERENCE"),
        (t[(t.EXCLUSION = 12)] = "EXCLUSION"),
        (t[(t.HUE = 13)] = "HUE"),
        (t[(t.SATURATION = 14)] = "SATURATION"),
        (t[(t.COLOR = 15)] = "COLOR"),
        (t[(t.LUMINOSITY = 16)] = "LUMINOSITY"),
        (t[(t.NORMAL_NPM = 17)] = "NORMAL_NPM"),
        (t[(t.ADD_NPM = 18)] = "ADD_NPM"),
        (t[(t.SCREEN_NPM = 19)] = "SCREEN_NPM"),
        (t[(t.NONE = 20)] = "NONE"),
        (t[(t.SRC_OVER = 0)] = "SRC_OVER"),
        (t[(t.SRC_IN = 21)] = "SRC_IN"),
        (t[(t.SRC_OUT = 22)] = "SRC_OUT"),
        (t[(t.SRC_ATOP = 23)] = "SRC_ATOP"),
        (t[(t.DST_OVER = 24)] = "DST_OVER"),
        (t[(t.DST_IN = 25)] = "DST_IN"),
        (t[(t.DST_OUT = 26)] = "DST_OUT"),
        (t[(t.DST_ATOP = 27)] = "DST_ATOP"),
        (t[(t.ERASE = 26)] = "ERASE"),
        (t[(t.SUBTRACT = 28)] = "SUBTRACT"),
        (t[(t.XOR = 29)] = "XOR");
    })(fr || (fr = {})),
    (function (t) {
      (t[(t.POINTS = 0)] = "POINTS"),
        (t[(t.LINES = 1)] = "LINES"),
        (t[(t.LINE_LOOP = 2)] = "LINE_LOOP"),
        (t[(t.LINE_STRIP = 3)] = "LINE_STRIP"),
        (t[(t.TRIANGLES = 4)] = "TRIANGLES"),
        (t[(t.TRIANGLE_STRIP = 5)] = "TRIANGLE_STRIP"),
        (t[(t.TRIANGLE_FAN = 6)] = "TRIANGLE_FAN");
    })(pr || (pr = {})),
    (function (t) {
      (t[(t.RGBA = 6408)] = "RGBA"),
        (t[(t.RGB = 6407)] = "RGB"),
        (t[(t.RG = 33319)] = "RG"),
        (t[(t.RED = 6403)] = "RED"),
        (t[(t.RGBA_INTEGER = 36249)] = "RGBA_INTEGER"),
        (t[(t.RGB_INTEGER = 36248)] = "RGB_INTEGER"),
        (t[(t.RG_INTEGER = 33320)] = "RG_INTEGER"),
        (t[(t.RED_INTEGER = 36244)] = "RED_INTEGER"),
        (t[(t.ALPHA = 6406)] = "ALPHA"),
        (t[(t.LUMINANCE = 6409)] = "LUMINANCE"),
        (t[(t.LUMINANCE_ALPHA = 6410)] = "LUMINANCE_ALPHA"),
        (t[(t.DEPTH_COMPONENT = 6402)] = "DEPTH_COMPONENT"),
        (t[(t.DEPTH_STENCIL = 34041)] = "DEPTH_STENCIL");
    })(_r || (_r = {})),
    (function (t) {
      (t[(t.TEXTURE_2D = 3553)] = "TEXTURE_2D"),
        (t[(t.TEXTURE_CUBE_MAP = 34067)] = "TEXTURE_CUBE_MAP"),
        (t[(t.TEXTURE_2D_ARRAY = 35866)] = "TEXTURE_2D_ARRAY"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_X = 34069)] = "TEXTURE_CUBE_MAP_POSITIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070)] = "TEXTURE_CUBE_MAP_NEGATIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071)] = "TEXTURE_CUBE_MAP_POSITIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072)] = "TEXTURE_CUBE_MAP_NEGATIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073)] = "TEXTURE_CUBE_MAP_POSITIVE_Z"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074)] = "TEXTURE_CUBE_MAP_NEGATIVE_Z");
    })(mr || (mr = {})),
    (function (t) {
      (t[(t.UNSIGNED_BYTE = 5121)] = "UNSIGNED_BYTE"),
        (t[(t.UNSIGNED_SHORT = 5123)] = "UNSIGNED_SHORT"),
        (t[(t.UNSIGNED_SHORT_5_6_5 = 33635)] = "UNSIGNED_SHORT_5_6_5"),
        (t[(t.UNSIGNED_SHORT_4_4_4_4 = 32819)] = "UNSIGNED_SHORT_4_4_4_4"),
        (t[(t.UNSIGNED_SHORT_5_5_5_1 = 32820)] = "UNSIGNED_SHORT_5_5_5_1"),
        (t[(t.UNSIGNED_INT = 5125)] = "UNSIGNED_INT"),
        (t[(t.UNSIGNED_INT_10F_11F_11F_REV = 35899)] = "UNSIGNED_INT_10F_11F_11F_REV"),
        (t[(t.UNSIGNED_INT_2_10_10_10_REV = 33640)] = "UNSIGNED_INT_2_10_10_10_REV"),
        (t[(t.UNSIGNED_INT_24_8 = 34042)] = "UNSIGNED_INT_24_8"),
        (t[(t.UNSIGNED_INT_5_9_9_9_REV = 35902)] = "UNSIGNED_INT_5_9_9_9_REV"),
        (t[(t.BYTE = 5120)] = "BYTE"),
        (t[(t.SHORT = 5122)] = "SHORT"),
        (t[(t.INT = 5124)] = "INT"),
        (t[(t.FLOAT = 5126)] = "FLOAT"),
        (t[(t.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269)] = "FLOAT_32_UNSIGNED_INT_24_8_REV"),
        (t[(t.HALF_FLOAT = 36193)] = "HALF_FLOAT");
    })(vr || (vr = {})),
    (function (t) {
      (t[(t.FLOAT = 0)] = "FLOAT"), (t[(t.INT = 1)] = "INT"), (t[(t.UINT = 2)] = "UINT");
    })(Er || (Er = {})),
    (function (t) {
      (t[(t.NEAREST = 0)] = "NEAREST"), (t[(t.LINEAR = 1)] = "LINEAR");
    })(Tr || (Tr = {})),
    (function (t) {
      (t[(t.CLAMP = 33071)] = "CLAMP"),
        (t[(t.REPEAT = 10497)] = "REPEAT"),
        (t[(t.MIRRORED_REPEAT = 33648)] = "MIRRORED_REPEAT");
    })(yr || (yr = {})),
    (function (t) {
      (t[(t.OFF = 0)] = "OFF"),
        (t[(t.POW2 = 1)] = "POW2"),
        (t[(t.ON = 2)] = "ON"),
        (t[(t.ON_MANUAL = 3)] = "ON_MANUAL");
    })(gr || (gr = {})),
    (function (t) {
      (t[(t.NPM = 0)] = "NPM"),
        (t[(t.UNPACK = 1)] = "UNPACK"),
        (t[(t.PMA = 2)] = "PMA"),
        (t[(t.NO_PREMULTIPLIED_ALPHA = 0)] = "NO_PREMULTIPLIED_ALPHA"),
        (t[(t.PREMULTIPLY_ON_UPLOAD = 1)] = "PREMULTIPLY_ON_UPLOAD"),
        (t[(t.PREMULTIPLY_ALPHA = 2)] = "PREMULTIPLY_ALPHA"),
        (t[(t.PREMULTIPLIED_ALPHA = 2)] = "PREMULTIPLIED_ALPHA");
    })(Rr || (Rr = {})),
    (function (t) {
      (t[(t.NO = 0)] = "NO"),
        (t[(t.YES = 1)] = "YES"),
        (t[(t.AUTO = 2)] = "AUTO"),
        (t[(t.BLEND = 0)] = "BLEND"),
        (t[(t.CLEAR = 1)] = "CLEAR"),
        (t[(t.BLIT = 2)] = "BLIT");
    })(br || (br = {})),
    (function (t) {
      (t[(t.AUTO = 0)] = "AUTO"), (t[(t.MANUAL = 1)] = "MANUAL");
    })(Ar || (Ar = {})),
    (function (t) {
      (t.LOW = "lowp"), (t.MEDIUM = "mediump"), (t.HIGH = "highp");
    })(xr || (xr = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.SCISSOR = 1)] = "SCISSOR"),
        (t[(t.STENCIL = 2)] = "STENCIL"),
        (t[(t.SPRITE = 3)] = "SPRITE");
    })(Sr || (Sr = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.LOW = 2)] = "LOW"),
        (t[(t.MEDIUM = 4)] = "MEDIUM"),
        (t[(t.HIGH = 8)] = "HIGH");
    })(Or || (Or = {})),
    (function (t) {
      (t[(t.ELEMENT_ARRAY_BUFFER = 34963)] = "ELEMENT_ARRAY_BUFFER"),
        (t[(t.ARRAY_BUFFER = 34962)] = "ARRAY_BUFFER"),
        (t[(t.UNIFORM_BUFFER = 35345)] = "UNIFORM_BUFFER");
    })(Ir || (Ir = {}));
  var Dr = (function (t) {
    function e() {
      var e = t.call(this) || this;
      return (e.children = []), (e.sortableChildren = rt.SORTABLE_CHILDREN), (e.sortDirty = !1), e;
    }
    return (
      ur(e, t),
      (e.prototype.onChildrenChange = function (t) {}),
      (e.prototype.addChild = function () {
        for (var t = arguments, e = [], r = 0; r < arguments.length; r++) e[r] = t[r];
        if (e.length > 1) for (var i = 0; i < e.length; i++) this.addChild(e[i]);
        else {
          var n = e[0];
          n.parent && n.parent.removeChild(n),
            (n.parent = this),
            (this.sortDirty = !0),
            (n.transform._parentID = -1),
            this.children.push(n),
            this._boundsID++,
            this.onChildrenChange(this.children.length - 1),
            this.emit("childAdded", n, this, this.children.length - 1),
            n.emit("added", this);
        }
        return e[0];
      }),
      (e.prototype.addChildAt = function (t, e) {
        if (e < 0 || e > this.children.length)
          throw new Error(
            t + "addChildAt: The index " + e + " supplied is out of bounds " + this.children.length
          );
        return (
          t.parent && t.parent.removeChild(t),
          (t.parent = this),
          (this.sortDirty = !0),
          (t.transform._parentID = -1),
          this.children.splice(e, 0, t),
          this._boundsID++,
          this.onChildrenChange(e),
          t.emit("added", this),
          this.emit("childAdded", t, this, e),
          t
        );
      }),
      (e.prototype.swapChildren = function (t, e) {
        if (t !== e) {
          var r = this.getChildIndex(t),
            i = this.getChildIndex(e);
          (this.children[r] = e), (this.children[i] = t), this.onChildrenChange(r < i ? r : i);
        }
      }),
      (e.prototype.getChildIndex = function (t) {
        var e = this.children.indexOf(t);
        if (-1 === e) throw new Error("The supplied DisplayObject must be a child of the caller");
        return e;
      }),
      (e.prototype.setChildIndex = function (t, e) {
        if (e < 0 || e >= this.children.length)
          throw new Error("The index " + e + " supplied is out of bounds " + this.children.length);
        var r = this.getChildIndex(t);
        xe(this.children, r, 1), this.children.splice(e, 0, t), this.onChildrenChange(e);
      }),
      (e.prototype.getChildAt = function (t) {
        if (t < 0 || t >= this.children.length)
          throw new Error("getChildAt: Index (" + t + ") does not exist.");
        return this.children[t];
      }),
      (e.prototype.removeChild = function () {
        for (var t = arguments, e = [], r = 0; r < arguments.length; r++) e[r] = t[r];
        if (e.length > 1) for (var i = 0; i < e.length; i++) this.removeChild(e[i]);
        else {
          var n = e[0],
            o = this.children.indexOf(n);
          if (-1 === o) return null;
          (n.parent = null),
            (n.transform._parentID = -1),
            xe(this.children, o, 1),
            this._boundsID++,
            this.onChildrenChange(o),
            n.emit("removed", this),
            this.emit("childRemoved", n, this, o);
        }
        return e[0];
      }),
      (e.prototype.removeChildAt = function (t) {
        var e = this.getChildAt(t);
        return (
          (e.parent = null),
          (e.transform._parentID = -1),
          xe(this.children, t, 1),
          this._boundsID++,
          this.onChildrenChange(t),
          e.emit("removed", this),
          this.emit("childRemoved", e, this, t),
          e
        );
      }),
      (e.prototype.removeChildren = function (t, e) {
        void 0 === t && (t = 0), void 0 === e && (e = this.children.length);
        var r,
          i = t,
          n = e - i;
        if (n > 0 && n <= e) {
          r = this.children.splice(i, n);
          for (var o = 0; o < r.length; ++o)
            (r[o].parent = null), r[o].transform && (r[o].transform._parentID = -1);
          for (this._boundsID++, this.onChildrenChange(t), o = 0; o < r.length; ++o)
            r[o].emit("removed", this), this.emit("childRemoved", r[o], this, o);
          return r;
        }
        if (0 === n && 0 === this.children.length) return [];
        throw new RangeError("removeChildren: numeric values are outside the acceptable range.");
      }),
      (e.prototype.sortChildren = function () {
        for (var t = !1, e = 0, r = this.children.length; e < r; ++e) {
          var i = this.children[e];
          (i._lastSortedIndex = e), t || 0 === i.zIndex || (t = !0);
        }
        t && this.children.length > 1 && this.children.sort(Nr), (this.sortDirty = !1);
      }),
      (e.prototype.updateTransform = function () {
        this.sortableChildren && this.sortDirty && this.sortChildren(),
          this._boundsID++,
          this.transform.updateTransform(this.parent.transform),
          (this.worldAlpha = this.alpha * this.parent.worldAlpha);
        for (var t = 0, e = this.children.length; t < e; ++t) {
          var r = this.children[t];
          r.visible && r.updateTransform();
        }
      }),
      (e.prototype.calculateBounds = function () {
        this._bounds.clear(), this._calculateBounds();
        for (var t = 0; t < this.children.length; t++) {
          var e = this.children[t];
          if (e.visible && e.renderable)
            if ((e.calculateBounds(), e._mask)) {
              var r = e._mask.maskObject || e._mask;
              r.calculateBounds(), this._bounds.addBoundsMask(e._bounds, r._bounds);
            } else
              e.filterArea
                ? this._bounds.addBoundsArea(e._bounds, e.filterArea)
                : this._bounds.addBounds(e._bounds);
        }
        this._bounds.updateID = this._boundsID;
      }),
      (e.prototype.getLocalBounds = function (e, r) {
        void 0 === r && (r = !1);
        var i = t.prototype.getLocalBounds.call(this, e);
        if (!r)
          for (var n = 0, o = this.children.length; n < o; ++n) {
            var s = this.children[n];
            s.visible && s.updateTransform();
          }
        return i;
      }),
      (e.prototype._calculateBounds = function () {}),
      (e.prototype._renderWithCulling = function (t) {
        var r = t.renderTexture.sourceFrame;
        if (r.width > 0 && r.height > 0) {
          var i, n;
          if (
            (this.cullArea
              ? ((i = this.cullArea), (n = this.worldTransform))
              : this._render !== e.prototype._render && (i = this.getBounds(!0)),
            i && r.intersects(i, n))
          )
            this._render(t);
          else if (this.cullArea) return;
          for (var o = 0, s = this.children.length; o < s; ++o) {
            var a = this.children[o],
              h = a.cullable;
            (a.cullable = h || !this.cullArea), a.render(t), (a.cullable = h);
          }
        }
      }),
      (e.prototype.render = function (t) {
        if (this.visible && !(this.worldAlpha <= 0) && this.renderable)
          if (this._mask || (this.filters && this.filters.length)) this.renderAdvanced(t);
          else if (this.cullable) this._renderWithCulling(t);
          else {
            this._render(t);
            for (var e = 0, r = this.children.length; e < r; ++e) this.children[e].render(t);
          }
      }),
      (e.prototype.renderAdvanced = function (t) {
        var e = this.filters,
          r = this._mask;
        if (e) {
          this._enabledFilters || (this._enabledFilters = []), (this._enabledFilters.length = 0);
          for (var i = 0; i < e.length; i++) e[i].enabled && this._enabledFilters.push(e[i]);
        }
        var n =
          (e && this._enabledFilters && this._enabledFilters.length) ||
          (r && (!r.isMaskData || (r.enabled && (r.autoDetect || r.type !== Sr.NONE))));
        if (
          (n && t.batch.flush(),
          e &&
            this._enabledFilters &&
            this._enabledFilters.length &&
            t.filter.push(this, this._enabledFilters),
          r && t.mask.push(this, this._mask),
          this.cullable)
        )
          this._renderWithCulling(t);
        else {
          this._render(t), (i = 0);
          for (var o = this.children.length; i < o; ++i) this.children[i].render(t);
        }
        n && t.batch.flush(),
          r && t.mask.pop(this),
          e && this._enabledFilters && this._enabledFilters.length && t.filter.pop();
      }),
      (e.prototype._render = function (t) {}),
      (e.prototype.destroy = function (e) {
        t.prototype.destroy.call(this), (this.sortDirty = !1);
        var r = "boolean" == typeof e ? e : e && e.children,
          i = this.removeChildren(0, this.children.length);
        if (r) for (var n = 0; n < i.length; ++n) i[n].destroy(e);
      }),
      Object.defineProperty(e.prototype, "width", {
        get: function () {
          return this.scale.x * this.getLocalBounds().width;
        },
        set: function (t) {
          var e = this.getLocalBounds().width;
          (this.scale.x = 0 !== e ? t / e : 1), (this._width = t);
        },
        enumerable: !1,
        configurable: !0,
      }),
      Object.defineProperty(e.prototype, "height", {
        get: function () {
          return this.scale.y * this.getLocalBounds().height;
        },
        set: function (t) {
          var e = this.getLocalBounds().height;
          (this.scale.y = 0 !== e ? t / e : 1), (this._height = t);
        },
        enumerable: !1,
        configurable: !0,
      }),
      e
    );
  })(Pr);
  Dr.prototype.containerUpdateTransform = Dr.prototype.updateTransform;
  var Cr = {
    accessible: !1,
    accessibleTitle: null,
    accessibleHint: null,
    tabIndex: 0,
    _accessibleActive: !1,
    _accessibleDiv: null,
    accessibleType: "button",
    accessiblePointerEvents: "auto",
    accessibleChildren: !0,
    renderId: -1,
  };
  Pr.mixin(Cr);
  var Lr = 100,
    wr = 0,
    Fr = 0,
    Ur = 2,
    Br = (function () {
      function t(t) {
        (this.debug = !1),
          (this._isActive = !1),
          (this._isMobileAccessibility = !1),
          (this.pool = []),
          (this.renderId = 0),
          (this.children = []),
          (this.androidUpdateCount = 0),
          (this.androidUpdateFrequency = 500),
          (this._hookDiv = null),
          (et.tablet || et.phone) && this.createTouchHook();
        var e = document.createElement("div");
        (e.style.width = Lr + "px"),
          (e.style.height = Lr + "px"),
          (e.style.position = "absolute"),
          (e.style.top = wr + "px"),
          (e.style.left = Fr + "px"),
          (e.style.zIndex = Ur.toString()),
          (this.div = e),
          (this.renderer = t),
          (this._onKeyDown = this._onKeyDown.bind(this)),
          (this._onMouseMove = this._onMouseMove.bind(this)),
          globalThis.addEventListener("keydown", this._onKeyDown, !1);
      }
      return (
        Object.defineProperty(t.prototype, "isActive", {
          get: function () {
            return this._isActive;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "isMobileAccessibility", {
          get: function () {
            return this._isMobileAccessibility;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.createTouchHook = function () {
          var t = this,
            e = document.createElement("button");
          (e.style.width = "1px"),
            (e.style.height = "1px"),
            (e.style.position = "absolute"),
            (e.style.top = "-1000px"),
            (e.style.left = "-1000px"),
            (e.style.zIndex = (2).toString()),
            (e.style.backgroundColor = "#FF0000"),
            (e.title = "select to enable accessibility for this content"),
            e.addEventListener("focus", function () {
              (t._isMobileAccessibility = !0), t.activate(), t.destroyTouchHook();
            }),
            document.body.appendChild(e),
            (this._hookDiv = e);
        }),
        (t.prototype.destroyTouchHook = function () {
          this._hookDiv && (document.body.removeChild(this._hookDiv), (this._hookDiv = null));
        }),
        (t.prototype.activate = function () {
          var t;
          this._isActive ||
            ((this._isActive = !0),
            globalThis.document.addEventListener("mousemove", this._onMouseMove, !0),
            globalThis.removeEventListener("keydown", this._onKeyDown, !1),
            this.renderer.on("postrender", this.update, this),
            null === (t = this.renderer.view.parentNode) ||
              void 0 === t ||
              t.appendChild(this.div));
        }),
        (t.prototype.deactivate = function () {
          var t;
          this._isActive &&
            !this._isMobileAccessibility &&
            ((this._isActive = !1),
            globalThis.document.removeEventListener("mousemove", this._onMouseMove, !0),
            globalThis.addEventListener("keydown", this._onKeyDown, !1),
            this.renderer.off("postrender", this.update),
            null === (t = this.div.parentNode) || void 0 === t || t.removeChild(this.div));
        }),
        (t.prototype.updateAccessibleObjects = function (t) {
          if (t.visible && t.accessibleChildren) {
            t.accessible &&
              t.interactive &&
              (t._accessibleActive || this.addChild(t), (t.renderId = this.renderId));
            var e = t.children;
            if (e) for (var r = 0; r < e.length; r++) this.updateAccessibleObjects(e[r]);
          }
        }),
        (t.prototype.update = function () {
          var t = performance.now();
          if (
            !(et.android.device && t < this.androidUpdateCount) &&
            ((this.androidUpdateCount = t + this.androidUpdateFrequency),
            this.renderer.renderingToScreen)
          ) {
            this.renderer._lastObjectRendered &&
              this.updateAccessibleObjects(this.renderer._lastObjectRendered);
            var e = this.renderer.view.getBoundingClientRect(),
              r = e.left,
              i = e.top,
              n = e.width,
              o = e.height,
              s = this.renderer,
              a = s.width,
              h = s.height,
              u = s.resolution,
              l = (n / a) * u,
              c = (o / h) * u,
              d = this.div;
            (d.style.left = r + "px"),
              (d.style.top = i + "px"),
              (d.style.width = a + "px"),
              (d.style.height = h + "px");
            for (var f = 0; f < this.children.length; f++) {
              var p = this.children[f];
              if (p.renderId !== this.renderId)
                (p._accessibleActive = !1),
                  xe(this.children, f, 1),
                  this.div.removeChild(p._accessibleDiv),
                  this.pool.push(p._accessibleDiv),
                  (p._accessibleDiv = null),
                  f--;
              else {
                d = p._accessibleDiv;
                var _ = p.hitArea,
                  m = p.worldTransform;
                p.hitArea
                  ? ((d.style.left = (m.tx + _.x * m.a) * l + "px"),
                    (d.style.top = (m.ty + _.y * m.d) * c + "px"),
                    (d.style.width = _.width * m.a * l + "px"),
                    (d.style.height = _.height * m.d * c + "px"))
                  : ((_ = p.getBounds()),
                    this.capHitArea(_),
                    (d.style.left = _.x * l + "px"),
                    (d.style.top = _.y * c + "px"),
                    (d.style.width = _.width * l + "px"),
                    (d.style.height = _.height * c + "px"),
                    d.title !== p.accessibleTitle &&
                      null !== p.accessibleTitle &&
                      (d.title = p.accessibleTitle),
                    d.getAttribute("aria-label") !== p.accessibleHint &&
                      null !== p.accessibleHint &&
                      d.setAttribute("aria-label", p.accessibleHint)),
                  (p.accessibleTitle === d.title && p.tabIndex === d.tabIndex) ||
                    ((d.title = p.accessibleTitle),
                    (d.tabIndex = p.tabIndex),
                    this.debug && this.updateDebugHTML(d));
              }
            }
            this.renderId++;
          }
        }),
        (t.prototype.updateDebugHTML = function (t) {
          t.innerHTML =
            "type: " + t.type + "</br> title : " + t.title + "</br> tabIndex: " + t.tabIndex;
        }),
        (t.prototype.capHitArea = function (t) {
          t.x < 0 && ((t.width += t.x), (t.x = 0)), t.y < 0 && ((t.height += t.y), (t.y = 0));
          var e = this.renderer,
            r = e.width,
            i = e.height;
          t.x + t.width > r && (t.width = r - t.x), t.y + t.height > i && (t.height = i - t.y);
        }),
        (t.prototype.addChild = function (t) {
          var e = this.pool.pop();
          e ||
            (((e = document.createElement("button")).style.width = Lr + "px"),
            (e.style.height = Lr + "px"),
            (e.style.backgroundColor = this.debug ? "rgba(255,255,255,0.5)" : "transparent"),
            (e.style.position = "absolute"),
            (e.style.zIndex = Ur.toString()),
            (e.style.borderStyle = "none"),
            navigator.userAgent.toLowerCase().indexOf("chrome") > -1
              ? e.setAttribute("aria-live", "off")
              : e.setAttribute("aria-live", "polite"),
            navigator.userAgent.match(/rv:.*Gecko\//)
              ? e.setAttribute("aria-relevant", "additions")
              : e.setAttribute("aria-relevant", "text"),
            e.addEventListener("click", this._onClick.bind(this)),
            e.addEventListener("focus", this._onFocus.bind(this)),
            e.addEventListener("focusout", this._onFocusOut.bind(this))),
            (e.style.pointerEvents = t.accessiblePointerEvents),
            (e.type = t.accessibleType),
            t.accessibleTitle && null !== t.accessibleTitle
              ? (e.title = t.accessibleTitle)
              : (t.accessibleHint && null !== t.accessibleHint) ||
                (e.title = "displayObject " + t.tabIndex),
            t.accessibleHint &&
              null !== t.accessibleHint &&
              e.setAttribute("aria-label", t.accessibleHint),
            this.debug && this.updateDebugHTML(e),
            (t._accessibleActive = !0),
            (t._accessibleDiv = e),
            (e.displayObject = t),
            this.children.push(t),
            this.div.appendChild(t._accessibleDiv),
            (t._accessibleDiv.tabIndex = t.tabIndex);
        }),
        (t.prototype._onClick = function (t) {
          var e = this.renderer.plugins.interaction,
            r = t.target.displayObject,
            i = e.eventData;
          e.dispatchEvent(r, "click", i),
            e.dispatchEvent(r, "pointertap", i),
            e.dispatchEvent(r, "tap", i);
        }),
        (t.prototype._onFocus = function (t) {
          t.target.getAttribute("aria-live") || t.target.setAttribute("aria-live", "assertive");
          var e = this.renderer.plugins.interaction,
            r = t.target.displayObject,
            i = e.eventData;
          e.dispatchEvent(r, "mouseover", i);
        }),
        (t.prototype._onFocusOut = function (t) {
          t.target.getAttribute("aria-live") || t.target.setAttribute("aria-live", "polite");
          var e = this.renderer.plugins.interaction,
            r = t.target.displayObject,
            i = e.eventData;
          e.dispatchEvent(r, "mouseout", i);
        }),
        (t.prototype._onKeyDown = function (t) {
          9 === t.keyCode && this.activate();
        }),
        (t.prototype._onMouseMove = function (t) {
          (0 === t.movementX && 0 === t.movementY) || this.deactivate();
        }),
        (t.prototype.destroy = function () {
          this.destroyTouchHook(),
            (this.div = null),
            globalThis.document.removeEventListener("mousemove", this._onMouseMove, !0),
            globalThis.removeEventListener("keydown", this._onKeyDown),
            (this.pool = null),
            (this.children = null),
            (this.renderer = null);
        }),
        t
      );
    })();
  (rt.TARGET_FPMS = 0.06),
    (function (t) {
      (t[(t.INTERACTION = 50)] = "INTERACTION"),
        (t[(t.HIGH = 25)] = "HIGH"),
        (t[(t.NORMAL = 0)] = "NORMAL"),
        (t[(t.LOW = -25)] = "LOW"),
        (t[(t.UTILITY = -50)] = "UTILITY");
    })(t.UPDATE_PRIORITY || (t.UPDATE_PRIORITY = {}));
  var Gr = (function () {
      function t(t, e, r, i) {
        void 0 === e && (e = null),
          void 0 === r && (r = 0),
          void 0 === i && (i = !1),
          (this.next = null),
          (this.previous = null),
          (this._destroyed = !1),
          (this.fn = t),
          (this.context = e),
          (this.priority = r),
          (this.once = i);
      }
      return (
        (t.prototype.match = function (t, e) {
          return void 0 === e && (e = null), this.fn === t && this.context === e;
        }),
        (t.prototype.emit = function (t) {
          this.fn && (this.context ? this.fn.call(this.context, t) : this.fn(t));
          var e = this.next;
          return this.once && this.destroy(!0), this._destroyed && (this.next = null), e;
        }),
        (t.prototype.connect = function (t) {
          (this.previous = t),
            t.next && (t.next.previous = this),
            (this.next = t.next),
            (t.next = this);
        }),
        (t.prototype.destroy = function (t) {
          void 0 === t && (t = !1),
            (this._destroyed = !0),
            (this.fn = null),
            (this.context = null),
            this.previous && (this.previous.next = this.next),
            this.next && (this.next.previous = this.previous);
          var e = this.next;
          return (this.next = t ? null : e), (this.previous = null), e;
        }),
        t
      );
    })(),
    Xr = (function () {
      function e() {
        var t = this;
        (this.autoStart = !1),
          (this.deltaTime = 1),
          (this.lastTime = -1),
          (this.speed = 1),
          (this.started = !1),
          (this._requestId = null),
          (this._maxElapsedMS = 100),
          (this._minElapsedMS = 0),
          (this._protected = !1),
          (this._lastFrame = -1),
          (this._head = new Gr(null, null, 1 / 0)),
          (this.deltaMS = 1 / rt.TARGET_FPMS),
          (this.elapsedMS = 1 / rt.TARGET_FPMS),
          (this._tick = function (e) {
            (t._requestId = null),
              t.started &&
                (t.update(e),
                t.started &&
                  null === t._requestId &&
                  t._head.next &&
                  (t._requestId = requestAnimationFrame(t._tick)));
          });
      }
      return (
        (e.prototype._requestIfNeeded = function () {
          null === this._requestId &&
            this._head.next &&
            ((this.lastTime = performance.now()),
            (this._lastFrame = this.lastTime),
            (this._requestId = requestAnimationFrame(this._tick)));
        }),
        (e.prototype._cancelIfNeeded = function () {
          null !== this._requestId &&
            (cancelAnimationFrame(this._requestId), (this._requestId = null));
        }),
        (e.prototype._startIfPossible = function () {
          this.started ? this._requestIfNeeded() : this.autoStart && this.start();
        }),
        (e.prototype.add = function (e, r, i) {
          return void 0 === i && (i = t.UPDATE_PRIORITY.NORMAL), this._addListener(new Gr(e, r, i));
        }),
        (e.prototype.addOnce = function (e, r, i) {
          return (
            void 0 === i && (i = t.UPDATE_PRIORITY.NORMAL), this._addListener(new Gr(e, r, i, !0))
          );
        }),
        (e.prototype._addListener = function (t) {
          var e = this._head.next,
            r = this._head;
          if (e) {
            for (; e; ) {
              if (t.priority > e.priority) {
                t.connect(r);
                break;
              }
              (r = e), (e = e.next);
            }
            t.previous || t.connect(r);
          } else t.connect(r);
          return this._startIfPossible(), this;
        }),
        (e.prototype.remove = function (t, e) {
          for (var r = this._head.next; r; ) r = r.match(t, e) ? r.destroy() : r.next;
          return this._head.next || this._cancelIfNeeded(), this;
        }),
        Object.defineProperty(e.prototype, "count", {
          get: function () {
            if (!this._head) return 0;
            for (var t = 0, e = this._head; (e = e.next); ) t++;
            return t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.start = function () {
          this.started || ((this.started = !0), this._requestIfNeeded());
        }),
        (e.prototype.stop = function () {
          this.started && ((this.started = !1), this._cancelIfNeeded());
        }),
        (e.prototype.destroy = function () {
          if (!this._protected) {
            this.stop();
            for (var t = this._head.next; t; ) t = t.destroy(!0);
            this._head.destroy(), (this._head = null);
          }
        }),
        (e.prototype.update = function (t) {
          var e;
          if ((void 0 === t && (t = performance.now()), t > this.lastTime)) {
            if (
              ((e = this.elapsedMS = t - this.lastTime) > this._maxElapsedMS &&
                (e = this._maxElapsedMS),
              (e *= this.speed),
              this._minElapsedMS)
            ) {
              var r = (t - this._lastFrame) | 0;
              if (r < this._minElapsedMS) return;
              this._lastFrame = t - (r % this._minElapsedMS);
            }
            (this.deltaMS = e), (this.deltaTime = this.deltaMS * rt.TARGET_FPMS);
            for (var i = this._head, n = i.next; n; ) n = n.emit(this.deltaTime);
            i.next || this._cancelIfNeeded();
          } else this.deltaTime = this.deltaMS = this.elapsedMS = 0;
          this.lastTime = t;
        }),
        Object.defineProperty(e.prototype, "FPS", {
          get: function () {
            return 1e3 / this.elapsedMS;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "minFPS", {
          get: function () {
            return 1e3 / this._maxElapsedMS;
          },
          set: function (t) {
            var e = Math.min(this.maxFPS, t),
              r = Math.min(Math.max(0, e) / 1e3, rt.TARGET_FPMS);
            this._maxElapsedMS = 1 / r;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "maxFPS", {
          get: function () {
            return this._minElapsedMS ? Math.round(1e3 / this._minElapsedMS) : 0;
          },
          set: function (t) {
            if (0 === t) this._minElapsedMS = 0;
            else {
              var e = Math.max(this.minFPS, t);
              this._minElapsedMS = 1 / (e / 1e3);
            }
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e, "shared", {
          get: function () {
            if (!e._shared) {
              var t = (e._shared = new e());
              (t.autoStart = !0), (t._protected = !0);
            }
            return e._shared;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e, "system", {
          get: function () {
            if (!e._system) {
              var t = (e._system = new e());
              (t.autoStart = !0), (t._protected = !0);
            }
            return e._system;
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(),
    kr = (function () {
      function e() {}
      return (
        (e.init = function (e) {
          var r = this;
          (e = Object.assign({ autoStart: !0, sharedTicker: !1 }, e)),
            Object.defineProperty(this, "ticker", {
              set: function (e) {
                this._ticker && this._ticker.remove(this.render, this),
                  (this._ticker = e),
                  e && e.add(this.render, this, t.UPDATE_PRIORITY.LOW);
              },
              get: function () {
                return this._ticker;
              },
            }),
            (this.stop = function () {
              r._ticker.stop();
            }),
            (this.start = function () {
              r._ticker.start();
            }),
            (this._ticker = null),
            (this.ticker = e.sharedTicker ? Xr.shared : new Xr()),
            e.autoStart && this.start();
        }),
        (e.destroy = function () {
          if (this._ticker) {
            var t = this._ticker;
            (this.ticker = null), t.destroy();
          }
        }),
        e
      );
    })(),
    Hr = (function () {
      function t() {
        (this.pressure = 0),
          (this.rotationAngle = 0),
          (this.twist = 0),
          (this.tangentialPressure = 0),
          (this.global = new Ye()),
          (this.target = null),
          (this.originalEvent = null),
          (this.identifier = null),
          (this.isPrimary = !1),
          (this.button = 0),
          (this.buttons = 0),
          (this.width = 0),
          (this.height = 0),
          (this.tiltX = 0),
          (this.tiltY = 0),
          (this.pointerType = null),
          (this.pressure = 0),
          (this.rotationAngle = 0),
          (this.twist = 0),
          (this.tangentialPressure = 0);
      }
      return (
        Object.defineProperty(t.prototype, "pointerId", {
          get: function () {
            return this.identifier;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.getLocalPosition = function (t, e, r) {
          return t.worldTransform.applyInverse(r || this.global, e);
        }),
        (t.prototype.copyEvent = function (t) {
          "isPrimary" in t && t.isPrimary && (this.isPrimary = !0),
            (this.button = "button" in t && t.button);
          var e = "buttons" in t && t.buttons;
          (this.buttons = Number.isInteger(e) ? e : "which" in t && t.which),
            (this.width = "width" in t && t.width),
            (this.height = "height" in t && t.height),
            (this.tiltX = "tiltX" in t && t.tiltX),
            (this.tiltY = "tiltY" in t && t.tiltY),
            (this.pointerType = "pointerType" in t && t.pointerType),
            (this.pressure = "pressure" in t && t.pressure),
            (this.rotationAngle = "rotationAngle" in t && t.rotationAngle),
            (this.twist = ("twist" in t && t.twist) || 0),
            (this.tangentialPressure = ("tangentialPressure" in t && t.tangentialPressure) || 0);
        }),
        (t.prototype.reset = function () {
          this.isPrimary = !1;
        }),
        t
      );
    })(),
    Yr = function (t, e) {
      return (Yr =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    jr = (function () {
      function t() {
        (this.stopped = !1),
          (this.stopsPropagatingAt = null),
          (this.stopPropagationHint = !1),
          (this.target = null),
          (this.currentTarget = null),
          (this.type = null),
          (this.data = null);
      }
      return (
        (t.prototype.stopPropagation = function () {
          (this.stopped = !0),
            (this.stopPropagationHint = !0),
            (this.stopsPropagatingAt = this.currentTarget);
        }),
        (t.prototype.reset = function () {
          (this.stopped = !1),
            (this.stopsPropagatingAt = null),
            (this.stopPropagationHint = !1),
            (this.currentTarget = null),
            (this.target = null);
        }),
        t
      );
    })(),
    Vr = (function () {
      function t(e) {
        (this._pointerId = e), (this._flags = t.FLAGS.NONE);
      }
      return (
        (t.prototype._doSet = function (t, e) {
          this._flags = e ? this._flags | t : this._flags & ~t;
        }),
        Object.defineProperty(t.prototype, "pointerId", {
          get: function () {
            return this._pointerId;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "flags", {
          get: function () {
            return this._flags;
          },
          set: function (t) {
            this._flags = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "none", {
          get: function () {
            return this._flags === t.FLAGS.NONE;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "over", {
          get: function () {
            return 0 != (this._flags & t.FLAGS.OVER);
          },
          set: function (e) {
            this._doSet(t.FLAGS.OVER, e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "rightDown", {
          get: function () {
            return 0 != (this._flags & t.FLAGS.RIGHT_DOWN);
          },
          set: function (e) {
            this._doSet(t.FLAGS.RIGHT_DOWN, e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "leftDown", {
          get: function () {
            return 0 != (this._flags & t.FLAGS.LEFT_DOWN);
          },
          set: function (e) {
            this._doSet(t.FLAGS.LEFT_DOWN, e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.FLAGS = Object.freeze({ NONE: 0, OVER: 1, LEFT_DOWN: 2, RIGHT_DOWN: 4 })),
        t
      );
    })(),
    Wr = (function () {
      function t() {
        this._tempPoint = new Ye();
      }
      return (
        (t.prototype.recursiveFindHit = function (t, e, r, i, n) {
          if (!e || !e.visible) return !1;
          var o = t.data.global,
            s = !1,
            a = (n = e.interactive || n),
            h = !0;
          if (
            (e.hitArea
              ? (i &&
                  (e.worldTransform.applyInverse(o, this._tempPoint),
                  e.hitArea.contains(this._tempPoint.x, this._tempPoint.y)
                    ? (s = !0)
                    : ((i = !1), (h = !1))),
                (a = !1))
              : e._mask && i && ((e._mask.containsPoint && e._mask.containsPoint(o)) || (i = !1)),
            h && e.interactiveChildren && e.children)
          )
            for (var u = e.children, l = u.length - 1; l >= 0; l--) {
              var c = u[l],
                d = this.recursiveFindHit(t, c, r, i, a);
              if (d) {
                if (!c.parent) continue;
                (a = !1), d && (t.target && (i = !1), (s = !0));
              }
            }
          return (
            n &&
              (i && !t.target && !e.hitArea && e.containsPoint && e.containsPoint(o) && (s = !0),
              e.interactive && (s && !t.target && (t.target = e), r && r(t, e, !!s))),
            s
          );
        }),
        (t.prototype.findHit = function (t, e, r, i) {
          this.recursiveFindHit(t, e, r, i, !1);
        }),
        t
      );
    })(),
    zr = {
      interactive: !1,
      interactiveChildren: !0,
      hitArea: null,
      get buttonMode() {
        return "pointer" === this.cursor;
      },
      set buttonMode(t) {
        t ? (this.cursor = "pointer") : "pointer" === this.cursor && (this.cursor = null);
      },
      cursor: null,
      get trackedPointers() {
        return (
          void 0 === this._trackedPointers && (this._trackedPointers = {}), this._trackedPointers
        );
      },
      _trackedPointers: void 0,
    };
  Pr.mixin(zr);
  var qr = 1,
    Kr = { target: null, data: { global: null } },
    Zr = (function (e) {
      function r(t, r) {
        var i = e.call(this) || this;
        return (
          (r = r || {}),
          (i.renderer = t),
          (i.autoPreventDefault = void 0 === r.autoPreventDefault || r.autoPreventDefault),
          (i.interactionFrequency = r.interactionFrequency || 10),
          (i.mouse = new Hr()),
          (i.mouse.identifier = qr),
          i.mouse.global.set(-999999),
          (i.activeInteractionData = {}),
          (i.activeInteractionData[qr] = i.mouse),
          (i.interactionDataPool = []),
          (i.eventData = new jr()),
          (i.interactionDOMElement = null),
          (i.moveWhenInside = !1),
          (i.eventsAdded = !1),
          (i.tickerAdded = !1),
          (i.mouseOverRenderer = !("PointerEvent" in globalThis)),
          (i.supportsTouchEvents = "ontouchstart" in globalThis),
          (i.supportsPointerEvents = !!globalThis.PointerEvent),
          (i.onPointerUp = i.onPointerUp.bind(i)),
          (i.processPointerUp = i.processPointerUp.bind(i)),
          (i.onPointerCancel = i.onPointerCancel.bind(i)),
          (i.processPointerCancel = i.processPointerCancel.bind(i)),
          (i.onPointerDown = i.onPointerDown.bind(i)),
          (i.processPointerDown = i.processPointerDown.bind(i)),
          (i.onPointerMove = i.onPointerMove.bind(i)),
          (i.processPointerMove = i.processPointerMove.bind(i)),
          (i.onPointerOut = i.onPointerOut.bind(i)),
          (i.processPointerOverOut = i.processPointerOverOut.bind(i)),
          (i.onPointerOver = i.onPointerOver.bind(i)),
          (i.cursorStyles = { default: "inherit", pointer: "pointer" }),
          (i.currentCursorMode = null),
          (i.cursor = null),
          (i.resolution = 1),
          (i.delayedEvents = []),
          (i.search = new Wr()),
          (i._tempDisplayObject = new Mr()),
          (i._eventListenerOptions = { capture: !0, passive: !1 }),
          (i._useSystemTicker = void 0 === r.useSystemTicker || r.useSystemTicker),
          i.setTargetElement(i.renderer.view, i.renderer.resolution),
          i
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          Yr(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(r, e),
        Object.defineProperty(r.prototype, "useSystemTicker", {
          get: function () {
            return this._useSystemTicker;
          },
          set: function (t) {
            (this._useSystemTicker = t), t ? this.addTickerListener() : this.removeTickerListener();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "lastObjectRendered", {
          get: function () {
            return this.renderer._lastObjectRendered || this._tempDisplayObject;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.hitTest = function (t, e) {
          return (
            (Kr.target = null),
            (Kr.data.global = t),
            e || (e = this.lastObjectRendered),
            this.processInteractive(Kr, e, null, !0),
            Kr.target
          );
        }),
        (r.prototype.setTargetElement = function (t, e) {
          void 0 === e && (e = 1),
            this.removeTickerListener(),
            this.removeEvents(),
            (this.interactionDOMElement = t),
            (this.resolution = e),
            this.addEvents(),
            this.addTickerListener();
        }),
        (r.prototype.addTickerListener = function () {
          !this.tickerAdded &&
            this.interactionDOMElement &&
            this._useSystemTicker &&
            (Xr.system.add(this.tickerUpdate, this, t.UPDATE_PRIORITY.INTERACTION),
            (this.tickerAdded = !0));
        }),
        (r.prototype.removeTickerListener = function () {
          this.tickerAdded && (Xr.system.remove(this.tickerUpdate, this), (this.tickerAdded = !1));
        }),
        (r.prototype.addEvents = function () {
          if (!this.eventsAdded && this.interactionDOMElement) {
            var t = this.interactionDOMElement.style;
            globalThis.navigator.msPointerEnabled
              ? ((t.msContentZooming = "none"), (t.msTouchAction = "none"))
              : this.supportsPointerEvents && (t.touchAction = "none"),
              this.supportsPointerEvents
                ? (globalThis.document.addEventListener(
                    "pointermove",
                    this.onPointerMove,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.addEventListener(
                    "pointerdown",
                    this.onPointerDown,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.addEventListener(
                    "pointerleave",
                    this.onPointerOut,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.addEventListener(
                    "pointerover",
                    this.onPointerOver,
                    this._eventListenerOptions
                  ),
                  globalThis.addEventListener(
                    "pointercancel",
                    this.onPointerCancel,
                    this._eventListenerOptions
                  ),
                  globalThis.addEventListener(
                    "pointerup",
                    this.onPointerUp,
                    this._eventListenerOptions
                  ))
                : (globalThis.document.addEventListener(
                    "mousemove",
                    this.onPointerMove,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.addEventListener(
                    "mousedown",
                    this.onPointerDown,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.addEventListener(
                    "mouseout",
                    this.onPointerOut,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.addEventListener(
                    "mouseover",
                    this.onPointerOver,
                    this._eventListenerOptions
                  ),
                  globalThis.addEventListener(
                    "mouseup",
                    this.onPointerUp,
                    this._eventListenerOptions
                  )),
              this.supportsTouchEvents &&
                (this.interactionDOMElement.addEventListener(
                  "touchstart",
                  this.onPointerDown,
                  this._eventListenerOptions
                ),
                this.interactionDOMElement.addEventListener(
                  "touchcancel",
                  this.onPointerCancel,
                  this._eventListenerOptions
                ),
                this.interactionDOMElement.addEventListener(
                  "touchend",
                  this.onPointerUp,
                  this._eventListenerOptions
                ),
                this.interactionDOMElement.addEventListener(
                  "touchmove",
                  this.onPointerMove,
                  this._eventListenerOptions
                )),
              (this.eventsAdded = !0);
          }
        }),
        (r.prototype.removeEvents = function () {
          if (this.eventsAdded && this.interactionDOMElement) {
            var t = this.interactionDOMElement.style;
            globalThis.navigator.msPointerEnabled
              ? ((t.msContentZooming = ""), (t.msTouchAction = ""))
              : this.supportsPointerEvents && (t.touchAction = ""),
              this.supportsPointerEvents
                ? (globalThis.document.removeEventListener(
                    "pointermove",
                    this.onPointerMove,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.removeEventListener(
                    "pointerdown",
                    this.onPointerDown,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.removeEventListener(
                    "pointerleave",
                    this.onPointerOut,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.removeEventListener(
                    "pointerover",
                    this.onPointerOver,
                    this._eventListenerOptions
                  ),
                  globalThis.removeEventListener(
                    "pointercancel",
                    this.onPointerCancel,
                    this._eventListenerOptions
                  ),
                  globalThis.removeEventListener(
                    "pointerup",
                    this.onPointerUp,
                    this._eventListenerOptions
                  ))
                : (globalThis.document.removeEventListener(
                    "mousemove",
                    this.onPointerMove,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.removeEventListener(
                    "mousedown",
                    this.onPointerDown,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.removeEventListener(
                    "mouseout",
                    this.onPointerOut,
                    this._eventListenerOptions
                  ),
                  this.interactionDOMElement.removeEventListener(
                    "mouseover",
                    this.onPointerOver,
                    this._eventListenerOptions
                  ),
                  globalThis.removeEventListener(
                    "mouseup",
                    this.onPointerUp,
                    this._eventListenerOptions
                  )),
              this.supportsTouchEvents &&
                (this.interactionDOMElement.removeEventListener(
                  "touchstart",
                  this.onPointerDown,
                  this._eventListenerOptions
                ),
                this.interactionDOMElement.removeEventListener(
                  "touchcancel",
                  this.onPointerCancel,
                  this._eventListenerOptions
                ),
                this.interactionDOMElement.removeEventListener(
                  "touchend",
                  this.onPointerUp,
                  this._eventListenerOptions
                ),
                this.interactionDOMElement.removeEventListener(
                  "touchmove",
                  this.onPointerMove,
                  this._eventListenerOptions
                )),
              (this.interactionDOMElement = null),
              (this.eventsAdded = !1);
          }
        }),
        (r.prototype.tickerUpdate = function (t) {
          (this._deltaTime += t),
            this._deltaTime < this.interactionFrequency || ((this._deltaTime = 0), this.update());
        }),
        (r.prototype.update = function () {
          if (this.interactionDOMElement)
            if (this._didMove) this._didMove = !1;
            else {
              for (var t in ((this.cursor = null), this.activeInteractionData))
                if (this.activeInteractionData.hasOwnProperty(t)) {
                  var e = this.activeInteractionData[t];
                  if (e.originalEvent && "touch" !== e.pointerType) {
                    var r = this.configureInteractionEventForDOMEvent(
                      this.eventData,
                      e.originalEvent,
                      e
                    );
                    this.processInteractive(
                      r,
                      this.lastObjectRendered,
                      this.processPointerOverOut,
                      !0
                    );
                  }
                }
              this.setCursorMode(this.cursor);
            }
        }),
        (r.prototype.setCursorMode = function (t) {
          t = t || "default";
          var e = !0;
          if (
            (globalThis.OffscreenCanvas &&
              this.interactionDOMElement instanceof OffscreenCanvas &&
              (e = !1),
            this.currentCursorMode !== t)
          ) {
            this.currentCursorMode = t;
            var r = this.cursorStyles[t];
            if (r)
              switch (typeof r) {
                case "string":
                  e && (this.interactionDOMElement.style.cursor = r);
                  break;
                case "function":
                  r(t);
                  break;
                case "object":
                  e && Object.assign(this.interactionDOMElement.style, r);
              }
            else
              e &&
                "string" == typeof t &&
                !Object.prototype.hasOwnProperty.call(this.cursorStyles, t) &&
                (this.interactionDOMElement.style.cursor = t);
          }
        }),
        (r.prototype.dispatchEvent = function (t, e, r) {
          (r.stopPropagationHint && t !== r.stopsPropagatingAt) ||
            ((r.currentTarget = t), (r.type = e), t.emit(e, r), t[e] && t[e](r));
        }),
        (r.prototype.delayDispatchEvent = function (t, e, r) {
          this.delayedEvents.push({ displayObject: t, eventString: e, eventData: r });
        }),
        (r.prototype.mapPositionToPoint = function (t, e, r) {
          var i;
          i = this.interactionDOMElement.parentElement
            ? this.interactionDOMElement.getBoundingClientRect()
            : {
                x: 0,
                y: 0,
                width: this.interactionDOMElement.width,
                height: this.interactionDOMElement.height,
                left: 0,
                top: 0,
              };
          var n = 1 / this.resolution;
          (t.x = (e - i.left) * (this.interactionDOMElement.width / i.width) * n),
            (t.y = (r - i.top) * (this.interactionDOMElement.height / i.height) * n);
        }),
        (r.prototype.processInteractive = function (t, e, r, i) {
          var n = this.search.findHit(t, e, r, i),
            o = this.delayedEvents;
          if (!o.length) return n;
          t.stopPropagationHint = !1;
          var s = o.length;
          this.delayedEvents = [];
          for (var a = 0; a < s; a++) {
            var h = o[a],
              u = h.displayObject,
              l = h.eventString,
              c = h.eventData;
            c.stopsPropagatingAt === u && (c.stopPropagationHint = !0), this.dispatchEvent(u, l, c);
          }
          return n;
        }),
        (r.prototype.onPointerDown = function (t) {
          if (!this.supportsTouchEvents || "touch" !== t.pointerType) {
            var e = this.normalizeToPointerData(t);
            this.autoPreventDefault &&
              e[0].isNormalized &&
              (t.cancelable || !("cancelable" in t)) &&
              t.preventDefault();
            for (var r = e.length, i = 0; i < r; i++) {
              var n = e[i],
                o = this.getInteractionDataForPointerId(n),
                s = this.configureInteractionEventForDOMEvent(this.eventData, n, o);
              if (
                ((s.data.originalEvent = t),
                this.processInteractive(s, this.lastObjectRendered, this.processPointerDown, !0),
                this.emit("pointerdown", s),
                "touch" === n.pointerType)
              )
                this.emit("touchstart", s);
              else if ("mouse" === n.pointerType || "pen" === n.pointerType) {
                var a = 2 === n.button;
                this.emit(a ? "rightdown" : "mousedown", this.eventData);
              }
            }
          }
        }),
        (r.prototype.processPointerDown = function (t, e, r) {
          var i = t.data,
            n = t.data.identifier;
          if (r)
            if (
              (e.trackedPointers[n] || (e.trackedPointers[n] = new Vr(n)),
              this.dispatchEvent(e, "pointerdown", t),
              "touch" === i.pointerType)
            )
              this.dispatchEvent(e, "touchstart", t);
            else if ("mouse" === i.pointerType || "pen" === i.pointerType) {
              var o = 2 === i.button;
              o ? (e.trackedPointers[n].rightDown = !0) : (e.trackedPointers[n].leftDown = !0),
                this.dispatchEvent(e, o ? "rightdown" : "mousedown", t);
            }
        }),
        (r.prototype.onPointerComplete = function (t, e, r) {
          for (
            var i = this.normalizeToPointerData(t),
              n = i.length,
              o = t.target !== this.interactionDOMElement ? "outside" : "",
              s = 0;
            s < n;
            s++
          ) {
            var a = i[s],
              h = this.getInteractionDataForPointerId(a),
              u = this.configureInteractionEventForDOMEvent(this.eventData, a, h);
            if (
              ((u.data.originalEvent = t),
              this.processInteractive(u, this.lastObjectRendered, r, e || !o),
              this.emit(e ? "pointercancel" : "pointerup" + o, u),
              "mouse" === a.pointerType || "pen" === a.pointerType)
            ) {
              var l = 2 === a.button;
              this.emit(l ? "rightup" + o : "mouseup" + o, u);
            } else
              "touch" === a.pointerType &&
                (this.emit(e ? "touchcancel" : "touchend" + o, u),
                this.releaseInteractionDataForPointerId(a.pointerId));
          }
        }),
        (r.prototype.onPointerCancel = function (t) {
          (this.supportsTouchEvents && "touch" === t.pointerType) ||
            this.onPointerComplete(t, !0, this.processPointerCancel);
        }),
        (r.prototype.processPointerCancel = function (t, e) {
          var r = t.data,
            i = t.data.identifier;
          void 0 !== e.trackedPointers[i] &&
            (delete e.trackedPointers[i],
            this.dispatchEvent(e, "pointercancel", t),
            "touch" === r.pointerType && this.dispatchEvent(e, "touchcancel", t));
        }),
        (r.prototype.onPointerUp = function (t) {
          (this.supportsTouchEvents && "touch" === t.pointerType) ||
            this.onPointerComplete(t, !1, this.processPointerUp);
        }),
        (r.prototype.processPointerUp = function (t, e, r) {
          var i = t.data,
            n = t.data.identifier,
            o = e.trackedPointers[n],
            s = "touch" === i.pointerType,
            a = "mouse" === i.pointerType || "pen" === i.pointerType,
            h = !1;
          if (a) {
            var u = 2 === i.button,
              l = Vr.FLAGS,
              c = u ? l.RIGHT_DOWN : l.LEFT_DOWN,
              d = void 0 !== o && o.flags & c;
            r
              ? (this.dispatchEvent(e, u ? "rightup" : "mouseup", t),
                d && (this.dispatchEvent(e, u ? "rightclick" : "click", t), (h = !0)))
              : d && this.dispatchEvent(e, u ? "rightupoutside" : "mouseupoutside", t),
              o && (u ? (o.rightDown = !1) : (o.leftDown = !1));
          }
          r
            ? (this.dispatchEvent(e, "pointerup", t),
              s && this.dispatchEvent(e, "touchend", t),
              o &&
                ((a && !h) || this.dispatchEvent(e, "pointertap", t),
                s && (this.dispatchEvent(e, "tap", t), (o.over = !1))))
            : o &&
              (this.dispatchEvent(e, "pointerupoutside", t),
              s && this.dispatchEvent(e, "touchendoutside", t)),
            o && o.none && delete e.trackedPointers[n];
        }),
        (r.prototype.onPointerMove = function (t) {
          if (!this.supportsTouchEvents || "touch" !== t.pointerType) {
            var e = this.normalizeToPointerData(t);
            ("mouse" !== e[0].pointerType && "pen" !== e[0].pointerType) ||
              ((this._didMove = !0), (this.cursor = null));
            for (var r = e.length, i = 0; i < r; i++) {
              var n = e[i],
                o = this.getInteractionDataForPointerId(n),
                s = this.configureInteractionEventForDOMEvent(this.eventData, n, o);
              (s.data.originalEvent = t),
                this.processInteractive(s, this.lastObjectRendered, this.processPointerMove, !0),
                this.emit("pointermove", s),
                "touch" === n.pointerType && this.emit("touchmove", s),
                ("mouse" !== n.pointerType && "pen" !== n.pointerType) || this.emit("mousemove", s);
            }
            "mouse" === e[0].pointerType && this.setCursorMode(this.cursor);
          }
        }),
        (r.prototype.processPointerMove = function (t, e, r) {
          var i = t.data,
            n = "touch" === i.pointerType,
            o = "mouse" === i.pointerType || "pen" === i.pointerType;
          o && this.processPointerOverOut(t, e, r),
            (this.moveWhenInside && !r) ||
              (this.dispatchEvent(e, "pointermove", t),
              n && this.dispatchEvent(e, "touchmove", t),
              o && this.dispatchEvent(e, "mousemove", t));
        }),
        (r.prototype.onPointerOut = function (t) {
          if (!this.supportsTouchEvents || "touch" !== t.pointerType) {
            var e = this.normalizeToPointerData(t)[0];
            "mouse" === e.pointerType && ((this.mouseOverRenderer = !1), this.setCursorMode(null));
            var r = this.getInteractionDataForPointerId(e),
              i = this.configureInteractionEventForDOMEvent(this.eventData, e, r);
            (i.data.originalEvent = e),
              this.processInteractive(i, this.lastObjectRendered, this.processPointerOverOut, !1),
              this.emit("pointerout", i),
              "mouse" === e.pointerType || "pen" === e.pointerType
                ? this.emit("mouseout", i)
                : this.releaseInteractionDataForPointerId(r.identifier);
          }
        }),
        (r.prototype.processPointerOverOut = function (t, e, r) {
          var i = t.data,
            n = t.data.identifier,
            o = "mouse" === i.pointerType || "pen" === i.pointerType,
            s = e.trackedPointers[n];
          r && !s && (s = e.trackedPointers[n] = new Vr(n)),
            void 0 !== s &&
              (r && this.mouseOverRenderer
                ? (s.over ||
                    ((s.over = !0),
                    this.delayDispatchEvent(e, "pointerover", t),
                    o && this.delayDispatchEvent(e, "mouseover", t)),
                  o && null === this.cursor && (this.cursor = e.cursor))
                : s.over &&
                  ((s.over = !1),
                  this.dispatchEvent(e, "pointerout", this.eventData),
                  o && this.dispatchEvent(e, "mouseout", t),
                  s.none && delete e.trackedPointers[n]));
        }),
        (r.prototype.onPointerOver = function (t) {
          var e = this.normalizeToPointerData(t)[0],
            r = this.getInteractionDataForPointerId(e),
            i = this.configureInteractionEventForDOMEvent(this.eventData, e, r);
          (i.data.originalEvent = e),
            "mouse" === e.pointerType && (this.mouseOverRenderer = !0),
            this.emit("pointerover", i),
            ("mouse" !== e.pointerType && "pen" !== e.pointerType) || this.emit("mouseover", i);
        }),
        (r.prototype.getInteractionDataForPointerId = function (t) {
          var e,
            r = t.pointerId;
          return (
            r === qr || "mouse" === t.pointerType
              ? (e = this.mouse)
              : this.activeInteractionData[r]
              ? (e = this.activeInteractionData[r])
              : (((e = this.interactionDataPool.pop() || new Hr()).identifier = r),
                (this.activeInteractionData[r] = e)),
            e.copyEvent(t),
            e
          );
        }),
        (r.prototype.releaseInteractionDataForPointerId = function (t) {
          var e = this.activeInteractionData[t];
          e && (delete this.activeInteractionData[t], e.reset(), this.interactionDataPool.push(e));
        }),
        (r.prototype.configureInteractionEventForDOMEvent = function (t, e, r) {
          return (
            (t.data = r),
            this.mapPositionToPoint(r.global, e.clientX, e.clientY),
            "touch" === e.pointerType && ((e.globalX = r.global.x), (e.globalY = r.global.y)),
            (r.originalEvent = e),
            t.reset(),
            t
          );
        }),
        (r.prototype.normalizeToPointerData = function (t) {
          var e = [];
          if (this.supportsTouchEvents && t instanceof TouchEvent)
            for (var r = 0, i = t.changedTouches.length; r < i; r++) {
              var n = t.changedTouches[r];
              void 0 === n.button && (n.button = t.touches.length ? 1 : 0),
                void 0 === n.buttons && (n.buttons = t.touches.length ? 1 : 0),
                void 0 === n.isPrimary &&
                  (n.isPrimary = 1 === t.touches.length && "touchstart" === t.type),
                void 0 === n.width && (n.width = n.radiusX || 1),
                void 0 === n.height && (n.height = n.radiusY || 1),
                void 0 === n.tiltX && (n.tiltX = 0),
                void 0 === n.tiltY && (n.tiltY = 0),
                void 0 === n.pointerType && (n.pointerType = "touch"),
                void 0 === n.pointerId && (n.pointerId = n.identifier || 0),
                void 0 === n.pressure && (n.pressure = n.force || 0.5),
                void 0 === n.twist && (n.twist = 0),
                void 0 === n.tangentialPressure && (n.tangentialPressure = 0),
                void 0 === n.layerX && (n.layerX = n.offsetX = n.clientX),
                void 0 === n.layerY && (n.layerY = n.offsetY = n.clientY),
                (n.isNormalized = !0),
                e.push(n);
            }
          else if (
            !globalThis.MouseEvent ||
            (t instanceof MouseEvent &&
              !(this.supportsPointerEvents && t instanceof globalThis.PointerEvent))
          ) {
            var o = t;
            void 0 === o.isPrimary && (o.isPrimary = !0),
              void 0 === o.width && (o.width = 1),
              void 0 === o.height && (o.height = 1),
              void 0 === o.tiltX && (o.tiltX = 0),
              void 0 === o.tiltY && (o.tiltY = 0),
              void 0 === o.pointerType && (o.pointerType = "mouse"),
              void 0 === o.pointerId && (o.pointerId = qr),
              void 0 === o.pressure && (o.pressure = 0.5),
              void 0 === o.twist && (o.twist = 0),
              void 0 === o.tangentialPressure && (o.tangentialPressure = 0),
              (o.isNormalized = !0),
              e.push(o);
          } else e.push(t);
          return e;
        }),
        (r.prototype.destroy = function () {
          this.removeEvents(),
            this.removeTickerListener(),
            this.removeAllListeners(),
            (this.renderer = null),
            (this.mouse = null),
            (this.eventData = null),
            (this.interactionDOMElement = null),
            (this.onPointerDown = null),
            (this.processPointerDown = null),
            (this.onPointerUp = null),
            (this.processPointerUp = null),
            (this.onPointerCancel = null),
            (this.processPointerCancel = null),
            (this.onPointerMove = null),
            (this.processPointerMove = null),
            (this.onPointerOut = null),
            (this.processPointerOverOut = null),
            (this.onPointerOver = null),
            (this.search = null);
        }),
        r
      );
    })(ot),
    Qr = (function () {
      function t(t) {
        (this.items = []), (this._name = t), (this._aliasCount = 0);
      }
      return (
        (t.prototype.emit = function (t, e, r, i, n, o, s, a) {
          if (arguments.length > 8) throw new Error("max arguments reached");
          var h = this.name,
            u = this.items;
          this._aliasCount++;
          for (var l = 0, c = u.length; l < c; l++) u[l][h](t, e, r, i, n, o, s, a);
          return u === this.items && this._aliasCount--, this;
        }),
        (t.prototype.ensureNonAliasedItems = function () {
          this._aliasCount > 0 &&
            this.items.length > 1 &&
            ((this._aliasCount = 0), (this.items = this.items.slice(0)));
        }),
        (t.prototype.add = function (t) {
          return (
            t[this._name] && (this.ensureNonAliasedItems(), this.remove(t), this.items.push(t)),
            this
          );
        }),
        (t.prototype.remove = function (t) {
          var e = this.items.indexOf(t);
          return -1 !== e && (this.ensureNonAliasedItems(), this.items.splice(e, 1)), this;
        }),
        (t.prototype.contains = function (t) {
          return -1 !== this.items.indexOf(t);
        }),
        (t.prototype.removeAll = function () {
          return this.ensureNonAliasedItems(), (this.items.length = 0), this;
        }),
        (t.prototype.destroy = function () {
          this.removeAll(), (this.items = null), (this._name = null);
        }),
        Object.defineProperty(t.prototype, "empty", {
          get: function () {
            return 0 === this.items.length;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "name", {
          get: function () {
            return this._name;
          },
          enumerable: !1,
          configurable: !0,
        }),
        t
      );
    })();
  Object.defineProperties(Qr.prototype, {
    dispatch: { value: Qr.prototype.emit },
    run: { value: Qr.prototype.emit },
  }),
    (rt.PREFER_ENV = et.any ? t.ENV.WEBGL : t.ENV.WEBGL2),
    (rt.STRICT_TEXTURE_CACHE = !1);
  var Jr = [];
  function $r(t, e) {
    if (!t) return null;
    var r = "";
    if ("string" == typeof t) {
      var i = /\.(\w{3,4})(?:$|\?|#)/i.exec(t);
      i && (r = i[1].toLowerCase());
    }
    for (var n = Jr.length - 1; n >= 0; --n) {
      var o = Jr[n];
      if (o.test && o.test(t, r)) return new o(t, e);
    }
    throw new Error("Unrecognized source type to auto-detect Resource");
  }
  var ti = function (t, e) {
    return (ti =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (t, e) {
          t.__proto__ = e;
        }) ||
      function (t, e) {
        for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
      })(t, e);
  };
  function ei(t, e) {
    function r() {
      this.constructor = t;
    }
    ti(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var ri = function () {
      return (ri =
        Object.assign ||
        function (t) {
          for (var e, r = arguments, i = 1, n = arguments.length; i < n; i++)
            for (var o in (e = r[i])) Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
          return t;
        }).apply(this, arguments);
    },
    ii = (function () {
      function t(t, e) {
        void 0 === t && (t = 0),
          void 0 === e && (e = 0),
          (this._width = t),
          (this._height = e),
          (this.destroyed = !1),
          (this.internal = !1),
          (this.onResize = new Qr("setRealSize")),
          (this.onUpdate = new Qr("update")),
          (this.onError = new Qr("onError"));
      }
      return (
        (t.prototype.bind = function (t) {
          this.onResize.add(t),
            this.onUpdate.add(t),
            this.onError.add(t),
            (this._width || this._height) && this.onResize.emit(this._width, this._height);
        }),
        (t.prototype.unbind = function (t) {
          this.onResize.remove(t), this.onUpdate.remove(t), this.onError.remove(t);
        }),
        (t.prototype.resize = function (t, e) {
          (t === this._width && e === this._height) ||
            ((this._width = t), (this._height = e), this.onResize.emit(t, e));
        }),
        Object.defineProperty(t.prototype, "valid", {
          get: function () {
            return !!this._width && !!this._height;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.update = function () {
          this.destroyed || this.onUpdate.emit();
        }),
        (t.prototype.load = function () {
          return Promise.resolve(this);
        }),
        Object.defineProperty(t.prototype, "width", {
          get: function () {
            return this._width;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "height", {
          get: function () {
            return this._height;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.style = function (t, e, r) {
          return !1;
        }),
        (t.prototype.dispose = function () {}),
        (t.prototype.destroy = function () {
          this.destroyed ||
            ((this.destroyed = !0),
            this.dispose(),
            this.onError.removeAll(),
            (this.onError = null),
            this.onResize.removeAll(),
            (this.onResize = null),
            this.onUpdate.removeAll(),
            (this.onUpdate = null));
        }),
        (t.test = function (t, e) {
          return !1;
        }),
        t
      );
    })(),
    ni = (function (e) {
      function r(t, r) {
        var i = this,
          n = r || {},
          o = n.width,
          s = n.height;
        if (!o || !s) throw new Error("BufferResource width or height invalid");
        return ((i = e.call(this, o, s) || this).data = t), i;
      }
      return (
        ei(r, e),
        (r.prototype.upload = function (e, r, i) {
          var n = e.gl;
          n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r.alphaMode === t.ALPHA_MODES.UNPACK);
          var o = r.realWidth,
            s = r.realHeight;
          return (
            i.width === o && i.height === s
              ? n.texSubImage2D(r.target, 0, 0, 0, o, s, r.format, i.type, this.data)
              : ((i.width = o),
                (i.height = s),
                n.texImage2D(r.target, 0, i.internalFormat, o, s, 0, r.format, i.type, this.data)),
            !0
          );
        }),
        (r.prototype.dispose = function () {
          this.data = null;
        }),
        (r.test = function (t) {
          return t instanceof Float32Array || t instanceof Uint8Array || t instanceof Uint32Array;
        }),
        r
      );
    })(ii),
    oi = { scaleMode: t.SCALE_MODES.NEAREST, format: t.FORMATS.RGBA, alphaMode: t.ALPHA_MODES.NPM },
    si = (function (e) {
      function r(r, i) {
        void 0 === r && (r = null), void 0 === i && (i = null);
        var n = e.call(this) || this,
          o = (i = i || {}).alphaMode,
          s = i.mipmap,
          a = i.anisotropicLevel,
          h = i.scaleMode,
          u = i.width,
          l = i.height,
          c = i.wrapMode,
          d = i.format,
          f = i.type,
          p = i.target,
          _ = i.resolution,
          m = i.resourceOptions;
        return (
          !r || r instanceof ii || ((r = $r(r, m)).internal = !0),
          (n.resolution = _ || rt.RESOLUTION),
          (n.width = Math.round((u || 0) * n.resolution) / n.resolution),
          (n.height = Math.round((l || 0) * n.resolution) / n.resolution),
          (n._mipmap = void 0 !== s ? s : rt.MIPMAP_TEXTURES),
          (n.anisotropicLevel = void 0 !== a ? a : rt.ANISOTROPIC_LEVEL),
          (n._wrapMode = c || rt.WRAP_MODE),
          (n._scaleMode = void 0 !== h ? h : rt.SCALE_MODE),
          (n.format = d || t.FORMATS.RGBA),
          (n.type = f || t.TYPES.UNSIGNED_BYTE),
          (n.target = p || t.TARGETS.TEXTURE_2D),
          (n.alphaMode = void 0 !== o ? o : t.ALPHA_MODES.UNPACK),
          (n.uid = Ie()),
          (n.touched = 0),
          (n.isPowerOfTwo = !1),
          n._refreshPOT(),
          (n._glTextures = {}),
          (n.dirtyId = 0),
          (n.dirtyStyleId = 0),
          (n.cacheId = null),
          (n.valid = u > 0 && l > 0),
          (n.textureCacheIds = []),
          (n.destroyed = !1),
          (n.resource = null),
          (n._batchEnabled = 0),
          (n._batchLocation = 0),
          (n.parentTextureArray = null),
          n.setResource(r),
          n
        );
      }
      return (
        ei(r, e),
        Object.defineProperty(r.prototype, "realWidth", {
          get: function () {
            return Math.round(this.width * this.resolution);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "realHeight", {
          get: function () {
            return Math.round(this.height * this.resolution);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "mipmap", {
          get: function () {
            return this._mipmap;
          },
          set: function (t) {
            this._mipmap !== t && ((this._mipmap = t), this.dirtyStyleId++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "scaleMode", {
          get: function () {
            return this._scaleMode;
          },
          set: function (t) {
            this._scaleMode !== t && ((this._scaleMode = t), this.dirtyStyleId++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "wrapMode", {
          get: function () {
            return this._wrapMode;
          },
          set: function (t) {
            this._wrapMode !== t && ((this._wrapMode = t), this.dirtyStyleId++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.setStyle = function (t, e) {
          var r;
          return (
            void 0 !== t && t !== this.scaleMode && ((this.scaleMode = t), (r = !0)),
            void 0 !== e && e !== this.mipmap && ((this.mipmap = e), (r = !0)),
            r && this.dirtyStyleId++,
            this
          );
        }),
        (r.prototype.setSize = function (t, e, r) {
          return (r = r || this.resolution), this.setRealSize(t * r, e * r, r);
        }),
        (r.prototype.setRealSize = function (t, e, r) {
          return (
            (this.resolution = r || this.resolution),
            (this.width = Math.round(t) / this.resolution),
            (this.height = Math.round(e) / this.resolution),
            this._refreshPOT(),
            this.update(),
            this
          );
        }),
        (r.prototype._refreshPOT = function () {
          this.isPowerOfTwo = be(this.realWidth) && be(this.realHeight);
        }),
        (r.prototype.setResolution = function (t) {
          var e = this.resolution;
          return e === t
            ? this
            : ((this.resolution = t),
              this.valid &&
                ((this.width = Math.round(this.width * e) / t),
                (this.height = Math.round(this.height * e) / t),
                this.emit("update", this)),
              this._refreshPOT(),
              this);
        }),
        (r.prototype.setResource = function (t) {
          if (this.resource === t) return this;
          if (this.resource) throw new Error("Resource can be set only once");
          return t.bind(this), (this.resource = t), this;
        }),
        (r.prototype.update = function () {
          this.valid
            ? (this.dirtyId++, this.dirtyStyleId++, this.emit("update", this))
            : this.width > 0 &&
              this.height > 0 &&
              ((this.valid = !0), this.emit("loaded", this), this.emit("update", this));
        }),
        (r.prototype.onError = function (t) {
          this.emit("error", this, t);
        }),
        (r.prototype.destroy = function () {
          this.resource &&
            (this.resource.unbind(this),
            this.resource.internal && this.resource.destroy(),
            (this.resource = null)),
            this.cacheId &&
              (delete De[this.cacheId], delete Ne[this.cacheId], (this.cacheId = null)),
            this.dispose(),
            r.removeFromCache(this),
            (this.textureCacheIds = null),
            (this.destroyed = !0);
        }),
        (r.prototype.dispose = function () {
          this.emit("dispose", this);
        }),
        (r.prototype.castToBaseTexture = function () {
          return this;
        }),
        (r.from = function (t, e, i) {
          void 0 === i && (i = rt.STRICT_TEXTURE_CACHE);
          var n = "string" == typeof t,
            o = null;
          if (n) o = t;
          else {
            if (!t._pixiId) {
              var s = (e && e.pixiIdPrefix) || "pixiid";
              t._pixiId = s + "_" + Ie();
            }
            o = t._pixiId;
          }
          var a = De[o];
          if (n && i && !a)
            throw new Error('The cacheId "' + o + '" does not exist in BaseTextureCache.');
          return a || (((a = new r(t, e)).cacheId = o), r.addToCache(a, o)), a;
        }),
        (r.fromBuffer = function (e, i, n, o) {
          e = e || new Float32Array(i * n * 4);
          var s = new ni(e, { width: i, height: n }),
            a = e instanceof Float32Array ? t.TYPES.FLOAT : t.TYPES.UNSIGNED_BYTE;
          return new r(s, Object.assign(oi, o || { width: i, height: n, type: a }));
        }),
        (r.addToCache = function (t, e) {
          e &&
            (-1 === t.textureCacheIds.indexOf(e) && t.textureCacheIds.push(e),
            De[e] &&
              console.warn(
                "BaseTexture added to the cache with an id [" + e + "] that already had an entry"
              ),
            (De[e] = t));
        }),
        (r.removeFromCache = function (t) {
          if ("string" == typeof t) {
            var e = De[t];
            if (e) {
              var r = e.textureCacheIds.indexOf(t);
              return r > -1 && e.textureCacheIds.splice(r, 1), delete De[t], e;
            }
          } else if (t && t.textureCacheIds) {
            for (var i = 0; i < t.textureCacheIds.length; ++i) delete De[t.textureCacheIds[i]];
            return (t.textureCacheIds.length = 0), t;
          }
          return null;
        }),
        (r._globalBatch = 0),
        r
      );
    })(ot),
    ai = (function (t) {
      function e(e, r) {
        var i = this,
          n = r || {},
          o = n.width,
          s = n.height;
        ((i = t.call(this, o, s) || this).items = []), (i.itemDirtyIds = []);
        for (var a = 0; a < e; a++) {
          var h = new si();
          i.items.push(h), i.itemDirtyIds.push(-2);
        }
        return (i.length = e), (i._load = null), (i.baseTexture = null), i;
      }
      return (
        ei(e, t),
        (e.prototype.initFromArray = function (t, e) {
          for (var r = 0; r < this.length; r++)
            t[r] &&
              (t[r].castToBaseTexture
                ? this.addBaseTextureAt(t[r].castToBaseTexture(), r)
                : t[r] instanceof ii
                ? this.addResourceAt(t[r], r)
                : this.addResourceAt($r(t[r], e), r));
        }),
        (e.prototype.dispose = function () {
          for (var t = 0, e = this.length; t < e; t++) this.items[t].destroy();
          (this.items = null), (this.itemDirtyIds = null), (this._load = null);
        }),
        (e.prototype.addResourceAt = function (t, e) {
          if (!this.items[e]) throw new Error("Index " + e + " is out of bounds");
          return (
            t.valid && !this.valid && this.resize(t.width, t.height),
            this.items[e].setResource(t),
            this
          );
        }),
        (e.prototype.bind = function (e) {
          if (null !== this.baseTexture)
            throw new Error("Only one base texture per TextureArray is allowed");
          t.prototype.bind.call(this, e);
          for (var r = 0; r < this.length; r++)
            (this.items[r].parentTextureArray = e), this.items[r].on("update", e.update, e);
        }),
        (e.prototype.unbind = function (e) {
          t.prototype.unbind.call(this, e);
          for (var r = 0; r < this.length; r++)
            (this.items[r].parentTextureArray = null), this.items[r].off("update", e.update, e);
        }),
        (e.prototype.load = function () {
          var t = this;
          if (this._load) return this._load;
          var e = this.items
            .map(function (t) {
              return t.resource;
            })
            .filter(function (t) {
              return t;
            })
            .map(function (t) {
              return t.load();
            });
          return (
            (this._load = Promise.all(e).then(function () {
              var e = t.items[0],
                r = e.realWidth,
                i = e.realHeight;
              return t.resize(r, i), Promise.resolve(t);
            })),
            this._load
          );
        }),
        e
      );
    })(ii),
    hi = (function (e) {
      function r(t, r) {
        var i,
          n,
          o = this,
          s = r || {},
          a = s.width,
          h = s.height;
        return (
          Array.isArray(t) ? ((i = t), (n = t.length)) : (n = t),
          (o = e.call(this, n, { width: a, height: h }) || this),
          i && o.initFromArray(i, r),
          o
        );
      }
      return (
        ei(r, e),
        (r.prototype.addBaseTextureAt = function (t, e) {
          if (!t.resource) throw new Error("ArrayResource does not support RenderTexture");
          return this.addResourceAt(t.resource, e), this;
        }),
        (r.prototype.bind = function (r) {
          e.prototype.bind.call(this, r), (r.target = t.TARGETS.TEXTURE_2D_ARRAY);
        }),
        (r.prototype.upload = function (t, e, r) {
          var i = this.length,
            n = this.itemDirtyIds,
            o = this.items,
            s = t.gl;
          r.dirtyId < 0 &&
            s.texImage3D(
              s.TEXTURE_2D_ARRAY,
              0,
              r.internalFormat,
              this._width,
              this._height,
              i,
              0,
              e.format,
              r.type,
              null
            );
          for (var a = 0; a < i; a++) {
            var h = o[a];
            n[a] < h.dirtyId &&
              ((n[a] = h.dirtyId),
              h.valid &&
                s.texSubImage3D(
                  s.TEXTURE_2D_ARRAY,
                  0,
                  0,
                  0,
                  a,
                  h.resource.width,
                  h.resource.height,
                  1,
                  e.format,
                  r.type,
                  h.resource.source
                ));
          }
          return !0;
        }),
        r
      );
    })(ai),
    ui = (function (e) {
      function r(t) {
        var r = this,
          i = t,
          n = i.naturalWidth || i.videoWidth || i.width,
          o = i.naturalHeight || i.videoHeight || i.height;
        return ((r = e.call(this, n, o) || this).source = t), (r.noSubImage = !1), r;
      }
      return (
        ei(r, e),
        (r.crossOrigin = function (t, e, r) {
          void 0 === r && 0 !== e.indexOf("data:")
            ? (t.crossOrigin = Ue(e))
            : !1 !== r && (t.crossOrigin = "string" == typeof r ? r : "anonymous");
        }),
        (r.prototype.upload = function (e, r, i, n) {
          var o = e.gl,
            s = r.realWidth,
            a = r.realHeight;
          if ((n = n || this.source) instanceof HTMLImageElement) {
            if (!n.complete || 0 === n.naturalWidth) return !1;
          } else if (n instanceof HTMLVideoElement && n.readyState <= 1) return !1;
          return (
            o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r.alphaMode === t.ALPHA_MODES.UNPACK),
            this.noSubImage || r.target !== o.TEXTURE_2D || i.width !== s || i.height !== a
              ? ((i.width = s),
                (i.height = a),
                o.texImage2D(r.target, 0, i.internalFormat, r.format, i.type, n))
              : o.texSubImage2D(o.TEXTURE_2D, 0, 0, 0, r.format, i.type, n),
            !0
          );
        }),
        (r.prototype.update = function () {
          if (!this.destroyed) {
            var t = this.source,
              r = t.naturalWidth || t.videoWidth || t.width,
              i = t.naturalHeight || t.videoHeight || t.height;
            this.resize(r, i), e.prototype.update.call(this);
          }
        }),
        (r.prototype.dispose = function () {
          this.source = null;
        }),
        r
      );
    })(ii),
    li = (function (t) {
      function e(e) {
        return t.call(this, e) || this;
      }
      return (
        ei(e, t),
        (e.test = function (t) {
          var e = globalThis.OffscreenCanvas;
          return (
            !!(e && t instanceof e) ||
            (globalThis.HTMLCanvasElement && t instanceof HTMLCanvasElement)
          );
        }),
        e
      );
    })(ui),
    ci = (function (e) {
      function r(i, n) {
        var o = this,
          s = n || {},
          a = s.width,
          h = s.height,
          u = s.autoLoad,
          l = s.linkBaseTexture;
        if (i && i.length !== r.SIDES)
          throw new Error("Invalid length. Got " + i.length + ", expected 6");
        o = e.call(this, 6, { width: a, height: h }) || this;
        for (var c = 0; c < r.SIDES; c++)
          o.items[c].target = t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X + c;
        return (o.linkBaseTexture = !1 !== l), i && o.initFromArray(i, n), !1 !== u && o.load(), o;
      }
      return (
        ei(r, e),
        (r.prototype.bind = function (r) {
          e.prototype.bind.call(this, r), (r.target = t.TARGETS.TEXTURE_CUBE_MAP);
        }),
        (r.prototype.addBaseTextureAt = function (e, r, i) {
          if ((void 0 === i && (i = this.linkBaseTexture), !this.items[r]))
            throw new Error("Index " + r + " is out of bounds");
          if (
            !this.linkBaseTexture ||
            e.parentTextureArray ||
            Object.keys(e._glTextures).length > 0
          ) {
            if (!e.resource)
              throw new Error("CubeResource does not support copying of renderTexture.");
            this.addResourceAt(e.resource, r);
          } else
            (e.target = t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X + r),
              (e.parentTextureArray = this.baseTexture),
              (this.items[r] = e);
          return (
            e.valid && !this.valid && this.resize(e.realWidth, e.realHeight),
            (this.items[r] = e),
            this
          );
        }),
        (r.prototype.upload = function (t, e, i) {
          for (var n = this.itemDirtyIds, o = 0; o < r.SIDES; o++) {
            var s = this.items[o];
            n[o] < s.dirtyId &&
              (s.valid && s.resource
                ? (s.resource.upload(t, s, i), (n[o] = s.dirtyId))
                : n[o] < -1 &&
                  (t.gl.texImage2D(
                    s.target,
                    0,
                    i.internalFormat,
                    e.realWidth,
                    e.realHeight,
                    0,
                    e.format,
                    i.type,
                    null
                  ),
                  (n[o] = -1)));
          }
          return !0;
        }),
        (r.test = function (t) {
          return Array.isArray(t) && t.length === r.SIDES;
        }),
        (r.SIDES = 6),
        r
      );
    })(ai),
    di = (function (e) {
      function r(t, r) {
        var i = this;
        if (((r = r || {}), !(t instanceof HTMLImageElement))) {
          var n = new Image();
          ui.crossOrigin(n, t, r.crossorigin), (n.src = t), (t = n);
        }
        return (
          (i = e.call(this, t) || this),
          !t.complete && i._width && i._height && ((i._width = 0), (i._height = 0)),
          (i.url = t.src),
          (i._process = null),
          (i.preserveBitmap = !1),
          (i.createBitmap =
            (void 0 !== r.createBitmap ? r.createBitmap : rt.CREATE_IMAGE_BITMAP) &&
            !!globalThis.createImageBitmap),
          (i.alphaMode = "number" == typeof r.alphaMode ? r.alphaMode : null),
          (i.bitmap = null),
          (i._load = null),
          !1 !== r.autoLoad && i.load(),
          i
        );
      }
      return (
        ei(r, e),
        (r.prototype.load = function (t) {
          var e = this;
          return this._load
            ? this._load
            : (void 0 !== t && (this.createBitmap = t),
              (this._load = new Promise(function (t, r) {
                var i = e.source;
                e.url = i.src;
                var n = function () {
                  e.destroyed ||
                    ((i.onload = null),
                    (i.onerror = null),
                    e.resize(i.width, i.height),
                    (e._load = null),
                    e.createBitmap ? t(e.process()) : t(e));
                };
                i.complete && i.src
                  ? n()
                  : ((i.onload = n),
                    (i.onerror = function (t) {
                      r(t), e.onError.emit(t);
                    }));
              })),
              this._load);
        }),
        (r.prototype.process = function () {
          var e = this,
            r = this.source;
          if (null !== this._process) return this._process;
          if (null !== this.bitmap || !globalThis.createImageBitmap) return Promise.resolve(this);
          var i = globalThis.createImageBitmap,
            n = !r.crossOrigin || "anonymous" === r.crossOrigin;
          return (
            (this._process = fetch(r.src, { mode: n ? "cors" : "no-cors" })
              .then(function (t) {
                return t.blob();
              })
              .then(function (n) {
                return i(n, 0, 0, r.width, r.height, {
                  premultiplyAlpha: e.alphaMode === t.ALPHA_MODES.UNPACK ? "premultiply" : "none",
                });
              })
              .then(function (t) {
                return e.destroyed
                  ? Promise.reject()
                  : ((e.bitmap = t), e.update(), (e._process = null), Promise.resolve(e));
              })),
            this._process
          );
        }),
        (r.prototype.upload = function (t, r, i) {
          if (
            ("number" == typeof this.alphaMode && (r.alphaMode = this.alphaMode),
            !this.createBitmap)
          )
            return e.prototype.upload.call(this, t, r, i);
          if (!this.bitmap && (this.process(), !this.bitmap)) return !1;
          if ((e.prototype.upload.call(this, t, r, i, this.bitmap), !this.preserveBitmap)) {
            var n = !0,
              o = r._glTextures;
            for (var s in o) {
              var a = o[s];
              if (a !== i && a.dirtyId !== r.dirtyId) {
                n = !1;
                break;
              }
            }
            n && (this.bitmap.close && this.bitmap.close(), (this.bitmap = null));
          }
          return !0;
        }),
        (r.prototype.dispose = function () {
          (this.source.onload = null),
            (this.source.onerror = null),
            e.prototype.dispose.call(this),
            this.bitmap && (this.bitmap.close(), (this.bitmap = null)),
            (this._process = null),
            (this._load = null);
        }),
        (r.test = function (t) {
          return "string" == typeof t || t instanceof HTMLImageElement;
        }),
        r
      );
    })(ui),
    fi = (function (t) {
      function e(e, r) {
        var i = this;
        return (
          (r = r || {}),
          ((i = t.call(this, document.createElement("canvas")) || this)._width = 0),
          (i._height = 0),
          (i.svg = e),
          (i.scale = r.scale || 1),
          (i._overrideWidth = r.width),
          (i._overrideHeight = r.height),
          (i._resolve = null),
          (i._crossorigin = r.crossorigin),
          (i._load = null),
          !1 !== r.autoLoad && i.load(),
          i
        );
      }
      return (
        ei(e, t),
        (e.prototype.load = function () {
          var t = this;
          return this._load
            ? this._load
            : ((this._load = new Promise(function (r) {
                if (
                  ((t._resolve = function () {
                    t.resize(t.source.width, t.source.height), r(t);
                  }),
                  e.SVG_XML.test(t.svg.trim()))
                ) {
                  if (!btoa) throw new Error("Your browser doesn't support base64 conversions.");
                  t.svg = "data:image/svg+xml;base64," + btoa(unescape(encodeURIComponent(t.svg)));
                }
                t._loadSvg();
              })),
              this._load);
        }),
        (e.prototype._loadSvg = function () {
          var t = this,
            e = new Image();
          ui.crossOrigin(e, this.svg, this._crossorigin),
            (e.src = this.svg),
            (e.onerror = function (r) {
              t._resolve && ((e.onerror = null), t.onError.emit(r));
            }),
            (e.onload = function () {
              if (t._resolve) {
                var r = e.width,
                  i = e.height;
                if (!r || !i)
                  throw new Error(
                    "The SVG image must have width and height defined (in pixels), canvas API needs them."
                  );
                var n = r * t.scale,
                  o = i * t.scale;
                (t._overrideWidth || t._overrideHeight) &&
                  ((n = t._overrideWidth || (t._overrideHeight / i) * r),
                  (o = t._overrideHeight || (t._overrideWidth / r) * i)),
                  (n = Math.round(n)),
                  (o = Math.round(o));
                var s = t.source;
                (s.width = n),
                  (s.height = o),
                  (s._pixiId = "canvas_" + Ie()),
                  s.getContext("2d").drawImage(e, 0, 0, r, i, 0, 0, n, o),
                  t._resolve(),
                  (t._resolve = null);
              }
            });
        }),
        (e.getSize = function (t) {
          var r = e.SVG_SIZE.exec(t),
            i = {};
          return (
            r &&
              ((i[r[1]] = Math.round(parseFloat(r[3]))), (i[r[5]] = Math.round(parseFloat(r[7])))),
            i
          );
        }),
        (e.prototype.dispose = function () {
          t.prototype.dispose.call(this), (this._resolve = null), (this._crossorigin = null);
        }),
        (e.test = function (t, r) {
          return (
            "svg" === r ||
            ("string" == typeof t &&
              /^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)) ||
            ("string" == typeof t && e.SVG_XML.test(t))
          );
        }),
        (e.SVG_XML = /^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m),
        (e.SVG_SIZE =
          /<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i),
        e
      );
    })(ui),
    pi = (function (t) {
      function e(r, i) {
        var n = this;
        if (((i = i || {}), !(r instanceof HTMLVideoElement))) {
          var o = document.createElement("video");
          o.setAttribute("preload", "auto"),
            o.setAttribute("webkit-playsinline", ""),
            o.setAttribute("playsinline", ""),
            "string" == typeof r && (r = [r]);
          var s = r[0].src || r[0];
          ui.crossOrigin(o, s, i.crossorigin);
          for (var a = 0; a < r.length; ++a) {
            var h = document.createElement("source"),
              u = r[a],
              l = u.src,
              c = u.mime,
              d = (l = l || r[a]).split("?").shift().toLowerCase(),
              f = d.slice(d.lastIndexOf(".") + 1);
            (c = c || e.MIME_TYPES[f] || "video/" + f), (h.src = l), (h.type = c), o.appendChild(h);
          }
          r = o;
        }
        return (
          ((n = t.call(this, r) || this).noSubImage = !0),
          (n._autoUpdate = !0),
          (n._isConnectedToTicker = !1),
          (n._updateFPS = i.updateFPS || 0),
          (n._msToNextUpdate = 0),
          (n.autoPlay = !1 !== i.autoPlay),
          (n._load = null),
          (n._resolve = null),
          (n._onCanPlay = n._onCanPlay.bind(n)),
          (n._onError = n._onError.bind(n)),
          !1 !== i.autoLoad && n.load(),
          n
        );
      }
      return (
        ei(e, t),
        (e.prototype.update = function (e) {
          if (!this.destroyed) {
            var r = Xr.shared.elapsedMS * this.source.playbackRate;
            (this._msToNextUpdate = Math.floor(this._msToNextUpdate - r)),
              (!this._updateFPS || this._msToNextUpdate <= 0) &&
                (t.prototype.update.call(this),
                (this._msToNextUpdate = this._updateFPS ? Math.floor(1e3 / this._updateFPS) : 0));
          }
        }),
        (e.prototype.load = function () {
          var t = this;
          if (this._load) return this._load;
          var e = this.source;
          return (
            (e.readyState === e.HAVE_ENOUGH_DATA || e.readyState === e.HAVE_FUTURE_DATA) &&
              e.width &&
              e.height &&
              (e.complete = !0),
            e.addEventListener("play", this._onPlayStart.bind(this)),
            e.addEventListener("pause", this._onPlayStop.bind(this)),
            this._isSourceReady()
              ? this._onCanPlay()
              : (e.addEventListener("canplay", this._onCanPlay),
                e.addEventListener("canplaythrough", this._onCanPlay),
                e.addEventListener("error", this._onError, !0)),
            (this._load = new Promise(function (r) {
              t.valid ? r(t) : ((t._resolve = r), e.load());
            })),
            this._load
          );
        }),
        (e.prototype._onError = function (t) {
          this.source.removeEventListener("error", this._onError, !0), this.onError.emit(t);
        }),
        (e.prototype._isSourcePlaying = function () {
          var t = this.source;
          return t.currentTime > 0 && !1 === t.paused && !1 === t.ended && t.readyState > 2;
        }),
        (e.prototype._isSourceReady = function () {
          var t = this.source;
          return 3 === t.readyState || 4 === t.readyState;
        }),
        (e.prototype._onPlayStart = function () {
          this.valid || this._onCanPlay(),
            this.autoUpdate &&
              !this._isConnectedToTicker &&
              (Xr.shared.add(this.update, this), (this._isConnectedToTicker = !0));
        }),
        (e.prototype._onPlayStop = function () {
          this._isConnectedToTicker &&
            (Xr.shared.remove(this.update, this), (this._isConnectedToTicker = !1));
        }),
        (e.prototype._onCanPlay = function () {
          var t = this.source;
          t.removeEventListener("canplay", this._onCanPlay),
            t.removeEventListener("canplaythrough", this._onCanPlay);
          var e = this.valid;
          this.resize(t.videoWidth, t.videoHeight),
            !e && this._resolve && (this._resolve(this), (this._resolve = null)),
            this._isSourcePlaying() ? this._onPlayStart() : this.autoPlay && t.play();
        }),
        (e.prototype.dispose = function () {
          this._isConnectedToTicker &&
            (Xr.shared.remove(this.update, this), (this._isConnectedToTicker = !1));
          var e = this.source;
          e &&
            (e.removeEventListener("error", this._onError, !0), e.pause(), (e.src = ""), e.load()),
            t.prototype.dispose.call(this);
        }),
        Object.defineProperty(e.prototype, "autoUpdate", {
          get: function () {
            return this._autoUpdate;
          },
          set: function (t) {
            t !== this._autoUpdate &&
              ((this._autoUpdate = t),
              !this._autoUpdate && this._isConnectedToTicker
                ? (Xr.shared.remove(this.update, this), (this._isConnectedToTicker = !1))
                : this._autoUpdate &&
                  !this._isConnectedToTicker &&
                  this._isSourcePlaying() &&
                  (Xr.shared.add(this.update, this), (this._isConnectedToTicker = !0)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "updateFPS", {
          get: function () {
            return this._updateFPS;
          },
          set: function (t) {
            t !== this._updateFPS && (this._updateFPS = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.test = function (t, r) {
          return (
            (globalThis.HTMLVideoElement && t instanceof HTMLVideoElement) ||
            e.TYPES.indexOf(r) > -1
          );
        }),
        (e.TYPES = ["mp4", "m4v", "webm", "ogg", "ogv", "h264", "avi", "mov"]),
        (e.MIME_TYPES = { ogv: "video/ogg", mov: "video/quicktime", m4v: "video/mp4" }),
        e
      );
    })(ui),
    _i = (function (t) {
      function e(e) {
        return t.call(this, e) || this;
      }
      return (
        ei(e, t),
        (e.test = function (t) {
          return !!globalThis.createImageBitmap && t instanceof ImageBitmap;
        }),
        e
      );
    })(ui);
  Jr.push(di, _i, li, pi, fi, ni, ci, hi);
  var mi = {
      __proto__: null,
      Resource: ii,
      BaseImageResource: ui,
      INSTALLED: Jr,
      autoDetectResource: $r,
      AbstractMultiResource: ai,
      ArrayResource: hi,
      BufferResource: ni,
      CanvasResource: li,
      CubeResource: ci,
      ImageResource: di,
      SVGResource: fi,
      VideoResource: pi,
      ImageBitmapResource: _i,
    },
    vi = (function (e) {
      function r() {
        return (null !== e && e.apply(this, arguments)) || this;
      }
      return (
        ei(r, e),
        (r.prototype.upload = function (e, r, i) {
          var n = e.gl;
          n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r.alphaMode === t.ALPHA_MODES.UNPACK);
          var o = r.realWidth,
            s = r.realHeight;
          return (
            i.width === o && i.height === s
              ? n.texSubImage2D(r.target, 0, 0, 0, o, s, r.format, i.type, this.data)
              : ((i.width = o),
                (i.height = s),
                n.texImage2D(r.target, 0, i.internalFormat, o, s, 0, r.format, i.type, this.data)),
            !0
          );
        }),
        r
      );
    })(ni),
    Ei = (function () {
      function e(e, r) {
        (this.width = Math.round(e || 100)),
          (this.height = Math.round(r || 100)),
          (this.stencil = !1),
          (this.depth = !1),
          (this.dirtyId = 0),
          (this.dirtyFormat = 0),
          (this.dirtySize = 0),
          (this.depthTexture = null),
          (this.colorTextures = []),
          (this.glFramebuffers = {}),
          (this.disposeRunner = new Qr("disposeFramebuffer")),
          (this.multisample = t.MSAA_QUALITY.NONE);
      }
      return (
        Object.defineProperty(e.prototype, "colorTexture", {
          get: function () {
            return this.colorTextures[0];
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.addColorTexture = function (e, r) {
          return (
            void 0 === e && (e = 0),
            (this.colorTextures[e] =
              r ||
              new si(null, {
                scaleMode: t.SCALE_MODES.NEAREST,
                resolution: 1,
                mipmap: t.MIPMAP_MODES.OFF,
                width: this.width,
                height: this.height,
              })),
            this.dirtyId++,
            this.dirtyFormat++,
            this
          );
        }),
        (e.prototype.addDepthTexture = function (e) {
          return (
            (this.depthTexture =
              e ||
              new si(new vi(null, { width: this.width, height: this.height }), {
                scaleMode: t.SCALE_MODES.NEAREST,
                resolution: 1,
                width: this.width,
                height: this.height,
                mipmap: t.MIPMAP_MODES.OFF,
                format: t.FORMATS.DEPTH_COMPONENT,
                type: t.TYPES.UNSIGNED_SHORT,
              })),
            this.dirtyId++,
            this.dirtyFormat++,
            this
          );
        }),
        (e.prototype.enableDepth = function () {
          return (this.depth = !0), this.dirtyId++, this.dirtyFormat++, this;
        }),
        (e.prototype.enableStencil = function () {
          return (this.stencil = !0), this.dirtyId++, this.dirtyFormat++, this;
        }),
        (e.prototype.resize = function (t, e) {
          if (((t = Math.round(t)), (e = Math.round(e)), t !== this.width || e !== this.height)) {
            (this.width = t), (this.height = e), this.dirtyId++, this.dirtySize++;
            for (var r = 0; r < this.colorTextures.length; r++) {
              var i = this.colorTextures[r],
                n = i.resolution;
              i.setSize(t / n, e / n);
            }
            this.depthTexture &&
              ((n = this.depthTexture.resolution), this.depthTexture.setSize(t / n, e / n));
          }
        }),
        (e.prototype.dispose = function () {
          this.disposeRunner.emit(this, !1);
        }),
        (e.prototype.destroyDepthTexture = function () {
          this.depthTexture &&
            (this.depthTexture.destroy(),
            (this.depthTexture = null),
            ++this.dirtyId,
            ++this.dirtyFormat);
        }),
        e
      );
    })(),
    Ti = (function (e) {
      function r(r) {
        void 0 === r && (r = {});
        var i = this;
        return (
          "number" == typeof r &&
            (r = {
              width: arguments[0],
              height: arguments[1],
              scaleMode: arguments[2],
              resolution: arguments[3],
            }),
          (r.width = r.width || 100),
          (r.height = r.height || 100),
          (r.multisample = void 0 !== r.multisample ? r.multisample : t.MSAA_QUALITY.NONE),
          ((i = e.call(this, null, r) || this).mipmap = t.MIPMAP_MODES.OFF),
          (i.valid = !0),
          (i.clearColor = [0, 0, 0, 0]),
          (i.framebuffer = new Ei(i.realWidth, i.realHeight).addColorTexture(0, i)),
          (i.framebuffer.multisample = r.multisample),
          (i.maskStack = []),
          (i.filterStack = [{}]),
          i
        );
      }
      return (
        ei(r, e),
        (r.prototype.resize = function (t, e) {
          this.framebuffer.resize(t * this.resolution, e * this.resolution),
            this.setRealSize(this.framebuffer.width, this.framebuffer.height);
        }),
        (r.prototype.dispose = function () {
          this.framebuffer.dispose(), e.prototype.dispose.call(this);
        }),
        (r.prototype.destroy = function () {
          e.prototype.destroy.call(this),
            this.framebuffer.destroyDepthTexture(),
            (this.framebuffer = null);
        }),
        r
      );
    })(si),
    yi = (function () {
      function t() {
        (this.x0 = 0),
          (this.y0 = 0),
          (this.x1 = 1),
          (this.y1 = 0),
          (this.x2 = 1),
          (this.y2 = 1),
          (this.x3 = 0),
          (this.y3 = 1),
          (this.uvsFloat32 = new Float32Array(8));
      }
      return (
        (t.prototype.set = function (t, e, r) {
          var i = e.width,
            n = e.height;
          if (r) {
            var o = t.width / 2 / i,
              s = t.height / 2 / n,
              a = t.x / i + o,
              h = t.y / n + s;
            (r = or.add(r, or.NW)),
              (this.x0 = a + o * or.uX(r)),
              (this.y0 = h + s * or.uY(r)),
              (r = or.add(r, 2)),
              (this.x1 = a + o * or.uX(r)),
              (this.y1 = h + s * or.uY(r)),
              (r = or.add(r, 2)),
              (this.x2 = a + o * or.uX(r)),
              (this.y2 = h + s * or.uY(r)),
              (r = or.add(r, 2)),
              (this.x3 = a + o * or.uX(r)),
              (this.y3 = h + s * or.uY(r));
          } else
            (this.x0 = t.x / i),
              (this.y0 = t.y / n),
              (this.x1 = (t.x + t.width) / i),
              (this.y1 = t.y / n),
              (this.x2 = (t.x + t.width) / i),
              (this.y2 = (t.y + t.height) / n),
              (this.x3 = t.x / i),
              (this.y3 = (t.y + t.height) / n);
          (this.uvsFloat32[0] = this.x0),
            (this.uvsFloat32[1] = this.y0),
            (this.uvsFloat32[2] = this.x1),
            (this.uvsFloat32[3] = this.y1),
            (this.uvsFloat32[4] = this.x2),
            (this.uvsFloat32[5] = this.y2),
            (this.uvsFloat32[6] = this.x3),
            (this.uvsFloat32[7] = this.y3);
        }),
        t
      );
    })(),
    gi = new yi(),
    Ri = (function (t) {
      function e(r, i, n, o, s, a) {
        var h = t.call(this) || this;
        if (
          ((h.noFrame = !1),
          i || ((h.noFrame = !0), (i = new Ve(0, 0, 1, 1))),
          r instanceof e && (r = r.baseTexture),
          (h.baseTexture = r),
          (h._frame = i),
          (h.trim = o),
          (h.valid = !1),
          (h._uvs = gi),
          (h.uvMatrix = null),
          (h.orig = n || i),
          (h._rotate = Number(s || 0)),
          !0 === s)
        )
          h._rotate = 2;
        else if (h._rotate % 2 != 0)
          throw new Error(
            "attempt to use diamond-shaped UVs. If you are sure, set rotation manually"
          );
        return (
          (h.defaultAnchor = a ? new Ye(a.x, a.y) : new Ye(0, 0)),
          (h._updateID = 0),
          (h.textureCacheIds = []),
          r.valid
            ? h.noFrame
              ? r.valid && h.onBaseTextureUpdated(r)
              : (h.frame = i)
            : r.once("loaded", h.onBaseTextureUpdated, h),
          h.noFrame && r.on("update", h.onBaseTextureUpdated, h),
          h
        );
      }
      return (
        ei(e, t),
        (e.prototype.update = function () {
          this.baseTexture.resource && this.baseTexture.resource.update();
        }),
        (e.prototype.onBaseTextureUpdated = function (t) {
          if (this.noFrame) {
            if (!this.baseTexture.valid) return;
            (this._frame.width = t.width),
              (this._frame.height = t.height),
              (this.valid = !0),
              this.updateUvs();
          } else this.frame = this._frame;
          this.emit("update", this);
        }),
        (e.prototype.destroy = function (t) {
          if (this.baseTexture) {
            if (t) {
              var r = this.baseTexture.resource;
              r && r.url && Ne[r.url] && e.removeFromCache(r.url), this.baseTexture.destroy();
            }
            this.baseTexture.off("loaded", this.onBaseTextureUpdated, this),
              this.baseTexture.off("update", this.onBaseTextureUpdated, this),
              (this.baseTexture = null);
          }
          (this._frame = null),
            (this._uvs = null),
            (this.trim = null),
            (this.orig = null),
            (this.valid = !1),
            e.removeFromCache(this),
            (this.textureCacheIds = null);
        }),
        (e.prototype.clone = function () {
          var t = this._frame.clone(),
            r = this._frame === this.orig ? t : this.orig.clone(),
            i = new e(
              this.baseTexture,
              !this.noFrame && t,
              r,
              this.trim && this.trim.clone(),
              this.rotate,
              this.defaultAnchor
            );
          return this.noFrame && (i._frame = t), i;
        }),
        (e.prototype.updateUvs = function () {
          this._uvs === gi && (this._uvs = new yi()),
            this._uvs.set(this._frame, this.baseTexture, this.rotate),
            this._updateID++;
        }),
        (e.from = function (t, r, i) {
          void 0 === r && (r = {}), void 0 === i && (i = rt.STRICT_TEXTURE_CACHE);
          var n = "string" == typeof t,
            o = null;
          if (n) o = t;
          else if (t instanceof si) {
            if (!t.cacheId) {
              var s = (r && r.pixiIdPrefix) || "pixiid";
              (t.cacheId = s + "-" + Ie()), si.addToCache(t, t.cacheId);
            }
            o = t.cacheId;
          } else
            t._pixiId || ((s = (r && r.pixiIdPrefix) || "pixiid"), (t._pixiId = s + "_" + Ie())),
              (o = t._pixiId);
          var a = Ne[o];
          if (n && i && !a)
            throw new Error('The cacheId "' + o + '" does not exist in TextureCache.');
          return (
            a || t instanceof si
              ? !a && t instanceof si && ((a = new e(t)), e.addToCache(a, o))
              : (r.resolution || (r.resolution = Be(t)),
                ((a = new e(new si(t, r))).baseTexture.cacheId = o),
                si.addToCache(a.baseTexture, o),
                e.addToCache(a, o)),
            a
          );
        }),
        (e.fromURL = function (t, r) {
          var i = Object.assign({ autoLoad: !1 }, null == r ? void 0 : r.resourceOptions),
            n = e.from(t, Object.assign({ resourceOptions: i }, r), !1),
            o = n.baseTexture.resource;
          return n.baseTexture.valid
            ? Promise.resolve(n)
            : o.load().then(function () {
                return Promise.resolve(n);
              });
        }),
        (e.fromBuffer = function (t, r, i, n) {
          return new e(si.fromBuffer(t, r, i, n));
        }),
        (e.fromLoader = function (t, r, i, n) {
          var o = new si(t, Object.assign({ scaleMode: rt.SCALE_MODE, resolution: Be(r) }, n)),
            s = o.resource;
          s instanceof di && (s.url = r);
          var a = new e(o);
          return (
            i || (i = r),
            si.addToCache(a.baseTexture, i),
            e.addToCache(a, i),
            i !== r && (si.addToCache(a.baseTexture, r), e.addToCache(a, r)),
            a.baseTexture.valid
              ? Promise.resolve(a)
              : new Promise(function (t) {
                  a.baseTexture.once("loaded", function () {
                    return t(a);
                  });
                })
          );
        }),
        (e.addToCache = function (t, e) {
          e &&
            (-1 === t.textureCacheIds.indexOf(e) && t.textureCacheIds.push(e),
            Ne[e] &&
              console.warn(
                "Texture added to the cache with an id [" + e + "] that already had an entry"
              ),
            (Ne[e] = t));
        }),
        (e.removeFromCache = function (t) {
          if ("string" == typeof t) {
            var e = Ne[t];
            if (e) {
              var r = e.textureCacheIds.indexOf(t);
              return r > -1 && e.textureCacheIds.splice(r, 1), delete Ne[t], e;
            }
          } else if (t && t.textureCacheIds) {
            for (var i = 0; i < t.textureCacheIds.length; ++i)
              Ne[t.textureCacheIds[i]] === t && delete Ne[t.textureCacheIds[i]];
            return (t.textureCacheIds.length = 0), t;
          }
          return null;
        }),
        Object.defineProperty(e.prototype, "resolution", {
          get: function () {
            return this.baseTexture.resolution;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "frame", {
          get: function () {
            return this._frame;
          },
          set: function (t) {
            (this._frame = t), (this.noFrame = !1);
            var e = t.x,
              r = t.y,
              i = t.width,
              n = t.height,
              o = e + i > this.baseTexture.width,
              s = r + n > this.baseTexture.height;
            if (o || s) {
              var a = o && s ? "and" : "or",
                h = "X: " + e + " + " + i + " = " + (e + i) + " > " + this.baseTexture.width,
                u = "Y: " + r + " + " + n + " = " + (r + n) + " > " + this.baseTexture.height;
              throw new Error(
                "Texture Error: frame does not fit inside the base Texture dimensions: " +
                  h +
                  " " +
                  a +
                  " " +
                  u
              );
            }
            (this.valid = i && n && this.baseTexture.valid),
              this.trim || this.rotate || (this.orig = t),
              this.valid && this.updateUvs();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "rotate", {
          get: function () {
            return this._rotate;
          },
          set: function (t) {
            (this._rotate = t), this.valid && this.updateUvs();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "width", {
          get: function () {
            return this.orig.width;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "height", {
          get: function () {
            return this.orig.height;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.castToBaseTexture = function () {
          return this.baseTexture;
        }),
        e
      );
    })(ot);
  function bi(t) {
    (t.destroy = function () {}),
      (t.on = function () {}),
      (t.once = function () {}),
      (t.emit = function () {});
  }
  (Ri.EMPTY = new Ri(new si())),
    bi(Ri.EMPTY),
    bi(Ri.EMPTY.baseTexture),
    (Ri.WHITE = (function () {
      var t = document.createElement("canvas");
      (t.width = 16), (t.height = 16);
      var e = t.getContext("2d");
      return (e.fillStyle = "white"), e.fillRect(0, 0, 16, 16), new Ri(new si(new li(t)));
    })()),
    bi(Ri.WHITE),
    bi(Ri.WHITE.baseTexture);
  var Ai = (function (t) {
      function e(e, r) {
        var i = t.call(this, e, r) || this;
        return (i.valid = !0), (i.filterFrame = null), (i.filterPoolKey = null), i.updateUvs(), i;
      }
      return (
        ei(e, t),
        Object.defineProperty(e.prototype, "framebuffer", {
          get: function () {
            return this.baseTexture.framebuffer;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "multisample", {
          get: function () {
            return this.framebuffer.multisample;
          },
          set: function (t) {
            this.framebuffer.multisample = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.resize = function (t, e, r) {
          void 0 === r && (r = !0);
          var i = this.baseTexture.resolution,
            n = Math.round(t * i) / i,
            o = Math.round(e * i) / i;
          (this.valid = n > 0 && o > 0),
            (this._frame.width = this.orig.width = n),
            (this._frame.height = this.orig.height = o),
            r && this.baseTexture.resize(n, o),
            this.updateUvs();
        }),
        (e.prototype.setResolution = function (t) {
          var e = this.baseTexture;
          e.resolution !== t && (e.setResolution(t), this.resize(e.width, e.height, !1));
        }),
        (e.create = function (t) {
          for (var r = arguments, i = [], n = 1; n < arguments.length; n++) i[n - 1] = r[n];
          return (
            "number" == typeof t &&
              (t = { width: t, height: i[0], scaleMode: i[1], resolution: i[2] }),
            new e(new Ti(t))
          );
        }),
        e
      );
    })(Ri),
    xi = (function () {
      function e(t) {
        (this.texturePool = {}),
          (this.textureOptions = t || {}),
          (this.enableFullScreen = !1),
          (this._pixelsWidth = 0),
          (this._pixelsHeight = 0);
      }
      return (
        (e.prototype.createTexture = function (e, r, i) {
          void 0 === i && (i = t.MSAA_QUALITY.NONE);
          var n = new Ti(
            Object.assign(
              { width: e, height: r, resolution: 1, multisample: i },
              this.textureOptions
            )
          );
          return new Ai(n);
        }),
        (e.prototype.getOptimalTexture = function (e, r, i, n) {
          var o;
          void 0 === i && (i = 1),
            void 0 === n && (n = t.MSAA_QUALITY.NONE),
            (e = Math.ceil(e * i - 1e-6)),
            (r = Math.ceil(r * i - 1e-6)),
            this.enableFullScreen && e === this._pixelsWidth && r === this._pixelsHeight
              ? (o = n > 1 ? -n : -1)
              : ((o = (((65535 & (e = Re(e))) << 16) | (65535 & (r = Re(r)))) >>> 0),
                n > 1 && (o += 4294967296 * n)),
            this.texturePool[o] || (this.texturePool[o] = []);
          var s = this.texturePool[o].pop();
          return (
            s || (s = this.createTexture(e, r, n)), (s.filterPoolKey = o), s.setResolution(i), s
          );
        }),
        (e.prototype.getFilterTexture = function (e, r, i) {
          var n = this.getOptimalTexture(
            e.width,
            e.height,
            r || e.resolution,
            i || t.MSAA_QUALITY.NONE
          );
          return (n.filterFrame = e.filterFrame), n;
        }),
        (e.prototype.returnTexture = function (t) {
          var e = t.filterPoolKey;
          (t.filterFrame = null), this.texturePool[e].push(t);
        }),
        (e.prototype.returnFilterTexture = function (t) {
          this.returnTexture(t);
        }),
        (e.prototype.clear = function (t) {
          if ((t = !1 !== t))
            for (var e in this.texturePool) {
              var r = this.texturePool[e];
              if (r) for (var i = 0; i < r.length; i++) r[i].destroy(!0);
            }
          this.texturePool = {};
        }),
        (e.prototype.setScreenSize = function (t) {
          if (t.width !== this._pixelsWidth || t.height !== this._pixelsHeight) {
            for (var e in ((this.enableFullScreen = t.width > 0 && t.height > 0), this.texturePool))
              if (Number(e) < 0) {
                var r = this.texturePool[e];
                if (r) for (var i = 0; i < r.length; i++) r[i].destroy(!0);
                this.texturePool[e] = [];
              }
            (this._pixelsWidth = t.width), (this._pixelsHeight = t.height);
          }
        }),
        (e.SCREEN_KEY = -1),
        e
      );
    })(),
    Si = (function () {
      function e(e, r, i, n, o, s, a) {
        void 0 === r && (r = 0),
          void 0 === i && (i = !1),
          void 0 === n && (n = t.TYPES.FLOAT),
          (this.buffer = e),
          (this.size = r),
          (this.normalized = i),
          (this.type = n),
          (this.stride = o),
          (this.start = s),
          (this.instance = a);
      }
      return (
        (e.prototype.destroy = function () {
          this.buffer = null;
        }),
        (e.from = function (t, r, i, n, o) {
          return new e(t, r, i, n, o);
        }),
        e
      );
    })(),
    Oi = 0,
    Ii = (function () {
      function e(t, e, r) {
        void 0 === e && (e = !0),
          void 0 === r && (r = !1),
          (this.data = t || new Float32Array(1)),
          (this._glBuffers = {}),
          (this._updateID = 0),
          (this.index = r),
          (this.static = e),
          (this.id = Oi++),
          (this.disposeRunner = new Qr("disposeBuffer"));
      }
      return (
        (e.prototype.update = function (t) {
          t instanceof Array && (t = new Float32Array(t)),
            (this.data = t || this.data),
            this._updateID++;
        }),
        (e.prototype.dispose = function () {
          this.disposeRunner.emit(this, !1);
        }),
        (e.prototype.destroy = function () {
          this.dispose(), (this.data = null);
        }),
        Object.defineProperty(e.prototype, "index", {
          get: function () {
            return this.type === t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;
          },
          set: function (e) {
            this.type = e ? t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER : t.BUFFER_TYPE.ARRAY_BUFFER;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.from = function (t) {
          return t instanceof Array && (t = new Float32Array(t)), new e(t);
        }),
        e
      );
    })(),
    Pi = {
      Float32Array: Float32Array,
      Uint32Array: Uint32Array,
      Int32Array: Int32Array,
      Uint8Array: Uint8Array,
    },
    Mi = { 5126: 4, 5123: 2, 5121: 1 },
    Ni = 0,
    Di = {
      Float32Array: Float32Array,
      Uint32Array: Uint32Array,
      Int32Array: Int32Array,
      Uint8Array: Uint8Array,
      Uint16Array: Uint16Array,
    },
    Ci = (function () {
      function e(t, e) {
        void 0 === t && (t = []),
          void 0 === e && (e = {}),
          (this.buffers = t),
          (this.indexBuffer = null),
          (this.attributes = e),
          (this.glVertexArrayObjects = {}),
          (this.id = Ni++),
          (this.instanced = !1),
          (this.instanceCount = 1),
          (this.disposeRunner = new Qr("disposeGeometry")),
          (this.refCount = 0);
      }
      return (
        (e.prototype.addAttribute = function (t, e, r, i, n, o, s, a) {
          if ((void 0 === r && (r = 0), void 0 === i && (i = !1), void 0 === a && (a = !1), !e))
            throw new Error("You must pass a buffer when creating an attribute");
          e instanceof Ii || (e instanceof Array && (e = new Float32Array(e)), (e = new Ii(e)));
          var h = t.split("|");
          if (h.length > 1) {
            for (var u = 0; u < h.length; u++) this.addAttribute(h[u], e, r, i, n);
            return this;
          }
          var l = this.buffers.indexOf(e);
          return (
            -1 === l && (this.buffers.push(e), (l = this.buffers.length - 1)),
            (this.attributes[t] = new Si(l, r, i, n, o, s, a)),
            (this.instanced = this.instanced || a),
            this
          );
        }),
        (e.prototype.getAttribute = function (t) {
          return this.attributes[t];
        }),
        (e.prototype.getBuffer = function (t) {
          return this.buffers[this.getAttribute(t).buffer];
        }),
        (e.prototype.addIndex = function (e) {
          return (
            e instanceof Ii || (e instanceof Array && (e = new Uint16Array(e)), (e = new Ii(e))),
            (e.type = t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),
            (this.indexBuffer = e),
            -1 === this.buffers.indexOf(e) && this.buffers.push(e),
            this
          );
        }),
        (e.prototype.getIndex = function () {
          return this.indexBuffer;
        }),
        (e.prototype.interleave = function () {
          if (1 === this.buffers.length || (2 === this.buffers.length && this.indexBuffer))
            return this;
          var t,
            e = [],
            r = [],
            i = new Ii();
          for (t in this.attributes) {
            var n = this.attributes[t],
              o = this.buffers[n.buffer];
            e.push(o.data), r.push((n.size * Mi[n.type]) / 4), (n.buffer = 0);
          }
          for (
            i.data = (function (t, e) {
              for (var r = 0, i = 0, n = {}, o = 0; o < t.length; o++)
                (i += e[o]), (r += t[o].length);
              var s = new ArrayBuffer(4 * r),
                a = null,
                h = 0;
              for (o = 0; o < t.length; o++) {
                var u = e[o],
                  l = t[o],
                  c = ye(l);
                n[c] || (n[c] = new Pi[c](s)), (a = n[c]);
                for (var d = 0; d < l.length; d++) a[((d / u) | 0) * i + h + (d % u)] = l[d];
                h += u;
              }
              return new Float32Array(s);
            })(e, r),
              t = 0;
            t < this.buffers.length;
            t++
          )
            this.buffers[t] !== this.indexBuffer && this.buffers[t].destroy();
          return (
            (this.buffers = [i]), this.indexBuffer && this.buffers.push(this.indexBuffer), this
          );
        }),
        (e.prototype.getSize = function () {
          for (var t in this.attributes) {
            var e = this.attributes[t];
            return this.buffers[e.buffer].data.length / (e.stride / 4 || e.size);
          }
          return 0;
        }),
        (e.prototype.dispose = function () {
          this.disposeRunner.emit(this, !1);
        }),
        (e.prototype.destroy = function () {
          this.dispose(),
            (this.buffers = null),
            (this.indexBuffer = null),
            (this.attributes = null);
        }),
        (e.prototype.clone = function () {
          for (var r = new e(), i = 0; i < this.buffers.length; i++)
            r.buffers[i] = new Ii(this.buffers[i].data.slice(0));
          for (var i in this.attributes) {
            var n = this.attributes[i];
            r.attributes[i] = new Si(
              n.buffer,
              n.size,
              n.normalized,
              n.type,
              n.stride,
              n.start,
              n.instance
            );
          }
          return (
            this.indexBuffer &&
              ((r.indexBuffer = r.buffers[this.buffers.indexOf(this.indexBuffer)]),
              (r.indexBuffer.type = t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER)),
            r
          );
        }),
        (e.merge = function (r) {
          for (var i, n = new e(), o = [], s = [], a = [], h = 0; h < r.length; h++) {
            i = r[h];
            for (var u = 0; u < i.buffers.length; u++)
              (s[u] = s[u] || 0), (s[u] += i.buffers[u].data.length), (a[u] = 0);
          }
          for (h = 0; h < i.buffers.length; h++)
            (o[h] = new Di[ye(i.buffers[h].data)](s[h])), (n.buffers[h] = new Ii(o[h]));
          for (h = 0; h < r.length; h++)
            for (i = r[h], u = 0; u < i.buffers.length; u++)
              o[u].set(i.buffers[u].data, a[u]), (a[u] += i.buffers[u].data.length);
          if (((n.attributes = i.attributes), i.indexBuffer)) {
            (n.indexBuffer = n.buffers[i.buffers.indexOf(i.indexBuffer)]),
              (n.indexBuffer.type = t.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER);
            var l = 0,
              c = 0,
              d = 0,
              f = 0;
            for (h = 0; h < i.buffers.length; h++)
              if (i.buffers[h] !== i.indexBuffer) {
                f = h;
                break;
              }
            for (var h in i.attributes) {
              var p = i.attributes[h];
              (0 | p.buffer) === f && (c += (p.size * Mi[p.type]) / 4);
            }
            for (h = 0; h < r.length; h++) {
              var _ = r[h].indexBuffer.data;
              for (u = 0; u < _.length; u++) n.indexBuffer.data[u + d] += l;
              (l += r[h].buffers[f].data.length / c), (d += _.length);
            }
          }
          return n;
        }),
        e
      );
    })(),
    Li = (function (t) {
      function e() {
        var e = t.call(this) || this;
        return (
          e
            .addAttribute("aVertexPosition", new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]))
            .addIndex([0, 1, 3, 2]),
          e
        );
      }
      return ei(e, t), e;
    })(Ci),
    wi = (function (t) {
      function e() {
        var e = t.call(this) || this;
        return (
          (e.vertices = new Float32Array([-1, -1, 1, -1, 1, 1, -1, 1])),
          (e.uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1])),
          (e.vertexBuffer = new Ii(e.vertices)),
          (e.uvBuffer = new Ii(e.uvs)),
          e
            .addAttribute("aVertexPosition", e.vertexBuffer)
            .addAttribute("aTextureCoord", e.uvBuffer)
            .addIndex([0, 1, 2, 0, 2, 3]),
          e
        );
      }
      return (
        ei(e, t),
        (e.prototype.map = function (t, e) {
          var r = 0,
            i = 0;
          return (
            (this.uvs[0] = r),
            (this.uvs[1] = i),
            (this.uvs[2] = r + e.width / t.width),
            (this.uvs[3] = i),
            (this.uvs[4] = r + e.width / t.width),
            (this.uvs[5] = i + e.height / t.height),
            (this.uvs[6] = r),
            (this.uvs[7] = i + e.height / t.height),
            (r = e.x),
            (i = e.y),
            (this.vertices[0] = r),
            (this.vertices[1] = i),
            (this.vertices[2] = r + e.width),
            (this.vertices[3] = i),
            (this.vertices[4] = r + e.width),
            (this.vertices[5] = i + e.height),
            (this.vertices[6] = r),
            (this.vertices[7] = i + e.height),
            this.invalidate(),
            this
          );
        }),
        (e.prototype.invalidate = function () {
          return this.vertexBuffer._updateID++, this.uvBuffer._updateID++, this;
        }),
        e
      );
    })(Ci),
    Fi = 0,
    Ui = (function () {
      function e(e, r, i) {
        (this.group = !0),
          (this.syncUniforms = {}),
          (this.dirtyId = 0),
          (this.id = Fi++),
          (this.static = !!r),
          (this.ubo = !!i),
          e instanceof Ii
            ? ((this.buffer = e),
              (this.buffer.type = t.BUFFER_TYPE.UNIFORM_BUFFER),
              (this.autoManage = !1),
              (this.ubo = !0))
            : ((this.uniforms = e),
              this.ubo &&
                ((this.buffer = new Ii(new Float32Array(1))),
                (this.buffer.type = t.BUFFER_TYPE.UNIFORM_BUFFER),
                (this.autoManage = !0)));
      }
      return (
        (e.prototype.update = function () {
          this.dirtyId++, !this.autoManage && this.buffer && this.buffer.update();
        }),
        (e.prototype.add = function (t, r, i) {
          if (this.ubo)
            throw new Error(
              "[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them"
            );
          this.uniforms[t] = new e(r, i);
        }),
        (e.from = function (t, r, i) {
          return new e(t, r, i);
        }),
        (e.uboFrom = function (t, r) {
          return new e(t, null == r || r, !0);
        }),
        e
      );
    })(),
    Bi = (function () {
      function e() {
        (this.renderTexture = null),
          (this.target = null),
          (this.legacy = !1),
          (this.resolution = 1),
          (this.multisample = t.MSAA_QUALITY.NONE),
          (this.sourceFrame = new Ve()),
          (this.destinationFrame = new Ve()),
          (this.bindingSourceFrame = new Ve()),
          (this.bindingDestinationFrame = new Ve()),
          (this.filters = []),
          (this.transform = null);
      }
      return (
        (e.prototype.clear = function () {
          (this.target = null), (this.filters = null), (this.renderTexture = null);
        }),
        e
      );
    })(),
    Gi = [new Ye(), new Ye(), new Ye(), new Ye()],
    Xi = new Qe(),
    ki = (function () {
      function e(t) {
        (this.renderer = t),
          (this.defaultFilterStack = [{}]),
          (this.texturePool = new xi()),
          this.texturePool.setScreenSize(t.view),
          (this.statePool = []),
          (this.quad = new Li()),
          (this.quadUv = new wi()),
          (this.tempRect = new Ve()),
          (this.activeState = {}),
          (this.globalUniforms = new Ui(
            {
              outputFrame: new Ve(),
              inputSize: new Float32Array(4),
              inputPixel: new Float32Array(4),
              inputClamp: new Float32Array(4),
              resolution: 1,
              filterArea: new Float32Array(4),
              filterClamp: new Float32Array(4),
            },
            !0
          )),
          (this.forceClear = !1),
          (this.useMaxPadding = !1);
      }
      return (
        (e.prototype.push = function (t, e) {
          for (
            var r,
              i,
              n = this.renderer,
              o = this.defaultFilterStack,
              s = this.statePool.pop() || new Bi(),
              a = this.renderer.renderTexture,
              h = e[0].resolution,
              u = e[0].multisample,
              l = e[0].padding,
              c = e[0].autoFit,
              d = null === (r = e[0].legacy) || void 0 === r || r,
              f = 1;
            f < e.length;
            f++
          ) {
            var p = e[f];
            (h = Math.min(h, p.resolution)),
              (u = Math.min(u, p.multisample)),
              (l = this.useMaxPadding ? Math.max(l, p.padding) : l + p.padding),
              (c = c && p.autoFit),
              (d = d || null === (i = p.legacy) || void 0 === i || i);
          }
          if (
            (1 === o.length && (this.defaultFilterStack[0].renderTexture = a.current),
            o.push(s),
            (s.resolution = h),
            (s.multisample = u),
            (s.legacy = d),
            (s.target = t),
            s.sourceFrame.copyFrom(t.filterArea || t.getBounds(!0)),
            s.sourceFrame.pad(l),
            c)
          ) {
            var _ = this.tempRect.copyFrom(a.sourceFrame);
            n.projection.transform &&
              this.transformAABB(Xi.copyFrom(n.projection.transform).invert(), _),
              s.sourceFrame.fit(_);
          }
          this.roundFrame(
            s.sourceFrame,
            a.current ? a.current.resolution : n.resolution,
            a.sourceFrame,
            a.destinationFrame,
            n.projection.transform
          ),
            (s.renderTexture = this.getOptimalFilterTexture(
              s.sourceFrame.width,
              s.sourceFrame.height,
              h,
              u
            )),
            (s.filters = e),
            (s.destinationFrame.width = s.renderTexture.width),
            (s.destinationFrame.height = s.renderTexture.height);
          var m = this.tempRect;
          (m.x = 0),
            (m.y = 0),
            (m.width = s.sourceFrame.width),
            (m.height = s.sourceFrame.height),
            (s.renderTexture.filterFrame = s.sourceFrame),
            s.bindingSourceFrame.copyFrom(a.sourceFrame),
            s.bindingDestinationFrame.copyFrom(a.destinationFrame),
            (s.transform = n.projection.transform),
            (n.projection.transform = null),
            a.bind(s.renderTexture, s.sourceFrame, m),
            n.framebuffer.clear(0, 0, 0, 0);
        }),
        (e.prototype.pop = function () {
          var e = this.defaultFilterStack,
            r = e.pop(),
            i = r.filters;
          this.activeState = r;
          var n = this.globalUniforms.uniforms;
          (n.outputFrame = r.sourceFrame), (n.resolution = r.resolution);
          var o = n.inputSize,
            s = n.inputPixel,
            a = n.inputClamp;
          if (
            ((o[0] = r.destinationFrame.width),
            (o[1] = r.destinationFrame.height),
            (o[2] = 1 / o[0]),
            (o[3] = 1 / o[1]),
            (s[0] = Math.round(o[0] * r.resolution)),
            (s[1] = Math.round(o[1] * r.resolution)),
            (s[2] = 1 / s[0]),
            (s[3] = 1 / s[1]),
            (a[0] = 0.5 * s[2]),
            (a[1] = 0.5 * s[3]),
            (a[2] = r.sourceFrame.width * o[2] - 0.5 * s[2]),
            (a[3] = r.sourceFrame.height * o[3] - 0.5 * s[3]),
            r.legacy)
          ) {
            var h = n.filterArea;
            (h[0] = r.destinationFrame.width),
              (h[1] = r.destinationFrame.height),
              (h[2] = r.sourceFrame.x),
              (h[3] = r.sourceFrame.y),
              (n.filterClamp = n.inputClamp);
          }
          this.globalUniforms.update();
          var u = e[e.length - 1];
          if ((this.renderer.framebuffer.blit(), 1 === i.length))
            i[0].apply(this, r.renderTexture, u.renderTexture, t.CLEAR_MODES.BLEND, r),
              this.returnFilterTexture(r.renderTexture);
          else {
            var l = r.renderTexture,
              c = this.getOptimalFilterTexture(l.width, l.height, r.resolution);
            c.filterFrame = l.filterFrame;
            var d = 0;
            for (d = 0; d < i.length - 1; ++d) {
              1 === d &&
                r.multisample > 1 &&
                ((c = this.getOptimalFilterTexture(l.width, l.height, r.resolution)).filterFrame =
                  l.filterFrame),
                i[d].apply(this, l, c, t.CLEAR_MODES.CLEAR, r);
              var f = l;
              (l = c), (c = f);
            }
            i[d].apply(this, l, u.renderTexture, t.CLEAR_MODES.BLEND, r),
              d > 1 && r.multisample > 1 && this.returnFilterTexture(r.renderTexture),
              this.returnFilterTexture(l),
              this.returnFilterTexture(c);
          }
          r.clear(), this.statePool.push(r);
        }),
        (e.prototype.bindAndClear = function (e, r) {
          void 0 === r && (r = t.CLEAR_MODES.CLEAR);
          var i = this.renderer,
            n = i.renderTexture,
            o = i.state;
          if (
            (e === this.defaultFilterStack[this.defaultFilterStack.length - 1].renderTexture
              ? (this.renderer.projection.transform = this.activeState.transform)
              : (this.renderer.projection.transform = null),
            e && e.filterFrame)
          ) {
            var s = this.tempRect;
            (s.x = 0),
              (s.y = 0),
              (s.width = e.filterFrame.width),
              (s.height = e.filterFrame.height),
              n.bind(e, e.filterFrame, s);
          } else
            e !== this.defaultFilterStack[this.defaultFilterStack.length - 1].renderTexture
              ? n.bind(e)
              : this.renderer.renderTexture.bind(
                  e,
                  this.activeState.bindingSourceFrame,
                  this.activeState.bindingDestinationFrame
                );
          var a = 1 & o.stateId || this.forceClear;
          (r === t.CLEAR_MODES.CLEAR || (r === t.CLEAR_MODES.BLIT && a)) &&
            this.renderer.framebuffer.clear(0, 0, 0, 0);
        }),
        (e.prototype.applyFilter = function (e, r, i, n) {
          var o = this.renderer;
          o.state.set(e.state),
            this.bindAndClear(i, n),
            (e.uniforms.uSampler = r),
            (e.uniforms.filterGlobals = this.globalUniforms),
            o.shader.bind(e),
            (e.legacy = !!e.program.attributeData.aTextureCoord),
            e.legacy
              ? (this.quadUv.map(r._frame, r.filterFrame),
                o.geometry.bind(this.quadUv),
                o.geometry.draw(t.DRAW_MODES.TRIANGLES))
              : (o.geometry.bind(this.quad), o.geometry.draw(t.DRAW_MODES.TRIANGLE_STRIP));
        }),
        (e.prototype.calculateSpriteMatrix = function (t, e) {
          var r = this.activeState,
            i = r.sourceFrame,
            n = r.destinationFrame,
            o = e._texture.orig,
            s = t.set(n.width, 0, 0, n.height, i.x, i.y),
            a = e.worldTransform.copyTo(Qe.TEMP_MATRIX);
          return (
            a.invert(),
            s.prepend(a),
            s.scale(1 / o.width, 1 / o.height),
            s.translate(e.anchor.x, e.anchor.y),
            s
          );
        }),
        (e.prototype.destroy = function () {
          (this.renderer = null), this.texturePool.clear(!1);
        }),
        (e.prototype.getOptimalFilterTexture = function (e, r, i, n) {
          return (
            void 0 === i && (i = 1),
            void 0 === n && (n = t.MSAA_QUALITY.NONE),
            this.texturePool.getOptimalTexture(e, r, i, n)
          );
        }),
        (e.prototype.getFilterTexture = function (e, r, i) {
          if ("number" == typeof e) {
            var n = e;
            (e = r), (r = n);
          }
          e = e || this.activeState.renderTexture;
          var o = this.texturePool.getOptimalTexture(
            e.width,
            e.height,
            r || e.resolution,
            i || t.MSAA_QUALITY.NONE
          );
          return (o.filterFrame = e.filterFrame), o;
        }),
        (e.prototype.returnFilterTexture = function (t) {
          this.texturePool.returnTexture(t);
        }),
        (e.prototype.emptyPool = function () {
          this.texturePool.clear(!0);
        }),
        (e.prototype.resize = function () {
          this.texturePool.setScreenSize(this.renderer.view);
        }),
        (e.prototype.transformAABB = function (t, e) {
          var r = Gi[0],
            i = Gi[1],
            n = Gi[2],
            o = Gi[3];
          r.set(e.left, e.top),
            i.set(e.left, e.bottom),
            n.set(e.right, e.top),
            o.set(e.right, e.bottom),
            t.apply(r, r),
            t.apply(i, i),
            t.apply(n, n),
            t.apply(o, o);
          var s = Math.min(r.x, i.x, n.x, o.x),
            a = Math.min(r.y, i.y, n.y, o.y),
            h = Math.max(r.x, i.x, n.x, o.x),
            u = Math.max(r.y, i.y, n.y, o.y);
          (e.x = s), (e.y = a), (e.width = h - s), (e.height = u - a);
        }),
        (e.prototype.roundFrame = function (t, e, r, i, n) {
          if (!(t.width <= 0 || t.height <= 0 || r.width <= 0 || r.height <= 0)) {
            if (n) {
              var o = n.a,
                s = n.b,
                a = n.c,
                h = n.d;
              if (
                (Math.abs(s) > 1e-4 || Math.abs(a) > 1e-4) &&
                (Math.abs(o) > 1e-4 || Math.abs(h) > 1e-4)
              )
                return;
            }
            (n = n ? Xi.copyFrom(n) : Xi.identity())
              .translate(-r.x, -r.y)
              .scale(i.width / r.width, i.height / r.height)
              .translate(i.x, i.y),
              this.transformAABB(n, t),
              t.ceil(e),
              this.transformAABB(n.invert(), t);
          }
        }),
        e
      );
    })(),
    Hi = (function () {
      function t(t) {
        this.renderer = t;
      }
      return (
        (t.prototype.flush = function () {}),
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        (t.prototype.start = function () {}),
        (t.prototype.stop = function () {
          this.flush();
        }),
        (t.prototype.render = function (t) {}),
        t
      );
    })(),
    Yi = (function () {
      function t(t) {
        (this.renderer = t),
          (this.emptyRenderer = new Hi(t)),
          (this.currentRenderer = this.emptyRenderer);
      }
      return (
        (t.prototype.setObjectRenderer = function (t) {
          this.currentRenderer !== t &&
            (this.currentRenderer.stop(), (this.currentRenderer = t), this.currentRenderer.start());
        }),
        (t.prototype.flush = function () {
          this.setObjectRenderer(this.emptyRenderer);
        }),
        (t.prototype.reset = function () {
          this.setObjectRenderer(this.emptyRenderer);
        }),
        (t.prototype.copyBoundTextures = function (t, e) {
          for (var r = this.renderer.texture.boundTextures, i = e - 1; i >= 0; --i)
            (t[i] = r[i] || null), t[i] && (t[i]._batchLocation = i);
        }),
        (t.prototype.boundArray = function (t, e, r, i) {
          for (var n = t.elements, o = t.ids, s = t.count, a = 0, h = 0; h < s; h++) {
            var u = n[h],
              l = u._batchLocation;
            if (l >= 0 && l < i && e[l] === u) o[h] = l;
            else
              for (; a < i; ) {
                var c = e[a];
                if (!c || c._batchEnabled !== r || c._batchLocation !== a) {
                  (o[h] = a), (u._batchLocation = a), (e[a] = u);
                  break;
                }
                a++;
              }
          }
        }),
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        t
      );
    })(),
    ji = 0,
    Vi = (function () {
      function e(t) {
        (this.renderer = t),
          (this.webGLVersion = 1),
          (this.extensions = {}),
          (this.supports = { uint32Indices: !1 }),
          (this.handleContextLost = this.handleContextLost.bind(this)),
          (this.handleContextRestored = this.handleContextRestored.bind(this)),
          t.view.addEventListener("webglcontextlost", this.handleContextLost, !1),
          t.view.addEventListener("webglcontextrestored", this.handleContextRestored, !1);
      }
      return (
        Object.defineProperty(e.prototype, "isLost", {
          get: function () {
            return !this.gl || this.gl.isContextLost();
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.contextChange = function (t) {
          (this.gl = t),
            (this.renderer.gl = t),
            (this.renderer.CONTEXT_UID = ji++),
            t.isContextLost() &&
              t.getExtension("WEBGL_lose_context") &&
              t.getExtension("WEBGL_lose_context").restoreContext();
        }),
        (e.prototype.initFromContext = function (t) {
          (this.gl = t),
            this.validateContext(t),
            (this.renderer.gl = t),
            (this.renderer.CONTEXT_UID = ji++),
            this.renderer.runners.contextChange.emit(t);
        }),
        (e.prototype.initFromOptions = function (t) {
          var e = this.createContext(this.renderer.view, t);
          this.initFromContext(e);
        }),
        (e.prototype.createContext = function (e, r) {
          var i;
          if ((rt.PREFER_ENV >= t.ENV.WEBGL2 && (i = e.getContext("webgl2", r)), i))
            this.webGLVersion = 2;
          else if (
            ((this.webGLVersion = 1),
            !(i = e.getContext("webgl", r) || e.getContext("experimental-webgl", r)))
          )
            throw new Error("This browser does not support WebGL. Try using the canvas renderer");
          return (this.gl = i), this.getExtensions(), this.gl;
        }),
        (e.prototype.getExtensions = function () {
          var t = this.gl,
            e = {
              anisotropicFiltering: t.getExtension("EXT_texture_filter_anisotropic"),
              floatTextureLinear: t.getExtension("OES_texture_float_linear"),
              s3tc: t.getExtension("WEBGL_compressed_texture_s3tc"),
              s3tc_sRGB: t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),
              etc: t.getExtension("WEBGL_compressed_texture_etc"),
              etc1: t.getExtension("WEBGL_compressed_texture_etc1"),
              pvrtc:
                t.getExtension("WEBGL_compressed_texture_pvrtc") ||
                t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),
              atc: t.getExtension("WEBGL_compressed_texture_atc"),
              astc: t.getExtension("WEBGL_compressed_texture_astc"),
            };
          1 === this.webGLVersion
            ? Object.assign(this.extensions, e, {
                drawBuffers: t.getExtension("WEBGL_draw_buffers"),
                depthTexture: t.getExtension("WEBGL_depth_texture"),
                loseContext: t.getExtension("WEBGL_lose_context"),
                vertexArrayObject:
                  t.getExtension("OES_vertex_array_object") ||
                  t.getExtension("MOZ_OES_vertex_array_object") ||
                  t.getExtension("WEBKIT_OES_vertex_array_object"),
                uint32ElementIndex: t.getExtension("OES_element_index_uint"),
                floatTexture: t.getExtension("OES_texture_float"),
                floatTextureLinear: t.getExtension("OES_texture_float_linear"),
                textureHalfFloat: t.getExtension("OES_texture_half_float"),
                textureHalfFloatLinear: t.getExtension("OES_texture_half_float_linear"),
              })
            : 2 === this.webGLVersion &&
              Object.assign(this.extensions, e, {
                colorBufferFloat: t.getExtension("EXT_color_buffer_float"),
              });
        }),
        (e.prototype.handleContextLost = function (t) {
          t.preventDefault();
        }),
        (e.prototype.handleContextRestored = function () {
          this.renderer.runners.contextChange.emit(this.gl);
        }),
        (e.prototype.destroy = function () {
          var t = this.renderer.view;
          (this.renderer = null),
            t.removeEventListener("webglcontextlost", this.handleContextLost),
            t.removeEventListener("webglcontextrestored", this.handleContextRestored),
            this.gl.useProgram(null),
            this.extensions.loseContext && this.extensions.loseContext.loseContext();
        }),
        (e.prototype.postrender = function () {
          this.renderer.renderingToScreen && this.gl.flush();
        }),
        (e.prototype.validateContext = function (t) {
          var e = t.getContextAttributes(),
            r =
              "WebGL2RenderingContext" in globalThis &&
              t instanceof globalThis.WebGL2RenderingContext;
          r && (this.webGLVersion = 2),
            e.stencil ||
              console.warn(
                "Provided WebGL context does not have a stencil buffer, masks may not render correctly"
              );
          var i = r || !!t.getExtension("OES_element_index_uint");
          (this.supports.uint32Indices = i),
            i ||
              console.warn(
                "Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly"
              );
        }),
        e
      );
    })(),
    Wi = function (e) {
      (this.framebuffer = e),
        (this.stencil = null),
        (this.dirtyId = -1),
        (this.dirtyFormat = -1),
        (this.dirtySize = -1),
        (this.multisample = t.MSAA_QUALITY.NONE),
        (this.msaaBuffer = null),
        (this.blitFramebuffer = null),
        (this.mipLevel = 0);
    },
    zi = new Ve(),
    qi = (function () {
      function e(t) {
        (this.renderer = t),
          (this.managedFramebuffers = []),
          (this.unknownFramebuffer = new Ei(10, 10)),
          (this.msaaSamples = null);
      }
      return (
        (e.prototype.contextChange = function () {
          var e = (this.gl = this.renderer.gl);
          if (
            ((this.CONTEXT_UID = this.renderer.CONTEXT_UID),
            (this.current = this.unknownFramebuffer),
            (this.viewport = new Ve()),
            (this.hasMRT = !0),
            (this.writeDepthTexture = !0),
            this.disposeAll(!0),
            1 === this.renderer.context.webGLVersion)
          ) {
            var r = this.renderer.context.extensions.drawBuffers,
              i = this.renderer.context.extensions.depthTexture;
            rt.PREFER_ENV === t.ENV.WEBGL_LEGACY && ((r = null), (i = null)),
              r
                ? (e.drawBuffers = function (t) {
                    return r.drawBuffersWEBGL(t);
                  })
                : ((this.hasMRT = !1), (e.drawBuffers = function () {})),
              i || (this.writeDepthTexture = !1);
          } else
            this.msaaSamples = e.getInternalformatParameter(e.RENDERBUFFER, e.RGBA8, e.SAMPLES);
        }),
        (e.prototype.bind = function (t, e, r) {
          void 0 === r && (r = 0);
          var i = this.gl;
          if (t) {
            var n = t.glFramebuffers[this.CONTEXT_UID] || this.initFramebuffer(t);
            this.current !== t &&
              ((this.current = t), i.bindFramebuffer(i.FRAMEBUFFER, n.framebuffer)),
              n.mipLevel !== r && (t.dirtyId++, t.dirtyFormat++, (n.mipLevel = r)),
              n.dirtyId !== t.dirtyId &&
                ((n.dirtyId = t.dirtyId),
                n.dirtyFormat !== t.dirtyFormat
                  ? ((n.dirtyFormat = t.dirtyFormat),
                    (n.dirtySize = t.dirtySize),
                    this.updateFramebuffer(t, r))
                  : n.dirtySize !== t.dirtySize &&
                    ((n.dirtySize = t.dirtySize), this.resizeFramebuffer(t)));
            for (var o = 0; o < t.colorTextures.length; o++) {
              var s = t.colorTextures[o];
              this.renderer.texture.unbind(s.parentTextureArray || s);
            }
            if ((t.depthTexture && this.renderer.texture.unbind(t.depthTexture), e)) {
              var a = e.width >> r,
                h = e.height >> r,
                u = a / e.width;
              this.setViewport(e.x * u, e.y * u, a, h);
            } else (a = t.width >> r), (h = t.height >> r), this.setViewport(0, 0, a, h);
          } else
            this.current && ((this.current = null), i.bindFramebuffer(i.FRAMEBUFFER, null)),
              e
                ? this.setViewport(e.x, e.y, e.width, e.height)
                : this.setViewport(0, 0, this.renderer.width, this.renderer.height);
        }),
        (e.prototype.setViewport = function (t, e, r, i) {
          var n = this.viewport;
          (t = Math.round(t)),
            (e = Math.round(e)),
            (r = Math.round(r)),
            (i = Math.round(i)),
            (n.width === r && n.height === i && n.x === t && n.y === e) ||
              ((n.x = t), (n.y = e), (n.width = r), (n.height = i), this.gl.viewport(t, e, r, i));
        }),
        Object.defineProperty(e.prototype, "size", {
          get: function () {
            return this.current
              ? { x: 0, y: 0, width: this.current.width, height: this.current.height }
              : { x: 0, y: 0, width: this.renderer.width, height: this.renderer.height };
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.clear = function (e, r, i, n, o) {
          void 0 === o && (o = t.BUFFER_BITS.COLOR | t.BUFFER_BITS.DEPTH);
          var s = this.gl;
          s.clearColor(e, r, i, n), s.clear(o);
        }),
        (e.prototype.initFramebuffer = function (t) {
          var e = this.gl,
            r = new Wi(e.createFramebuffer());
          return (
            (r.multisample = this.detectSamples(t.multisample)),
            (t.glFramebuffers[this.CONTEXT_UID] = r),
            this.managedFramebuffers.push(t),
            t.disposeRunner.add(this),
            r
          );
        }),
        (e.prototype.resizeFramebuffer = function (t) {
          var e = this.gl,
            r = t.glFramebuffers[this.CONTEXT_UID];
          r.msaaBuffer &&
            (e.bindRenderbuffer(e.RENDERBUFFER, r.msaaBuffer),
            e.renderbufferStorageMultisample(
              e.RENDERBUFFER,
              r.multisample,
              e.RGBA8,
              t.width,
              t.height
            )),
            r.stencil &&
              (e.bindRenderbuffer(e.RENDERBUFFER, r.stencil),
              r.msaaBuffer
                ? e.renderbufferStorageMultisample(
                    e.RENDERBUFFER,
                    r.multisample,
                    e.DEPTH24_STENCIL8,
                    t.width,
                    t.height
                  )
                : e.renderbufferStorage(e.RENDERBUFFER, e.DEPTH_STENCIL, t.width, t.height));
          var i = t.colorTextures,
            n = i.length;
          e.drawBuffers || (n = Math.min(n, 1));
          for (var o = 0; o < n; o++) {
            var s = i[o],
              a = s.parentTextureArray || s;
            this.renderer.texture.bind(a, 0);
          }
          t.depthTexture && this.writeDepthTexture && this.renderer.texture.bind(t.depthTexture, 0);
        }),
        (e.prototype.updateFramebuffer = function (t, e) {
          var r = this.gl,
            i = t.glFramebuffers[this.CONTEXT_UID],
            n = t.colorTextures,
            o = n.length;
          r.drawBuffers || (o = Math.min(o, 1)),
            i.multisample > 1 && this.canMultisampleFramebuffer(t)
              ? ((i.msaaBuffer = i.msaaBuffer || r.createRenderbuffer()),
                r.bindRenderbuffer(r.RENDERBUFFER, i.msaaBuffer),
                r.renderbufferStorageMultisample(
                  r.RENDERBUFFER,
                  i.multisample,
                  r.RGBA8,
                  t.width,
                  t.height
                ),
                r.framebufferRenderbuffer(
                  r.FRAMEBUFFER,
                  r.COLOR_ATTACHMENT0,
                  r.RENDERBUFFER,
                  i.msaaBuffer
                ))
              : i.msaaBuffer &&
                (r.deleteRenderbuffer(i.msaaBuffer),
                (i.msaaBuffer = null),
                i.blitFramebuffer && (i.blitFramebuffer.dispose(), (i.blitFramebuffer = null)));
          for (var s = [], a = 0; a < o; a++) {
            var h = n[a],
              u = h.parentTextureArray || h;
            this.renderer.texture.bind(u, 0),
              (0 === a && i.msaaBuffer) ||
                (r.framebufferTexture2D(
                  r.FRAMEBUFFER,
                  r.COLOR_ATTACHMENT0 + a,
                  h.target,
                  u._glTextures[this.CONTEXT_UID].texture,
                  e
                ),
                s.push(r.COLOR_ATTACHMENT0 + a));
          }
          if ((s.length > 1 && r.drawBuffers(s), t.depthTexture && this.writeDepthTexture)) {
            var l = t.depthTexture;
            this.renderer.texture.bind(l, 0),
              r.framebufferTexture2D(
                r.FRAMEBUFFER,
                r.DEPTH_ATTACHMENT,
                r.TEXTURE_2D,
                l._glTextures[this.CONTEXT_UID].texture,
                e
              );
          }
          (!t.stencil && !t.depth) || (t.depthTexture && this.writeDepthTexture)
            ? i.stencil && (r.deleteRenderbuffer(i.stencil), (i.stencil = null))
            : ((i.stencil = i.stencil || r.createRenderbuffer()),
              r.bindRenderbuffer(r.RENDERBUFFER, i.stencil),
              i.msaaBuffer
                ? r.renderbufferStorageMultisample(
                    r.RENDERBUFFER,
                    i.multisample,
                    r.DEPTH24_STENCIL8,
                    t.width,
                    t.height
                  )
                : r.renderbufferStorage(r.RENDERBUFFER, r.DEPTH_STENCIL, t.width, t.height),
              r.framebufferRenderbuffer(
                r.FRAMEBUFFER,
                r.DEPTH_STENCIL_ATTACHMENT,
                r.RENDERBUFFER,
                i.stencil
              ));
        }),
        (e.prototype.canMultisampleFramebuffer = function (t) {
          return (
            1 !== this.renderer.context.webGLVersion &&
            t.colorTextures.length <= 1 &&
            !t.depthTexture
          );
        }),
        (e.prototype.detectSamples = function (e) {
          var r = this.msaaSamples,
            i = t.MSAA_QUALITY.NONE;
          if (e <= 1 || null === r) return i;
          for (var n = 0; n < r.length; n++)
            if (r[n] <= e) {
              i = r[n];
              break;
            }
          return 1 === i && (i = t.MSAA_QUALITY.NONE), i;
        }),
        (e.prototype.blit = function (t, e, r) {
          var i = this.current,
            n = this.renderer,
            o = this.gl,
            s = this.CONTEXT_UID;
          if (2 === n.context.webGLVersion && i) {
            var a = i.glFramebuffers[s];
            if (a) {
              if (!t) {
                if (!a.msaaBuffer) return;
                var h = i.colorTextures[0];
                if (!h) return;
                a.blitFramebuffer ||
                  ((a.blitFramebuffer = new Ei(i.width, i.height)),
                  a.blitFramebuffer.addColorTexture(0, h)),
                  (t = a.blitFramebuffer).colorTextures[0] !== h &&
                    ((t.colorTextures[0] = h), t.dirtyId++, t.dirtyFormat++),
                  (t.width === i.width && t.height === i.height) ||
                    ((t.width = i.width), (t.height = i.height), t.dirtyId++, t.dirtySize++);
              }
              e || (((e = zi).width = i.width), (e.height = i.height)), r || (r = e);
              var u = e.width === r.width && e.height === r.height;
              this.bind(t),
                o.bindFramebuffer(o.READ_FRAMEBUFFER, a.framebuffer),
                o.blitFramebuffer(
                  e.left,
                  e.top,
                  e.right,
                  e.bottom,
                  r.left,
                  r.top,
                  r.right,
                  r.bottom,
                  o.COLOR_BUFFER_BIT,
                  u ? o.NEAREST : o.LINEAR
                );
            }
          }
        }),
        (e.prototype.disposeFramebuffer = function (t, e) {
          var r = t.glFramebuffers[this.CONTEXT_UID],
            i = this.gl;
          if (r) {
            delete t.glFramebuffers[this.CONTEXT_UID];
            var n = this.managedFramebuffers.indexOf(t);
            n >= 0 && this.managedFramebuffers.splice(n, 1),
              t.disposeRunner.remove(this),
              e ||
                (i.deleteFramebuffer(r.framebuffer),
                r.msaaBuffer && i.deleteRenderbuffer(r.msaaBuffer),
                r.stencil && i.deleteRenderbuffer(r.stencil)),
              r.blitFramebuffer && r.blitFramebuffer.dispose();
          }
        }),
        (e.prototype.disposeAll = function (t) {
          var e = this.managedFramebuffers;
          this.managedFramebuffers = [];
          for (var r = 0; r < e.length; r++) this.disposeFramebuffer(e[r], t);
        }),
        (e.prototype.forceStencil = function () {
          var t = this.current;
          if (t) {
            var e = t.glFramebuffers[this.CONTEXT_UID];
            if (e && !e.stencil) {
              t.stencil = !0;
              var r = t.width,
                i = t.height,
                n = this.gl,
                o = n.createRenderbuffer();
              n.bindRenderbuffer(n.RENDERBUFFER, o),
                e.msaaBuffer
                  ? n.renderbufferStorageMultisample(
                      n.RENDERBUFFER,
                      e.multisample,
                      n.DEPTH24_STENCIL8,
                      r,
                      i
                    )
                  : n.renderbufferStorage(n.RENDERBUFFER, n.DEPTH_STENCIL, r, i),
                (e.stencil = o),
                n.framebufferRenderbuffer(
                  n.FRAMEBUFFER,
                  n.DEPTH_STENCIL_ATTACHMENT,
                  n.RENDERBUFFER,
                  o
                );
            }
          }
        }),
        (e.prototype.reset = function () {
          (this.current = this.unknownFramebuffer), (this.viewport = new Ve());
        }),
        (e.prototype.destroy = function () {
          this.renderer = null;
        }),
        e
      );
    })(),
    Ki = { 5126: 4, 5123: 2, 5121: 1 },
    Zi = (function () {
      function e(t) {
        (this.renderer = t),
          (this._activeGeometry = null),
          (this._activeVao = null),
          (this.hasVao = !0),
          (this.hasInstance = !0),
          (this.canUseUInt32ElementIndex = !1),
          (this.managedGeometries = {});
      }
      return (
        (e.prototype.contextChange = function () {
          this.disposeAll(!0);
          var e = (this.gl = this.renderer.gl),
            r = this.renderer.context;
          if (((this.CONTEXT_UID = this.renderer.CONTEXT_UID), 2 !== r.webGLVersion)) {
            var i = this.renderer.context.extensions.vertexArrayObject;
            rt.PREFER_ENV === t.ENV.WEBGL_LEGACY && (i = null),
              i
                ? ((e.createVertexArray = function () {
                    return i.createVertexArrayOES();
                  }),
                  (e.bindVertexArray = function (t) {
                    return i.bindVertexArrayOES(t);
                  }),
                  (e.deleteVertexArray = function (t) {
                    return i.deleteVertexArrayOES(t);
                  }))
                : ((this.hasVao = !1),
                  (e.createVertexArray = function () {
                    return null;
                  }),
                  (e.bindVertexArray = function () {
                    return null;
                  }),
                  (e.deleteVertexArray = function () {
                    return null;
                  }));
          }
          if (2 !== r.webGLVersion) {
            var n = e.getExtension("ANGLE_instanced_arrays");
            n
              ? ((e.vertexAttribDivisor = function (t, e) {
                  return n.vertexAttribDivisorANGLE(t, e);
                }),
                (e.drawElementsInstanced = function (t, e, r, i, o) {
                  return n.drawElementsInstancedANGLE(t, e, r, i, o);
                }),
                (e.drawArraysInstanced = function (t, e, r, i) {
                  return n.drawArraysInstancedANGLE(t, e, r, i);
                }))
              : (this.hasInstance = !1);
          }
          this.canUseUInt32ElementIndex = 2 === r.webGLVersion || !!r.extensions.uint32ElementIndex;
        }),
        (e.prototype.bind = function (t, e) {
          e = e || this.renderer.shader.shader;
          var r = this.gl,
            i = t.glVertexArrayObjects[this.CONTEXT_UID],
            n = !1;
          i ||
            ((this.managedGeometries[t.id] = t),
            t.disposeRunner.add(this),
            (t.glVertexArrayObjects[this.CONTEXT_UID] = i = {}),
            (n = !0));
          var o = i[e.program.id] || this.initGeometryVao(t, e, n);
          (this._activeGeometry = t),
            this._activeVao !== o &&
              ((this._activeVao = o),
              this.hasVao ? r.bindVertexArray(o) : this.activateVao(t, e.program)),
            this.updateBuffers();
        }),
        (e.prototype.reset = function () {
          this.unbind();
        }),
        (e.prototype.updateBuffers = function () {
          for (
            var t = this._activeGeometry, e = this.renderer.buffer, r = 0;
            r < t.buffers.length;
            r++
          ) {
            var i = t.buffers[r];
            e.update(i);
          }
        }),
        (e.prototype.checkCompatibility = function (t, e) {
          var r = t.attributes,
            i = e.attributeData;
          for (var n in i)
            if (!r[n])
              throw new Error(
                'shader and geometry incompatible, geometry missing the "' + n + '" attribute'
              );
        }),
        (e.prototype.getSignature = function (t, e) {
          var r = t.attributes,
            i = e.attributeData,
            n = ["g", t.id];
          for (var o in r) i[o] && n.push(o, i[o].location);
          return n.join("-");
        }),
        (e.prototype.initGeometryVao = function (t, e, r) {
          void 0 === r && (r = !0);
          var i = this.gl,
            n = this.CONTEXT_UID,
            o = this.renderer.buffer,
            s = e.program;
          s.glPrograms[n] || this.renderer.shader.generateProgram(e), this.checkCompatibility(t, s);
          var a = this.getSignature(t, s),
            h = t.glVertexArrayObjects[this.CONTEXT_UID],
            u = h[a];
          if (u) return (h[s.id] = u), u;
          var l = t.buffers,
            c = t.attributes,
            d = {},
            f = {};
          for (var p in l) (d[p] = 0), (f[p] = 0);
          for (var p in c)
            !c[p].size && s.attributeData[p]
              ? (c[p].size = s.attributeData[p].size)
              : c[p].size ||
                console.warn(
                  "PIXI Geometry attribute '" +
                    p +
                    "' size cannot be determined (likely the bound shader does not have the attribute)"
                ),
              (d[c[p].buffer] += c[p].size * Ki[c[p].type]);
          for (var p in c) {
            var _ = c[p],
              m = _.size;
            void 0 === _.stride &&
              (d[_.buffer] === m * Ki[_.type] ? (_.stride = 0) : (_.stride = d[_.buffer])),
              void 0 === _.start && ((_.start = f[_.buffer]), (f[_.buffer] += m * Ki[_.type]));
          }
          (u = i.createVertexArray()), i.bindVertexArray(u);
          for (var v = 0; v < l.length; v++) {
            var E = l[v];
            o.bind(E), r && E._glBuffers[n].refCount++;
          }
          return this.activateVao(t, s), (this._activeVao = u), (h[s.id] = u), (h[a] = u), u;
        }),
        (e.prototype.disposeGeometry = function (t, e) {
          var r;
          if (this.managedGeometries[t.id]) {
            delete this.managedGeometries[t.id];
            var i = t.glVertexArrayObjects[this.CONTEXT_UID],
              n = this.gl,
              o = t.buffers,
              s = null === (r = this.renderer) || void 0 === r ? void 0 : r.buffer;
            if ((t.disposeRunner.remove(this), i)) {
              if (s)
                for (var a = 0; a < o.length; a++) {
                  var h = o[a]._glBuffers[this.CONTEXT_UID];
                  h && (h.refCount--, 0 !== h.refCount || e || s.dispose(o[a], e));
                }
              if (!e)
                for (var u in i)
                  if ("g" === u[0]) {
                    var l = i[u];
                    this._activeVao === l && this.unbind(), n.deleteVertexArray(l);
                  }
              delete t.glVertexArrayObjects[this.CONTEXT_UID];
            }
          }
        }),
        (e.prototype.disposeAll = function (t) {
          for (var e = Object.keys(this.managedGeometries), r = 0; r < e.length; r++)
            this.disposeGeometry(this.managedGeometries[e[r]], t);
        }),
        (e.prototype.activateVao = function (t, e) {
          var r = this.gl,
            i = this.CONTEXT_UID,
            n = this.renderer.buffer,
            o = t.buffers,
            s = t.attributes;
          t.indexBuffer && n.bind(t.indexBuffer);
          var a = null;
          for (var h in s) {
            var u = s[h],
              l = o[u.buffer],
              c = l._glBuffers[i];
            if (e.attributeData[h]) {
              a !== c && (n.bind(l), (a = c));
              var d = e.attributeData[h].location;
              if (
                (r.enableVertexAttribArray(d),
                r.vertexAttribPointer(
                  d,
                  u.size,
                  u.type || r.FLOAT,
                  u.normalized,
                  u.stride,
                  u.start
                ),
                u.instance)
              ) {
                if (!this.hasInstance)
                  throw new Error("geometry error, GPU Instancing is not supported on this device");
                r.vertexAttribDivisor(d, 1);
              }
            }
          }
        }),
        (e.prototype.draw = function (t, e, r, i) {
          var n = this.gl,
            o = this._activeGeometry;
          if (o.indexBuffer) {
            var s = o.indexBuffer.data.BYTES_PER_ELEMENT,
              a = 2 === s ? n.UNSIGNED_SHORT : n.UNSIGNED_INT;
            2 === s || (4 === s && this.canUseUInt32ElementIndex)
              ? o.instanced
                ? n.drawElementsInstanced(
                    t,
                    e || o.indexBuffer.data.length,
                    a,
                    (r || 0) * s,
                    i || 1
                  )
                : n.drawElements(t, e || o.indexBuffer.data.length, a, (r || 0) * s)
              : console.warn("unsupported index buffer type: uint32");
          } else
            o.instanced
              ? n.drawArraysInstanced(t, r, e || o.getSize(), i || 1)
              : n.drawArrays(t, r, e || o.getSize());
          return this;
        }),
        (e.prototype.unbind = function () {
          this.gl.bindVertexArray(null), (this._activeVao = null), (this._activeGeometry = null);
        }),
        (e.prototype.destroy = function () {
          this.renderer = null;
        }),
        e
      );
    })(),
    Qi = (function () {
      function e(e) {
        void 0 === e && (e = null),
          (this.type = t.MASK_TYPES.NONE),
          (this.autoDetect = !0),
          (this.maskObject = e || null),
          (this.pooled = !1),
          (this.isMaskData = !0),
          (this.resolution = null),
          (this.multisample = rt.FILTER_MULTISAMPLE),
          (this.enabled = !0),
          (this._filters = null),
          (this._stencilCounter = 0),
          (this._scissorCounter = 0),
          (this._scissorRect = null),
          (this._scissorRectLocal = null),
          (this._target = null);
      }
      return (
        Object.defineProperty(e.prototype, "filter", {
          get: function () {
            return this._filters ? this._filters[0] : null;
          },
          set: function (t) {
            t
              ? this._filters
                ? (this._filters[0] = t)
                : (this._filters = [t])
              : (this._filters = null);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.reset = function () {
          this.pooled &&
            ((this.maskObject = null), (this.type = t.MASK_TYPES.NONE), (this.autoDetect = !0)),
            (this._target = null),
            (this._scissorRectLocal = null);
        }),
        (e.prototype.copyCountersOrReset = function (t) {
          t
            ? ((this._stencilCounter = t._stencilCounter),
              (this._scissorCounter = t._scissorCounter),
              (this._scissorRect = t._scissorRect))
            : ((this._stencilCounter = 0), (this._scissorCounter = 0), (this._scissorRect = null));
        }),
        e
      );
    })();
  function Ji(t, e, r) {
    var i = t.createShader(e);
    return t.shaderSource(i, r), t.compileShader(i), i;
  }
  function $i(t, e) {
    var r = t
        .getShaderSource(e)
        .split("\n")
        .map(function (t, e) {
          return e + ": " + t;
        }),
      i = t.getShaderInfoLog(e),
      n = i.split("\n"),
      o = {},
      s = n
        .map(function (t) {
          return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/, "$1"));
        })
        .filter(function (t) {
          return !(!t || o[t] || ((o[t] = !0), 0));
        }),
      a = [""];
    s.forEach(function (t) {
      (r[t - 1] = "%c" + r[t - 1] + "%c"),
        a.push("background: #FF0000; color:#FFFFFF; font-size: 10px", "font-size: 10px");
    });
    var h = r.join("\n");
    (a[0] = h),
      console.error(i),
      console.groupCollapsed("click to view full shader code"),
      console.warn.apply(console, a),
      console.groupEnd();
  }
  function tn(t) {
    for (var e = new Array(t), r = 0; r < e.length; r++) e[r] = !1;
    return e;
  }
  function en(t, e) {
    switch (t) {
      case "float":
        return 0;
      case "vec2":
        return new Float32Array(2 * e);
      case "vec3":
        return new Float32Array(3 * e);
      case "vec4":
        return new Float32Array(4 * e);
      case "int":
      case "uint":
      case "sampler2D":
      case "sampler2DArray":
        return 0;
      case "ivec2":
        return new Int32Array(2 * e);
      case "ivec3":
        return new Int32Array(3 * e);
      case "ivec4":
        return new Int32Array(4 * e);
      case "uvec2":
        return new Uint32Array(2 * e);
      case "uvec3":
        return new Uint32Array(3 * e);
      case "uvec4":
        return new Uint32Array(4 * e);
      case "bool":
        return !1;
      case "bvec2":
        return tn(2 * e);
      case "bvec3":
        return tn(3 * e);
      case "bvec4":
        return tn(4 * e);
      case "mat2":
        return new Float32Array([1, 0, 0, 1]);
      case "mat3":
        return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
      case "mat4":
        return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);
    }
    return null;
  }
  var rn,
    nn = {},
    on = nn;
  function sn() {
    if (on === nn || (on && on.isContextLost())) {
      var e = document.createElement("canvas"),
        r = void 0;
      rt.PREFER_ENV >= t.ENV.WEBGL2 && (r = e.getContext("webgl2", {})),
        r ||
          ((r = e.getContext("webgl", {}) || e.getContext("experimental-webgl", {}))
            ? r.getExtension("WEBGL_draw_buffers")
            : (r = null)),
        (on = r);
    }
    return on;
  }
  function an(e, r, i) {
    if ("precision" !== e.substring(0, 9)) {
      var n = r;
      return (
        r === t.PRECISION.HIGH && i !== t.PRECISION.HIGH && (n = t.PRECISION.MEDIUM),
        "precision " + n + " float;\n" + e
      );
    }
    return i !== t.PRECISION.HIGH && "precision highp" === e.substring(0, 15)
      ? e.replace("precision highp", "precision mediump")
      : e;
  }
  var hn = {
    float: 1,
    vec2: 2,
    vec3: 3,
    vec4: 4,
    int: 1,
    ivec2: 2,
    ivec3: 3,
    ivec4: 4,
    uint: 1,
    uvec2: 2,
    uvec3: 3,
    uvec4: 4,
    bool: 1,
    bvec2: 2,
    bvec3: 3,
    bvec4: 4,
    mat2: 4,
    mat3: 9,
    mat4: 16,
    sampler2D: 1,
  };
  function un(t) {
    return hn[t];
  }
  var ln = null,
    cn = {
      FLOAT: "float",
      FLOAT_VEC2: "vec2",
      FLOAT_VEC3: "vec3",
      FLOAT_VEC4: "vec4",
      INT: "int",
      INT_VEC2: "ivec2",
      INT_VEC3: "ivec3",
      INT_VEC4: "ivec4",
      UNSIGNED_INT: "uint",
      UNSIGNED_INT_VEC2: "uvec2",
      UNSIGNED_INT_VEC3: "uvec3",
      UNSIGNED_INT_VEC4: "uvec4",
      BOOL: "bool",
      BOOL_VEC2: "bvec2",
      BOOL_VEC3: "bvec3",
      BOOL_VEC4: "bvec4",
      FLOAT_MAT2: "mat2",
      FLOAT_MAT3: "mat3",
      FLOAT_MAT4: "mat4",
      SAMPLER_2D: "sampler2D",
      INT_SAMPLER_2D: "sampler2D",
      UNSIGNED_INT_SAMPLER_2D: "sampler2D",
      SAMPLER_CUBE: "samplerCube",
      INT_SAMPLER_CUBE: "samplerCube",
      UNSIGNED_INT_SAMPLER_CUBE: "samplerCube",
      SAMPLER_2D_ARRAY: "sampler2DArray",
      INT_SAMPLER_2D_ARRAY: "sampler2DArray",
      UNSIGNED_INT_SAMPLER_2D_ARRAY: "sampler2DArray",
    };
  function dn(t, e) {
    if (!ln) {
      var r = Object.keys(cn);
      ln = {};
      for (var i = 0; i < r.length; ++i) {
        var n = r[i];
        ln[t[n]] = cn[n];
      }
    }
    return ln[e];
  }
  var fn,
    pn = [
      {
        test: function (t) {
          return "float" === t.type && 1 === t.size;
        },
        code: function (t) {
          return (
            '\n            if(uv["' +
            t +
            '"] !== ud["' +
            t +
            '"].value)\n            {\n                ud["' +
            t +
            '"].value = uv["' +
            t +
            '"]\n                gl.uniform1f(ud["' +
            t +
            '"].location, uv["' +
            t +
            '"])\n            }\n            '
          );
        },
      },
      {
        test: function (t) {
          return (
            ("sampler2D" === t.type || "samplerCube" === t.type || "sampler2DArray" === t.type) &&
            1 === t.size &&
            !t.isArray
          );
        },
        code: function (t) {
          return (
            't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["' +
            t +
            '"], t);\n\n            if(ud["' +
            t +
            '"].value !== t)\n            {\n                ud["' +
            t +
            '"].value = t;\n                gl.uniform1i(ud["' +
            t +
            '"].location, t);\n; // eslint-disable-line max-len\n            }'
          );
        },
      },
      {
        test: function (t, e) {
          return "mat3" === t.type && 1 === t.size && void 0 !== e.a;
        },
        code: function (t) {
          return (
            '\n            gl.uniformMatrix3fv(ud["' +
            t +
            '"].location, false, uv["' +
            t +
            '"].toArray(true));\n            '
          );
        },
        codeUbo: function (t) {
          return (
            "\n                var " +
            t +
            "_matrix = uv." +
            t +
            ".toArray(true);\n\n                data[offset] = " +
            t +
            "_matrix[0];\n                data[offset+1] = " +
            t +
            "_matrix[1];\n                data[offset+2] = " +
            t +
            "_matrix[2];\n        \n                data[offset + 4] = " +
            t +
            "_matrix[3];\n                data[offset + 5] = " +
            t +
            "_matrix[4];\n                data[offset + 6] = " +
            t +
            "_matrix[5];\n        \n                data[offset + 8] = " +
            t +
            "_matrix[6];\n                data[offset + 9] = " +
            t +
            "_matrix[7];\n                data[offset + 10] = " +
            t +
            "_matrix[8];\n            "
          );
        },
      },
      {
        test: function (t, e) {
          return "vec2" === t.type && 1 === t.size && void 0 !== e.x;
        },
        code: function (t) {
          return (
            '\n                cv = ud["' +
            t +
            '"].value;\n                v = uv["' +
            t +
            '"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["' +
            t +
            '"].location, v.x, v.y);\n                }'
          );
        },
        codeUbo: function (t) {
          return (
            "\n                v = uv." +
            t +
            ";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "
          );
        },
      },
      {
        test: function (t) {
          return "vec2" === t.type && 1 === t.size;
        },
        code: function (t) {
          return (
            '\n                cv = ud["' +
            t +
            '"].value;\n                v = uv["' +
            t +
            '"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["' +
            t +
            '"].location, v[0], v[1]);\n                }\n            '
          );
        },
      },
      {
        test: function (t, e) {
          return "vec4" === t.type && 1 === t.size && void 0 !== e.width;
        },
        code: function (t) {
          return (
            '\n                cv = ud["' +
            t +
            '"].value;\n                v = uv["' +
            t +
            '"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["' +
            t +
            '"].location, v.x, v.y, v.width, v.height)\n                }'
          );
        },
        codeUbo: function (t) {
          return (
            "\n                    v = uv." +
            t +
            ";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "
          );
        },
      },
      {
        test: function (t) {
          return "vec4" === t.type && 1 === t.size;
        },
        code: function (t) {
          return (
            '\n                cv = ud["' +
            t +
            '"].value;\n                v = uv["' +
            t +
            '"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["' +
            t +
            '"].location, v[0], v[1], v[2], v[3])\n                }'
          );
        },
      },
    ],
    _n = {
      float:
        "\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",
      vec2: "\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",
      vec3: "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
      vec4: "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",
      int: "\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",
      ivec2:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",
      ivec3:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",
      ivec4:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",
      uint: "\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",
      uvec2:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",
      uvec3:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",
      uvec4:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",
      bool: "\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",
      bvec2:
        "\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",
      bvec3:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",
      bvec4:
        "\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",
      mat2: "gl.uniformMatrix2fv(location, false, v)",
      mat3: "gl.uniformMatrix3fv(location, false, v)",
      mat4: "gl.uniformMatrix4fv(location, false, v)",
      sampler2D: "gl.uniform1i(location, v)",
      samplerCube: "gl.uniform1i(location, v)",
      sampler2DArray: "gl.uniform1i(location, v)",
    },
    mn = {
      float: "gl.uniform1fv(location, v)",
      vec2: "gl.uniform2fv(location, v)",
      vec3: "gl.uniform3fv(location, v)",
      vec4: "gl.uniform4fv(location, v)",
      mat4: "gl.uniformMatrix4fv(location, false, v)",
      mat3: "gl.uniformMatrix3fv(location, false, v)",
      mat2: "gl.uniformMatrix2fv(location, false, v)",
      int: "gl.uniform1iv(location, v)",
      ivec2: "gl.uniform2iv(location, v)",
      ivec3: "gl.uniform3iv(location, v)",
      ivec4: "gl.uniform4iv(location, v)",
      uint: "gl.uniform1uiv(location, v)",
      uvec2: "gl.uniform2uiv(location, v)",
      uvec3: "gl.uniform3uiv(location, v)",
      uvec4: "gl.uniform4uiv(location, v)",
      bool: "gl.uniform1iv(location, v)",
      bvec2: "gl.uniform2iv(location, v)",
      bvec3: "gl.uniform3iv(location, v)",
      bvec4: "gl.uniform4iv(location, v)",
      sampler2D: "gl.uniform1iv(location, v)",
      samplerCube: "gl.uniform1iv(location, v)",
      sampler2DArray: "gl.uniform1iv(location, v)",
    },
    vn = [
      "precision mediump float;",
      "void main(void){",
      "float test = 0.1;",
      "%forloop%",
      "gl_FragColor = vec4(0.0);",
      "}",
    ].join("\n");
  function En(t) {
    for (var e = "", r = 0; r < t; ++r)
      r > 0 && (e += "\nelse "), r < t - 1 && (e += "if(test == " + r + ".0){}");
    return e;
  }
  function Tn(t, e) {
    if (0 === t) throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");
    for (var r = e.createShader(e.FRAGMENT_SHADER); ; ) {
      var i = vn.replace(/%forloop%/gi, En(t));
      if ((e.shaderSource(r, i), e.compileShader(r), e.getShaderParameter(r, e.COMPILE_STATUS)))
        break;
      t = (t / 2) | 0;
    }
    return t;
  }
  var yn = 0,
    gn = {},
    Rn = (function () {
      function e(r, i, n) {
        void 0 === n && (n = "pixi-shader"),
          (this.id = yn++),
          (this.vertexSrc = r || e.defaultVertexSrc),
          (this.fragmentSrc = i || e.defaultFragmentSrc),
          (this.vertexSrc = this.vertexSrc.trim()),
          (this.fragmentSrc = this.fragmentSrc.trim()),
          "#version" !== this.vertexSrc.substring(0, 8) &&
            ((n = n.replace(/\s+/g, "-")),
            gn[n] ? (gn[n]++, (n += "-" + gn[n])) : (gn[n] = 1),
            (this.vertexSrc = "#define SHADER_NAME " + n + "\n" + this.vertexSrc),
            (this.fragmentSrc = "#define SHADER_NAME " + n + "\n" + this.fragmentSrc),
            (this.vertexSrc = an(this.vertexSrc, rt.PRECISION_VERTEX, t.PRECISION.HIGH)),
            (this.fragmentSrc = an(
              this.fragmentSrc,
              rt.PRECISION_FRAGMENT,
              (function () {
                if (!rn) {
                  rn = t.PRECISION.MEDIUM;
                  var e = sn();
                  if (e && e.getShaderPrecisionFormat) {
                    var r = e.getShaderPrecisionFormat(e.FRAGMENT_SHADER, e.HIGH_FLOAT);
                    rn = r.precision ? t.PRECISION.HIGH : t.PRECISION.MEDIUM;
                  }
                }
                return rn;
              })()
            ))),
          (this.glPrograms = {}),
          (this.syncUniforms = null);
      }
      return (
        Object.defineProperty(e, "defaultVertexSrc", {
          get: function () {
            return "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n";
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e, "defaultFragmentSrc", {
          get: function () {
            return "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}";
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.from = function (t, r, i) {
          var n = t + r,
            o = Me[n];
          return o || (Me[n] = o = new e(t, r, i)), o;
        }),
        e
      );
    })(),
    bn = (function () {
      function t(t, e) {
        (this.uniformBindCount = 0),
          (this.program = t),
          (this.uniformGroup = e ? (e instanceof Ui ? e : new Ui(e)) : new Ui({}));
      }
      return (
        (t.prototype.checkUniformExists = function (t, e) {
          if (e.uniforms[t]) return !0;
          for (var r in e.uniforms) {
            var i = e.uniforms[r];
            if (i.group && this.checkUniformExists(t, i)) return !0;
          }
          return !1;
        }),
        (t.prototype.destroy = function () {
          this.uniformGroup = null;
        }),
        Object.defineProperty(t.prototype, "uniforms", {
          get: function () {
            return this.uniformGroup.uniforms;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.from = function (e, r, i) {
          return new t(Rn.from(e, r), i);
        }),
        t
      );
    })(),
    An = (function () {
      function e() {
        (this.data = 0),
          (this.blendMode = t.BLEND_MODES.NORMAL),
          (this.polygonOffset = 0),
          (this.blend = !0),
          (this.depthMask = !0);
      }
      return (
        Object.defineProperty(e.prototype, "blend", {
          get: function () {
            return !!(1 & this.data);
          },
          set: function (t) {
            !!(1 & this.data) !== t && (this.data ^= 1);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "offsets", {
          get: function () {
            return !!(2 & this.data);
          },
          set: function (t) {
            !!(2 & this.data) !== t && (this.data ^= 2);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "culling", {
          get: function () {
            return !!(4 & this.data);
          },
          set: function (t) {
            !!(4 & this.data) !== t && (this.data ^= 4);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "depthTest", {
          get: function () {
            return !!(8 & this.data);
          },
          set: function (t) {
            !!(8 & this.data) !== t && (this.data ^= 8);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "depthMask", {
          get: function () {
            return !!(32 & this.data);
          },
          set: function (t) {
            !!(32 & this.data) !== t && (this.data ^= 32);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "clockwiseFrontFace", {
          get: function () {
            return !!(16 & this.data);
          },
          set: function (t) {
            !!(16 & this.data) !== t && (this.data ^= 16);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "blendMode", {
          get: function () {
            return this._blendMode;
          },
          set: function (e) {
            (this.blend = e !== t.BLEND_MODES.NONE), (this._blendMode = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "polygonOffset", {
          get: function () {
            return this._polygonOffset;
          },
          set: function (t) {
            (this.offsets = !!t), (this._polygonOffset = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.for2d = function () {
          var t = new e();
          return (t.depthTest = !1), (t.blend = !0), t;
        }),
        e
      );
    })(),
    xn = (function (t) {
      function e(r, i, n) {
        var o = this,
          s = Rn.from(r || e.defaultVertexSrc, i || e.defaultFragmentSrc);
        return (
          ((o = t.call(this, s, n) || this).padding = 0),
          (o.resolution = rt.FILTER_RESOLUTION),
          (o.multisample = rt.FILTER_MULTISAMPLE),
          (o.enabled = !0),
          (o.autoFit = !0),
          (o.state = new An()),
          o
        );
      }
      return (
        ei(e, t),
        (e.prototype.apply = function (t, e, r, i, n) {
          t.applyFilter(this, e, r, i);
        }),
        Object.defineProperty(e.prototype, "blendMode", {
          get: function () {
            return this.state.blendMode;
          },
          set: function (t) {
            this.state.blendMode = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "resolution", {
          get: function () {
            return this._resolution;
          },
          set: function (t) {
            this._resolution = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e, "defaultVertexSrc", {
          get: function () {
            return "attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e, "defaultFragmentSrc", {
          get: function () {
            return "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n";
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(bn),
    Sn =
      "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",
    On =
      "varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",
    In = new Qe(),
    Pn = (function () {
      function t(t, e) {
        (this._texture = t),
          (this.mapCoord = new Qe()),
          (this.uClampFrame = new Float32Array(4)),
          (this.uClampOffset = new Float32Array(2)),
          (this._textureID = -1),
          (this._updateID = 0),
          (this.clampOffset = 0),
          (this.clampMargin = void 0 === e ? 0.5 : e),
          (this.isSimple = !1);
      }
      return (
        Object.defineProperty(t.prototype, "texture", {
          get: function () {
            return this._texture;
          },
          set: function (t) {
            (this._texture = t), (this._textureID = -1);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.multiplyUvs = function (t, e) {
          void 0 === e && (e = t);
          for (var r = this.mapCoord, i = 0; i < t.length; i += 2) {
            var n = t[i],
              o = t[i + 1];
            (e[i] = n * r.a + o * r.c + r.tx), (e[i + 1] = n * r.b + o * r.d + r.ty);
          }
          return e;
        }),
        (t.prototype.update = function (t) {
          var e = this._texture;
          if (!e || !e.valid) return !1;
          if (!t && this._textureID === e._updateID) return !1;
          (this._textureID = e._updateID), this._updateID++;
          var r = e._uvs;
          this.mapCoord.set(r.x1 - r.x0, r.y1 - r.y0, r.x3 - r.x0, r.y3 - r.y0, r.x0, r.y0);
          var i = e.orig,
            n = e.trim;
          n &&
            (In.set(i.width / n.width, 0, 0, i.height / n.height, -n.x / n.width, -n.y / n.height),
            this.mapCoord.append(In));
          var o = e.baseTexture,
            s = this.uClampFrame,
            a = this.clampMargin / o.resolution,
            h = this.clampOffset;
          return (
            (s[0] = (e._frame.x + a + h) / o.width),
            (s[1] = (e._frame.y + a + h) / o.height),
            (s[2] = (e._frame.x + e._frame.width - a + h) / o.width),
            (s[3] = (e._frame.y + e._frame.height - a + h) / o.height),
            (this.uClampOffset[0] = h / o.realWidth),
            (this.uClampOffset[1] = h / o.realHeight),
            (this.isSimple =
              e._frame.width === o.width && e._frame.height === o.height && 0 === e.rotate),
            !0
          );
        }),
        t
      );
    })(),
    Mn = (function (t) {
      function e(e, r, i) {
        var n = this,
          o = null;
        return (
          "string" != typeof e &&
            void 0 === r &&
            void 0 === i &&
            ((o = e), (e = void 0), (r = void 0), (i = void 0)),
          ((n = t.call(this, e || Sn, r || On, i) || this).maskSprite = o),
          (n.maskMatrix = new Qe()),
          n
        );
      }
      return (
        ei(e, t),
        Object.defineProperty(e.prototype, "maskSprite", {
          get: function () {
            return this._maskSprite;
          },
          set: function (t) {
            (this._maskSprite = t), this._maskSprite && (this._maskSprite.renderable = !1);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.apply = function (t, e, r, i) {
          var n = this._maskSprite,
            o = n._texture;
          o.valid &&
            (o.uvMatrix || (o.uvMatrix = new Pn(o, 0)),
            o.uvMatrix.update(),
            (this.uniforms.npmAlpha = o.baseTexture.alphaMode ? 0 : 1),
            (this.uniforms.mask = o),
            (this.uniforms.otherMatrix = t
              .calculateSpriteMatrix(this.maskMatrix, n)
              .prepend(o.uvMatrix.mapCoord)),
            (this.uniforms.alpha = n.worldAlpha),
            (this.uniforms.maskClamp = o.uvMatrix.uClampFrame),
            t.applyFilter(this, e, r, i));
        }),
        e
      );
    })(xn),
    Nn = (function () {
      function e(t) {
        (this.renderer = t),
          (this.enableScissor = !0),
          (this.alphaMaskPool = []),
          (this.maskDataPool = []),
          (this.maskStack = []),
          (this.alphaMaskIndex = 0);
      }
      return (
        (e.prototype.setMaskStack = function (t) {
          (this.maskStack = t),
            this.renderer.scissor.setMaskStack(t),
            this.renderer.stencil.setMaskStack(t);
        }),
        (e.prototype.push = function (e, r) {
          var i = r;
          if (!i.isMaskData) {
            var n = this.maskDataPool.pop() || new Qi();
            (n.pooled = !0), (n.maskObject = r), (i = n);
          }
          var o = 0 !== this.maskStack.length ? this.maskStack[this.maskStack.length - 1] : null;
          if (
            (i.copyCountersOrReset(o),
            i.autoDetect && this.detect(i),
            (i._target = e),
            i.type !== t.MASK_TYPES.SPRITE && this.maskStack.push(i),
            i.enabled)
          )
            switch (i.type) {
              case t.MASK_TYPES.SCISSOR:
                this.renderer.scissor.push(i);
                break;
              case t.MASK_TYPES.STENCIL:
                this.renderer.stencil.push(i);
                break;
              case t.MASK_TYPES.SPRITE:
                i.copyCountersOrReset(null), this.pushSpriteMask(i);
            }
          i.type === t.MASK_TYPES.SPRITE && this.maskStack.push(i);
        }),
        (e.prototype.pop = function (e) {
          var r = this.maskStack.pop();
          if (r && r._target === e) {
            if (r.enabled)
              switch (r.type) {
                case t.MASK_TYPES.SCISSOR:
                  this.renderer.scissor.pop();
                  break;
                case t.MASK_TYPES.STENCIL:
                  this.renderer.stencil.pop(r.maskObject);
                  break;
                case t.MASK_TYPES.SPRITE:
                  this.popSpriteMask(r);
              }
            if ((r.reset(), r.pooled && this.maskDataPool.push(r), 0 !== this.maskStack.length)) {
              var i = this.maskStack[this.maskStack.length - 1];
              i.type === t.MASK_TYPES.SPRITE &&
                i._filters &&
                (i._filters[0].maskSprite = i.maskObject);
            }
          }
        }),
        (e.prototype.detect = function (e) {
          e.maskObject.isSprite
            ? (e.type = t.MASK_TYPES.SPRITE)
            : this.enableScissor && this.renderer.scissor.testScissor(e)
            ? (e.type = t.MASK_TYPES.SCISSOR)
            : (e.type = t.MASK_TYPES.STENCIL);
        }),
        (e.prototype.pushSpriteMask = function (t) {
          var e,
            r,
            i = t.maskObject,
            n = t._target,
            o = t._filters;
          o ||
            (o = this.alphaMaskPool[this.alphaMaskIndex]) ||
            (o = this.alphaMaskPool[this.alphaMaskIndex] = [new Mn()]);
          var s,
            a,
            h = this.renderer,
            u = h.renderTexture;
          if (u.current) {
            var l = u.current;
            (s = t.resolution || l.resolution),
              (a = null !== (e = t.multisample) && void 0 !== e ? e : l.multisample);
          } else
            (s = t.resolution || h.resolution),
              (a = null !== (r = t.multisample) && void 0 !== r ? r : h.multisample);
          (o[0].resolution = s), (o[0].multisample = a), (o[0].maskSprite = i);
          var c = n.filterArea;
          (n.filterArea = i.getBounds(!0)),
            h.filter.push(n, o),
            (n.filterArea = c),
            t._filters || this.alphaMaskIndex++;
        }),
        (e.prototype.popSpriteMask = function (t) {
          this.renderer.filter.pop(),
            t._filters
              ? (t._filters[0].maskSprite = null)
              : (this.alphaMaskIndex--,
                (this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite = null));
        }),
        (e.prototype.destroy = function () {
          this.renderer = null;
        }),
        e
      );
    })(),
    Dn = (function () {
      function t(t) {
        (this.renderer = t), (this.maskStack = []), (this.glConst = 0);
      }
      return (
        (t.prototype.getStackLength = function () {
          return this.maskStack.length;
        }),
        (t.prototype.setMaskStack = function (t) {
          var e = this.renderer.gl,
            r = this.getStackLength();
          this.maskStack = t;
          var i = this.getStackLength();
          i !== r &&
            (0 === i ? e.disable(this.glConst) : (e.enable(this.glConst), this._useCurrent()));
        }),
        (t.prototype._useCurrent = function () {}),
        (t.prototype.destroy = function () {
          (this.renderer = null), (this.maskStack = null);
        }),
        t
      );
    })(),
    Cn = new Qe(),
    Ln = (function (t) {
      function e(e) {
        var r = t.call(this, e) || this;
        return (r.glConst = WebGLRenderingContext.SCISSOR_TEST), r;
      }
      return (
        ei(e, t),
        (e.prototype.getStackLength = function () {
          var t = this.maskStack[this.maskStack.length - 1];
          return t ? t._scissorCounter : 0;
        }),
        (e.prototype.calcScissorRect = function (t) {
          if (!t._scissorRectLocal) {
            var e = t._scissorRect,
              r = t.maskObject,
              i = this.renderer,
              n = i.renderTexture;
            r.renderable = !0;
            var o = r.getBounds();
            this.roundFrameToPixels(
              o,
              n.current ? n.current.resolution : i.resolution,
              n.sourceFrame,
              n.destinationFrame,
              i.projection.transform
            ),
              (r.renderable = !1),
              e && o.fit(e),
              (t._scissorRectLocal = o);
          }
        }),
        (e.isMatrixRotated = function (t) {
          if (!t) return !1;
          var e = t.a,
            r = t.b,
            i = t.c,
            n = t.d;
          return (
            (Math.abs(r) > 1e-4 || Math.abs(i) > 1e-4) && (Math.abs(e) > 1e-4 || Math.abs(n) > 1e-4)
          );
        }),
        (e.prototype.testScissor = function (t) {
          var r = t.maskObject;
          if (!r.isFastRect || !r.isFastRect()) return !1;
          if (e.isMatrixRotated(r.worldTransform)) return !1;
          if (e.isMatrixRotated(this.renderer.projection.transform)) return !1;
          this.calcScissorRect(t);
          var i = t._scissorRectLocal;
          return i.width > 0 && i.height > 0;
        }),
        (e.prototype.roundFrameToPixels = function (t, r, i, n, o) {
          e.isMatrixRotated(o) ||
            ((o = o ? Cn.copyFrom(o) : Cn.identity())
              .translate(-i.x, -i.y)
              .scale(n.width / i.width, n.height / i.height)
              .translate(n.x, n.y),
            this.renderer.filter.transformAABB(o, t),
            t.fit(n),
            (t.x = Math.round(t.x * r)),
            (t.y = Math.round(t.y * r)),
            (t.width = Math.round(t.width * r)),
            (t.height = Math.round(t.height * r)));
        }),
        (e.prototype.push = function (t) {
          t._scissorRectLocal || this.calcScissorRect(t);
          var e = this.renderer.gl;
          t._scissorRect || e.enable(e.SCISSOR_TEST),
            t._scissorCounter++,
            (t._scissorRect = t._scissorRectLocal),
            this._useCurrent();
        }),
        (e.prototype.pop = function () {
          var t = this.renderer.gl;
          this.getStackLength() > 0 ? this._useCurrent() : t.disable(t.SCISSOR_TEST);
        }),
        (e.prototype._useCurrent = function () {
          var t,
            e = this.maskStack[this.maskStack.length - 1]._scissorRect;
          (t = this.renderer.renderTexture.current ? e.y : this.renderer.height - e.height - e.y),
            this.renderer.gl.scissor(e.x, t, e.width, e.height);
        }),
        e
      );
    })(Dn),
    wn = (function (t) {
      function e(e) {
        var r = t.call(this, e) || this;
        return (r.glConst = WebGLRenderingContext.STENCIL_TEST), r;
      }
      return (
        ei(e, t),
        (e.prototype.getStackLength = function () {
          var t = this.maskStack[this.maskStack.length - 1];
          return t ? t._stencilCounter : 0;
        }),
        (e.prototype.push = function (t) {
          var e = t.maskObject,
            r = this.renderer.gl,
            i = t._stencilCounter;
          0 === i &&
            (this.renderer.framebuffer.forceStencil(),
            r.clearStencil(0),
            r.clear(r.STENCIL_BUFFER_BIT),
            r.enable(r.STENCIL_TEST)),
            t._stencilCounter++,
            r.colorMask(!1, !1, !1, !1),
            r.stencilFunc(r.EQUAL, i, 4294967295),
            r.stencilOp(r.KEEP, r.KEEP, r.INCR),
            (e.renderable = !0),
            e.render(this.renderer),
            this.renderer.batch.flush(),
            (e.renderable = !1),
            this._useCurrent();
        }),
        (e.prototype.pop = function (t) {
          var e = this.renderer.gl;
          0 === this.getStackLength()
            ? e.disable(e.STENCIL_TEST)
            : (e.colorMask(!1, !1, !1, !1),
              e.stencilOp(e.KEEP, e.KEEP, e.DECR),
              (t.renderable = !0),
              t.render(this.renderer),
              this.renderer.batch.flush(),
              (t.renderable = !1),
              this._useCurrent());
        }),
        (e.prototype._useCurrent = function () {
          var t = this.renderer.gl;
          t.colorMask(!0, !0, !0, !0),
            t.stencilFunc(t.EQUAL, this.getStackLength(), 4294967295),
            t.stencilOp(t.KEEP, t.KEEP, t.KEEP);
        }),
        e
      );
    })(Dn),
    Fn = (function () {
      function t(t) {
        (this.renderer = t),
          (this.destinationFrame = null),
          (this.sourceFrame = null),
          (this.defaultFrame = null),
          (this.projectionMatrix = new Qe()),
          (this.transform = null);
      }
      return (
        (t.prototype.update = function (t, e, r, i) {
          (this.destinationFrame = t || this.destinationFrame || this.defaultFrame),
            (this.sourceFrame = e || this.sourceFrame || t),
            this.calculateProjection(this.destinationFrame, this.sourceFrame, r, i),
            this.transform && this.projectionMatrix.append(this.transform);
          var n = this.renderer;
          (n.globalUniforms.uniforms.projectionMatrix = this.projectionMatrix),
            n.globalUniforms.update(),
            n.shader.shader && n.shader.syncUniformGroup(n.shader.shader.uniforms.globals);
        }),
        (t.prototype.calculateProjection = function (t, e, r, i) {
          var n = this.projectionMatrix,
            o = i ? -1 : 1;
          n.identity(),
            (n.a = (1 / e.width) * 2),
            (n.d = o * ((1 / e.height) * 2)),
            (n.tx = -1 - e.x * n.a),
            (n.ty = -o - e.y * n.d);
        }),
        (t.prototype.setTransform = function (t) {}),
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        t
      );
    })(),
    Un = new Ve(),
    Bn = new Ve(),
    Gn = (function () {
      function t(t) {
        (this.renderer = t),
          (this.clearColor = t._backgroundColorRgba),
          (this.defaultMaskStack = []),
          (this.current = null),
          (this.sourceFrame = new Ve()),
          (this.destinationFrame = new Ve()),
          (this.viewportFrame = new Ve());
      }
      return (
        (t.prototype.bind = function (t, e, r) {
          void 0 === t && (t = null);
          var i,
            n,
            o,
            s = this.renderer;
          (this.current = t),
            t
              ? ((o = (i = t.baseTexture).resolution),
                e || ((Un.width = t.frame.width), (Un.height = t.frame.height), (e = Un)),
                r ||
                  ((Bn.x = t.frame.x),
                  (Bn.y = t.frame.y),
                  (Bn.width = e.width),
                  (Bn.height = e.height),
                  (r = Bn)),
                (n = i.framebuffer))
              : ((o = s.resolution),
                e || ((Un.width = s.screen.width), (Un.height = s.screen.height), (e = Un)),
                r || (((r = Un).width = e.width), (r.height = e.height)));
          var a = this.viewportFrame;
          (a.x = r.x * o),
            (a.y = r.y * o),
            (a.width = r.width * o),
            (a.height = r.height * o),
            t || (a.y = s.view.height - (a.y + a.height)),
            a.ceil(),
            this.renderer.framebuffer.bind(n, a),
            this.renderer.projection.update(r, e, o, !n),
            t
              ? this.renderer.mask.setMaskStack(i.maskStack)
              : this.renderer.mask.setMaskStack(this.defaultMaskStack),
            this.sourceFrame.copyFrom(e),
            this.destinationFrame.copyFrom(r);
        }),
        (t.prototype.clear = function (t, e) {
          t = this.current ? t || this.current.baseTexture.clearColor : t || this.clearColor;
          var r = this.destinationFrame,
            i = this.current ? this.current.baseTexture : this.renderer.screen,
            n = r.width !== i.width || r.height !== i.height;
          if (n) {
            var o = this.viewportFrame,
              s = o.x,
              a = o.y,
              h = o.width,
              u = o.height;
            (s = Math.round(s)),
              (a = Math.round(a)),
              (h = Math.round(h)),
              (u = Math.round(u)),
              this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),
              this.renderer.gl.scissor(s, a, h, u);
          }
          this.renderer.framebuffer.clear(t[0], t[1], t[2], t[3], e),
            n && this.renderer.scissor.pop();
        }),
        (t.prototype.resize = function () {
          this.bind(null);
        }),
        (t.prototype.reset = function () {
          this.bind(null);
        }),
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        t
      );
    })();
  function Xn(t, e, r, i, n) {
    r.buffer.update(n);
  }
  var kn = {
      float: "\n        data[offset] = v;\n    ",
      vec2: "\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",
      vec3: "\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",
      vec4: "\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",
      mat2: "\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",
      mat3: "\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",
      mat4: "\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    ",
    },
    Hn = {
      float: 4,
      vec2: 8,
      vec3: 12,
      vec4: 16,
      int: 4,
      ivec2: 8,
      ivec3: 12,
      ivec4: 16,
      uint: 4,
      uvec2: 8,
      uvec3: 12,
      uvec4: 16,
      bool: 4,
      bvec2: 8,
      bvec3: 12,
      bvec4: 16,
      mat2: 32,
      mat3: 48,
      mat4: 64,
    };
  function Yn(t) {
    for (
      var e = t.map(function (t) {
          return { data: t, offset: 0, dataLen: 0, dirty: 0 };
        }),
        r = 0,
        i = 0,
        n = 0,
        o = 0;
      o < e.length;
      o++
    ) {
      var s = e[o];
      if (
        ((r = Hn[s.data.type]),
        s.data.size > 1 && (r = Math.max(r, 16) * s.data.size),
        (s.dataLen = r),
        i % r != 0 && i < 16)
      ) {
        var a = (i % r) % 16;
        (i += a), (n += a);
      }
      i + r > 16
        ? ((n = 16 * Math.ceil(n / 16)), (s.offset = n), (n += r), (i = r))
        : ((s.offset = n), (i += r), (n += r));
    }
    return { uboElements: e, size: (n = 16 * Math.ceil(n / 16)) };
  }
  function jn(t, e) {
    var r = [];
    for (var i in t) e[i] && r.push(e[i]);
    return (
      r.sort(function (t, e) {
        return t.index - e.index;
      }),
      r
    );
  }
  function Vn(t, e) {
    if (!t.autoManage) return { size: 0, syncFunc: Xn };
    for (
      var r = Yn(jn(t.uniforms, e)),
        i = r.uboElements,
        n = r.size,
        o = [
          "\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    ",
        ],
        s = 0;
      s < i.length;
      s++
    ) {
      for (
        var a = i[s], h = t.uniforms[a.data.name], u = a.data.name, l = !1, c = 0;
        c < pn.length;
        c++
      ) {
        var d = pn[c];
        if (d.codeUbo && d.test(a.data, h)) {
          o.push("offset = " + a.offset / 4 + ";", pn[c].codeUbo(a.data.name, h)), (l = !0);
          break;
        }
      }
      if (!l)
        if (a.data.size > 1) {
          var f = un(a.data.type),
            p = Math.max(Hn[a.data.type] / 16, 1),
            _ = f / p,
            m = (4 - (_ % 4)) % 4;
          o.push(
            "\n                cv = ud." +
              u +
              ".value;\n                v = uv." +
              u +
              ";\n                offset = " +
              a.offset / 4 +
              ";\n\n                t = 0;\n\n                for(var i=0; i < " +
              a.data.size * p +
              "; i++)\n                {\n                    for(var j = 0; j < " +
              _ +
              "; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += " +
              m +
              ";\n                }\n\n                "
          );
        } else {
          var v = kn[a.data.type];
          o.push(
            "\n                cv = ud." +
              u +
              ".value;\n                v = uv." +
              u +
              ";\n                offset = " +
              a.offset / 4 +
              ";\n                " +
              v +
              ";\n                "
          );
        }
    }
    return (
      o.push("\n       renderer.buffer.update(buffer);\n    "),
      {
        size: n,
        syncFunc: new Function("ud", "uv", "renderer", "syncData", "buffer", o.join("\n")),
      }
    );
  }
  var Wn = function () {},
    zn = (function () {
      function t(t, e) {
        (this.program = t),
          (this.uniformData = e),
          (this.uniformGroups = {}),
          (this.uniformDirtyGroups = {}),
          (this.uniformBufferBindings = {});
      }
      return (
        (t.prototype.destroy = function () {
          (this.uniformData = null),
            (this.uniformGroups = null),
            (this.uniformDirtyGroups = null),
            (this.uniformBufferBindings = null),
            (this.program = null);
        }),
        t
      );
    })();
  function qn(t, e) {
    var r = Ji(t, t.VERTEX_SHADER, e.vertexSrc),
      i = Ji(t, t.FRAGMENT_SHADER, e.fragmentSrc),
      n = t.createProgram();
    if (
      (t.attachShader(n, r),
      t.attachShader(n, i),
      t.linkProgram(n),
      t.getProgramParameter(n, t.LINK_STATUS) ||
        (function (t, e, r, i) {
          t.getProgramParameter(e, t.LINK_STATUS) ||
            (t.getShaderParameter(r, t.COMPILE_STATUS) || $i(t, r),
            t.getShaderParameter(i, t.COMPILE_STATUS) || $i(t, i),
            console.error("PixiJS Error: Could not initialize shader."),
            "" !== t.getProgramInfoLog(e) &&
              console.warn("PixiJS Warning: gl.getProgramInfoLog()", t.getProgramInfoLog(e)));
        })(t, n, r, i),
      (e.attributeData = (function (t, e) {
        for (var r = {}, i = e.getProgramParameter(t, e.ACTIVE_ATTRIBUTES), n = 0; n < i; n++) {
          var o = e.getActiveAttrib(t, n);
          if (0 !== o.name.indexOf("gl_")) {
            var s = dn(e, o.type),
              a = { type: s, name: o.name, size: un(s), location: e.getAttribLocation(t, o.name) };
            r[o.name] = a;
          }
        }
        return r;
      })(n, t)),
      (e.uniformData = (function (t, e) {
        for (var r = {}, i = e.getProgramParameter(t, e.ACTIVE_UNIFORMS), n = 0; n < i; n++) {
          var o = e.getActiveUniform(t, n),
            s = o.name.replace(/\[.*?\]$/, ""),
            a = !!o.name.match(/\[.*?\]$/),
            h = dn(e, o.type);
          r[s] = { name: s, index: n, type: h, size: o.size, isArray: a, value: en(h, o.size) };
        }
        return r;
      })(n, t)),
      !/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc))
    ) {
      var o = Object.keys(e.attributeData);
      o.sort(function (t, e) {
        return t > e ? 1 : -1;
      });
      for (var s = 0; s < o.length; s++)
        (e.attributeData[o[s]].location = s), t.bindAttribLocation(n, s, o[s]);
      t.linkProgram(n);
    }
    t.deleteShader(r), t.deleteShader(i);
    var a = {};
    for (var s in e.uniformData) {
      var h = e.uniformData[s];
      a[s] = { location: t.getUniformLocation(n, s), value: en(h.type, h.size) };
    }
    return new zn(n, a);
  }
  var Kn = 0,
    Zn = { textureCount: 0, uboCount: 0 },
    Qn = (function () {
      function t(t) {
        (this.destroyed = !1),
          (this.renderer = t),
          this.systemCheck(),
          (this.gl = null),
          (this.shader = null),
          (this.program = null),
          (this.cache = {}),
          (this._uboCache = {}),
          (this.id = Kn++);
      }
      return (
        (t.prototype.systemCheck = function () {
          if (
            !(function () {
              if ("boolean" == typeof fn) return fn;
              try {
                var t = new Function(
                  "param1",
                  "param2",
                  "param3",
                  "return param1[param2] === param3;"
                );
                fn = !0 === t({ a: "b" }, "a", "b");
              } catch (t) {
                fn = !1;
              }
              return fn;
            })()
          )
            throw new Error(
              "Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support."
            );
        }),
        (t.prototype.contextChange = function (t) {
          (this.gl = t), this.reset();
        }),
        (t.prototype.bind = function (t, e) {
          t.uniforms.globals = this.renderer.globalUniforms;
          var r = t.program,
            i = r.glPrograms[this.renderer.CONTEXT_UID] || this.generateProgram(t);
          return (
            (this.shader = t),
            this.program !== r && ((this.program = r), this.gl.useProgram(i.program)),
            e ||
              ((Zn.textureCount = 0), (Zn.uboCount = 0), this.syncUniformGroup(t.uniformGroup, Zn)),
            i
          );
        }),
        (t.prototype.setUniforms = function (t) {
          var e = this.shader.program,
            r = e.glPrograms[this.renderer.CONTEXT_UID];
          e.syncUniforms(r.uniformData, t, this.renderer);
        }),
        (t.prototype.syncUniformGroup = function (t, e) {
          var r = this.getGlProgram();
          (t.static && t.dirtyId === r.uniformDirtyGroups[t.id]) ||
            ((r.uniformDirtyGroups[t.id] = t.dirtyId), this.syncUniforms(t, r, e));
        }),
        (t.prototype.syncUniforms = function (t, e, r) {
          (t.syncUniforms[this.shader.program.id] || this.createSyncGroups(t))(
            e.uniformData,
            t.uniforms,
            this.renderer,
            r
          );
        }),
        (t.prototype.createSyncGroups = function (t) {
          var e = this.getSignature(t, this.shader.program.uniformData, "u");
          return (
            this.cache[e] ||
              (this.cache[e] = (function (t, e) {
                var r,
                  i = [
                    "\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    ",
                  ];
                for (var n in t.uniforms) {
                  var o = e[n];
                  if (o) {
                    for (var s = t.uniforms[n], a = !1, h = 0; h < pn.length; h++)
                      if (pn[h].test(o, s)) {
                        i.push(pn[h].code(n, s)), (a = !0);
                        break;
                      }
                    if (!a) {
                      var u = (1 === o.size ? _n : mn)[o.type].replace(
                        "location",
                        'ud["' + n + '"].location'
                      );
                      i.push(
                        '\n            cu = ud["' +
                          n +
                          '"];\n            cv = cu.value;\n            v = uv["' +
                          n +
                          '"];\n            ' +
                          u +
                          ";"
                      );
                    }
                  } else
                    (null === (r = t.uniforms[n]) || void 0 === r ? void 0 : r.group) &&
                      (t.uniforms[n].ubo
                        ? i.push(
                            "\n                        renderer.shader.syncUniformBufferGroup(uv." +
                              n +
                              ", '" +
                              n +
                              "');\n                    "
                          )
                        : i.push(
                            "\n                        renderer.shader.syncUniformGroup(uv." +
                              n +
                              ", syncData);\n                    "
                          ));
                }
                return new Function("ud", "uv", "renderer", "syncData", i.join("\n"));
              })(t, this.shader.program.uniformData)),
            (t.syncUniforms[this.shader.program.id] = this.cache[e]),
            t.syncUniforms[this.shader.program.id]
          );
        }),
        (t.prototype.syncUniformBufferGroup = function (t, e) {
          var r = this.getGlProgram();
          if (!t.static || 0 !== t.dirtyId || !r.uniformGroups[t.id]) {
            t.dirtyId = 0;
            var i = r.uniformGroups[t.id] || this.createSyncBufferGroup(t, r, e);
            t.buffer.update(), i(r.uniformData, t.uniforms, this.renderer, Zn, t.buffer);
          }
          this.renderer.buffer.bindBufferBase(t.buffer, r.uniformBufferBindings[e]);
        }),
        (t.prototype.createSyncBufferGroup = function (t, e, r) {
          var i = this.renderer.gl;
          this.renderer.buffer.bind(t.buffer);
          var n = this.gl.getUniformBlockIndex(e.program, r);
          (e.uniformBufferBindings[r] = this.shader.uniformBindCount),
            i.uniformBlockBinding(e.program, n, this.shader.uniformBindCount),
            this.shader.uniformBindCount++;
          var o = this.getSignature(t, this.shader.program.uniformData, "ubo"),
            s = this._uboCache[o];
          if (
            (s || (s = this._uboCache[o] = Vn(t, this.shader.program.uniformData)), t.autoManage)
          ) {
            var a = new Float32Array(s.size / 4);
            t.buffer.update(a);
          }
          return (e.uniformGroups[t.id] = s.syncFunc), e.uniformGroups[t.id];
        }),
        (t.prototype.getSignature = function (t, e, r) {
          var i = t.uniforms,
            n = [r + "-"];
          for (var o in i) n.push(o), e[o] && n.push(e[o].type);
          return n.join("-");
        }),
        (t.prototype.getGlProgram = function () {
          return this.shader ? this.shader.program.glPrograms[this.renderer.CONTEXT_UID] : null;
        }),
        (t.prototype.generateProgram = function (t) {
          var e = this.gl,
            r = t.program,
            i = qn(e, r);
          return (r.glPrograms[this.renderer.CONTEXT_UID] = i), i;
        }),
        (t.prototype.reset = function () {
          (this.program = null), (this.shader = null);
        }),
        (t.prototype.destroy = function () {
          (this.renderer = null), (this.destroyed = !0);
        }),
        t
      );
    })(),
    Jn = 0,
    $n = 1,
    to = 2,
    eo = 3,
    ro = 4,
    io = 5,
    no = (function () {
      function e() {
        (this.gl = null),
          (this.stateId = 0),
          (this.polygonOffset = 0),
          (this.blendMode = t.BLEND_MODES.NONE),
          (this._blendEq = !1),
          (this.map = []),
          (this.map[Jn] = this.setBlend),
          (this.map[$n] = this.setOffset),
          (this.map[to] = this.setCullFace),
          (this.map[eo] = this.setDepthTest),
          (this.map[ro] = this.setFrontFace),
          (this.map[io] = this.setDepthMask),
          (this.checks = []),
          (this.defaultState = new An()),
          (this.defaultState.blend = !0);
      }
      return (
        (e.prototype.contextChange = function (e) {
          (this.gl = e),
            (this.blendModes = (function (e, r) {
              return (
                void 0 === r && (r = []),
                (r[t.BLEND_MODES.NORMAL] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.ADD] = [e.ONE, e.ONE]),
                (r[t.BLEND_MODES.MULTIPLY] = [
                  e.DST_COLOR,
                  e.ONE_MINUS_SRC_ALPHA,
                  e.ONE,
                  e.ONE_MINUS_SRC_ALPHA,
                ]),
                (r[t.BLEND_MODES.SCREEN] = [
                  e.ONE,
                  e.ONE_MINUS_SRC_COLOR,
                  e.ONE,
                  e.ONE_MINUS_SRC_ALPHA,
                ]),
                (r[t.BLEND_MODES.OVERLAY] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.DARKEN] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.LIGHTEN] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.COLOR_DODGE] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.COLOR_BURN] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.HARD_LIGHT] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.SOFT_LIGHT] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.DIFFERENCE] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.EXCLUSION] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.HUE] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.SATURATION] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.COLOR] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.LUMINOSITY] = [e.ONE, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.NONE] = [0, 0]),
                (r[t.BLEND_MODES.NORMAL_NPM] = [
                  e.SRC_ALPHA,
                  e.ONE_MINUS_SRC_ALPHA,
                  e.ONE,
                  e.ONE_MINUS_SRC_ALPHA,
                ]),
                (r[t.BLEND_MODES.ADD_NPM] = [e.SRC_ALPHA, e.ONE, e.ONE, e.ONE]),
                (r[t.BLEND_MODES.SCREEN_NPM] = [
                  e.SRC_ALPHA,
                  e.ONE_MINUS_SRC_COLOR,
                  e.ONE,
                  e.ONE_MINUS_SRC_ALPHA,
                ]),
                (r[t.BLEND_MODES.SRC_IN] = [e.DST_ALPHA, e.ZERO]),
                (r[t.BLEND_MODES.SRC_OUT] = [e.ONE_MINUS_DST_ALPHA, e.ZERO]),
                (r[t.BLEND_MODES.SRC_ATOP] = [e.DST_ALPHA, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.DST_OVER] = [e.ONE_MINUS_DST_ALPHA, e.ONE]),
                (r[t.BLEND_MODES.DST_IN] = [e.ZERO, e.SRC_ALPHA]),
                (r[t.BLEND_MODES.DST_OUT] = [e.ZERO, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.DST_ATOP] = [e.ONE_MINUS_DST_ALPHA, e.SRC_ALPHA]),
                (r[t.BLEND_MODES.XOR] = [e.ONE_MINUS_DST_ALPHA, e.ONE_MINUS_SRC_ALPHA]),
                (r[t.BLEND_MODES.SUBTRACT] = [
                  e.ONE,
                  e.ONE,
                  e.ONE,
                  e.ONE,
                  e.FUNC_REVERSE_SUBTRACT,
                  e.FUNC_ADD,
                ]),
                r
              );
            })(e)),
            this.set(this.defaultState),
            this.reset();
        }),
        (e.prototype.set = function (t) {
          if (((t = t || this.defaultState), this.stateId !== t.data)) {
            for (var e = this.stateId ^ t.data, r = 0; e; )
              1 & e && this.map[r].call(this, !!(t.data & (1 << r))), (e >>= 1), r++;
            this.stateId = t.data;
          }
          for (r = 0; r < this.checks.length; r++) this.checks[r](this, t);
        }),
        (e.prototype.forceState = function (t) {
          t = t || this.defaultState;
          for (var e = 0; e < this.map.length; e++) this.map[e].call(this, !!(t.data & (1 << e)));
          for (e = 0; e < this.checks.length; e++) this.checks[e](this, t);
          this.stateId = t.data;
        }),
        (e.prototype.setBlend = function (t) {
          this.updateCheck(e.checkBlendMode, t), this.gl[t ? "enable" : "disable"](this.gl.BLEND);
        }),
        (e.prototype.setOffset = function (t) {
          this.updateCheck(e.checkPolygonOffset, t),
            this.gl[t ? "enable" : "disable"](this.gl.POLYGON_OFFSET_FILL);
        }),
        (e.prototype.setDepthTest = function (t) {
          this.gl[t ? "enable" : "disable"](this.gl.DEPTH_TEST);
        }),
        (e.prototype.setDepthMask = function (t) {
          this.gl.depthMask(t);
        }),
        (e.prototype.setCullFace = function (t) {
          this.gl[t ? "enable" : "disable"](this.gl.CULL_FACE);
        }),
        (e.prototype.setFrontFace = function (t) {
          this.gl.frontFace(this.gl[t ? "CW" : "CCW"]);
        }),
        (e.prototype.setBlendMode = function (t) {
          if (t !== this.blendMode) {
            this.blendMode = t;
            var e = this.blendModes[t],
              r = this.gl;
            2 === e.length ? r.blendFunc(e[0], e[1]) : r.blendFuncSeparate(e[0], e[1], e[2], e[3]),
              6 === e.length
                ? ((this._blendEq = !0), r.blendEquationSeparate(e[4], e[5]))
                : this._blendEq &&
                  ((this._blendEq = !1), r.blendEquationSeparate(r.FUNC_ADD, r.FUNC_ADD));
          }
        }),
        (e.prototype.setPolygonOffset = function (t, e) {
          this.gl.polygonOffset(t, e);
        }),
        (e.prototype.reset = function () {
          this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, !1),
            this.forceState(this.defaultState),
            (this._blendEq = !0),
            (this.blendMode = -1),
            this.setBlendMode(0);
        }),
        (e.prototype.updateCheck = function (t, e) {
          var r = this.checks.indexOf(t);
          e && -1 === r ? this.checks.push(t) : e || -1 === r || this.checks.splice(r, 1);
        }),
        (e.checkBlendMode = function (t, e) {
          t.setBlendMode(e.blendMode);
        }),
        (e.checkPolygonOffset = function (t, e) {
          t.setPolygonOffset(1, e.polygonOffset);
        }),
        (e.prototype.destroy = function () {
          this.gl = null;
        }),
        e
      );
    })(),
    oo = (function () {
      function e(t) {
        (this.renderer = t),
          (this.count = 0),
          (this.checkCount = 0),
          (this.maxIdle = rt.GC_MAX_IDLE),
          (this.checkCountMax = rt.GC_MAX_CHECK_COUNT),
          (this.mode = rt.GC_MODE);
      }
      return (
        (e.prototype.postrender = function () {
          this.renderer.renderingToScreen &&
            (this.count++,
            this.mode !== t.GC_MODES.MANUAL &&
              (this.checkCount++,
              this.checkCount > this.checkCountMax && ((this.checkCount = 0), this.run())));
        }),
        (e.prototype.run = function () {
          for (
            var t = this.renderer.texture, e = t.managedTextures, r = !1, i = 0;
            i < e.length;
            i++
          ) {
            var n = e[i];
            !n.framebuffer &&
              this.count - n.touched > this.maxIdle &&
              (t.destroyTexture(n, !0), (e[i] = null), (r = !0));
          }
          if (r) {
            var o = 0;
            for (i = 0; i < e.length; i++) null !== e[i] && (e[o++] = e[i]);
            e.length = o;
          }
        }),
        (e.prototype.unload = function (t) {
          var e = this.renderer.texture,
            r = t._texture;
          r && !r.framebuffer && e.destroyTexture(r);
          for (var i = t.children.length - 1; i >= 0; i--) this.unload(t.children[i]);
        }),
        (e.prototype.destroy = function () {
          this.renderer = null;
        }),
        e
      );
    })(),
    so = function (e) {
      (this.texture = e),
        (this.width = -1),
        (this.height = -1),
        (this.dirtyId = -1),
        (this.dirtyStyleId = -1),
        (this.mipmap = !1),
        (this.wrapMode = 33071),
        (this.type = t.TYPES.UNSIGNED_BYTE),
        (this.internalFormat = t.FORMATS.RGBA),
        (this.samplerType = 0);
    },
    ao = (function () {
      function e(t) {
        (this.renderer = t),
          (this.boundTextures = []),
          (this.currentLocation = -1),
          (this.managedTextures = []),
          (this._unknownBoundTextures = !1),
          (this.unknownTexture = new si()),
          (this.hasIntegerTextures = !1);
      }
      return (
        (e.prototype.contextChange = function () {
          var e = (this.gl = this.renderer.gl);
          (this.CONTEXT_UID = this.renderer.CONTEXT_UID),
            (this.webGLVersion = this.renderer.context.webGLVersion),
            (this.internalFormats = (function (e) {
              var r, i, n, o, s, a, h, u, l, c, d, f, p, _, m, v, E, T, y, g, R, b, A;
              return (
                "WebGL2RenderingContext" in globalThis &&
                e instanceof globalThis.WebGL2RenderingContext
                  ? (((r = {})[t.TYPES.UNSIGNED_BYTE] =
                      (((i = {})[t.FORMATS.RGBA] = e.RGBA8),
                      (i[t.FORMATS.RGB] = e.RGB8),
                      (i[t.FORMATS.RG] = e.RG8),
                      (i[t.FORMATS.RED] = e.R8),
                      (i[t.FORMATS.RGBA_INTEGER] = e.RGBA8UI),
                      (i[t.FORMATS.RGB_INTEGER] = e.RGB8UI),
                      (i[t.FORMATS.RG_INTEGER] = e.RG8UI),
                      (i[t.FORMATS.RED_INTEGER] = e.R8UI),
                      (i[t.FORMATS.ALPHA] = e.ALPHA),
                      (i[t.FORMATS.LUMINANCE] = e.LUMINANCE),
                      (i[t.FORMATS.LUMINANCE_ALPHA] = e.LUMINANCE_ALPHA),
                      i)),
                    (r[t.TYPES.BYTE] =
                      (((n = {})[t.FORMATS.RGBA] = e.RGBA8_SNORM),
                      (n[t.FORMATS.RGB] = e.RGB8_SNORM),
                      (n[t.FORMATS.RG] = e.RG8_SNORM),
                      (n[t.FORMATS.RED] = e.R8_SNORM),
                      (n[t.FORMATS.RGBA_INTEGER] = e.RGBA8I),
                      (n[t.FORMATS.RGB_INTEGER] = e.RGB8I),
                      (n[t.FORMATS.RG_INTEGER] = e.RG8I),
                      (n[t.FORMATS.RED_INTEGER] = e.R8I),
                      n)),
                    (r[t.TYPES.UNSIGNED_SHORT] =
                      (((o = {})[t.FORMATS.RGBA_INTEGER] = e.RGBA16UI),
                      (o[t.FORMATS.RGB_INTEGER] = e.RGB16UI),
                      (o[t.FORMATS.RG_INTEGER] = e.RG16UI),
                      (o[t.FORMATS.RED_INTEGER] = e.R16UI),
                      (o[t.FORMATS.DEPTH_COMPONENT] = e.DEPTH_COMPONENT16),
                      o)),
                    (r[t.TYPES.SHORT] =
                      (((s = {})[t.FORMATS.RGBA_INTEGER] = e.RGBA16I),
                      (s[t.FORMATS.RGB_INTEGER] = e.RGB16I),
                      (s[t.FORMATS.RG_INTEGER] = e.RG16I),
                      (s[t.FORMATS.RED_INTEGER] = e.R16I),
                      s)),
                    (r[t.TYPES.UNSIGNED_INT] =
                      (((a = {})[t.FORMATS.RGBA_INTEGER] = e.RGBA32UI),
                      (a[t.FORMATS.RGB_INTEGER] = e.RGB32UI),
                      (a[t.FORMATS.RG_INTEGER] = e.RG32UI),
                      (a[t.FORMATS.RED_INTEGER] = e.R32UI),
                      (a[t.FORMATS.DEPTH_COMPONENT] = e.DEPTH_COMPONENT24),
                      a)),
                    (r[t.TYPES.INT] =
                      (((h = {})[t.FORMATS.RGBA_INTEGER] = e.RGBA32I),
                      (h[t.FORMATS.RGB_INTEGER] = e.RGB32I),
                      (h[t.FORMATS.RG_INTEGER] = e.RG32I),
                      (h[t.FORMATS.RED_INTEGER] = e.R32I),
                      h)),
                    (r[t.TYPES.FLOAT] =
                      (((u = {})[t.FORMATS.RGBA] = e.RGBA32F),
                      (u[t.FORMATS.RGB] = e.RGB32F),
                      (u[t.FORMATS.RG] = e.RG32F),
                      (u[t.FORMATS.RED] = e.R32F),
                      (u[t.FORMATS.DEPTH_COMPONENT] = e.DEPTH_COMPONENT32F),
                      u)),
                    (r[t.TYPES.HALF_FLOAT] =
                      (((l = {})[t.FORMATS.RGBA] = e.RGBA16F),
                      (l[t.FORMATS.RGB] = e.RGB16F),
                      (l[t.FORMATS.RG] = e.RG16F),
                      (l[t.FORMATS.RED] = e.R16F),
                      l)),
                    (r[t.TYPES.UNSIGNED_SHORT_5_6_5] = (((c = {})[t.FORMATS.RGB] = e.RGB565), c)),
                    (r[t.TYPES.UNSIGNED_SHORT_4_4_4_4] = (((d = {})[t.FORMATS.RGBA] = e.RGBA4), d)),
                    (r[t.TYPES.UNSIGNED_SHORT_5_5_5_1] =
                      (((f = {})[t.FORMATS.RGBA] = e.RGB5_A1), f)),
                    (r[t.TYPES.UNSIGNED_INT_2_10_10_10_REV] =
                      (((p = {})[t.FORMATS.RGBA] = e.RGB10_A2),
                      (p[t.FORMATS.RGBA_INTEGER] = e.RGB10_A2UI),
                      p)),
                    (r[t.TYPES.UNSIGNED_INT_10F_11F_11F_REV] =
                      (((_ = {})[t.FORMATS.RGB] = e.R11F_G11F_B10F), _)),
                    (r[t.TYPES.UNSIGNED_INT_5_9_9_9_REV] =
                      (((m = {})[t.FORMATS.RGB] = e.RGB9_E5), m)),
                    (r[t.TYPES.UNSIGNED_INT_24_8] =
                      (((v = {})[t.FORMATS.DEPTH_STENCIL] = e.DEPTH24_STENCIL8), v)),
                    (r[t.TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV] =
                      (((E = {})[t.FORMATS.DEPTH_STENCIL] = e.DEPTH32F_STENCIL8), E)),
                    (A = r))
                  : (((T = {})[t.TYPES.UNSIGNED_BYTE] =
                      (((y = {})[t.FORMATS.RGBA] = e.RGBA),
                      (y[t.FORMATS.RGB] = e.RGB),
                      (y[t.FORMATS.ALPHA] = e.ALPHA),
                      (y[t.FORMATS.LUMINANCE] = e.LUMINANCE),
                      (y[t.FORMATS.LUMINANCE_ALPHA] = e.LUMINANCE_ALPHA),
                      y)),
                    (T[t.TYPES.UNSIGNED_SHORT_5_6_5] = (((g = {})[t.FORMATS.RGB] = e.RGB), g)),
                    (T[t.TYPES.UNSIGNED_SHORT_4_4_4_4] = (((R = {})[t.FORMATS.RGBA] = e.RGBA), R)),
                    (T[t.TYPES.UNSIGNED_SHORT_5_5_5_1] = (((b = {})[t.FORMATS.RGBA] = e.RGBA), b)),
                    (A = T)),
                A
              );
            })(e));
          var r = e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);
          this.boundTextures.length = r;
          for (var i = 0; i < r; i++) this.boundTextures[i] = null;
          this.emptyTextures = {};
          var n = new so(e.createTexture());
          for (
            e.bindTexture(e.TEXTURE_2D, n.texture),
              e.texImage2D(
                e.TEXTURE_2D,
                0,
                e.RGBA,
                1,
                1,
                0,
                e.RGBA,
                e.UNSIGNED_BYTE,
                new Uint8Array(4)
              ),
              this.emptyTextures[e.TEXTURE_2D] = n,
              this.emptyTextures[e.TEXTURE_CUBE_MAP] = new so(e.createTexture()),
              e.bindTexture(e.TEXTURE_CUBE_MAP, this.emptyTextures[e.TEXTURE_CUBE_MAP].texture),
              i = 0;
            i < 6;
            i++
          )
            e.texImage2D(
              e.TEXTURE_CUBE_MAP_POSITIVE_X + i,
              0,
              e.RGBA,
              1,
              1,
              0,
              e.RGBA,
              e.UNSIGNED_BYTE,
              null
            );
          for (
            e.texParameteri(e.TEXTURE_CUBE_MAP, e.TEXTURE_MAG_FILTER, e.LINEAR),
              e.texParameteri(e.TEXTURE_CUBE_MAP, e.TEXTURE_MIN_FILTER, e.LINEAR),
              i = 0;
            i < this.boundTextures.length;
            i++
          )
            this.bind(null, i);
        }),
        (e.prototype.bind = function (t, e) {
          void 0 === e && (e = 0);
          var r = this.gl;
          if (
            (t = null == t ? void 0 : t.castToBaseTexture()) &&
            t.valid &&
            !t.parentTextureArray
          ) {
            t.touched = this.renderer.textureGC.count;
            var i = t._glTextures[this.CONTEXT_UID] || this.initTexture(t);
            this.boundTextures[e] !== t &&
              (this.currentLocation !== e &&
                ((this.currentLocation = e), r.activeTexture(r.TEXTURE0 + e)),
              r.bindTexture(t.target, i.texture)),
              i.dirtyId !== t.dirtyId &&
                (this.currentLocation !== e &&
                  ((this.currentLocation = e), r.activeTexture(r.TEXTURE0 + e)),
                this.updateTexture(t)),
              (this.boundTextures[e] = t);
          } else
            this.currentLocation !== e &&
              ((this.currentLocation = e), r.activeTexture(r.TEXTURE0 + e)),
              r.bindTexture(r.TEXTURE_2D, this.emptyTextures[r.TEXTURE_2D].texture),
              (this.boundTextures[e] = null);
        }),
        (e.prototype.reset = function () {
          (this._unknownBoundTextures = !0),
            (this.hasIntegerTextures = !1),
            (this.currentLocation = -1);
          for (var t = 0; t < this.boundTextures.length; t++)
            this.boundTextures[t] = this.unknownTexture;
        }),
        (e.prototype.unbind = function (t) {
          var e = this.gl,
            r = this.boundTextures;
          if (this._unknownBoundTextures) {
            this._unknownBoundTextures = !1;
            for (var i = 0; i < r.length; i++) r[i] === this.unknownTexture && this.bind(null, i);
          }
          for (i = 0; i < r.length; i++)
            r[i] === t &&
              (this.currentLocation !== i &&
                (e.activeTexture(e.TEXTURE0 + i), (this.currentLocation = i)),
              e.bindTexture(t.target, this.emptyTextures[t.target].texture),
              (r[i] = null));
        }),
        (e.prototype.ensureSamplerType = function (e) {
          var r = this.boundTextures,
            i = this.hasIntegerTextures,
            n = this.CONTEXT_UID;
          if (i)
            for (var o = e - 1; o >= 0; --o) {
              var s = r[o];
              s &&
                s._glTextures[n].samplerType !== t.SAMPLER_TYPES.FLOAT &&
                this.renderer.texture.unbind(s);
            }
        }),
        (e.prototype.initTexture = function (t) {
          var e = new so(this.gl.createTexture());
          return (
            (e.dirtyId = -1),
            (t._glTextures[this.CONTEXT_UID] = e),
            this.managedTextures.push(t),
            t.on("dispose", this.destroyTexture, this),
            e
          );
        }),
        (e.prototype.initTextureType = function (e, r) {
          var i, n;
          (r.internalFormat =
            null !==
              (n =
                null === (i = this.internalFormats[e.type]) || void 0 === i
                  ? void 0
                  : i[e.format]) && void 0 !== n
              ? n
              : e.format),
            2 === this.webGLVersion && e.type === t.TYPES.HALF_FLOAT
              ? (r.type = this.gl.HALF_FLOAT)
              : (r.type = e.type);
        }),
        (e.prototype.updateTexture = function (e) {
          var r = e._glTextures[this.CONTEXT_UID];
          if (r) {
            var i = this.renderer;
            if ((this.initTextureType(e, r), e.resource && e.resource.upload(i, e, r)))
              r.samplerType !== t.SAMPLER_TYPES.FLOAT && (this.hasIntegerTextures = !0);
            else {
              var n = e.realWidth,
                o = e.realHeight,
                s = i.gl;
              (r.width !== n || r.height !== o || r.dirtyId < 0) &&
                ((r.width = n),
                (r.height = o),
                s.texImage2D(e.target, 0, r.internalFormat, n, o, 0, e.format, r.type, null));
            }
            e.dirtyStyleId !== r.dirtyStyleId && this.updateTextureStyle(e),
              (r.dirtyId = e.dirtyId);
          }
        }),
        (e.prototype.destroyTexture = function (t, e) {
          var r = this.gl;
          if (
            (t = t.castToBaseTexture())._glTextures[this.CONTEXT_UID] &&
            (this.unbind(t),
            r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),
            t.off("dispose", this.destroyTexture, this),
            delete t._glTextures[this.CONTEXT_UID],
            !e)
          ) {
            var i = this.managedTextures.indexOf(t);
            -1 !== i && xe(this.managedTextures, i, 1);
          }
        }),
        (e.prototype.updateTextureStyle = function (e) {
          var r = e._glTextures[this.CONTEXT_UID];
          r &&
            ((e.mipmap !== t.MIPMAP_MODES.POW2 && 2 === this.webGLVersion) || e.isPowerOfTwo
              ? (r.mipmap = e.mipmap >= 1)
              : (r.mipmap = !1),
            2 === this.webGLVersion || e.isPowerOfTwo
              ? (r.wrapMode = e.wrapMode)
              : (r.wrapMode = t.WRAP_MODES.CLAMP),
            (e.resource && e.resource.style(this.renderer, e, r)) || this.setStyle(e, r),
            (r.dirtyStyleId = e.dirtyStyleId));
        }),
        (e.prototype.setStyle = function (e, r) {
          var i = this.gl;
          if (
            (r.mipmap && e.mipmap !== t.MIPMAP_MODES.ON_MANUAL && i.generateMipmap(e.target),
            i.texParameteri(e.target, i.TEXTURE_WRAP_S, r.wrapMode),
            i.texParameteri(e.target, i.TEXTURE_WRAP_T, r.wrapMode),
            r.mipmap)
          ) {
            i.texParameteri(
              e.target,
              i.TEXTURE_MIN_FILTER,
              e.scaleMode === t.SCALE_MODES.LINEAR
                ? i.LINEAR_MIPMAP_LINEAR
                : i.NEAREST_MIPMAP_NEAREST
            );
            var n = this.renderer.context.extensions.anisotropicFiltering;
            if (n && e.anisotropicLevel > 0 && e.scaleMode === t.SCALE_MODES.LINEAR) {
              var o = Math.min(
                e.anisotropicLevel,
                i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)
              );
              i.texParameterf(e.target, n.TEXTURE_MAX_ANISOTROPY_EXT, o);
            }
          } else
            i.texParameteri(
              e.target,
              i.TEXTURE_MIN_FILTER,
              e.scaleMode === t.SCALE_MODES.LINEAR ? i.LINEAR : i.NEAREST
            );
          i.texParameteri(
            e.target,
            i.TEXTURE_MAG_FILTER,
            e.scaleMode === t.SCALE_MODES.LINEAR ? i.LINEAR : i.NEAREST
          );
        }),
        (e.prototype.destroy = function () {
          this.renderer = null;
        }),
        e
      );
    })(),
    ho = {
      __proto__: null,
      FilterSystem: ki,
      BatchSystem: Yi,
      ContextSystem: Vi,
      FramebufferSystem: qi,
      GeometrySystem: Zi,
      MaskSystem: Nn,
      ScissorSystem: Ln,
      StencilSystem: wn,
      ProjectionSystem: Fn,
      RenderTextureSystem: Gn,
      ShaderSystem: Qn,
      StateSystem: no,
      TextureGCSystem: oo,
      TextureSystem: ao,
    },
    uo = new Qe(),
    lo = (function (e) {
      function r(r, i) {
        void 0 === r && (r = t.RENDERER_TYPE.UNKNOWN);
        var n = e.call(this) || this;
        return (
          (i = Object.assign({}, rt.RENDER_OPTIONS, i)),
          (n.options = i),
          (n.type = r),
          (n.screen = new Ve(0, 0, i.width, i.height)),
          (n.view = i.view || document.createElement("canvas")),
          (n.resolution = i.resolution || rt.RESOLUTION),
          (n.useContextAlpha = i.useContextAlpha),
          (n.autoDensity = !!i.autoDensity),
          (n.preserveDrawingBuffer = i.preserveDrawingBuffer),
          (n.clearBeforeRender = i.clearBeforeRender),
          (n._backgroundColor = 0),
          (n._backgroundColorRgba = [0, 0, 0, 1]),
          (n._backgroundColorString = "#000000"),
          (n.backgroundColor = i.backgroundColor || n._backgroundColor),
          (n.backgroundAlpha = i.backgroundAlpha),
          void 0 !== i.transparent &&
            ((n.useContextAlpha = i.transparent), (n.backgroundAlpha = i.transparent ? 0 : 1)),
          (n._lastObjectRendered = null),
          (n.plugins = {}),
          n
        );
      }
      return (
        ei(r, e),
        (r.prototype.initPlugins = function (t) {
          for (var e in t) this.plugins[e] = new t[e](this);
        }),
        Object.defineProperty(r.prototype, "width", {
          get: function () {
            return this.view.width;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "height", {
          get: function () {
            return this.view.height;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.resize = function (t, e) {
          (this.view.width = Math.round(t * this.resolution)),
            (this.view.height = Math.round(e * this.resolution));
          var r = this.view.width / this.resolution,
            i = this.view.height / this.resolution;
          (this.screen.width = r),
            (this.screen.height = i),
            this.autoDensity &&
              ((this.view.style.width = r + "px"), (this.view.style.height = i + "px")),
            this.emit("resize", r, i);
        }),
        (r.prototype.generateTexture = function (t, e, r, i) {
          void 0 === e && (e = {}),
            "number" == typeof e && (e = { scaleMode: e, resolution: r, region: i });
          var n = e.region,
            o = (function (t, e) {
              var r = {};
              for (var i in t)
                Object.prototype.hasOwnProperty.call(t, i) && e.indexOf(i) < 0 && (r[i] = t[i]);
              if (null != t && "function" == typeof Object.getOwnPropertySymbols) {
                var n = 0;
                for (i = Object.getOwnPropertySymbols(t); n < i.length; n++)
                  e.indexOf(i[n]) < 0 && (r[i[n]] = t[i[n]]);
              }
              return r;
            })(e, ["region"]);
          0 === (i = n || t.getLocalBounds(null, !0)).width && (i.width = 1),
            0 === i.height && (i.height = 1);
          var s = Ai.create(ri({ width: i.width, height: i.height }, o));
          return (
            (uo.tx = -i.x),
            (uo.ty = -i.y),
            this.render(t, {
              renderTexture: s,
              clear: !1,
              transform: uo,
              skipUpdateTransform: !!t.parent,
            }),
            s
          );
        }),
        (r.prototype.destroy = function (e) {
          for (var r in this.plugins) this.plugins[r].destroy(), (this.plugins[r] = null);
          e && this.view.parentNode && this.view.parentNode.removeChild(this.view),
            (this.plugins = null),
            (this.type = t.RENDERER_TYPE.UNKNOWN),
            (this.view = null),
            (this.screen = null),
            (this._tempDisplayObjectParent = null),
            (this.options = null),
            (this._backgroundColorRgba = null),
            (this._backgroundColorString = null),
            (this._lastObjectRendered = null);
        }),
        Object.defineProperty(r.prototype, "backgroundColor", {
          get: function () {
            return this._backgroundColor;
          },
          set: function (t) {
            (this._backgroundColor = t),
              (this._backgroundColorString = de(t)),
              ce(t, this._backgroundColorRgba);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "backgroundAlpha", {
          get: function () {
            return this._backgroundColorRgba[3];
          },
          set: function (t) {
            this._backgroundColorRgba[3] = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        r
      );
    })(ot),
    co = function (t) {
      (this.buffer = t || null), (this.updateID = -1), (this.byteLength = -1), (this.refCount = 0);
    },
    fo = (function () {
      function t(t) {
        (this.renderer = t), (this.managedBuffers = {}), (this.boundBufferBases = {});
      }
      return (
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        (t.prototype.contextChange = function () {
          this.disposeAll(!0),
            (this.gl = this.renderer.gl),
            (this.CONTEXT_UID = this.renderer.CONTEXT_UID);
        }),
        (t.prototype.bind = function (t) {
          var e = this.gl,
            r = this.CONTEXT_UID,
            i = t._glBuffers[r] || this.createGLBuffer(t);
          e.bindBuffer(t.type, i.buffer);
        }),
        (t.prototype.bindBufferBase = function (t, e) {
          var r = this.gl,
            i = this.CONTEXT_UID;
          if (this.boundBufferBases[e] !== t) {
            var n = t._glBuffers[i] || this.createGLBuffer(t);
            (this.boundBufferBases[e] = t), r.bindBufferBase(r.UNIFORM_BUFFER, e, n.buffer);
          }
        }),
        (t.prototype.bindBufferRange = function (t, e, r) {
          var i = this.gl,
            n = this.CONTEXT_UID;
          r = r || 0;
          var o = t._glBuffers[n] || this.createGLBuffer(t);
          i.bindBufferRange(i.UNIFORM_BUFFER, e || 0, o.buffer, 256 * r, 256);
        }),
        (t.prototype.update = function (t) {
          var e = this.gl,
            r = this.CONTEXT_UID,
            i = t._glBuffers[r];
          if (t._updateID !== i.updateID)
            if (
              ((i.updateID = t._updateID),
              e.bindBuffer(t.type, i.buffer),
              i.byteLength >= t.data.byteLength)
            )
              e.bufferSubData(t.type, 0, t.data);
            else {
              var n = t.static ? e.STATIC_DRAW : e.DYNAMIC_DRAW;
              (i.byteLength = t.data.byteLength), e.bufferData(t.type, t.data, n);
            }
        }),
        (t.prototype.dispose = function (t, e) {
          if (this.managedBuffers[t.id]) {
            delete this.managedBuffers[t.id];
            var r = t._glBuffers[this.CONTEXT_UID],
              i = this.gl;
            t.disposeRunner.remove(this),
              r && (e || i.deleteBuffer(r.buffer), delete t._glBuffers[this.CONTEXT_UID]);
          }
        }),
        (t.prototype.disposeAll = function (t) {
          for (var e = Object.keys(this.managedBuffers), r = 0; r < e.length; r++)
            this.dispose(this.managedBuffers[e[r]], t);
        }),
        (t.prototype.createGLBuffer = function (t) {
          var e = this.CONTEXT_UID,
            r = this.gl;
          return (
            (t._glBuffers[e] = new co(r.createBuffer())),
            (this.managedBuffers[t.id] = t),
            t.disposeRunner.add(this),
            t._glBuffers[e]
          );
        }),
        t
      );
    })(),
    po = (function (e) {
      function r(i) {
        var n = e.call(this, t.RENDERER_TYPE.WEBGL, i) || this;
        return (
          (i = n.options),
          (n.gl = null),
          (n.CONTEXT_UID = 0),
          (n.runners = {
            destroy: new Qr("destroy"),
            contextChange: new Qr("contextChange"),
            reset: new Qr("reset"),
            update: new Qr("update"),
            postrender: new Qr("postrender"),
            prerender: new Qr("prerender"),
            resize: new Qr("resize"),
          }),
          n.runners.contextChange.add(n),
          (n.globalUniforms = new Ui({ projectionMatrix: new Qe() }, !0)),
          n
            .addSystem(Nn, "mask")
            .addSystem(Vi, "context")
            .addSystem(no, "state")
            .addSystem(Qn, "shader")
            .addSystem(ao, "texture")
            .addSystem(fo, "buffer")
            .addSystem(Zi, "geometry")
            .addSystem(qi, "framebuffer")
            .addSystem(Ln, "scissor")
            .addSystem(wn, "stencil")
            .addSystem(Fn, "projection")
            .addSystem(oo, "textureGC")
            .addSystem(ki, "filter")
            .addSystem(Gn, "renderTexture")
            .addSystem(Yi, "batch"),
          n.initPlugins(r.__plugins),
          (n.multisample = void 0),
          i.context
            ? n.context.initFromContext(i.context)
            : n.context.initFromOptions({
                alpha: !!n.useContextAlpha,
                antialias: i.antialias,
                premultipliedAlpha: n.useContextAlpha && "notMultiplied" !== n.useContextAlpha,
                stencil: !0,
                preserveDrawingBuffer: i.preserveDrawingBuffer,
                powerPreference: n.options.powerPreference,
              }),
          (n.renderingToScreen = !0),
          he(2 === n.context.webGLVersion ? "WebGL 2" : "WebGL 1"),
          n.resize(n.options.width, n.options.height),
          n
        );
      }
      return (
        ei(r, e),
        (r.create = function (t) {
          if (ue()) return new r(t);
          throw new Error(
            'WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.'
          );
        }),
        (r.prototype.contextChange = function () {
          var e,
            r = this.gl;
          if (1 === this.context.webGLVersion) {
            var i = r.getParameter(r.FRAMEBUFFER_BINDING);
            r.bindFramebuffer(r.FRAMEBUFFER, null),
              (e = r.getParameter(r.SAMPLES)),
              r.bindFramebuffer(r.FRAMEBUFFER, i);
          } else
            (i = r.getParameter(r.DRAW_FRAMEBUFFER_BINDING)),
              r.bindFramebuffer(r.DRAW_FRAMEBUFFER, null),
              (e = r.getParameter(r.SAMPLES)),
              r.bindFramebuffer(r.DRAW_FRAMEBUFFER, i);
          e >= t.MSAA_QUALITY.HIGH
            ? (this.multisample = t.MSAA_QUALITY.HIGH)
            : e >= t.MSAA_QUALITY.MEDIUM
            ? (this.multisample = t.MSAA_QUALITY.MEDIUM)
            : e >= t.MSAA_QUALITY.LOW
            ? (this.multisample = t.MSAA_QUALITY.LOW)
            : (this.multisample = t.MSAA_QUALITY.NONE);
        }),
        (r.prototype.addSystem = function (t, e) {
          var r = new t(this);
          if (this[e]) throw new Error('Whoops! The name "' + e + '" is already in use');
          for (var i in ((this[e] = r), this.runners)) this.runners[i].add(r);
          return this;
        }),
        (r.prototype.render = function (t, e) {
          var r, i, n, o;
          if (
            (e &&
              (e instanceof Ai
                ? ((r = e), (i = arguments[2]), (n = arguments[3]), (o = arguments[4]))
                : ((r = e.renderTexture),
                  (i = e.clear),
                  (n = e.transform),
                  (o = e.skipUpdateTransform))),
            (this.renderingToScreen = !r),
            this.runners.prerender.emit(),
            this.emit("prerender"),
            (this.projection.transform = n),
            !this.context.isLost)
          ) {
            if ((r || (this._lastObjectRendered = t), !o)) {
              var s = t.enableTempParent();
              t.updateTransform(), t.disableTempParent(s);
            }
            this.renderTexture.bind(r),
              this.batch.currentRenderer.start(),
              (void 0 !== i ? i : this.clearBeforeRender) && this.renderTexture.clear(),
              t.render(this),
              this.batch.currentRenderer.flush(),
              r && r.baseTexture.update(),
              this.runners.postrender.emit(),
              (this.projection.transform = null),
              this.emit("postrender");
          }
        }),
        (r.prototype.generateTexture = function (t, r, i, n) {
          void 0 === r && (r = {});
          var o = e.prototype.generateTexture.call(this, t, r, i, n);
          return this.framebuffer.blit(), o;
        }),
        (r.prototype.resize = function (t, r) {
          e.prototype.resize.call(this, t, r),
            this.runners.resize.emit(this.screen.height, this.screen.width);
        }),
        (r.prototype.reset = function () {
          return this.runners.reset.emit(), this;
        }),
        (r.prototype.clear = function () {
          this.renderTexture.bind(), this.renderTexture.clear();
        }),
        (r.prototype.destroy = function (t) {
          for (var r in (this.runners.destroy.emit(), this.runners)) this.runners[r].destroy();
          e.prototype.destroy.call(this, t), (this.gl = null);
        }),
        Object.defineProperty(r.prototype, "extract", {
          get: function () {
            return this.plugins.extract;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.registerPlugin = function (t, e) {
          (r.__plugins = r.__plugins || {}), (r.__plugins[t] = e);
        }),
        r
      );
    })(lo);
  function _o(t) {
    return po.create(t);
  }
  var mo =
      "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
    vo =
      "attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",
    Eo = (function () {
      function t(t) {
        this.renderer = t;
      }
      return (
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        t
      );
    })(),
    To = function () {
      (this.texArray = null),
        (this.blend = 0),
        (this.type = t.DRAW_MODES.TRIANGLES),
        (this.start = 0),
        (this.size = 0),
        (this.data = null);
    },
    yo = (function () {
      function t() {
        (this.elements = []), (this.ids = []), (this.count = 0);
      }
      return (
        (t.prototype.clear = function () {
          for (var t = 0; t < this.count; t++) this.elements[t] = null;
          this.count = 0;
        }),
        t
      );
    })(),
    go = (function () {
      function t(t) {
        "number" == typeof t
          ? (this.rawBinaryData = new ArrayBuffer(t))
          : t instanceof Uint8Array
          ? (this.rawBinaryData = t.buffer)
          : (this.rawBinaryData = t),
          (this.uint32View = new Uint32Array(this.rawBinaryData)),
          (this.float32View = new Float32Array(this.rawBinaryData));
      }
      return (
        Object.defineProperty(t.prototype, "int8View", {
          get: function () {
            return (
              this._int8View || (this._int8View = new Int8Array(this.rawBinaryData)), this._int8View
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "uint8View", {
          get: function () {
            return (
              this._uint8View || (this._uint8View = new Uint8Array(this.rawBinaryData)),
              this._uint8View
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "int16View", {
          get: function () {
            return (
              this._int16View || (this._int16View = new Int16Array(this.rawBinaryData)),
              this._int16View
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "uint16View", {
          get: function () {
            return (
              this._uint16View || (this._uint16View = new Uint16Array(this.rawBinaryData)),
              this._uint16View
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "int32View", {
          get: function () {
            return (
              this._int32View || (this._int32View = new Int32Array(this.rawBinaryData)),
              this._int32View
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.view = function (t) {
          return this[t + "View"];
        }),
        (t.prototype.destroy = function () {
          (this.rawBinaryData = null),
            (this._int8View = null),
            (this._uint8View = null),
            (this._int16View = null),
            (this._uint16View = null),
            (this._int32View = null),
            (this.uint32View = null),
            (this.float32View = null);
        }),
        (t.sizeOf = function (t) {
          switch (t) {
            case "int8":
            case "uint8":
              return 1;
            case "int16":
            case "uint16":
              return 2;
            case "int32":
            case "uint32":
            case "float32":
              return 4;
            default:
              throw new Error(t + " isn't a valid view type");
          }
        }),
        t
      );
    })(),
    Ro = (function (e) {
      function r(t) {
        var r = e.call(this, t) || this;
        return (
          (r.shaderGenerator = null),
          (r.geometryClass = null),
          (r.vertexSize = null),
          (r.state = An.for2d()),
          (r.size = 4 * rt.SPRITE_BATCH_SIZE),
          (r._vertexCount = 0),
          (r._indexCount = 0),
          (r._bufferedElements = []),
          (r._bufferedTextures = []),
          (r._bufferSize = 0),
          (r._shader = null),
          (r._packedGeometries = []),
          (r._packedGeometryPoolSize = 2),
          (r._flushId = 0),
          (r._aBuffers = {}),
          (r._iBuffers = {}),
          (r.MAX_TEXTURES = 1),
          r.renderer.on("prerender", r.onPrerender, r),
          t.runners.contextChange.add(r),
          (r._dcIndex = 0),
          (r._aIndex = 0),
          (r._iIndex = 0),
          (r._attributeBuffer = null),
          (r._indexBuffer = null),
          (r._tempBoundTextures = []),
          r
        );
      }
      return (
        ei(r, e),
        (r.prototype.contextChange = function () {
          var e = this.renderer.gl;
          rt.PREFER_ENV === t.ENV.WEBGL_LEGACY
            ? (this.MAX_TEXTURES = 1)
            : ((this.MAX_TEXTURES = Math.min(
                e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),
                rt.SPRITE_MAX_TEXTURES
              )),
              (this.MAX_TEXTURES = Tn(this.MAX_TEXTURES, e))),
            (this._shader = this.shaderGenerator.generateShader(this.MAX_TEXTURES));
          for (var r = 0; r < this._packedGeometryPoolSize; r++)
            this._packedGeometries[r] = new this.geometryClass();
          this.initFlushBuffers();
        }),
        (r.prototype.initFlushBuffers = function () {
          for (
            var t = r._drawCallPool,
              e = r._textureArrayPool,
              i = this.size / 4,
              n = Math.floor(i / this.MAX_TEXTURES) + 1;
            t.length < i;

          )
            t.push(new To());
          for (; e.length < n; ) e.push(new yo());
          for (var o = 0; o < this.MAX_TEXTURES; o++) this._tempBoundTextures[o] = null;
        }),
        (r.prototype.onPrerender = function () {
          this._flushId = 0;
        }),
        (r.prototype.render = function (t) {
          t._texture.valid &&
            (this._vertexCount + t.vertexData.length / 2 > this.size && this.flush(),
            (this._vertexCount += t.vertexData.length / 2),
            (this._indexCount += t.indices.length),
            (this._bufferedTextures[this._bufferSize] = t._texture.baseTexture),
            (this._bufferedElements[this._bufferSize++] = t));
        }),
        (r.prototype.buildTexturesAndDrawCalls = function () {
          var t = this._bufferedTextures,
            e = this.MAX_TEXTURES,
            i = r._textureArrayPool,
            n = this.renderer.batch,
            o = this._tempBoundTextures,
            s = this.renderer.textureGC.count,
            a = ++si._globalBatch,
            h = 0,
            u = i[0],
            l = 0;
          n.copyBoundTextures(o, e);
          for (var c = 0; c < this._bufferSize; ++c) {
            var d = t[c];
            (t[c] = null),
              d._batchEnabled !== a &&
                (u.count >= e &&
                  (n.boundArray(u, o, a, e),
                  this.buildDrawCalls(u, l, c),
                  (l = c),
                  (u = i[++h]),
                  ++a),
                (d._batchEnabled = a),
                (d.touched = s),
                (u.elements[u.count++] = d));
          }
          for (
            u.count > 0 &&
              (n.boundArray(u, o, a, e), this.buildDrawCalls(u, l, this._bufferSize), ++h, ++a),
              c = 0;
            c < o.length;
            c++
          )
            o[c] = null;
          si._globalBatch = a;
        }),
        (r.prototype.buildDrawCalls = function (t, e, i) {
          var n = this._bufferedElements,
            o = this._attributeBuffer,
            s = this._indexBuffer,
            a = this.vertexSize,
            h = r._drawCallPool,
            u = this._dcIndex,
            l = this._aIndex,
            c = this._iIndex,
            d = h[u];
          (d.start = this._iIndex), (d.texArray = t);
          for (var f = e; f < i; ++f) {
            var p = n[f],
              _ = p._texture.baseTexture,
              m = pe[_.alphaMode ? 1 : 0][p.blendMode];
            (n[f] = null),
              e < f &&
                d.blend !== m &&
                ((d.size = c - d.start), (e = f), ((d = h[++u]).texArray = t), (d.start = c)),
              this.packInterleavedGeometry(p, o, s, l, c),
              (l += (p.vertexData.length / 2) * a),
              (c += p.indices.length),
              (d.blend = m);
          }
          e < i && ((d.size = c - d.start), ++u),
            (this._dcIndex = u),
            (this._aIndex = l),
            (this._iIndex = c);
        }),
        (r.prototype.bindAndClearTexArray = function (t) {
          for (var e = this.renderer.texture, r = 0; r < t.count; r++)
            e.bind(t.elements[r], t.ids[r]), (t.elements[r] = null);
          t.count = 0;
        }),
        (r.prototype.updateGeometry = function () {
          var t = this._packedGeometries,
            e = this._attributeBuffer,
            r = this._indexBuffer;
          rt.CAN_UPLOAD_SAME_BUFFER
            ? (t[this._flushId]._buffer.update(e.rawBinaryData),
              t[this._flushId]._indexBuffer.update(r),
              this.renderer.geometry.updateBuffers())
            : (this._packedGeometryPoolSize <= this._flushId &&
                (this._packedGeometryPoolSize++, (t[this._flushId] = new this.geometryClass())),
              t[this._flushId]._buffer.update(e.rawBinaryData),
              t[this._flushId]._indexBuffer.update(r),
              this.renderer.geometry.bind(t[this._flushId]),
              this.renderer.geometry.updateBuffers(),
              this._flushId++);
        }),
        (r.prototype.drawBatches = function () {
          for (
            var t = this._dcIndex,
              e = this.renderer,
              i = e.gl,
              n = e.state,
              o = r._drawCallPool,
              s = null,
              a = 0;
            a < t;
            a++
          ) {
            var h = o[a],
              u = h.texArray,
              l = h.type,
              c = h.size,
              d = h.start,
              f = h.blend;
            s !== u && ((s = u), this.bindAndClearTexArray(u)),
              (this.state.blendMode = f),
              n.set(this.state),
              i.drawElements(l, c, i.UNSIGNED_SHORT, 2 * d);
          }
        }),
        (r.prototype.flush = function () {
          0 !== this._vertexCount &&
            ((this._attributeBuffer = this.getAttributeBuffer(this._vertexCount)),
            (this._indexBuffer = this.getIndexBuffer(this._indexCount)),
            (this._aIndex = 0),
            (this._iIndex = 0),
            (this._dcIndex = 0),
            this.buildTexturesAndDrawCalls(),
            this.updateGeometry(),
            this.drawBatches(),
            (this._bufferSize = 0),
            (this._vertexCount = 0),
            (this._indexCount = 0));
        }),
        (r.prototype.start = function () {
          this.renderer.state.set(this.state),
            this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),
            this.renderer.shader.bind(this._shader),
            rt.CAN_UPLOAD_SAME_BUFFER &&
              this.renderer.geometry.bind(this._packedGeometries[this._flushId]);
        }),
        (r.prototype.stop = function () {
          this.flush();
        }),
        (r.prototype.destroy = function () {
          for (var t = 0; t < this._packedGeometryPoolSize; t++)
            this._packedGeometries[t] && this._packedGeometries[t].destroy();
          this.renderer.off("prerender", this.onPrerender, this),
            (this._aBuffers = null),
            (this._iBuffers = null),
            (this._packedGeometries = null),
            (this._attributeBuffer = null),
            (this._indexBuffer = null),
            this._shader && (this._shader.destroy(), (this._shader = null)),
            e.prototype.destroy.call(this);
        }),
        (r.prototype.getAttributeBuffer = function (t) {
          var e = Re(Math.ceil(t / 8)),
            r = Ae(e),
            i = 8 * e;
          this._aBuffers.length <= r && (this._iBuffers.length = r + 1);
          var n = this._aBuffers[i];
          return n || (this._aBuffers[i] = n = new go(i * this.vertexSize * 4)), n;
        }),
        (r.prototype.getIndexBuffer = function (t) {
          var e = Re(Math.ceil(t / 12)),
            r = Ae(e),
            i = 12 * e;
          this._iBuffers.length <= r && (this._iBuffers.length = r + 1);
          var n = this._iBuffers[r];
          return n || (this._iBuffers[r] = n = new Uint16Array(i)), n;
        }),
        (r.prototype.packInterleavedGeometry = function (t, e, r, i, n) {
          for (
            var o = e.uint32View,
              s = e.float32View,
              a = i / this.vertexSize,
              h = t.uvs,
              u = t.indices,
              l = t.vertexData,
              c = t._texture.baseTexture._batchLocation,
              d = Math.min(t.worldAlpha, 1),
              f =
                d < 1 && t._texture.baseTexture.alphaMode
                  ? ve(t._tintRGB, d)
                  : t._tintRGB + ((255 * d) << 24),
              p = 0;
            p < l.length;
            p += 2
          )
            (s[i++] = l[p]),
              (s[i++] = l[p + 1]),
              (s[i++] = h[p]),
              (s[i++] = h[p + 1]),
              (o[i++] = f),
              (s[i++] = c);
          for (p = 0; p < u.length; p++) r[n++] = a + u[p];
        }),
        (r._drawCallPool = []),
        (r._textureArrayPool = []),
        r
      );
    })(Hi),
    bo = (function () {
      function t(t, e) {
        if (
          ((this.vertexSrc = t),
          (this.fragTemplate = e),
          (this.programCache = {}),
          (this.defaultGroupCache = {}),
          e.indexOf("%count%") < 0)
        )
          throw new Error('Fragment template must contain "%count%".');
        if (e.indexOf("%forloop%") < 0)
          throw new Error('Fragment template must contain "%forloop%".');
      }
      return (
        (t.prototype.generateShader = function (t) {
          if (!this.programCache[t]) {
            for (var e = new Int32Array(t), r = 0; r < t; r++) e[r] = r;
            this.defaultGroupCache[t] = Ui.from({ uSamplers: e }, !0);
            var i = this.fragTemplate;
            (i = (i = i.replace(/%count%/gi, "" + t)).replace(
              /%forloop%/gi,
              this.generateSampleSrc(t)
            )),
              (this.programCache[t] = new Rn(this.vertexSrc, i));
          }
          var n = {
            tint: new Float32Array([1, 1, 1, 1]),
            translationMatrix: new Qe(),
            default: this.defaultGroupCache[t],
          };
          return new bn(this.programCache[t], n);
        }),
        (t.prototype.generateSampleSrc = function (t) {
          var e = "";
          (e += "\n"), (e += "\n");
          for (var r = 0; r < t; r++)
            r > 0 && (e += "\nelse "),
              r < t - 1 && (e += "if(vTextureId < " + r + ".5)"),
              (e += "\n{"),
              (e += "\n\tcolor = texture2D(uSamplers[" + r + "], vTextureCoord);"),
              (e += "\n}");
          return (e += "\n") + "\n";
        }),
        t
      );
    })(),
    Ao = (function (e) {
      function r(r) {
        void 0 === r && (r = !1);
        var i = e.call(this) || this;
        return (
          (i._buffer = new Ii(null, r, !1)),
          (i._indexBuffer = new Ii(null, r, !0)),
          i
            .addAttribute("aVertexPosition", i._buffer, 2, !1, t.TYPES.FLOAT)
            .addAttribute("aTextureCoord", i._buffer, 2, !1, t.TYPES.FLOAT)
            .addAttribute("aColor", i._buffer, 4, !0, t.TYPES.UNSIGNED_BYTE)
            .addAttribute("aTextureId", i._buffer, 1, !0, t.TYPES.FLOAT)
            .addIndex(i._indexBuffer),
          i
        );
      }
      return ei(r, e), r;
    })(Ci),
    xo =
      "precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",
    So =
      "varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",
    Oo = (function () {
      function t() {}
      return (
        (t.create = function (t) {
          var e = Object.assign({ vertex: xo, fragment: So, geometryClass: Ao, vertexSize: 6 }, t),
            r = e.vertex,
            i = e.fragment,
            n = e.vertexSize,
            o = e.geometryClass;
          return (function (t) {
            function e(e) {
              var s = t.call(this, e) || this;
              return (
                (s.shaderGenerator = new bo(r, i)), (s.geometryClass = o), (s.vertexSize = n), s
              );
            }
            return ei(e, t), e;
          })(Ro);
        }),
        Object.defineProperty(t, "defaultVertexSrc", {
          get: function () {
            return xo;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t, "defaultFragmentTemplate", {
          get: function () {
            return So;
          },
          enumerable: !1,
          configurable: !0,
        }),
        t
      );
    })(),
    Io = Oo.create(),
    Po = {},
    Mo = function (t) {
      Object.defineProperty(Po, t, {
        get: function () {
          return mi[t];
        },
      });
    };
  for (var No in mi) Mo(No);
  var Do = {},
    Co = function (t) {
      Object.defineProperty(Do, t, {
        get: function () {
          return ho[t];
        },
      });
    };
  for (var No in ho) Co(No);
  var Lo = (function () {
      function t(e) {
        var r = this;
        (this.stage = new Dr()),
          (e = Object.assign({ forceCanvas: !1 }, e)),
          (this.renderer = _o(e)),
          t._plugins.forEach(function (t) {
            t.init.call(r, e);
          });
      }
      return (
        (t.registerPlugin = function (e) {
          t._plugins.push(e);
        }),
        (t.prototype.render = function () {
          this.renderer.render(this.stage);
        }),
        Object.defineProperty(t.prototype, "view", {
          get: function () {
            return this.renderer.view;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "screen", {
          get: function () {
            return this.renderer.screen;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.destroy = function (e, r) {
          var i = this,
            n = t._plugins.slice(0);
          n.reverse(),
            n.forEach(function (t) {
              t.destroy.call(i);
            }),
            this.stage.destroy(r),
            (this.stage = null),
            this.renderer.destroy(e),
            (this.renderer = null);
        }),
        (t._plugins = []),
        t
      );
    })(),
    wo = (function () {
      function t() {}
      return (
        (t.init = function (t) {
          var e = this;
          Object.defineProperty(this, "resizeTo", {
            set: function (t) {
              globalThis.removeEventListener("resize", this.queueResize),
                (this._resizeTo = t),
                t && (globalThis.addEventListener("resize", this.queueResize), this.resize());
            },
            get: function () {
              return this._resizeTo;
            },
          }),
            (this.queueResize = function () {
              e._resizeTo &&
                (e.cancelResize(),
                (e._resizeId = requestAnimationFrame(function () {
                  return e.resize();
                })));
            }),
            (this.cancelResize = function () {
              e._resizeId && (cancelAnimationFrame(e._resizeId), (e._resizeId = null));
            }),
            (this.resize = function () {
              if (e._resizeTo) {
                var t, r;
                if ((e.cancelResize(), e._resizeTo === globalThis.window))
                  (t = globalThis.innerWidth), (r = globalThis.innerHeight);
                else {
                  var i = e._resizeTo;
                  (t = i.clientWidth), (r = i.clientHeight);
                }
                e.renderer.resize(t, r);
              }
            }),
            (this._resizeId = null),
            (this._resizeTo = null),
            (this.resizeTo = t.resizeTo || null);
        }),
        (t.destroy = function () {
          globalThis.removeEventListener("resize", this.queueResize),
            this.cancelResize(),
            (this.cancelResize = null),
            (this.queueResize = null),
            (this.resizeTo = null),
            (this.resize = null);
        }),
        t
      );
    })();
  Lo.registerPlugin(wo);
  var Fo = new Ve(),
    Uo = (function () {
      function t(t) {
        this.renderer = t;
      }
      return (
        (t.prototype.image = function (t, e, r) {
          var i = new Image();
          return (i.src = this.base64(t, e, r)), i;
        }),
        (t.prototype.base64 = function (t, e, r) {
          return this.canvas(t).toDataURL(e, r);
        }),
        (t.prototype.canvas = function (e) {
          var r,
            i,
            n,
            o = this.renderer,
            s = !1,
            a = !1;
          e && (e instanceof Ai ? (n = e) : ((n = this.renderer.generateTexture(e)), (a = !0))),
            n
              ? ((r = n.baseTexture.resolution), (i = n.frame), (s = !1), o.renderTexture.bind(n))
              : ((r = this.renderer.resolution),
                (s = !0),
                ((i = Fo).width = this.renderer.width),
                (i.height = this.renderer.height),
                o.renderTexture.bind(null));
          var h = Math.floor(i.width * r + 1e-4),
            u = Math.floor(i.height * r + 1e-4),
            l = new Ce(h, u, 1),
            c = new Uint8Array(4 * h * u),
            d = o.gl;
          d.readPixels(i.x * r, i.y * r, h, u, d.RGBA, d.UNSIGNED_BYTE, c);
          var f = l.context.getImageData(0, 0, h, u);
          if ((t.arrayPostDivide(c, f.data), l.context.putImageData(f, 0, 0), s)) {
            var p = new Ce(l.width, l.height, 1);
            p.context.scale(1, -1), p.context.drawImage(l.canvas, 0, -u), l.destroy(), (l = p);
          }
          return a && n.destroy(!0), l.canvas;
        }),
        (t.prototype.pixels = function (e) {
          var r,
            i,
            n,
            o = this.renderer,
            s = !1;
          e && (e instanceof Ai ? (n = e) : ((n = this.renderer.generateTexture(e)), (s = !0))),
            n
              ? ((r = n.baseTexture.resolution), (i = n.frame), o.renderTexture.bind(n))
              : ((r = o.resolution),
                ((i = Fo).width = o.width),
                (i.height = o.height),
                o.renderTexture.bind(null));
          var a = i.width * r,
            h = i.height * r,
            u = new Uint8Array(4 * a * h),
            l = o.gl;
          return (
            l.readPixels(i.x * r, i.y * r, a, h, l.RGBA, l.UNSIGNED_BYTE, u),
            s && n.destroy(!0),
            t.arrayPostDivide(u, u),
            u
          );
        }),
        (t.prototype.destroy = function () {
          this.renderer = null;
        }),
        (t.arrayPostDivide = function (t, e) {
          for (var r = 0; r < t.length; r += 4) {
            var i = (e[r + 3] = t[r + 3]);
            0 !== i
              ? ((e[r] = Math.round(Math.min((255 * t[r]) / i, 255))),
                (e[r + 1] = Math.round(Math.min((255 * t[r + 1]) / i, 255))),
                (e[r + 2] = Math.round(Math.min((255 * t[r + 2]) / i, 255))))
              : ((e[r] = t[r]), (e[r + 1] = t[r + 1]), (e[r + 2] = t[r + 2]));
          }
        }),
        t
      );
    })(),
    Bo = (function () {
      function t(t, e, r) {
        void 0 === e && (e = !1),
          (this._fn = t),
          (this._once = e),
          (this._thisArg = r),
          (this._next = this._prev = this._owner = null);
      }
      return (
        (t.prototype.detach = function () {
          return null !== this._owner && (this._owner.detach(this), !0);
        }),
        t
      );
    })();
  function Go(t, e) {
    return (
      t._head
        ? ((t._tail._next = e), (e._prev = t._tail), (t._tail = e))
        : ((t._head = e), (t._tail = e)),
      (e._owner = t),
      e
    );
  }
  var Xo = (function () {
    function t() {
      this._head = this._tail = void 0;
    }
    return (
      (t.prototype.handlers = function (t) {
        void 0 === t && (t = !1);
        var e = this._head;
        if (t) return !!e;
        for (var r = []; e; ) r.push(e), (e = e._next);
        return r;
      }),
      (t.prototype.has = function (t) {
        if (!(t instanceof Bo))
          throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");
        return t._owner === this;
      }),
      (t.prototype.dispatch = function () {
        for (var t = arguments, e = [], r = 0; r < arguments.length; r++) e[r] = t[r];
        var i = this._head;
        if (!i) return !1;
        for (; i; ) i._once && this.detach(i), i._fn.apply(i._thisArg, e), (i = i._next);
        return !0;
      }),
      (t.prototype.add = function (t, e) {
        if ((void 0 === e && (e = null), "function" != typeof t))
          throw new Error("MiniSignal#add(): First arg must be a Function.");
        return Go(this, new Bo(t, !1, e));
      }),
      (t.prototype.once = function (t, e) {
        if ((void 0 === e && (e = null), "function" != typeof t))
          throw new Error("MiniSignal#once(): First arg must be a Function.");
        return Go(this, new Bo(t, !0, e));
      }),
      (t.prototype.detach = function (t) {
        if (!(t instanceof Bo))
          throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");
        return t._owner !== this
          ? this
          : (t._prev && (t._prev._next = t._next),
            t._next && (t._next._prev = t._prev),
            t === this._head
              ? ((this._head = t._next), null === t._next && (this._tail = null))
              : t === this._tail && ((this._tail = t._prev), (this._tail._next = null)),
            (t._owner = null),
            this);
      }),
      (t.prototype.detachAll = function () {
        var t = this._head;
        if (!t) return this;
        for (this._head = this._tail = null; t; ) (t._owner = null), (t = t._next);
        return this;
      }),
      t
    );
  })();
  function ko(t, e) {
    e = e || {};
    for (
      var r = {
          key: [
            "source",
            "protocol",
            "authority",
            "userInfo",
            "user",
            "password",
            "host",
            "port",
            "relative",
            "path",
            "directory",
            "file",
            "query",
            "anchor",
          ],
          q: { name: "queryKey", parser: /(?:^|&)([^&=]*)=?([^&]*)/g },
          parser: {
            strict:
              /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
            loose:
              /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
          },
        },
        i = r.parser[e.strictMode ? "strict" : "loose"].exec(t),
        n = {},
        o = 14;
      o--;

    )
      n[r.key[o]] = i[o] || "";
    return (
      (n[r.q.name] = {}),
      n[r.key[12]].replace(r.q.parser, function (t, e, i) {
        e && (n[r.q.name][e] = i);
      }),
      n
    );
  }
  var Ho = !(!globalThis.XDomainRequest || "withCredentials" in new XMLHttpRequest()),
    Yo = null;
  function jo() {}
  function Vo(t, e, r) {
    e && 0 === e.indexOf(".") && (e = e.substring(1)), e && (t[e] = r);
  }
  function Wo(t) {
    return t.toString().replace("object ", "");
  }
  function zo() {}
  function qo(t) {
    return function () {
      for (var e = arguments, r = [], i = 0; i < arguments.length; i++) r[i] = e[i];
      if (null === t) throw new Error("Callback was already called.");
      var n = t;
      (t = null), n.apply(this, r);
    };
  }
  (t.LoaderResource = (function () {
    function t(e, r, i) {
      if (
        ((this._dequeue = jo),
        (this._onLoadBinding = null),
        (this._elementTimer = 0),
        (this._boundComplete = null),
        (this._boundOnError = null),
        (this._boundOnProgress = null),
        (this._boundOnTimeout = null),
        (this._boundXhrOnError = null),
        (this._boundXhrOnTimeout = null),
        (this._boundXhrOnAbort = null),
        (this._boundXhrOnLoad = null),
        "string" != typeof e || "string" != typeof r)
      )
        throw new Error("Both name and url are required for constructing a resource.");
      (i = i || {}),
        (this._flags = 0),
        this._setFlag(t.STATUS_FLAGS.DATA_URL, 0 === r.indexOf("data:")),
        (this.name = e),
        (this.url = r),
        (this.extension = this._getExtension()),
        (this.data = null),
        (this.crossOrigin = !0 === i.crossOrigin ? "anonymous" : i.crossOrigin),
        (this.timeout = i.timeout || 0),
        (this.loadType = i.loadType || this._determineLoadType()),
        (this.xhrType = i.xhrType),
        (this.metadata = i.metadata || {}),
        (this.error = null),
        (this.xhr = null),
        (this.children = []),
        (this.type = t.TYPE.UNKNOWN),
        (this.progressChunk = 0),
        (this._dequeue = jo),
        (this._onLoadBinding = null),
        (this._elementTimer = 0),
        (this._boundComplete = this.complete.bind(this)),
        (this._boundOnError = this._onError.bind(this)),
        (this._boundOnProgress = this._onProgress.bind(this)),
        (this._boundOnTimeout = this._onTimeout.bind(this)),
        (this._boundXhrOnError = this._xhrOnError.bind(this)),
        (this._boundXhrOnTimeout = this._xhrOnTimeout.bind(this)),
        (this._boundXhrOnAbort = this._xhrOnAbort.bind(this)),
        (this._boundXhrOnLoad = this._xhrOnLoad.bind(this)),
        (this.onStart = new Xo()),
        (this.onProgress = new Xo()),
        (this.onComplete = new Xo()),
        (this.onAfterMiddleware = new Xo());
    }
    return (
      (t.setExtensionLoadType = function (e, r) {
        Vo(t._loadTypeMap, e, r);
      }),
      (t.setExtensionXhrType = function (e, r) {
        Vo(t._xhrTypeMap, e, r);
      }),
      Object.defineProperty(t.prototype, "isDataUrl", {
        get: function () {
          return this._hasFlag(t.STATUS_FLAGS.DATA_URL);
        },
        enumerable: !1,
        configurable: !0,
      }),
      Object.defineProperty(t.prototype, "isComplete", {
        get: function () {
          return this._hasFlag(t.STATUS_FLAGS.COMPLETE);
        },
        enumerable: !1,
        configurable: !0,
      }),
      Object.defineProperty(t.prototype, "isLoading", {
        get: function () {
          return this._hasFlag(t.STATUS_FLAGS.LOADING);
        },
        enumerable: !1,
        configurable: !0,
      }),
      (t.prototype.complete = function () {
        this._clearEvents(), this._finish();
      }),
      (t.prototype.abort = function (e) {
        if (!this.error) {
          if (((this.error = new Error(e)), this._clearEvents(), this.xhr)) this.xhr.abort();
          else if (this.xdr) this.xdr.abort();
          else if (this.data)
            if (this.data.src) this.data.src = t.EMPTY_GIF;
            else for (; this.data.firstChild; ) this.data.removeChild(this.data.firstChild);
          this._finish();
        }
      }),
      (t.prototype.load = function (e) {
        var r = this;
        if (!this.isLoading)
          if (this.isComplete)
            e &&
              setTimeout(function () {
                return e(r);
              }, 1);
          else
            switch (
              (e && this.onComplete.once(e),
              this._setFlag(t.STATUS_FLAGS.LOADING, !0),
              this.onStart.dispatch(this),
              (!1 !== this.crossOrigin && "string" == typeof this.crossOrigin) ||
                (this.crossOrigin = this._determineCrossOrigin(this.url)),
              this.loadType)
            ) {
              case t.LOAD_TYPE.IMAGE:
                (this.type = t.TYPE.IMAGE), this._loadElement("image");
                break;
              case t.LOAD_TYPE.AUDIO:
                (this.type = t.TYPE.AUDIO), this._loadSourceElement("audio");
                break;
              case t.LOAD_TYPE.VIDEO:
                (this.type = t.TYPE.VIDEO), this._loadSourceElement("video");
                break;
              case t.LOAD_TYPE.XHR:
              default:
                Ho && this.crossOrigin ? this._loadXdr() : this._loadXhr();
            }
      }),
      (t.prototype._hasFlag = function (t) {
        return 0 != (this._flags & t);
      }),
      (t.prototype._setFlag = function (t, e) {
        this._flags = e ? this._flags | t : this._flags & ~t;
      }),
      (t.prototype._clearEvents = function () {
        clearTimeout(this._elementTimer),
          this.data &&
            this.data.removeEventListener &&
            (this.data.removeEventListener("error", this._boundOnError, !1),
            this.data.removeEventListener("load", this._boundComplete, !1),
            this.data.removeEventListener("progress", this._boundOnProgress, !1),
            this.data.removeEventListener("canplaythrough", this._boundComplete, !1)),
          this.xhr &&
            (this.xhr.removeEventListener
              ? (this.xhr.removeEventListener("error", this._boundXhrOnError, !1),
                this.xhr.removeEventListener("timeout", this._boundXhrOnTimeout, !1),
                this.xhr.removeEventListener("abort", this._boundXhrOnAbort, !1),
                this.xhr.removeEventListener("progress", this._boundOnProgress, !1),
                this.xhr.removeEventListener("load", this._boundXhrOnLoad, !1))
              : ((this.xhr.onerror = null),
                (this.xhr.ontimeout = null),
                (this.xhr.onprogress = null),
                (this.xhr.onload = null)));
      }),
      (t.prototype._finish = function () {
        if (this.isComplete)
          throw new Error("Complete called again for an already completed resource.");
        this._setFlag(t.STATUS_FLAGS.COMPLETE, !0),
          this._setFlag(t.STATUS_FLAGS.LOADING, !1),
          this.onComplete.dispatch(this);
      }),
      (t.prototype._loadElement = function (t) {
        this.metadata.loadElement
          ? (this.data = this.metadata.loadElement)
          : "image" === t && void 0 !== globalThis.Image
          ? (this.data = new Image())
          : (this.data = document.createElement(t)),
          this.crossOrigin && (this.data.crossOrigin = this.crossOrigin),
          this.metadata.skipSource || (this.data.src = this.url),
          this.data.addEventListener("error", this._boundOnError, !1),
          this.data.addEventListener("load", this._boundComplete, !1),
          this.data.addEventListener("progress", this._boundOnProgress, !1),
          this.timeout && (this._elementTimer = setTimeout(this._boundOnTimeout, this.timeout));
      }),
      (t.prototype._loadSourceElement = function (t) {
        if (
          (this.metadata.loadElement
            ? (this.data = this.metadata.loadElement)
            : "audio" === t && void 0 !== globalThis.Audio
            ? (this.data = new Audio())
            : (this.data = document.createElement(t)),
          null !== this.data)
        ) {
          if (
            (this.crossOrigin && (this.data.crossOrigin = this.crossOrigin),
            !this.metadata.skipSource)
          )
            if (navigator.isCocoonJS)
              this.data.src = Array.isArray(this.url) ? this.url[0] : this.url;
            else if (Array.isArray(this.url))
              for (var e = this.metadata.mimeType, r = 0; r < this.url.length; ++r)
                this.data.appendChild(
                  this._createSource(t, this.url[r], Array.isArray(e) ? e[r] : e)
                );
            else
              (e = this.metadata.mimeType),
                this.data.appendChild(this._createSource(t, this.url, Array.isArray(e) ? e[0] : e));
          this.data.addEventListener("error", this._boundOnError, !1),
            this.data.addEventListener("load", this._boundComplete, !1),
            this.data.addEventListener("progress", this._boundOnProgress, !1),
            this.data.addEventListener("canplaythrough", this._boundComplete, !1),
            this.data.load(),
            this.timeout && (this._elementTimer = setTimeout(this._boundOnTimeout, this.timeout));
        } else this.abort("Unsupported element: " + t);
      }),
      (t.prototype._loadXhr = function () {
        "string" != typeof this.xhrType && (this.xhrType = this._determineXhrType());
        var e = (this.xhr = new XMLHttpRequest());
        "use-credentials" === this.crossOrigin && (e.withCredentials = !0),
          e.open("GET", this.url, !0),
          (e.timeout = this.timeout),
          this.xhrType === t.XHR_RESPONSE_TYPE.JSON || this.xhrType === t.XHR_RESPONSE_TYPE.DOCUMENT
            ? (e.responseType = t.XHR_RESPONSE_TYPE.TEXT)
            : (e.responseType = this.xhrType),
          e.addEventListener("error", this._boundXhrOnError, !1),
          e.addEventListener("timeout", this._boundXhrOnTimeout, !1),
          e.addEventListener("abort", this._boundXhrOnAbort, !1),
          e.addEventListener("progress", this._boundOnProgress, !1),
          e.addEventListener("load", this._boundXhrOnLoad, !1),
          e.send();
      }),
      (t.prototype._loadXdr = function () {
        "string" != typeof this.xhrType && (this.xhrType = this._determineXhrType());
        var t = (this.xhr = new globalThis.XDomainRequest());
        (t.timeout = this.timeout || 5e3),
          (t.onerror = this._boundXhrOnError),
          (t.ontimeout = this._boundXhrOnTimeout),
          (t.onprogress = this._boundOnProgress),
          (t.onload = this._boundXhrOnLoad),
          t.open("GET", this.url, !0),
          setTimeout(function () {
            return t.send();
          }, 1);
      }),
      (t.prototype._createSource = function (t, e, r) {
        r || (r = t + "/" + this._getExtension(e));
        var i = document.createElement("source");
        return (i.src = e), (i.type = r), i;
      }),
      (t.prototype._onError = function (t) {
        this.abort("Failed to load element using: " + t.target.nodeName);
      }),
      (t.prototype._onProgress = function (t) {
        t && t.lengthComputable && this.onProgress.dispatch(this, t.loaded / t.total);
      }),
      (t.prototype._onTimeout = function () {
        this.abort("Load timed out.");
      }),
      (t.prototype._xhrOnError = function () {
        var t = this.xhr;
        this.abort(
          Wo(t) + " Request failed. Status: " + t.status + ', text: "' + t.statusText + '"'
        );
      }),
      (t.prototype._xhrOnTimeout = function () {
        var t = this.xhr;
        this.abort(Wo(t) + " Request timed out.");
      }),
      (t.prototype._xhrOnAbort = function () {
        var t = this.xhr;
        this.abort(Wo(t) + " Request was aborted by the user.");
      }),
      (t.prototype._xhrOnLoad = function () {
        var e = this.xhr,
          r = "",
          i = void 0 === e.status ? 200 : e.status;
        if (
          (("" !== e.responseType && "text" !== e.responseType && void 0 !== e.responseType) ||
            (r = e.responseText),
          0 === i && (r.length > 0 || e.responseType === t.XHR_RESPONSE_TYPE.BUFFER)
            ? (i = 200)
            : 1223 === i && (i = 204),
          2 == ((i / 100) | 0))
        ) {
          if (this.xhrType === t.XHR_RESPONSE_TYPE.TEXT) (this.data = r), (this.type = t.TYPE.TEXT);
          else if (this.xhrType === t.XHR_RESPONSE_TYPE.JSON)
            try {
              (this.data = JSON.parse(r)), (this.type = t.TYPE.JSON);
            } catch (t) {
              return void this.abort("Error trying to parse loaded json: " + t);
            }
          else if (this.xhrType === t.XHR_RESPONSE_TYPE.DOCUMENT)
            try {
              if (globalThis.DOMParser) {
                var n = new DOMParser();
                this.data = n.parseFromString(r, "text/xml");
              } else {
                var o = document.createElement("div");
                (o.innerHTML = r), (this.data = o);
              }
              this.type = t.TYPE.XML;
            } catch (t) {
              return void this.abort("Error trying to parse loaded xml: " + t);
            }
          else this.data = e.response || r;
          this.complete();
        } else this.abort("[" + e.status + "] " + e.statusText + ": " + e.responseURL);
      }),
      (t.prototype._determineCrossOrigin = function (t, e) {
        if (0 === t.indexOf("data:")) return "";
        if (globalThis.origin !== globalThis.location.origin) return "anonymous";
        (e = e || globalThis.location), Yo || (Yo = document.createElement("a")), (Yo.href = t);
        var r = ko(Yo.href, { strictMode: !0 }),
          i = (!r.port && "" === e.port) || r.port === e.port,
          n = r.protocol ? r.protocol + ":" : "";
        return r.host === e.hostname && i && n === e.protocol ? "" : "anonymous";
      }),
      (t.prototype._determineXhrType = function () {
        return t._xhrTypeMap[this.extension] || t.XHR_RESPONSE_TYPE.TEXT;
      }),
      (t.prototype._determineLoadType = function () {
        return t._loadTypeMap[this.extension] || t.LOAD_TYPE.XHR;
      }),
      (t.prototype._getExtension = function (t) {
        void 0 === t && (t = this.url);
        var e = "";
        if (this.isDataUrl) {
          var r = t.indexOf("/");
          e = t.substring(r + 1, t.indexOf(";", r));
        } else {
          var i = t.indexOf("?"),
            n = t.indexOf("#"),
            o = Math.min(i > -1 ? i : t.length, n > -1 ? n : t.length);
          e = (t = t.substring(0, o)).substring(t.lastIndexOf(".") + 1);
        }
        return e.toLowerCase();
      }),
      (t.prototype._getMimeFromXhrType = function (e) {
        switch (e) {
          case t.XHR_RESPONSE_TYPE.BUFFER:
            return "application/octet-binary";
          case t.XHR_RESPONSE_TYPE.BLOB:
            return "application/blob";
          case t.XHR_RESPONSE_TYPE.DOCUMENT:
            return "application/xml";
          case t.XHR_RESPONSE_TYPE.JSON:
            return "application/json";
          case t.XHR_RESPONSE_TYPE.DEFAULT:
          case t.XHR_RESPONSE_TYPE.TEXT:
          default:
            return "text/plain";
        }
      }),
      t
    );
  })()),
    (function (t) {
      !(function (t) {
        (t[(t.NONE = 0)] = "NONE"),
          (t[(t.DATA_URL = 1)] = "DATA_URL"),
          (t[(t.COMPLETE = 2)] = "COMPLETE"),
          (t[(t.LOADING = 4)] = "LOADING");
      })(t.STATUS_FLAGS || (t.STATUS_FLAGS = {})),
        (function (t) {
          (t[(t.UNKNOWN = 0)] = "UNKNOWN"),
            (t[(t.JSON = 1)] = "JSON"),
            (t[(t.XML = 2)] = "XML"),
            (t[(t.IMAGE = 3)] = "IMAGE"),
            (t[(t.AUDIO = 4)] = "AUDIO"),
            (t[(t.VIDEO = 5)] = "VIDEO"),
            (t[(t.TEXT = 6)] = "TEXT");
        })(t.TYPE || (t.TYPE = {})),
        (function (t) {
          (t[(t.XHR = 1)] = "XHR"),
            (t[(t.IMAGE = 2)] = "IMAGE"),
            (t[(t.AUDIO = 3)] = "AUDIO"),
            (t[(t.VIDEO = 4)] = "VIDEO");
        })(t.LOAD_TYPE || (t.LOAD_TYPE = {})),
        (function (t) {
          (t.DEFAULT = "text"),
            (t.BUFFER = "arraybuffer"),
            (t.BLOB = "blob"),
            (t.DOCUMENT = "document"),
            (t.JSON = "json"),
            (t.TEXT = "text");
        })(t.XHR_RESPONSE_TYPE || (t.XHR_RESPONSE_TYPE = {})),
        (t._loadTypeMap = {
          gif: t.LOAD_TYPE.IMAGE,
          png: t.LOAD_TYPE.IMAGE,
          bmp: t.LOAD_TYPE.IMAGE,
          jpg: t.LOAD_TYPE.IMAGE,
          jpeg: t.LOAD_TYPE.IMAGE,
          tif: t.LOAD_TYPE.IMAGE,
          tiff: t.LOAD_TYPE.IMAGE,
          webp: t.LOAD_TYPE.IMAGE,
          tga: t.LOAD_TYPE.IMAGE,
          svg: t.LOAD_TYPE.IMAGE,
          "svg+xml": t.LOAD_TYPE.IMAGE,
          mp3: t.LOAD_TYPE.AUDIO,
          ogg: t.LOAD_TYPE.AUDIO,
          wav: t.LOAD_TYPE.AUDIO,
          mp4: t.LOAD_TYPE.VIDEO,
          webm: t.LOAD_TYPE.VIDEO,
        }),
        (t._xhrTypeMap = {
          xhtml: t.XHR_RESPONSE_TYPE.DOCUMENT,
          html: t.XHR_RESPONSE_TYPE.DOCUMENT,
          htm: t.XHR_RESPONSE_TYPE.DOCUMENT,
          xml: t.XHR_RESPONSE_TYPE.DOCUMENT,
          tmx: t.XHR_RESPONSE_TYPE.DOCUMENT,
          svg: t.XHR_RESPONSE_TYPE.DOCUMENT,
          tsx: t.XHR_RESPONSE_TYPE.DOCUMENT,
          gif: t.XHR_RESPONSE_TYPE.BLOB,
          png: t.XHR_RESPONSE_TYPE.BLOB,
          bmp: t.XHR_RESPONSE_TYPE.BLOB,
          jpg: t.XHR_RESPONSE_TYPE.BLOB,
          jpeg: t.XHR_RESPONSE_TYPE.BLOB,
          tif: t.XHR_RESPONSE_TYPE.BLOB,
          tiff: t.XHR_RESPONSE_TYPE.BLOB,
          webp: t.XHR_RESPONSE_TYPE.BLOB,
          tga: t.XHR_RESPONSE_TYPE.BLOB,
          json: t.XHR_RESPONSE_TYPE.JSON,
          text: t.XHR_RESPONSE_TYPE.TEXT,
          txt: t.XHR_RESPONSE_TYPE.TEXT,
          ttf: t.XHR_RESPONSE_TYPE.BUFFER,
          otf: t.XHR_RESPONSE_TYPE.BUFFER,
        }),
        (t.EMPTY_GIF =
          "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==");
    })(t.LoaderResource || (t.LoaderResource = {}));
  var Ko = function (t, e) {
      (this.data = t), (this.callback = e);
    },
    Zo = (function () {
      function t(t, e) {
        var r = this;
        if (
          (void 0 === e && (e = 1),
          (this.workers = 0),
          (this.saturated = zo),
          (this.unsaturated = zo),
          (this.empty = zo),
          (this.drain = zo),
          (this.error = zo),
          (this.started = !1),
          (this.paused = !1),
          (this._tasks = []),
          (this._insert = function (t, e, i) {
            if (i && "function" != typeof i) throw new Error("task callback must be a function");
            if (((r.started = !0), null == t && r.idle()))
              setTimeout(function () {
                return r.drain();
              }, 1);
            else {
              var n = new Ko(t, "function" == typeof i ? i : zo);
              e ? r._tasks.unshift(n) : r._tasks.push(n), setTimeout(r.process, 1);
            }
          }),
          (this.process = function () {
            for (; !r.paused && r.workers < r.concurrency && r._tasks.length; ) {
              var t = r._tasks.shift();
              0 === r._tasks.length && r.empty(),
                (r.workers += 1),
                r.workers === r.concurrency && r.saturated(),
                r._worker(t.data, qo(r._next(t)));
            }
          }),
          (this._worker = t),
          0 === e)
        )
          throw new Error("Concurrency must not be zero");
        (this.concurrency = e), (this.buffer = e / 4);
      }
      return (
        (t.prototype._next = function (t) {
          var e = this;
          return function () {
            for (var r = arguments, i = [], n = 0; n < arguments.length; n++) i[n] = r[n];
            (e.workers -= 1),
              t.callback.apply(t, i),
              null != i[0] && e.error(i[0], t.data),
              e.workers <= e.concurrency - e.buffer && e.unsaturated(),
              e.idle() && e.drain(),
              e.process();
          };
        }),
        (t.prototype.push = function (t, e) {
          this._insert(t, !1, e);
        }),
        (t.prototype.kill = function () {
          (this.workers = 0), (this.drain = zo), (this.started = !1), (this._tasks = []);
        }),
        (t.prototype.unshift = function (t, e) {
          this._insert(t, !0, e);
        }),
        (t.prototype.length = function () {
          return this._tasks.length;
        }),
        (t.prototype.running = function () {
          return this.workers;
        }),
        (t.prototype.idle = function () {
          return this._tasks.length + this.workers === 0;
        }),
        (t.prototype.pause = function () {
          !0 !== this.paused && (this.paused = !0);
        }),
        (t.prototype.resume = function () {
          if (!1 !== this.paused) {
            this.paused = !1;
            for (var t = 1; t <= this.concurrency; t++) this.process();
          }
        }),
        (t.eachSeries = function (t, e, r, i) {
          var n = 0,
            o = t.length;
          !(function s(a) {
            a || n === o
              ? r && r(a)
              : i
              ? setTimeout(function () {
                  e(t[n++], s);
                }, 1)
              : e(t[n++], s);
          })();
        }),
        (t.queue = function (e, r) {
          return new t(e, r);
        }),
        t
      );
    })(),
    Qo = /(#[\w-]+)?$/,
    Jo = (function () {
      function e(t, r) {
        var i = this;
        void 0 === t && (t = ""),
          void 0 === r && (r = 10),
          (this.progress = 0),
          (this.loading = !1),
          (this.defaultQueryString = ""),
          (this._beforeMiddleware = []),
          (this._afterMiddleware = []),
          (this._resourcesParsing = []),
          (this._boundLoadResource = function (t, e) {
            return i._loadResource(t, e);
          }),
          (this.resources = {}),
          (this.baseUrl = t),
          (this._beforeMiddleware = []),
          (this._afterMiddleware = []),
          (this._resourcesParsing = []),
          (this._boundLoadResource = function (t, e) {
            return i._loadResource(t, e);
          }),
          (this._queue = Zo.queue(this._boundLoadResource, r)),
          this._queue.pause(),
          (this.resources = {}),
          (this.onProgress = new Xo()),
          (this.onError = new Xo()),
          (this.onLoad = new Xo()),
          (this.onStart = new Xo()),
          (this.onComplete = new Xo());
        for (var n = 0; n < e._plugins.length; ++n) {
          var o = e._plugins[n],
            s = o.pre,
            a = o.use;
          s && this.pre(s), a && this.use(a);
        }
        this._protected = !1;
      }
      return (
        (e.prototype._add = function (e, r, i, n) {
          if (this.loading && (!i || !i.parentResource))
            throw new Error("Cannot add resources while the loader is running.");
          if (this.resources[e]) throw new Error('Resource named "' + e + '" already exists.');
          if (
            ((r = this._prepareUrl(r)),
            (this.resources[e] = new t.LoaderResource(e, r, i)),
            "function" == typeof n && this.resources[e].onAfterMiddleware.once(n),
            this.loading)
          ) {
            for (var o = i.parentResource, s = [], a = 0; a < o.children.length; ++a)
              o.children[a].isComplete || s.push(o.children[a]);
            var h = (o.progressChunk * (s.length + 1)) / (s.length + 2);
            for (o.children.push(this.resources[e]), o.progressChunk = h, a = 0; a < s.length; ++a)
              s[a].progressChunk = h;
            this.resources[e].progressChunk = h;
          }
          return this._queue.push(this.resources[e]), this;
        }),
        (e.prototype.pre = function (t) {
          return this._beforeMiddleware.push(t), this;
        }),
        (e.prototype.use = function (t) {
          return this._afterMiddleware.push(t), this;
        }),
        (e.prototype.reset = function () {
          for (var t in ((this.progress = 0),
          (this.loading = !1),
          this._queue.kill(),
          this._queue.pause(),
          this.resources)) {
            var e = this.resources[t];
            e._onLoadBinding && e._onLoadBinding.detach(), e.isLoading && e.abort("loader reset");
          }
          return (this.resources = {}), this;
        }),
        (e.prototype.load = function (t) {
          if (("function" == typeof t && this.onComplete.once(t), this.loading)) return this;
          if (this._queue.idle()) this._onStart(), this._onComplete();
          else {
            for (var e = 100 / this._queue._tasks.length, r = 0; r < this._queue._tasks.length; ++r)
              this._queue._tasks[r].data.progressChunk = e;
            this._onStart(), this._queue.resume();
          }
          return this;
        }),
        Object.defineProperty(e.prototype, "concurrency", {
          get: function () {
            return this._queue.concurrency;
          },
          set: function (t) {
            this._queue.concurrency = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype._prepareUrl = function (t) {
          var e,
            r = ko(t, { strictMode: !0 });
          if (
            ((e =
              r.protocol || !r.path || 0 === t.indexOf("//")
                ? t
                : this.baseUrl.length &&
                  this.baseUrl.lastIndexOf("/") !== this.baseUrl.length - 1 &&
                  "/" !== t.charAt(0)
                ? this.baseUrl + "/" + t
                : this.baseUrl + t),
            this.defaultQueryString)
          ) {
            var i = Qo.exec(e)[0];
            -1 !== (e = e.slice(0, e.length - i.length)).indexOf("?")
              ? (e += "&" + this.defaultQueryString)
              : (e += "?" + this.defaultQueryString),
              (e += i);
          }
          return e;
        }),
        (e.prototype._loadResource = function (t, e) {
          var r = this;
          (t._dequeue = e),
            Zo.eachSeries(
              this._beforeMiddleware,
              function (e, i) {
                e.call(r, t, function () {
                  i(t.isComplete ? {} : null);
                });
              },
              function () {
                t.isComplete
                  ? r._onLoad(t)
                  : ((t._onLoadBinding = t.onComplete.once(r._onLoad, r)), t.load());
              },
              !0
            );
        }),
        (e.prototype._onStart = function () {
          (this.progress = 0), (this.loading = !0), this.onStart.dispatch(this);
        }),
        (e.prototype._onComplete = function () {
          (this.progress = 100),
            (this.loading = !1),
            this.onComplete.dispatch(this, this.resources);
        }),
        (e.prototype._onLoad = function (t) {
          var e = this;
          (t._onLoadBinding = null),
            this._resourcesParsing.push(t),
            t._dequeue(),
            Zo.eachSeries(
              this._afterMiddleware,
              function (r, i) {
                r.call(e, t, i);
              },
              function () {
                t.onAfterMiddleware.dispatch(t),
                  (e.progress = Math.min(100, e.progress + t.progressChunk)),
                  e.onProgress.dispatch(e, t),
                  t.error ? e.onError.dispatch(t.error, e, t) : e.onLoad.dispatch(e, t),
                  e._resourcesParsing.splice(e._resourcesParsing.indexOf(t), 1),
                  e._queue.idle() && 0 === e._resourcesParsing.length && e._onComplete();
              },
              !0
            );
        }),
        (e.prototype.destroy = function () {
          this._protected || this.reset();
        }),
        Object.defineProperty(e, "shared", {
          get: function () {
            var t = e._shared;
            return t || (((t = new e())._protected = !0), (e._shared = t)), t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.registerPlugin = function (t) {
          return e._plugins.push(t), t.add && t.add(), e;
        }),
        (e._plugins = []),
        e
      );
    })();
  Jo.prototype.add = function (t, e, r, i) {
    if (Array.isArray(t)) {
      for (var n = 0; n < t.length; ++n) this.add(t[n]);
      return this;
    }
    if (
      ("object" == typeof t &&
        ((r = t),
        (i = e || r.callback || r.onComplete),
        (e = r.url),
        (t = r.name || r.key || r.url)),
      "string" != typeof e && ((i = r), (r = e), (e = t)),
      "string" != typeof e)
    )
      throw new Error("No url passed to add resource to loader.");
    return "function" == typeof r && ((i = r), (r = null)), this._add(t, e, r, i);
  };
  var $o,
    ts = (function () {
      function t() {}
      return (
        (t.init = function (t) {
          (t = Object.assign({ sharedLoader: !1 }, t)),
            (this.loader = t.sharedLoader ? Jo.shared : new Jo());
        }),
        (t.destroy = function () {
          this.loader && (this.loader.destroy(), (this.loader = null));
        }),
        t
      );
    })(),
    es = (function () {
      function e() {}
      return (
        (e.add = function () {
          t.LoaderResource.setExtensionLoadType("svg", t.LoaderResource.LOAD_TYPE.XHR),
            t.LoaderResource.setExtensionXhrType("svg", t.LoaderResource.XHR_RESPONSE_TYPE.TEXT);
        }),
        (e.use = function (e, r) {
          if (!e.data || (e.type !== t.LoaderResource.TYPE.IMAGE && "svg" !== e.extension)) r();
          else {
            var i = e.data,
              n = e.url,
              o = e.name,
              s = e.metadata;
            Ri.fromLoader(i, n, o, s)
              .then(function (t) {
                (e.texture = t), r();
              })
              .catch(r);
          }
        }),
        e
      );
    })(),
    rs = self.URL || self.webkitURL;
  Jo.registerPlugin({
    use: function (e, r) {
      if (e.data) {
        if (e.xhr && e.xhrType === t.LoaderResource.XHR_RESPONSE_TYPE.BLOB)
          if (self.Blob && "string" != typeof e.data) {
            if (0 === e.data.type.indexOf("image")) {
              var i = rs.createObjectURL(e.data);
              return (
                (e.blob = e.data),
                (e.data = new Image()),
                (e.data.src = i),
                (e.type = t.LoaderResource.TYPE.IMAGE),
                void (e.data.onload = function () {
                  rs.revokeObjectURL(i), (e.data.onload = null), r();
                })
              );
            }
          } else {
            var n = e.xhr.getResponseHeader("content-type");
            if (n && 0 === n.indexOf("image"))
              return (
                (e.data = new Image()),
                (e.data.src =
                  "data:" +
                  n +
                  ";base64," +
                  (function (t) {
                    for (var e = "", r = 0; r < t.length; ) {
                      for (var i = [0, 0, 0], n = [0, 0, 0, 0], o = 0; o < i.length; ++o)
                        r < t.length ? (i[o] = 255 & t.charCodeAt(r++)) : (i[o] = 0);
                      switch (
                        ((n[0] = i[0] >> 2),
                        (n[1] = ((3 & i[0]) << 4) | (i[1] >> 4)),
                        (n[2] = ((15 & i[1]) << 2) | (i[2] >> 6)),
                        (n[3] = 63 & i[2]),
                        r - (t.length - 1))
                      ) {
                        case 2:
                          (n[3] = 64), (n[2] = 64);
                          break;
                        case 1:
                          n[3] = 64;
                      }
                      for (o = 0; o < n.length; ++o)
                        e +=
                          "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(
                            n[o]
                          );
                    }
                    return e;
                  })(e.xhr.responseText)),
                (e.type = t.LoaderResource.TYPE.IMAGE),
                void (e.data.onload = function () {
                  (e.data.onload = null), r();
                })
              );
          }
        r();
      } else r();
    },
  }),
    Jo.registerPlugin(es),
    (function (t) {
      (t[(t.COMPRESSED_RGB_S3TC_DXT1_EXT = 33776)] = "COMPRESSED_RGB_S3TC_DXT1_EXT"),
        (t[(t.COMPRESSED_RGBA_S3TC_DXT1_EXT = 33777)] = "COMPRESSED_RGBA_S3TC_DXT1_EXT"),
        (t[(t.COMPRESSED_RGBA_S3TC_DXT3_EXT = 33778)] = "COMPRESSED_RGBA_S3TC_DXT3_EXT"),
        (t[(t.COMPRESSED_RGBA_S3TC_DXT5_EXT = 33779)] = "COMPRESSED_RGBA_S3TC_DXT5_EXT"),
        (t[(t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = 35917)] =
          "COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT"),
        (t[(t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT = 35918)] =
          "COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT"),
        (t[(t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT = 35919)] =
          "COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT"),
        (t[(t.COMPRESSED_SRGB_S3TC_DXT1_EXT = 35916)] = "COMPRESSED_SRGB_S3TC_DXT1_EXT"),
        (t[(t.COMPRESSED_R11_EAC = 37488)] = "COMPRESSED_R11_EAC"),
        (t[(t.COMPRESSED_SIGNED_R11_EAC = 37489)] = "COMPRESSED_SIGNED_R11_EAC"),
        (t[(t.COMPRESSED_RG11_EAC = 37490)] = "COMPRESSED_RG11_EAC"),
        (t[(t.COMPRESSED_SIGNED_RG11_EAC = 37491)] = "COMPRESSED_SIGNED_RG11_EAC"),
        (t[(t.COMPRESSED_RGB8_ETC2 = 37492)] = "COMPRESSED_RGB8_ETC2"),
        (t[(t.COMPRESSED_RGBA8_ETC2_EAC = 37496)] = "COMPRESSED_RGBA8_ETC2_EAC"),
        (t[(t.COMPRESSED_SRGB8_ETC2 = 37493)] = "COMPRESSED_SRGB8_ETC2"),
        (t[(t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC = 37497)] = "COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"),
        (t[(t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2 = 37494)] =
          "COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2"),
        (t[(t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2 = 37495)] =
          "COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2"),
        (t[(t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 35840)] = "COMPRESSED_RGB_PVRTC_4BPPV1_IMG"),
        (t[(t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 35842)] = "COMPRESSED_RGBA_PVRTC_4BPPV1_IMG"),
        (t[(t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 35841)] = "COMPRESSED_RGB_PVRTC_2BPPV1_IMG"),
        (t[(t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 35843)] = "COMPRESSED_RGBA_PVRTC_2BPPV1_IMG"),
        (t[(t.COMPRESSED_RGB_ETC1_WEBGL = 36196)] = "COMPRESSED_RGB_ETC1_WEBGL"),
        (t[(t.COMPRESSED_RGB_ATC_WEBGL = 35986)] = "COMPRESSED_RGB_ATC_WEBGL"),
        (t[(t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL = 35986)] =
          "COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL"),
        (t[(t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL = 34798)] =
          "COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL");
    })(t.INTERNAL_FORMATS || (t.INTERNAL_FORMATS = {}));
  var is =
      ((($o = {})[t.INTERNAL_FORMATS.COMPRESSED_RGB_S3TC_DXT1_EXT] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB_S3TC_DXT1_EXT] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_R11_EAC] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SIGNED_R11_EAC] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RG11_EAC] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SIGNED_RG11_EAC] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGB8_ETC2] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA8_ETC2_EAC] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB8_ETC2] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG] = 0.25),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG] = 0.25),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGB_ETC1_WEBGL] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGB_ATC_WEBGL] = 0.5),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL] = 1),
      ($o[t.INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL] = 1),
      $o),
    ns = function (t, e) {
      return (ns =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function os(t, e) {
    function r() {
      this.constructor = t;
    }
    ns(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var ss,
    as,
    hs = (function (t) {
      function e(e, r) {
        void 0 === r && (r = { width: 1, height: 1, autoLoad: !0 });
        var i,
          n,
          o = this;
        return (
          "string" == typeof e ? ((i = e), (n = new Uint8Array())) : ((i = null), (n = e)),
          ((o = t.call(this, n, r) || this).origin = i),
          (o.buffer = n ? new go(n) : null),
          o.origin && !1 !== r.autoLoad && o.load(),
          n && n.length && ((o.loaded = !0), o.onBlobLoaded(o.buffer.rawBinaryData)),
          o
        );
      }
      return (
        os(e, t),
        (e.prototype.onBlobLoaded = function (t) {}),
        (e.prototype.load = function () {
          return (
            (t = this),
            void 0,
            (e = Promise),
            (r = function () {
              var t;
              return (function (t, e) {
                var r,
                  i,
                  n,
                  o,
                  s = {
                    label: 0,
                    sent: function () {
                      if (1 & n[0]) throw n[1];
                      return n[1];
                    },
                    trys: [],
                    ops: [],
                  };
                return (
                  (o = { next: a(0), throw: a(1), return: a(2) }),
                  "function" == typeof Symbol &&
                    (o[Symbol.iterator] = function () {
                      return this;
                    }),
                  o
                );
                function a(o) {
                  return function (a) {
                    return (function (o) {
                      if (r) throw new TypeError("Generator is already executing.");
                      for (; s; )
                        try {
                          if (
                            ((r = 1),
                            i &&
                              (n =
                                2 & o[0]
                                  ? i.return
                                  : o[0]
                                  ? i.throw || ((n = i.return) && n.call(i), 0)
                                  : i.next) &&
                              !(n = n.call(i, o[1])).done)
                          )
                            return n;
                          switch (((i = 0), n && (o = [2 & o[0], n.value]), o[0])) {
                            case 0:
                            case 1:
                              n = o;
                              break;
                            case 4:
                              return s.label++, { value: o[1], done: !1 };
                            case 5:
                              s.label++, (i = o[1]), (o = [0]);
                              continue;
                            case 7:
                              (o = s.ops.pop()), s.trys.pop();
                              continue;
                            default:
                              if (
                                !(n = (n = s.trys).length > 0 && n[n.length - 1]) &&
                                (6 === o[0] || 2 === o[0])
                              ) {
                                s = 0;
                                continue;
                              }
                              if (3 === o[0] && (!n || (o[1] > n[0] && o[1] < n[3]))) {
                                s.label = o[1];
                                break;
                              }
                              if (6 === o[0] && s.label < n[1]) {
                                (s.label = n[1]), (n = o);
                                break;
                              }
                              if (n && s.label < n[2]) {
                                (s.label = n[2]), s.ops.push(o);
                                break;
                              }
                              n[2] && s.ops.pop(), s.trys.pop();
                              continue;
                          }
                          o = e.call(t, s);
                        } catch (t) {
                          (o = [6, t]), (i = 0);
                        } finally {
                          r = n = 0;
                        }
                      if (5 & o[0]) throw o[1];
                      return { value: o[0] ? o[1] : void 0, done: !0 };
                    })([o, a]);
                  };
                }
              })(this, function (e) {
                switch (e.label) {
                  case 0:
                    return [4, fetch(this.origin)];
                  case 1:
                    return [4, e.sent().blob()];
                  case 2:
                    return [4, e.sent().arrayBuffer()];
                  case 3:
                    return (
                      (t = e.sent()),
                      (this.data = new Uint32Array(t)),
                      (this.buffer = new go(t)),
                      (this.loaded = !0),
                      this.onBlobLoaded(t),
                      this.update(),
                      [2, this]
                    );
                }
              });
            }),
            new (e || (e = Promise))(function (i, n) {
              function o(t) {
                try {
                  a(r.next(t));
                } catch (t) {
                  n(t);
                }
              }
              function s(t) {
                try {
                  a(r.throw(t));
                } catch (t) {
                  n(t);
                }
              }
              function a(t) {
                t.done
                  ? i(t.value)
                  : new e(function (e) {
                      e(t.value);
                    }).then(o, s);
              }
              a((r = r.apply(t, [])).next());
            })
          );
          var t, e, r;
        }),
        e
      );
    })(ni),
    us = (function (t) {
      function e(r, i) {
        var n = t.call(this, r, i) || this;
        return (
          (n.format = i.format),
          (n.levels = i.levels || 1),
          (n._width = i.width),
          (n._height = i.height),
          (n._extension = e._formatToExtension(n.format)),
          (i.levelBuffers || n.buffer) &&
            (n._levelBuffers =
              i.levelBuffers ||
              e._createLevelBuffers(
                r instanceof Uint8Array ? r : n.buffer.uint8View,
                n.format,
                n.levels,
                4,
                4,
                n.width,
                n.height
              )),
          n
        );
      }
      return (
        os(e, t),
        (e.prototype.upload = function (t, e, r) {
          var i = t.gl;
          if (!t.context.extensions[this._extension])
            throw new Error(this._extension + " textures are not supported on the current machine");
          if (!this._levelBuffers) return !1;
          for (var n = 0, o = this.levels; n < o; n++) {
            var s = this._levelBuffers[n],
              a = s.levelID,
              h = s.levelWidth,
              u = s.levelHeight,
              l = s.levelBuffer;
            i.compressedTexImage2D(i.TEXTURE_2D, a, this.format, h, u, 0, l);
          }
          return !0;
        }),
        (e.prototype.onBlobLoaded = function () {
          this._levelBuffers = e._createLevelBuffers(
            this.buffer.uint8View,
            this.format,
            this.levels,
            4,
            4,
            this.width,
            this.height
          );
        }),
        (e._formatToExtension = function (t) {
          if (t >= 33776 && t <= 33779) return "s3tc";
          if (t >= 37488 && t <= 37497) return "etc";
          if (t >= 35840 && t <= 35843) return "pvrtc";
          if (t >= 36196) return "etc1";
          if (t >= 35986 && t <= 34798) return "atc";
          throw new Error("Invalid (compressed) texture format given!");
        }),
        (e._createLevelBuffers = function (t, e, r, i, n, o, s) {
          for (
            var a = new Array(r),
              h = t.byteOffset,
              u = o,
              l = s,
              c = (u + i - 1) & ~(i - 1),
              d = (l + n - 1) & ~(n - 1),
              f = c * d * is[e],
              p = 0;
            p < r;
            p++
          )
            (a[p] = {
              levelID: p,
              levelWidth: r > 1 ? u : c,
              levelHeight: r > 1 ? l : d,
              levelBuffer: new Uint8Array(t.buffer, h, f),
            }),
              (h += f),
              (f =
                (c = ((u = u >> 1 || 1) + i - 1) & ~(i - 1)) *
                (d = ((l = l >> 1 || 1) + n - 1) & ~(n - 1)) *
                is[e]);
          return a;
        }),
        e
      );
    })(hs),
    ls = (function () {
      function e() {}
      return (
        (e.use = function (r, i) {
          var n = r.data;
          if (r.type === t.LoaderResource.TYPE.JSON && n && n.cacheID && n.textures) {
            for (var o = n.textures, s = void 0, a = void 0, h = 0, u = o.length; h < u; h++) {
              var l = o[h],
                c = l.src,
                d = l.format;
              if ((d || (a = c), e.textureFormats[d])) {
                s = c;
                break;
              }
            }
            if (!(s = s || a))
              return void i(
                new Error(
                  "Cannot load compressed-textures in " +
                    r.url +
                    ", make sure you provide a fallback"
                )
              );
            if (s === r.url)
              return void i(
                new Error("URL of compressed texture cannot be the same as the manifest's URL")
              );
            var f = {
                crossOrigin: r.crossOrigin,
                metadata: r.metadata.imageMetadata,
                parentResource: r,
              },
              p = ne.resolve(r.url.replace(this.baseUrl, ""), s),
              _ = n.cacheID;
            this.add(_, p, f, function (t) {
              if (t.error) i(t.error);
              else {
                var e = t.texture,
                  n = void 0 === e ? null : e,
                  o = t.textures,
                  s = void 0 === o ? {} : o;
                Object.assign(r, { texture: n, textures: s }), i();
              }
            });
          } else i();
        }),
        (e.add = function () {
          var t = document.createElement("canvas").getContext("webgl");
          if (t) {
            var r = {
              s3tc: t.getExtension("WEBGL_compressed_texture_s3tc"),
              s3tc_sRGB: t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),
              etc: t.getExtension("WEBGL_compressed_texture_etc"),
              etc1: t.getExtension("WEBGL_compressed_texture_etc1"),
              pvrtc:
                t.getExtension("WEBGL_compressed_texture_pvrtc") ||
                t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),
              atc: t.getExtension("WEBGL_compressed_texture_atc"),
              astc: t.getExtension("WEBGL_compressed_texture_astc"),
            };
            for (var i in ((e.textureExtensions = r), (e.textureFormats = {}), r)) {
              var n = r[i];
              n && Object.assign(e.textureFormats, Object.getPrototypeOf(n));
            }
          }
        }),
        e
      );
    })();
  function cs(e, r, i) {
    var n = { textures: {}, texture: null };
    return r
      ? (r
          .map(function (e) {
            return new Ri(
              new si(
                e,
                Object.assign(
                  { mipmap: t.MIPMAP_MODES.OFF, alphaMode: t.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA },
                  i
                )
              )
            );
          })
          .forEach(function (t, r) {
            var i = t.baseTexture,
              o = e + "-" + (r + 1);
            si.addToCache(i, o),
              Ri.addToCache(t, o),
              0 === r && (si.addToCache(i, e), Ri.addToCache(t, e), (n.texture = t)),
              (n.textures[o] = t);
          }),
        n)
      : n;
  }
  t.LoaderResource.setExtensionXhrType("dds", t.LoaderResource.XHR_RESPONSE_TYPE.BUFFER);
  var ds, fs;
  !(function (t) {
    (t[(t.DXGI_FORMAT_UNKNOWN = 0)] = "DXGI_FORMAT_UNKNOWN"),
      (t[(t.DXGI_FORMAT_R32G32B32A32_TYPELESS = 1)] = "DXGI_FORMAT_R32G32B32A32_TYPELESS"),
      (t[(t.DXGI_FORMAT_R32G32B32A32_FLOAT = 2)] = "DXGI_FORMAT_R32G32B32A32_FLOAT"),
      (t[(t.DXGI_FORMAT_R32G32B32A32_UINT = 3)] = "DXGI_FORMAT_R32G32B32A32_UINT"),
      (t[(t.DXGI_FORMAT_R32G32B32A32_SINT = 4)] = "DXGI_FORMAT_R32G32B32A32_SINT"),
      (t[(t.DXGI_FORMAT_R32G32B32_TYPELESS = 5)] = "DXGI_FORMAT_R32G32B32_TYPELESS"),
      (t[(t.DXGI_FORMAT_R32G32B32_FLOAT = 6)] = "DXGI_FORMAT_R32G32B32_FLOAT"),
      (t[(t.DXGI_FORMAT_R32G32B32_UINT = 7)] = "DXGI_FORMAT_R32G32B32_UINT"),
      (t[(t.DXGI_FORMAT_R32G32B32_SINT = 8)] = "DXGI_FORMAT_R32G32B32_SINT"),
      (t[(t.DXGI_FORMAT_R16G16B16A16_TYPELESS = 9)] = "DXGI_FORMAT_R16G16B16A16_TYPELESS"),
      (t[(t.DXGI_FORMAT_R16G16B16A16_FLOAT = 10)] = "DXGI_FORMAT_R16G16B16A16_FLOAT"),
      (t[(t.DXGI_FORMAT_R16G16B16A16_UNORM = 11)] = "DXGI_FORMAT_R16G16B16A16_UNORM"),
      (t[(t.DXGI_FORMAT_R16G16B16A16_UINT = 12)] = "DXGI_FORMAT_R16G16B16A16_UINT"),
      (t[(t.DXGI_FORMAT_R16G16B16A16_SNORM = 13)] = "DXGI_FORMAT_R16G16B16A16_SNORM"),
      (t[(t.DXGI_FORMAT_R16G16B16A16_SINT = 14)] = "DXGI_FORMAT_R16G16B16A16_SINT"),
      (t[(t.DXGI_FORMAT_R32G32_TYPELESS = 15)] = "DXGI_FORMAT_R32G32_TYPELESS"),
      (t[(t.DXGI_FORMAT_R32G32_FLOAT = 16)] = "DXGI_FORMAT_R32G32_FLOAT"),
      (t[(t.DXGI_FORMAT_R32G32_UINT = 17)] = "DXGI_FORMAT_R32G32_UINT"),
      (t[(t.DXGI_FORMAT_R32G32_SINT = 18)] = "DXGI_FORMAT_R32G32_SINT"),
      (t[(t.DXGI_FORMAT_R32G8X24_TYPELESS = 19)] = "DXGI_FORMAT_R32G8X24_TYPELESS"),
      (t[(t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT = 20)] = "DXGI_FORMAT_D32_FLOAT_S8X24_UINT"),
      (t[(t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS = 21)] = "DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS"),
      (t[(t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT = 22)] = "DXGI_FORMAT_X32_TYPELESS_G8X24_UINT"),
      (t[(t.DXGI_FORMAT_R10G10B10A2_TYPELESS = 23)] = "DXGI_FORMAT_R10G10B10A2_TYPELESS"),
      (t[(t.DXGI_FORMAT_R10G10B10A2_UNORM = 24)] = "DXGI_FORMAT_R10G10B10A2_UNORM"),
      (t[(t.DXGI_FORMAT_R10G10B10A2_UINT = 25)] = "DXGI_FORMAT_R10G10B10A2_UINT"),
      (t[(t.DXGI_FORMAT_R11G11B10_FLOAT = 26)] = "DXGI_FORMAT_R11G11B10_FLOAT"),
      (t[(t.DXGI_FORMAT_R8G8B8A8_TYPELESS = 27)] = "DXGI_FORMAT_R8G8B8A8_TYPELESS"),
      (t[(t.DXGI_FORMAT_R8G8B8A8_UNORM = 28)] = "DXGI_FORMAT_R8G8B8A8_UNORM"),
      (t[(t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB = 29)] = "DXGI_FORMAT_R8G8B8A8_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_R8G8B8A8_UINT = 30)] = "DXGI_FORMAT_R8G8B8A8_UINT"),
      (t[(t.DXGI_FORMAT_R8G8B8A8_SNORM = 31)] = "DXGI_FORMAT_R8G8B8A8_SNORM"),
      (t[(t.DXGI_FORMAT_R8G8B8A8_SINT = 32)] = "DXGI_FORMAT_R8G8B8A8_SINT"),
      (t[(t.DXGI_FORMAT_R16G16_TYPELESS = 33)] = "DXGI_FORMAT_R16G16_TYPELESS"),
      (t[(t.DXGI_FORMAT_R16G16_FLOAT = 34)] = "DXGI_FORMAT_R16G16_FLOAT"),
      (t[(t.DXGI_FORMAT_R16G16_UNORM = 35)] = "DXGI_FORMAT_R16G16_UNORM"),
      (t[(t.DXGI_FORMAT_R16G16_UINT = 36)] = "DXGI_FORMAT_R16G16_UINT"),
      (t[(t.DXGI_FORMAT_R16G16_SNORM = 37)] = "DXGI_FORMAT_R16G16_SNORM"),
      (t[(t.DXGI_FORMAT_R16G16_SINT = 38)] = "DXGI_FORMAT_R16G16_SINT"),
      (t[(t.DXGI_FORMAT_R32_TYPELESS = 39)] = "DXGI_FORMAT_R32_TYPELESS"),
      (t[(t.DXGI_FORMAT_D32_FLOAT = 40)] = "DXGI_FORMAT_D32_FLOAT"),
      (t[(t.DXGI_FORMAT_R32_FLOAT = 41)] = "DXGI_FORMAT_R32_FLOAT"),
      (t[(t.DXGI_FORMAT_R32_UINT = 42)] = "DXGI_FORMAT_R32_UINT"),
      (t[(t.DXGI_FORMAT_R32_SINT = 43)] = "DXGI_FORMAT_R32_SINT"),
      (t[(t.DXGI_FORMAT_R24G8_TYPELESS = 44)] = "DXGI_FORMAT_R24G8_TYPELESS"),
      (t[(t.DXGI_FORMAT_D24_UNORM_S8_UINT = 45)] = "DXGI_FORMAT_D24_UNORM_S8_UINT"),
      (t[(t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS = 46)] = "DXGI_FORMAT_R24_UNORM_X8_TYPELESS"),
      (t[(t.DXGI_FORMAT_X24_TYPELESS_G8_UINT = 47)] = "DXGI_FORMAT_X24_TYPELESS_G8_UINT"),
      (t[(t.DXGI_FORMAT_R8G8_TYPELESS = 48)] = "DXGI_FORMAT_R8G8_TYPELESS"),
      (t[(t.DXGI_FORMAT_R8G8_UNORM = 49)] = "DXGI_FORMAT_R8G8_UNORM"),
      (t[(t.DXGI_FORMAT_R8G8_UINT = 50)] = "DXGI_FORMAT_R8G8_UINT"),
      (t[(t.DXGI_FORMAT_R8G8_SNORM = 51)] = "DXGI_FORMAT_R8G8_SNORM"),
      (t[(t.DXGI_FORMAT_R8G8_SINT = 52)] = "DXGI_FORMAT_R8G8_SINT"),
      (t[(t.DXGI_FORMAT_R16_TYPELESS = 53)] = "DXGI_FORMAT_R16_TYPELESS"),
      (t[(t.DXGI_FORMAT_R16_FLOAT = 54)] = "DXGI_FORMAT_R16_FLOAT"),
      (t[(t.DXGI_FORMAT_D16_UNORM = 55)] = "DXGI_FORMAT_D16_UNORM"),
      (t[(t.DXGI_FORMAT_R16_UNORM = 56)] = "DXGI_FORMAT_R16_UNORM"),
      (t[(t.DXGI_FORMAT_R16_UINT = 57)] = "DXGI_FORMAT_R16_UINT"),
      (t[(t.DXGI_FORMAT_R16_SNORM = 58)] = "DXGI_FORMAT_R16_SNORM"),
      (t[(t.DXGI_FORMAT_R16_SINT = 59)] = "DXGI_FORMAT_R16_SINT"),
      (t[(t.DXGI_FORMAT_R8_TYPELESS = 60)] = "DXGI_FORMAT_R8_TYPELESS"),
      (t[(t.DXGI_FORMAT_R8_UNORM = 61)] = "DXGI_FORMAT_R8_UNORM"),
      (t[(t.DXGI_FORMAT_R8_UINT = 62)] = "DXGI_FORMAT_R8_UINT"),
      (t[(t.DXGI_FORMAT_R8_SNORM = 63)] = "DXGI_FORMAT_R8_SNORM"),
      (t[(t.DXGI_FORMAT_R8_SINT = 64)] = "DXGI_FORMAT_R8_SINT"),
      (t[(t.DXGI_FORMAT_A8_UNORM = 65)] = "DXGI_FORMAT_A8_UNORM"),
      (t[(t.DXGI_FORMAT_R1_UNORM = 66)] = "DXGI_FORMAT_R1_UNORM"),
      (t[(t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP = 67)] = "DXGI_FORMAT_R9G9B9E5_SHAREDEXP"),
      (t[(t.DXGI_FORMAT_R8G8_B8G8_UNORM = 68)] = "DXGI_FORMAT_R8G8_B8G8_UNORM"),
      (t[(t.DXGI_FORMAT_G8R8_G8B8_UNORM = 69)] = "DXGI_FORMAT_G8R8_G8B8_UNORM"),
      (t[(t.DXGI_FORMAT_BC1_TYPELESS = 70)] = "DXGI_FORMAT_BC1_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC1_UNORM = 71)] = "DXGI_FORMAT_BC1_UNORM"),
      (t[(t.DXGI_FORMAT_BC1_UNORM_SRGB = 72)] = "DXGI_FORMAT_BC1_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_BC2_TYPELESS = 73)] = "DXGI_FORMAT_BC2_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC2_UNORM = 74)] = "DXGI_FORMAT_BC2_UNORM"),
      (t[(t.DXGI_FORMAT_BC2_UNORM_SRGB = 75)] = "DXGI_FORMAT_BC2_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_BC3_TYPELESS = 76)] = "DXGI_FORMAT_BC3_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC3_UNORM = 77)] = "DXGI_FORMAT_BC3_UNORM"),
      (t[(t.DXGI_FORMAT_BC3_UNORM_SRGB = 78)] = "DXGI_FORMAT_BC3_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_BC4_TYPELESS = 79)] = "DXGI_FORMAT_BC4_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC4_UNORM = 80)] = "DXGI_FORMAT_BC4_UNORM"),
      (t[(t.DXGI_FORMAT_BC4_SNORM = 81)] = "DXGI_FORMAT_BC4_SNORM"),
      (t[(t.DXGI_FORMAT_BC5_TYPELESS = 82)] = "DXGI_FORMAT_BC5_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC5_UNORM = 83)] = "DXGI_FORMAT_BC5_UNORM"),
      (t[(t.DXGI_FORMAT_BC5_SNORM = 84)] = "DXGI_FORMAT_BC5_SNORM"),
      (t[(t.DXGI_FORMAT_B5G6R5_UNORM = 85)] = "DXGI_FORMAT_B5G6R5_UNORM"),
      (t[(t.DXGI_FORMAT_B5G5R5A1_UNORM = 86)] = "DXGI_FORMAT_B5G5R5A1_UNORM"),
      (t[(t.DXGI_FORMAT_B8G8R8A8_UNORM = 87)] = "DXGI_FORMAT_B8G8R8A8_UNORM"),
      (t[(t.DXGI_FORMAT_B8G8R8X8_UNORM = 88)] = "DXGI_FORMAT_B8G8R8X8_UNORM"),
      (t[(t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM = 89)] =
        "DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM"),
      (t[(t.DXGI_FORMAT_B8G8R8A8_TYPELESS = 90)] = "DXGI_FORMAT_B8G8R8A8_TYPELESS"),
      (t[(t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB = 91)] = "DXGI_FORMAT_B8G8R8A8_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_B8G8R8X8_TYPELESS = 92)] = "DXGI_FORMAT_B8G8R8X8_TYPELESS"),
      (t[(t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB = 93)] = "DXGI_FORMAT_B8G8R8X8_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_BC6H_TYPELESS = 94)] = "DXGI_FORMAT_BC6H_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC6H_UF16 = 95)] = "DXGI_FORMAT_BC6H_UF16"),
      (t[(t.DXGI_FORMAT_BC6H_SF16 = 96)] = "DXGI_FORMAT_BC6H_SF16"),
      (t[(t.DXGI_FORMAT_BC7_TYPELESS = 97)] = "DXGI_FORMAT_BC7_TYPELESS"),
      (t[(t.DXGI_FORMAT_BC7_UNORM = 98)] = "DXGI_FORMAT_BC7_UNORM"),
      (t[(t.DXGI_FORMAT_BC7_UNORM_SRGB = 99)] = "DXGI_FORMAT_BC7_UNORM_SRGB"),
      (t[(t.DXGI_FORMAT_AYUV = 100)] = "DXGI_FORMAT_AYUV"),
      (t[(t.DXGI_FORMAT_Y410 = 101)] = "DXGI_FORMAT_Y410"),
      (t[(t.DXGI_FORMAT_Y416 = 102)] = "DXGI_FORMAT_Y416"),
      (t[(t.DXGI_FORMAT_NV12 = 103)] = "DXGI_FORMAT_NV12"),
      (t[(t.DXGI_FORMAT_P010 = 104)] = "DXGI_FORMAT_P010"),
      (t[(t.DXGI_FORMAT_P016 = 105)] = "DXGI_FORMAT_P016"),
      (t[(t.DXGI_FORMAT_420_OPAQUE = 106)] = "DXGI_FORMAT_420_OPAQUE"),
      (t[(t.DXGI_FORMAT_YUY2 = 107)] = "DXGI_FORMAT_YUY2"),
      (t[(t.DXGI_FORMAT_Y210 = 108)] = "DXGI_FORMAT_Y210"),
      (t[(t.DXGI_FORMAT_Y216 = 109)] = "DXGI_FORMAT_Y216"),
      (t[(t.DXGI_FORMAT_NV11 = 110)] = "DXGI_FORMAT_NV11"),
      (t[(t.DXGI_FORMAT_AI44 = 111)] = "DXGI_FORMAT_AI44"),
      (t[(t.DXGI_FORMAT_IA44 = 112)] = "DXGI_FORMAT_IA44"),
      (t[(t.DXGI_FORMAT_P8 = 113)] = "DXGI_FORMAT_P8"),
      (t[(t.DXGI_FORMAT_A8P8 = 114)] = "DXGI_FORMAT_A8P8"),
      (t[(t.DXGI_FORMAT_B4G4R4A4_UNORM = 115)] = "DXGI_FORMAT_B4G4R4A4_UNORM"),
      (t[(t.DXGI_FORMAT_P208 = 116)] = "DXGI_FORMAT_P208"),
      (t[(t.DXGI_FORMAT_V208 = 117)] = "DXGI_FORMAT_V208"),
      (t[(t.DXGI_FORMAT_V408 = 118)] = "DXGI_FORMAT_V408"),
      (t[(t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE = 119)] =
        "DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE"),
      (t[(t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE = 120)] =
        "DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE"),
      (t[(t.DXGI_FORMAT_FORCE_UINT = 121)] = "DXGI_FORMAT_FORCE_UINT");
  })(ds || (ds = {})),
    (function (t) {
      (t[(t.DDS_DIMENSION_TEXTURE1D = 2)] = "DDS_DIMENSION_TEXTURE1D"),
        (t[(t.DDS_DIMENSION_TEXTURE2D = 3)] = "DDS_DIMENSION_TEXTURE2D"),
        (t[(t.DDS_DIMENSION_TEXTURE3D = 6)] = "DDS_DIMENSION_TEXTURE3D");
    })(fs || (fs = {}));
  var ps,
    _s,
    ms,
    vs =
      (((ss = {})[827611204] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT),
      (ss[861165636] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT),
      (ss[894720068] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT),
      ss),
    Es =
      (((as = {})[ds.DXGI_FORMAT_BC1_TYPELESS] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT),
      (as[ds.DXGI_FORMAT_BC1_UNORM] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT),
      (as[ds.DXGI_FORMAT_BC2_TYPELESS] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT),
      (as[ds.DXGI_FORMAT_BC2_UNORM] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT),
      (as[ds.DXGI_FORMAT_BC3_TYPELESS] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT),
      (as[ds.DXGI_FORMAT_BC3_UNORM] = t.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT),
      (as[ds.DXGI_FORMAT_BC1_UNORM_SRGB] = t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT),
      (as[ds.DXGI_FORMAT_BC2_UNORM_SRGB] = t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT),
      (as[ds.DXGI_FORMAT_BC3_UNORM_SRGB] = t.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),
      as),
    Ts = (function () {
      function t() {}
      return (
        (t.use = function (e, r) {
          if ("dds" === e.extension && e.data)
            try {
              Object.assign(e, cs(e.name || e.url, t.parse(e.data), e.metadata));
            } catch (t) {
              return void r(t);
            }
          r();
        }),
        (t.parse = function (t) {
          var e = new Uint32Array(t);
          if (542327876 !== e[0]) throw new Error("Invalid DDS file magic word");
          var r = new Uint32Array(t, 0, 124 / Uint32Array.BYTES_PER_ELEMENT),
            i = r[3],
            n = r[4],
            o = r[7],
            s = new Uint32Array(
              t,
              19 * Uint32Array.BYTES_PER_ELEMENT,
              32 / Uint32Array.BYTES_PER_ELEMENT
            ),
            a = s[1];
          if (4 & a) {
            var h = s[2];
            if (808540228 !== h) {
              var u = vs[h],
                l = new Uint8Array(t, 128);
              return [new us(l, { format: u, width: n, height: i, levels: o })];
            }
            var c = new Uint32Array(e.buffer, 128, 20 / Uint32Array.BYTES_PER_ELEMENT),
              d = c[0],
              f = c[1],
              p = c[2],
              _ = c[3],
              m = Es[d];
            if (void 0 === m)
              throw new Error("DDSLoader cannot parse texture data with DXGI format " + d);
            if (4 === p) throw new Error("DDSLoader does not support cubemap textures");
            if (f === fs.DDS_DIMENSION_TEXTURE3D)
              throw new Error("DDSLoader does not supported 3D texture data");
            var v = new Array();
            if (1 === _) v.push(new Uint8Array(t, 148));
            else {
              for (var E = is[m], T = 0, y = n, g = i, R = 0; R < o; R++)
                (T += Math.max(1, (y + 3) & -4) * Math.max(1, (g + 3) & -4) * E),
                  (y >>>= 1),
                  (g >>>= 1);
              var b = 148;
              for (R = 0; R < _; R++) v.push(new Uint8Array(t, b, T)), (b += T);
            }
            return v.map(function (t) {
              return new us(t, { format: m, width: n, height: i, levels: o });
            });
          }
          if (64 & a) throw new Error("DDSLoader does not support uncompressed texture data.");
          if (512 & a)
            throw new Error("DDSLoader does not supported YUV uncompressed texture data.");
          if (131072 & a)
            throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");
          if (2 & a)
            throw new Error("DDSLoader does not support single-channel (alpha) texture data!");
          throw new Error("DDSLoader failed to load a texture file due to an unknown reason!");
        }),
        t
      );
    })();
  t.LoaderResource.setExtensionXhrType("ktx", t.LoaderResource.XHR_RESPONSE_TYPE.BUFFER);
  var ys = [171, 75, 84, 88, 32, 49, 49, 187, 13, 10, 26, 10],
    gs =
      (((ps = {})[t.TYPES.UNSIGNED_BYTE] = 1),
      (ps[t.TYPES.UNSIGNED_SHORT] = 2),
      (ps[t.TYPES.INT] = 4),
      (ps[t.TYPES.UNSIGNED_INT] = 4),
      (ps[t.TYPES.FLOAT] = 4),
      (ps[t.TYPES.HALF_FLOAT] = 8),
      ps),
    Rs =
      (((_s = {})[t.FORMATS.RGBA] = 4),
      (_s[t.FORMATS.RGB] = 3),
      (_s[t.FORMATS.RG] = 2),
      (_s[t.FORMATS.RED] = 1),
      (_s[t.FORMATS.LUMINANCE] = 1),
      (_s[t.FORMATS.LUMINANCE_ALPHA] = 2),
      (_s[t.FORMATS.ALPHA] = 1),
      _s),
    bs =
      (((ms = {})[t.TYPES.UNSIGNED_SHORT_4_4_4_4] = 2),
      (ms[t.TYPES.UNSIGNED_SHORT_5_5_5_1] = 2),
      (ms[t.TYPES.UNSIGNED_SHORT_5_6_5] = 2),
      ms),
    As = (function () {
      function e() {}
      return (
        (e.use = function (r, i) {
          if ("ktx" === r.extension && r.data)
            try {
              var n = r.name || r.url,
                o = e.parse(n, r.data),
                s = o.compressed,
                a = o.uncompressed;
              if (s) Object.assign(r, cs(n, s, r.metadata));
              else if (a) {
                var h = {};
                a.forEach(function (e, r) {
                  var i = new Ri(
                      new si(e.resource, {
                        mipmap: t.MIPMAP_MODES.OFF,
                        alphaMode: t.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,
                        type: e.type,
                        format: e.format,
                      })
                    ),
                    o = n + "-" + (r + 1);
                  si.addToCache(i.baseTexture, o),
                    Ri.addToCache(i, o),
                    0 === r && ((h[n] = i), si.addToCache(i.baseTexture, n), Ri.addToCache(i, n)),
                    (h[o] = i);
                }),
                  Object.assign(r, { textures: h });
              }
            } catch (t) {
              return void i(t);
            }
          i();
        }),
        (e.parse = function (r, i) {
          var n = new DataView(i);
          if (!e.validate(r, n)) return null;
          var o = 67305985 === n.getUint32(12, !0),
            s = n.getUint32(16, o),
            a = n.getUint32(24, o),
            h = n.getUint32(28, o),
            u = n.getUint32(36, o),
            l = n.getUint32(40, o) || 1,
            c = n.getUint32(44, o) || 1,
            d = n.getUint32(48, o) || 1,
            f = n.getUint32(52, o),
            p = n.getUint32(56, o),
            _ = n.getUint32(60, o);
          if (0 === l || 1 !== c) throw new Error("Only 2D textures are supported");
          if (1 !== f) throw new Error("CubeTextures are not supported by KTXLoader yet!");
          if (1 !== d) throw new Error("WebGL does not support array textures");
          var m,
            v = (u + 3) & -4,
            E = (l + 3) & -4,
            T = new Array(d),
            y = u * l;
          if (
            (0 === s && (y = v * E),
            void 0 === (m = 0 !== s ? (gs[s] ? gs[s] * Rs[a] : bs[s]) : is[h]))
          )
            throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");
          for (var g = y * m, R = u, b = l, A = v, x = E, S = 64 + _, O = 0; O < p; O++) {
            for (var I = n.getUint32(S, o), P = S + 4, M = 0; M < d; M++) {
              var N = T[M];
              N || (N = T[M] = new Array(p)),
                (N[O] = {
                  levelID: O,
                  levelWidth: p > 1 || 0 !== s ? R : A,
                  levelHeight: p > 1 || 0 !== s ? b : x,
                  levelBuffer: new Uint8Array(i, P, g),
                }),
                (P += g);
            }
            (S = (S += I + 4) % 4 != 0 ? S + 4 - (S % 4) : S),
              (g =
                (A = ((R = R >> 1 || 1) + 4 - 1) & -4) *
                (x = ((b = b >> 1 || 1) + 4 - 1) & -4) *
                m);
          }
          return 0 !== s
            ? {
                uncompressed: T.map(function (r) {
                  var i = r[0].levelBuffer,
                    n = !1;
                  return (
                    s === t.TYPES.FLOAT
                      ? (i = new Float32Array(
                          r[0].levelBuffer.buffer,
                          r[0].levelBuffer.byteOffset,
                          r[0].levelBuffer.byteLength / 4
                        ))
                      : s === t.TYPES.UNSIGNED_INT
                      ? ((n = !0),
                        (i = new Uint32Array(
                          r[0].levelBuffer.buffer,
                          r[0].levelBuffer.byteOffset,
                          r[0].levelBuffer.byteLength / 4
                        )))
                      : s === t.TYPES.INT &&
                        ((n = !0),
                        (i = new Int32Array(
                          r[0].levelBuffer.buffer,
                          r[0].levelBuffer.byteOffset,
                          r[0].levelBuffer.byteLength / 4
                        ))),
                    {
                      resource: new ni(i, { width: r[0].levelWidth, height: r[0].levelHeight }),
                      type: s,
                      format: n ? e.convertFormatToInteger(a) : a,
                    }
                  );
                }),
              }
            : {
                compressed: T.map(function (t) {
                  return new us(null, {
                    format: h,
                    width: u,
                    height: l,
                    levels: p,
                    levelBuffers: t,
                  });
                }),
              };
        }),
        (e.validate = function (t, e) {
          for (var r = 0; r < ys.length; r++) if (e.getUint8(r) !== ys[r]) return !1;
          return !0;
        }),
        (e.convertFormatToInteger = function (e) {
          switch (e) {
            case t.FORMATS.RGBA:
              return t.FORMATS.RGBA_INTEGER;
            case t.FORMATS.RGB:
              return t.FORMATS.RGB_INTEGER;
            case t.FORMATS.RG:
              return t.FORMATS.RG_INTEGER;
            case t.FORMATS.RED:
              return t.FORMATS.RED_INTEGER;
            default:
              return e;
          }
        }),
        e
      );
    })(),
    xs = function (t, e) {
      return (xs =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function Ss(t, e) {
    function r() {
      this.constructor = t;
    }
    xs(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var Os = (function (e) {
      function r(r, i, n, o) {
        void 0 === r && (r = 1500), void 0 === n && (n = 16384), void 0 === o && (o = !1);
        var s = e.call(this) || this;
        return (
          n > 16384 && (n = 16384),
          (s._properties = [!1, !0, !1, !1, !1]),
          (s._maxSize = r),
          (s._batchSize = n),
          (s._buffers = null),
          (s._bufferUpdateIDs = []),
          (s._updateID = 0),
          (s.interactiveChildren = !1),
          (s.blendMode = t.BLEND_MODES.NORMAL),
          (s.autoResize = o),
          (s.roundPixels = !0),
          (s.baseTexture = null),
          s.setProperties(i),
          (s._tint = 0),
          (s.tintRgb = new Float32Array(4)),
          (s.tint = 16777215),
          s
        );
      }
      return (
        Ss(r, e),
        (r.prototype.setProperties = function (t) {
          t &&
            ((this._properties[0] =
              "vertices" in t || "scale" in t ? !!t.vertices || !!t.scale : this._properties[0]),
            (this._properties[1] = "position" in t ? !!t.position : this._properties[1]),
            (this._properties[2] = "rotation" in t ? !!t.rotation : this._properties[2]),
            (this._properties[3] = "uvs" in t ? !!t.uvs : this._properties[3]),
            (this._properties[4] =
              "tint" in t || "alpha" in t ? !!t.tint || !!t.alpha : this._properties[4]));
        }),
        (r.prototype.updateTransform = function () {
          this.displayObjectUpdateTransform();
        }),
        Object.defineProperty(r.prototype, "tint", {
          get: function () {
            return this._tint;
          },
          set: function (t) {
            (this._tint = t), ce(t, this.tintRgb);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.render = function (t) {
          var e = this;
          this.visible &&
            !(this.worldAlpha <= 0) &&
            this.children.length &&
            this.renderable &&
            (this.baseTexture ||
              ((this.baseTexture = this.children[0]._texture.baseTexture),
              this.baseTexture.valid ||
                this.baseTexture.once("update", function () {
                  return e.onChildrenChange(0);
                })),
            t.batch.setObjectRenderer(t.plugins.particle),
            t.plugins.particle.render(this));
        }),
        (r.prototype.onChildrenChange = function (t) {
          for (var e = Math.floor(t / this._batchSize); this._bufferUpdateIDs.length < e; )
            this._bufferUpdateIDs.push(0);
          this._bufferUpdateIDs[e] = ++this._updateID;
        }),
        (r.prototype.dispose = function () {
          if (this._buffers) {
            for (var t = 0; t < this._buffers.length; ++t) this._buffers[t].destroy();
            this._buffers = null;
          }
        }),
        (r.prototype.destroy = function (t) {
          e.prototype.destroy.call(this, t),
            this.dispose(),
            (this._properties = null),
            (this._buffers = null),
            (this._bufferUpdateIDs = null);
        }),
        r
      );
    })(Dr),
    Is = (function () {
      function e(e, r, i) {
        (this.geometry = new Ci()),
          (this.indexBuffer = null),
          (this.size = i),
          (this.dynamicProperties = []),
          (this.staticProperties = []);
        for (var n = 0; n < e.length; ++n) {
          var o = e[n];
          (o = {
            attributeName: o.attributeName,
            size: o.size,
            uploadFunction: o.uploadFunction,
            type: o.type || t.TYPES.FLOAT,
            offset: o.offset,
          }),
            r[n] ? this.dynamicProperties.push(o) : this.staticProperties.push(o);
        }
        (this.staticStride = 0),
          (this.staticBuffer = null),
          (this.staticData = null),
          (this.staticDataUint32 = null),
          (this.dynamicStride = 0),
          (this.dynamicBuffer = null),
          (this.dynamicData = null),
          (this.dynamicDataUint32 = null),
          (this._updateID = 0),
          this.initBuffers();
      }
      return (
        (e.prototype.initBuffers = function () {
          var e = this.geometry,
            r = 0;
          (this.indexBuffer = new Ii(Te(this.size), !0, !0)),
            e.addIndex(this.indexBuffer),
            (this.dynamicStride = 0);
          for (var i = 0; i < this.dynamicProperties.length; ++i)
            ((a = this.dynamicProperties[i]).offset = r),
              (r += a.size),
              (this.dynamicStride += a.size);
          var n = new ArrayBuffer(this.size * this.dynamicStride * 4 * 4);
          (this.dynamicData = new Float32Array(n)),
            (this.dynamicDataUint32 = new Uint32Array(n)),
            (this.dynamicBuffer = new Ii(this.dynamicData, !1, !1));
          var o = 0;
          for (this.staticStride = 0, i = 0; i < this.staticProperties.length; ++i)
            ((a = this.staticProperties[i]).offset = o),
              (o += a.size),
              (this.staticStride += a.size);
          var s = new ArrayBuffer(this.size * this.staticStride * 4 * 4);
          for (
            this.staticData = new Float32Array(s),
              this.staticDataUint32 = new Uint32Array(s),
              this.staticBuffer = new Ii(this.staticData, !0, !1),
              i = 0;
            i < this.dynamicProperties.length;
            ++i
          ) {
            var a = this.dynamicProperties[i];
            e.addAttribute(
              a.attributeName,
              this.dynamicBuffer,
              0,
              a.type === t.TYPES.UNSIGNED_BYTE,
              a.type,
              4 * this.dynamicStride,
              4 * a.offset
            );
          }
          for (i = 0; i < this.staticProperties.length; ++i)
            (a = this.staticProperties[i]),
              e.addAttribute(
                a.attributeName,
                this.staticBuffer,
                0,
                a.type === t.TYPES.UNSIGNED_BYTE,
                a.type,
                4 * this.staticStride,
                4 * a.offset
              );
        }),
        (e.prototype.uploadDynamic = function (e, r, i) {
          for (var n = 0; n < this.dynamicProperties.length; n++) {
            var o = this.dynamicProperties[n];
            o.uploadFunction(
              e,
              r,
              i,
              o.type === t.TYPES.UNSIGNED_BYTE ? this.dynamicDataUint32 : this.dynamicData,
              this.dynamicStride,
              o.offset
            );
          }
          this.dynamicBuffer._updateID++;
        }),
        (e.prototype.uploadStatic = function (e, r, i) {
          for (var n = 0; n < this.staticProperties.length; n++) {
            var o = this.staticProperties[n];
            o.uploadFunction(
              e,
              r,
              i,
              o.type === t.TYPES.UNSIGNED_BYTE ? this.staticDataUint32 : this.staticData,
              this.staticStride,
              o.offset
            );
          }
          this.staticBuffer._updateID++;
        }),
        (e.prototype.destroy = function () {
          (this.indexBuffer = null),
            (this.dynamicProperties = null),
            (this.dynamicBuffer = null),
            (this.dynamicData = null),
            (this.dynamicDataUint32 = null),
            (this.staticProperties = null),
            (this.staticBuffer = null),
            (this.staticData = null),
            (this.staticDataUint32 = null),
            this.geometry.destroy();
        }),
        e
      );
    })(),
    Ps =
      "varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",
    Ms =
      "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n",
    Ns = (function (e) {
      function r(r) {
        var i = e.call(this, r) || this;
        return (
          (i.shader = null),
          (i.properties = null),
          (i.tempMatrix = new Qe()),
          (i.properties = [
            {
              attributeName: "aVertexPosition",
              size: 2,
              uploadFunction: i.uploadVertices,
              offset: 0,
            },
            {
              attributeName: "aPositionCoord",
              size: 2,
              uploadFunction: i.uploadPosition,
              offset: 0,
            },
            { attributeName: "aRotation", size: 1, uploadFunction: i.uploadRotation, offset: 0 },
            { attributeName: "aTextureCoord", size: 2, uploadFunction: i.uploadUvs, offset: 0 },
            {
              attributeName: "aColor",
              size: 1,
              type: t.TYPES.UNSIGNED_BYTE,
              uploadFunction: i.uploadTint,
              offset: 0,
            },
          ]),
          (i.shader = bn.from(Ms, Ps, {})),
          (i.state = An.for2d()),
          i
        );
      }
      return (
        Ss(r, e),
        (r.prototype.render = function (t) {
          var e = t.children,
            r = t._maxSize,
            i = t._batchSize,
            n = this.renderer,
            o = e.length;
          if (0 !== o) {
            o > r && !t.autoResize && (o = r);
            var s = t._buffers;
            s || (s = t._buffers = this.generateBuffers(t));
            var a = e[0]._texture.baseTexture;
            (this.state.blendMode = _e(t.blendMode, a.alphaMode)), n.state.set(this.state);
            var h = n.gl,
              u = t.worldTransform.copyTo(this.tempMatrix);
            u.prepend(n.globalUniforms.uniforms.projectionMatrix),
              (this.shader.uniforms.translationMatrix = u.toArray(!0)),
              (this.shader.uniforms.uColor = me(
                t.tintRgb,
                t.worldAlpha,
                this.shader.uniforms.uColor,
                a.alphaMode
              )),
              (this.shader.uniforms.uSampler = a),
              this.renderer.shader.bind(this.shader);
            for (var l = !1, c = 0, d = 0; c < o; c += i, d += 1) {
              var f = o - c;
              f > i && (f = i), d >= s.length && s.push(this._generateOneMoreBuffer(t));
              var p = s[d];
              p.uploadDynamic(e, c, f);
              var _ = t._bufferUpdateIDs[d] || 0;
              (l = l || p._updateID < _) && ((p._updateID = t._updateID), p.uploadStatic(e, c, f)),
                n.geometry.bind(p.geometry),
                h.drawElements(h.TRIANGLES, 6 * f, h.UNSIGNED_SHORT, 0);
            }
          }
        }),
        (r.prototype.generateBuffers = function (t) {
          for (
            var e = [], r = t._maxSize, i = t._batchSize, n = t._properties, o = 0;
            o < r;
            o += i
          )
            e.push(new Is(this.properties, n, i));
          return e;
        }),
        (r.prototype._generateOneMoreBuffer = function (t) {
          var e = t._batchSize,
            r = t._properties;
          return new Is(this.properties, r, e);
        }),
        (r.prototype.uploadVertices = function (t, e, r, i, n, o) {
          for (var s = 0, a = 0, h = 0, u = 0, l = 0; l < r; ++l) {
            var c = t[e + l],
              d = c._texture,
              f = c.scale.x,
              p = c.scale.y,
              _ = d.trim,
              m = d.orig;
            _
              ? ((s = (a = _.x - c.anchor.x * m.width) + _.width),
                (h = (u = _.y - c.anchor.y * m.height) + _.height))
              : ((s = m.width * (1 - c.anchor.x)),
                (a = m.width * -c.anchor.x),
                (h = m.height * (1 - c.anchor.y)),
                (u = m.height * -c.anchor.y)),
              (i[o] = a * f),
              (i[o + 1] = u * p),
              (i[o + n] = s * f),
              (i[o + n + 1] = u * p),
              (i[o + 2 * n] = s * f),
              (i[o + 2 * n + 1] = h * p),
              (i[o + 3 * n] = a * f),
              (i[o + 3 * n + 1] = h * p),
              (o += 4 * n);
          }
        }),
        (r.prototype.uploadPosition = function (t, e, r, i, n, o) {
          for (var s = 0; s < r; s++) {
            var a = t[e + s].position;
            (i[o] = a.x),
              (i[o + 1] = a.y),
              (i[o + n] = a.x),
              (i[o + n + 1] = a.y),
              (i[o + 2 * n] = a.x),
              (i[o + 2 * n + 1] = a.y),
              (i[o + 3 * n] = a.x),
              (i[o + 3 * n + 1] = a.y),
              (o += 4 * n);
          }
        }),
        (r.prototype.uploadRotation = function (t, e, r, i, n, o) {
          for (var s = 0; s < r; s++) {
            var a = t[e + s].rotation;
            (i[o] = a), (i[o + n] = a), (i[o + 2 * n] = a), (i[o + 3 * n] = a), (o += 4 * n);
          }
        }),
        (r.prototype.uploadUvs = function (t, e, r, i, n, o) {
          for (var s = 0; s < r; ++s) {
            var a = t[e + s]._texture._uvs;
            a
              ? ((i[o] = a.x0),
                (i[o + 1] = a.y0),
                (i[o + n] = a.x1),
                (i[o + n + 1] = a.y1),
                (i[o + 2 * n] = a.x2),
                (i[o + 2 * n + 1] = a.y2),
                (i[o + 3 * n] = a.x3),
                (i[o + 3 * n + 1] = a.y3),
                (o += 4 * n))
              : ((i[o] = 0),
                (i[o + 1] = 0),
                (i[o + n] = 0),
                (i[o + n + 1] = 0),
                (i[o + 2 * n] = 0),
                (i[o + 2 * n + 1] = 0),
                (i[o + 3 * n] = 0),
                (i[o + 3 * n + 1] = 0),
                (o += 4 * n));
          }
        }),
        (r.prototype.uploadTint = function (t, e, r, i, n, o) {
          for (var s = 0; s < r; ++s) {
            var a = t[e + s],
              h = a._texture.baseTexture.alphaMode > 0,
              u = a.alpha,
              l = u < 1 && h ? ve(a._tintRGB, u) : a._tintRGB + ((255 * u) << 24);
            (i[o] = l), (i[o + n] = l), (i[o + 2 * n] = l), (i[o + 3 * n] = l), (o += 4 * n);
          }
        }),
        (r.prototype.destroy = function () {
          e.prototype.destroy.call(this),
            this.shader && (this.shader.destroy(), (this.shader = null)),
            (this.tempMatrix = null);
        }),
        r
      );
    })(Hi);
  !(function (t) {
    (t.MITER = "miter"), (t.BEVEL = "bevel"), (t.ROUND = "round");
  })(t.LINE_JOIN || (t.LINE_JOIN = {})),
    (function (t) {
      (t.BUTT = "butt"), (t.ROUND = "round"), (t.SQUARE = "square");
    })(t.LINE_CAP || (t.LINE_CAP = {}));
  var Ds = {
      adaptive: !0,
      maxLength: 10,
      minSegments: 8,
      maxSegments: 2048,
      epsilon: 1e-4,
      _segmentsCount: function (t, e) {
        if ((void 0 === e && (e = 20), !this.adaptive || !t || isNaN(t))) return e;
        var r = Math.ceil(t / this.maxLength);
        return (
          r < this.minSegments
            ? (r = this.minSegments)
            : r > this.maxSegments && (r = this.maxSegments),
          r
        );
      },
    },
    Cs = (function () {
      function t() {
        (this.color = 16777215),
          (this.alpha = 1),
          (this.texture = Ri.WHITE),
          (this.matrix = null),
          (this.visible = !1),
          this.reset();
      }
      return (
        (t.prototype.clone = function () {
          var e = new t();
          return (
            (e.color = this.color),
            (e.alpha = this.alpha),
            (e.texture = this.texture),
            (e.matrix = this.matrix),
            (e.visible = this.visible),
            e
          );
        }),
        (t.prototype.reset = function () {
          (this.color = 16777215),
            (this.alpha = 1),
            (this.texture = Ri.WHITE),
            (this.matrix = null),
            (this.visible = !1);
        }),
        (t.prototype.destroy = function () {
          (this.texture = null), (this.matrix = null);
        }),
        t
      );
    })(),
    Ls = function (t, e) {
      return (Ls =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function ws(t, e) {
    function r() {
      this.constructor = t;
    }
    Ls(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  function Fs(t, e) {
    var r, i;
    void 0 === e && (e = !1);
    var n = t.length;
    if (!(n < 6)) {
      for (var o = 0, s = 0, a = t[n - 2], h = t[n - 1]; s < n; s += 2) {
        var u = t[s],
          l = t[s + 1];
        (o += (u - a) * (l + h)), (a = u), (h = l);
      }
      if ((!e && o > 0) || (e && o <= 0)) {
        var c = n / 2;
        for (s = c + (c % 2); s < n; s += 2) {
          var d = n - s - 2,
            f = n - s - 1,
            p = s,
            _ = s + 1;
          (r = [t[p], t[d]]),
            (t[d] = r[0]),
            (t[p] = r[1]),
            (i = [t[_], t[f]]),
            (t[f] = i[0]),
            (t[_] = i[1]);
        }
      }
    }
  }
  var Us = {
      build: function (t) {
        t.points = t.shape.points.slice();
      },
      triangulate: function (t, e) {
        var r = t.points,
          i = t.holes,
          n = e.points,
          o = e.indices;
        if (r.length >= 6) {
          Fs(r, !1);
          for (var s = [], a = 0; a < i.length; a++) {
            var h = i[a];
            Fs(h.points, !0), s.push(r.length / 2), (r = r.concat(h.points));
          }
          var u = st(r, s, 2);
          if (!u) return;
          var l = n.length / 2;
          for (a = 0; a < u.length; a += 3)
            o.push(u[a] + l), o.push(u[a + 1] + l), o.push(u[a + 2] + l);
          for (a = 0; a < r.length; a++) n.push(r[a]);
        }
      },
    },
    Bs = {
      build: function (e) {
        var r,
          i,
          n,
          o,
          s,
          a,
          h = e.points;
        if (e.type === t.SHAPES.CIRC) {
          var u = e.shape;
          (r = u.x), (i = u.y), (s = a = u.radius), (n = o = 0);
        } else if (e.type === t.SHAPES.ELIP) {
          var l = e.shape;
          (r = l.x), (i = l.y), (s = l.width), (a = l.height), (n = o = 0);
        } else {
          var c = e.shape,
            d = c.width / 2,
            f = c.height / 2;
          (r = c.x + d),
            (i = c.y + f),
            (n = d - (s = a = Math.max(0, Math.min(c.radius, Math.min(d, f))))),
            (o = f - a);
        }
        var p = Math.ceil(2.3 * Math.sqrt(s + a)),
          _ = 8 * p + (n ? 4 : 0) + (o ? 4 : 0);
        if (((h.length = _), 0 !== _)) {
          if (0 === p)
            return (
              (h.length = 8),
              (h[0] = h[6] = r + n),
              (h[1] = h[3] = i + o),
              (h[2] = h[4] = r - n),
              void (h[5] = h[7] = i - o)
            );
          var m,
            v,
            E = 0,
            T = 4 * p + (n ? 2 : 0) + 2,
            y = T,
            g = _,
            R = r + (m = n + s),
            b = r - m,
            A = i + (v = o);
          if (((h[E++] = R), (h[E++] = A), (h[--T] = A), (h[--T] = b), o)) {
            var x = i - v;
            (h[y++] = b), (h[y++] = x), (h[--g] = x), (h[--g] = R);
          }
          for (var S = 1; S < p; S++) {
            var O = (Math.PI / 2) * (S / p);
            (R = r + (m = n + Math.cos(O) * s)),
              (b = r - m),
              (A = i + (v = o + Math.sin(O) * a)),
              (x = i - v),
              (h[E++] = R),
              (h[E++] = A),
              (h[--T] = A),
              (h[--T] = b),
              (h[y++] = b),
              (h[y++] = x),
              (h[--g] = x),
              (h[--g] = R);
          }
          (R = r + (m = n)),
            (b = r - m),
            (A = i + (v = o + a)),
            (x = i - v),
            (h[E++] = R),
            (h[E++] = A),
            (h[--g] = x),
            (h[--g] = R),
            n && ((h[E++] = b), (h[E++] = A), (h[--g] = x), (h[--g] = b));
        }
      },
      triangulate: function (e, r) {
        var i,
          n,
          o = e.points,
          s = r.points,
          a = r.indices,
          h = s.length / 2,
          u = h;
        if (e.type !== t.SHAPES.RREC) {
          var l = e.shape;
          (i = l.x), (n = l.y);
        } else {
          var c = e.shape;
          (i = c.x + c.width / 2), (n = c.y + c.height / 2);
        }
        var d = e.matrix;
        s.push(e.matrix ? d.a * i + d.c * n + d.tx : i, e.matrix ? d.b * i + d.d * n + d.ty : n),
          h++,
          s.push(o[0], o[1]);
        for (var f = 2; f < o.length; f += 2) s.push(o[f], o[f + 1]), a.push(h++, u, h);
        a.push(u + 1, u, h);
      },
    },
    Gs = {
      build: function (t) {
        var e = t.shape,
          r = e.x,
          i = e.y,
          n = e.width,
          o = e.height,
          s = t.points;
        (s.length = 0), s.push(r, i, r + n, i, r + n, i + o, r, i + o);
      },
      triangulate: function (t, e) {
        var r = t.points,
          i = e.points,
          n = i.length / 2;
        i.push(r[0], r[1], r[2], r[3], r[6], r[7], r[4], r[5]),
          e.indices.push(n, n + 1, n + 2, n + 1, n + 2, n + 3);
      },
    };
  function Xs(t, e, r) {
    return t + (e - t) * r;
  }
  function ks(t, e, r, i, n, o, s) {
    void 0 === s && (s = []);
    for (var a = s, h = 0, u = 0, l = 0, c = 0, d = 0, f = 0, p = 0, _ = 0; p <= 20; ++p)
      (h = Xs(t, r, (_ = p / 20))),
        (u = Xs(e, i, _)),
        (l = Xs(r, n, _)),
        (c = Xs(i, o, _)),
        (d = Xs(h, l, _)),
        (f = Xs(u, c, _)),
        (0 === p && a[a.length - 2] === d && a[a.length - 1] === f) || a.push(d, f);
    return a;
  }
  var Hs = {
    build: function (t) {
      if (aa.nextRoundedRectBehavior) Bs.build(t);
      else {
        var e = t.shape,
          r = t.points,
          i = e.x,
          n = e.y,
          o = e.width,
          s = e.height,
          a = Math.max(0, Math.min(e.radius, Math.min(o, s) / 2));
        (r.length = 0),
          a
            ? (ks(i, n + a, i, n, i + a, n, r),
              ks(i + o - a, n, i + o, n, i + o, n + a, r),
              ks(i + o, n + s - a, i + o, n + s, i + o - a, n + s, r),
              ks(i + a, n + s, i, n + s, i, n + s - a, r))
            : r.push(i, n, i + o, n, i + o, n + s, i, n + s);
      }
    },
    triangulate: function (t, e) {
      if (aa.nextRoundedRectBehavior) Bs.triangulate(t, e);
      else {
        for (
          var r = t.points,
            i = e.points,
            n = e.indices,
            o = i.length / 2,
            s = st(r, null, 2),
            a = 0,
            h = s.length;
          a < h;
          a += 3
        )
          n.push(s[a] + o), n.push(s[a + 1] + o), n.push(s[a + 2] + o);
        for (a = 0, h = r.length; a < h; a++) i.push(r[a], r[++a]);
      }
    },
  };
  function Ys(t, e, r, i, n, o, s, a) {
    var h, u;
    s ? ((h = i), (u = -r)) : ((h = -i), (u = r));
    var l = t - r * n + h,
      c = e - i * n + u,
      d = t + r * o + h,
      f = e + i * o + u;
    return a.push(l, c), a.push(d, f), 2;
  }
  function js(t, e, r, i, n, o, s, a) {
    var h = r - t,
      u = i - e,
      l = Math.atan2(h, u),
      c = Math.atan2(n - t, o - e);
    a && l < c ? (l += 2 * Math.PI) : !a && l > c && (c += 2 * Math.PI);
    var d = l,
      f = c - l,
      p = Math.abs(f),
      _ = Math.sqrt(h * h + u * u),
      m = 1 + (((15 * p * Math.sqrt(_)) / Math.PI) >> 0),
      v = f / m;
    if (((d += v), a)) {
      s.push(t, e), s.push(r, i);
      for (var E = 1, T = d; E < m; E++, T += v)
        s.push(t, e), s.push(t + Math.sin(T) * _, e + Math.cos(T) * _);
      s.push(t, e), s.push(n, o);
    } else {
      for (s.push(r, i), s.push(t, e), E = 1, T = d; E < m; E++, T += v)
        s.push(t + Math.sin(T) * _, e + Math.cos(T) * _), s.push(t, e);
      s.push(n, o), s.push(t, e);
    }
    return 2 * m;
  }
  function Vs(e, r) {
    e.lineStyle.native
      ? (function (e, r) {
          var i = 0,
            n = e.shape,
            o = e.points || n.points,
            s = n.type !== t.SHAPES.POLY || n.closeStroke;
          if (0 !== o.length) {
            var a = r.points,
              h = r.indices,
              u = o.length / 2,
              l = a.length / 2,
              c = l;
            for (a.push(o[0], o[1]), i = 1; i < u; i++)
              a.push(o[2 * i], o[2 * i + 1]), h.push(c, c + 1), c++;
            s && h.push(c, l);
          }
        })(e, r)
      : (function (e, r) {
          var i = e.shape,
            n = e.points || i.points.slice(),
            o = r.closePointEps;
          if (0 !== n.length) {
            var s = e.lineStyle,
              a = new Ye(n[0], n[1]),
              h = new Ye(n[n.length - 2], n[n.length - 1]),
              u = i.type !== t.SHAPES.POLY || i.closeStroke,
              l = Math.abs(a.x - h.x) < o && Math.abs(a.y - h.y) < o;
            if (u) {
              (n = n.slice()), l && (n.pop(), n.pop(), h.set(n[n.length - 2], n[n.length - 1]));
              var c = 0.5 * (a.x + h.x),
                d = 0.5 * (h.y + a.y);
              n.unshift(c, d), n.push(c, d);
            }
            var f = r.points,
              p = n.length / 2,
              _ = n.length,
              m = f.length / 2,
              v = s.width / 2,
              E = v * v,
              T = s.miterLimit * s.miterLimit,
              y = n[0],
              g = n[1],
              R = n[2],
              b = n[3],
              A = 0,
              x = 0,
              S = -(g - b),
              O = y - R,
              I = 0,
              P = 0,
              M = Math.sqrt(S * S + O * O);
            (S /= M), (O /= M), (S *= v), (O *= v);
            var N = s.alignment,
              D = 2 * (1 - N),
              C = 2 * N;
            u ||
              (s.cap === t.LINE_CAP.ROUND
                ? (_ +=
                    js(
                      y - S * (D - C) * 0.5,
                      g - O * (D - C) * 0.5,
                      y - S * D,
                      g - O * D,
                      y + S * C,
                      g + O * C,
                      f,
                      !0
                    ) + 2)
                : s.cap === t.LINE_CAP.SQUARE && (_ += Ys(y, g, S, O, D, C, !0, f))),
              f.push(y - S * D, g - O * D),
              f.push(y + S * C, g + O * C);
            for (var L = 1; L < p - 1; ++L) {
              (y = n[2 * (L - 1)]),
                (g = n[2 * (L - 1) + 1]),
                (R = n[2 * L]),
                (b = n[2 * L + 1]),
                (A = n[2 * (L + 1)]),
                (x = n[2 * (L + 1) + 1]),
                (S = -(g - b)),
                (O = y - R),
                (S /= M = Math.sqrt(S * S + O * O)),
                (O /= M),
                (S *= v),
                (O *= v),
                (I = -(b - x)),
                (P = R - A),
                (I /= M = Math.sqrt(I * I + P * P)),
                (P /= M),
                (I *= v),
                (P *= v);
              var w = R - y,
                F = g - b,
                U = R - A,
                B = x - b,
                G = F * U - B * w,
                X = G < 0;
              if (Math.abs(G) < 0.1) f.push(R - S * D, b - O * D), f.push(R + S * C, b + O * C);
              else {
                var k = (-S + y) * (-O + b) - (-S + R) * (-O + g),
                  H = (-I + A) * (-P + b) - (-I + R) * (-P + x),
                  Y = (w * H - U * k) / G,
                  j = (B * k - F * H) / G,
                  V = (Y - R) * (Y - R) + (j - b) * (j - b),
                  W = R + (Y - R) * D,
                  z = b + (j - b) * D,
                  q = R - (Y - R) * C,
                  K = b - (j - b) * C,
                  Z = X ? D : C;
                V <= Math.min(w * w + F * F, U * U + B * B) + Z * Z * E
                  ? s.join === t.LINE_JOIN.BEVEL || V / E > T
                    ? (X
                        ? (f.push(W, z),
                          f.push(R + S * C, b + O * C),
                          f.push(W, z),
                          f.push(R + I * C, b + P * C))
                        : (f.push(R - S * D, b - O * D),
                          f.push(q, K),
                          f.push(R - I * D, b - P * D),
                          f.push(q, K)),
                      (_ += 2))
                    : s.join === t.LINE_JOIN.ROUND
                    ? X
                      ? (f.push(W, z),
                        f.push(R + S * C, b + O * C),
                        (_ += js(R, b, R + S * C, b + O * C, R + I * C, b + P * C, f, !0) + 4),
                        f.push(W, z),
                        f.push(R + I * C, b + P * C))
                      : (f.push(R - S * D, b - O * D),
                        f.push(q, K),
                        (_ += js(R, b, R - S * D, b - O * D, R - I * D, b - P * D, f, !1) + 4),
                        f.push(R - I * D, b - P * D),
                        f.push(q, K))
                    : (f.push(W, z), f.push(q, K))
                  : (f.push(R - S * D, b - O * D),
                    f.push(R + S * C, b + O * C),
                    s.join === t.LINE_JOIN.BEVEL ||
                      V / E > T ||
                      (s.join === t.LINE_JOIN.ROUND
                        ? (_ += X
                            ? js(R, b, R + S * C, b + O * C, R + I * C, b + P * C, f, !0) + 2
                            : js(R, b, R - S * D, b - O * D, R - I * D, b - P * D, f, !1) + 2)
                        : (X ? (f.push(q, K), f.push(q, K)) : (f.push(W, z), f.push(W, z)),
                          (_ += 2))),
                    f.push(R - I * D, b - P * D),
                    f.push(R + I * C, b + P * C),
                    (_ += 2));
              }
            }
            (y = n[2 * (p - 2)]),
              (g = n[2 * (p - 2) + 1]),
              (R = n[2 * (p - 1)]),
              (S = -(g - (b = n[2 * (p - 1) + 1]))),
              (O = y - R),
              (S /= M = Math.sqrt(S * S + O * O)),
              (O /= M),
              (S *= v),
              (O *= v),
              f.push(R - S * D, b - O * D),
              f.push(R + S * C, b + O * C),
              u ||
                (s.cap === t.LINE_CAP.ROUND
                  ? (_ +=
                      js(
                        R - S * (D - C) * 0.5,
                        b - O * (D - C) * 0.5,
                        R - S * D,
                        b - O * D,
                        R + S * C,
                        b + O * C,
                        f,
                        !1
                      ) + 2)
                  : s.cap === t.LINE_CAP.SQUARE && (_ += Ys(R, b, S, O, D, C, !1, f)));
            var Q = r.indices,
              J = Ds.epsilon * Ds.epsilon;
            for (L = m; L < _ + m - 2; ++L)
              (y = f[2 * L]),
                (g = f[2 * L + 1]),
                (R = f[2 * (L + 1)]),
                (b = f[2 * (L + 1) + 1]),
                (A = f[2 * (L + 2)]),
                (x = f[2 * (L + 2) + 1]),
                Math.abs(y * (b - x) + R * (x - g) + A * (g - b)) < J || Q.push(L, L + 1, L + 2);
          }
        })(e, r);
  }
  var Ws,
    zs = (function () {
      function t() {}
      return (
        (t.curveTo = function (t, e, r, i, n, o) {
          var s = o[o.length - 2],
            a = o[o.length - 1] - e,
            h = s - t,
            u = i - e,
            l = r - t,
            c = Math.abs(a * l - h * u);
          if (c < 1e-8 || 0 === n)
            return (o[o.length - 2] === t && o[o.length - 1] === e) || o.push(t, e), null;
          var d = a * a + h * h,
            f = u * u + l * l,
            p = a * u + h * l,
            _ = (n * Math.sqrt(d)) / c,
            m = (n * Math.sqrt(f)) / c,
            v = (_ * p) / d,
            E = (m * p) / f,
            T = _ * l + m * h,
            y = _ * u + m * a,
            g = h * (m + v),
            R = a * (m + v),
            b = l * (_ + E),
            A = u * (_ + E);
          return {
            cx: T + t,
            cy: y + e,
            radius: n,
            startAngle: Math.atan2(R - y, g - T),
            endAngle: Math.atan2(A - y, b - T),
            anticlockwise: h * u > l * a,
          };
        }),
        (t.arc = function (t, e, r, i, n, o, s, a, h) {
          for (
            var u = s - o,
              l = Ds._segmentsCount(Math.abs(u) * n, 40 * Math.ceil(Math.abs(u) / Xe)),
              c = u / (2 * l),
              d = 2 * c,
              f = Math.cos(c),
              p = Math.sin(c),
              _ = l - 1,
              m = (_ % 1) / _,
              v = 0;
            v <= _;
            ++v
          ) {
            var E = c + o + d * (v + m * v),
              T = Math.cos(E),
              y = -Math.sin(E);
            h.push((f * T + p * y) * n + r, (f * -y + p * T) * n + i);
          }
        }),
        t
      );
    })(),
    qs = (function () {
      function t() {}
      return (
        (t.curveLength = function (t, e, r, i, n, o, s, a) {
          for (
            var h = 0,
              u = 0,
              l = 0,
              c = 0,
              d = 0,
              f = 0,
              p = 0,
              _ = 0,
              m = 0,
              v = 0,
              E = 0,
              T = t,
              y = e,
              g = 1;
            g <= 10;
            ++g
          )
            (v =
              T -
              (_ =
                (p = (f = (d = 1 - (u = g / 10)) * d) * d) * t +
                3 * f * u * r +
                3 * d * (l = u * u) * n +
                (c = l * u) * s)),
              (E = y - (m = p * e + 3 * f * u * i + 3 * d * l * o + c * a)),
              (T = _),
              (y = m),
              (h += Math.sqrt(v * v + E * E));
          return h;
        }),
        (t.curveTo = function (e, r, i, n, o, s, a) {
          var h = a[a.length - 2],
            u = a[a.length - 1];
          a.length -= 2;
          var l = Ds._segmentsCount(t.curveLength(h, u, e, r, i, n, o, s)),
            c = 0,
            d = 0,
            f = 0,
            p = 0,
            _ = 0;
          a.push(h, u);
          for (var m = 1, v = 0; m <= l; ++m)
            (f = (d = (c = 1 - (v = m / l)) * c) * c),
              (_ = (p = v * v) * v),
              a.push(
                f * h + 3 * d * v * e + 3 * c * p * i + _ * o,
                f * u + 3 * d * v * r + 3 * c * p * n + _ * s
              );
        }),
        t
      );
    })(),
    Ks = (function () {
      function t() {}
      return (
        (t.curveLength = function (t, e, r, i, n, o) {
          var s = t - 2 * r + n,
            a = e - 2 * i + o,
            h = 2 * r - 2 * t,
            u = 2 * i - 2 * e,
            l = 4 * (s * s + a * a),
            c = 4 * (s * h + a * u),
            d = h * h + u * u,
            f = 2 * Math.sqrt(l + c + d),
            p = Math.sqrt(l),
            _ = 2 * l * p,
            m = 2 * Math.sqrt(d),
            v = c / p;
          return (
            (_ * f + p * c * (f - m) + (4 * d * l - c * c) * Math.log((2 * p + v + f) / (v + m))) /
            (4 * _)
          );
        }),
        (t.curveTo = function (e, r, i, n, o) {
          for (
            var s = o[o.length - 2],
              a = o[o.length - 1],
              h = Ds._segmentsCount(t.curveLength(s, a, e, r, i, n)),
              u = 0,
              l = 0,
              c = 1;
            c <= h;
            ++c
          ) {
            var d = c / h;
            (u = s + (e - s) * d),
              (l = a + (r - a) * d),
              o.push(u + (e + (i - e) * d - u) * d, l + (r + (n - r) * d - l) * d);
          }
        }),
        t
      );
    })(),
    Zs = (function () {
      function t() {
        this.reset();
      }
      return (
        (t.prototype.begin = function (t, e, r) {
          this.reset(), (this.style = t), (this.start = e), (this.attribStart = r);
        }),
        (t.prototype.end = function (t, e) {
          (this.attribSize = e - this.attribStart), (this.size = t - this.start);
        }),
        (t.prototype.reset = function () {
          (this.style = null),
            (this.size = 0),
            (this.start = 0),
            (this.attribStart = 0),
            (this.attribSize = 0);
        }),
        t
      );
    })(),
    Qs =
      (((Ws = {})[t.SHAPES.POLY] = Us),
      (Ws[t.SHAPES.CIRC] = Bs),
      (Ws[t.SHAPES.ELIP] = Bs),
      (Ws[t.SHAPES.RECT] = Gs),
      (Ws[t.SHAPES.RREC] = Hs),
      Ws),
    Js = [],
    $s = [],
    ta = (function () {
      function t(t, e, r, i) {
        void 0 === e && (e = null),
          void 0 === r && (r = null),
          void 0 === i && (i = null),
          (this.points = []),
          (this.holes = []),
          (this.shape = t),
          (this.lineStyle = r),
          (this.fillStyle = e),
          (this.matrix = i),
          (this.type = t.type);
      }
      return (
        (t.prototype.clone = function () {
          return new t(this.shape, this.fillStyle, this.lineStyle, this.matrix);
        }),
        (t.prototype.destroy = function () {
          (this.shape = null),
            (this.holes.length = 0),
            (this.holes = null),
            (this.points.length = 0),
            (this.points = null),
            (this.lineStyle = null),
            (this.fillStyle = null);
        }),
        t
      );
    })(),
    ea = new Ye(),
    ra = new ar(),
    ia = (function (e) {
      function r() {
        var t = e.call(this) || this;
        return (
          (t.closePointEps = 1e-4),
          (t.boundsPadding = 0),
          (t.uvsFloat32 = null),
          (t.indicesUint16 = null),
          (t.batchable = !1),
          (t.points = []),
          (t.colors = []),
          (t.uvs = []),
          (t.indices = []),
          (t.textureIds = []),
          (t.graphicsData = []),
          (t.drawCalls = []),
          (t.batchDirty = -1),
          (t.batches = []),
          (t.dirty = 0),
          (t.cacheDirty = -1),
          (t.clearDirty = 0),
          (t.shapeIndex = 0),
          (t._bounds = new ar()),
          (t.boundsDirty = -1),
          t
        );
      }
      return (
        ws(r, e),
        Object.defineProperty(r.prototype, "bounds", {
          get: function () {
            return (
              this.boundsDirty !== this.dirty &&
                ((this.boundsDirty = this.dirty), this.calculateBounds()),
              this._bounds
            );
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.invalidate = function () {
          (this.boundsDirty = -1),
            this.dirty++,
            this.batchDirty++,
            (this.shapeIndex = 0),
            (this.points.length = 0),
            (this.colors.length = 0),
            (this.uvs.length = 0),
            (this.indices.length = 0),
            (this.textureIds.length = 0);
          for (var t = 0; t < this.drawCalls.length; t++)
            this.drawCalls[t].texArray.clear(), $s.push(this.drawCalls[t]);
          for (this.drawCalls.length = 0, t = 0; t < this.batches.length; t++) {
            var e = this.batches[t];
            e.reset(), Js.push(e);
          }
          this.batches.length = 0;
        }),
        (r.prototype.clear = function () {
          return (
            this.graphicsData.length > 0 &&
              (this.invalidate(), this.clearDirty++, (this.graphicsData.length = 0)),
            this
          );
        }),
        (r.prototype.drawShape = function (t, e, r, i) {
          void 0 === e && (e = null), void 0 === r && (r = null), void 0 === i && (i = null);
          var n = new ta(t, e, r, i);
          return this.graphicsData.push(n), this.dirty++, this;
        }),
        (r.prototype.drawHole = function (t, e) {
          if ((void 0 === e && (e = null), !this.graphicsData.length)) return null;
          var r = new ta(t, null, null, e),
            i = this.graphicsData[this.graphicsData.length - 1];
          return (r.lineStyle = i.lineStyle), i.holes.push(r), this.dirty++, this;
        }),
        (r.prototype.destroy = function () {
          e.prototype.destroy.call(this);
          for (var t = 0; t < this.graphicsData.length; ++t) this.graphicsData[t].destroy();
          (this.points.length = 0),
            (this.points = null),
            (this.colors.length = 0),
            (this.colors = null),
            (this.uvs.length = 0),
            (this.uvs = null),
            (this.indices.length = 0),
            (this.indices = null),
            this.indexBuffer.destroy(),
            (this.indexBuffer = null),
            (this.graphicsData.length = 0),
            (this.graphicsData = null),
            (this.drawCalls.length = 0),
            (this.drawCalls = null),
            (this.batches.length = 0),
            (this.batches = null),
            (this._bounds = null);
        }),
        (r.prototype.containsPoint = function (t) {
          for (var e = this.graphicsData, r = 0; r < e.length; ++r) {
            var i = e[r];
            if (
              i.fillStyle.visible &&
              i.shape &&
              (i.matrix ? i.matrix.applyInverse(t, ea) : ea.copyFrom(t),
              i.shape.contains(ea.x, ea.y))
            ) {
              var n = !1;
              if (i.holes)
                for (var o = 0; o < i.holes.length; o++)
                  if (i.holes[o].shape.contains(ea.x, ea.y)) {
                    n = !0;
                    break;
                  }
              if (!n) return !0;
            }
          }
          return !1;
        }),
        (r.prototype.updateBatches = function (e) {
          if (this.graphicsData.length) {
            if (this.validateBatching()) {
              this.cacheDirty = this.dirty;
              var r = this.uvs,
                i = this.graphicsData,
                n = null,
                o = null;
              this.batches.length > 0 && (o = (n = this.batches[this.batches.length - 1]).style);
              for (var s = this.shapeIndex; s < i.length; s++) {
                this.shapeIndex++;
                var a = i[s],
                  h = a.fillStyle,
                  u = a.lineStyle;
                Qs[a.type].build(a),
                  a.matrix && this.transformPoints(a.points, a.matrix),
                  (h.visible || u.visible) && this.processHoles(a.holes);
                for (var l = 0; l < 2; l++) {
                  var c = 0 === l ? h : u;
                  if (c.visible) {
                    var d = c.texture.baseTexture,
                      f = this.indices.length,
                      p = this.points.length / 2;
                    (d.wrapMode = t.WRAP_MODES.REPEAT),
                      0 === l ? this.processFill(a) : this.processLine(a);
                    var _ = this.points.length / 2 - p;
                    0 !== _ &&
                      (n && !this._compareStyles(o, c) && (n.end(f, p), (n = null)),
                      n ||
                        ((n = Js.pop() || new Zs()).begin(c, f, p), this.batches.push(n), (o = c)),
                      this.addUvs(this.points, r, c.texture, p, _, c.matrix));
                  }
                }
              }
              var m = this.indices.length,
                v = this.points.length / 2;
              if ((n && n.end(m, v), 0 !== this.batches.length)) {
                if (this.indicesUint16 && this.indices.length === this.indicesUint16.length)
                  this.indicesUint16.set(this.indices);
                else {
                  var E = v > 65535 && e;
                  this.indicesUint16 = E
                    ? new Uint32Array(this.indices)
                    : new Uint16Array(this.indices);
                }
                (this.batchable = this.isBatchable()),
                  this.batchable ? this.packBatches() : this.buildDrawCalls();
              } else this.batchable = !0;
            }
          } else this.batchable = !0;
        }),
        (r.prototype._compareStyles = function (t, e) {
          return (
            !(!t || !e) &&
            t.texture.baseTexture === e.texture.baseTexture &&
            t.color + t.alpha === e.color + e.alpha &&
            !!t.native == !!e.native
          );
        }),
        (r.prototype.validateBatching = function () {
          if (this.dirty === this.cacheDirty || !this.graphicsData.length) return !1;
          for (var t = 0, e = this.graphicsData.length; t < e; t++) {
            var r = this.graphicsData[t],
              i = r.fillStyle,
              n = r.lineStyle;
            if (i && !i.texture.baseTexture.valid) return !1;
            if (n && !n.texture.baseTexture.valid) return !1;
          }
          return !0;
        }),
        (r.prototype.packBatches = function () {
          this.batchDirty++, (this.uvsFloat32 = new Float32Array(this.uvs));
          for (var t = this.batches, e = 0, r = t.length; e < r; e++)
            for (var i = t[e], n = 0; n < i.size; n++) {
              var o = i.start + n;
              this.indicesUint16[o] = this.indicesUint16[o] - i.attribStart;
            }
        }),
        (r.prototype.isBatchable = function () {
          if (this.points.length > 131070) return !1;
          for (var t = this.batches, e = 0; e < t.length; e++) if (t[e].style.native) return !1;
          return this.points.length < 2 * r.BATCHABLE_SIZE;
        }),
        (r.prototype.buildDrawCalls = function () {
          for (var e = ++si._globalBatch, r = 0; r < this.drawCalls.length; r++)
            this.drawCalls[r].texArray.clear(), $s.push(this.drawCalls[r]);
          this.drawCalls.length = 0;
          var i = this.colors,
            n = this.textureIds,
            o = $s.pop();
          o || ((o = new To()).texArray = new yo()),
            (o.texArray.count = 0),
            (o.start = 0),
            (o.size = 0),
            (o.type = t.DRAW_MODES.TRIANGLES);
          var s = 0,
            a = null,
            h = 0,
            u = !1,
            l = t.DRAW_MODES.TRIANGLES,
            c = 0;
          for (this.drawCalls.push(o), r = 0; r < this.batches.length; r++) {
            var d = this.batches[r],
              f = d.style,
              p = f.texture.baseTexture;
            u !== !!f.native &&
              ((l = (u = !!f.native) ? t.DRAW_MODES.LINES : t.DRAW_MODES.TRIANGLES),
              (a = null),
              (s = 8),
              e++),
              a !== p &&
                ((a = p),
                p._batchEnabled !== e &&
                  (8 === s &&
                    (e++,
                    (s = 0),
                    o.size > 0 &&
                      ((o = $s.pop()) || ((o = new To()).texArray = new yo()),
                      this.drawCalls.push(o)),
                    (o.start = c),
                    (o.size = 0),
                    (o.texArray.count = 0),
                    (o.type = l)),
                  (p.touched = 1),
                  (p._batchEnabled = e),
                  (p._batchLocation = s),
                  (p.wrapMode = t.WRAP_MODES.REPEAT),
                  (o.texArray.elements[o.texArray.count++] = p),
                  s++)),
              (o.size += d.size),
              (c += d.size),
              (h = p._batchLocation),
              this.addColors(i, f.color, f.alpha, d.attribSize, d.attribStart),
              this.addTextureIds(n, h, d.attribSize, d.attribStart);
          }
          (si._globalBatch = e), this.packAttributes();
        }),
        (r.prototype.packAttributes = function () {
          for (
            var t = this.points,
              e = this.uvs,
              r = this.colors,
              i = this.textureIds,
              n = new ArrayBuffer(3 * t.length * 4),
              o = new Float32Array(n),
              s = new Uint32Array(n),
              a = 0,
              h = 0;
            h < t.length / 2;
            h++
          )
            (o[a++] = t[2 * h]),
              (o[a++] = t[2 * h + 1]),
              (o[a++] = e[2 * h]),
              (o[a++] = e[2 * h + 1]),
              (s[a++] = r[h]),
              (o[a++] = i[h]);
          this._buffer.update(n), this._indexBuffer.update(this.indicesUint16);
        }),
        (r.prototype.processFill = function (t) {
          t.holes.length ? Us.triangulate(t, this) : Qs[t.type].triangulate(t, this);
        }),
        (r.prototype.processLine = function (t) {
          Vs(t, this);
          for (var e = 0; e < t.holes.length; e++) Vs(t.holes[e], this);
        }),
        (r.prototype.processHoles = function (t) {
          for (var e = 0; e < t.length; e++) {
            var r = t[e];
            Qs[r.type].build(r), r.matrix && this.transformPoints(r.points, r.matrix);
          }
        }),
        (r.prototype.calculateBounds = function () {
          var e = this._bounds,
            r = ra,
            i = Qe.IDENTITY;
          this._bounds.clear(), r.clear();
          for (var n = 0; n < this.graphicsData.length; n++) {
            var o = this.graphicsData[n],
              s = o.shape,
              a = o.type,
              h = o.lineStyle,
              u = o.matrix || Qe.IDENTITY,
              l = 0;
            if (
              (h && h.visible && (l = h.width * Math.max(0, h.alignment)),
              i !== u && (r.isEmpty() || (e.addBoundsMatrix(r, i), r.clear()), (i = u)),
              a === t.SHAPES.RECT || a === t.SHAPES.RREC)
            ) {
              var c = s;
              r.addFramePad(c.x, c.y, c.x + c.width, c.y + c.height, l, l);
            } else if (a === t.SHAPES.CIRC) {
              var d = s;
              r.addFramePad(d.x, d.y, d.x, d.y, d.radius + l, d.radius + l);
            } else if (a === t.SHAPES.ELIP) {
              var f = s;
              r.addFramePad(f.x, f.y, f.x, f.y, f.width + l, f.height + l);
            } else {
              var p = s;
              e.addVerticesMatrix(i, p.points, 0, p.points.length, l, l);
            }
          }
          r.isEmpty() || e.addBoundsMatrix(r, i), e.pad(this.boundsPadding, this.boundsPadding);
        }),
        (r.prototype.transformPoints = function (t, e) {
          for (var r = 0; r < t.length / 2; r++) {
            var i = t[2 * r],
              n = t[2 * r + 1];
            (t[2 * r] = e.a * i + e.c * n + e.tx), (t[2 * r + 1] = e.b * i + e.d * n + e.ty);
          }
        }),
        (r.prototype.addColors = function (t, e, r, i, n) {
          void 0 === n && (n = 0);
          var o = ve((e >> 16) + (65280 & e) + ((255 & e) << 16), r);
          t.length = Math.max(t.length, n + i);
          for (var s = 0; s < i; s++) t[n + s] = o;
        }),
        (r.prototype.addTextureIds = function (t, e, r, i) {
          void 0 === i && (i = 0), (t.length = Math.max(t.length, i + r));
          for (var n = 0; n < r; n++) t[i + n] = e;
        }),
        (r.prototype.addUvs = function (t, e, r, i, n, o) {
          void 0 === o && (o = null);
          for (var s = 0, a = e.length, h = r.frame; s < n; ) {
            var u = t[2 * (i + s)],
              l = t[2 * (i + s) + 1];
            if (o) {
              var c = o.a * u + o.c * l + o.tx;
              (l = o.b * u + o.d * l + o.ty), (u = c);
            }
            s++, e.push(u / h.width, l / h.height);
          }
          var d = r.baseTexture;
          (h.width < d.width || h.height < d.height) && this.adjustUvs(e, r, a, n);
        }),
        (r.prototype.adjustUvs = function (t, e, r, i) {
          for (
            var n = e.baseTexture,
              o = r + 2 * i,
              s = e.frame,
              a = s.width / n.width,
              h = s.height / n.height,
              u = s.x / s.width,
              l = s.y / s.height,
              c = Math.floor(t[r] + 1e-6),
              d = Math.floor(t[r + 1] + 1e-6),
              f = r + 2;
            f < o;
            f += 2
          )
            (c = Math.min(c, Math.floor(t[f] + 1e-6))),
              (d = Math.min(d, Math.floor(t[f + 1] + 1e-6)));
          for (u -= c, l -= d, f = r; f < o; f += 2)
            (t[f] = (t[f] + u) * a), (t[f + 1] = (t[f + 1] + l) * h);
        }),
        (r.BATCHABLE_SIZE = 100),
        r
      );
    })(Ao),
    na = (function (e) {
      function r() {
        var r = (null !== e && e.apply(this, arguments)) || this;
        return (
          (r.width = 0),
          (r.alignment = 0.5),
          (r.native = !1),
          (r.cap = t.LINE_CAP.BUTT),
          (r.join = t.LINE_JOIN.MITER),
          (r.miterLimit = 10),
          r
        );
      }
      return (
        ws(r, e),
        (r.prototype.clone = function () {
          var t = new r();
          return (
            (t.color = this.color),
            (t.alpha = this.alpha),
            (t.texture = this.texture),
            (t.matrix = this.matrix),
            (t.visible = this.visible),
            (t.width = this.width),
            (t.alignment = this.alignment),
            (t.native = this.native),
            (t.cap = this.cap),
            (t.join = this.join),
            (t.miterLimit = this.miterLimit),
            t
          );
        }),
        (r.prototype.reset = function () {
          e.prototype.reset.call(this),
            (this.color = 0),
            (this.alignment = 0.5),
            (this.width = 0),
            (this.native = !1);
        }),
        r
      );
    })(Cs),
    oa = new Float32Array(3),
    sa = {},
    aa = (function (e) {
      function r(r) {
        void 0 === r && (r = null);
        var i = e.call(this) || this;
        return (
          (i.shader = null),
          (i.pluginName = "batch"),
          (i.currentPath = null),
          (i.batches = []),
          (i.batchTint = -1),
          (i.batchDirty = -1),
          (i.vertexData = null),
          (i._fillStyle = new Cs()),
          (i._lineStyle = new na()),
          (i._matrix = null),
          (i._holeMode = !1),
          (i.state = An.for2d()),
          (i._geometry = r || new ia()),
          i._geometry.refCount++,
          (i._transformID = -1),
          (i.tint = 16777215),
          (i.blendMode = t.BLEND_MODES.NORMAL),
          i
        );
      }
      return (
        ws(r, e),
        Object.defineProperty(r.prototype, "geometry", {
          get: function () {
            return this._geometry;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.clone = function () {
          return this.finishPoly(), new r(this._geometry);
        }),
        Object.defineProperty(r.prototype, "blendMode", {
          get: function () {
            return this.state.blendMode;
          },
          set: function (t) {
            this.state.blendMode = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "tint", {
          get: function () {
            return this._tint;
          },
          set: function (t) {
            this._tint = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "fill", {
          get: function () {
            return this._fillStyle;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "line", {
          get: function () {
            return this._lineStyle;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.lineStyle = function (t, e, r, i, n) {
          return (
            void 0 === t && (t = null),
            void 0 === e && (e = 0),
            void 0 === r && (r = 1),
            void 0 === i && (i = 0.5),
            void 0 === n && (n = !1),
            "number" == typeof t && (t = { width: t, color: e, alpha: r, alignment: i, native: n }),
            this.lineTextureStyle(t)
          );
        }),
        (r.prototype.lineTextureStyle = function (e) {
          (e = Object.assign(
            {
              width: 0,
              texture: Ri.WHITE,
              color: e && e.texture ? 16777215 : 0,
              alpha: 1,
              matrix: null,
              alignment: 0.5,
              native: !1,
              cap: t.LINE_CAP.BUTT,
              join: t.LINE_JOIN.MITER,
              miterLimit: 10,
            },
            e
          )),
            this.currentPath && this.startPoly();
          var r = e.width > 0 && e.alpha > 0;
          return (
            r
              ? (e.matrix && ((e.matrix = e.matrix.clone()), e.matrix.invert()),
                Object.assign(this._lineStyle, { visible: r }, e))
              : this._lineStyle.reset(),
            this
          );
        }),
        (r.prototype.startPoly = function () {
          if (this.currentPath) {
            var t = this.currentPath.points,
              e = this.currentPath.points.length;
            e > 2 &&
              (this.drawShape(this.currentPath),
              (this.currentPath = new qe()),
              (this.currentPath.closeStroke = !1),
              this.currentPath.points.push(t[e - 2], t[e - 1]));
          } else (this.currentPath = new qe()), (this.currentPath.closeStroke = !1);
        }),
        (r.prototype.finishPoly = function () {
          this.currentPath &&
            (this.currentPath.points.length > 2
              ? (this.drawShape(this.currentPath), (this.currentPath = null))
              : (this.currentPath.points.length = 0));
        }),
        (r.prototype.moveTo = function (t, e) {
          return (
            this.startPoly(),
            (this.currentPath.points[0] = t),
            (this.currentPath.points[1] = e),
            this
          );
        }),
        (r.prototype.lineTo = function (t, e) {
          this.currentPath || this.moveTo(0, 0);
          var r = this.currentPath.points,
            i = r[r.length - 2],
            n = r[r.length - 1];
          return (i === t && n === e) || r.push(t, e), this;
        }),
        (r.prototype._initCurve = function (t, e) {
          void 0 === t && (t = 0),
            void 0 === e && (e = 0),
            this.currentPath
              ? 0 === this.currentPath.points.length && (this.currentPath.points = [t, e])
              : this.moveTo(t, e);
        }),
        (r.prototype.quadraticCurveTo = function (t, e, r, i) {
          this._initCurve();
          var n = this.currentPath.points;
          return 0 === n.length && this.moveTo(0, 0), Ks.curveTo(t, e, r, i, n), this;
        }),
        (r.prototype.bezierCurveTo = function (t, e, r, i, n, o) {
          return this._initCurve(), qs.curveTo(t, e, r, i, n, o, this.currentPath.points), this;
        }),
        (r.prototype.arcTo = function (t, e, r, i, n) {
          this._initCurve(t, e);
          var o = this.currentPath.points,
            s = zs.curveTo(t, e, r, i, n, o);
          if (s) {
            var a = s.cx,
              h = s.cy,
              u = s.radius,
              l = s.startAngle,
              c = s.endAngle,
              d = s.anticlockwise;
            this.arc(a, h, u, l, c, d);
          }
          return this;
        }),
        (r.prototype.arc = function (t, e, r, i, n, o) {
          if ((void 0 === o && (o = !1), i === n)) return this;
          if ((!o && n <= i ? (n += Xe) : o && i <= n && (i += Xe), 0 == n - i)) return this;
          var s = t + Math.cos(i) * r,
            a = e + Math.sin(i) * r,
            h = this._geometry.closePointEps,
            u = this.currentPath ? this.currentPath.points : null;
          if (u) {
            var l = Math.abs(u[u.length - 2] - s),
              c = Math.abs(u[u.length - 1] - a);
            (l < h && c < h) || u.push(s, a);
          } else this.moveTo(s, a), (u = this.currentPath.points);
          return zs.arc(s, a, t, e, r, i, n, o, u), this;
        }),
        (r.prototype.beginFill = function (t, e) {
          return (
            void 0 === t && (t = 0),
            void 0 === e && (e = 1),
            this.beginTextureFill({ texture: Ri.WHITE, color: t, alpha: e })
          );
        }),
        (r.prototype.beginTextureFill = function (t) {
          (t = Object.assign({ texture: Ri.WHITE, color: 16777215, alpha: 1, matrix: null }, t)),
            this.currentPath && this.startPoly();
          var e = t.alpha > 0;
          return (
            e
              ? (t.matrix && ((t.matrix = t.matrix.clone()), t.matrix.invert()),
                Object.assign(this._fillStyle, { visible: e }, t))
              : this._fillStyle.reset(),
            this
          );
        }),
        (r.prototype.endFill = function () {
          return this.finishPoly(), this._fillStyle.reset(), this;
        }),
        (r.prototype.drawRect = function (t, e, r, i) {
          return this.drawShape(new Ve(t, e, r, i));
        }),
        (r.prototype.drawRoundedRect = function (t, e, r, i, n) {
          return this.drawShape(new Ke(t, e, r, i, n));
        }),
        (r.prototype.drawCircle = function (t, e, r) {
          return this.drawShape(new We(t, e, r));
        }),
        (r.prototype.drawEllipse = function (t, e, r, i) {
          return this.drawShape(new ze(t, e, r, i));
        }),
        (r.prototype.drawPolygon = function () {
          for (var t, e = arguments, r = [], i = 0; i < arguments.length; i++) r[i] = e[i];
          var n = !0,
            o = r[0];
          o.points ? ((n = o.closeStroke), (t = o.points)) : (t = Array.isArray(r[0]) ? r[0] : r);
          var s = new qe(t);
          return (s.closeStroke = n), this.drawShape(s), this;
        }),
        (r.prototype.drawShape = function (t) {
          return (
            this._holeMode
              ? this._geometry.drawHole(t, this._matrix)
              : this._geometry.drawShape(
                  t,
                  this._fillStyle.clone(),
                  this._lineStyle.clone(),
                  this._matrix
                ),
            this
          );
        }),
        (r.prototype.clear = function () {
          return (
            this._geometry.clear(),
            this._lineStyle.reset(),
            this._fillStyle.reset(),
            this._boundsID++,
            (this._matrix = null),
            (this._holeMode = !1),
            (this.currentPath = null),
            this
          );
        }),
        (r.prototype.isFastRect = function () {
          var e = this._geometry.graphicsData;
          return !(
            1 !== e.length ||
            e[0].shape.type !== t.SHAPES.RECT ||
            e[0].matrix ||
            e[0].holes.length ||
            (e[0].lineStyle.visible && e[0].lineStyle.width)
          );
        }),
        (r.prototype._render = function (t) {
          this.finishPoly();
          var e = this._geometry,
            r = t.context.supports.uint32Indices;
          e.updateBatches(r),
            e.batchable
              ? (this.batchDirty !== e.batchDirty && this._populateBatches(),
                this._renderBatched(t))
              : (t.batch.flush(), this._renderDirect(t));
        }),
        (r.prototype._populateBatches = function () {
          var t = this._geometry,
            e = this.blendMode,
            r = t.batches.length;
          (this.batchTint = -1),
            (this._transformID = -1),
            (this.batchDirty = t.batchDirty),
            (this.batches.length = r),
            (this.vertexData = new Float32Array(t.points));
          for (var i = 0; i < r; i++) {
            var n = t.batches[i],
              o = n.style.color,
              s = new Float32Array(this.vertexData.buffer, 4 * n.attribStart * 2, 2 * n.attribSize),
              a = new Float32Array(t.uvsFloat32.buffer, 4 * n.attribStart * 2, 2 * n.attribSize),
              h = {
                vertexData: s,
                blendMode: e,
                indices: new Uint16Array(t.indicesUint16.buffer, 2 * n.start, n.size),
                uvs: a,
                _batchRGB: ce(o),
                _tintRGB: o,
                _texture: n.style.texture,
                alpha: n.style.alpha,
                worldAlpha: 1,
              };
            this.batches[i] = h;
          }
        }),
        (r.prototype._renderBatched = function (t) {
          if (this.batches.length) {
            t.batch.setObjectRenderer(t.plugins[this.pluginName]),
              this.calculateVertices(),
              this.calculateTints();
            for (var e = 0, r = this.batches.length; e < r; e++) {
              var i = this.batches[e];
              (i.worldAlpha = this.worldAlpha * i.alpha), t.plugins[this.pluginName].render(i);
            }
          }
        }),
        (r.prototype._renderDirect = function (t) {
          var e = this._resolveDirectShader(t),
            r = this._geometry,
            i = this.tint,
            n = this.worldAlpha,
            o = e.uniforms,
            s = r.drawCalls;
          (o.translationMatrix = this.transform.worldTransform),
            (o.tint[0] = (((i >> 16) & 255) / 255) * n),
            (o.tint[1] = (((i >> 8) & 255) / 255) * n),
            (o.tint[2] = ((255 & i) / 255) * n),
            (o.tint[3] = n),
            t.shader.bind(e),
            t.geometry.bind(r, e),
            t.state.set(this.state);
          for (var a = 0, h = s.length; a < h; a++) this._renderDrawCallDirect(t, r.drawCalls[a]);
        }),
        (r.prototype._renderDrawCallDirect = function (t, e) {
          for (
            var r = e.texArray, i = e.type, n = e.size, o = e.start, s = r.count, a = 0;
            a < s;
            a++
          )
            t.texture.bind(r.elements[a], a);
          t.geometry.draw(i, n, o);
        }),
        (r.prototype._resolveDirectShader = function (t) {
          var e = this.shader,
            r = this.pluginName;
          if (!e) {
            if (!sa[r]) {
              for (var i = t.plugins.batch.MAX_TEXTURES, n = new Int32Array(i), o = 0; o < i; o++)
                n[o] = o;
              var s = {
                  tint: new Float32Array([1, 1, 1, 1]),
                  translationMatrix: new Qe(),
                  default: Ui.from({ uSamplers: n }, !0),
                },
                a = t.plugins[r]._shader.program;
              sa[r] = new bn(a, s);
            }
            e = sa[r];
          }
          return e;
        }),
        (r.prototype._calculateBounds = function () {
          this.finishPoly();
          var t = this._geometry;
          if (t.graphicsData.length) {
            var e = t.bounds,
              r = e.minX,
              i = e.minY,
              n = e.maxX,
              o = e.maxY;
            this._bounds.addFrame(this.transform, r, i, n, o);
          }
        }),
        (r.prototype.containsPoint = function (t) {
          return (
            this.worldTransform.applyInverse(t, r._TEMP_POINT),
            this._geometry.containsPoint(r._TEMP_POINT)
          );
        }),
        (r.prototype.calculateTints = function () {
          if (this.batchTint !== this.tint) {
            this.batchTint = this.tint;
            for (var t = ce(this.tint, oa), e = 0; e < this.batches.length; e++) {
              var r = this.batches[e],
                i = r._batchRGB,
                n =
                  ((t[0] * i[0] * 255) << 16) +
                  ((t[1] * i[1] * 255) << 8) +
                  (0 | (t[2] * i[2] * 255));
              r._tintRGB = (n >> 16) + (65280 & n) + ((255 & n) << 16);
            }
          }
        }),
        (r.prototype.calculateVertices = function () {
          var t = this.transform._worldID;
          if (this._transformID !== t) {
            this._transformID = t;
            for (
              var e = this.transform.worldTransform,
                r = e.a,
                i = e.b,
                n = e.c,
                o = e.d,
                s = e.tx,
                a = e.ty,
                h = this._geometry.points,
                u = this.vertexData,
                l = 0,
                c = 0;
              c < h.length;
              c += 2
            ) {
              var d = h[c],
                f = h[c + 1];
              (u[l++] = r * d + n * f + s), (u[l++] = o * f + i * d + a);
            }
          }
        }),
        (r.prototype.closePath = function () {
          var t = this.currentPath;
          return t && ((t.closeStroke = !0), this.finishPoly()), this;
        }),
        (r.prototype.setMatrix = function (t) {
          return (this._matrix = t), this;
        }),
        (r.prototype.beginHole = function () {
          return this.finishPoly(), (this._holeMode = !0), this;
        }),
        (r.prototype.endHole = function () {
          return this.finishPoly(), (this._holeMode = !1), this;
        }),
        (r.prototype.destroy = function (t) {
          this._geometry.refCount--,
            0 === this._geometry.refCount && this._geometry.dispose(),
            (this._matrix = null),
            (this.currentPath = null),
            this._lineStyle.destroy(),
            (this._lineStyle = null),
            this._fillStyle.destroy(),
            (this._fillStyle = null),
            (this._geometry = null),
            (this.shader = null),
            (this.vertexData = null),
            (this.batches.length = 0),
            (this.batches = null),
            e.prototype.destroy.call(this, t);
        }),
        (r.nextRoundedRectBehavior = !1),
        (r._TEMP_POINT = new Ye()),
        r
      );
    })(Dr),
    ha = {
      buildPoly: Us,
      buildCircle: Bs,
      buildRectangle: Gs,
      buildRoundedRectangle: Hs,
      buildLine: Vs,
      ArcUtils: zs,
      BezierUtils: qs,
      QuadraticUtils: Ks,
      BatchPart: Zs,
      FILL_COMMANDS: Qs,
      BATCH_POOL: Js,
      DRAW_CALL_POOL: $s,
    },
    ua = function (t, e) {
      return (ua =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    la = new Ye(),
    ca = new Uint16Array([0, 1, 2, 0, 2, 3]),
    da = (function (e) {
      function r(r) {
        var i = e.call(this) || this;
        return (
          (i._anchor = new Ze(
            i._onAnchorUpdate,
            i,
            r ? r.defaultAnchor.x : 0,
            r ? r.defaultAnchor.y : 0
          )),
          (i._texture = null),
          (i._width = 0),
          (i._height = 0),
          (i._tint = null),
          (i._tintRGB = null),
          (i.tint = 16777215),
          (i.blendMode = t.BLEND_MODES.NORMAL),
          (i._cachedTint = 16777215),
          (i.uvs = null),
          (i.texture = r || Ri.EMPTY),
          (i.vertexData = new Float32Array(8)),
          (i.vertexTrimmedData = null),
          (i._transformID = -1),
          (i._textureID = -1),
          (i._transformTrimmedID = -1),
          (i._textureTrimmedID = -1),
          (i.indices = ca),
          (i.pluginName = "batch"),
          (i.isSprite = !0),
          (i._roundPixels = rt.ROUND_PIXELS),
          i
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          ua(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(r, e),
        (r.prototype._onTextureUpdate = function () {
          (this._textureID = -1),
            (this._textureTrimmedID = -1),
            (this._cachedTint = 16777215),
            this._width &&
              (this.scale.x = (Se(this.scale.x) * this._width) / this._texture.orig.width),
            this._height &&
              (this.scale.y = (Se(this.scale.y) * this._height) / this._texture.orig.height);
        }),
        (r.prototype._onAnchorUpdate = function () {
          (this._transformID = -1), (this._transformTrimmedID = -1);
        }),
        (r.prototype.calculateVertices = function () {
          var t = this._texture;
          if (this._transformID !== this.transform._worldID || this._textureID !== t._updateID) {
            this._textureID !== t._updateID && (this.uvs = this._texture._uvs.uvsFloat32),
              (this._transformID = this.transform._worldID),
              (this._textureID = t._updateID);
            var e = this.transform.worldTransform,
              r = e.a,
              i = e.b,
              n = e.c,
              o = e.d,
              s = e.tx,
              a = e.ty,
              h = this.vertexData,
              u = t.trim,
              l = t.orig,
              c = this._anchor,
              d = 0,
              f = 0,
              p = 0,
              _ = 0;
            if (
              (u
                ? ((d = (f = u.x - c._x * l.width) + u.width),
                  (p = (_ = u.y - c._y * l.height) + u.height))
                : ((d = (f = -c._x * l.width) + l.width), (p = (_ = -c._y * l.height) + l.height)),
              (h[0] = r * f + n * _ + s),
              (h[1] = o * _ + i * f + a),
              (h[2] = r * d + n * _ + s),
              (h[3] = o * _ + i * d + a),
              (h[4] = r * d + n * p + s),
              (h[5] = o * p + i * d + a),
              (h[6] = r * f + n * p + s),
              (h[7] = o * p + i * f + a),
              this._roundPixels)
            )
              for (var m = rt.RESOLUTION, v = 0; v < h.length; ++v)
                h[v] = Math.round(((h[v] * m) | 0) / m);
          }
        }),
        (r.prototype.calculateTrimmedVertices = function () {
          if (this.vertexTrimmedData) {
            if (
              this._transformTrimmedID === this.transform._worldID &&
              this._textureTrimmedID === this._texture._updateID
            )
              return;
          } else this.vertexTrimmedData = new Float32Array(8);
          (this._transformTrimmedID = this.transform._worldID),
            (this._textureTrimmedID = this._texture._updateID);
          var t = this._texture,
            e = this.vertexTrimmedData,
            r = t.orig,
            i = this._anchor,
            n = this.transform.worldTransform,
            o = n.a,
            s = n.b,
            a = n.c,
            h = n.d,
            u = n.tx,
            l = n.ty,
            c = -i._x * r.width,
            d = c + r.width,
            f = -i._y * r.height,
            p = f + r.height;
          (e[0] = o * c + a * f + u),
            (e[1] = h * f + s * c + l),
            (e[2] = o * d + a * f + u),
            (e[3] = h * f + s * d + l),
            (e[4] = o * d + a * p + u),
            (e[5] = h * p + s * d + l),
            (e[6] = o * c + a * p + u),
            (e[7] = h * p + s * c + l);
        }),
        (r.prototype._render = function (t) {
          this.calculateVertices(),
            t.batch.setObjectRenderer(t.plugins[this.pluginName]),
            t.plugins[this.pluginName].render(this);
        }),
        (r.prototype._calculateBounds = function () {
          var t = this._texture.trim,
            e = this._texture.orig;
          !t || (t.width === e.width && t.height === e.height)
            ? (this.calculateVertices(), this._bounds.addQuad(this.vertexData))
            : (this.calculateTrimmedVertices(), this._bounds.addQuad(this.vertexTrimmedData));
        }),
        (r.prototype.getLocalBounds = function (t) {
          return 0 === this.children.length
            ? (this._localBounds || (this._localBounds = new ar()),
              (this._localBounds.minX = this._texture.orig.width * -this._anchor._x),
              (this._localBounds.minY = this._texture.orig.height * -this._anchor._y),
              (this._localBounds.maxX = this._texture.orig.width * (1 - this._anchor._x)),
              (this._localBounds.maxY = this._texture.orig.height * (1 - this._anchor._y)),
              t ||
                (this._localBoundsRect || (this._localBoundsRect = new Ve()),
                (t = this._localBoundsRect)),
              this._localBounds.getRectangle(t))
            : e.prototype.getLocalBounds.call(this, t);
        }),
        (r.prototype.containsPoint = function (t) {
          this.worldTransform.applyInverse(t, la);
          var e = this._texture.orig.width,
            r = this._texture.orig.height,
            i = -e * this.anchor.x,
            n = 0;
          return la.x >= i && la.x < i + e && ((n = -r * this.anchor.y), la.y >= n && la.y < n + r);
        }),
        (r.prototype.destroy = function (t) {
          if (
            (e.prototype.destroy.call(this, t),
            this._texture.off("update", this._onTextureUpdate, this),
            (this._anchor = null),
            "boolean" == typeof t ? t : t && t.texture)
          ) {
            var r = "boolean" == typeof t ? t : t && t.baseTexture;
            this._texture.destroy(!!r);
          }
          this._texture = null;
        }),
        (r.from = function (t, e) {
          return new r(t instanceof Ri ? t : Ri.from(t, e));
        }),
        Object.defineProperty(r.prototype, "roundPixels", {
          get: function () {
            return this._roundPixels;
          },
          set: function (t) {
            this._roundPixels !== t && (this._transformID = -1), (this._roundPixels = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "width", {
          get: function () {
            return Math.abs(this.scale.x) * this._texture.orig.width;
          },
          set: function (t) {
            var e = Se(this.scale.x) || 1;
            (this.scale.x = (e * t) / this._texture.orig.width), (this._width = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "height", {
          get: function () {
            return Math.abs(this.scale.y) * this._texture.orig.height;
          },
          set: function (t) {
            var e = Se(this.scale.y) || 1;
            (this.scale.y = (e * t) / this._texture.orig.height), (this._height = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "anchor", {
          get: function () {
            return this._anchor;
          },
          set: function (t) {
            this._anchor.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "tint", {
          get: function () {
            return this._tint;
          },
          set: function (t) {
            (this._tint = t), (this._tintRGB = (t >> 16) + (65280 & t) + ((255 & t) << 16));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "texture", {
          get: function () {
            return this._texture;
          },
          set: function (t) {
            this._texture !== t &&
              (this._texture && this._texture.off("update", this._onTextureUpdate, this),
              (this._texture = t || Ri.EMPTY),
              (this._cachedTint = 16777215),
              (this._textureID = -1),
              (this._textureTrimmedID = -1),
              t &&
                (t.baseTexture.valid
                  ? this._onTextureUpdate()
                  : t.once("update", this._onTextureUpdate, this)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        r
      );
    })(Dr),
    fa = function (t, e) {
      return (fa =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  !(function (t) {
    (t[(t.LINEAR_VERTICAL = 0)] = "LINEAR_VERTICAL"),
      (t[(t.LINEAR_HORIZONTAL = 1)] = "LINEAR_HORIZONTAL");
  })(t.TEXT_GRADIENT || (t.TEXT_GRADIENT = {}));
  var pa = {
      align: "left",
      breakWords: !1,
      dropShadow: !1,
      dropShadowAlpha: 1,
      dropShadowAngle: Math.PI / 6,
      dropShadowBlur: 0,
      dropShadowColor: "black",
      dropShadowDistance: 5,
      fill: "black",
      fillGradientType: t.TEXT_GRADIENT.LINEAR_VERTICAL,
      fillGradientStops: [],
      fontFamily: "Arial",
      fontSize: 26,
      fontStyle: "normal",
      fontVariant: "normal",
      fontWeight: "normal",
      letterSpacing: 0,
      lineHeight: 0,
      lineJoin: "miter",
      miterLimit: 10,
      padding: 0,
      stroke: "black",
      strokeThickness: 0,
      textBaseline: "alphabetic",
      trim: !1,
      whiteSpace: "pre",
      wordWrap: !1,
      wordWrapWidth: 100,
      leading: 0,
    },
    _a = ["serif", "sans-serif", "monospace", "cursive", "fantasy", "system-ui"],
    ma = (function () {
      function t(t) {
        (this.styleID = 0), this.reset(), Ta(this, t, t);
      }
      return (
        (t.prototype.clone = function () {
          var e = {};
          return Ta(e, this, pa), new t(e);
        }),
        (t.prototype.reset = function () {
          Ta(this, pa, pa);
        }),
        Object.defineProperty(t.prototype, "align", {
          get: function () {
            return this._align;
          },
          set: function (t) {
            this._align !== t && ((this._align = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "breakWords", {
          get: function () {
            return this._breakWords;
          },
          set: function (t) {
            this._breakWords !== t && ((this._breakWords = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "dropShadow", {
          get: function () {
            return this._dropShadow;
          },
          set: function (t) {
            this._dropShadow !== t && ((this._dropShadow = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "dropShadowAlpha", {
          get: function () {
            return this._dropShadowAlpha;
          },
          set: function (t) {
            this._dropShadowAlpha !== t && ((this._dropShadowAlpha = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "dropShadowAngle", {
          get: function () {
            return this._dropShadowAngle;
          },
          set: function (t) {
            this._dropShadowAngle !== t && ((this._dropShadowAngle = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "dropShadowBlur", {
          get: function () {
            return this._dropShadowBlur;
          },
          set: function (t) {
            this._dropShadowBlur !== t && ((this._dropShadowBlur = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "dropShadowColor", {
          get: function () {
            return this._dropShadowColor;
          },
          set: function (t) {
            var e = Ea(t);
            this._dropShadowColor !== e && ((this._dropShadowColor = e), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "dropShadowDistance", {
          get: function () {
            return this._dropShadowDistance;
          },
          set: function (t) {
            this._dropShadowDistance !== t && ((this._dropShadowDistance = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fill", {
          get: function () {
            return this._fill;
          },
          set: function (t) {
            var e = Ea(t);
            this._fill !== e && ((this._fill = e), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fillGradientType", {
          get: function () {
            return this._fillGradientType;
          },
          set: function (t) {
            this._fillGradientType !== t && ((this._fillGradientType = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fillGradientStops", {
          get: function () {
            return this._fillGradientStops;
          },
          set: function (t) {
            (function (t, e) {
              if (!Array.isArray(t) || !Array.isArray(e)) return !1;
              if (t.length !== e.length) return !1;
              for (var r = 0; r < t.length; ++r) if (t[r] !== e[r]) return !1;
              return !0;
            })(this._fillGradientStops, t) || ((this._fillGradientStops = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fontFamily", {
          get: function () {
            return this._fontFamily;
          },
          set: function (t) {
            this.fontFamily !== t && ((this._fontFamily = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fontSize", {
          get: function () {
            return this._fontSize;
          },
          set: function (t) {
            this._fontSize !== t && ((this._fontSize = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fontStyle", {
          get: function () {
            return this._fontStyle;
          },
          set: function (t) {
            this._fontStyle !== t && ((this._fontStyle = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fontVariant", {
          get: function () {
            return this._fontVariant;
          },
          set: function (t) {
            this._fontVariant !== t && ((this._fontVariant = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "fontWeight", {
          get: function () {
            return this._fontWeight;
          },
          set: function (t) {
            this._fontWeight !== t && ((this._fontWeight = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "letterSpacing", {
          get: function () {
            return this._letterSpacing;
          },
          set: function (t) {
            this._letterSpacing !== t && ((this._letterSpacing = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "lineHeight", {
          get: function () {
            return this._lineHeight;
          },
          set: function (t) {
            this._lineHeight !== t && ((this._lineHeight = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "leading", {
          get: function () {
            return this._leading;
          },
          set: function (t) {
            this._leading !== t && ((this._leading = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "lineJoin", {
          get: function () {
            return this._lineJoin;
          },
          set: function (t) {
            this._lineJoin !== t && ((this._lineJoin = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "miterLimit", {
          get: function () {
            return this._miterLimit;
          },
          set: function (t) {
            this._miterLimit !== t && ((this._miterLimit = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "padding", {
          get: function () {
            return this._padding;
          },
          set: function (t) {
            this._padding !== t && ((this._padding = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "stroke", {
          get: function () {
            return this._stroke;
          },
          set: function (t) {
            var e = Ea(t);
            this._stroke !== e && ((this._stroke = e), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "strokeThickness", {
          get: function () {
            return this._strokeThickness;
          },
          set: function (t) {
            this._strokeThickness !== t && ((this._strokeThickness = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "textBaseline", {
          get: function () {
            return this._textBaseline;
          },
          set: function (t) {
            this._textBaseline !== t && ((this._textBaseline = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "trim", {
          get: function () {
            return this._trim;
          },
          set: function (t) {
            this._trim !== t && ((this._trim = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "whiteSpace", {
          get: function () {
            return this._whiteSpace;
          },
          set: function (t) {
            this._whiteSpace !== t && ((this._whiteSpace = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "wordWrap", {
          get: function () {
            return this._wordWrap;
          },
          set: function (t) {
            this._wordWrap !== t && ((this._wordWrap = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "wordWrapWidth", {
          get: function () {
            return this._wordWrapWidth;
          },
          set: function (t) {
            this._wordWrapWidth !== t && ((this._wordWrapWidth = t), this.styleID++);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.toFontString = function () {
          var t = "number" == typeof this.fontSize ? this.fontSize + "px" : this.fontSize,
            e = this.fontFamily;
          Array.isArray(this.fontFamily) || (e = this.fontFamily.split(","));
          for (var r = e.length - 1; r >= 0; r--) {
            var i = e[r].trim();
            !/([\"\'])[^\'\"]+\1/.test(i) && _a.indexOf(i) < 0 && (i = '"' + i + '"'), (e[r] = i);
          }
          return (
            this.fontStyle +
            " " +
            this.fontVariant +
            " " +
            this.fontWeight +
            " " +
            t +
            " " +
            e.join(",")
          );
        }),
        t
      );
    })();
  function va(t) {
    return "number" == typeof t
      ? de(t)
      : ("string" == typeof t && 0 === t.indexOf("0x") && (t = t.replace("0x", "#")), t);
  }
  function Ea(t) {
    if (Array.isArray(t)) {
      for (var e = 0; e < t.length; ++e) t[e] = va(t[e]);
      return t;
    }
    return va(t);
  }
  function Ta(t, e, r) {
    for (var i in r) Array.isArray(e[i]) ? (t[i] = e[i].slice()) : (t[i] = e[i]);
  }
  var ya = (function () {
      function t(t, e, r, i, n, o, s, a, h) {
        (this.text = t),
          (this.style = e),
          (this.width = r),
          (this.height = i),
          (this.lines = n),
          (this.lineWidths = o),
          (this.lineHeight = s),
          (this.maxLineWidth = a),
          (this.fontProperties = h);
      }
      return (
        (t.measureText = function (e, r, i, n) {
          void 0 === n && (n = t._canvas), (i = null == i ? r.wordWrap : i);
          var o = r.toFontString(),
            s = t.measureFont(o);
          0 === s.fontSize && ((s.fontSize = r.fontSize), (s.ascent = r.fontSize));
          var a = n.getContext("2d");
          a.font = o;
          for (
            var h = (i ? t.wordWrap(e, r, n) : e).split(/(?:\r\n|\r|\n)/),
              u = new Array(h.length),
              l = 0,
              c = 0;
            c < h.length;
            c++
          ) {
            var d = a.measureText(h[c]).width + (h[c].length - 1) * r.letterSpacing;
            (u[c] = d), (l = Math.max(l, d));
          }
          var f = l + r.strokeThickness;
          r.dropShadow && (f += r.dropShadowDistance);
          var p = r.lineHeight || s.fontSize + r.strokeThickness,
            _ = Math.max(p, s.fontSize + r.strokeThickness) + (h.length - 1) * (p + r.leading);
          return (
            r.dropShadow && (_ += r.dropShadowDistance),
            new t(e, r, f, _, h, u, p + r.leading, l, s)
          );
        }),
        (t.wordWrap = function (e, r, i) {
          void 0 === i && (i = t._canvas);
          for (
            var n = i.getContext("2d"),
              o = 0,
              s = "",
              a = "",
              h = Object.create(null),
              u = r.letterSpacing,
              l = r.whiteSpace,
              c = t.collapseSpaces(l),
              d = t.collapseNewlines(l),
              f = !c,
              p = r.wordWrapWidth + u,
              _ = t.tokenize(e),
              m = 0;
            m < _.length;
            m++
          ) {
            var v = _[m];
            if (t.isNewline(v)) {
              if (!d) {
                (a += t.addLine(s)), (f = !c), (s = ""), (o = 0);
                continue;
              }
              v = " ";
            }
            if (c) {
              var E = t.isBreakingSpace(v),
                T = t.isBreakingSpace(s[s.length - 1]);
              if (E && T) continue;
            }
            var y = t.getFromCache(v, u, h, n);
            if (y > p)
              if (
                ("" !== s && ((a += t.addLine(s)), (s = ""), (o = 0)),
                t.canBreakWords(v, r.breakWords))
              )
                for (var g = t.wordWrapSplit(v), R = 0; R < g.length; R++) {
                  for (var b = g[R], A = 1; g[R + A]; ) {
                    var x = g[R + A],
                      S = b[b.length - 1];
                    if (t.canBreakChars(S, x, v, R, r.breakWords)) break;
                    (b += x), A++;
                  }
                  R += b.length - 1;
                  var O = t.getFromCache(b, u, h, n);
                  O + o > p && ((a += t.addLine(s)), (f = !1), (s = ""), (o = 0)),
                    (s += b),
                    (o += O);
                }
              else {
                s.length > 0 && ((a += t.addLine(s)), (s = ""), (o = 0));
                var I = m === _.length - 1;
                (a += t.addLine(v, !I)), (f = !1), (s = ""), (o = 0);
              }
            else
              y + o > p && ((f = !1), (a += t.addLine(s)), (s = ""), (o = 0)),
                (s.length > 0 || !t.isBreakingSpace(v) || f) && ((s += v), (o += y));
          }
          return a + t.addLine(s, !1);
        }),
        (t.addLine = function (e, r) {
          return void 0 === r && (r = !0), (e = t.trimRight(e)), r ? e + "\n" : e;
        }),
        (t.getFromCache = function (t, e, r, i) {
          var n = r[t];
          if ("number" != typeof n) {
            var o = t.length * e;
            (n = i.measureText(t).width + o), (r[t] = n);
          }
          return n;
        }),
        (t.collapseSpaces = function (t) {
          return "normal" === t || "pre-line" === t;
        }),
        (t.collapseNewlines = function (t) {
          return "normal" === t;
        }),
        (t.trimRight = function (e) {
          if ("string" != typeof e) return "";
          for (var r = e.length - 1; r >= 0; r--) {
            var i = e[r];
            if (!t.isBreakingSpace(i)) break;
            e = e.slice(0, -1);
          }
          return e;
        }),
        (t.isNewline = function (e) {
          return "string" == typeof e && t._newlines.indexOf(e.charCodeAt(0)) >= 0;
        }),
        (t.isBreakingSpace = function (e, r) {
          return "string" == typeof e && t._breakingSpaces.indexOf(e.charCodeAt(0)) >= 0;
        }),
        (t.tokenize = function (e) {
          var r = [],
            i = "";
          if ("string" != typeof e) return r;
          for (var n = 0; n < e.length; n++) {
            var o = e[n],
              s = e[n + 1];
            t.isBreakingSpace(o, s) || t.isNewline(o)
              ? ("" !== i && (r.push(i), (i = "")), r.push(o))
              : (i += o);
          }
          return "" !== i && r.push(i), r;
        }),
        (t.canBreakWords = function (t, e) {
          return e;
        }),
        (t.canBreakChars = function (t, e, r, i, n) {
          return !0;
        }),
        (t.wordWrapSplit = function (t) {
          return t.split("");
        }),
        (t.measureFont = function (e) {
          if (t._fonts[e]) return t._fonts[e];
          var r = { ascent: 0, descent: 0, fontSize: 0 },
            i = t._canvas,
            n = t._context;
          n.font = e;
          var o = t.METRICS_STRING + t.BASELINE_SYMBOL,
            s = Math.ceil(n.measureText(o).width),
            a = Math.ceil(n.measureText(t.BASELINE_SYMBOL).width),
            h = Math.ceil(t.HEIGHT_MULTIPLIER * a);
          (a = (a * t.BASELINE_MULTIPLIER) | 0),
            (i.width = s),
            (i.height = h),
            (n.fillStyle = "#f00"),
            n.fillRect(0, 0, s, h),
            (n.font = e),
            (n.textBaseline = "alphabetic"),
            (n.fillStyle = "#000"),
            n.fillText(o, 0, a);
          var u = n.getImageData(0, 0, s, h).data,
            l = u.length,
            c = 4 * s,
            d = 0,
            f = 0,
            p = !1;
          for (d = 0; d < a; ++d) {
            for (var _ = 0; _ < c; _ += 4)
              if (255 !== u[f + _]) {
                p = !0;
                break;
              }
            if (p) break;
            f += c;
          }
          for (r.ascent = a - d, f = l - c, p = !1, d = h; d > a; --d) {
            for (_ = 0; _ < c; _ += 4)
              if (255 !== u[f + _]) {
                p = !0;
                break;
              }
            if (p) break;
            f -= c;
          }
          return (r.descent = d - a), (r.fontSize = r.ascent + r.descent), (t._fonts[e] = r), r;
        }),
        (t.clearMetrics = function (e) {
          void 0 === e && (e = ""), e ? delete t._fonts[e] : (t._fonts = {});
        }),
        t
      );
    })(),
    ga = (function () {
      try {
        var t = new OffscreenCanvas(0, 0),
          e = t.getContext("2d");
        return e && e.measureText ? t : document.createElement("canvas");
      } catch (t) {
        return document.createElement("canvas");
      }
    })();
  (ga.width = ga.height = 10),
    (ya._canvas = ga),
    (ya._context = ga.getContext("2d")),
    (ya._fonts = {}),
    (ya.METRICS_STRING = "|q"),
    (ya.BASELINE_SYMBOL = "M"),
    (ya.BASELINE_MULTIPLIER = 1.4),
    (ya.HEIGHT_MULTIPLIER = 2),
    (ya._newlines = [10, 13]),
    (ya._breakingSpaces = [
      9, 32, 8192, 8193, 8194, 8195, 8196, 8197, 8198, 8200, 8201, 8202, 8287, 12288,
    ]);
  var Ra = { texture: !0, children: !1, baseTexture: !0 },
    ba = (function (e) {
      function r(t, r, i) {
        var n = this,
          o = !1;
        i || ((i = document.createElement("canvas")), (o = !0)), (i.width = 3), (i.height = 3);
        var s = Ri.from(i);
        return (
          (s.orig = new Ve()),
          (s.trim = new Ve()),
          ((n = e.call(this, s) || this)._ownCanvas = o),
          (n.canvas = i),
          (n.context = n.canvas.getContext("2d")),
          (n._resolution = rt.RESOLUTION),
          (n._autoResolution = !0),
          (n._text = null),
          (n._style = null),
          (n._styleListener = null),
          (n._font = ""),
          (n.text = t),
          (n.style = r),
          (n.localStyleID = -1),
          n
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          fa(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(r, e),
        (r.prototype.updateText = function (t) {
          var e = this._style;
          if (
            (this.localStyleID !== e.styleID &&
              ((this.dirty = !0), (this.localStyleID = e.styleID)),
            this.dirty || !t)
          ) {
            this._font = this._style.toFontString();
            var i,
              n,
              o = this.context,
              s = ya.measureText(this._text || " ", this._style, this._style.wordWrap, this.canvas),
              a = s.width,
              h = s.height,
              u = s.lines,
              l = s.lineHeight,
              c = s.lineWidths,
              d = s.maxLineWidth,
              f = s.fontProperties;
            (this.canvas.width = Math.ceil(
              Math.ceil(Math.max(1, a) + 2 * e.padding) * this._resolution
            )),
              (this.canvas.height = Math.ceil(
                Math.ceil(Math.max(1, h) + 2 * e.padding) * this._resolution
              )),
              o.scale(this._resolution, this._resolution),
              o.clearRect(0, 0, this.canvas.width, this.canvas.height),
              (o.font = this._font),
              (o.lineWidth = e.strokeThickness),
              (o.textBaseline = e.textBaseline),
              (o.lineJoin = e.lineJoin),
              (o.miterLimit = e.miterLimit);
            for (var p = e.dropShadow ? 2 : 1, _ = 0; _ < p; ++_) {
              var m = e.dropShadow && 0 === _,
                v = m ? Math.ceil(Math.max(1, h) + 2 * e.padding) : 0,
                E = v * this._resolution;
              if (m) {
                (o.fillStyle = "black"), (o.strokeStyle = "black");
                var T = e.dropShadowColor,
                  y = ce("number" == typeof T ? T : fe(T)),
                  g = e.dropShadowBlur * this._resolution,
                  R = e.dropShadowDistance * this._resolution;
                (o.shadowColor =
                  "rgba(" +
                  255 * y[0] +
                  "," +
                  255 * y[1] +
                  "," +
                  255 * y[2] +
                  "," +
                  e.dropShadowAlpha +
                  ")"),
                  (o.shadowBlur = g),
                  (o.shadowOffsetX = Math.cos(e.dropShadowAngle) * R),
                  (o.shadowOffsetY = Math.sin(e.dropShadowAngle) * R + E);
              } else
                (o.fillStyle = this._generateFillStyle(e, u, s)),
                  (o.strokeStyle = e.stroke),
                  (o.shadowColor = "black"),
                  (o.shadowBlur = 0),
                  (o.shadowOffsetX = 0),
                  (o.shadowOffsetY = 0);
              var b = (l - f.fontSize) / 2;
              (!r.nextLineHeightBehavior || l - f.fontSize < 0) && (b = 0);
              for (var A = 0; A < u.length; A++)
                (i = e.strokeThickness / 2),
                  (n = e.strokeThickness / 2 + A * l + f.ascent + b),
                  "right" === e.align
                    ? (i += d - c[A])
                    : "center" === e.align && (i += (d - c[A]) / 2),
                  e.stroke &&
                    e.strokeThickness &&
                    this.drawLetterSpacing(u[A], i + e.padding, n + e.padding - v, !0),
                  e.fill && this.drawLetterSpacing(u[A], i + e.padding, n + e.padding - v);
            }
            this.updateTexture();
          }
        }),
        (r.prototype.drawLetterSpacing = function (t, e, i, n) {
          void 0 === n && (n = !1);
          var o = this._style.letterSpacing,
            s =
              r.experimentalLetterSpacing &&
              ("letterSpacing" in CanvasRenderingContext2D.prototype ||
                "textLetterSpacing" in CanvasRenderingContext2D.prototype);
          if (0 === o || s)
            return (
              s && ((this.context.letterSpacing = o), (this.context.textLetterSpacing = o)),
              void (n ? this.context.strokeText(t, e, i) : this.context.fillText(t, e, i))
            );
          for (
            var a = e,
              h = Array.from ? Array.from(t) : t.split(""),
              u = this.context.measureText(t).width,
              l = 0,
              c = 0;
            c < h.length;
            ++c
          ) {
            var d = h[c];
            n ? this.context.strokeText(d, a, i) : this.context.fillText(d, a, i);
            for (var f = "", p = c + 1; p < h.length; ++p) f += h[p];
            (a += u - (l = this.context.measureText(f).width) + o), (u = l);
          }
        }),
        (r.prototype.updateTexture = function () {
          var t = this.canvas;
          if (this._style.trim) {
            var e = Le(t);
            e.data &&
              ((t.width = e.width), (t.height = e.height), this.context.putImageData(e.data, 0, 0));
          }
          var r = this._texture,
            i = this._style,
            n = i.trim ? 0 : i.padding,
            o = r.baseTexture;
          (r.trim.width = r._frame.width = t.width / this._resolution),
            (r.trim.height = r._frame.height = t.height / this._resolution),
            (r.trim.x = -n),
            (r.trim.y = -n),
            (r.orig.width = r._frame.width - 2 * n),
            (r.orig.height = r._frame.height - 2 * n),
            this._onTextureUpdate(),
            o.setRealSize(t.width, t.height, this._resolution),
            r.updateUvs(),
            this._recursivePostUpdateTransform(),
            (this.dirty = !1);
        }),
        (r.prototype._render = function (t) {
          this._autoResolution &&
            this._resolution !== t.resolution &&
            ((this._resolution = t.resolution), (this.dirty = !0)),
            this.updateText(!0),
            e.prototype._render.call(this, t);
        }),
        (r.prototype.getLocalBounds = function (t) {
          return this.updateText(!0), e.prototype.getLocalBounds.call(this, t);
        }),
        (r.prototype._calculateBounds = function () {
          this.updateText(!0), this.calculateVertices(), this._bounds.addQuad(this.vertexData);
        }),
        (r.prototype._generateFillStyle = function (e, r, i) {
          var n,
            o = e.fill;
          if (!Array.isArray(o)) return o;
          if (1 === o.length) return o[0];
          var s = e.dropShadow ? e.dropShadowDistance : 0,
            a = e.padding || 0,
            h = this.canvas.width / this._resolution - s - 2 * a,
            u = this.canvas.height / this._resolution - s - 2 * a,
            l = o.slice(),
            c = e.fillGradientStops.slice();
          if (!c.length) for (var d = l.length + 1, f = 1; f < d; ++f) c.push(f / d);
          if (
            (l.unshift(o[0]),
            c.unshift(0),
            l.push(o[o.length - 1]),
            c.push(1),
            e.fillGradientType === t.TEXT_GRADIENT.LINEAR_VERTICAL)
          ) {
            n = this.context.createLinearGradient(h / 2, a, h / 2, u + a);
            var p = i.fontProperties.fontSize + e.strokeThickness;
            for (f = 0; f < r.length; f++) {
              var _ = i.lineHeight * (f - 1) + p,
                m = i.lineHeight * f,
                v = m;
              f > 0 && _ > m && (v = (m + _) / 2);
              var E = m + p,
                T = i.lineHeight * (f + 1),
                y = E;
              f + 1 < r.length && T < E && (y = (E + T) / 2);
              for (var g = (y - v) / u, R = 0; R < l.length; R++) {
                var b;
                b = "number" == typeof c[R] ? c[R] : R / l.length;
                var A = Math.min(1, Math.max(0, v / u + b * g));
                (A = Number(A.toFixed(5))), n.addColorStop(A, l[R]);
              }
            }
          } else {
            n = this.context.createLinearGradient(a, u / 2, h + a, u / 2);
            var x = l.length + 1,
              S = 1;
            for (f = 0; f < l.length; f++) {
              var O;
              (O = "number" == typeof c[f] ? c[f] : S / x), n.addColorStop(O, l[f]), S++;
            }
          }
          return n;
        }),
        (r.prototype.destroy = function (t) {
          "boolean" == typeof t && (t = { children: t }),
            (t = Object.assign({}, Ra, t)),
            e.prototype.destroy.call(this, t),
            this._ownCanvas && (this.canvas.height = this.canvas.width = 0),
            (this.context = null),
            (this.canvas = null),
            (this._style = null);
        }),
        Object.defineProperty(r.prototype, "width", {
          get: function () {
            return this.updateText(!0), Math.abs(this.scale.x) * this._texture.orig.width;
          },
          set: function (t) {
            this.updateText(!0);
            var e = Se(this.scale.x) || 1;
            (this.scale.x = (e * t) / this._texture.orig.width), (this._width = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "height", {
          get: function () {
            return this.updateText(!0), Math.abs(this.scale.y) * this._texture.orig.height;
          },
          set: function (t) {
            this.updateText(!0);
            var e = Se(this.scale.y) || 1;
            (this.scale.y = (e * t) / this._texture.orig.height), (this._height = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "style", {
          get: function () {
            return this._style;
          },
          set: function (t) {
            (t = t || {}),
              (this._style = t instanceof ma ? t : new ma(t)),
              (this.localStyleID = -1),
              (this.dirty = !0);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "text", {
          get: function () {
            return this._text;
          },
          set: function (t) {
            (t = String(null == t ? "" : t)),
              this._text !== t && ((this._text = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "resolution", {
          get: function () {
            return this._resolution;
          },
          set: function (t) {
            (this._autoResolution = !1),
              this._resolution !== t && ((this._resolution = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.nextLineHeightBehavior = !1),
        (r.experimentalLetterSpacing = !1),
        r
      );
    })(da);
  rt.UPLOADS_PER_FRAME = 4;
  var Aa = function (t, e) {
      return (Aa =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    xa = (function () {
      function t(t) {
        (this.maxItemsPerFrame = t), (this.itemsLeft = 0);
      }
      return (
        (t.prototype.beginFrame = function () {
          this.itemsLeft = this.maxItemsPerFrame;
        }),
        (t.prototype.allowedToUpload = function () {
          return this.itemsLeft-- > 0;
        }),
        t
      );
    })();
  function Sa(t, e) {
    var r = !1;
    if (t && t._textures && t._textures.length)
      for (var i = 0; i < t._textures.length; i++)
        if (t._textures[i] instanceof Ri) {
          var n = t._textures[i].baseTexture;
          -1 === e.indexOf(n) && (e.push(n), (r = !0));
        }
    return r;
  }
  function Oa(t, e) {
    if (t.baseTexture instanceof si) {
      var r = t.baseTexture;
      return -1 === e.indexOf(r) && e.push(r), !0;
    }
    return !1;
  }
  function Ia(t, e) {
    if (t._texture && t._texture instanceof Ri) {
      var r = t._texture.baseTexture;
      return -1 === e.indexOf(r) && e.push(r), !0;
    }
    return !1;
  }
  function Pa(t, e) {
    return e instanceof ba && (e.updateText(!0), !0);
  }
  function Ma(t, e) {
    if (e instanceof ma) {
      var r = e.toFontString();
      return ya.measureFont(r), !0;
    }
    return !1;
  }
  function Na(t, e) {
    if (t instanceof ba) {
      -1 === e.indexOf(t.style) && e.push(t.style), -1 === e.indexOf(t) && e.push(t);
      var r = t._texture.baseTexture;
      return -1 === e.indexOf(r) && e.push(r), !0;
    }
    return !1;
  }
  function Da(t, e) {
    return t instanceof ma && (-1 === e.indexOf(t) && e.push(t), !0);
  }
  var Ca = (function () {
    function e(t) {
      var e = this;
      (this.limiter = new xa(rt.UPLOADS_PER_FRAME)),
        (this.renderer = t),
        (this.uploadHookHelper = null),
        (this.queue = []),
        (this.addHooks = []),
        (this.uploadHooks = []),
        (this.completes = []),
        (this.ticking = !1),
        (this.delayedTick = function () {
          e.queue && e.prepareItems();
        }),
        this.registerFindHook(Na),
        this.registerFindHook(Da),
        this.registerFindHook(Sa),
        this.registerFindHook(Oa),
        this.registerFindHook(Ia),
        this.registerUploadHook(Pa),
        this.registerUploadHook(Ma);
    }
    return (
      (e.prototype.upload = function (e, r) {
        "function" == typeof e && ((r = e), (e = null)),
          e && this.add(e),
          this.queue.length
            ? (r && this.completes.push(r),
              this.ticking ||
                ((this.ticking = !0),
                Xr.system.addOnce(this.tick, this, t.UPDATE_PRIORITY.UTILITY)))
            : r && r();
      }),
      (e.prototype.tick = function () {
        setTimeout(this.delayedTick, 0);
      }),
      (e.prototype.prepareItems = function () {
        for (this.limiter.beginFrame(); this.queue.length && this.limiter.allowedToUpload(); ) {
          var e = this.queue[0],
            r = !1;
          if (e && !e._destroyed)
            for (var i = 0, n = this.uploadHooks.length; i < n; i++)
              if (this.uploadHooks[i](this.uploadHookHelper, e)) {
                this.queue.shift(), (r = !0);
                break;
              }
          r || this.queue.shift();
        }
        if (this.queue.length) Xr.system.addOnce(this.tick, this, t.UPDATE_PRIORITY.UTILITY);
        else {
          this.ticking = !1;
          var o = this.completes.slice(0);
          for (this.completes.length = 0, i = 0, n = o.length; i < n; i++) o[i]();
        }
      }),
      (e.prototype.registerFindHook = function (t) {
        return t && this.addHooks.push(t), this;
      }),
      (e.prototype.registerUploadHook = function (t) {
        return t && this.uploadHooks.push(t), this;
      }),
      (e.prototype.add = function (t) {
        for (var e = 0, r = this.addHooks.length; e < r && !this.addHooks[e](t, this.queue); e++);
        if (t instanceof Dr) for (e = t.children.length - 1; e >= 0; e--) this.add(t.children[e]);
        return this;
      }),
      (e.prototype.destroy = function () {
        this.ticking && Xr.system.remove(this.tick, this),
          (this.ticking = !1),
          (this.addHooks = null),
          (this.uploadHooks = null),
          (this.renderer = null),
          (this.completes = null),
          (this.queue = null),
          (this.limiter = null),
          (this.uploadHookHelper = null);
      }),
      e
    );
  })();
  function La(t, e) {
    return e instanceof si && (e._glTextures[t.CONTEXT_UID] || t.texture.bind(e), !0);
  }
  function wa(t, e) {
    if (!(e instanceof aa)) return !1;
    var r = e.geometry;
    e.finishPoly(), r.updateBatches();
    for (var i = r.batches, n = 0; n < i.length; n++) {
      var o = i[n].style.texture;
      o && La(t, o.baseTexture);
    }
    return r.batchable || t.geometry.bind(r, e._resolveDirectShader(t)), !0;
  }
  function Fa(t, e) {
    return t instanceof aa && (e.push(t), !0);
  }
  var Ua = (function (t) {
      function e(e) {
        var r = t.call(this, e) || this;
        return (
          (r.uploadHookHelper = r.renderer),
          r.registerFindHook(Fa),
          r.registerUploadHook(La),
          r.registerUploadHook(wa),
          r
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          Aa(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(e, t),
        e
      );
    })(Ca),
    Ba = (function () {
      function t(t) {
        (this.maxMilliseconds = t), (this.frameStart = 0);
      }
      return (
        (t.prototype.beginFrame = function () {
          this.frameStart = Date.now();
        }),
        (t.prototype.allowedToUpload = function () {
          return Date.now() - this.frameStart < this.maxMilliseconds;
        }),
        t
      );
    })(),
    Ga = (function () {
      function t(t, e, r) {
        void 0 === r && (r = null),
          (this._texture = t instanceof Ri ? t : null),
          (this.baseTexture = t instanceof si ? t : this._texture.baseTexture),
          (this.textures = {}),
          (this.animations = {}),
          (this.data = e);
        var i = this.baseTexture.resource;
        (this.resolution = this._updateResolution(r || (i ? i.url : null))),
          (this._frames = this.data.frames),
          (this._frameKeys = Object.keys(this._frames)),
          (this._batchIndex = 0),
          (this._callback = null);
      }
      return (
        (t.prototype._updateResolution = function (t) {
          void 0 === t && (t = null);
          var e = this.data.meta.scale,
            r = Be(t, null);
          return (
            null === r && (r = void 0 !== e ? parseFloat(e) : 1),
            1 !== r && this.baseTexture.setResolution(r),
            r
          );
        }),
        (t.prototype.parse = function (e) {
          (this._batchIndex = 0),
            (this._callback = e),
            this._frameKeys.length <= t.BATCH_SIZE
              ? (this._processFrames(0), this._processAnimations(), this._parseComplete())
              : this._nextBatch();
        }),
        (t.prototype._processFrames = function (e) {
          for (var r = e, i = t.BATCH_SIZE; r - e < i && r < this._frameKeys.length; ) {
            var n = this._frameKeys[r],
              o = this._frames[n],
              s = o.frame;
            if (s) {
              var a,
                h = null,
                u = !1 !== o.trimmed && o.sourceSize ? o.sourceSize : o.frame,
                l = new Ve(
                  0,
                  0,
                  Math.floor(u.w) / this.resolution,
                  Math.floor(u.h) / this.resolution
                );
              (a = o.rotated
                ? new Ve(
                    Math.floor(s.x) / this.resolution,
                    Math.floor(s.y) / this.resolution,
                    Math.floor(s.h) / this.resolution,
                    Math.floor(s.w) / this.resolution
                  )
                : new Ve(
                    Math.floor(s.x) / this.resolution,
                    Math.floor(s.y) / this.resolution,
                    Math.floor(s.w) / this.resolution,
                    Math.floor(s.h) / this.resolution
                  )),
                !1 !== o.trimmed &&
                  o.spriteSourceSize &&
                  (h = new Ve(
                    Math.floor(o.spriteSourceSize.x) / this.resolution,
                    Math.floor(o.spriteSourceSize.y) / this.resolution,
                    Math.floor(s.w) / this.resolution,
                    Math.floor(s.h) / this.resolution
                  )),
                (this.textures[n] = new Ri(this.baseTexture, a, l, h, o.rotated ? 2 : 0, o.anchor)),
                Ri.addToCache(this.textures[n], n);
            }
            r++;
          }
        }),
        (t.prototype._processAnimations = function () {
          var t = this.data.animations || {};
          for (var e in t) {
            this.animations[e] = [];
            for (var r = 0; r < t[e].length; r++) {
              var i = t[e][r];
              this.animations[e].push(this.textures[i]);
            }
          }
        }),
        (t.prototype._parseComplete = function () {
          var t = this._callback;
          (this._callback = null), (this._batchIndex = 0), t.call(this, this.textures);
        }),
        (t.prototype._nextBatch = function () {
          var e = this;
          this._processFrames(this._batchIndex * t.BATCH_SIZE),
            this._batchIndex++,
            setTimeout(function () {
              e._batchIndex * t.BATCH_SIZE < e._frameKeys.length
                ? e._nextBatch()
                : (e._processAnimations(), e._parseComplete());
            }, 0);
        }),
        (t.prototype.destroy = function (t) {
          var e;
          for (var r in (void 0 === t && (t = !1), this.textures)) this.textures[r].destroy();
          (this._frames = null),
            (this._frameKeys = null),
            (this.data = null),
            (this.textures = null),
            t &&
              (null === (e = this._texture) || void 0 === e || e.destroy(),
              this.baseTexture.destroy()),
            (this._texture = null),
            (this.baseTexture = null);
        }),
        (t.BATCH_SIZE = 1e3),
        t
      );
    })(),
    Xa = (function () {
      function e() {}
      return (
        (e.use = function (r, i) {
          var n,
            o,
            s = this,
            a = r.name + "_image";
          if (r.data && r.type === t.LoaderResource.TYPE.JSON && r.data.frames && !s.resources[a]) {
            var h =
              null === (o = null === (n = r.data) || void 0 === n ? void 0 : n.meta) || void 0 === o
                ? void 0
                : o.related_multi_packs;
            if (Array.isArray(h))
              for (
                var u = function (e) {
                    if ("string" != typeof e) return "continue";
                    var i = e.replace(".json", ""),
                      n = ne.resolve(r.url.replace(s.baseUrl, ""), e);
                    if (
                      s.resources[i] ||
                      Object.values(s.resources).some(function (t) {
                        return ne.format(ne.parse(t.url)) === n;
                      })
                    )
                      return "continue";
                    var o = {
                      crossOrigin: r.crossOrigin,
                      loadType: t.LoaderResource.LOAD_TYPE.XHR,
                      xhrType: t.LoaderResource.XHR_RESPONSE_TYPE.JSON,
                      parentResource: r,
                      metadata: r.metadata,
                    };
                    s.add(i, n, o);
                  },
                  l = 0,
                  c = h;
                l < c.length;
                l++
              )
                u(c[l]);
            var d = {
                crossOrigin: r.crossOrigin,
                metadata: r.metadata.imageMetadata,
                parentResource: r,
              },
              f = e.getResourcePath(r, s.baseUrl);
            s.add(a, f, d, function (t) {
              if (t.error) i(t.error);
              else {
                var e = new Ga(t.texture, r.data, r.url);
                e.parse(function () {
                  (r.spritesheet = e), (r.textures = e.textures), i();
                });
              }
            });
          } else i();
        }),
        (e.getResourcePath = function (t, e) {
          return t.isDataUrl
            ? t.data.meta.image
            : ne.resolve(t.url.replace(e, ""), t.data.meta.image);
        }),
        e
      );
    })(),
    ka = function (t, e) {
      return (ka =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function Ha(t, e) {
    function r() {
      this.constructor = t;
    }
    ka(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var Ya = new Ye(),
    ja = (function (t) {
      function e(e, r, i) {
        void 0 === r && (r = 100), void 0 === i && (i = 100);
        var n = t.call(this, e) || this;
        return (
          (n.tileTransform = new sr()),
          (n._width = r),
          (n._height = i),
          (n.uvMatrix = n.texture.uvMatrix || new Pn(e)),
          (n.pluginName = "tilingSprite"),
          (n.uvRespectAnchor = !1),
          n
        );
      }
      return (
        Ha(e, t),
        Object.defineProperty(e.prototype, "clampMargin", {
          get: function () {
            return this.uvMatrix.clampMargin;
          },
          set: function (t) {
            (this.uvMatrix.clampMargin = t), this.uvMatrix.update(!0);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "tileScale", {
          get: function () {
            return this.tileTransform.scale;
          },
          set: function (t) {
            this.tileTransform.scale.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "tilePosition", {
          get: function () {
            return this.tileTransform.position;
          },
          set: function (t) {
            this.tileTransform.position.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype._onTextureUpdate = function () {
          this.uvMatrix && (this.uvMatrix.texture = this._texture), (this._cachedTint = 16777215);
        }),
        (e.prototype._render = function (t) {
          var e = this._texture;
          e &&
            e.valid &&
            (this.tileTransform.updateLocalTransform(),
            this.uvMatrix.update(),
            t.batch.setObjectRenderer(t.plugins[this.pluginName]),
            t.plugins[this.pluginName].render(this));
        }),
        (e.prototype._calculateBounds = function () {
          var t = this._width * -this._anchor._x,
            e = this._height * -this._anchor._y,
            r = this._width * (1 - this._anchor._x),
            i = this._height * (1 - this._anchor._y);
          this._bounds.addFrame(this.transform, t, e, r, i);
        }),
        (e.prototype.getLocalBounds = function (e) {
          return 0 === this.children.length
            ? ((this._bounds.minX = this._width * -this._anchor._x),
              (this._bounds.minY = this._height * -this._anchor._y),
              (this._bounds.maxX = this._width * (1 - this._anchor._x)),
              (this._bounds.maxY = this._height * (1 - this._anchor._y)),
              e ||
                (this._localBoundsRect || (this._localBoundsRect = new Ve()),
                (e = this._localBoundsRect)),
              this._bounds.getRectangle(e))
            : t.prototype.getLocalBounds.call(this, e);
        }),
        (e.prototype.containsPoint = function (t) {
          this.worldTransform.applyInverse(t, Ya);
          var e = this._width,
            r = this._height,
            i = -e * this.anchor._x;
          if (Ya.x >= i && Ya.x < i + e) {
            var n = -r * this.anchor._y;
            if (Ya.y >= n && Ya.y < n + r) return !0;
          }
          return !1;
        }),
        (e.prototype.destroy = function (e) {
          t.prototype.destroy.call(this, e), (this.tileTransform = null), (this.uvMatrix = null);
        }),
        (e.from = function (t, r) {
          return new e(t instanceof Ri ? t : Ri.from(t, r), r.width, r.height);
        }),
        Object.defineProperty(e.prototype, "width", {
          get: function () {
            return this._width;
          },
          set: function (t) {
            this._width = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "height", {
          get: function () {
            return this._height;
          },
          set: function (t) {
            this._height = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(da),
    Va =
      "#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",
    Wa = new Qe(),
    za = (function (e) {
      function r(t) {
        var r = e.call(this, t) || this;
        return t.runners.contextChange.add(r), (r.quad = new wi()), (r.state = An.for2d()), r;
      }
      return (
        Ha(r, e),
        (r.prototype.contextChange = function () {
          var t = this.renderer,
            e = { globals: t.globalUniforms };
          (this.simpleShader = bn.from(
            Va,
            "#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",
            e
          )),
            (this.shader =
              t.context.webGLVersion > 1
                ? bn.from(
                    "#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",
                    "#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",
                    e
                  )
                : bn.from(
                    Va,
                    "#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",
                    e
                  ));
        }),
        (r.prototype.render = function (e) {
          var r = this.renderer,
            i = this.quad,
            n = i.vertices;
          (n[0] = n[6] = e._width * -e.anchor.x),
            (n[1] = n[3] = e._height * -e.anchor.y),
            (n[2] = n[4] = e._width * (1 - e.anchor.x)),
            (n[5] = n[7] = e._height * (1 - e.anchor.y));
          var o = e.uvRespectAnchor ? e.anchor.x : 0,
            s = e.uvRespectAnchor ? e.anchor.y : 0;
          ((n = i.uvs)[0] = n[6] = -o),
            (n[1] = n[3] = -s),
            (n[2] = n[4] = 1 - o),
            (n[5] = n[7] = 1 - s),
            i.invalidate();
          var a = e._texture,
            h = a.baseTexture,
            u = e.tileTransform.localTransform,
            l = e.uvMatrix,
            c = h.isPowerOfTwo && a.frame.width === h.width && a.frame.height === h.height;
          c &&
            (h._glTextures[r.CONTEXT_UID]
              ? (c = h.wrapMode !== t.WRAP_MODES.CLAMP)
              : h.wrapMode === t.WRAP_MODES.CLAMP && (h.wrapMode = t.WRAP_MODES.REPEAT));
          var d = c ? this.simpleShader : this.shader,
            f = a.width,
            p = a.height,
            _ = e._width,
            m = e._height;
          Wa.set((u.a * f) / _, (u.b * f) / m, (u.c * p) / _, (u.d * p) / m, u.tx / _, u.ty / m),
            Wa.invert(),
            c
              ? Wa.prepend(l.mapCoord)
              : ((d.uniforms.uMapCoord = l.mapCoord.toArray(!0)),
                (d.uniforms.uClampFrame = l.uClampFrame),
                (d.uniforms.uClampOffset = l.uClampOffset)),
            (d.uniforms.uTransform = Wa.toArray(!0)),
            (d.uniforms.uColor = Ee(e.tint, e.worldAlpha, d.uniforms.uColor, h.alphaMode)),
            (d.uniforms.translationMatrix = e.transform.worldTransform.toArray(!0)),
            (d.uniforms.uSampler = a),
            r.shader.bind(d),
            r.geometry.bind(i),
            (this.state.blendMode = _e(e.blendMode, h.alphaMode)),
            r.state.set(this.state),
            r.geometry.draw(this.renderer.gl.TRIANGLES, 6, 0);
        }),
        r
      );
    })(Hi),
    qa = function (t, e) {
      return (qa =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function Ka(t, e) {
    function r() {
      this.constructor = t;
    }
    qa(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var Za = (function () {
      function t(t, e) {
        (this.uvBuffer = t),
          (this.uvMatrix = e),
          (this.data = null),
          (this._bufferUpdateId = -1),
          (this._textureUpdateId = -1),
          (this._updateID = 0);
      }
      return (
        (t.prototype.update = function (t) {
          if (
            t ||
            this._bufferUpdateId !== this.uvBuffer._updateID ||
            this._textureUpdateId !== this.uvMatrix._updateID
          ) {
            (this._bufferUpdateId = this.uvBuffer._updateID),
              (this._textureUpdateId = this.uvMatrix._updateID);
            var e = this.uvBuffer.data;
            (this.data && this.data.length === e.length) ||
              (this.data = new Float32Array(e.length)),
              this.uvMatrix.multiplyUvs(e, this.data),
              this._updateID++;
          }
        }),
        t
      );
    })(),
    Qa = new Ye(),
    Ja = new qe(),
    $a = (function (e) {
      function r(r, i, n, o) {
        void 0 === o && (o = t.DRAW_MODES.TRIANGLES);
        var s = e.call(this) || this;
        return (
          (s.geometry = r),
          (s.shader = i),
          (s.state = n || An.for2d()),
          (s.drawMode = o),
          (s.start = 0),
          (s.size = 0),
          (s.uvs = null),
          (s.indices = null),
          (s.vertexData = new Float32Array(1)),
          (s.vertexDirty = -1),
          (s._transformID = -1),
          (s._roundPixels = rt.ROUND_PIXELS),
          (s.batchUvs = null),
          s
        );
      }
      return (
        Ka(r, e),
        Object.defineProperty(r.prototype, "geometry", {
          get: function () {
            return this._geometry;
          },
          set: function (t) {
            this._geometry !== t &&
              (this._geometry &&
                (this._geometry.refCount--,
                0 === this._geometry.refCount && this._geometry.dispose()),
              (this._geometry = t),
              this._geometry && this._geometry.refCount++,
              (this.vertexDirty = -1));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "uvBuffer", {
          get: function () {
            return this.geometry.buffers[1];
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "verticesBuffer", {
          get: function () {
            return this.geometry.buffers[0];
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "material", {
          get: function () {
            return this.shader;
          },
          set: function (t) {
            this.shader = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "blendMode", {
          get: function () {
            return this.state.blendMode;
          },
          set: function (t) {
            this.state.blendMode = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "roundPixels", {
          get: function () {
            return this._roundPixels;
          },
          set: function (t) {
            this._roundPixels !== t && (this._transformID = -1), (this._roundPixels = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "tint", {
          get: function () {
            return "tint" in this.shader ? this.shader.tint : null;
          },
          set: function (t) {
            this.shader.tint = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "texture", {
          get: function () {
            return "texture" in this.shader ? this.shader.texture : null;
          },
          set: function (t) {
            this.shader.texture = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype._render = function (e) {
          var i = this.geometry.buffers[0].data;
          this.shader.batchable &&
          this.drawMode === t.DRAW_MODES.TRIANGLES &&
          i.length < 2 * r.BATCHABLE_SIZE
            ? this._renderToBatch(e)
            : this._renderDefault(e);
        }),
        (r.prototype._renderDefault = function (t) {
          var e = this.shader;
          (e.alpha = this.worldAlpha),
            e.update && e.update(),
            t.batch.flush(),
            (e.uniforms.translationMatrix = this.transform.worldTransform.toArray(!0)),
            t.shader.bind(e),
            t.state.set(this.state),
            t.geometry.bind(this.geometry, e),
            t.geometry.draw(this.drawMode, this.size, this.start, this.geometry.instanceCount);
        }),
        (r.prototype._renderToBatch = function (t) {
          var e = this.geometry,
            r = this.shader;
          r.uvMatrix && (r.uvMatrix.update(), this.calculateUvs()),
            this.calculateVertices(),
            (this.indices = e.indexBuffer.data),
            (this._tintRGB = r._tintRGB),
            (this._texture = r.texture);
          var i = this.material.pluginName;
          t.batch.setObjectRenderer(t.plugins[i]), t.plugins[i].render(this);
        }),
        (r.prototype.calculateVertices = function () {
          var t = this.geometry.buffers[0],
            e = t.data,
            r = t._updateID;
          if (r !== this.vertexDirty || this._transformID !== this.transform._worldID) {
            (this._transformID = this.transform._worldID),
              this.vertexData.length !== e.length && (this.vertexData = new Float32Array(e.length));
            for (
              var i = this.transform.worldTransform,
                n = i.a,
                o = i.b,
                s = i.c,
                a = i.d,
                h = i.tx,
                u = i.ty,
                l = this.vertexData,
                c = 0;
              c < l.length / 2;
              c++
            ) {
              var d = e[2 * c],
                f = e[2 * c + 1];
              (l[2 * c] = n * d + s * f + h), (l[2 * c + 1] = o * d + a * f + u);
            }
            if (this._roundPixels) {
              var p = rt.RESOLUTION;
              for (c = 0; c < l.length; ++c) l[c] = Math.round(((l[c] * p) | 0) / p);
            }
            this.vertexDirty = r;
          }
        }),
        (r.prototype.calculateUvs = function () {
          var t = this.geometry.buffers[1],
            e = this.shader;
          e.uvMatrix.isSimple
            ? (this.uvs = t.data)
            : (this.batchUvs || (this.batchUvs = new Za(t, e.uvMatrix)),
              this.batchUvs.update(),
              (this.uvs = this.batchUvs.data));
        }),
        (r.prototype._calculateBounds = function () {
          this.calculateVertices(),
            this._bounds.addVertexData(this.vertexData, 0, this.vertexData.length);
        }),
        (r.prototype.containsPoint = function (t) {
          if (!this.getBounds().contains(t.x, t.y)) return !1;
          this.worldTransform.applyInverse(t, Qa);
          for (
            var e = this.geometry.getBuffer("aVertexPosition").data,
              r = Ja.points,
              i = this.geometry.getIndex().data,
              n = i.length,
              o = 4 === this.drawMode ? 3 : 1,
              s = 0;
            s + 2 < n;
            s += o
          ) {
            var a = 2 * i[s],
              h = 2 * i[s + 1],
              u = 2 * i[s + 2];
            if (
              ((r[0] = e[a]),
              (r[1] = e[a + 1]),
              (r[2] = e[h]),
              (r[3] = e[h + 1]),
              (r[4] = e[u]),
              (r[5] = e[u + 1]),
              Ja.contains(Qa.x, Qa.y))
            )
              return !0;
          }
          return !1;
        }),
        (r.prototype.destroy = function (t) {
          e.prototype.destroy.call(this, t),
            this._cachedTexture && (this._cachedTexture.destroy(), (this._cachedTexture = null)),
            (this.geometry = null),
            (this.shader = null),
            (this.state = null),
            (this.uvs = null),
            (this.indices = null),
            (this.vertexData = null);
        }),
        (r.BATCHABLE_SIZE = 100),
        r
      );
    })(Dr),
    th =
      "varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n",
    eh =
      "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n",
    rh = (function (t) {
      function e(e, r) {
        var i = this,
          n = {
            uSampler: e,
            alpha: 1,
            uTextureMatrix: Qe.IDENTITY,
            uColor: new Float32Array([1, 1, 1, 1]),
          };
        return (
          (r = Object.assign({ tint: 16777215, alpha: 1, pluginName: "batch" }, r)).uniforms &&
            Object.assign(n, r.uniforms),
          ((i = t.call(this, r.program || Rn.from(eh, th), n) || this)._colorDirty = !1),
          (i.uvMatrix = new Pn(e)),
          (i.batchable = void 0 === r.program),
          (i.pluginName = r.pluginName),
          (i.tint = r.tint),
          (i.alpha = r.alpha),
          i
        );
      }
      return (
        Ka(e, t),
        Object.defineProperty(e.prototype, "texture", {
          get: function () {
            return this.uniforms.uSampler;
          },
          set: function (t) {
            this.uniforms.uSampler !== t &&
              ((this.uniforms.uSampler = t), (this.uvMatrix.texture = t));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "alpha", {
          get: function () {
            return this._alpha;
          },
          set: function (t) {
            t !== this._alpha && ((this._alpha = t), (this._colorDirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "tint", {
          get: function () {
            return this._tint;
          },
          set: function (t) {
            t !== this._tint &&
              ((this._tint = t),
              (this._tintRGB = (t >> 16) + (65280 & t) + ((255 & t) << 16)),
              (this._colorDirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.update = function () {
          if (this._colorDirty) {
            this._colorDirty = !1;
            var t = this.texture.baseTexture;
            Ee(this._tint, this._alpha, this.uniforms.uColor, t.alphaMode);
          }
          this.uvMatrix.update() && (this.uniforms.uTextureMatrix = this.uvMatrix.mapCoord);
        }),
        e
      );
    })(bn),
    ih = (function (e) {
      function r(r, i, n) {
        var o = e.call(this) || this,
          s = new Ii(r),
          a = new Ii(i, !0),
          h = new Ii(n, !0, !0);
        return (
          o
            .addAttribute("aVertexPosition", s, 2, !1, t.TYPES.FLOAT)
            .addAttribute("aTextureCoord", a, 2, !1, t.TYPES.FLOAT)
            .addIndex(h),
          (o._updateId = -1),
          o
        );
      }
      return (
        Ka(r, e),
        Object.defineProperty(r.prototype, "vertexDirtyId", {
          get: function () {
            return this.buffers[0]._updateID;
          },
          enumerable: !1,
          configurable: !0,
        }),
        r
      );
    })(Ci),
    nh = function (t, e) {
      return (nh =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    oh = function () {
      (this.info = []),
        (this.common = []),
        (this.page = []),
        (this.char = []),
        (this.kerning = []),
        (this.distanceField = []);
    },
    sh = (function () {
      function t() {}
      return (
        (t.test = function (t) {
          return "string" == typeof t && 0 === t.indexOf("info face=");
        }),
        (t.parse = function (t) {
          var e = t.match(/^[a-z]+\s+.+$/gm),
            r = {
              info: [],
              common: [],
              page: [],
              char: [],
              chars: [],
              kerning: [],
              kernings: [],
              distanceField: [],
            };
          for (var i in e) {
            var n = e[i].match(/^[a-z]+/gm)[0],
              o = e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),
              s = {};
            for (var a in o) {
              var h = o[a].split("="),
                u = h[0],
                l = h[1].replace(/"/gm, ""),
                c = parseFloat(l),
                d = isNaN(c) ? l : c;
              s[u] = d;
            }
            r[n].push(s);
          }
          var f = new oh();
          return (
            r.info.forEach(function (t) {
              return f.info.push({ face: t.face, size: parseInt(t.size, 10) });
            }),
            r.common.forEach(function (t) {
              return f.common.push({ lineHeight: parseInt(t.lineHeight, 10) });
            }),
            r.page.forEach(function (t) {
              return f.page.push({ id: parseInt(t.id, 10), file: t.file });
            }),
            r.char.forEach(function (t) {
              return f.char.push({
                id: parseInt(t.id, 10),
                page: parseInt(t.page, 10),
                x: parseInt(t.x, 10),
                y: parseInt(t.y, 10),
                width: parseInt(t.width, 10),
                height: parseInt(t.height, 10),
                xoffset: parseInt(t.xoffset, 10),
                yoffset: parseInt(t.yoffset, 10),
                xadvance: parseInt(t.xadvance, 10),
              });
            }),
            r.kerning.forEach(function (t) {
              return f.kerning.push({
                first: parseInt(t.first, 10),
                second: parseInt(t.second, 10),
                amount: parseInt(t.amount, 10),
              });
            }),
            r.distanceField.forEach(function (t) {
              return f.distanceField.push({
                distanceRange: parseInt(t.distanceRange, 10),
                fieldType: t.fieldType,
              });
            }),
            f
          );
        }),
        t
      );
    })(),
    ah = (function () {
      function t() {}
      return (
        (t.test = function (t) {
          return (
            t instanceof XMLDocument &&
            t.getElementsByTagName("page").length &&
            null !== t.getElementsByTagName("info")[0].getAttribute("face")
          );
        }),
        (t.parse = function (t) {
          for (
            var e = new oh(),
              r = t.getElementsByTagName("info"),
              i = t.getElementsByTagName("common"),
              n = t.getElementsByTagName("page"),
              o = t.getElementsByTagName("char"),
              s = t.getElementsByTagName("kerning"),
              a = t.getElementsByTagName("distanceField"),
              h = 0;
            h < r.length;
            h++
          )
            e.info.push({
              face: r[h].getAttribute("face"),
              size: parseInt(r[h].getAttribute("size"), 10),
            });
          for (h = 0; h < i.length; h++)
            e.common.push({ lineHeight: parseInt(i[h].getAttribute("lineHeight"), 10) });
          for (h = 0; h < n.length; h++)
            e.page.push({
              id: parseInt(n[h].getAttribute("id"), 10) || 0,
              file: n[h].getAttribute("file"),
            });
          for (h = 0; h < o.length; h++) {
            var u = o[h];
            e.char.push({
              id: parseInt(u.getAttribute("id"), 10),
              page: parseInt(u.getAttribute("page"), 10) || 0,
              x: parseInt(u.getAttribute("x"), 10),
              y: parseInt(u.getAttribute("y"), 10),
              width: parseInt(u.getAttribute("width"), 10),
              height: parseInt(u.getAttribute("height"), 10),
              xoffset: parseInt(u.getAttribute("xoffset"), 10),
              yoffset: parseInt(u.getAttribute("yoffset"), 10),
              xadvance: parseInt(u.getAttribute("xadvance"), 10),
            });
          }
          for (h = 0; h < s.length; h++)
            e.kerning.push({
              first: parseInt(s[h].getAttribute("first"), 10),
              second: parseInt(s[h].getAttribute("second"), 10),
              amount: parseInt(s[h].getAttribute("amount"), 10),
            });
          for (h = 0; h < a.length; h++)
            e.distanceField.push({
              fieldType: a[h].getAttribute("fieldType"),
              distanceRange: parseInt(a[h].getAttribute("distanceRange"), 10),
            });
          return e;
        }),
        t
      );
    })(),
    hh = (function () {
      function t() {}
      return (
        (t.test = function (t) {
          if ("string" == typeof t && t.indexOf("<font>") > -1) {
            var e = new globalThis.DOMParser().parseFromString(t, "text/xml");
            return ah.test(e);
          }
          return !1;
        }),
        (t.parse = function (t) {
          var e = new globalThis.DOMParser().parseFromString(t, "text/xml");
          return ah.parse(e);
        }),
        t
      );
    })(),
    uh = [sh, ah, hh];
  function lh(t) {
    for (var e = 0; e < uh.length; e++) if (uh[e].test(t)) return uh[e];
    return null;
  }
  function ch(e, r, i, n, o, s, a) {
    var h = i.text,
      u = i.fontProperties;
    r.translate(n, o), r.scale(s, s);
    var l = a.strokeThickness / 2,
      c = -a.strokeThickness / 2;
    if (
      ((r.font = a.toFontString()),
      (r.lineWidth = a.strokeThickness),
      (r.textBaseline = a.textBaseline),
      (r.lineJoin = a.lineJoin),
      (r.miterLimit = a.miterLimit),
      (r.fillStyle = (function (e, r, i, n, o, s) {
        var a,
          h = i.fill;
        if (!Array.isArray(h)) return h;
        if (1 === h.length) return h[0];
        var u = i.dropShadow ? i.dropShadowDistance : 0,
          l = i.padding || 0,
          c = e.width / n - u - 2 * l,
          d = e.height / n - u - 2 * l,
          f = h.slice(),
          p = i.fillGradientStops.slice();
        if (!p.length) for (var _ = f.length + 1, m = 1; m < _; ++m) p.push(m / _);
        if (
          (f.unshift(h[0]),
          p.unshift(0),
          f.push(h[h.length - 1]),
          p.push(1),
          i.fillGradientType === t.TEXT_GRADIENT.LINEAR_VERTICAL)
        ) {
          a = r.createLinearGradient(c / 2, l, c / 2, d + l);
          var v = 0,
            E = (s.fontProperties.fontSize + i.strokeThickness) / d;
          for (m = 0; m < o.length; m++)
            for (var T = s.lineHeight * m, y = 0; y < f.length; y++) {
              var g = T / d + ("number" == typeof p[y] ? p[y] : y / f.length) * E,
                R = Math.max(v, g);
              (R = Math.min(R, 1)), a.addColorStop(R, f[y]), (v = R);
            }
        } else {
          a = r.createLinearGradient(l, d / 2, c + l, d / 2);
          var b = f.length + 1,
            A = 1;
          for (m = 0; m < f.length; m++) {
            var x;
            (x = "number" == typeof p[m] ? p[m] : A / b), a.addColorStop(x, f[m]), A++;
          }
        }
        return a;
      })(e, r, a, s, [h], i)),
      (r.strokeStyle = a.stroke),
      a.dropShadow)
    ) {
      var d = a.dropShadowColor,
        f = ce("number" == typeof d ? d : fe(d)),
        p = a.dropShadowBlur * s,
        _ = a.dropShadowDistance * s;
      (r.shadowColor =
        "rgba(" + 255 * f[0] + "," + 255 * f[1] + "," + 255 * f[2] + "," + a.dropShadowAlpha + ")"),
        (r.shadowBlur = p),
        (r.shadowOffsetX = Math.cos(a.dropShadowAngle) * _),
        (r.shadowOffsetY = Math.sin(a.dropShadowAngle) * _);
    } else
      (r.shadowColor = "black"), (r.shadowBlur = 0), (r.shadowOffsetX = 0), (r.shadowOffsetY = 0);
    a.stroke && a.strokeThickness && r.strokeText(h, l, c + i.lineHeight - u.descent),
      a.fill && r.fillText(h, l, c + i.lineHeight - u.descent),
      r.setTransform(1, 0, 0, 1, 0, 0),
      (r.fillStyle = "rgba(0, 0, 0, 0)");
  }
  function dh(t) {
    return Array.from ? Array.from(t) : t.split("");
  }
  function fh(t) {
    return t.codePointAt ? t.codePointAt(0) : t.charCodeAt(0);
  }
  var ph = (function () {
      function e(e, r, i) {
        var n,
          o,
          s = e.info[0],
          a = e.common[0],
          h = e.page[0],
          u = e.distanceField[0],
          l = Be(h.file),
          c = {};
        (this._ownsTextures = i),
          (this.font = s.face),
          (this.size = s.size),
          (this.lineHeight = a.lineHeight / l),
          (this.chars = {}),
          (this.pageTextures = c);
        for (var d = 0; d < e.page.length; d++) {
          var f = e.page[d],
            p = f.id,
            _ = f.file;
          (c[p] = r instanceof Array ? r[d] : r[_]),
            (null == u ? void 0 : u.fieldType) &&
              "none" !== u.fieldType &&
              (c[p].baseTexture.alphaMode = t.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA);
        }
        for (d = 0; d < e.char.length; d++) {
          var m = e.char[d],
            v = ((p = m.id), m.page),
            E = e.char[d],
            T = E.x,
            y = E.y,
            g = E.width,
            R = E.height,
            b = E.xoffset,
            A = E.yoffset,
            x = E.xadvance;
          (y /= l), (g /= l), (R /= l), (b /= l), (A /= l), (x /= l);
          var S = new Ve((T /= l) + c[v].frame.x / l, y + c[v].frame.y / l, g, R);
          this.chars[p] = {
            xOffset: b,
            yOffset: A,
            xAdvance: x,
            kerning: {},
            texture: new Ri(c[v].baseTexture, S),
            page: v,
          };
        }
        for (d = 0; d < e.kerning.length; d++) {
          var O = e.kerning[d],
            I = O.first,
            P = O.second,
            M = O.amount;
          (I /= l), (P /= l), (M /= l), this.chars[P] && (this.chars[P].kerning[I] = M);
        }
        (this.distanceFieldRange = null == u ? void 0 : u.distanceRange),
          (this.distanceFieldType =
            null !==
              (o =
                null === (n = null == u ? void 0 : u.fieldType) || void 0 === n
                  ? void 0
                  : n.toLowerCase()) && void 0 !== o
              ? o
              : "none");
      }
      return (
        (e.prototype.destroy = function () {
          for (var t in this.chars) this.chars[t].texture.destroy(), (this.chars[t].texture = null);
          for (var t in this.pageTextures)
            this._ownsTextures && this.pageTextures[t].destroy(!0), (this.pageTextures[t] = null);
          (this.chars = null), (this.pageTextures = null);
        }),
        (e.install = function (t, r, i) {
          var n;
          if (t instanceof oh) n = t;
          else {
            var o = lh(t);
            if (!o) throw new Error("Unrecognized data format for font.");
            n = o.parse(t);
          }
          r instanceof Ri && (r = [r]);
          var s = new e(n, r, i);
          return (e.available[s.font] = s), s;
        }),
        (e.uninstall = function (t) {
          var r = e.available[t];
          if (!r) throw new Error("No font found named '" + t + "'");
          r.destroy(), delete e.available[t];
        }),
        (e.from = function (t, r, i) {
          if (!t) throw new Error("[BitmapFont] Property `name` is required.");
          var n = Object.assign({}, e.defaultOptions, i),
            o = n.chars,
            s = n.padding,
            a = n.resolution,
            h = n.textureWidth,
            u = n.textureHeight,
            l = (function (t) {
              "string" == typeof t && (t = [t]);
              for (var e = [], r = 0, i = t.length; r < i; r++) {
                var n = t[r];
                if (Array.isArray(n)) {
                  if (2 !== n.length)
                    throw new Error(
                      "[BitmapFont]: Invalid character range length, expecting 2 got " +
                        n.length +
                        "."
                    );
                  var o = n[0].charCodeAt(0),
                    s = n[1].charCodeAt(0);
                  if (s < o) throw new Error("[BitmapFont]: Invalid character range.");
                  for (var a = o, h = s; a <= h; a++) e.push(String.fromCharCode(a));
                } else e.push.apply(e, dh(n));
              }
              if (0 === e.length)
                throw new Error("[BitmapFont]: Empty set when resolving characters.");
              return e;
            })(o),
            c = r instanceof ma ? r : new ma(r),
            d = h,
            f = new oh();
          (f.info[0] = { face: c.fontFamily, size: c.fontSize }),
            (f.common[0] = { lineHeight: c.fontSize });
          for (var p, _, m, v = 0, E = 0, T = 0, y = [], g = 0; g < l.length; g++) {
            p ||
              (((p = document.createElement("canvas")).width = h),
              (p.height = u),
              (_ = p.getContext("2d")),
              (m = new si(p, { resolution: a })),
              y.push(new Ri(m)),
              f.page.push({ id: y.length - 1, file: "" }));
            var R = ya.measureText(l[g], c, !1, p),
              b = R.width,
              A = Math.ceil(R.height),
              x = Math.ceil(("italic" === c.fontStyle ? 2 : 1) * b);
            if (E >= u - A * a) {
              if (0 === E)
                throw new Error(
                  "[BitmapFont] textureHeight " +
                    u +
                    "px is too small for " +
                    c.fontSize +
                    "px fonts"
                );
              --g, (p = null), (_ = null), (m = null), (E = 0), (v = 0), (T = 0);
            } else if (((T = Math.max(A + R.fontProperties.descent, T)), x * a + v >= d))
              --g, (E += T * a), (E = Math.ceil(E)), (v = 0), (T = 0);
            else {
              ch(p, _, R, v, E, a, c);
              var S = fh(R.text);
              f.char.push({
                id: S,
                page: y.length - 1,
                x: v / a,
                y: E / a,
                width: x,
                height: A,
                xoffset: 0,
                yoffset: 0,
                xadvance: Math.ceil(
                  b - (c.dropShadow ? c.dropShadowDistance : 0) - (c.stroke ? c.strokeThickness : 0)
                ),
              }),
                (v += (x + 2 * s) * a),
                (v = Math.ceil(v));
            }
          }
          g = 0;
          for (var O = l.length; g < O; g++)
            for (var I = l[g], P = 0; P < O; P++) {
              var M = l[P],
                N = _.measureText(I).width,
                D = _.measureText(M).width,
                C = _.measureText(I + M).width - (N + D);
              C && f.kerning.push({ first: fh(I), second: fh(M), amount: C });
            }
          var L = new e(f, y, !0);
          return void 0 !== e.available[t] && e.uninstall(t), (e.available[t] = L), L;
        }),
        (e.ALPHA = [["a", "z"], ["A", "Z"], " "]),
        (e.NUMERIC = [["0", "9"]]),
        (e.ALPHANUMERIC = [["a", "z"], ["A", "Z"], ["0", "9"], " "]),
        (e.ASCII = [[" ", "~"]]),
        (e.defaultOptions = {
          resolution: 1,
          textureWidth: 512,
          textureHeight: 512,
          padding: 4,
          chars: e.ALPHANUMERIC,
        }),
        (e.available = {}),
        e
      );
    })(),
    _h = [],
    mh = [],
    vh = [],
    Eh = (function (e) {
      function r(t, i) {
        void 0 === i && (i = {});
        var n = e.call(this) || this;
        n._tint = 16777215;
        var o = Object.assign({}, r.styleDefaults, i),
          s = o.align,
          a = o.tint,
          h = o.maxWidth,
          u = o.letterSpacing,
          l = o.fontName,
          c = o.fontSize;
        if (!ph.available[l]) throw new Error('Missing BitmapFont "' + l + '"');
        return (
          (n._activePagesMeshData = []),
          (n._textWidth = 0),
          (n._textHeight = 0),
          (n._align = s),
          (n._tint = a),
          (n._fontName = l),
          (n._fontSize = c || ph.available[l].size),
          (n._text = t),
          (n._maxWidth = h),
          (n._maxLineHeight = 0),
          (n._letterSpacing = u),
          (n._anchor = new Ze(
            function () {
              n.dirty = !0;
            },
            n,
            0,
            0
          )),
          (n._roundPixels = rt.ROUND_PIXELS),
          (n.dirty = !0),
          (n._textureCache = {}),
          n
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          nh(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(r, e),
        (r.prototype.updateText = function () {
          for (
            var e,
              r = ph.available[this._fontName],
              i = this._fontSize / r.size,
              n = new Ye(),
              o = [],
              s = [],
              a = [],
              h = dh(this._text.replace(/(?:\r\n|\r)/g, "\n") || " "),
              u = (this._maxWidth * r.size) / this._fontSize,
              l = "none" === r.distanceFieldType ? _h : mh,
              c = null,
              d = 0,
              f = 0,
              p = 0,
              _ = -1,
              m = 0,
              v = 0,
              E = 0,
              T = 0,
              y = 0;
            y < h.length;
            y++
          ) {
            var g = fh((k = h[y]));
            if ((/(?:\s)/.test(k) && ((_ = y), (m = d), T++), "\r" !== k && "\n" !== k)) {
              var R = r.chars[g];
              if (R) {
                c && R.kerning[c] && (n.x += R.kerning[c]);
                var b = vh.pop() || {
                  texture: Ri.EMPTY,
                  line: 0,
                  charCode: 0,
                  prevSpaces: 0,
                  position: new Ye(),
                };
                (b.texture = R.texture),
                  (b.line = p),
                  (b.charCode = g),
                  (b.position.x = n.x + R.xOffset + this._letterSpacing / 2),
                  (b.position.y = n.y + R.yOffset),
                  (b.prevSpaces = T),
                  o.push(b),
                  (d = b.position.x + Math.max(R.xAdvance, R.texture.orig.width)),
                  (n.x += R.xAdvance + this._letterSpacing),
                  (E = Math.max(E, R.yOffset + R.texture.height)),
                  (c = g),
                  -1 !== _ &&
                    u > 0 &&
                    n.x > u &&
                    (xe(o, 1 + _ - ++v, 1 + y - _),
                    (y = _),
                    (_ = -1),
                    s.push(m),
                    a.push(o.length > 0 ? o[o.length - 1].prevSpaces : 0),
                    (f = Math.max(f, m)),
                    p++,
                    (n.x = 0),
                    (n.y += r.lineHeight),
                    (c = null),
                    (T = 0));
              }
            } else
              s.push(d),
                a.push(-1),
                (f = Math.max(f, d)),
                ++p,
                ++v,
                (n.x = 0),
                (n.y += r.lineHeight),
                (c = null),
                (T = 0);
          }
          var A = h[h.length - 1];
          "\r" !== A &&
            "\n" !== A &&
            (/(?:\s)/.test(A) && (d = m), s.push(d), (f = Math.max(f, d)), a.push(-1));
          var x = [];
          for (y = 0; y <= p; y++) {
            var S = 0;
            "right" === this._align
              ? (S = f - s[y])
              : "center" === this._align
              ? (S = (f - s[y]) / 2)
              : "justify" === this._align && (S = a[y] < 0 ? 0 : (f - s[y]) / a[y]),
              x.push(S);
          }
          var O = o.length,
            I = {},
            P = [],
            M = this._activePagesMeshData;
          for (y = 0; y < M.length; y++) l.push(M[y]);
          for (y = 0; y < O; y++) {
            var N = (Y = o[y].texture).baseTexture.uid;
            if (!I[N]) {
              if (!(Z = l.pop())) {
                var D = new ih(),
                  C = void 0,
                  L = void 0;
                "none" === r.distanceFieldType
                  ? ((C = new rh(Ri.EMPTY)), (L = t.BLEND_MODES.NORMAL))
                  : ((C = new rh(Ri.EMPTY, {
                      program: Rn.from(
                        "// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n",
                        "// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"
                      ),
                      uniforms: { uFWidth: 0 },
                    })),
                    (L = t.BLEND_MODES.NORMAL_NPM));
                var w = new $a(D, C);
                (w.blendMode = L),
                  (Z = {
                    index: 0,
                    indexCount: 0,
                    vertexCount: 0,
                    uvsCount: 0,
                    total: 0,
                    mesh: w,
                    vertices: null,
                    uvs: null,
                    indices: null,
                  });
              }
              (Z.index = 0),
                (Z.indexCount = 0),
                (Z.vertexCount = 0),
                (Z.uvsCount = 0),
                (Z.total = 0);
              var F = this._textureCache;
              (F[N] = F[N] || new Ri(Y.baseTexture)),
                (Z.mesh.texture = F[N]),
                (Z.mesh.tint = this._tint),
                P.push(Z),
                (I[N] = Z);
            }
            I[N].total++;
          }
          for (y = 0; y < M.length; y++) -1 === P.indexOf(M[y]) && this.removeChild(M[y].mesh);
          for (y = 0; y < P.length; y++) P[y].mesh.parent !== this && this.addChild(P[y].mesh);
          for (var y in ((this._activePagesMeshData = P), I)) {
            var U = (Z = I[y]).total;
            if (
              !((null === (e = Z.indices) || void 0 === e ? void 0 : e.length) > 6 * U) ||
              Z.vertices.length < 2 * $a.BATCHABLE_SIZE
            )
              (Z.vertices = new Float32Array(8 * U)),
                (Z.uvs = new Float32Array(8 * U)),
                (Z.indices = new Uint16Array(6 * U));
            else for (var B = Z.total, G = Z.vertices, X = 4 * B * 2; X < G.length; X++) G[X] = 0;
            Z.mesh.size = 6 * U;
          }
          for (y = 0; y < O; y++) {
            var k,
              H =
                (k = o[y]).position.x + x[k.line] * ("justify" === this._align ? k.prevSpaces : 1);
            this._roundPixels && (H = Math.round(H));
            var Y,
              j = H * i,
              V = k.position.y * i,
              W = I[(Y = k.texture).baseTexture.uid],
              z = Y.frame,
              q = Y._uvs,
              K = W.index++;
            (W.indices[6 * K + 0] = 0 + 4 * K),
              (W.indices[6 * K + 1] = 1 + 4 * K),
              (W.indices[6 * K + 2] = 2 + 4 * K),
              (W.indices[6 * K + 3] = 0 + 4 * K),
              (W.indices[6 * K + 4] = 2 + 4 * K),
              (W.indices[6 * K + 5] = 3 + 4 * K),
              (W.vertices[8 * K + 0] = j),
              (W.vertices[8 * K + 1] = V),
              (W.vertices[8 * K + 2] = j + z.width * i),
              (W.vertices[8 * K + 3] = V),
              (W.vertices[8 * K + 4] = j + z.width * i),
              (W.vertices[8 * K + 5] = V + z.height * i),
              (W.vertices[8 * K + 6] = j),
              (W.vertices[8 * K + 7] = V + z.height * i),
              (W.uvs[8 * K + 0] = q.x0),
              (W.uvs[8 * K + 1] = q.y0),
              (W.uvs[8 * K + 2] = q.x1),
              (W.uvs[8 * K + 3] = q.y1),
              (W.uvs[8 * K + 4] = q.x2),
              (W.uvs[8 * K + 5] = q.y2),
              (W.uvs[8 * K + 6] = q.x3),
              (W.uvs[8 * K + 7] = q.y3);
          }
          for (var y in ((this._textWidth = f * i),
          (this._textHeight = (n.y + r.lineHeight) * i),
          I)) {
            var Z = I[y];
            if (0 !== this.anchor.x || 0 !== this.anchor.y)
              for (
                var Q = 0,
                  J = this._textWidth * this.anchor.x,
                  $ = this._textHeight * this.anchor.y,
                  tt = 0;
                tt < Z.total;
                tt++
              )
                (Z.vertices[Q++] -= J),
                  (Z.vertices[Q++] -= $),
                  (Z.vertices[Q++] -= J),
                  (Z.vertices[Q++] -= $),
                  (Z.vertices[Q++] -= J),
                  (Z.vertices[Q++] -= $),
                  (Z.vertices[Q++] -= J),
                  (Z.vertices[Q++] -= $);
            this._maxLineHeight = E * i;
            var et = Z.mesh.geometry.getBuffer("aVertexPosition"),
              rt = Z.mesh.geometry.getBuffer("aTextureCoord"),
              it = Z.mesh.geometry.getIndex();
            (et.data = Z.vertices),
              (rt.data = Z.uvs),
              (it.data = Z.indices),
              et.update(),
              rt.update(),
              it.update();
          }
          for (y = 0; y < o.length; y++) vh.push(o[y]);
        }),
        (r.prototype.updateTransform = function () {
          this.validate(), this.containerUpdateTransform();
        }),
        (r.prototype._render = function (t) {
          var r = ph.available[this._fontName],
            i = r.distanceFieldRange,
            n = r.distanceFieldType,
            o = r.size;
          if ("none" !== n)
            for (
              var s = this.worldTransform,
                a = s.a,
                h = s.b,
                u = s.c,
                l = s.d,
                c = Math.sqrt(a * a + h * h),
                d = Math.sqrt(u * u + l * l),
                f = (Math.abs(c) + Math.abs(d)) / 2,
                p = this._fontSize / o,
                _ = 0,
                m = this._activePagesMeshData;
              _ < m.length;
              _++
            )
              m[_].mesh.shader.uniforms.uFWidth = f * i * p * t.resolution;
          e.prototype._render.call(this, t);
        }),
        (r.prototype.getLocalBounds = function () {
          return this.validate(), e.prototype.getLocalBounds.call(this);
        }),
        (r.prototype.validate = function () {
          this.dirty && (this.updateText(), (this.dirty = !1));
        }),
        Object.defineProperty(r.prototype, "tint", {
          get: function () {
            return this._tint;
          },
          set: function (t) {
            if (this._tint !== t) {
              this._tint = t;
              for (var e = 0; e < this._activePagesMeshData.length; e++)
                this._activePagesMeshData[e].mesh.tint = t;
            }
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "align", {
          get: function () {
            return this._align;
          },
          set: function (t) {
            this._align !== t && ((this._align = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "fontName", {
          get: function () {
            return this._fontName;
          },
          set: function (t) {
            if (!ph.available[t]) throw new Error('Missing BitmapFont "' + t + '"');
            this._fontName !== t && ((this._fontName = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "fontSize", {
          get: function () {
            return this._fontSize;
          },
          set: function (t) {
            this._fontSize !== t && ((this._fontSize = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "anchor", {
          get: function () {
            return this._anchor;
          },
          set: function (t) {
            "number" == typeof t ? this._anchor.set(t) : this._anchor.copyFrom(t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "text", {
          get: function () {
            return this._text;
          },
          set: function (t) {
            (t = String(null == t ? "" : t)),
              this._text !== t && ((this._text = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "maxWidth", {
          get: function () {
            return this._maxWidth;
          },
          set: function (t) {
            this._maxWidth !== t && ((this._maxWidth = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "maxLineHeight", {
          get: function () {
            return this.validate(), this._maxLineHeight;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "textWidth", {
          get: function () {
            return this.validate(), this._textWidth;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "letterSpacing", {
          get: function () {
            return this._letterSpacing;
          },
          set: function (t) {
            this._letterSpacing !== t && ((this._letterSpacing = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "roundPixels", {
          get: function () {
            return this._roundPixels;
          },
          set: function (t) {
            t !== this._roundPixels && ((this._roundPixels = t), (this.dirty = !0));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "textHeight", {
          get: function () {
            return this.validate(), this._textHeight;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.destroy = function (t) {
          var r = this._textureCache;
          for (var i in r) r[i].destroy(), delete r[i];
          (this._textureCache = null), e.prototype.destroy.call(this, t);
        }),
        (r.styleDefaults = { align: "left", tint: 16777215, maxWidth: 0, letterSpacing: 0 }),
        r
      );
    })(Dr),
    Th = (function () {
      function e() {}
      return (
        (e.add = function () {
          t.LoaderResource.setExtensionXhrType("fnt", t.LoaderResource.XHR_RESPONSE_TYPE.TEXT);
        }),
        (e.use = function (r, i) {
          var n = lh(r.data);
          if (n)
            for (
              var o = e.getBaseUrl(this, r),
                s = n.parse(r.data),
                a = {},
                h = function (t) {
                  (a[t.metadata.pageFile] = t.texture),
                    Object.keys(a).length === s.page.length &&
                      ((r.bitmapFont = ph.install(s, a, !0)), i());
                },
                u = 0;
              u < s.page.length;
              ++u
            ) {
              var l = s.page[u].file,
                c = o + l,
                d = !1;
              for (var f in this.resources) {
                var p = this.resources[f];
                if (p.url === c) {
                  (p.metadata.pageFile = l),
                    p.texture ? h(p) : p.onAfterMiddleware.add(h),
                    (d = !0);
                  break;
                }
              }
              if (!d) {
                var _ = {
                  crossOrigin: r.crossOrigin,
                  loadType: t.LoaderResource.LOAD_TYPE.IMAGE,
                  metadata: Object.assign({ pageFile: l }, r.metadata.imageMetadata),
                  parentResource: r,
                };
                this.add(c, _, h);
              }
            }
          else i();
        }),
        (e.getBaseUrl = function (t, r) {
          var i = r.isDataUrl ? "" : e.dirname(r.url);
          return (
            r.isDataUrl &&
              ("." === i && (i = ""),
              t.baseUrl && i && "/" === t.baseUrl.charAt(t.baseUrl.length - 1) && (i += "/")),
            (i = i.replace(t.baseUrl, "")) && "/" !== i.charAt(i.length - 1) && (i += "/"),
            i
          );
        }),
        (e.dirname = function (t) {
          var e = t
            .replace(/\\/g, "/")
            .replace(/\/$/, "")
            .replace(/\/[^\/]*$/, "");
          return e === t ? "." : "" === e ? "/" : e;
        }),
        e
      );
    })(),
    yh = function (t, e) {
      return (yh =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    gh =
      "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",
    Rh = (function (t) {
      function e(e) {
        void 0 === e && (e = 1);
        var r = t.call(this, mo, gh, { uAlpha: 1 }) || this;
        return (r.alpha = e), r;
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          yh(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(e, t),
        Object.defineProperty(e.prototype, "alpha", {
          get: function () {
            return this.uniforms.uAlpha;
          },
          set: function (t) {
            this.uniforms.uAlpha = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(xn),
    bh = function (t, e) {
      return (bh =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    };
  function Ah(t, e) {
    function r() {
      this.constructor = t;
    }
    bh(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var xh,
    Sh,
    Oh,
    Ih,
    Ph,
    Mh,
    Nh,
    Dh,
    Ch,
    Lh,
    wh,
    Fh,
    Uh,
    Bh,
    Gh,
    Xh,
    kh,
    Hh,
    Yh,
    jh =
      "\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",
    Vh = {
      5: [0.153388, 0.221461, 0.250301],
      7: [0.071303, 0.131514, 0.189879, 0.214607],
      9: [0.028532, 0.067234, 0.124009, 0.179044, 0.20236],
      11: [0.0093, 0.028002, 0.065984, 0.121703, 0.175713, 0.198596],
      13: [0.002406, 0.009255, 0.027867, 0.065666, 0.121117, 0.174868, 0.197641],
      15: [489e-6, 0.002403, 0.009246, 0.02784, 0.065602, 0.120999, 0.174697, 0.197448],
    },
    Wh = [
      "varying vec2 vBlurTexCoords[%size%];",
      "uniform sampler2D uSampler;",
      "void main(void)",
      "{",
      "    gl_FragColor = vec4(0.0);",
      "    %blur%",
      "}",
    ].join("\n");
  !(function (t) {
    (t[(t.WEBGL_LEGACY = 0)] = "WEBGL_LEGACY"),
      (t[(t.WEBGL = 1)] = "WEBGL"),
      (t[(t.WEBGL2 = 2)] = "WEBGL2");
  })(xh || (xh = {})),
    (function (t) {
      (t[(t.UNKNOWN = 0)] = "UNKNOWN"),
        (t[(t.WEBGL = 1)] = "WEBGL"),
        (t[(t.CANVAS = 2)] = "CANVAS");
    })(Sh || (Sh = {})),
    (function (t) {
      (t[(t.COLOR = 16384)] = "COLOR"),
        (t[(t.DEPTH = 256)] = "DEPTH"),
        (t[(t.STENCIL = 1024)] = "STENCIL");
    })(Oh || (Oh = {})),
    (function (t) {
      (t[(t.NORMAL = 0)] = "NORMAL"),
        (t[(t.ADD = 1)] = "ADD"),
        (t[(t.MULTIPLY = 2)] = "MULTIPLY"),
        (t[(t.SCREEN = 3)] = "SCREEN"),
        (t[(t.OVERLAY = 4)] = "OVERLAY"),
        (t[(t.DARKEN = 5)] = "DARKEN"),
        (t[(t.LIGHTEN = 6)] = "LIGHTEN"),
        (t[(t.COLOR_DODGE = 7)] = "COLOR_DODGE"),
        (t[(t.COLOR_BURN = 8)] = "COLOR_BURN"),
        (t[(t.HARD_LIGHT = 9)] = "HARD_LIGHT"),
        (t[(t.SOFT_LIGHT = 10)] = "SOFT_LIGHT"),
        (t[(t.DIFFERENCE = 11)] = "DIFFERENCE"),
        (t[(t.EXCLUSION = 12)] = "EXCLUSION"),
        (t[(t.HUE = 13)] = "HUE"),
        (t[(t.SATURATION = 14)] = "SATURATION"),
        (t[(t.COLOR = 15)] = "COLOR"),
        (t[(t.LUMINOSITY = 16)] = "LUMINOSITY"),
        (t[(t.NORMAL_NPM = 17)] = "NORMAL_NPM"),
        (t[(t.ADD_NPM = 18)] = "ADD_NPM"),
        (t[(t.SCREEN_NPM = 19)] = "SCREEN_NPM"),
        (t[(t.NONE = 20)] = "NONE"),
        (t[(t.SRC_OVER = 0)] = "SRC_OVER"),
        (t[(t.SRC_IN = 21)] = "SRC_IN"),
        (t[(t.SRC_OUT = 22)] = "SRC_OUT"),
        (t[(t.SRC_ATOP = 23)] = "SRC_ATOP"),
        (t[(t.DST_OVER = 24)] = "DST_OVER"),
        (t[(t.DST_IN = 25)] = "DST_IN"),
        (t[(t.DST_OUT = 26)] = "DST_OUT"),
        (t[(t.DST_ATOP = 27)] = "DST_ATOP"),
        (t[(t.ERASE = 26)] = "ERASE"),
        (t[(t.SUBTRACT = 28)] = "SUBTRACT"),
        (t[(t.XOR = 29)] = "XOR");
    })(Ih || (Ih = {})),
    (function (t) {
      (t[(t.POINTS = 0)] = "POINTS"),
        (t[(t.LINES = 1)] = "LINES"),
        (t[(t.LINE_LOOP = 2)] = "LINE_LOOP"),
        (t[(t.LINE_STRIP = 3)] = "LINE_STRIP"),
        (t[(t.TRIANGLES = 4)] = "TRIANGLES"),
        (t[(t.TRIANGLE_STRIP = 5)] = "TRIANGLE_STRIP"),
        (t[(t.TRIANGLE_FAN = 6)] = "TRIANGLE_FAN");
    })(Ph || (Ph = {})),
    (function (t) {
      (t[(t.RGBA = 6408)] = "RGBA"),
        (t[(t.RGB = 6407)] = "RGB"),
        (t[(t.RG = 33319)] = "RG"),
        (t[(t.RED = 6403)] = "RED"),
        (t[(t.RGBA_INTEGER = 36249)] = "RGBA_INTEGER"),
        (t[(t.RGB_INTEGER = 36248)] = "RGB_INTEGER"),
        (t[(t.RG_INTEGER = 33320)] = "RG_INTEGER"),
        (t[(t.RED_INTEGER = 36244)] = "RED_INTEGER"),
        (t[(t.ALPHA = 6406)] = "ALPHA"),
        (t[(t.LUMINANCE = 6409)] = "LUMINANCE"),
        (t[(t.LUMINANCE_ALPHA = 6410)] = "LUMINANCE_ALPHA"),
        (t[(t.DEPTH_COMPONENT = 6402)] = "DEPTH_COMPONENT"),
        (t[(t.DEPTH_STENCIL = 34041)] = "DEPTH_STENCIL");
    })(Mh || (Mh = {})),
    (function (t) {
      (t[(t.TEXTURE_2D = 3553)] = "TEXTURE_2D"),
        (t[(t.TEXTURE_CUBE_MAP = 34067)] = "TEXTURE_CUBE_MAP"),
        (t[(t.TEXTURE_2D_ARRAY = 35866)] = "TEXTURE_2D_ARRAY"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_X = 34069)] = "TEXTURE_CUBE_MAP_POSITIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070)] = "TEXTURE_CUBE_MAP_NEGATIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071)] = "TEXTURE_CUBE_MAP_POSITIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072)] = "TEXTURE_CUBE_MAP_NEGATIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073)] = "TEXTURE_CUBE_MAP_POSITIVE_Z"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074)] = "TEXTURE_CUBE_MAP_NEGATIVE_Z");
    })(Nh || (Nh = {})),
    (function (t) {
      (t[(t.UNSIGNED_BYTE = 5121)] = "UNSIGNED_BYTE"),
        (t[(t.UNSIGNED_SHORT = 5123)] = "UNSIGNED_SHORT"),
        (t[(t.UNSIGNED_SHORT_5_6_5 = 33635)] = "UNSIGNED_SHORT_5_6_5"),
        (t[(t.UNSIGNED_SHORT_4_4_4_4 = 32819)] = "UNSIGNED_SHORT_4_4_4_4"),
        (t[(t.UNSIGNED_SHORT_5_5_5_1 = 32820)] = "UNSIGNED_SHORT_5_5_5_1"),
        (t[(t.UNSIGNED_INT = 5125)] = "UNSIGNED_INT"),
        (t[(t.UNSIGNED_INT_10F_11F_11F_REV = 35899)] = "UNSIGNED_INT_10F_11F_11F_REV"),
        (t[(t.UNSIGNED_INT_2_10_10_10_REV = 33640)] = "UNSIGNED_INT_2_10_10_10_REV"),
        (t[(t.UNSIGNED_INT_24_8 = 34042)] = "UNSIGNED_INT_24_8"),
        (t[(t.UNSIGNED_INT_5_9_9_9_REV = 35902)] = "UNSIGNED_INT_5_9_9_9_REV"),
        (t[(t.BYTE = 5120)] = "BYTE"),
        (t[(t.SHORT = 5122)] = "SHORT"),
        (t[(t.INT = 5124)] = "INT"),
        (t[(t.FLOAT = 5126)] = "FLOAT"),
        (t[(t.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269)] = "FLOAT_32_UNSIGNED_INT_24_8_REV"),
        (t[(t.HALF_FLOAT = 36193)] = "HALF_FLOAT");
    })(Dh || (Dh = {})),
    (function (t) {
      (t[(t.FLOAT = 0)] = "FLOAT"), (t[(t.INT = 1)] = "INT"), (t[(t.UINT = 2)] = "UINT");
    })(Ch || (Ch = {})),
    (function (t) {
      (t[(t.NEAREST = 0)] = "NEAREST"), (t[(t.LINEAR = 1)] = "LINEAR");
    })(Lh || (Lh = {})),
    (function (t) {
      (t[(t.CLAMP = 33071)] = "CLAMP"),
        (t[(t.REPEAT = 10497)] = "REPEAT"),
        (t[(t.MIRRORED_REPEAT = 33648)] = "MIRRORED_REPEAT");
    })(wh || (wh = {})),
    (function (t) {
      (t[(t.OFF = 0)] = "OFF"),
        (t[(t.POW2 = 1)] = "POW2"),
        (t[(t.ON = 2)] = "ON"),
        (t[(t.ON_MANUAL = 3)] = "ON_MANUAL");
    })(Fh || (Fh = {})),
    (function (t) {
      (t[(t.NPM = 0)] = "NPM"),
        (t[(t.UNPACK = 1)] = "UNPACK"),
        (t[(t.PMA = 2)] = "PMA"),
        (t[(t.NO_PREMULTIPLIED_ALPHA = 0)] = "NO_PREMULTIPLIED_ALPHA"),
        (t[(t.PREMULTIPLY_ON_UPLOAD = 1)] = "PREMULTIPLY_ON_UPLOAD"),
        (t[(t.PREMULTIPLY_ALPHA = 2)] = "PREMULTIPLY_ALPHA"),
        (t[(t.PREMULTIPLIED_ALPHA = 2)] = "PREMULTIPLIED_ALPHA");
    })(Uh || (Uh = {})),
    (function (t) {
      (t[(t.NO = 0)] = "NO"),
        (t[(t.YES = 1)] = "YES"),
        (t[(t.AUTO = 2)] = "AUTO"),
        (t[(t.BLEND = 0)] = "BLEND"),
        (t[(t.CLEAR = 1)] = "CLEAR"),
        (t[(t.BLIT = 2)] = "BLIT");
    })(Bh || (Bh = {})),
    (function (t) {
      (t[(t.AUTO = 0)] = "AUTO"), (t[(t.MANUAL = 1)] = "MANUAL");
    })(Gh || (Gh = {})),
    (function (t) {
      (t.LOW = "lowp"), (t.MEDIUM = "mediump"), (t.HIGH = "highp");
    })(Xh || (Xh = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.SCISSOR = 1)] = "SCISSOR"),
        (t[(t.STENCIL = 2)] = "STENCIL"),
        (t[(t.SPRITE = 3)] = "SPRITE");
    })(kh || (kh = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.LOW = 2)] = "LOW"),
        (t[(t.MEDIUM = 4)] = "MEDIUM"),
        (t[(t.HIGH = 8)] = "HIGH");
    })(Hh || (Hh = {})),
    (function (t) {
      (t[(t.ELEMENT_ARRAY_BUFFER = 34963)] = "ELEMENT_ARRAY_BUFFER"),
        (t[(t.ARRAY_BUFFER = 34962)] = "ARRAY_BUFFER"),
        (t[(t.UNIFORM_BUFFER = 35345)] = "UNIFORM_BUFFER");
    })(Yh || (Yh = {}));
  var zh = (function (t) {
      function e(e, r, i, n, o) {
        void 0 === r && (r = 8),
          void 0 === i && (i = 4),
          void 0 === n && (n = rt.FILTER_RESOLUTION),
          void 0 === o && (o = 5);
        var s = this,
          a = (function (t, e) {
            var r,
              i = Math.ceil(t / 2),
              n = jh,
              o = "";
            r = e
              ? "vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);"
              : "vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";
            for (var s = 0; s < t; s++) {
              var a = r.replace("%index%", s.toString());
              (o += a = a.replace("%sampleIndex%", s - (i - 1) + ".0")), (o += "\n");
            }
            return (n = n.replace("%blur%", o)).replace("%size%", t.toString());
          })(o, e),
          h = (function (t) {
            for (var e, r = Vh[t], i = r.length, n = Wh, o = "", s = 0; s < t; s++) {
              var a =
                "gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace(
                  "%index%",
                  s.toString()
                );
              (e = s),
                s >= i && (e = t - s - 1),
                (o += a = a.replace("%value%", r[e].toString())),
                (o += "\n");
            }
            return (n = n.replace("%blur%", o)).replace("%size%", t.toString());
          })(o);
        return (
          ((s = t.call(this, a, h) || this).horizontal = e),
          (s.resolution = n),
          (s._quality = 0),
          (s.quality = i),
          (s.blur = r),
          s
        );
      }
      return (
        Ah(e, t),
        (e.prototype.apply = function (t, e, r, i) {
          if (
            (r
              ? this.horizontal
                ? (this.uniforms.strength = (1 / r.width) * (r.width / e.width))
                : (this.uniforms.strength = (1 / r.height) * (r.height / e.height))
              : this.horizontal
              ? (this.uniforms.strength = (1 / t.renderer.width) * (t.renderer.width / e.width))
              : (this.uniforms.strength = (1 / t.renderer.height) * (t.renderer.height / e.height)),
            (this.uniforms.strength *= this.strength),
            (this.uniforms.strength /= this.passes),
            1 === this.passes)
          )
            t.applyFilter(this, e, r, i);
          else {
            var n = t.getFilterTexture(),
              o = t.renderer,
              s = e,
              a = n;
            (this.state.blend = !1), t.applyFilter(this, s, a, Bh.CLEAR);
            for (var h = 1; h < this.passes - 1; h++) {
              t.bindAndClear(s, Bh.BLIT), (this.uniforms.uSampler = a);
              var u = a;
              (a = s), (s = u), o.shader.bind(this), o.geometry.draw(5);
            }
            (this.state.blend = !0), t.applyFilter(this, a, r, i), t.returnFilterTexture(n);
          }
        }),
        Object.defineProperty(e.prototype, "blur", {
          get: function () {
            return this.strength;
          },
          set: function (t) {
            (this.padding = 1 + 2 * Math.abs(t)), (this.strength = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "quality", {
          get: function () {
            return this._quality;
          },
          set: function (t) {
            (this._quality = t), (this.passes = t);
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(xn),
    qh = (function (t) {
      function e(e, r, i, n) {
        void 0 === e && (e = 8),
          void 0 === r && (r = 4),
          void 0 === i && (i = rt.FILTER_RESOLUTION),
          void 0 === n && (n = 5);
        var o = t.call(this) || this;
        return (
          (o.blurXFilter = new zh(!0, e, r, i, n)),
          (o.blurYFilter = new zh(!1, e, r, i, n)),
          (o.resolution = i),
          (o.quality = r),
          (o.blur = e),
          (o.repeatEdgePixels = !1),
          o
        );
      }
      return (
        Ah(e, t),
        (e.prototype.apply = function (t, e, r, i) {
          var n = Math.abs(this.blurXFilter.strength),
            o = Math.abs(this.blurYFilter.strength);
          if (n && o) {
            var s = t.getFilterTexture();
            this.blurXFilter.apply(t, e, s, Bh.CLEAR),
              this.blurYFilter.apply(t, s, r, i),
              t.returnFilterTexture(s);
          } else o ? this.blurYFilter.apply(t, e, r, i) : this.blurXFilter.apply(t, e, r, i);
        }),
        (e.prototype.updatePadding = function () {
          this._repeatEdgePixels
            ? (this.padding = 0)
            : (this.padding =
                2 *
                Math.max(Math.abs(this.blurXFilter.strength), Math.abs(this.blurYFilter.strength)));
        }),
        Object.defineProperty(e.prototype, "blur", {
          get: function () {
            return this.blurXFilter.blur;
          },
          set: function (t) {
            (this.blurXFilter.blur = this.blurYFilter.blur = t), this.updatePadding();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "quality", {
          get: function () {
            return this.blurXFilter.quality;
          },
          set: function (t) {
            this.blurXFilter.quality = this.blurYFilter.quality = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "blurX", {
          get: function () {
            return this.blurXFilter.blur;
          },
          set: function (t) {
            (this.blurXFilter.blur = t), this.updatePadding();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "blurY", {
          get: function () {
            return this.blurYFilter.blur;
          },
          set: function (t) {
            (this.blurYFilter.blur = t), this.updatePadding();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "blendMode", {
          get: function () {
            return this.blurYFilter.blendMode;
          },
          set: function (t) {
            this.blurYFilter.blendMode = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "repeatEdgePixels", {
          get: function () {
            return this._repeatEdgePixels;
          },
          set: function (t) {
            (this._repeatEdgePixels = t), this.updatePadding();
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(xn),
    Kh = function (t, e) {
      return (Kh =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    Zh =
      "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",
    Qh = (function (t) {
      function e() {
        var e = this,
          r = {
            m: new Float32Array([1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0]),
            uAlpha: 1,
          };
        return ((e = t.call(this, vo, Zh, r) || this).alpha = 1), e;
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          Kh(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(e, t),
        (e.prototype._loadMatrix = function (t, e) {
          void 0 === e && (e = !1);
          var r = t;
          e && (this._multiply(r, this.uniforms.m, t), (r = this._colorMatrix(r))),
            (this.uniforms.m = r);
        }),
        (e.prototype._multiply = function (t, e, r) {
          return (
            (t[0] = e[0] * r[0] + e[1] * r[5] + e[2] * r[10] + e[3] * r[15]),
            (t[1] = e[0] * r[1] + e[1] * r[6] + e[2] * r[11] + e[3] * r[16]),
            (t[2] = e[0] * r[2] + e[1] * r[7] + e[2] * r[12] + e[3] * r[17]),
            (t[3] = e[0] * r[3] + e[1] * r[8] + e[2] * r[13] + e[3] * r[18]),
            (t[4] = e[0] * r[4] + e[1] * r[9] + e[2] * r[14] + e[3] * r[19] + e[4]),
            (t[5] = e[5] * r[0] + e[6] * r[5] + e[7] * r[10] + e[8] * r[15]),
            (t[6] = e[5] * r[1] + e[6] * r[6] + e[7] * r[11] + e[8] * r[16]),
            (t[7] = e[5] * r[2] + e[6] * r[7] + e[7] * r[12] + e[8] * r[17]),
            (t[8] = e[5] * r[3] + e[6] * r[8] + e[7] * r[13] + e[8] * r[18]),
            (t[9] = e[5] * r[4] + e[6] * r[9] + e[7] * r[14] + e[8] * r[19] + e[9]),
            (t[10] = e[10] * r[0] + e[11] * r[5] + e[12] * r[10] + e[13] * r[15]),
            (t[11] = e[10] * r[1] + e[11] * r[6] + e[12] * r[11] + e[13] * r[16]),
            (t[12] = e[10] * r[2] + e[11] * r[7] + e[12] * r[12] + e[13] * r[17]),
            (t[13] = e[10] * r[3] + e[11] * r[8] + e[12] * r[13] + e[13] * r[18]),
            (t[14] = e[10] * r[4] + e[11] * r[9] + e[12] * r[14] + e[13] * r[19] + e[14]),
            (t[15] = e[15] * r[0] + e[16] * r[5] + e[17] * r[10] + e[18] * r[15]),
            (t[16] = e[15] * r[1] + e[16] * r[6] + e[17] * r[11] + e[18] * r[16]),
            (t[17] = e[15] * r[2] + e[16] * r[7] + e[17] * r[12] + e[18] * r[17]),
            (t[18] = e[15] * r[3] + e[16] * r[8] + e[17] * r[13] + e[18] * r[18]),
            (t[19] = e[15] * r[4] + e[16] * r[9] + e[17] * r[14] + e[18] * r[19] + e[19]),
            t
          );
        }),
        (e.prototype._colorMatrix = function (t) {
          var e = new Float32Array(t);
          return (e[4] /= 255), (e[9] /= 255), (e[14] /= 255), (e[19] /= 255), e;
        }),
        (e.prototype.brightness = function (t, e) {
          var r = [t, 0, 0, 0, 0, 0, t, 0, 0, 0, 0, 0, t, 0, 0, 0, 0, 0, 1, 0];
          this._loadMatrix(r, e);
        }),
        (e.prototype.tint = function (t, e) {
          var r = [
            ((t >> 16) & 255) / 255,
            0,
            0,
            0,
            0,
            0,
            ((t >> 8) & 255) / 255,
            0,
            0,
            0,
            0,
            0,
            (255 & t) / 255,
            0,
            0,
            0,
            0,
            0,
            1,
            0,
          ];
          this._loadMatrix(r, e);
        }),
        (e.prototype.greyscale = function (t, e) {
          var r = [t, t, t, 0, 0, t, t, t, 0, 0, t, t, t, 0, 0, 0, 0, 0, 1, 0];
          this._loadMatrix(r, e);
        }),
        (e.prototype.blackAndWhite = function (t) {
          this._loadMatrix(
            [0.3, 0.6, 0.1, 0, 0, 0.3, 0.6, 0.1, 0, 0, 0.3, 0.6, 0.1, 0, 0, 0, 0, 0, 1, 0],
            t
          );
        }),
        (e.prototype.hue = function (t, e) {
          t = ((t || 0) / 180) * Math.PI;
          var r = Math.cos(t),
            i = Math.sin(t),
            n = 1 / 3,
            o = (0, Math.sqrt)(n),
            s = [
              r + (1 - r) * n,
              n * (1 - r) - o * i,
              n * (1 - r) + o * i,
              0,
              0,
              n * (1 - r) + o * i,
              r + n * (1 - r),
              n * (1 - r) - o * i,
              0,
              0,
              n * (1 - r) - o * i,
              n * (1 - r) + o * i,
              r + n * (1 - r),
              0,
              0,
              0,
              0,
              0,
              1,
              0,
            ];
          this._loadMatrix(s, e);
        }),
        (e.prototype.contrast = function (t, e) {
          var r = (t || 0) + 1,
            i = -0.5 * (r - 1),
            n = [r, 0, 0, 0, i, 0, r, 0, 0, i, 0, 0, r, 0, i, 0, 0, 0, 1, 0];
          this._loadMatrix(n, e);
        }),
        (e.prototype.saturate = function (t, e) {
          void 0 === t && (t = 0);
          var r = (2 * t) / 3 + 1,
            i = -0.5 * (r - 1),
            n = [r, i, i, 0, 0, i, r, i, 0, 0, i, i, r, 0, 0, 0, 0, 0, 1, 0];
          this._loadMatrix(n, e);
        }),
        (e.prototype.desaturate = function () {
          this.saturate(-1);
        }),
        (e.prototype.negative = function (t) {
          this._loadMatrix([-1, 0, 0, 1, 0, 0, -1, 0, 1, 0, 0, 0, -1, 1, 0, 0, 0, 0, 1, 0], t);
        }),
        (e.prototype.sepia = function (t) {
          this._loadMatrix(
            [
              0.393, 0.7689999, 0.18899999, 0, 0, 0.349, 0.6859999, 0.16799999, 0, 0, 0.272,
              0.5339999, 0.13099999, 0, 0, 0, 0, 0, 1, 0,
            ],
            t
          );
        }),
        (e.prototype.technicolor = function (t) {
          this._loadMatrix(
            [
              1.9125277891456083, -0.8545344976951645, -0.09155508482755585, 0, 11.793603434377337,
              -0.3087833385928097, 1.7658908555458428, -0.10601743074722245, 0, -70.35205161461398,
              -0.231103377548616, -0.7501899197440212, 1.847597816108189, 0, 30.950940869491138, 0,
              0, 0, 1, 0,
            ],
            t
          );
        }),
        (e.prototype.polaroid = function (t) {
          this._loadMatrix(
            [
              1.438, -0.062, -0.062, 0, 0, -0.122, 1.378, -0.122, 0, 0, -0.016, -0.016, 1.483, 0, 0,
              0, 0, 0, 1, 0,
            ],
            t
          );
        }),
        (e.prototype.toBGR = function (t) {
          this._loadMatrix([0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], t);
        }),
        (e.prototype.kodachrome = function (t) {
          this._loadMatrix(
            [
              1.1285582396593525, -0.3967382283601348, -0.03992559172921793, 0, 63.72958762196502,
              -0.16404339962244616, 1.0835251566291304, -0.05498805115633132, 0, 24.732407896706203,
              -0.16786010706155763, -0.5603416277695248, 1.6014850761964943, 0, 35.62982807460946,
              0, 0, 0, 1, 0,
            ],
            t
          );
        }),
        (e.prototype.browni = function (t) {
          this._loadMatrix(
            [
              0.5997023498159715, 0.34553243048391263, -0.2708298674538042, 0, 47.43192855600873,
              -0.037703249837783157, 0.8609577587992641, 0.15059552388459913, 0, -36.96841498319127,
              0.24113635128153335, -0.07441037908422492, 0.44972182064877153, 0, -7.562075277591283,
              0, 0, 0, 1, 0,
            ],
            t
          );
        }),
        (e.prototype.vintage = function (t) {
          this._loadMatrix(
            [
              0.6279345635605994, 0.3202183420819367, -0.03965408211312453, 0, 9.651285835294123,
              0.02578397704808868, 0.6441188644374771, 0.03259127616149294, 0, 7.462829176470591,
              0.0466055556782719, -0.0851232987247891, 0.5241648018700465, 0, 5.159190588235296, 0,
              0, 0, 1, 0,
            ],
            t
          );
        }),
        (e.prototype.colorTone = function (t, e, r, i, n) {
          var o = (((r = r || 16770432) >> 16) & 255) / 255,
            s = ((r >> 8) & 255) / 255,
            a = (255 & r) / 255,
            h = (((i = i || 3375104) >> 16) & 255) / 255,
            u = ((i >> 8) & 255) / 255,
            l = (255 & i) / 255,
            c = [
              0.3,
              0.59,
              0.11,
              0,
              0,
              o,
              s,
              a,
              (t = t || 0.2),
              0,
              h,
              u,
              l,
              (e = e || 0.15),
              0,
              o - h,
              s - u,
              a - l,
              0,
              0,
            ];
          this._loadMatrix(c, n);
        }),
        (e.prototype.night = function (t, e) {
          var r = [
            -2 * (t = t || 0.1),
            -t,
            0,
            0,
            0,
            -t,
            0,
            t,
            0,
            0,
            0,
            t,
            2 * t,
            0,
            0,
            0,
            0,
            0,
            1,
            0,
          ];
          this._loadMatrix(r, e);
        }),
        (e.prototype.predator = function (t, e) {
          var r = [
            11.224130630493164 * t,
            -4.794486999511719 * t,
            -2.8746118545532227 * t,
            0 * t,
            0.40342438220977783 * t,
            -3.6330697536468506 * t,
            9.193157196044922 * t,
            -2.951810836791992 * t,
            0 * t,
            -1.316135048866272 * t,
            -3.2184197902679443 * t,
            -4.2375030517578125 * t,
            7.476448059082031 * t,
            0 * t,
            0.8044459223747253 * t,
            0,
            0,
            0,
            1,
            0,
          ];
          this._loadMatrix(r, e);
        }),
        (e.prototype.lsd = function (t) {
          this._loadMatrix(
            [2, -0.4, 0.5, 0, 0, -0.5, 2, -0.4, 0, 0, -0.4, -0.5, 3, 0, 0, 0, 0, 0, 1, 0],
            t
          );
        }),
        (e.prototype.reset = function () {
          this._loadMatrix([1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0], !1);
        }),
        Object.defineProperty(e.prototype, "matrix", {
          get: function () {
            return this.uniforms.m;
          },
          set: function (t) {
            this.uniforms.m = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "alpha", {
          get: function () {
            return this.uniforms.uAlpha;
          },
          set: function (t) {
            this.uniforms.uAlpha = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(xn);
  Qh.prototype.grayscale = Qh.prototype.greyscale;
  var Jh,
    $h,
    tu,
    eu,
    ru,
    iu,
    nu,
    ou,
    su,
    au,
    hu,
    uu,
    lu,
    cu,
    du,
    fu,
    pu,
    _u,
    mu,
    vu = function (t, e) {
      return (vu =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    Eu =
      "varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",
    Tu =
      "attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n",
    yu = (function (t) {
      function e(e, r) {
        var i = this,
          n = new Qe();
        return (
          (e.renderable = !1),
          ((i =
            t.call(this, Tu, Eu, {
              mapSampler: e._texture,
              filterMatrix: n,
              scale: { x: 1, y: 1 },
              rotation: new Float32Array([1, 0, 0, 1]),
            }) || this).maskSprite = e),
          (i.maskMatrix = n),
          null == r && (r = 20),
          (i.scale = new Ye(r, r)),
          i
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          vu(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(e, t),
        (e.prototype.apply = function (t, e, r, i) {
          (this.uniforms.filterMatrix = t.calculateSpriteMatrix(this.maskMatrix, this.maskSprite)),
            (this.uniforms.scale.x = this.scale.x),
            (this.uniforms.scale.y = this.scale.y);
          var n = this.maskSprite.worldTransform,
            o = Math.sqrt(n.a * n.a + n.b * n.b),
            s = Math.sqrt(n.c * n.c + n.d * n.d);
          0 !== o &&
            0 !== s &&
            ((this.uniforms.rotation[0] = n.a / o),
            (this.uniforms.rotation[1] = n.b / o),
            (this.uniforms.rotation[2] = n.c / s),
            (this.uniforms.rotation[3] = n.d / s)),
            t.applyFilter(this, e, r, i);
        }),
        Object.defineProperty(e.prototype, "map", {
          get: function () {
            return this.uniforms.mapSampler;
          },
          set: function (t) {
            this.uniforms.mapSampler = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(xn),
    gu = function (t, e) {
      return (gu =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    Ru =
      "\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",
    bu =
      'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n',
    Au = (function (t) {
      function e() {
        return t.call(this, Ru, bu) || this;
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          gu(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(e, t),
        e
      );
    })(xn),
    xu = function (t, e) {
      return (xu =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    Su =
      "precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",
    Ou = (function (t) {
      function e(e, r) {
        void 0 === e && (e = 0.5), void 0 === r && (r = Math.random());
        var i = t.call(this, vo, Su, { uNoise: 0, uSeed: 0 }) || this;
        return (i.noise = e), (i.seed = r), i;
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          xu(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(e, t),
        Object.defineProperty(e.prototype, "noise", {
          get: function () {
            return this.uniforms.uNoise;
          },
          set: function (t) {
            this.uniforms.uNoise = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "seed", {
          get: function () {
            return this.uniforms.uSeed;
          },
          set: function (t) {
            this.uniforms.uSeed = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        e
      );
    })(xn);
  !(function (t) {
    (t[(t.WEBGL_LEGACY = 0)] = "WEBGL_LEGACY"),
      (t[(t.WEBGL = 1)] = "WEBGL"),
      (t[(t.WEBGL2 = 2)] = "WEBGL2");
  })(Jh || (Jh = {})),
    (function (t) {
      (t[(t.UNKNOWN = 0)] = "UNKNOWN"),
        (t[(t.WEBGL = 1)] = "WEBGL"),
        (t[(t.CANVAS = 2)] = "CANVAS");
    })($h || ($h = {})),
    (function (t) {
      (t[(t.COLOR = 16384)] = "COLOR"),
        (t[(t.DEPTH = 256)] = "DEPTH"),
        (t[(t.STENCIL = 1024)] = "STENCIL");
    })(tu || (tu = {})),
    (function (t) {
      (t[(t.NORMAL = 0)] = "NORMAL"),
        (t[(t.ADD = 1)] = "ADD"),
        (t[(t.MULTIPLY = 2)] = "MULTIPLY"),
        (t[(t.SCREEN = 3)] = "SCREEN"),
        (t[(t.OVERLAY = 4)] = "OVERLAY"),
        (t[(t.DARKEN = 5)] = "DARKEN"),
        (t[(t.LIGHTEN = 6)] = "LIGHTEN"),
        (t[(t.COLOR_DODGE = 7)] = "COLOR_DODGE"),
        (t[(t.COLOR_BURN = 8)] = "COLOR_BURN"),
        (t[(t.HARD_LIGHT = 9)] = "HARD_LIGHT"),
        (t[(t.SOFT_LIGHT = 10)] = "SOFT_LIGHT"),
        (t[(t.DIFFERENCE = 11)] = "DIFFERENCE"),
        (t[(t.EXCLUSION = 12)] = "EXCLUSION"),
        (t[(t.HUE = 13)] = "HUE"),
        (t[(t.SATURATION = 14)] = "SATURATION"),
        (t[(t.COLOR = 15)] = "COLOR"),
        (t[(t.LUMINOSITY = 16)] = "LUMINOSITY"),
        (t[(t.NORMAL_NPM = 17)] = "NORMAL_NPM"),
        (t[(t.ADD_NPM = 18)] = "ADD_NPM"),
        (t[(t.SCREEN_NPM = 19)] = "SCREEN_NPM"),
        (t[(t.NONE = 20)] = "NONE"),
        (t[(t.SRC_OVER = 0)] = "SRC_OVER"),
        (t[(t.SRC_IN = 21)] = "SRC_IN"),
        (t[(t.SRC_OUT = 22)] = "SRC_OUT"),
        (t[(t.SRC_ATOP = 23)] = "SRC_ATOP"),
        (t[(t.DST_OVER = 24)] = "DST_OVER"),
        (t[(t.DST_IN = 25)] = "DST_IN"),
        (t[(t.DST_OUT = 26)] = "DST_OUT"),
        (t[(t.DST_ATOP = 27)] = "DST_ATOP"),
        (t[(t.ERASE = 26)] = "ERASE"),
        (t[(t.SUBTRACT = 28)] = "SUBTRACT"),
        (t[(t.XOR = 29)] = "XOR");
    })(eu || (eu = {})),
    (function (t) {
      (t[(t.POINTS = 0)] = "POINTS"),
        (t[(t.LINES = 1)] = "LINES"),
        (t[(t.LINE_LOOP = 2)] = "LINE_LOOP"),
        (t[(t.LINE_STRIP = 3)] = "LINE_STRIP"),
        (t[(t.TRIANGLES = 4)] = "TRIANGLES"),
        (t[(t.TRIANGLE_STRIP = 5)] = "TRIANGLE_STRIP"),
        (t[(t.TRIANGLE_FAN = 6)] = "TRIANGLE_FAN");
    })(ru || (ru = {})),
    (function (t) {
      (t[(t.RGBA = 6408)] = "RGBA"),
        (t[(t.RGB = 6407)] = "RGB"),
        (t[(t.RG = 33319)] = "RG"),
        (t[(t.RED = 6403)] = "RED"),
        (t[(t.RGBA_INTEGER = 36249)] = "RGBA_INTEGER"),
        (t[(t.RGB_INTEGER = 36248)] = "RGB_INTEGER"),
        (t[(t.RG_INTEGER = 33320)] = "RG_INTEGER"),
        (t[(t.RED_INTEGER = 36244)] = "RED_INTEGER"),
        (t[(t.ALPHA = 6406)] = "ALPHA"),
        (t[(t.LUMINANCE = 6409)] = "LUMINANCE"),
        (t[(t.LUMINANCE_ALPHA = 6410)] = "LUMINANCE_ALPHA"),
        (t[(t.DEPTH_COMPONENT = 6402)] = "DEPTH_COMPONENT"),
        (t[(t.DEPTH_STENCIL = 34041)] = "DEPTH_STENCIL");
    })(iu || (iu = {})),
    (function (t) {
      (t[(t.TEXTURE_2D = 3553)] = "TEXTURE_2D"),
        (t[(t.TEXTURE_CUBE_MAP = 34067)] = "TEXTURE_CUBE_MAP"),
        (t[(t.TEXTURE_2D_ARRAY = 35866)] = "TEXTURE_2D_ARRAY"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_X = 34069)] = "TEXTURE_CUBE_MAP_POSITIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070)] = "TEXTURE_CUBE_MAP_NEGATIVE_X"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071)] = "TEXTURE_CUBE_MAP_POSITIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072)] = "TEXTURE_CUBE_MAP_NEGATIVE_Y"),
        (t[(t.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073)] = "TEXTURE_CUBE_MAP_POSITIVE_Z"),
        (t[(t.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074)] = "TEXTURE_CUBE_MAP_NEGATIVE_Z");
    })(nu || (nu = {})),
    (function (t) {
      (t[(t.UNSIGNED_BYTE = 5121)] = "UNSIGNED_BYTE"),
        (t[(t.UNSIGNED_SHORT = 5123)] = "UNSIGNED_SHORT"),
        (t[(t.UNSIGNED_SHORT_5_6_5 = 33635)] = "UNSIGNED_SHORT_5_6_5"),
        (t[(t.UNSIGNED_SHORT_4_4_4_4 = 32819)] = "UNSIGNED_SHORT_4_4_4_4"),
        (t[(t.UNSIGNED_SHORT_5_5_5_1 = 32820)] = "UNSIGNED_SHORT_5_5_5_1"),
        (t[(t.UNSIGNED_INT = 5125)] = "UNSIGNED_INT"),
        (t[(t.UNSIGNED_INT_10F_11F_11F_REV = 35899)] = "UNSIGNED_INT_10F_11F_11F_REV"),
        (t[(t.UNSIGNED_INT_2_10_10_10_REV = 33640)] = "UNSIGNED_INT_2_10_10_10_REV"),
        (t[(t.UNSIGNED_INT_24_8 = 34042)] = "UNSIGNED_INT_24_8"),
        (t[(t.UNSIGNED_INT_5_9_9_9_REV = 35902)] = "UNSIGNED_INT_5_9_9_9_REV"),
        (t[(t.BYTE = 5120)] = "BYTE"),
        (t[(t.SHORT = 5122)] = "SHORT"),
        (t[(t.INT = 5124)] = "INT"),
        (t[(t.FLOAT = 5126)] = "FLOAT"),
        (t[(t.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269)] = "FLOAT_32_UNSIGNED_INT_24_8_REV"),
        (t[(t.HALF_FLOAT = 36193)] = "HALF_FLOAT");
    })(ou || (ou = {})),
    (function (t) {
      (t[(t.FLOAT = 0)] = "FLOAT"), (t[(t.INT = 1)] = "INT"), (t[(t.UINT = 2)] = "UINT");
    })(su || (su = {})),
    (function (t) {
      (t[(t.NEAREST = 0)] = "NEAREST"), (t[(t.LINEAR = 1)] = "LINEAR");
    })(au || (au = {})),
    (function (t) {
      (t[(t.CLAMP = 33071)] = "CLAMP"),
        (t[(t.REPEAT = 10497)] = "REPEAT"),
        (t[(t.MIRRORED_REPEAT = 33648)] = "MIRRORED_REPEAT");
    })(hu || (hu = {})),
    (function (t) {
      (t[(t.OFF = 0)] = "OFF"),
        (t[(t.POW2 = 1)] = "POW2"),
        (t[(t.ON = 2)] = "ON"),
        (t[(t.ON_MANUAL = 3)] = "ON_MANUAL");
    })(uu || (uu = {})),
    (function (t) {
      (t[(t.NPM = 0)] = "NPM"),
        (t[(t.UNPACK = 1)] = "UNPACK"),
        (t[(t.PMA = 2)] = "PMA"),
        (t[(t.NO_PREMULTIPLIED_ALPHA = 0)] = "NO_PREMULTIPLIED_ALPHA"),
        (t[(t.PREMULTIPLY_ON_UPLOAD = 1)] = "PREMULTIPLY_ON_UPLOAD"),
        (t[(t.PREMULTIPLY_ALPHA = 2)] = "PREMULTIPLY_ALPHA"),
        (t[(t.PREMULTIPLIED_ALPHA = 2)] = "PREMULTIPLIED_ALPHA");
    })(lu || (lu = {})),
    (function (t) {
      (t[(t.NO = 0)] = "NO"),
        (t[(t.YES = 1)] = "YES"),
        (t[(t.AUTO = 2)] = "AUTO"),
        (t[(t.BLEND = 0)] = "BLEND"),
        (t[(t.CLEAR = 1)] = "CLEAR"),
        (t[(t.BLIT = 2)] = "BLIT");
    })(cu || (cu = {})),
    (function (t) {
      (t[(t.AUTO = 0)] = "AUTO"), (t[(t.MANUAL = 1)] = "MANUAL");
    })(du || (du = {})),
    (function (t) {
      (t.LOW = "lowp"), (t.MEDIUM = "mediump"), (t.HIGH = "highp");
    })(fu || (fu = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.SCISSOR = 1)] = "SCISSOR"),
        (t[(t.STENCIL = 2)] = "STENCIL"),
        (t[(t.SPRITE = 3)] = "SPRITE");
    })(pu || (pu = {})),
    (function (t) {
      (t[(t.NONE = 0)] = "NONE"),
        (t[(t.LOW = 2)] = "LOW"),
        (t[(t.MEDIUM = 4)] = "MEDIUM"),
        (t[(t.HIGH = 8)] = "HIGH");
    })(_u || (_u = {})),
    (function (t) {
      (t[(t.ELEMENT_ARRAY_BUFFER = 34963)] = "ELEMENT_ARRAY_BUFFER"),
        (t[(t.ARRAY_BUFFER = 34962)] = "ARRAY_BUFFER"),
        (t[(t.UNIFORM_BUFFER = 35345)] = "UNIFORM_BUFFER");
    })(mu || (mu = {}));
  var Iu = new Qe();
  (Pr.prototype._cacheAsBitmap = !1),
    (Pr.prototype._cacheData = null),
    (Pr.prototype._cacheAsBitmapResolution = null),
    (Pr.prototype._cacheAsBitmapMultisample = _u.NONE);
  var Pu = function () {
    (this.textureCacheId = null),
      (this.originalRender = null),
      (this.originalRenderCanvas = null),
      (this.originalCalculateBounds = null),
      (this.originalGetLocalBounds = null),
      (this.originalUpdateTransform = null),
      (this.originalDestroy = null),
      (this.originalMask = null),
      (this.originalFilterArea = null),
      (this.originalContainsPoint = null),
      (this.sprite = null);
  };
  Object.defineProperties(Pr.prototype, {
    cacheAsBitmapResolution: {
      get: function () {
        return this._cacheAsBitmapResolution;
      },
      set: function (t) {
        t !== this._cacheAsBitmapResolution &&
          ((this._cacheAsBitmapResolution = t),
          this.cacheAsBitmap && ((this.cacheAsBitmap = !1), (this.cacheAsBitmap = !0)));
      },
    },
    cacheAsBitmapMultisample: {
      get: function () {
        return this._cacheAsBitmapMultisample;
      },
      set: function (t) {
        t !== this._cacheAsBitmapMultisample &&
          ((this._cacheAsBitmapMultisample = t),
          this.cacheAsBitmap && ((this.cacheAsBitmap = !1), (this.cacheAsBitmap = !0)));
      },
    },
    cacheAsBitmap: {
      get: function () {
        return this._cacheAsBitmap;
      },
      set: function (t) {
        var e;
        this._cacheAsBitmap !== t &&
          ((this._cacheAsBitmap = t),
          t
            ? (this._cacheData || (this._cacheData = new Pu()),
              ((e = this._cacheData).originalRender = this.render),
              (e.originalRenderCanvas = this.renderCanvas),
              (e.originalUpdateTransform = this.updateTransform),
              (e.originalCalculateBounds = this.calculateBounds),
              (e.originalGetLocalBounds = this.getLocalBounds),
              (e.originalDestroy = this.destroy),
              (e.originalContainsPoint = this.containsPoint),
              (e.originalMask = this._mask),
              (e.originalFilterArea = this.filterArea),
              (this.render = this._renderCached),
              (this.renderCanvas = this._renderCachedCanvas),
              (this.destroy = this._cacheAsBitmapDestroy))
            : ((e = this._cacheData).sprite && this._destroyCachedDisplayObject(),
              (this.render = e.originalRender),
              (this.renderCanvas = e.originalRenderCanvas),
              (this.calculateBounds = e.originalCalculateBounds),
              (this.getLocalBounds = e.originalGetLocalBounds),
              (this.destroy = e.originalDestroy),
              (this.updateTransform = e.originalUpdateTransform),
              (this.containsPoint = e.originalContainsPoint),
              (this._mask = e.originalMask),
              (this.filterArea = e.originalFilterArea)));
      },
    },
  }),
    (Pr.prototype._renderCached = function (t) {
      !this.visible ||
        this.worldAlpha <= 0 ||
        !this.renderable ||
        (this._initCachedDisplayObject(t),
        (this._cacheData.sprite.transform._worldID = this.transform._worldID),
        (this._cacheData.sprite.worldAlpha = this.worldAlpha),
        this._cacheData.sprite._render(t));
    }),
    (Pr.prototype._initCachedDisplayObject = function (t) {
      var e;
      if (!this._cacheData || !this._cacheData.sprite) {
        var r = this.alpha;
        (this.alpha = 1), t.batch.flush();
        var i = this.getLocalBounds(null, !0).clone();
        if (this.filters && this.filters.length) {
          var n = this.filters[0].padding;
          i.pad(n);
        }
        i.ceil(rt.RESOLUTION);
        var o = t.renderTexture.current,
          s = t.renderTexture.sourceFrame.clone(),
          a = t.renderTexture.destinationFrame.clone(),
          h = t.projection.transform,
          u = Ai.create({
            width: i.width,
            height: i.height,
            resolution: this.cacheAsBitmapResolution || t.resolution,
            multisample:
              null !== (e = this.cacheAsBitmapMultisample) && void 0 !== e ? e : t.multisample,
          }),
          l = "cacheAsBitmap_" + Ie();
        (this._cacheData.textureCacheId = l), si.addToCache(u.baseTexture, l), Ri.addToCache(u, l);
        var c = this.transform.localTransform.copyTo(Iu).invert().translate(-i.x, -i.y);
        (this.render = this._cacheData.originalRender),
          t.render(this, { renderTexture: u, clear: !0, transform: c, skipUpdateTransform: !1 }),
          t.framebuffer.blit(),
          (t.projection.transform = h),
          t.renderTexture.bind(o, s, a),
          (this.render = this._renderCached),
          (this.updateTransform = this.displayObjectUpdateTransform),
          (this.calculateBounds = this._calculateCachedBounds),
          (this.getLocalBounds = this._getCachedLocalBounds),
          (this._mask = null),
          (this.filterArea = null),
          (this.alpha = r);
        var d = new da(u);
        (d.transform.worldTransform = this.transform.worldTransform),
          (d.anchor.x = -i.x / i.width),
          (d.anchor.y = -i.y / i.height),
          (d.alpha = r),
          (d._bounds = this._bounds),
          (this._cacheData.sprite = d),
          (this.transform._parentID = -1),
          this.parent
            ? this.updateTransform()
            : (this.enableTempParent(), this.updateTransform(), this.disableTempParent(null)),
          (this.containsPoint = d.containsPoint.bind(d));
      }
    }),
    (Pr.prototype._renderCachedCanvas = function (t) {
      !this.visible ||
        this.worldAlpha <= 0 ||
        !this.renderable ||
        (this._initCachedDisplayObjectCanvas(t),
        (this._cacheData.sprite.worldAlpha = this.worldAlpha),
        this._cacheData.sprite._renderCanvas(t));
    }),
    (Pr.prototype._initCachedDisplayObjectCanvas = function (t) {
      if (!this._cacheData || !this._cacheData.sprite) {
        var e = this.getLocalBounds(null, !0),
          r = this.alpha;
        this.alpha = 1;
        var i = t.context,
          n = t._projTransform;
        e.ceil(rt.RESOLUTION);
        var o = Ai.create({ width: e.width, height: e.height }),
          s = "cacheAsBitmap_" + Ie();
        (this._cacheData.textureCacheId = s), si.addToCache(o.baseTexture, s), Ri.addToCache(o, s);
        var a = Iu;
        this.transform.localTransform.copyTo(a),
          a.invert(),
          (a.tx -= e.x),
          (a.ty -= e.y),
          (this.renderCanvas = this._cacheData.originalRenderCanvas),
          t.render(this, { renderTexture: o, clear: !0, transform: a, skipUpdateTransform: !1 }),
          (t.context = i),
          (t._projTransform = n),
          (this.renderCanvas = this._renderCachedCanvas),
          (this.updateTransform = this.displayObjectUpdateTransform),
          (this.calculateBounds = this._calculateCachedBounds),
          (this.getLocalBounds = this._getCachedLocalBounds),
          (this._mask = null),
          (this.filterArea = null),
          (this.alpha = r);
        var h = new da(o);
        (h.transform.worldTransform = this.transform.worldTransform),
          (h.anchor.x = -e.x / e.width),
          (h.anchor.y = -e.y / e.height),
          (h.alpha = r),
          (h._bounds = this._bounds),
          (this._cacheData.sprite = h),
          (this.transform._parentID = -1),
          this.parent
            ? this.updateTransform()
            : ((this.parent = t._tempDisplayObjectParent),
              this.updateTransform(),
              (this.parent = null)),
          (this.containsPoint = h.containsPoint.bind(h));
      }
    }),
    (Pr.prototype._calculateCachedBounds = function () {
      this._bounds.clear(),
        (this._cacheData.sprite.transform._worldID = this.transform._worldID),
        this._cacheData.sprite._calculateBounds(),
        (this._bounds.updateID = this._boundsID);
    }),
    (Pr.prototype._getCachedLocalBounds = function () {
      return this._cacheData.sprite.getLocalBounds(null);
    }),
    (Pr.prototype._destroyCachedDisplayObject = function () {
      this._cacheData.sprite._texture.destroy(!0),
        (this._cacheData.sprite = null),
        si.removeFromCache(this._cacheData.textureCacheId),
        Ri.removeFromCache(this._cacheData.textureCacheId),
        (this._cacheData.textureCacheId = null);
    }),
    (Pr.prototype._cacheAsBitmapDestroy = function (t) {
      (this.cacheAsBitmap = !1), this.destroy(t);
    }),
    (Pr.prototype.name = null),
    (Dr.prototype.getChildByName = function (t, e) {
      for (var r = 0, i = this.children.length; r < i; r++)
        if (this.children[r].name === t) return this.children[r];
      if (e)
        for (r = 0, i = this.children.length; r < i; r++)
          if (this.children[r].getChildByName) {
            var n = this.children[r].getChildByName(t, !0);
            if (n) return n;
          }
      return null;
    }),
    (Pr.prototype.getGlobalPosition = function (t, e) {
      return (
        void 0 === t && (t = new Ye()),
        void 0 === e && (e = !1),
        this.parent
          ? this.parent.toGlobal(this.position, t, e)
          : ((t.x = this.position.x), (t.y = this.position.y)),
        t
      );
    });
  var Mu = function (t, e) {
    return (Mu =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (t, e) {
          t.__proto__ = e;
        }) ||
      function (t, e) {
        for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
      })(t, e);
  };
  function Nu(t, e) {
    function r() {
      this.constructor = t;
    }
    Mu(t, e),
      (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
  }
  var Du = (function (t) {
      function e(e, r, i, n) {
        void 0 === e && (e = 100),
          void 0 === r && (r = 100),
          void 0 === i && (i = 10),
          void 0 === n && (n = 10);
        var o = t.call(this) || this;
        return (o.segWidth = i), (o.segHeight = n), (o.width = e), (o.height = r), o.build(), o;
      }
      return (
        Nu(e, t),
        (e.prototype.build = function () {
          for (
            var t = this.segWidth * this.segHeight,
              e = [],
              r = [],
              i = [],
              n = this.segWidth - 1,
              o = this.segHeight - 1,
              s = this.width / n,
              a = this.height / o,
              h = 0;
            h < t;
            h++
          ) {
            var u = h % this.segWidth,
              l = (h / this.segWidth) | 0;
            e.push(u * s, l * a), r.push(u / n, l / o);
          }
          var c = n * o;
          for (h = 0; h < c; h++) {
            var d = h % n,
              f = (h / n) | 0,
              p = f * this.segWidth + d,
              _ = f * this.segWidth + d + 1,
              m = (f + 1) * this.segWidth + d,
              v = (f + 1) * this.segWidth + d + 1;
            i.push(p, _, m, _, v, m);
          }
          (this.buffers[0].data = new Float32Array(e)),
            (this.buffers[1].data = new Float32Array(r)),
            (this.indexBuffer.data = new Uint16Array(i)),
            this.buffers[0].update(),
            this.buffers[1].update(),
            this.indexBuffer.update();
        }),
        e
      );
    })(ih),
    Cu = (function (t) {
      function e(e, r, i) {
        void 0 === e && (e = 200), void 0 === i && (i = 0);
        var n =
          t.call(
            this,
            new Float32Array(4 * r.length),
            new Float32Array(4 * r.length),
            new Uint16Array(6 * (r.length - 1))
          ) || this;
        return (n.points = r), (n._width = e), (n.textureScale = i), n.build(), n;
      }
      return (
        Nu(e, t),
        Object.defineProperty(e.prototype, "width", {
          get: function () {
            return this._width;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.build = function () {
          var t = this.points;
          if (t) {
            var e = this.getBuffer("aVertexPosition"),
              r = this.getBuffer("aTextureCoord"),
              i = this.getIndex();
            if (!(t.length < 1)) {
              e.data.length / 4 !== t.length &&
                ((e.data = new Float32Array(4 * t.length)),
                (r.data = new Float32Array(4 * t.length)),
                (i.data = new Uint16Array(6 * (t.length - 1))));
              var n = r.data,
                o = i.data;
              (n[0] = 0), (n[1] = 0), (n[2] = 0), (n[3] = 1);
              for (
                var s = 0, a = t[0], h = this._width * this.textureScale, u = t.length, l = 0;
                l < u;
                l++
              ) {
                var c = 4 * l;
                if (this.textureScale > 0) {
                  var d = a.x - t[l].x,
                    f = a.y - t[l].y,
                    p = Math.sqrt(d * d + f * f);
                  (a = t[l]), (s += p / h);
                } else s = l / (u - 1);
                (n[c] = s), (n[c + 1] = 0), (n[c + 2] = s), (n[c + 3] = 1);
              }
              var _ = 0;
              for (l = 0; l < u - 1; l++)
                (c = 2 * l),
                  (o[_++] = c),
                  (o[_++] = c + 1),
                  (o[_++] = c + 2),
                  (o[_++] = c + 2),
                  (o[_++] = c + 1),
                  (o[_++] = c + 3);
              r.update(), i.update(), this.updateVertices();
            }
          }
        }),
        (e.prototype.updateVertices = function () {
          var t = this.points;
          if (!(t.length < 1)) {
            for (
              var e, r = t[0], i = 0, n = 0, o = this.buffers[0].data, s = t.length, a = 0;
              a < s;
              a++
            ) {
              var h = t[a],
                u = 4 * a;
              (n = -((e = a < t.length - 1 ? t[a + 1] : h).x - r.x)), (i = e.y - r.y);
              var l = Math.sqrt(i * i + n * n),
                c = this.textureScale > 0 ? (this.textureScale * this._width) / 2 : this._width / 2;
              (i /= l),
                (n /= l),
                (i *= c),
                (n *= c),
                (o[u] = h.x + i),
                (o[u + 1] = h.y + n),
                (o[u + 2] = h.x - i),
                (o[u + 3] = h.y - n),
                (r = h);
            }
            this.buffers[0].update();
          }
        }),
        (e.prototype.update = function () {
          this.textureScale > 0 ? this.build() : this.updateVertices();
        }),
        e
      );
    })(ih),
    Lu = (function (e) {
      function r(r, i, n) {
        void 0 === n && (n = 0);
        var o = this,
          s = new Cu(r.height, i, n),
          a = new rh(r);
        return (
          n > 0 && (r.baseTexture.wrapMode = t.WRAP_MODES.REPEAT),
          ((o = e.call(this, s, a) || this).autoUpdate = !0),
          o
        );
      }
      return (
        Nu(r, e),
        (r.prototype._render = function (t) {
          var r = this.geometry;
          (this.autoUpdate || r._width !== this.shader.texture.height) &&
            ((r._width = this.shader.texture.height), r.update()),
            e.prototype._render.call(this, t);
        }),
        r
      );
    })($a),
    wu = (function (t) {
      function e(e, r, i) {
        var n = this,
          o = new Du(e.width, e.height, r, i),
          s = new rh(Ri.WHITE);
        return ((n = t.call(this, o, s) || this).texture = e), (n.autoResize = !0), n;
      }
      return (
        Nu(e, t),
        (e.prototype.textureUpdated = function () {
          this._textureID = this.shader.texture._updateID;
          var t = this.geometry,
            e = this.shader.texture,
            r = e.width,
            i = e.height;
          !this.autoResize ||
            (t.width === r && t.height === i) ||
            ((t.width = this.shader.texture.width),
            (t.height = this.shader.texture.height),
            t.build());
        }),
        Object.defineProperty(e.prototype, "texture", {
          get: function () {
            return this.shader.texture;
          },
          set: function (t) {
            this.shader.texture !== t &&
              ((this.shader.texture = t),
              (this._textureID = -1),
              t.baseTexture.valid
                ? this.textureUpdated()
                : t.once("update", this.textureUpdated, this));
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype._render = function (e) {
          this._textureID !== this.shader.texture._updateID && this.textureUpdated(),
            t.prototype._render.call(this, e);
        }),
        (e.prototype.destroy = function (e) {
          this.shader.texture.off("update", this.textureUpdated, this),
            t.prototype.destroy.call(this, e);
        }),
        e
      );
    })($a),
    Fu = (function (t) {
      function e(e, r, i, n, o) {
        void 0 === e && (e = Ri.EMPTY);
        var s = this,
          a = new ih(r, i, n);
        a.getBuffer("aVertexPosition").static = !1;
        var h = new rh(e);
        return ((s = t.call(this, a, h, null, o) || this).autoUpdate = !0), s;
      }
      return (
        Nu(e, t),
        Object.defineProperty(e.prototype, "vertices", {
          get: function () {
            return this.geometry.getBuffer("aVertexPosition").data;
          },
          set: function (t) {
            this.geometry.getBuffer("aVertexPosition").data = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype._render = function (e) {
          this.autoUpdate && this.geometry.getBuffer("aVertexPosition").update(),
            t.prototype._render.call(this, e);
        }),
        e
      );
    })($a),
    Uu = 10,
    Bu = (function (t) {
      function e(e, r, i, n, o) {
        void 0 === r && (r = Uu),
          void 0 === i && (i = Uu),
          void 0 === n && (n = Uu),
          void 0 === o && (o = Uu);
        var s = t.call(this, Ri.WHITE, 4, 4) || this;
        return (
          (s._origWidth = e.orig.width),
          (s._origHeight = e.orig.height),
          (s._width = s._origWidth),
          (s._height = s._origHeight),
          (s._leftWidth = r),
          (s._rightWidth = n),
          (s._topHeight = i),
          (s._bottomHeight = o),
          (s.texture = e),
          s
        );
      }
      return (
        Nu(e, t),
        (e.prototype.textureUpdated = function () {
          (this._textureID = this.shader.texture._updateID), this._refresh();
        }),
        Object.defineProperty(e.prototype, "vertices", {
          get: function () {
            return this.geometry.getBuffer("aVertexPosition").data;
          },
          set: function (t) {
            this.geometry.getBuffer("aVertexPosition").data = t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype.updateHorizontalVertices = function () {
          var t = this.vertices,
            e = this._getMinScale();
          (t[9] = t[11] = t[13] = t[15] = this._topHeight * e),
            (t[17] = t[19] = t[21] = t[23] = this._height - this._bottomHeight * e),
            (t[25] = t[27] = t[29] = t[31] = this._height);
        }),
        (e.prototype.updateVerticalVertices = function () {
          var t = this.vertices,
            e = this._getMinScale();
          (t[2] = t[10] = t[18] = t[26] = this._leftWidth * e),
            (t[4] = t[12] = t[20] = t[28] = this._width - this._rightWidth * e),
            (t[6] = t[14] = t[22] = t[30] = this._width);
        }),
        (e.prototype._getMinScale = function () {
          var t = this._leftWidth + this._rightWidth,
            e = this._width > t ? 1 : this._width / t,
            r = this._topHeight + this._bottomHeight,
            i = this._height > r ? 1 : this._height / r;
          return Math.min(e, i);
        }),
        Object.defineProperty(e.prototype, "width", {
          get: function () {
            return this._width;
          },
          set: function (t) {
            (this._width = t), this._refresh();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "height", {
          get: function () {
            return this._height;
          },
          set: function (t) {
            (this._height = t), this._refresh();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "leftWidth", {
          get: function () {
            return this._leftWidth;
          },
          set: function (t) {
            (this._leftWidth = t), this._refresh();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "rightWidth", {
          get: function () {
            return this._rightWidth;
          },
          set: function (t) {
            (this._rightWidth = t), this._refresh();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "topHeight", {
          get: function () {
            return this._topHeight;
          },
          set: function (t) {
            (this._topHeight = t), this._refresh();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(e.prototype, "bottomHeight", {
          get: function () {
            return this._bottomHeight;
          },
          set: function (t) {
            (this._bottomHeight = t), this._refresh();
          },
          enumerable: !1,
          configurable: !0,
        }),
        (e.prototype._refresh = function () {
          var t = this.texture,
            e = this.geometry.buffers[1].data;
          (this._origWidth = t.orig.width), (this._origHeight = t.orig.height);
          var r = 1 / this._origWidth,
            i = 1 / this._origHeight;
          (e[0] = e[8] = e[16] = e[24] = 0),
            (e[1] = e[3] = e[5] = e[7] = 0),
            (e[6] = e[14] = e[22] = e[30] = 1),
            (e[25] = e[27] = e[29] = e[31] = 1),
            (e[2] = e[10] = e[18] = e[26] = r * this._leftWidth),
            (e[4] = e[12] = e[20] = e[28] = 1 - r * this._rightWidth),
            (e[9] = e[11] = e[13] = e[15] = i * this._topHeight),
            (e[17] = e[19] = e[21] = e[23] = 1 - i * this._bottomHeight),
            this.updateHorizontalVertices(),
            this.updateVerticalVertices(),
            this.geometry.buffers[0].update(),
            this.geometry.buffers[1].update();
        }),
        e
      );
    })(wu),
    Gu = function (t, e) {
      return (Gu =
        Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array &&
          function (t, e) {
            t.__proto__ = e;
          }) ||
        function (t, e) {
          for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r]);
        })(t, e);
    },
    Xu = (function (e) {
      function r(t, r) {
        void 0 === r && (r = !0);
        var i = e.call(this, t[0] instanceof Ri ? t[0] : t[0].texture) || this;
        return (
          (i._textures = null),
          (i._durations = null),
          (i._autoUpdate = r),
          (i._isConnectedToTicker = !1),
          (i.animationSpeed = 1),
          (i.loop = !0),
          (i.updateAnchor = !1),
          (i.onComplete = null),
          (i.onFrameChange = null),
          (i.onLoop = null),
          (i._currentTime = 0),
          (i._playing = !1),
          (i._previousFrame = null),
          (i.textures = t),
          i
        );
      }
      return (
        (function (t, e) {
          function r() {
            this.constructor = t;
          }
          Gu(t, e),
            (t.prototype = null === e ? Object.create(e) : ((r.prototype = e.prototype), new r()));
        })(r, e),
        (r.prototype.stop = function () {
          this._playing &&
            ((this._playing = !1),
            this._autoUpdate &&
              this._isConnectedToTicker &&
              (Xr.shared.remove(this.update, this), (this._isConnectedToTicker = !1)));
        }),
        (r.prototype.play = function () {
          this._playing ||
            ((this._playing = !0),
            this._autoUpdate &&
              !this._isConnectedToTicker &&
              (Xr.shared.add(this.update, this, t.UPDATE_PRIORITY.HIGH),
              (this._isConnectedToTicker = !0)));
        }),
        (r.prototype.gotoAndStop = function (t) {
          this.stop();
          var e = this.currentFrame;
          (this._currentTime = t), e !== this.currentFrame && this.updateTexture();
        }),
        (r.prototype.gotoAndPlay = function (t) {
          var e = this.currentFrame;
          (this._currentTime = t), e !== this.currentFrame && this.updateTexture(), this.play();
        }),
        (r.prototype.update = function (t) {
          if (this._playing) {
            var e = this.animationSpeed * t,
              r = this.currentFrame;
            if (null !== this._durations) {
              var i = (this._currentTime % 1) * this._durations[this.currentFrame];
              for (i += (e / 60) * 1e3; i < 0; )
                this._currentTime--, (i += this._durations[this.currentFrame]);
              var n = Math.sign(this.animationSpeed * t);
              for (
                this._currentTime = Math.floor(this._currentTime);
                i >= this._durations[this.currentFrame];

              )
                (i -= this._durations[this.currentFrame] * n), (this._currentTime += n);
              this._currentTime += i / this._durations[this.currentFrame];
            } else this._currentTime += e;
            this._currentTime < 0 && !this.loop
              ? (this.gotoAndStop(0), this.onComplete && this.onComplete())
              : this._currentTime >= this._textures.length && !this.loop
              ? (this.gotoAndStop(this._textures.length - 1), this.onComplete && this.onComplete())
              : r !== this.currentFrame &&
                (this.loop &&
                  this.onLoop &&
                  (this.animationSpeed > 0 && this.currentFrame < r
                    ? this.onLoop()
                    : this.animationSpeed < 0 && this.currentFrame > r && this.onLoop()),
                this.updateTexture());
          }
        }),
        (r.prototype.updateTexture = function () {
          var t = this.currentFrame;
          this._previousFrame !== t &&
            ((this._previousFrame = t),
            (this._texture = this._textures[t]),
            (this._textureID = -1),
            (this._textureTrimmedID = -1),
            (this._cachedTint = 16777215),
            (this.uvs = this._texture._uvs.uvsFloat32),
            this.updateAnchor && this._anchor.copyFrom(this._texture.defaultAnchor),
            this.onFrameChange && this.onFrameChange(this.currentFrame));
        }),
        (r.prototype.destroy = function (t) {
          this.stop(),
            e.prototype.destroy.call(this, t),
            (this.onComplete = null),
            (this.onFrameChange = null),
            (this.onLoop = null);
        }),
        (r.fromFrames = function (t) {
          for (var e = [], i = 0; i < t.length; ++i) e.push(Ri.from(t[i]));
          return new r(e);
        }),
        (r.fromImages = function (t) {
          for (var e = [], i = 0; i < t.length; ++i) e.push(Ri.from(t[i]));
          return new r(e);
        }),
        Object.defineProperty(r.prototype, "totalFrames", {
          get: function () {
            return this._textures.length;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "textures", {
          get: function () {
            return this._textures;
          },
          set: function (t) {
            if (t[0] instanceof Ri) (this._textures = t), (this._durations = null);
            else {
              (this._textures = []), (this._durations = []);
              for (var e = 0; e < t.length; e++)
                this._textures.push(t[e].texture), this._durations.push(t[e].time);
            }
            (this._previousFrame = null), this.gotoAndStop(0), this.updateTexture();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "currentFrame", {
          get: function () {
            var t = Math.floor(this._currentTime) % this._textures.length;
            return t < 0 && (t += this._textures.length), t;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "playing", {
          get: function () {
            return this._playing;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "autoUpdate", {
          get: function () {
            return this._autoUpdate;
          },
          set: function (t) {
            t !== this._autoUpdate &&
              ((this._autoUpdate = t),
              !this._autoUpdate && this._isConnectedToTicker
                ? (Xr.shared.remove(this.update, this), (this._isConnectedToTicker = !1))
                : this._autoUpdate &&
                  !this._isConnectedToTicker &&
                  this._playing &&
                  (Xr.shared.add(this.update, this), (this._isConnectedToTicker = !0)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        r
      );
    })(da);
  po.registerPlugin("accessibility", Br),
    po.registerPlugin("extract", Uo),
    po.registerPlugin("interaction", Zr),
    po.registerPlugin("particle", Ns),
    po.registerPlugin("prepare", Ua),
    po.registerPlugin("batch", Io),
    po.registerPlugin("tilingSprite", za),
    Jo.registerPlugin(Th),
    Jo.registerPlugin(ls),
    Jo.registerPlugin(Ts),
    Jo.registerPlugin(As),
    Jo.registerPlugin(Xa),
    Lo.registerPlugin(kr),
    Lo.registerPlugin(ts);
  var ku = {
    AlphaFilter: Rh,
    BlurFilter: qh,
    BlurFilterPass: zh,
    ColorMatrixFilter: Qh,
    DisplacementFilter: yu,
    FXAAFilter: Au,
    NoiseFilter: Ou,
  };
  return (
    (t.AbstractBatchRenderer = Ro),
    (t.AbstractMultiResource = ai),
    (t.AbstractRenderer = lo),
    (t.AccessibilityManager = Br),
    (t.AnimatedSprite = Xu),
    (t.AppLoaderPlugin = ts),
    (t.Application = Lo),
    (t.ArrayResource = hi),
    (t.Attribute = Si),
    (t.BaseImageResource = ui),
    (t.BasePrepare = Ca),
    (t.BaseRenderTexture = Ti),
    (t.BaseTexture = si),
    (t.BatchDrawCall = To),
    (t.BatchGeometry = Ao),
    (t.BatchPluginFactory = Oo),
    (t.BatchRenderer = Io),
    (t.BatchShaderGenerator = bo),
    (t.BatchSystem = Yi),
    (t.BatchTextureArray = yo),
    (t.BitmapFont = ph),
    (t.BitmapFontData = oh),
    (t.BitmapFontLoader = Th),
    (t.BitmapText = Eh),
    (t.BlobResource = hs),
    (t.Bounds = ar),
    (t.Buffer = Ii),
    (t.BufferResource = ni),
    (t.CanvasResource = li),
    (t.Circle = We),
    (t.CompressedTextureLoader = ls),
    (t.CompressedTextureResource = us),
    (t.Container = Dr),
    (t.ContextSystem = Vi),
    (t.CountLimiter = xa),
    (t.CubeResource = ci),
    (t.DDSLoader = Ts),
    (t.DEG_TO_RAD = He),
    (t.DisplayObject = Pr),
    (t.Ellipse = ze),
    (t.Extract = Uo),
    (t.FORMATS_TO_COMPONENTS = Rs),
    (t.FillStyle = Cs),
    (t.Filter = xn),
    (t.FilterState = Bi),
    (t.FilterSystem = ki),
    (t.Framebuffer = Ei),
    (t.FramebufferSystem = qi),
    (t.GLFramebuffer = Wi),
    (t.GLProgram = zn),
    (t.GLTexture = so),
    (t.GRAPHICS_CURVES = Ds),
    (t.Geometry = Ci),
    (t.GeometrySystem = Zi),
    (t.Graphics = aa),
    (t.GraphicsData = ta),
    (t.GraphicsGeometry = ia),
    (t.IGLUniformData = Wn),
    (t.INSTALLED = Jr),
    (t.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL = is),
    (t.ImageBitmapResource = _i),
    (t.ImageResource = di),
    (t.InteractionData = Hr),
    (t.InteractionEvent = jr),
    (t.InteractionManager = Zr),
    (t.InteractionTrackingData = Vr),
    (t.KTXLoader = As),
    (t.LineStyle = na),
    (t.Loader = Jo),
    (t.MaskData = Qi),
    (t.MaskSystem = Nn),
    (t.Matrix = Qe),
    (t.Mesh = $a),
    (t.MeshBatchUvs = Za),
    (t.MeshGeometry = ih),
    (t.MeshMaterial = rh),
    (t.NineSlicePlane = Bu),
    (t.ObjectRenderer = Hi),
    (t.ObservablePoint = Ze),
    (t.PI_2 = Xe),
    (t.ParticleContainer = Os),
    (t.ParticleRenderer = Ns),
    (t.PlaneGeometry = Du),
    (t.Point = Ye),
    (t.Polygon = qe),
    (t.Prepare = Ua),
    (t.Program = Rn),
    (t.ProjectionSystem = Fn),
    (t.Quad = Li),
    (t.QuadUv = wi),
    (t.RAD_TO_DEG = ke),
    (t.Rectangle = Ve),
    (t.RenderTexture = Ai),
    (t.RenderTexturePool = xi),
    (t.RenderTextureSystem = Gn),
    (t.Renderer = po),
    (t.Resource = ii),
    (t.RopeGeometry = Cu),
    (t.RoundedRectangle = Ke),
    (t.Runner = Qr),
    (t.SVGResource = fi),
    (t.ScissorSystem = Ln),
    (t.Shader = bn),
    (t.ShaderSystem = Qn),
    (t.SimpleMesh = Fu),
    (t.SimplePlane = wu),
    (t.SimpleRope = Lu),
    (t.Sprite = da),
    (t.SpriteMaskFilter = Mn),
    (t.Spritesheet = Ga),
    (t.SpritesheetLoader = Xa),
    (t.State = An),
    (t.StateSystem = no),
    (t.StencilSystem = wn),
    (t.System = Eo),
    (t.TYPES_TO_BYTES_PER_COMPONENT = gs),
    (t.TYPES_TO_BYTES_PER_PIXEL = bs),
    (t.TemporaryDisplayObject = Mr),
    (t.Text = ba),
    (t.TextMetrics = ya),
    (t.TextStyle = ma),
    (t.Texture = Ri),
    (t.TextureGCSystem = oo),
    (t.TextureLoader = es),
    (t.TextureMatrix = Pn),
    (t.TextureSystem = ao),
    (t.TextureUvs = yi),
    (t.Ticker = Xr),
    (t.TickerPlugin = kr),
    (t.TilingSprite = ja),
    (t.TilingSpriteRenderer = za),
    (t.TimeLimiter = Ba),
    (t.Transform = sr),
    (t.UniformGroup = Ui),
    (t.VERSION = "6.3.0"),
    (t.VideoResource = pi),
    (t.ViewableBuffer = go),
    (t.accessibleTarget = Cr),
    (t.autoDetectRenderer = _o),
    (t.autoDetectResource = $r),
    (t.checkMaxIfStatementsInShader = Tn),
    (t.createUBOElements = Yn),
    (t.defaultFilterVertex = vo),
    (t.defaultVertex = mo),
    (t.filters = ku),
    (t.generateProgram = qn),
    (t.generateUniformBufferSync = Vn),
    (t.getTestContext = sn),
    (t.getUBOData = jn),
    (t.graphicsUtils = ha),
    (t.groupD8 = or),
    (t.interactiveTarget = zr),
    (t.isMobile = et),
    (t.resources = Po),
    (t.settings = rt),
    (t.systems = Do),
    (t.uniformParsers = pn),
    (t.utils = Ge),
    t
  );
})({});
var __filters = (function (e, n, t, r, o, i, l, a) {
  "use strict";
  var s = function (e, n) {
    return (s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (e, n) {
          e.__proto__ = n;
        }) ||
      function (e, n) {
        for (var t in n) Object.prototype.hasOwnProperty.call(n, t) && (e[t] = n[t]);
      })(e, n);
  };
  function u(e, n) {
    function t() {
      this.constructor = e;
    }
    s(e, n), (e.prototype = null === n ? Object.create(n) : ((t.prototype = n.prototype), new t()));
  }
  var f = function () {
    return (f =
      Object.assign ||
      function (e) {
        for (var n, t = arguments, r = 1, o = arguments.length; r < o; r++)
          for (var i in (n = t[r])) Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);
        return e;
      }).apply(this, arguments);
  };
  Object.create;
  Object.create;
  var c =
      "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
    m = (function (e) {
      function n(n) {
        var t =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float gamma;\nuniform float contrast;\nuniform float saturation;\nuniform float brightness;\nuniform float red;\nuniform float green;\nuniform float blue;\nuniform float alpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (c.a > 0.0) {\n        c.rgb /= c.a;\n\n        vec3 rgb = pow(c.rgb, vec3(1. / gamma));\n        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);\n        rgb.r *= red;\n        rgb.g *= green;\n        rgb.b *= blue;\n        c.rgb = rgb * brightness;\n\n        c.rgb *= c.a;\n    }\n\n    gl_FragColor = c * alpha;\n}\n"
          ) || this;
        return (
          (t.gamma = 1),
          (t.saturation = 1),
          (t.contrast = 1),
          (t.brightness = 1),
          (t.red = 1),
          (t.green = 1),
          (t.blue = 1),
          (t.alpha = 1),
          Object.assign(t, n),
          t
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          (this.uniforms.gamma = Math.max(this.gamma, 1e-4)),
            (this.uniforms.saturation = this.saturation),
            (this.uniforms.contrast = this.contrast),
            (this.uniforms.brightness = this.brightness),
            (this.uniforms.red = this.red),
            (this.uniforms.green = this.green),
            (this.uniforms.blue = this.blue),
            (this.uniforms.alpha = this.alpha),
            e.applyFilter(this, n, t, r);
        }),
        n
      );
    })(n.Filter),
    p = (function (e) {
      function n(n) {
        void 0 === n && (n = 0.5);
        var t =
          e.call(
            this,
            c,
            "\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n"
          ) || this;
        return (t.threshold = n), t;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "threshold", {
          get: function () {
            return this.uniforms.threshold;
          },
          set: function (e) {
            this.uniforms.threshold = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    d = (function (e) {
      function n(n, r, o) {
        void 0 === n && (n = 4), void 0 === r && (r = 3), void 0 === o && (o = !1);
        var i =
          e.call(
            this,
            c,
            o
              ? "\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n"
              : "\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}"
          ) || this;
        return (
          (i._kernels = []),
          (i._blur = 4),
          (i._quality = 3),
          (i.uniforms.uOffset = new Float32Array(2)),
          (i._pixelSize = new t.Point()),
          (i.pixelSize = 1),
          (i._clamp = o),
          Array.isArray(n) ? (i.kernels = n) : ((i._blur = n), (i.quality = r)),
          i
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o,
            i = this._pixelSize.x / n._frame.width,
            l = this._pixelSize.y / n._frame.height;
          if (1 === this._quality || 0 === this._blur)
            (o = this._kernels[0] + 0.5),
              (this.uniforms.uOffset[0] = o * i),
              (this.uniforms.uOffset[1] = o * l),
              e.applyFilter(this, n, t, r);
          else {
            for (
              var a = e.getFilterTexture(), s = n, u = a, f = void 0, c = this._quality - 1, m = 0;
              m < c;
              m++
            )
              (o = this._kernels[m] + 0.5),
                (this.uniforms.uOffset[0] = o * i),
                (this.uniforms.uOffset[1] = o * l),
                e.applyFilter(this, s, u, 1),
                (f = s),
                (s = u),
                (u = f);
            (o = this._kernels[c] + 0.5),
              (this.uniforms.uOffset[0] = o * i),
              (this.uniforms.uOffset[1] = o * l),
              e.applyFilter(this, s, t, r),
              e.returnFilterTexture(a);
          }
        }),
        (n.prototype._updatePadding = function () {
          this.padding = Math.ceil(
            this._kernels.reduce(function (e, n) {
              return e + n + 0.5;
            }, 0)
          );
        }),
        (n.prototype._generateKernels = function () {
          var e = this._blur,
            n = this._quality,
            t = [e];
          if (e > 0) for (var r = e, o = e / n, i = 1; i < n; i++) (r -= o), t.push(r);
          (this._kernels = t), this._updatePadding();
        }),
        Object.defineProperty(n.prototype, "kernels", {
          get: function () {
            return this._kernels;
          },
          set: function (e) {
            Array.isArray(e) && e.length > 0
              ? ((this._kernels = e),
                (this._quality = e.length),
                (this._blur = Math.max.apply(Math, e)))
              : ((this._kernels = [0]), (this._quality = 1));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "clamp", {
          get: function () {
            return this._clamp;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "pixelSize", {
          get: function () {
            return this._pixelSize;
          },
          set: function (e) {
            "number" == typeof e
              ? ((this._pixelSize.x = e), (this._pixelSize.y = e))
              : Array.isArray(e)
              ? ((this._pixelSize.x = e[0]), (this._pixelSize.y = e[1]))
              : e instanceof t.Point
              ? ((this._pixelSize.x = e.x), (this._pixelSize.y = e.y))
              : ((this._pixelSize.x = 1), (this._pixelSize.y = 1));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "quality", {
          get: function () {
            return this._quality;
          },
          set: function (e) {
            (this._quality = Math.max(1, Math.round(e))), this._generateKernels();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "blur", {
          get: function () {
            return this._blur;
          },
          set: function (e) {
            (this._blur = e), this._generateKernels();
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    h = (function (e) {
      function n(t) {
        var o =
          e.call(
            this,
            c,
            "uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n"
          ) || this;
        (o.bloomScale = 1),
          (o.brightness = 1),
          (o._resolution = r.settings.FILTER_RESOLUTION),
          "number" == typeof t && (t = { threshold: t });
        var i = Object.assign(n.defaults, t);
        (o.bloomScale = i.bloomScale), (o.brightness = i.brightness);
        var l = i.kernels,
          a = i.blur,
          s = i.quality,
          u = i.pixelSize,
          f = i.resolution;
        return (
          (o._extractFilter = new p(i.threshold)),
          (o._extractFilter.resolution = f),
          (o._blurFilter = l ? new d(l) : new d(a, s)),
          (o.pixelSize = u),
          (o.resolution = f),
          o
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r, o) {
          var i = e.getFilterTexture();
          this._extractFilter.apply(e, n, i, 1, o);
          var l = e.getFilterTexture();
          this._blurFilter.apply(e, i, l, 1),
            (this.uniforms.bloomScale = this.bloomScale),
            (this.uniforms.brightness = this.brightness),
            (this.uniforms.bloomTexture = l),
            e.applyFilter(this, n, t, r),
            e.returnFilterTexture(l),
            e.returnFilterTexture(i);
        }),
        Object.defineProperty(n.prototype, "resolution", {
          get: function () {
            return this._resolution;
          },
          set: function (e) {
            (this._resolution = e),
              this._extractFilter && (this._extractFilter.resolution = e),
              this._blurFilter && (this._blurFilter.resolution = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "threshold", {
          get: function () {
            return this._extractFilter.threshold;
          },
          set: function (e) {
            this._extractFilter.threshold = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "kernels", {
          get: function () {
            return this._blurFilter.kernels;
          },
          set: function (e) {
            this._blurFilter.kernels = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "blur", {
          get: function () {
            return this._blurFilter.blur;
          },
          set: function (e) {
            this._blurFilter.blur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "quality", {
          get: function () {
            return this._blurFilter.quality;
          },
          set: function (e) {
            this._blurFilter.quality = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "pixelSize", {
          get: function () {
            return this._blurFilter.pixelSize;
          },
          set: function (e) {
            this._blurFilter.pixelSize = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          threshold: 0.5,
          bloomScale: 1,
          brightness: 1,
          kernels: null,
          blur: 8,
          quality: 4,
          pixelSize: 1,
          resolution: r.settings.FILTER_RESOLUTION,
        }),
        n
      );
    })(n.Filter),
    g = (function (e) {
      function n(n) {
        void 0 === n && (n = 8);
        var t =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n    return floor( coord / size ) * size;\n}\n\nvec2 getMod(vec2 coord, vec2 size)\n{\n    return mod( coord , size) / size;\n}\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n\n    if (clamp(p.x, 0.0, 4.0) == p.x)\n    {\n        if (clamp(p.y, 0.0, 4.0) == p.y)\n        {\n            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n        }\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    // get the rounded color..\n    vec2 pixCoord = pixelate(coord, vec2(pixelSize));\n    pixCoord = unmapCoord(pixCoord);\n\n    vec4 color = texture2D(uSampler, pixCoord);\n\n    // determine the character to use\n    float gray = (color.r + color.g + color.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    // get the mod..\n    vec2 modd = getMod(coord, vec2(pixelSize));\n\n    gl_FragColor = color * character( n, vec2(-1.0) + modd * 2.0);\n\n}\n"
          ) || this;
        return (t.size = n), t;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "size", {
          get: function () {
            return this.uniforms.pixelSize;
          },
          set: function (e) {
            this.uniforms.pixelSize = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    v = (function (e) {
      function n(n) {
        var t =
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform float transformX;\nuniform float transformY;\nuniform vec3 lightColor;\nuniform float lightAlpha;\nuniform vec3 shadowColor;\nuniform float shadowAlpha;\n\nvoid main(void) {\n    vec2 transform = vec2(1.0 / filterArea) * vec2(transformX, transformY);\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float light = texture2D(uSampler, vTextureCoord - transform).a;\n    float shadow = texture2D(uSampler, vTextureCoord + transform).a;\n\n    color.rgb = mix(color.rgb, lightColor, clamp((color.a - light) * lightAlpha, 0.0, 1.0));\n    color.rgb = mix(color.rgb, shadowColor, clamp((color.a - shadow) * shadowAlpha, 0.0, 1.0));\n    gl_FragColor = vec4(color.rgb * color.a, color.a);\n}\n"
          ) || this;
        return (
          (t._thickness = 2),
          (t._angle = 0),
          (t.uniforms.lightColor = new Float32Array(3)),
          (t.uniforms.shadowColor = new Float32Array(3)),
          Object.assign(
            t,
            {
              rotation: 45,
              thickness: 2,
              lightColor: 16777215,
              lightAlpha: 0.7,
              shadowColor: 0,
              shadowAlpha: 0.7,
            },
            n
          ),
          (t.padding = 1),
          t
        );
      }
      return (
        u(n, e),
        (n.prototype._updateTransform = function () {
          (this.uniforms.transformX = this._thickness * Math.cos(this._angle)),
            (this.uniforms.transformY = this._thickness * Math.sin(this._angle));
        }),
        Object.defineProperty(n.prototype, "rotation", {
          get: function () {
            return this._angle / t.DEG_TO_RAD;
          },
          set: function (e) {
            (this._angle = e * t.DEG_TO_RAD), this._updateTransform();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "thickness", {
          get: function () {
            return this._thickness;
          },
          set: function (e) {
            (this._thickness = e), this._updateTransform();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "lightColor", {
          get: function () {
            return o.rgb2hex(this.uniforms.lightColor);
          },
          set: function (e) {
            o.hex2rgb(e, this.uniforms.lightColor);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "lightAlpha", {
          get: function () {
            return this.uniforms.lightAlpha;
          },
          set: function (e) {
            this.uniforms.lightAlpha = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "shadowColor", {
          get: function () {
            return o.rgb2hex(this.uniforms.shadowColor);
          },
          set: function (e) {
            o.hex2rgb(e, this.uniforms.shadowColor);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "shadowAlpha", {
          get: function () {
            return this.uniforms.shadowAlpha;
          },
          set: function (e) {
            this.uniforms.shadowAlpha = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    y = (function (e) {
      function n(n, o, s, u) {
        void 0 === n && (n = 2),
          void 0 === o && (o = 4),
          void 0 === s && (s = r.settings.FILTER_RESOLUTION),
          void 0 === u && (u = 5);
        var f,
          c,
          m = e.call(this) || this;
        return (
          "number" == typeof n
            ? ((f = n), (c = n))
            : n instanceof t.Point
            ? ((f = n.x), (c = n.y))
            : Array.isArray(n) && ((f = n[0]), (c = n[1])),
          (m.blurXFilter = new a.BlurFilterPass(!0, f, o, s, u)),
          (m.blurYFilter = new a.BlurFilterPass(!1, c, o, s, u)),
          (m.blurYFilter.blendMode = i.BLEND_MODES.SCREEN),
          (m.defaultFilter = new l.AlphaFilter()),
          m
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o = e.getFilterTexture();
          this.defaultFilter.apply(e, n, t, r),
            this.blurXFilter.apply(e, n, o, 1),
            this.blurYFilter.apply(e, o, t, 0),
            e.returnFilterTexture(o);
        }),
        Object.defineProperty(n.prototype, "blur", {
          get: function () {
            return this.blurXFilter.blur;
          },
          set: function (e) {
            this.blurXFilter.blur = this.blurYFilter.blur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "blurX", {
          get: function () {
            return this.blurXFilter.blur;
          },
          set: function (e) {
            this.blurXFilter.blur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "blurY", {
          get: function () {
            return this.blurYFilter.blur;
          },
          set: function (e) {
            this.blurYFilter.blur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    b = (function (e) {
      function n(t) {
        var r =
          e.call(
            this,
            c,
            "uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n"
          ) || this;
        return (r.uniforms.dimensions = new Float32Array(2)), Object.assign(r, n.defaults, t), r;
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o = n.filterFrame,
            i = o.width,
            l = o.height;
          (this.uniforms.dimensions[0] = i),
            (this.uniforms.dimensions[1] = l),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "radius", {
          get: function () {
            return this.uniforms.radius;
          },
          set: function (e) {
            this.uniforms.radius = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "strength", {
          get: function () {
            return this.uniforms.strength;
          },
          set: function (e) {
            this.uniforms.strength = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "center", {
          get: function () {
            return this.uniforms.center;
          },
          set: function (e) {
            this.uniforms.center = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = { center: [0.5, 0.5], radius: 100, strength: 1 }),
        n
      );
    })(n.Filter),
    x = (function (e) {
      function t(n, t, r) {
        void 0 === t && (t = !1), void 0 === r && (r = 1);
        var o =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D colorMap;\nuniform float _mix;\nuniform float _size;\nuniform float _sliceSize;\nuniform float _slicePixelSize;\nuniform float _sliceInnerSize;\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord.xy);\n\n    vec4 adjusted;\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n        float innerWidth = _size - 1.0;\n        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);\n        float zSlice1 = min(zSlice0 + 1.0, innerWidth);\n        float xOffset = _slicePixelSize * 0.5 + color.r * _sliceInnerSize;\n        float s0 = xOffset + (zSlice0 * _sliceSize);\n        float s1 = xOffset + (zSlice1 * _sliceSize);\n        float yOffset = _sliceSize * 0.5 + color.g * (1.0 - _sliceSize);\n        vec4 slice0Color = texture2D(colorMap, vec2(s0,yOffset));\n        vec4 slice1Color = texture2D(colorMap, vec2(s1,yOffset));\n        float zOffset = fract(color.b * innerWidth);\n        adjusted = mix(slice0Color, slice1Color, zOffset);\n\n        color.rgb *= color.a;\n    }\n    gl_FragColor = vec4(mix(color, adjusted, _mix).rgb, color.a);\n\n}"
          ) || this;
        return (
          (o.mix = 1),
          (o._size = 0),
          (o._sliceSize = 0),
          (o._slicePixelSize = 0),
          (o._sliceInnerSize = 0),
          (o._nearest = !1),
          (o._scaleMode = null),
          (o._colorMap = null),
          (o._scaleMode = null),
          (o.nearest = t),
          (o.mix = r),
          (o.colorMap = n),
          o
        );
      }
      return (
        u(t, e),
        (t.prototype.apply = function (e, n, t, r) {
          (this.uniforms._mix = this.mix), e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(t.prototype, "colorSize", {
          get: function () {
            return this._size;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "colorMap", {
          get: function () {
            return this._colorMap;
          },
          set: function (e) {
            var t;
            e &&
              (e instanceof n.Texture || (e = n.Texture.from(e)),
              (null === (t = e) || void 0 === t ? void 0 : t.baseTexture) &&
                ((e.baseTexture.scaleMode = this._scaleMode),
                (e.baseTexture.mipmap = i.MIPMAP_MODES.OFF),
                (this._size = e.height),
                (this._sliceSize = 1 / this._size),
                (this._slicePixelSize = this._sliceSize / this._size),
                (this._sliceInnerSize = this._slicePixelSize * (this._size - 1)),
                (this.uniforms._size = this._size),
                (this.uniforms._sliceSize = this._sliceSize),
                (this.uniforms._slicePixelSize = this._slicePixelSize),
                (this.uniforms._sliceInnerSize = this._sliceInnerSize),
                (this.uniforms.colorMap = e)),
              (this._colorMap = e));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(t.prototype, "nearest", {
          get: function () {
            return this._nearest;
          },
          set: function (e) {
            (this._nearest = e),
              (this._scaleMode = e ? i.SCALE_MODES.NEAREST : i.SCALE_MODES.LINEAR);
            var n = this._colorMap;
            n &&
              n.baseTexture &&
              ((n.baseTexture._glTextures = {}),
              (n.baseTexture.scaleMode = this._scaleMode),
              (n.baseTexture.mipmap = i.MIPMAP_MODES.OFF),
              n._updateID++,
              n.baseTexture.emit("update", n.baseTexture));
          },
          enumerable: !1,
          configurable: !0,
        }),
        (t.prototype.updateColorMap = function () {
          var e = this._colorMap;
          e &&
            e.baseTexture &&
            (e._updateID++, e.baseTexture.emit("update", e.baseTexture), (this.colorMap = e));
        }),
        (t.prototype.destroy = function (n) {
          void 0 === n && (n = !1),
            this._colorMap && this._colorMap.destroy(n),
            e.prototype.destroy.call(this);
        }),
        t
      );
    })(n.Filter),
    _ = (function (e) {
      function n(n, t) {
        void 0 === n && (n = 0), void 0 === t && (t = 1);
        var r =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 color;\nuniform float alpha;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);\n}\n"
          ) || this;
        return (
          (r._color = 0),
          (r._alpha = 1),
          (r.uniforms.color = new Float32Array(3)),
          (r.color = n),
          (r.alpha = t),
          r
        );
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "color", {
          get: function () {
            return this._color;
          },
          set: function (e) {
            var n = this.uniforms.color;
            "number" == typeof e
              ? (o.hex2rgb(e, n), (this._color = e))
              : ((n[0] = e[0]), (n[1] = e[1]), (n[2] = e[2]), (this._color = o.rgb2hex(n)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "alpha", {
          get: function () {
            return this._alpha;
          },
          set: function (e) {
            (this.uniforms.alpha = e), (this._alpha = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    C = (function (e) {
      function n(n, t, r) {
        void 0 === n && (n = 16711680), void 0 === t && (t = 0), void 0 === r && (r = 0.4);
        var o =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 originalColor;\nuniform vec3 newColor;\nuniform float epsilon;\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    vec3 colorDiff = originalColor - (currentColor.rgb / max(currentColor.a, 0.0000000001));\n    float colorDistance = length(colorDiff);\n    float doReplace = step(colorDistance, epsilon);\n    gl_FragColor = vec4(mix(currentColor.rgb, (newColor + colorDiff) * currentColor.a, doReplace), currentColor.a);\n}\n"
          ) || this;
        return (
          (o._originalColor = 16711680),
          (o._newColor = 0),
          (o.uniforms.originalColor = new Float32Array(3)),
          (o.uniforms.newColor = new Float32Array(3)),
          (o.originalColor = n),
          (o.newColor = t),
          (o.epsilon = r),
          o
        );
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "originalColor", {
          get: function () {
            return this._originalColor;
          },
          set: function (e) {
            var n = this.uniforms.originalColor;
            "number" == typeof e
              ? (o.hex2rgb(e, n), (this._originalColor = e))
              : ((n[0] = e[0]), (n[1] = e[1]), (n[2] = e[2]), (this._originalColor = o.rgb2hex(n)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "newColor", {
          get: function () {
            return this._newColor;
          },
          set: function (e) {
            var n = this.uniforms.newColor;
            "number" == typeof e
              ? (o.hex2rgb(e, n), (this._newColor = e))
              : ((n[0] = e[0]), (n[1] = e[1]), (n[2] = e[2]), (this._newColor = o.rgb2hex(n)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "epsilon", {
          get: function () {
            return this.uniforms.epsilon;
          },
          set: function (e) {
            this.uniforms.epsilon = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    S = (function (e) {
      function n(n, t, r) {
        void 0 === t && (t = 200), void 0 === r && (r = 200);
        var o =
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n"
          ) || this;
        return (
          (o.uniforms.texelSize = new Float32Array(2)),
          (o.uniforms.matrix = new Float32Array(9)),
          void 0 !== n && (o.matrix = n),
          (o.width = t),
          (o.height = r),
          o
        );
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "matrix", {
          get: function () {
            return this.uniforms.matrix;
          },
          set: function (e) {
            var n = this;
            e.forEach(function (e, t) {
              n.uniforms.matrix[t] = e;
            });
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "width", {
          get: function () {
            return 1 / this.uniforms.texelSize[0];
          },
          set: function (e) {
            this.uniforms.texelSize[0] = 1 / e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "height", {
          get: function () {
            return 1 / this.uniforms.texelSize[1];
          },
          set: function (e) {
            this.uniforms.texelSize[1] = 1 / e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    F = (function (e) {
      function n() {
        return (
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n"
          ) || this
        );
      }
      return u(n, e), n;
    })(n.Filter),
    z = (function (e) {
      function n(t) {
        var r =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy - vec2(0.5, 0.5)) * filterArea.xy / dimensions;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n"
          ) || this;
        return (
          (r.time = 0),
          (r.seed = 0),
          (r.uniforms.dimensions = new Float32Array(2)),
          Object.assign(r, n.defaults, t),
          r
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o = n.filterFrame,
            i = o.width,
            l = o.height;
          (this.uniforms.dimensions[0] = i),
            (this.uniforms.dimensions[1] = l),
            (this.uniforms.seed = this.seed),
            (this.uniforms.time = this.time),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "curvature", {
          get: function () {
            return this.uniforms.curvature;
          },
          set: function (e) {
            this.uniforms.curvature = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "lineWidth", {
          get: function () {
            return this.uniforms.lineWidth;
          },
          set: function (e) {
            this.uniforms.lineWidth = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "lineContrast", {
          get: function () {
            return this.uniforms.lineContrast;
          },
          set: function (e) {
            this.uniforms.lineContrast = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "verticalLine", {
          get: function () {
            return this.uniforms.verticalLine;
          },
          set: function (e) {
            this.uniforms.verticalLine = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "noise", {
          get: function () {
            return this.uniforms.noise;
          },
          set: function (e) {
            this.uniforms.noise = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "noiseSize", {
          get: function () {
            return this.uniforms.noiseSize;
          },
          set: function (e) {
            this.uniforms.noiseSize = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "vignetting", {
          get: function () {
            return this.uniforms.vignetting;
          },
          set: function (e) {
            this.uniforms.vignetting = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "vignettingAlpha", {
          get: function () {
            return this.uniforms.vignettingAlpha;
          },
          set: function (e) {
            this.uniforms.vignettingAlpha = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "vignettingBlur", {
          get: function () {
            return this.uniforms.vignettingBlur;
          },
          set: function (e) {
            this.uniforms.vignettingBlur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          curvature: 1,
          lineWidth: 1,
          lineContrast: 0.25,
          verticalLine: !1,
          noise: 0,
          noiseSize: 1,
          seed: 0,
          vignetting: 0.3,
          vignettingAlpha: 1,
          vignettingBlur: 0.3,
          time: 0,
        }),
        n
      );
    })(n.Filter),
    O = (function (e) {
      function n(n, t) {
        void 0 === n && (n = 1), void 0 === t && (t = 5);
        var r =
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 filterArea;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * filterArea.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n"
          ) || this;
        return (r.scale = n), (r.angle = t), r;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "scale", {
          get: function () {
            return this.uniforms.scale;
          },
          set: function (e) {
            this.uniforms.scale = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "angle", {
          get: function () {
            return this.uniforms.angle;
          },
          set: function (e) {
            this.uniforms.angle = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    P = (function (e) {
      function i(o) {
        var l = e.call(this) || this;
        (l.angle = 45), (l._distance = 5), (l._resolution = r.settings.FILTER_RESOLUTION);
        var a = o ? f(f({}, i.defaults), o) : i.defaults,
          s = a.kernels,
          u = a.blur,
          m = a.quality,
          p = a.pixelSize,
          h = a.resolution;
        (l._tintFilter = new n.Filter(
          c,
          "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"
        )),
          (l._tintFilter.uniforms.color = new Float32Array(4)),
          (l._tintFilter.uniforms.shift = new t.Point()),
          (l._tintFilter.resolution = h),
          (l._blurFilter = s ? new d(s) : new d(u, m)),
          (l.pixelSize = p),
          (l.resolution = h);
        var g = a.shadowOnly,
          v = a.rotation,
          y = a.distance,
          b = a.alpha,
          x = a.color;
        return (
          (l.shadowOnly = g),
          (l.rotation = v),
          (l.distance = y),
          (l.alpha = b),
          (l.color = x),
          l._updatePadding(),
          l
        );
      }
      return (
        u(i, e),
        (i.prototype.apply = function (e, n, t, r) {
          var o = e.getFilterTexture();
          this._tintFilter.apply(e, n, o, 1),
            this._blurFilter.apply(e, o, t, r),
            !0 !== this.shadowOnly && e.applyFilter(this, n, t, 0),
            e.returnFilterTexture(o);
        }),
        (i.prototype._updatePadding = function () {
          this.padding = this.distance + 2 * this.blur;
        }),
        (i.prototype._updateShift = function () {
          this._tintFilter.uniforms.shift.set(
            this.distance * Math.cos(this.angle),
            this.distance * Math.sin(this.angle)
          );
        }),
        Object.defineProperty(i.prototype, "resolution", {
          get: function () {
            return this._resolution;
          },
          set: function (e) {
            (this._resolution = e),
              this._tintFilter && (this._tintFilter.resolution = e),
              this._blurFilter && (this._blurFilter.resolution = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "distance", {
          get: function () {
            return this._distance;
          },
          set: function (e) {
            (this._distance = e), this._updatePadding(), this._updateShift();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "rotation", {
          get: function () {
            return this.angle / t.DEG_TO_RAD;
          },
          set: function (e) {
            (this.angle = e * t.DEG_TO_RAD), this._updateShift();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "alpha", {
          get: function () {
            return this._tintFilter.uniforms.alpha;
          },
          set: function (e) {
            this._tintFilter.uniforms.alpha = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "color", {
          get: function () {
            return o.rgb2hex(this._tintFilter.uniforms.color);
          },
          set: function (e) {
            o.hex2rgb(e, this._tintFilter.uniforms.color);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "kernels", {
          get: function () {
            return this._blurFilter.kernels;
          },
          set: function (e) {
            this._blurFilter.kernels = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "blur", {
          get: function () {
            return this._blurFilter.blur;
          },
          set: function (e) {
            (this._blurFilter.blur = e), this._updatePadding();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "quality", {
          get: function () {
            return this._blurFilter.quality;
          },
          set: function (e) {
            this._blurFilter.quality = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(i.prototype, "pixelSize", {
          get: function () {
            return this._blurFilter.pixelSize;
          },
          set: function (e) {
            this._blurFilter.pixelSize = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (i.defaults = {
          rotation: 45,
          distance: 5,
          color: 0,
          alpha: 0.5,
          shadowOnly: !1,
          kernels: null,
          blur: 2,
          quality: 3,
          pixelSize: 1,
          resolution: r.settings.FILTER_RESOLUTION,
        }),
        i
      );
    })(n.Filter),
    A = (function (e) {
      function n(n) {
        void 0 === n && (n = 5);
        var t =
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float strength;\nuniform vec4 filterArea;\n\n\nvoid main(void)\n{\n\tvec2 onePixel = vec2(1.0 / filterArea);\n\n\tvec4 color;\n\n\tcolor.rgb = vec3(0.5);\n\n\tcolor -= texture2D(uSampler, vTextureCoord - onePixel) * strength;\n\tcolor += texture2D(uSampler, vTextureCoord + onePixel) * strength;\n\n\tcolor.rgb = vec3((color.r + color.g + color.b) / 3.0);\n\n\tfloat alpha = texture2D(uSampler, vTextureCoord).a;\n\n\tgl_FragColor = vec4(color.rgb * alpha, alpha);\n}\n"
          ) || this;
        return (t.strength = n), t;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "strength", {
          get: function () {
            return this.uniforms.strength;
          },
          set: function (e) {
            this.uniforms.strength = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    T = (function (e) {
      function r(t) {
        var o =
          e.call(
            this,
            c,
            "// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n"
          ) || this;
        return (
          (o.offset = 100),
          (o.fillMode = r.TRANSPARENT),
          (o.average = !1),
          (o.seed = 0),
          (o.minSize = 8),
          (o.sampleSize = 512),
          (o._slices = 0),
          (o._offsets = new Float32Array(1)),
          (o._sizes = new Float32Array(1)),
          (o._direction = -1),
          (o.uniforms.dimensions = new Float32Array(2)),
          (o._canvas = document.createElement("canvas")),
          (o._canvas.width = 4),
          (o._canvas.height = o.sampleSize),
          (o.texture = n.Texture.from(o._canvas, { scaleMode: i.SCALE_MODES.NEAREST })),
          Object.assign(o, r.defaults, t),
          o
        );
      }
      return (
        u(r, e),
        (r.prototype.apply = function (e, n, t, r) {
          var o = n.filterFrame,
            i = o.width,
            l = o.height;
          (this.uniforms.dimensions[0] = i),
            (this.uniforms.dimensions[1] = l),
            (this.uniforms.aspect = l / i),
            (this.uniforms.seed = this.seed),
            (this.uniforms.offset = this.offset),
            (this.uniforms.fillMode = this.fillMode),
            e.applyFilter(this, n, t, r);
        }),
        (r.prototype._randomizeSizes = function () {
          var e = this._sizes,
            n = this._slices - 1,
            t = this.sampleSize,
            r = Math.min(this.minSize / t, 0.9 / this._slices);
          if (this.average) {
            for (var o = this._slices, i = 1, l = 0; l < n; l++) {
              var a = i / (o - l),
                s = Math.max(a * (1 - 0.6 * Math.random()), r);
              (e[l] = s), (i -= s);
            }
            e[n] = i;
          } else {
            i = 1;
            var u = Math.sqrt(1 / this._slices);
            for (l = 0; l < n; l++) {
              s = Math.max(u * i * Math.random(), r);
              (e[l] = s), (i -= s);
            }
            e[n] = i;
          }
          this.shuffle();
        }),
        (r.prototype.shuffle = function () {
          for (var e = this._sizes, n = this._slices - 1; n > 0; n--) {
            var t = (Math.random() * n) >> 0,
              r = e[n];
            (e[n] = e[t]), (e[t] = r);
          }
        }),
        (r.prototype._randomizeOffsets = function () {
          for (var e = 0; e < this._slices; e++)
            this._offsets[e] = Math.random() * (Math.random() < 0.5 ? -1 : 1);
        }),
        (r.prototype.refresh = function () {
          this._randomizeSizes(), this._randomizeOffsets(), this.redraw();
        }),
        (r.prototype.redraw = function () {
          var e,
            n = this.sampleSize,
            t = this.texture,
            r = this._canvas.getContext("2d");
          r.clearRect(0, 0, 8, n);
          for (var o = 0, i = 0; i < this._slices; i++) {
            e = Math.floor(256 * this._offsets[i]);
            var l = this._sizes[i] * n,
              a = e > 0 ? e : 0,
              s = e < 0 ? -e : 0;
            (r.fillStyle = "rgba(" + a + ", " + s + ", 0, 1)"),
              r.fillRect(0, o >> 0, n, (l + 1) >> 0),
              (o += l);
          }
          t.baseTexture.update(), (this.uniforms.displacementMap = t);
        }),
        Object.defineProperty(r.prototype, "sizes", {
          get: function () {
            return this._sizes;
          },
          set: function (e) {
            for (var n = Math.min(this._slices, e.length), t = 0; t < n; t++) this._sizes[t] = e[t];
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "offsets", {
          get: function () {
            return this._offsets;
          },
          set: function (e) {
            for (var n = Math.min(this._slices, e.length), t = 0; t < n; t++)
              this._offsets[t] = e[t];
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "slices", {
          get: function () {
            return this._slices;
          },
          set: function (e) {
            this._slices !== e &&
              ((this._slices = e),
              (this.uniforms.slices = e),
              (this._sizes = this.uniforms.slicesWidth = new Float32Array(e)),
              (this._offsets = this.uniforms.slicesOffset = new Float32Array(e)),
              this.refresh());
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "direction", {
          get: function () {
            return this._direction;
          },
          set: function (e) {
            if (this._direction !== e) {
              this._direction = e;
              var n = e * t.DEG_TO_RAD;
              (this.uniforms.sinDir = Math.sin(n)), (this.uniforms.cosDir = Math.cos(n));
            }
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "red", {
          get: function () {
            return this.uniforms.red;
          },
          set: function (e) {
            this.uniforms.red = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "green", {
          get: function () {
            return this.uniforms.green;
          },
          set: function (e) {
            this.uniforms.green = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(r.prototype, "blue", {
          get: function () {
            return this.uniforms.blue;
          },
          set: function (e) {
            this.uniforms.blue = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (r.prototype.destroy = function () {
          var e;
          null === (e = this.texture) || void 0 === e || e.destroy(!0),
            (this.texture =
              this._canvas =
              this.red =
              this.green =
              this.blue =
              this._sizes =
              this._offsets =
                null);
        }),
        (r.defaults = {
          slices: 5,
          offset: 100,
          direction: 0,
          fillMode: 0,
          average: !1,
          seed: 0,
          red: [0, 0],
          green: [0, 0],
          blue: [0, 0],
          minSize: 8,
          sampleSize: 512,
        }),
        (r.TRANSPARENT = 0),
        (r.ORIGINAL = 1),
        (r.LOOP = 2),
        (r.CLAMP = 3),
        (r.MIRROR = 4),
        r
      );
    })(n.Filter),
    w = (function (e) {
      function n(t) {
        var r = this,
          o = Object.assign({}, n.defaults, t),
          i = o.outerStrength,
          l = o.innerStrength,
          a = o.color,
          s = o.knockout,
          u = o.quality,
          f = Math.round(o.distance);
        return (
          ((r =
            e.call(
              this,
              c,
              "varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;\n    \n    if (knockout) {\n      float resultAlpha = outerGlowAlpha + innerGlowAlpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n"
                .replace(/__ANGLE_STEP_SIZE__/gi, "" + (1 / u / f).toFixed(7))
                .replace(/__DIST__/gi, f.toFixed(0) + ".0")
            ) || this).uniforms.glowColor = new Float32Array([0, 0, 0, 1])),
          Object.assign(r, {
            color: a,
            outerStrength: i,
            innerStrength: l,
            padding: f,
            knockout: s,
          }),
          r
        );
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "color", {
          get: function () {
            return o.rgb2hex(this.uniforms.glowColor);
          },
          set: function (e) {
            o.hex2rgb(e, this.uniforms.glowColor);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "outerStrength", {
          get: function () {
            return this.uniforms.outerStrength;
          },
          set: function (e) {
            this.uniforms.outerStrength = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "innerStrength", {
          get: function () {
            return this.uniforms.innerStrength;
          },
          set: function (e) {
            this.uniforms.innerStrength = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "knockout", {
          get: function () {
            return this.uniforms.knockout;
          },
          set: function (e) {
            this.uniforms.knockout = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          distance: 10,
          outerStrength: 4,
          innerStrength: 0,
          color: 16777215,
          quality: 0.1,
          knockout: !1,
        }),
        n
      );
    })(n.Filter),
    D = (function (e) {
      function n(r) {
        var o =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n".replace(
              "${perlin}",
              "vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n"
            )
          ) || this;
        (o.parallel = !0),
          (o.time = 0),
          (o._angle = 0),
          (o.uniforms.dimensions = new Float32Array(2));
        var i = Object.assign(n.defaults, r);
        return (
          (o._angleLight = new t.Point()),
          (o.angle = i.angle),
          (o.gain = i.gain),
          (o.lacunarity = i.lacunarity),
          (o.alpha = i.alpha),
          (o.parallel = i.parallel),
          (o.center = i.center),
          (o.time = i.time),
          o
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o = n.filterFrame,
            i = o.width,
            l = o.height;
          (this.uniforms.light = this.parallel ? this._angleLight : this.center),
            (this.uniforms.parallel = this.parallel),
            (this.uniforms.dimensions[0] = i),
            (this.uniforms.dimensions[1] = l),
            (this.uniforms.aspect = l / i),
            (this.uniforms.time = this.time),
            (this.uniforms.alpha = this.alpha),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "angle", {
          get: function () {
            return this._angle;
          },
          set: function (e) {
            this._angle = e;
            var n = e * t.DEG_TO_RAD;
            (this._angleLight.x = Math.cos(n)), (this._angleLight.y = Math.sin(n));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "gain", {
          get: function () {
            return this.uniforms.gain;
          },
          set: function (e) {
            this.uniforms.gain = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "lacunarity", {
          get: function () {
            return this.uniforms.lacunarity;
          },
          set: function (e) {
            this.uniforms.lacunarity = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "alpha", {
          get: function () {
            return this.uniforms.alpha;
          },
          set: function (e) {
            this.uniforms.alpha = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          angle: 30,
          gain: 0.5,
          lacunarity: 2.5,
          time: 0,
          parallel: !0,
          center: [0, 0],
          alpha: 1,
        }),
        n
      );
    })(n.Filter),
    j = (function (e) {
      function n(n, r, o) {
        void 0 === n && (n = [0, 0]), void 0 === r && (r = 5), void 0 === o && (o = 0);
        var i =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uVelocity;\nuniform int uKernelSize;\nuniform float uOffset;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\n// Notice:\n// the perfect way:\n//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);\n// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.\n// So use uKernelSize directly.\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        gl_FragColor = color;\n        return;\n    }\n\n    vec2 velocity = uVelocity / filterArea.xy;\n    float offset = -uOffset / length(uVelocity) - 0.5;\n    int k = uKernelSize - 1;\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n        vec2 bias = velocity * (float(i) / float(k) + offset);\n        color += texture2D(uSampler, vTextureCoord + bias);\n    }\n    gl_FragColor = color / float(uKernelSize);\n}\n"
          ) || this;
        return (
          (i.kernelSize = 5),
          (i.uniforms.uVelocity = new Float32Array(2)),
          (i._velocity = new t.ObservablePoint(i.velocityChanged, i)),
          i.setVelocity(n),
          (i.kernelSize = r),
          (i.offset = o),
          i
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o = this.velocity,
            i = o.x,
            l = o.y;
          (this.uniforms.uKernelSize = 0 !== i || 0 !== l ? this.kernelSize : 0),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "velocity", {
          get: function () {
            return this._velocity;
          },
          set: function (e) {
            this.setVelocity(e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.prototype.setVelocity = function (e) {
          if (Array.isArray(e)) {
            var n = e[0],
              t = e[1];
            this._velocity.set(n, t);
          } else this._velocity.copyFrom(e);
        }),
        (n.prototype.velocityChanged = function () {
          (this.uniforms.uVelocity[0] = this._velocity.x),
            (this.uniforms.uVelocity[1] = this._velocity.y),
            (this.padding =
              1 + (Math.max(Math.abs(this._velocity.x), Math.abs(this._velocity.y)) >> 0));
        }),
        Object.defineProperty(n.prototype, "offset", {
          get: function () {
            return this.uniforms.uOffset;
          },
          set: function (e) {
            this.uniforms.uOffset = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    M = (function (e) {
      function n(n, t, r) {
        void 0 === t && (t = 0.05), void 0 === r && (r = n.length);
        var o =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float epsilon;\n\nconst int MAX_COLORS = %maxColors%;\n\nuniform vec3 originalColors[MAX_COLORS];\nuniform vec3 targetColors[MAX_COLORS];\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    float alpha = gl_FragColor.a;\n    if (alpha < 0.0001)\n    {\n      return;\n    }\n\n    vec3 color = gl_FragColor.rgb / alpha;\n\n    for(int i = 0; i < MAX_COLORS; i++)\n    {\n      vec3 origColor = originalColors[i];\n      if (origColor.r < 0.0)\n      {\n        break;\n      }\n      vec3 colorDiff = origColor - color;\n      if (length(colorDiff) < epsilon)\n      {\n        vec3 targetColor = targetColors[i];\n        gl_FragColor = vec4((targetColor + colorDiff) * alpha, alpha);\n        return;\n      }\n    }\n}\n".replace(
              /%maxColors%/g,
              r.toFixed(0)
            )
          ) || this;
        return (
          (o._replacements = []),
          (o._maxColors = 0),
          (o.epsilon = t),
          (o._maxColors = r),
          (o.uniforms.originalColors = new Float32Array(3 * r)),
          (o.uniforms.targetColors = new Float32Array(3 * r)),
          (o.replacements = n),
          o
        );
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "replacements", {
          get: function () {
            return this._replacements;
          },
          set: function (e) {
            var n = this.uniforms.originalColors,
              t = this.uniforms.targetColors,
              r = e.length;
            if (r > this._maxColors)
              throw new Error(
                "Length of replacements (" +
                  r +
                  ") exceeds the maximum colors length (" +
                  this._maxColors +
                  ")"
              );
            n[3 * r] = -1;
            for (var i = 0; i < r; i++) {
              var l = e[i],
                a = l[0];
              "number" == typeof a ? (a = o.hex2rgb(a)) : (l[0] = o.rgb2hex(a)),
                (n[3 * i] = a[0]),
                (n[3 * i + 1] = a[1]),
                (n[3 * i + 2] = a[2]);
              var s = l[1];
              "number" == typeof s ? (s = o.hex2rgb(s)) : (l[1] = o.rgb2hex(s)),
                (t[3 * i] = s[0]),
                (t[3 * i + 1] = s[1]),
                (t[3 * i + 2] = s[2]);
            }
            this._replacements = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.prototype.refresh = function () {
          this.replacements = this._replacements;
        }),
        Object.defineProperty(n.prototype, "maxColors", {
          get: function () {
            return this._maxColors;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "epsilon", {
          get: function () {
            return this.uniforms.epsilon;
          },
          set: function (e) {
            this.uniforms.epsilon = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    R = (function (e) {
      function n(t, r) {
        void 0 === r && (r = 0);
        var o =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n"
          ) || this;
        return (
          (o.seed = 0),
          (o.uniforms.dimensions = new Float32Array(2)),
          "number" == typeof t ? ((o.seed = t), (t = void 0)) : (o.seed = r),
          Object.assign(o, n.defaults, t),
          o
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o, i;
          (this.uniforms.dimensions[0] =
            null === (o = n.filterFrame) || void 0 === o ? void 0 : o.width),
            (this.uniforms.dimensions[1] =
              null === (i = n.filterFrame) || void 0 === i ? void 0 : i.height),
            (this.uniforms.seed = this.seed),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "sepia", {
          get: function () {
            return this.uniforms.sepia;
          },
          set: function (e) {
            this.uniforms.sepia = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "noise", {
          get: function () {
            return this.uniforms.noise;
          },
          set: function (e) {
            this.uniforms.noise = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "noiseSize", {
          get: function () {
            return this.uniforms.noiseSize;
          },
          set: function (e) {
            this.uniforms.noiseSize = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "scratch", {
          get: function () {
            return this.uniforms.scratch;
          },
          set: function (e) {
            this.uniforms.scratch = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "scratchDensity", {
          get: function () {
            return this.uniforms.scratchDensity;
          },
          set: function (e) {
            this.uniforms.scratchDensity = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "scratchWidth", {
          get: function () {
            return this.uniforms.scratchWidth;
          },
          set: function (e) {
            this.uniforms.scratchWidth = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "vignetting", {
          get: function () {
            return this.uniforms.vignetting;
          },
          set: function (e) {
            this.uniforms.vignetting = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "vignettingAlpha", {
          get: function () {
            return this.uniforms.vignettingAlpha;
          },
          set: function (e) {
            this.uniforms.vignettingAlpha = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "vignettingBlur", {
          get: function () {
            return this.uniforms.vignettingBlur;
          },
          set: function (e) {
            this.uniforms.vignettingBlur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          sepia: 0.3,
          noise: 0.3,
          noiseSize: 1,
          scratch: 0.5,
          scratchDensity: 0.3,
          scratchWidth: 1,
          vignetting: 0.3,
          vignettingAlpha: 1,
          vignettingBlur: 0.3,
        }),
        n
      );
    })(n.Filter),
    E = (function (e) {
      function n(t, r, o) {
        void 0 === t && (t = 1), void 0 === r && (r = 0), void 0 === o && (o = 0.1);
        var i =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 thickness;\nuniform vec4 outlineColor;\nuniform vec4 filterClamp;\n\nconst float DOUBLE_PI = 3.14159265358979323846264 * 2.;\n\nvoid main(void) {\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float maxAlpha = 0.;\n    vec2 displaced;\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ${angleStep}) {\n        displaced.x = vTextureCoord.x + thickness.x * cos(angle);\n        displaced.y = vTextureCoord.y + thickness.y * sin(angle);\n        curColor = texture2D(uSampler, clamp(displaced, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, curColor.a);\n    }\n    float resultAlpha = max(maxAlpha, ownColor.a);\n    gl_FragColor = vec4((ownColor.rgb + outlineColor.rgb * (1. - ownColor.a)) * resultAlpha, resultAlpha);\n}\n".replace(
              /\$\{angleStep\}/,
              n.getAngleStep(o)
            )
          ) || this;
        return (
          (i._thickness = 1),
          (i.uniforms.thickness = new Float32Array([0, 0])),
          (i.uniforms.outlineColor = new Float32Array([0, 0, 0, 1])),
          Object.assign(i, { thickness: t, color: r, quality: o }),
          i
        );
      }
      return (
        u(n, e),
        (n.getAngleStep = function (e) {
          var t = Math.max(e * n.MAX_SAMPLES, n.MIN_SAMPLES);
          return ((2 * Math.PI) / t).toFixed(7);
        }),
        (n.prototype.apply = function (e, n, t, r) {
          (this.uniforms.thickness[0] = this._thickness / n._frame.width),
            (this.uniforms.thickness[1] = this._thickness / n._frame.height),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "color", {
          get: function () {
            return o.rgb2hex(this.uniforms.outlineColor);
          },
          set: function (e) {
            o.hex2rgb(e, this.uniforms.outlineColor);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "thickness", {
          get: function () {
            return this._thickness;
          },
          set: function (e) {
            (this._thickness = e), (this.padding = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.MIN_SAMPLES = 1),
        (n.MAX_SAMPLES = 100),
        n
      );
    })(n.Filter),
    I = (function (e) {
      function n(n) {
        void 0 === n && (n = 10);
        var t =
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec2 size;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n\treturn floor( coord / size ) * size;\n}\n\nvoid main(void)\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = pixelate(coord, size);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord);\n}\n"
          ) || this;
        return (t.size = n), t;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "size", {
          get: function () {
            return this.uniforms.size;
          },
          set: function (e) {
            "number" == typeof e && (e = [e, e]), (this.uniforms.size = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    k = (function (e) {
      function n(n, t, r, o) {
        void 0 === n && (n = 0),
          void 0 === t && (t = [0, 0]),
          void 0 === r && (r = 5),
          void 0 === o && (o = -1);
        var i =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform float uRadian;\nuniform vec2 uCenter;\nuniform float uRadius;\nuniform int uKernelSize;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        gl_FragColor = color;\n        return;\n    }\n\n    float aspect = filterArea.y / filterArea.x;\n    vec2 center = uCenter.xy / filterArea.xy;\n    float gradient = uRadius / filterArea.x * 0.3;\n    float radius = uRadius / filterArea.x - gradient * 0.5;\n    int k = uKernelSize - 1;\n\n    vec2 coord = vTextureCoord;\n    vec2 dir = vec2(center - coord);\n    float dist = length(vec2(dir.x, dir.y * aspect));\n\n    float radianStep = uRadian;\n    if (radius >= 0.0 && dist > radius) {\n        float delta = dist - radius;\n        float gap = gradient;\n        float scale = 1.0 - abs(delta / gap);\n        if (scale <= 0.0) {\n            gl_FragColor = color;\n            return;\n        }\n        radianStep *= scale;\n    }\n    radianStep /= float(k);\n\n    float s = sin(radianStep);\n    float c = cos(radianStep);\n    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n\n        coord -= center;\n        coord.y *= aspect;\n        coord = rotationMatrix * coord;\n        coord.y /= aspect;\n        coord += center;\n\n        vec4 sample = texture2D(uSampler, coord);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample;\n    }\n\n    gl_FragColor = color / float(uKernelSize);\n}\n"
          ) || this;
        return (i._angle = 0), (i.angle = n), (i.center = t), (i.kernelSize = r), (i.radius = o), i;
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          (this.uniforms.uKernelSize = 0 !== this._angle ? this.kernelSize : 0),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "angle", {
          get: function () {
            return this._angle;
          },
          set: function (e) {
            (this._angle = e), (this.uniforms.uRadian = (e * Math.PI) / 180);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "center", {
          get: function () {
            return this.uniforms.uCenter;
          },
          set: function (e) {
            this.uniforms.uCenter = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "radius", {
          get: function () {
            return this.uniforms.uRadius;
          },
          set: function (e) {
            (e < 0 || e === 1 / 0) && (e = -1), (this.uniforms.uRadius = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    L = (function (e) {
      function n(t) {
        var r =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n"
          ) || this;
        return (
          (r.time = 0),
          (r.uniforms.amplitude = new Float32Array(2)),
          (r.uniforms.waveLength = new Float32Array(2)),
          (r.uniforms.alpha = new Float32Array(2)),
          (r.uniforms.dimensions = new Float32Array(2)),
          Object.assign(r, n.defaults, t),
          r
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o, i;
          (this.uniforms.dimensions[0] =
            null === (o = n.filterFrame) || void 0 === o ? void 0 : o.width),
            (this.uniforms.dimensions[1] =
              null === (i = n.filterFrame) || void 0 === i ? void 0 : i.height),
            (this.uniforms.time = this.time),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "mirror", {
          get: function () {
            return this.uniforms.mirror;
          },
          set: function (e) {
            this.uniforms.mirror = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "boundary", {
          get: function () {
            return this.uniforms.boundary;
          },
          set: function (e) {
            this.uniforms.boundary = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "amplitude", {
          get: function () {
            return this.uniforms.amplitude;
          },
          set: function (e) {
            (this.uniforms.amplitude[0] = e[0]), (this.uniforms.amplitude[1] = e[1]);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "waveLength", {
          get: function () {
            return this.uniforms.waveLength;
          },
          set: function (e) {
            (this.uniforms.waveLength[0] = e[0]), (this.uniforms.waveLength[1] = e[1]);
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "alpha", {
          get: function () {
            return this.uniforms.alpha;
          },
          set: function (e) {
            (this.uniforms.alpha[0] = e[0]), (this.uniforms.alpha[1] = e[1]);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          mirror: !0,
          boundary: 0.5,
          amplitude: [0, 20],
          waveLength: [30, 100],
          alpha: [1, 1],
          time: 0,
        }),
        n
      );
    })(n.Filter),
    N = (function (e) {
      function n(n, t, r) {
        void 0 === n && (n = [-10, 0]), void 0 === t && (t = [0, 10]), void 0 === r && (r = [0, 0]);
        var o =
          e.call(
            this,
            c,
            "precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n"
          ) || this;
        return (o.red = n), (o.green = t), (o.blue = r), o;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "red", {
          get: function () {
            return this.uniforms.red;
          },
          set: function (e) {
            this.uniforms.red = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "green", {
          get: function () {
            return this.uniforms.green;
          },
          set: function (e) {
            this.uniforms.green = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "blue", {
          get: function () {
            return this.uniforms.blue;
          },
          set: function (e) {
            this.uniforms.blue = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    X = (function (e) {
      function n(t, r, o) {
        void 0 === t && (t = [0, 0]), void 0 === o && (o = 0);
        var i =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n"
          ) || this;
        return (i.center = t), Object.assign(i, n.defaults, r), (i.time = o), i;
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          (this.uniforms.time = this.time), e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "center", {
          get: function () {
            return this.uniforms.center;
          },
          set: function (e) {
            this.uniforms.center = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "amplitude", {
          get: function () {
            return this.uniforms.amplitude;
          },
          set: function (e) {
            this.uniforms.amplitude = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "wavelength", {
          get: function () {
            return this.uniforms.wavelength;
          },
          set: function (e) {
            this.uniforms.wavelength = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "brightness", {
          get: function () {
            return this.uniforms.brightness;
          },
          set: function (e) {
            this.uniforms.brightness = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "speed", {
          get: function () {
            return this.uniforms.speed;
          },
          set: function (e) {
            this.uniforms.speed = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "radius", {
          get: function () {
            return this.uniforms.radius;
          },
          set: function (e) {
            this.uniforms.radius = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = { amplitude: 30, wavelength: 160, brightness: 1, speed: 500, radius: -1 }),
        n
      );
    })(n.Filter),
    B = (function (e) {
      function n(n, t, r) {
        void 0 === t && (t = 0), void 0 === r && (r = 1);
        var o =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLightmap;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\nuniform vec4 ambientColor;\nvoid main() {\n    vec4 diffuseColor = texture2D(uSampler, vTextureCoord);\n    vec2 lightCoord = (vTextureCoord * filterArea.xy) / dimensions;\n    vec4 light = texture2D(uLightmap, lightCoord);\n    vec3 ambient = ambientColor.rgb * ambientColor.a;\n    vec3 intensity = ambient + light.rgb;\n    vec3 finalColor = diffuseColor.rgb * intensity;\n    gl_FragColor = vec4(finalColor, diffuseColor.a);\n}\n"
          ) || this;
        return (
          (o._color = 0),
          (o.uniforms.dimensions = new Float32Array(2)),
          (o.uniforms.ambientColor = new Float32Array([0, 0, 0, r])),
          (o.texture = n),
          (o.color = t),
          o
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o, i;
          (this.uniforms.dimensions[0] =
            null === (o = n.filterFrame) || void 0 === o ? void 0 : o.width),
            (this.uniforms.dimensions[1] =
              null === (i = n.filterFrame) || void 0 === i ? void 0 : i.height),
            e.applyFilter(this, n, t, r);
        }),
        Object.defineProperty(n.prototype, "texture", {
          get: function () {
            return this.uniforms.uLightmap;
          },
          set: function (e) {
            this.uniforms.uLightmap = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "color", {
          get: function () {
            return this._color;
          },
          set: function (e) {
            var n = this.uniforms.ambientColor;
            "number" == typeof e
              ? (o.hex2rgb(e, n), (this._color = e))
              : ((n[0] = e[0]),
                (n[1] = e[1]),
                (n[2] = e[2]),
                (n[3] = e[3]),
                (this._color = o.rgb2hex(n)));
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "alpha", {
          get: function () {
            return this.uniforms.ambientColor[3];
          },
          set: function (e) {
            this.uniforms.ambientColor[3] = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    G = (function (e) {
      function n(n, r, o, i) {
        void 0 === n && (n = 100), void 0 === r && (r = 600);
        var l =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n"
          ) || this;
        return (
          (l.uniforms.blur = n),
          (l.uniforms.gradientBlur = r),
          (l.uniforms.start = o || new t.Point(0, window.innerHeight / 2)),
          (l.uniforms.end = i || new t.Point(600, window.innerHeight / 2)),
          (l.uniforms.delta = new t.Point(30, 30)),
          (l.uniforms.texSize = new t.Point(window.innerWidth, window.innerHeight)),
          l.updateDelta(),
          l
        );
      }
      return (
        u(n, e),
        (n.prototype.updateDelta = function () {
          (this.uniforms.delta.x = 0), (this.uniforms.delta.y = 0);
        }),
        Object.defineProperty(n.prototype, "blur", {
          get: function () {
            return this.uniforms.blur;
          },
          set: function (e) {
            this.uniforms.blur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "gradientBlur", {
          get: function () {
            return this.uniforms.gradientBlur;
          },
          set: function (e) {
            this.uniforms.gradientBlur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "start", {
          get: function () {
            return this.uniforms.start;
          },
          set: function (e) {
            (this.uniforms.start = e), this.updateDelta();
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "end", {
          get: function () {
            return this.uniforms.end;
          },
          set: function (e) {
            (this.uniforms.end = e), this.updateDelta();
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    K = (function (e) {
      function n() {
        return (null !== e && e.apply(this, arguments)) || this;
      }
      return (
        u(n, e),
        (n.prototype.updateDelta = function () {
          var e = this.uniforms.end.x - this.uniforms.start.x,
            n = this.uniforms.end.y - this.uniforms.start.y,
            t = Math.sqrt(e * e + n * n);
          (this.uniforms.delta.x = e / t), (this.uniforms.delta.y = n / t);
        }),
        n
      );
    })(G),
    q = (function (e) {
      function n() {
        return (null !== e && e.apply(this, arguments)) || this;
      }
      return (
        u(n, e),
        (n.prototype.updateDelta = function () {
          var e = this.uniforms.end.x - this.uniforms.start.x,
            n = this.uniforms.end.y - this.uniforms.start.y,
            t = Math.sqrt(e * e + n * n);
          (this.uniforms.delta.x = -n / t), (this.uniforms.delta.y = e / t);
        }),
        n
      );
    })(G),
    W = (function (e) {
      function n(n, t, r, o) {
        void 0 === n && (n = 100), void 0 === t && (t = 600);
        var i = e.call(this) || this;
        return (
          (i.tiltShiftXFilter = new K(n, t, r, o)), (i.tiltShiftYFilter = new q(n, t, r, o)), i
        );
      }
      return (
        u(n, e),
        (n.prototype.apply = function (e, n, t, r) {
          var o = e.getFilterTexture();
          this.tiltShiftXFilter.apply(e, n, o, 1),
            this.tiltShiftYFilter.apply(e, o, t, r),
            e.returnFilterTexture(o);
        }),
        Object.defineProperty(n.prototype, "blur", {
          get: function () {
            return this.tiltShiftXFilter.blur;
          },
          set: function (e) {
            this.tiltShiftXFilter.blur = this.tiltShiftYFilter.blur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "gradientBlur", {
          get: function () {
            return this.tiltShiftXFilter.gradientBlur;
          },
          set: function (e) {
            this.tiltShiftXFilter.gradientBlur = this.tiltShiftYFilter.gradientBlur = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "start", {
          get: function () {
            return this.tiltShiftXFilter.start;
          },
          set: function (e) {
            this.tiltShiftXFilter.start = this.tiltShiftYFilter.start = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "end", {
          get: function () {
            return this.tiltShiftXFilter.end;
          },
          set: function (e) {
            this.tiltShiftXFilter.end = this.tiltShiftYFilter.end = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        n
      );
    })(n.Filter),
    Y = (function (e) {
      function n(t) {
        var r =
          e.call(
            this,
            c,
            "varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n"
          ) || this;
        return Object.assign(r, n.defaults, t), r;
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "offset", {
          get: function () {
            return this.uniforms.offset;
          },
          set: function (e) {
            this.uniforms.offset = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "radius", {
          get: function () {
            return this.uniforms.radius;
          },
          set: function (e) {
            this.uniforms.radius = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "angle", {
          get: function () {
            return this.uniforms.angle;
          },
          set: function (e) {
            this.uniforms.angle = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = { radius: 200, angle: 4, padding: 20, offset: new t.Point() }),
        n
      );
    })(n.Filter),
    Z = (function (e) {
      function n(t) {
        var r,
          o = Object.assign(n.defaults, t),
          i = o.maxKernelSize,
          l = (function (e, n) {
            var t = {};
            for (var r in e)
              Object.prototype.hasOwnProperty.call(e, r) && n.indexOf(r) < 0 && (t[r] = e[r]);
            if (null != e && "function" == typeof Object.getOwnPropertySymbols) {
              var o = 0;
              for (r = Object.getOwnPropertySymbols(e); o < r.length; o++)
                n.indexOf(r[o]) < 0 &&
                  Object.prototype.propertyIsEnumerable.call(e, r[o]) &&
                  (t[r[o]] = e[r[o]]);
            }
            return t;
          })(o, ["maxKernelSize"]);
        return (
          (r =
            e.call(
              this,
              c,
              "varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace(
                "${maxKernelSize}",
                i.toFixed(1)
              )
            ) || this),
          Object.assign(r, l),
          r
        );
      }
      return (
        u(n, e),
        Object.defineProperty(n.prototype, "center", {
          get: function () {
            return this.uniforms.uCenter;
          },
          set: function (e) {
            this.uniforms.uCenter = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "strength", {
          get: function () {
            return this.uniforms.uStrength;
          },
          set: function (e) {
            this.uniforms.uStrength = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "innerRadius", {
          get: function () {
            return this.uniforms.uInnerRadius;
          },
          set: function (e) {
            this.uniforms.uInnerRadius = e;
          },
          enumerable: !1,
          configurable: !0,
        }),
        Object.defineProperty(n.prototype, "radius", {
          get: function () {
            return this.uniforms.uRadius;
          },
          set: function (e) {
            (e < 0 || e === 1 / 0) && (e = -1), (this.uniforms.uRadius = e);
          },
          enumerable: !1,
          configurable: !0,
        }),
        (n.defaults = {
          strength: 0.1,
          center: [0, 0],
          innerRadius: 0,
          radius: -1,
          maxKernelSize: 32,
        }),
        n
      );
    })(n.Filter);
  return (
    (e.AdjustmentFilter = m),
    (e.AdvancedBloomFilter = h),
    (e.AsciiFilter = g),
    (e.BevelFilter = v),
    (e.BloomFilter = y),
    (e.BulgePinchFilter = b),
    (e.CRTFilter = z),
    (e.ColorMapFilter = x),
    (e.ColorOverlayFilter = _),
    (e.ColorReplaceFilter = C),
    (e.ConvolutionFilter = S),
    (e.CrossHatchFilter = F),
    (e.DotFilter = O),
    (e.DropShadowFilter = P),
    (e.EmbossFilter = A),
    (e.GlitchFilter = T),
    (e.GlowFilter = w),
    (e.GodrayFilter = D),
    (e.KawaseBlurFilter = d),
    (e.MotionBlurFilter = j),
    (e.MultiColorReplaceFilter = M),
    (e.OldFilmFilter = R),
    (e.OutlineFilter = E),
    (e.PixelateFilter = I),
    (e.RGBSplitFilter = N),
    (e.RadialBlurFilter = k),
    (e.ReflectionFilter = L),
    (e.ShockwaveFilter = X),
    (e.SimpleLightmapFilter = B),
    (e.TiltShiftAxisFilter = G),
    (e.TiltShiftFilter = W),
    (e.TiltShiftXFilter = K),
    (e.TiltShiftYFilter = q),
    (e.TwistFilter = Y),
    (e.ZoomBlurFilter = Z),
    Object.defineProperty(e, "__esModule", { value: !0 }),
    e
  );
})({}, PIXI, PIXI, PIXI, PIXI.utils, PIXI, PIXI.filters, PIXI.filters);
Object.assign(PIXI.filters, __filters);
var servicebase = {};
class ServiceBase {
  xhrGet(a) {
    const b = new XMLHttpRequest();
    return new Promise((c, d) => {
      b.addEventListener("load", () => {
        200 === b.status ? c(b.responseText) : d(this.xhrError(b.status, a));
      });
      b.open("GET", ServiceBase.API_URL + a);
      b.setRequestHeader("Client-Version", App.ClientVersion);
      b.send();
    });
  }
  xhrPost(a, b) {
    const c = new XMLHttpRequest();
    return new Promise((d, e) => {
      c.addEventListener("load", () => {
        if (200 === c.status) return d(c.responseText);
        e(this.xhrError(c.status, a));
      });
      c.open("POST", ServiceBase.API_URL + a);
      c.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
      c.setRequestHeader("Client-Version", App.ClientVersion);
      c.send(JSON.stringify(b));
    });
  }
  xhrError(a, b) {
    return "xhr request " + ServiceBase.API_URL + b + " failed with status " + a;
  }
}
const urlParams = new URLSearchParams(window.location.search),
  myParam = urlParams.get("dev"),
  loc = window.location
    .toString()
    .replace(/(^\w+:|^)\/\//, "")
    .trim()
    .replace(/\/$/, "");
ServiceBase.API_URL =
  "site.ninja.local" === loc ? "http://api.ninja.local/" : "https://api.ninja.io/";
var userservice = {};
class UserService extends ServiceBase {
  constructor() {
    super();
  }
  async getRanking() {
    const a = await this.xhrGet("user/ranking");
    return JSON.parse(a);
  }
  async getRankingType(a, b) {
    a = await this.xhrGet("user/ranking/" + a + "/limit/" + b);
    return JSON.parse(a);
  }
  async getWeaponRanking() {
    const a = await this.xhrGet("user/weapon-ranking");
    return JSON.parse(a);
  }
  async getWeaponRankingType(a) {
    a = await this.xhrGet("user/weapon-ranking/" + a);
    return JSON.parse(a);
  }
  async getGuestCredentials(a) {
    a = await this.xhrGet("user/guest/" + a);
    return JSON.parse(a);
  }
  async getCredentials(a) {
    a = await this.xhrGet("user/credential/" + a);
    return JSON.parse(a);
  }
  async getProfile(a) {
    return await this.xhrGet("user/profile/" + a);
  }
  async getUserProfile(a) {
    a = await this.xhrGet("user/profile/" + a + "/view");
    return JSON.parse(a);
  }
  async getUserProfileByName(a) {
    a = await this.xhrGet("user/profile/" + a + "/view-name");
    return JSON.parse(a);
  }
  async getUserSearch(a) {
    a = await this.xhrGet("user/search/" + a);
    return JSON.parse(a);
  }
  async getUserWeaponStats(a) {
    return await this.xhrGet("user/" + a + "/weapon-stats");
  }
  async getChallenge() {
    return await this.xhrGet("user/challenge");
  }
  async getCustomization(a) {
    return await this.xhrGet("user/customization/" + a);
  }
  async getFriends(a) {
    return await this.xhrGet("user/friends/" + a);
  }
  async getMessages(a) {
    return await this.xhrGet("user/messages/" + a);
  }
  async getCurrency(a) {
    a = await this.xhrGet("user/currency/" + a);
    return JSON.parse(a);
  }
  async getSettings(a) {
    a = await this.xhrGet("user/settings/" + a);
    return JSON.parse(a);
  }
  async getInvitations(a) {
    return await this.xhrGet("user/invitations/" + a);
  }
  async getInvitees(a) {
    return await this.xhrGet("user/invitees/" + a);
  }
  async getRewardsAvailable(a) {
    a = await this.xhrGet("user/rewards-available/" + a);
    return JSON.parse(a);
  }
  async getRewards(a) {
    a = await this.xhrGet("user/rewards/" + a);
    return JSON.parse(a);
  }
  async postClaimShopReward(a) {
    a = await this.xhrPost("user/reward-shop", { id: a });
    return JSON.parse(a);
  }
  async postClaimRewards(a) {
    a = await this.xhrPost("user/reward-claim", { id: a });
    return JSON.parse(a);
  }
  async postLogin(a, b) {
    a = await this.xhrPost("user/login", { name: a, password: b });
    return JSON.parse(a);
  }
  async postAutoRegister() {
    const a = await this.xhrPost("user/auto-register", {});
    return JSON.parse(a);
  }
  async postRegister(a, b, c) {
    a = await this.xhrPost("user/register", { name: a, email: b, password: c });
    return JSON.parse(a);
  }
  async postSettings(a, b) {
    a = await this.xhrPost("user/settings", { settings: a, id: b });
    return JSON.parse(a);
  }
  async postRecovery(a, b, c) {
    a = await this.xhrPost("user/recover", { email: a, type: b, challenge: c });
    return JSON.parse(a);
  }
  async postRenewPassword(a, b, c) {
    a = await this.xhrPost("user/renewpassword", { newPassword: a, oldPassword: b, id: c });
    return JSON.parse(a);
  }
  async postDeactivateAccount(a, b) {
    a = await this.xhrPost("user/deactivate", { password: a, id: b });
    return JSON.parse(a);
  }
  async postCustomization(a, b) {
    a = await this.xhrPost("user/customization", { customization: a, id: b });
    return JSON.parse(a);
  }
  async postAutogenRename(a, b, c) {
    a = await this.xhrPost("user/autogen-rename", { name: a, password: b, id: c });
    return JSON.parse(a);
  }
  async postFriendInvite(a, b) {
    a = await this.xhrPost("user/invite", { name: a, id: b });
    return JSON.parse(a);
  }
  async postAcceptFriend(a, b) {
    a = await this.xhrPost("user/accept", { friendId: a, id: b });
    return JSON.parse(a);
  }
  async postDeclineFriend(a, b) {
    a = await this.xhrPost("user/decline", { friendId: a, id: b });
    return JSON.parse(a);
  }
  async postUnfriend(a, b) {
    a = await this.xhrPost("user/unfriend", { friendId: a, id: b });
    return JSON.parse(a);
  }
  async postFriendMessage(a, b, c) {
    a = await this.xhrPost("user/message", { friendId: a, message: b, id: c });
    return JSON.parse(a);
  }
  async postPurchase(a, b, c) {
    a = await this.xhrPost("user/purchase", { productType: a, productId: b, id: c });
    return JSON.parse(a);
  }
  async postUsername(a, b, c) {
    a = await this.xhrPost("user/rename", { name: a, password: b, id: c });
    return JSON.parse(a);
  }
  async postFriendGold(a, b, c) {
    a = await this.xhrPost("user/gold", { friendId: a, amount: b, id: c });
    return JSON.parse(a);
  }
  async postCreateGame(a, b, c, d, e, f, g, h) {
    a = await this.xhrPost("user/game/create", {
      gameId: a,
      type: b,
      mode: c,
      duration: d,
      name: e,
      password: f,
      customization: g,
      id: h,
    });
    return JSON.parse(a);
  }
  async postSocial(a, b, c) {
    a = await this.xhrPost("user/social", { type: a, url: b, id: c });
    return JSON.parse(a);
  }
}
var serverservice = {};
class ServerService extends ServiceBase {
  constructor() {
    super();
  }
  async getNews() {
    const a = await this.xhrGet("news");
    return JSON.parse(a);
  }
  async getServers() {
    const a = await this.xhrGet("server");
    return JSON.parse(a);
  }
  async getGames() {
    const a = await this.xhrGet("game");
    return JSON.parse(a);
  }
  async getMaps() {
    const a = await this.xhrGet("map");
    return JSON.parse(a);
  }
  async getItemDrops() {
    const a = await this.xhrGet("item-drop");
    return JSON.parse(a);
  }
}
var clanservice = {};
class ClanService extends ServiceBase {
  constructor() {
    super();
  }
  async getClanByClanId(a) {
    a = await this.xhrGet("clan/" + a + "/clan-id");
    return JSON.parse(a);
  }
  async getClanByAccountId(a) {
    a = await this.xhrGet("clan/" + a + "/account-id");
    return JSON.parse(a);
  }
  async getClanList() {
    const a = await this.xhrGet("clan/list");
    return JSON.parse(a);
  }
  async getClanSearch(a) {
    a = await this.xhrGet("clan/search/" + a);
    return JSON.parse(a);
  }
  async getClanMembers(a) {
    a = await this.xhrGet("clan/" + a + "/members");
    return JSON.parse(a);
  }
  async getClanInvitations(a) {
    a = await this.xhrGet("clan/invitations/" + a);
    return JSON.parse(a);
  }
  async postCreate(a, b) {
    a = await this.xhrPost("clan", { name: a, id: b });
    return JSON.parse(a);
  }
  async postLeaveMember(a) {
    a = await this.xhrPost("clan/leave", { id: a });
    return JSON.parse(a);
  }
  async postInviteMember(a, b) {
    a = await this.xhrPost("clan/invite", { targetId: a, id: b });
    return JSON.parse(a);
  }
  async postAcceptMember(a, b) {
    a = await this.xhrPost("clan/accept", { clanId: a, id: b });
    return JSON.parse(a);
  }
  async postDeclineMember(a, b) {
    a = await this.xhrPost("clan/decline", { clanId: a, id: b });
    return JSON.parse(a);
  }
  async postRemoveMember(a, b) {
    a = await this.xhrPost("clan/remove", { targetId: a, id: b });
    return JSON.parse(a);
  }
  async postPromoteMember(a, b) {
    a = await this.xhrPost("clan/promote", { targetId: a, id: b });
    return JSON.parse(a);
  }
  async postDemoteMember(a, b) {
    a = await this.xhrPost("clan/demote", { targetId: a, id: b });
    return JSON.parse(a);
  }
  async postBanner(a, b) {
    a = await this.xhrPost("clan/banner", { data: a, id: b });
    return JSON.parse(a);
  }
}
var apiclient = {};
class APIClient {
  static async getNews() {
    return await new ServerService().getNews();
  }
  static async getServers() {
    return await new ServerService().getServers();
  }
  static async getGames() {
    return await new ServerService().getGames();
  }
  static async getMaps() {
    return await new ServerService().getMaps();
  }
  static async getItemDrops() {
    return await new ServerService().getItemDrops();
  }
  static async getRanking() {
    return await new UserService().getRanking();
  }
  static async getRankingType(a, b) {
    return await new UserService().getRankingType(a, b);
  }
  static async getWeaponRanking() {
    return await new UserService().getWeaponRanking();
  }
  static async getWeaponRankingType(a) {
    return await new UserService().getWeaponRankingType(a);
  }
  static async getGuestCredentials(a) {
    return await new UserService().getGuestCredentials(a);
  }
  static async getCredentials(a) {
    return await new UserService().getCredentials(a);
  }
  static async getProfile(a) {
    return await new UserService().getProfile(a);
  }
  static async getUserProfile(a) {
    return await new UserService().getUserProfile(a);
  }
  static async getUserProfileByName(a) {
    return await new UserService().getUserProfileByName(a);
  }
  static async getUserSearch(a) {
    return await new UserService().getUserSearch(a);
  }
  static async getUserWeaponStats(a) {
    return await new UserService().getUserWeaponStats(a);
  }
  static async getChallenge() {
    return await new UserService().getChallenge();
  }
  static async getFriends(a) {
    return await new UserService().getFriends(a);
  }
  static async getMessages(a) {
    return await new UserService().getMessages(a);
  }
  static async getCurrency(a) {
    return await new UserService().getCurrency(a);
  }
  static async getSettings(a) {
    return await new UserService().getSettings(a);
  }
  static async getInvitations(a) {
    return await new UserService().getInvitations(a);
  }
  static async getInvitees(a) {
    return await new UserService().getInvitees(a);
  }
  static async getRewardsAvailable(a) {
    return await new UserService().getRewardsAvailable(a);
  }
  static async getRewards(a) {
    return await new UserService().getRewards(a);
  }
  static async postClaimShopReward(a) {
    return await new UserService().postClaimShopReward(a);
  }
  static async postClaimRewards(a) {
    return await new UserService().postClaimRewards(a);
  }
  static async postLogin(a, b) {
    return await new UserService().postLogin(a, b);
  }
  static async postAutoRegistration() {
    return await new UserService().postAutoRegister();
  }
  static async postRegistration(a, b, c) {
    return await new UserService().postRegister(a, b, c);
  }
  static async postSettings(a, b) {
    return await new UserService().postSettings(a, b);
  }
  static async postRecovery(a, b, c) {
    return await new UserService().postRecovery(a, b, c);
  }
  static async postCustomization(a, b) {
    return await new UserService().postCustomization(a, b);
  }
  static async postAutogenRename(a, b, c) {
    return await new UserService().postAutogenRename(a, b, c);
  }
  static async renewPassword(a, b, c) {
    return await new UserService().postRenewPassword(a, b, c);
  }
  static async deactivateAccount(a, b) {
    return await new UserService().postDeactivateAccount(a, b);
  }
  static async getCustomization(a) {
    return await new UserService().getCustomization(a);
  }
  static async postInviteFriend(a, b) {
    return await new UserService().postFriendInvite(a, b);
  }
  static async postAcceptFriend(a, b) {
    return await new UserService().postAcceptFriend(a, b);
  }
  static async postDeclineFriend(a, b) {
    return await new UserService().postDeclineFriend(a, b);
  }
  static async postUnfriend(a, b) {
    return await new UserService().postUnfriend(a, b);
  }
  static async postFriendMessage(a, b, c) {
    return await new UserService().postFriendMessage(a, b, c);
  }
  static async postPurchase(a, b, c) {
    return await new UserService().postPurchase(a, b, c);
  }
  static async postUsername(a, b, c) {
    return await new UserService().postUsername(a, b, c);
  }
  static async postFriendGold(a, b, c) {
    return await new UserService().postFriendGold(a, b, c);
  }
  static async postCreateGame(a, b, c, d, e, f, g, h) {
    return await new UserService().postCreateGame(a, b, c, d, e, f, g, h);
  }
  static async postSocial(a, b, c) {
    return await new UserService().postSocial(a, b, c);
  }
  static async getClanByClanId(a) {
    return await new ClanService().getClanByClanId(a);
  }
  static async getClanByAccountId(a) {
    return await new ClanService().getClanByAccountId(a);
  }
  static async getClanList() {
    return await new ClanService().getList();
  }
  static async getClanSearch(a) {
    return await new ClanService().getClanSearch(a);
  }
  static async getClanMembers(a) {
    return await new ClanService().getClanMembers(a);
  }
  static async getClanInvitations(a) {
    return await new ClanService().getClanInvitations(a);
  }
  static async postCreateClan(a, b) {
    return await new ClanService().postCreate(a, b);
  }
  static async postLeaveMember(a) {
    return await new ClanService().postLeaveMember(a);
  }
  static async postInviteMember(a, b) {
    return await new ClanService().postInviteMember(a, b);
  }
  static async postAcceptInviteMember(a, b) {
    return await new ClanService().postAcceptMember(a, b);
  }
  static async postDeclineInviteMember(a, b) {
    return await new ClanService().postDeclineMember(a, b);
  }
  static async postRemoveMember(a, b) {
    return await new ClanService().postRemoveMember(a, b);
  }
  static async postPromoteMember(a, b) {
    return await new ClanService().postPromoteMember(a, b);
  }
  static async postDemoteMember(a, b) {
    return await new ClanService().postDemoteMember(a, b);
  }
  static async postBanner(a, b) {
    return await new ClanService().postBanner(a, b);
  }
}
APIClient.ChallengeURL = ServiceBase.API_URL + "user/challenge";
var eventdispatcher = {};
function EventDispatcher() {
  this._listeners = {};
  this.addListener = function (a, b) {
    void 0 === this._listeners[a] ? (this._listeners[a] = [b]) : this._listeners[a].push(b);
  };
  this.removeListener = function (a, b) {
    if (void 0 !== this._listeners[a])
      for (let c = 0, d = this._listeners[a].length; c < d; c++)
        if (
          this._listeners[a][c] === b &&
          (this._listeners[a].splice(c, 1), 0 === this._listeners[a].length)
        ) {
          delete this._listeners[a];
          break;
        }
  };
  this.dispatchEvent = function (a) {
    let b = this._listeners[a.type];
    if (void 0 !== b)
      if (1 === b.length) b[0](a);
      else for (let c = 0, d = b.length; c < d; c++) b[c](a);
  };
  this.removeListeners = function (a) {
    for (let b in this._listeners) this._listeners[b].splice(0, this._listeners[b].length);
  };
  this.hasListener = function (a, b) {
    if (void 0 !== this._listeners[a]) {
      if (void 0 === b) return !0;
      a = this._listeners[a];
      for (let c = 0, d = a.length; c < d; c++) if (a[c] === b) return !0;
    }
    return !1;
  };
  return this;
}
var client = {};
class Client extends EventDispatcher {
  constructor() {
    super();
    this.pinger = this.socket = null;
    this.time = 0;
    this.serverSwitch = !1;
    this.onCloseForImmediateReconnect = null;
    this.server = Client.DefaultServer;
    this.connectionTimeout = null;
    this.allowNextAttempt = !0;
  }
  setServer(a) {
    this.server = a;
  }
  connect() {
    if (this.allowNextAttempt) {
      this.allowNextAttempt = !1;
      null !== this.connectionTimeout &&
        (clearTimeout(this.connectionTimeout), (this.connectionTimeout = null));
      this.connectionTimeout = setTimeout(() => {
        this.allowNextAttempt = !0;
      }, 1e3);
      var a = LZString.compressToEncodedURIComponent(JSON.stringify(App.Credential));
      a =
        ("1" === this.server.secure ? "wss" : "ws") +
        "://" +
        this.server.domain +
        ":" +
        this.server.port +
        "/ws?auth=" +
        a;
      this.socket &&
        this.socket.readyState !== WebSocket.CLOSED &&
        this.socket.readyState !== WebSocket.CLOSING &&
        this.socket.readyState !== WebSocket.CONNECTING &&
        this.disconnect();
      this.socket = new WebSocket(a, ["ninja.io"]);
      this.socket.onopen = this.onOpen.bind(this);
      this.socket.onmessage = this.onMessage.bind(this);
      this.socket.onclose = this.onClose.bind(this);
      this.socket.onerror = this.onError.bind(this);
      this.socket.binaryType = "arraybuffer";
    }
  }
  disconnect(a) {
    this.serverSwitch = a;
    this.socket.close();
    clearInterval(this.pinger);
    this.pinger = null;
    this.dispatchEvent({ type: Client.DISCONNECT });
  }
  onOpen(a) {
    this.addListener(Protocol.ECHO_RESP, this.onEchoResponse._bind_(this));
    this.dispatchEvent({ type: Client.CONNECT });
    null !== this.pinger && (clearInterval(this.pinger), (this.pinger = null));
    this.pinger = setInterval(() => {
      this.time = DateUTC();
      this.emit({ type: Protocol.ECHO });
    }, 8e3);
  }
  onError(a) {
    this.dispatchEvent({ type: Client.CONNECTION_ERROR });
    console.log("Game server connection error", a);
  }
  onMessage(a) {
    a = Client.decompress(a.data);
    this.dispatchEvent(a);
  }
  onClose(a) {
    switch (a.code) {
      case Client.CODE_AUTH_FAILED:
        App.Console.log("Invalid credentials.", 16711680);
        this.dispatchEvent({ type: Client.AUTH_FAILED });
        break;
      case Client.CODE_MAX_CLIENTS:
        App.Console.log("This region is full.", 16711680);
        App.Console.log("Retry later or select a different region.", 16763904);
        this.dispatchEvent({ type: Client.SERVER_FULL });
        return;
      case Client.CODE_DUPLICATE_CLIENT:
        App.Console.log("This account is already connected.", 16711680);
    }
    if (this.serverSwitch) {
      if (((this.serverSwitch = !1), this.onCloseForImmediateReconnect))
        this.onCloseForImmediateReconnect();
    } else this.dispatchEvent({ type: Protocol.DISCONNECT });
  }
  emit(a) {
    this.socket.readyState === WebSocket.OPEN && ((a = Client.compress(a)), this.socket.send(a));
  }
  isConnected() {
    return null !== this.socket && this.socket.readyState === WebSocket.OPEN;
  }
  onEchoResponse() {
    let a = Date.now() - this.time;
    App.Stats.setPing(a);
  }
}
Client.compress = function (a) {
  let b = JSON.stringify(a),
    c = new Uint8Array(b.length + 1);
  c[0] = a.t ? 1 : 0;
  for (let d = 1, e = b.length; d < e + 1; d++) c[d] = b.charCodeAt(d - 1);
  return c.buffer;
};
Client.decompress = function (a) {
  a = new Uint8Array(a);
  let b;
  if (128 === a[0]) {
    b = Protocol.GAME_BIN;
    var c = Client.unpackGameData(a);
  } else {
    let d;
    switch (a[0]) {
      case 0:
        c = a.length - 1;
        for (d = Array(c); 0 < c--; ) d[c] = String.fromCharCode(a[c + 1]);
        c = JSON.parse(d.join(""));
        b = c.type;
        c = c.data;
        break;
      case 1:
        b = Protocol.GAME;
        c = a.length - 1;
        for (d = Array(c); 0 < c--; ) d[c] = String.fromCharCode(a[c + 1]);
        c = JSON.parse(d.join(""));
    }
  }
  return { data: c, type: b };
};
Client.unpackGameData = function (a) {
  return {
    t: Protocol.Game.UPDATE,
    d: JSON.parse(LZString.decompressFromUint8Array(a.subarray(1))),
  };
};
Client.CONNECT = "connect";
Client.DISCONNECT = "disconnect";
Client.AUTH_FAILED = "auth_failed";
Client.SERVER_FULL = "server_full";
Client.CONNECTION_ERROR = "connection_error";
Client.CODE_AUTH_FAILED = 1;
Client.CODE_MAX_CLIENTS = 2;
Client.CODE_DUPLICATE_CLIENT = 3;
Client.DefaultServer = {
  id: "6",
  uid: "EKWnN6sr",
  name: "NA 1",
  domain: "ca1.ninja.io",
  title: "North America 1",
  address: "167.114.144.181",
  port: "58391",
  secure: "1",
  region: "na_east",
  status: "online",
  players: "0",
  games: "0",
  modes: { deathmatch: "0", teamDeathmatch: "0", captureTheFlag: "0", dodgeball: "0" },
};
var inputstate = {};
function InputState() {
  this.mapping = InputState.InvertMapping(
    Registry.Instance[Registry.Key.SETTINGS].controls.keyBindings
  );
  null === this.mapping &&
    (this.mapping = InputState.InvertMapping(InputState.DefaultBindings.QWERTY));
  this.input = {
    LM: { d: 0, x: 0, y: 0 },
    RM: 0,
    W: 0,
    A: 0,
    S: 0,
    D: 0,
    E: 0,
    X: 0,
    F: 0,
    R: 0,
    Q: 0,
    _: 0,
  };
  this.update = function (a, b) {
    var c = !1;
    this.mapping[a]
      ? ("ctrl_chat" === this.mapping[a] && App.Console.setActive(!0),
        (a = InputState.GetMappedCharacter(a, this.mapping)))
      : arrowsInv[a] && (a = arrowsInv[a]);
    if (void 0 !== this.input[a] && this.input[a] !== b)
      if (((c = a), "object" === typeof b)) for (var d in b) this.input[a][d] = b[d];
      else this.input[a] = b;
    return c;
  };
}
InputState.GetMappedCharacter = function (a, b) {
  return InputState.DefaultBindings.QWERTY[b[a]];
};
InputState.InvertMapping = function (a) {
  var b = {},
    c;
  for (c in a) b[a[c]] = c;
  return b;
};
InputState.DefaultBindings = {
  QWERTY: {
    ctrl_jump: "W",
    ctrl_move_left: "A",
    ctrl_move_right: "D",
    ctrl_crouch: "S",
    ctrl_prone: "X",
    ctrl_fire: "LM",
    ctrl_fly: "RM",
    ctrl_reload: "R",
    ctrl_throw: "E",
    ctrl_drop: "F",
    ctrl_swap: "Q",
    ctrl_flag: "W+S",
    ctrl_chat: "T",
    ctrl_help: "H",
    ctrl_weapon: "G",
    ctrl_leader: "V",
  },
  AZERTY: {
    ctrl_jump: "Z",
    ctrl_move_left: "Q",
    ctrl_move_right: "D",
    ctrl_crouch: "S",
    ctrl_prone: "X",
    ctrl_fire: "LM",
    ctrl_fly: "RM",
    ctrl_reload: "R",
    ctrl_throw: "E",
    ctrl_drop: "F",
    ctrl_swap: "A",
    ctrl_flag: "Z+S",
    ctrl_chat: "T",
    ctrl_help: "H",
    ctrl_weapon: "G",
    ctrl_leader: "V",
  },
};
InputState.Descriptions = {
  ctrl_fly: "(right mouse) Fly",
  ctrl_fire: "(left mouse) Fire weapon",
  ctrl_jump: "Jump",
  ctrl_move_left: "Move left",
  ctrl_move_right: "Move right",
  ctrl_crouch: "Crouch, roll, teleport",
  ctrl_prone: "Prone",
  ctrl_reload: "Reload",
  ctrl_throw: "Throw weapon",
  ctrl_drop: "Drop weapon",
  ctrl_swap: "Swap weapon",
  ctrl_flag: "Thow flag",
  ctrl_chat: "(or ENTER) Chat",
  ctrl_help: "Display help",
  ctrl_weapon: "Display weapon menu",
  ctrl_leader: "Display leaderboard",
};
var registry = {};
class Registry {
  constructor() {
    this.settings = Registry.DefaultSettings;
    try {
      if (void 0 === window.localStorage) return;
    } catch (a) {
      return;
    }
    try {
      this[Registry.Key.MASTER] = JSON.parse(localStorage.getItem(Registry.Key.MASTER));
    } catch (a) {}
    try {
      this[Registry.Key.SETTINGS] = JSON.parse(localStorage.getItem(Registry.Key.SETTINGS));
    } catch (a) {}
    try {
      this[Registry.Key.CREDENTIAL] = JSON.parse(localStorage.getItem(Registry.Key.CREDENTIAL));
    } catch (a) {}
    null === this[Registry.Key.MASTER]
      ? ((this[Registry.Key.MASTER] = { registryVersion: Registry.Version, firstRun: !0 }),
        localStorage.setItem(Registry.Key.MASTER, JSON.stringify(this[Registry.Key.MASTER])))
      : this[Registry.Key.MASTER].firstRun &&
        ((this[Registry.Key.MASTER].firstRun = !1),
        localStorage.setItem(Registry.Key.MASTER, JSON.stringify(this[Registry.Key.MASTER])));
    null === this[Registry.Key.SETTINGS] &&
      ((this[Registry.Key.SETTINGS] = Registry.DefaultSettings),
      localStorage.setItem(Registry.Key.SETTINGS, JSON.stringify(this[Registry.Key.SETTINGS])));
    null === this[Registry.Key.CREDENTIAL] &&
      ((this[Registry.Key.CREDENTIAL] = { available: !1 }),
      localStorage.setItem(Registry.Key.CREDENTIAL, JSON.stringify(this[Registry.Key.CREDENTIAL])));
  }
  store(a, b) {
    Registry.SetLocalStorageItem(a, b, !0);
  }
  retrieve(a) {
    return Registry.GetLocalStorageItem(a, !0);
  }
  remove(a) {
    return Registry.RemoveStorageItem(a);
  }
}
Registry.GetLocalStorageItem = function (a, b = !1) {
  try {
    if (void 0 === window.localStorage) return;
  } catch (d) {
    return { available: !1 };
  }
  let c;
  if (b)
    try {
      c = JSON.parse(localStorage.getItem(a));
    } catch (d) {
      c = { error: !0 };
    }
  else c = localStorage.getItem(a);
  return c;
};
Registry.SetLocalStorageItem = function (a, b, c = !1) {
  try {
    if (void 0 === window.localStorage) return;
  } catch (d) {
    return;
  }
  this[a] = b;
  localStorage.setItem(a, c ? JSON.stringify(b) : b);
};
Registry.RemoveStorageItem = function (a) {
  try {
    if (void 0 === window.localStorage) return;
  } catch (b) {
    return;
  }
  void 0 !== this[a] && delete this[a];
  localStorage.removeItem(a);
};
Registry.Version = "1.0.0";
Registry.Key = {
  MASTER: "master",
  SETTINGS: "settings",
  CREDENTIAL: "credential",
  AUTOGEN: "autogen",
};
Registry.DefaultSettings = {
  controls: { keyBindings: InputState.DefaultBindings.QWERTY },
  graphics: { reticleLine: !0, aa: !1, fxaa: !1, shockwaveFx: !1 },
  sound: { enabled: !0, volume: 1 },
};
Registry.Instance = new Registry();
var feature = {};
class Feature extends PIXI.Graphics {
  constructor() {
    super();
    this.hides = [];
    this.container = new PIXI.Container();
    this.addChild(this.container);
  }
  show() {}
  hide() {}
  resize(a, b) {
    this.x = 0.5 * a;
    this.y = -8;
  }
  update() {}
}
var movementjoystick = {};
class MovementJoystick extends PIXI.Graphics {
  constructor() {
    super();
    this.lineStyle(2, 16777215, 0.6);
    this.beginFill(16777215, 0.1);
    this.drawRoundedRect(-60, -18, 36, 36, 8, 8);
    this.drawRoundedRect(24, -18, 36, 36, 8, 8);
    this.drawRoundedRect(-18, -60, 36, 36, 8, 8);
    this.drawRoundedRect(-18, 24, 36, 36, 8, 8);
    this.endFill();
    this.hitArea = new PIXI.Circle(0, 0, 60);
    this.interactive = !0;
    this.ny = this.nx = 0;
    this.pointerId = -1;
    this.on("pointerdown", (a) => this.onStart(a));
    this.on("pointermove", (a) => this.onMove(a));
    this.on("pointerup", (a) => this.onEnd(a));
    this.on("pointerupoutside", (a) => this.onEnd(a));
    this.on("touchstart", (a) => {
      a.stopPropagation();
    });
    this.jump = this.prone = this.crouch = this.fly = this.right = this.left = !1;
    this.stick = new PIXI.Graphics();
    this.addChild(this.stick);
    this.knob = new PIXI.Graphics();
    this.knob.lineStyle(3, 16777215, 0.4);
    this.knob.beginFill(16777215, 0.3);
    this.knob.drawCircle(0, 0, 15);
    this.knob.endFill();
    this.addChild(this.knob);
    this.scale.x = this.scale.y = 1.3;
    this.label = new PIXI.Text("Movement", {
      fontName: "Arial",
      fontSize: 15,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.label.x = 0;
    this.label.y = 0.5 * this.height - 14;
    this.label.resolution = 1.5 * App.DevicePixelRatio;
    this.label.anchor.x = this.label.anchor.y = 0.5;
    this.label.scale.x = this.label.scale.y = 1.2;
    this.label.alpha = 0.9;
    this.label.tint = 16763904;
    this.addChild(this.label);
  }
  onStart(a) {
    a.stopPropagation();
    this.pointerId = a.data.pointerId;
    let b = this.toGlobal(new PIXI.Point(0, 0)),
      c = a.data.global.x - b.x;
    a = a.data.global.y - b.y;
    60 < Math.sqrt(c * c + a * a) || this.update(c, a);
  }
  onEnd(a) {
    a.data.pointerId === this.pointerId &&
      ((this.pointerId = -1),
      a.stopPropagation(),
      this.stick.clear(),
      (this.knob.x = 0),
      (this.knob.y = 0),
      this.emit(Layer.Events.JOYSTICK_MOVE_STATE, {
        left: !1,
        right: !1,
        fly: !1,
        crouch: !1,
        prone: !1,
        jump: !1,
        nx: 0.7 * this.nx,
        ny: 0.7 * this.ny,
      }));
  }
  onMove(a) {
    if (a.data.pointerId === this.pointerId) {
      a.stopPropagation();
      var b = this.toGlobal(new PIXI.Point(0, 0));
      this.update(a.data.global.x - b.x, a.data.global.y - b.y);
    }
  }
  update(a, b) {
    let c = Math.atan2(b, a),
      d = Math.min(Math.sqrt(a * a + b * b), 60);
    this.knob.x = d * Math.cos(c);
    this.knob.y = d * Math.sin(c);
    this.stick.clear();
    this.stick.lineStyle(1, 16777215, 1, 0.5, !0);
    this.stick.moveTo(0, 0);
    this.stick.lineTo(this.knob.x, this.knob.y);
    this.left = -30 > a;
    this.right = 30 < a;
    this.jump = -15 > b && -60 < b;
    this.fly = -60 > b;
    this.crouch = 30 < b && 60 >= b;
    this.prone = 60 < b;
    this.nx = (d / 60) * Math.cos(c);
    this.ny = (d / 60) * Math.sin(c);
    this.emit(Layer.Events.JOYSTICK_MOVE_STATE, {
      left: this.left,
      right: this.right,
      fly: this.fly,
      crouch: this.crouch,
      prone: this.prone,
      jump: this.jump,
      nx: 0.7 * this.nx,
      ny: 0.7 * this.ny,
    });
  }
}
MovementJoystick.POINTER_DOWN = "pointer_down";
var targetingjoystick = {};
class TargetingJoystick extends PIXI.Graphics {
  constructor() {
    super();
    this.lineStyle(2, 16777215, 0.6);
    this.beginFill(16777215, 0.1);
    this.drawCircle(0, 0, 50);
    this.endFill();
    this.interactive = !0;
    this.throwing = !1;
    this.pointerCount = 0;
    this.pointerId = -1;
    this.ny = this.nx = 0;
    this.on("pointerdown", (a) => this.onStart(a));
    this.on("pointermove", (a) => this.onMove(a));
    this.on("pointerup", (a) => this.onEnd(a));
    this.on("pointerupoutside", (a) => this.onEnd(a));
    this.on("touchstart", (a) => {
      a.stopPropagation();
    });
    this.stick = new PIXI.Graphics();
    this.addChild(this.stick);
    this.knob = new PIXI.Graphics();
    this.knob.lineStyle(3, 16777215, 0.4);
    this.knob.beginFill(16777215, 0.3);
    this.knob.drawCircle(0, 0, 15);
    this.knob.endFill();
    this.addChild(this.knob);
    this.switchWeaponKey = new PIXI.Graphics();
    this.switchWeaponKey.lineStyle(3, 16777215, 0.4);
    this.switchWeaponKey.beginFill(16777215, 0.3);
    this.switchWeaponKey.drawRoundedRect(0, 0, 36, 36, 4);
    this.switchWeaponKey.endFill();
    this.switchWeaponKey.interactive = !0;
    this.addChild(this.switchWeaponKey);
    this.switchWeaponKey.on("pointerdown", (a) => this.onSwitch(a));
    this.switchWeaponKey.x = 56;
    this.switchWeaponKey.y = 40;
    this.tapTime = 0;
    this.scale.x = this.scale.y = 1.3;
    this.label = new PIXI.Text("View & Aim", {
      fontName: "Arial",
      fontSize: 15,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.label.x = 0;
    this.label.y = 0.5 * this.height - 29;
    this.label.resolution = 1.5 * App.DevicePixelRatio;
    this.label.anchor.x = this.label.anchor.y = 0.5;
    this.label.scale.x = this.label.scale.y = 1.2;
    this.label.alpha = 0.9;
    this.label.tint = 16763904;
    this.addChild(this.label);
  }
  onSwitch(a) {
    a.stopPropagation();
    this.emit(Layer.Events.JOYSTICK_TARGET_STATE, {
      nx: 0.7 * this.nx,
      ny: 0.7 * this.ny,
      fire: !1,
      throw: !1,
      end: !1,
      switch: !0,
    });
  }
  onStart(a) {
    a.stopPropagation();
    this.pointerCount += 2 > this.pointerCount ? 1 : 0;
    var b = Date.now();
    500 > b - this.tapTime && (this.throwing = !0);
    this.tapTime = b;
    this.pointerId = a.data.pointerId;
    let c = this.toGlobal(new PIXI.Point(0, 0));
    b = a.data.global.x - c.x;
    a = a.data.global.y - c.y;
    60 < Math.sqrt(b * b + a * a) || this.update(b, a);
  }
  onEnd(a) {
    a.data.pointerId === this.pointerId &&
      ((this.pointerCount -= 0 < this.pointerCount ? 1 : 0),
      (this.pointerId = -1),
      a.stopPropagation(),
      this.stick.clear(),
      (this.knob.x = 0),
      (this.knob.y = 0),
      (this.throwing = !1),
      this.emit(Layer.Events.JOYSTICK_TARGET_STATE, {
        nx: 0.7 * this.nx,
        ny: 0.7 * this.ny,
        fire: !1,
        throw: !1,
        end: !0,
      }));
  }
  onMove(a) {
    if (a.data.pointerId === this.pointerId) {
      a.stopPropagation();
      var b = this.toGlobal(new PIXI.Point(0, 0));
      this.update(a.data.global.x - b.x, a.data.global.y - b.y);
    }
  }
  update(a, b) {
    let c = Math.atan2(b, a);
    a = Math.min(Math.sqrt(a * a + b * b), 60);
    this.knob.x = a * Math.cos(c);
    this.knob.y = a * Math.sin(c);
    this.stick.clear();
    this.stick.lineStyle(1, 16777215, 1, 0.5, !0);
    this.stick.moveTo(0, 0);
    this.stick.lineTo(this.knob.x, this.knob.y);
    this.nx = (a / 60) * Math.cos(c);
    this.ny = (a / 60) * Math.sin(c);
    this.emit(Layer.Events.JOYSTICK_TARGET_STATE, {
      nx: 0.7 * this.nx,
      ny: 0.7 * this.ny,
      fire: 10 < a && 2 > this.pointerCount,
      throw: this.throwing,
    });
  }
}
MovementJoystick.POINTER_DOWN = "pointer_down";
var gamemenu = {};
class GameMenu extends Feature {
  constructor() {
    super();
    this.discButtonBackground = new PIXI.Graphics();
    this.discButtonBackground.beginFill(0, 0.35);
    this.discButtonBackground.drawRoundedRect(0, 0, 60, 20, 2);
    this.discButtonBackground.endFill();
    this.discButtonBackground.scale.x = this.discButtonBackground.scale.y = 1.2;
    this.discButtonBackground.x = App.ClientWidth - 89;
    this.discButtonBackground.y = 3;
    this.discButtonBackground.interactive = !0;
    this.discButtonBackground.hitArea = new PIXI.Rectangle(0, 0, 60, 20);
    this.addChild(this.discButtonBackground);
    this.discTitle = new PIXI.Text("Menu", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.discTitle.x = 0.5 * this.discButtonBackground.width;
    this.discTitle.y = 16;
    this.discTitle.resolution = 1.5 * App.DevicePixelRatio;
    this.discTitle.anchor.x = this.discTitle.anchor.y = 0.5;
    this.discTitle.scale.x = this.discTitle.scale.y = 1.2;
    this.discTitle.alpha = 0.9;
    this.discTitle.tint = 16763904;
    this.addChild(this.discTitle);
    this.discButtonBackground.on("mouseover", () => {
      this.discTitle.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.discButtonBackground.on("mouseout", () => {
      this.discTitle.alpha = 0.9;
    });
    this.discButtonBackground.on("mousedown", () => {
      this.emit(Layer.Events.ESCAPE_MENU_ACCESS);
      AudioEffects.ButtonClick.audio.play();
    });
    this.discButtonBackground.on("touchstart", () => {
      this.emit(Layer.Events.ESCAPE_MENU_ACCESS);
      AudioEffects.ButtonClick.audio.play();
    });
    this.helpButtonBackground = new PIXI.Graphics();
    this.helpButtonBackground.beginFill(0, 0.35);
    this.helpButtonBackground.drawRoundedRect(0, 0, 80, 20, 2);
    this.helpButtonBackground.endFill();
    this.helpButtonBackground.x = App.ClientWidth - 180;
    this.helpButtonBackground.y = 3;
    this.helpButtonBackground.scale.x = this.helpButtonBackground.scale.y = 1.2;
    this.helpButtonBackground.interactive = !0;
    this.helpButtonBackground.hitArea = new PIXI.Rectangle(0, 0, 80, 20);
    this.addChild(this.helpButtonBackground);
    this.helpTitle = new PIXI.Text("Controls", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.helpTitle.x = 0.5 * this.helpButtonBackground.width;
    this.helpTitle.y = 16;
    this.helpTitle.resolution = 1.5 * App.DevicePixelRatio;
    this.helpTitle.anchor.x = this.helpTitle.anchor.y = 0.5;
    this.helpTitle.scale.x = this.helpTitle.scale.y = 1.2;
    this.helpTitle.alpha = 0.7;
    this.helpTitle.tint = 65280;
    this.addChild(this.helpTitle);
    this.helpButtonBackground.on("mouseover", () => {
      this.helpTitle.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.helpButtonBackground.on("mouseout", () => {
      this.helpTitle.alpha = 0.7;
    });
    this.helpButtonBackground.on("mousedown", () => {
      this.emit(Layer.Events.DISPLAY_HELP);
      AudioEffects.ButtonClick.audio.play();
    });
    this.helpButtonBackground.on("touchstart", () => {
      this.emit(Layer.Events.DISPLAY_HELP);
      AudioEffects.ButtonClick.audio.play();
    });
    App.IsMobile &&
      ((this.movementJoystick = new MovementJoystick()),
      this.movementJoystick.on(Layer.Events.JOYSTICK_MOVE_STATE, (a) =>
        this.emit(Layer.Events.JOYSTICK_MOVE_STATE, a)
      ),
      this.addChild(this.movementJoystick),
      (this.targetingJoystick = new TargetingJoystick()),
      this.targetingJoystick.on(Layer.Events.JOYSTICK_TARGET_STATE, (a) =>
        this.emit(Layer.Events.JOYSTICK_TARGET_STATE, a)
      ),
      this.addChild(this.targetingJoystick));
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      ((this.minmax = new PIXI.Sprite(App.CombinedTextures.max_screen)),
      (this.minmax.x = App.ClientWidth - 200),
      (this.minmax.y = 16),
      (this.minmax.anchor.x = this.minmax.anchor.y = 0.5),
      (this.minmax.alpha = 1),
      (this.minmax.scale.x = this.minmax.scale.y = 0.4),
      (this.minmax.interactive = !0),
      this.minmax.on("mousedown", () => {
        let a = window.document,
          b = a.documentElement,
          c =
            b.requestFullscreen ||
            b.mozRequestFullScreen ||
            b.webkitRequestFullScreen ||
            b.msRequestFullscreen,
          d =
            a.exitFullscreen ||
            a.mozCancelFullScreen ||
            a.webkitExitFullscreen ||
            a.msExitFullscreen;
        a.fullscreenElement ||
        a.mozFullScreenElement ||
        a.webkitFullscreenElement ||
        a.msFullscreenElement
          ? (d.call(a), (this.minmax.texture = App.CombinedTextures.max_screen))
          : (c.call(b), (this.minmax.texture = App.CombinedTextures.min_screen));
      }),
      this.addChild(this.minmax));
    App.IsMobile &&
      setInterval(() => {
        this.resize(App.ClientWidth, App.ClientHeight);
      }, 3e3);
  }
  show() {
    super.show();
    this.resize(App.ClientWidth, App.ClientHeight);
  }
  resize(a, b) {
    this.y = this.x = 0;
    var c = 0.9 > App.Scale ? 0.9 : App.Scale,
      d = this.toLocal(new PIXI.Point(a - 99 * c, 3 * c), App.Stage);
    this.discButtonBackground.scale.x = this.discButtonBackground.scale.y = 1.2 / c;
    this.discTitle.scale.x = this.discTitle.scale.y = 1.2 / c;
    this.discButtonBackground.x = d.x;
    this.discTitle.x = this.discButtonBackground.x + 0.5 * this.discButtonBackground.width;
    d = this.toLocal(new PIXI.Point(a - 210 * c, 3 * c), App.Stage);
    this.helpButtonBackground.scale.x = this.helpButtonBackground.scale.y = 1.2 / c;
    this.helpTitle.scale.x = this.helpTitle.scale.y = 1.2 / c;
    this.helpButtonBackground.x = d.x;
    this.helpTitle.x = this.helpButtonBackground.x + 0.5 * this.helpButtonBackground.width;
    this.minmax &&
      this.minmax.parent &&
      ((this.minmax.scale.x = this.minmax.scale.y = 0.5 / c),
      (c = this.toLocal(new PIXI.Point(a - 230 * c, 13 * c), App.Stage)),
      (this.minmax.x = c.x));
    App.IsMobile &&
      ((c = this.toLocal(new PIXI.Point(0.15 * a, 0.8 * b), App.Stage)),
      (a = this.toLocal(new PIXI.Point(0.85 * a, 0.8 * b), App.Stage)),
      (this.movementJoystick.x = c.x),
      (this.movementJoystick.y = c.y),
      (this.targetingJoystick.x = a.x),
      (this.targetingJoystick.y = a.y));
  }
}
var guestmenu = {};
class GuestMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = -6;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 46, 100, 524);
    this.background.endFill();
    this.container.addChild(this.background);
    this.discordButton = new PIXI.Sprite(App.CombinedTextures.discord);
    this.discordButton.y = 8;
    this.discordButton.scale.x = this.discordButton.scale.y = 0.25;
    this.joinDiscordText = new PIXI.Text("Discord", {
      fontSize: 18,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.joinDiscordText.y = this.discordButton.y + 6;
    this.joinDiscordText.tint = 16776960;
    this.joinDiscordText.resolution = 1.5 * App.DevicePixelRatio;
    this.joinDiscordText.interactive = !0;
    this.joinDiscordText.hitArea = new PIXI.Rectangle(-30, 0, 94, 24);
    this.joinDiscordText.on("mouseover", () => {
      this.discordButton.scale.x = this.discordButton.scale.y = 0.27;
      this.joinDiscordText.scale.x = this.joinDiscordText.scale.y = 1.1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.joinDiscordText.on("mouseout", () => {
      this.discordButton.scale.x = this.discordButton.scale.y = 0.25;
      this.joinDiscordText.scale.x = this.joinDiscordText.scale.y = 1;
    });
    this.joinDiscordText.on("mousedown", () => {
      window.open("https://discord.gg/yAYmSWZ", "_blank");
    });
    this.zapperButton = new PIXI.Sprite(App.CombinedTextures.zapper);
    this.zapperButton.y = App.ClientHeight - 35;
    this.zapperButton.scale.x = this.zapperButton.scale.y = 0.29;
    this.getZapperText = new PIXI.BitmapText("Play Zapper.io", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.getZapperText.y = App.ClientHeight - 26;
    this.getZapperText.tint = 16776960;
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      (this.addChild(this.discordButton), this.addChild(this.joinDiscordText));
    this.getZapperText.interactive = !0;
    this.getZapperText.hitArea = new PIXI.Rectangle(-30, 0, 220, 32);
    this.getZapperText.on("mouseover", () => {
      this.zapperButton.scale.x = this.zapperButton.scale.y = 0.32;
      this.getZapperText.scale.x = this.getZapperText.scale.y = 1.1;
    });
    this.getZapperText.on("mouseout", () => {
      this.zapperButton.scale.x = this.zapperButton.scale.y = 0.29;
      this.getZapperText.scale.x = this.getZapperText.scale.y = 1;
    });
    this.getZapperText.on("mousedown", () => {
      window.open(
        App.WhiteLabel === App.WhiteLabel_CG
          ? "https://www.crazygames.com/game/zapper-io"
          : "https://zapper.io",
        "_blank"
      );
    });
    this.loginButton = new PIXI.Graphics();
    this.loginButton.interactive = !0;
    this.loginButton.lineStyle(1, 16777215, 0.3, 0);
    this.loginButton.beginFill(16777215, 0.15);
    this.loginButton.drawRect(0, 0, 70, 25);
    this.loginButton.setActive = (a = !1) => {
      this.loginButton.tint = a ? 16777215 : 5592405;
    };
    this.loginButton.on("mousedown", () => {
      this.emit(Layer.Events.LOGIN_ACCESS);
    });
    this.loginButton.on("touchstart", () => {
      this.emit(Layer.Events.LOGIN_ACCESS);
    });
    this.loginButton.x = 116;
    this.loginButton.y = 16;
    this.loginButton.tint = 5592405;
    this.container.addChild(this.loginButton);
    this.loginText = new PIXI.Text("Login", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16750848,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.loginText.x = this.loginButton.x + 0.5 * (this.loginButton.width - this.loginText.width);
    this.loginText.y = this.loginButton.y + 2;
    this.loginText.resolution = 1.5 * App.DevicePixelRatio;
    this.loginText.alpha = 0.8;
    this.container.addChild(this.loginText);
    this.loginButton.on("mouseover", () => {
      this.loginText.alpha = 1;
    });
    this.loginButton.on("mouseout", () => {
      this.loginText.alpha = 0.8;
    });
    this.registerButton = new PIXI.Graphics();
    this.registerButton.interactive = !0;
    this.registerButton.lineStyle(1, 16777215, 0.3, 0);
    this.registerButton.beginFill(16777215, 0.15);
    this.registerButton.drawRect(0, 0, 70, 25);
    this.registerButton.setActive = (a = !1) => {
      this.registerButton.tint = a ? 16777215 : 5592405;
    };
    this.registerButton.on("mousedown", () => {
      this.emit(Layer.Events.REGISTER_ACCESS);
    });
    this.registerButton.on("touchstart", () => {
      this.emit(Layer.Events.REGISTER_ACCESS);
    });
    this.registerButton.x = this.loginButton.x + 74;
    this.registerButton.y = this.loginButton.y;
    this.registerButton.tint = 5592405;
    this.container.addChild(this.registerButton);
    this.registerText = new PIXI.Text("Register", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16750848,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.registerText.x =
      this.registerButton.x + 0.5 * (this.registerButton.width - this.registerText.width);
    this.registerText.y = this.registerButton.y + 2;
    this.registerText.resolution = 1.5 * App.DevicePixelRatio;
    this.registerText.alpha = 0.8;
    this.container.addChild(this.registerText);
    this.registerButton.on("mouseover", () => {
      this.registerText.alpha = 1;
    });
    this.registerButton.on("mouseout", () => {
      this.registerText.alpha = 0.8;
    });
    this.playButton = new GuestMenuButton("Play", 16763904, 18, "menu_icon_play");
    this.playButton.x = 0;
    this.playButton.y = 50;
    this.playButton.on(GuestMenuButton.BUTTON_PRESSED, () => this.emit(Layer.Events.MENU_ACCESS));
    this.container.addChild(this.playButton);
    this.profileButton = new GuestMenuButton("Profile", 16763904, 18, "menu_icon_profile");
    this.profileButton.x = 0;
    this.profileButton.y = this.playButton.y + 70;
    this.profileButton.on(GuestMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.GUEST_PROFILE_ACCESS)
    );
    this.container.addChild(this.profileButton);
    this.shopButton = new GuestMenuButton("Shop", 16763904, 18, "menu_icon_shop");
    this.shopButton.x = 0;
    this.shopButton.y = this.profileButton.y + 70;
    this.shopButton.on(GuestMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.CUSTOMIZATION_ACCESS)
    );
    this.container.addChild(this.shopButton);
    this.rankingButton = new GuestMenuButton("Ranking", 16763904, 18, "menu_icon_ranking");
    this.rankingButton.x = 0;
    this.rankingButton.y = this.shopButton.y + 70;
    this.rankingButton.on(GuestMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.RANKING_ACCESS)
    );
    this.container.addChild(this.rankingButton);
    this.memberButton = new GuestMenuButton("Players", 16763904, 18, "menu_icon_players");
    this.memberButton.x = 0;
    this.memberButton.y = this.rankingButton.y + 70;
    this.memberButton.on(GuestMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.MEMBER_ACCESS)
    );
    this.container.addChild(this.memberButton);
    this.clanButton = new GuestMenuButton("Clans", 16763904, 18, "menu_icon_clans");
    this.clanButton.x = 0;
    this.clanButton.y = this.memberButton.y + 70;
    this.clanButton.on(GuestMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.CLAN_BROWSER_ACCESS)
    );
    this.container.addChild(this.clanButton);
    this.settingsButton = new GuestMenuButton("Settings", 16763904, 18, "menu_icon_settings", !1);
    this.settingsButton.x = 0;
    this.settingsButton.y = this.clanButton.y + 70;
    this.settingsButton.on(GuestMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.SETTINGS_ACCESS)
    );
    this.container.addChild(this.settingsButton);
    this.setMode(GuestMenu.MODE_NONE);
  }
  setMode(a) {
    this.mode = a;
    this.playButton.setActive(a === GuestMenu.MODE_NONE);
    this.loginButton.setActive(a === GuestMenu.MODE_LOGIN);
    this.registerButton.setActive(a === GuestMenu.MODE_REGISTER);
    this.rankingButton.setActive(a === GuestMenu.MODE_RANKING);
    this.memberButton.setActive(a === GuestMenu.MODE_MEMBER);
    this.clanButton.setActive(a === GuestMenu.MODE_CLAN);
    this.shopButton.setActive(a === GuestMenu.MODE_SHOP);
    this.profileButton.setActive(a === GuestMenu.MODE_GUEST_PROFILE);
    this.settingsButton.setActive(a === GuestMenu.MODE_SETTINGS);
  }
  resize(a, b) {
    this.x = 0.5 * a - 430;
    this.y = -8;
    this.discordButton.x = 0;
    this.joinDiscordText.x = this.discordButton.x + this.discordButton.width + 2;
    this.zapperButton.x = 0.5 * -a + 0.5 * this.container.width + 5;
    this.getZapperText.x = this.zapperButton.x + this.zapperButton.width + 9;
    this.zapperButton.y = App.ClientHeight - 35;
    this.getZapperText.y = App.ClientHeight - 26;
    860 > App.ClientWidth || 560 > App.ClientHeight
      ? ((this.zapperButton.visible = !1), (this.getZapperText.visible = !1))
      : ((this.zapperButton.visible = !0), (this.getZapperText.visible = !0));
  }
}
GuestMenu.MODE_NONE = "none";
GuestMenu.MODE_LOGIN = "login";
GuestMenu.MODE_REGISTER = "register";
GuestMenu.MODE_RANKING = "ranking";
GuestMenu.MODE_MEMBER = "member";
GuestMenu.MODE_CLAN = "clan";
GuestMenu.MODE_SHOP = "shop";
GuestMenu.MODE_PARTNER = "partner";
GuestMenu.MODE_GUEST_PROFILE = "guest_profile";
GuestMenu.MODE_SETTINGS = "settings";
class GuestMenuButton extends PIXI.Graphics {
  constructor(a = "", b = 16763904, c = 18, d = null, e = !0) {
    super();
    this.interactive = !0;
    this.active = !1;
    this.hitArea = new PIXI.Rectangle(0, 0, 98, 70);
    this.backgroundEnabled = new PIXI.Graphics();
    this.backgroundEnabled.lineStyle(1, 16777215, 0.2, 0);
    this.backgroundEnabled.beginFill(6710886, 0.4);
    this.backgroundEnabled.drawRoundedRect(4, 1, 92, 69, 6);
    this.backgroundEnabled.endFill();
    e &&
      (this.backgroundEnabled.lineStyle(1, 16777215, 0.1, 0),
      this.backgroundEnabled.moveTo(8, 70),
      this.backgroundEnabled.lineTo(92, 70));
    this.backgroundDisabled = new PIXI.Graphics();
    this.backgroundDisabled.drawRect(0, 1, 100, 69);
    e &&
      (this.backgroundDisabled.lineStyle(1, 16777215, 0.1, 0),
      this.backgroundDisabled.moveTo(8, 70),
      this.backgroundDisabled.lineTo(92, 70));
    this.addChild(this.backgroundDisabled);
    this.backgroundHover = new PIXI.Graphics();
    this.backgroundHover.beginFill(0, 0.2);
    this.backgroundHover.drawRect(4, 1, 92, 69);
    this.backgroundHover.visible = !1;
    this.addChild(this.backgroundHover);
    this.activeBackground = this.backgroundDisabled;
    d &&
      ((this.icon = new PIXI.Sprite(App.CombinedTextures[d])),
      (this.icon.x = 0.5 * this.width),
      (this.icon.y = 0.37 * this.height),
      (this.icon.tint = 13421772),
      (this.icon.scale.x = this.icon.scale.y = 0.7),
      (this.icon.anchor.x = this.icon.anchor.y = 0.5),
      this.addChild(this.icon));
    this.label = new PIXI.Text(a, {
      fontSize: c,
      fontFamily: "Arial",
      fill: b,
      lineJoin: "round",
      strokeThickness: 3,
    });
    this.label.resolution = 1.5 * App.DevicePixelRatio;
    this.label.x = 0.5 * (this.width - this.label.width);
    this.label.y = 46;
    this.addChild(this.label);
    this.on("mousedown", () => {
      this.emit(GuestMenuButton.BUTTON_PRESSED);
      this.backgroundHover.visible = !1;
      AudioEffects.ButtonClick.audio.play();
    });
    this.on("touchstart", () => {
      this.emit(GuestMenuButton.BUTTON_PRESSED);
      AudioEffects.ButtonClick.audio.play();
    });
    this.on("mouseover", () => {
      this.active || (this.backgroundHover.visible = !0);
      AudioEffects.ButtonHover.audio.play();
    });
    this.on("mouseout", () => {
      this.backgroundHover.visible = !1;
    });
  }
  setActive(a = !0) {
    (this.active = a)
      ? (this.backgroundDisabled.parent && this.removeChild(this.backgroundDisabled),
        this.addChildAt(this.backgroundEnabled, 0),
        (this.activeBackground = this.backgroundEnabled))
      : (this.backgroundEnabled.parent && this.removeChild(this.backgroundEnabled),
        this.addChildAt(this.backgroundDisabled, 0),
        (this.activeBackground = this.backgroundDisabled));
  }
}
GuestMenuButton.BUTTON_PRESSED = "button_pressed";
var membermenu = {};
class MemberMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = -6;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 46, 100, 524);
    this.background.endFill();
    this.container.addChild(this.background);
    this.discordButton = new PIXI.Sprite(App.CombinedTextures.discord);
    this.discordButton.y = 8;
    this.discordButton.scale.x = this.discordButton.scale.y = 0.25;
    this.joinDiscordText = new PIXI.Text("Discord", {
      fontSize: 18,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.joinDiscordText.y = this.discordButton.y + 6;
    this.joinDiscordText.tint = 16776960;
    this.joinDiscordText.resolution = 1.5 * App.DevicePixelRatio;
    this.joinDiscordText.interactive = !0;
    this.joinDiscordText.hitArea = new PIXI.Rectangle(-30, 0, 94, 24);
    this.joinDiscordText.on("mouseover", () => {
      this.discordButton.scale.x = this.discordButton.scale.y = 0.27;
      this.joinDiscordText.scale.x = this.joinDiscordText.scale.y = 1.1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.joinDiscordText.on("mouseout", () => {
      this.discordButton.scale.x = this.discordButton.scale.y = 0.25;
      this.joinDiscordText.scale.x = this.joinDiscordText.scale.y = 1;
    });
    this.joinDiscordText.on("mousedown", () => {
      window.open("https://discord.gg/yAYmSWZ", "_blank");
    });
    this.zapperButton = new PIXI.Sprite(App.CombinedTextures.zapper);
    this.zapperButton.y = App.ClientHeight - 35;
    this.zapperButton.scale.x = this.zapperButton.scale.y = 0.29;
    this.getZapperText = new PIXI.BitmapText("Play Zapper.io", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.getZapperText.y = App.ClientHeight - 26;
    this.getZapperText.tint = 16776960;
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      (this.addChild(this.discordButton), this.addChild(this.joinDiscordText));
    this.getZapperText.interactive = !0;
    this.getZapperText.hitArea = new PIXI.Rectangle(-30, 0, 220, 32);
    this.getZapperText.on("mouseover", () => {
      this.zapperButton.scale.x = this.zapperButton.scale.y = 0.32;
      this.getZapperText.scale.x = this.getZapperText.scale.y = 1.1;
    });
    this.getZapperText.on("mouseout", () => {
      this.zapperButton.scale.x = this.zapperButton.scale.y = 0.29;
      this.getZapperText.scale.x = this.getZapperText.scale.y = 1;
    });
    this.getZapperText.on("mousedown", () => {
      window.open(
        App.WhiteLabel === App.WhiteLabel_CG
          ? "https://www.crazygames.com/game/zapper-io"
          : "https://zapper.io",
        "_blank"
      );
    });
    this.logoutButton = new PIXI.Graphics();
    this.logoutButton.interactive = !0;
    this.logoutButton.lineStyle(1, 16777215, 0.3, 0);
    this.logoutButton.beginFill(16777215, 0.15);
    this.logoutButton.drawRect(0, 0, 100, 25);
    this.logoutButton.setActive = () => {};
    this.logoutButton.on("mousedown", () => this.onLogout());
    this.logoutButton.on("touchstart", () => this.onLogout());
    this.logoutButton.x = 116;
    this.logoutButton.y = 15;
    this.logoutButton.tint = 5592405;
    this.container.addChild(this.logoutButton);
    this.logoutIcon = new PIXI.Sprite(App.CombinedTextures.logout);
    this.logoutIcon.x = this.logoutButton.x + this.logoutButton.width - 24;
    this.logoutIcon.y = this.logoutButton.y + 0.1 * this.logoutButton.height;
    this.logoutIcon.scale.x = this.logoutIcon.scale.y = 0.4;
    this.logoutIcon.interactive = !1;
    this.logoutIcon.alpha = 0.7;
    this.container.addChild(this.logoutIcon);
    this.logoutText = new PIXI.Text("Logout", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16750848,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.logoutText.x =
      this.logoutButton.x + 0.5 * (this.logoutButton.width - this.logoutText.width) - 10;
    this.logoutText.y = this.logoutButton.y + 2;
    this.logoutText.resolution = 1.5 * App.DevicePixelRatio;
    this.logoutText.alpha = 0.7;
    this.container.addChild(this.logoutText);
    this.logoutButton.on("mouseover", () => {
      this.logoutText.alpha = this.logoutIcon.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.logoutButton.on("mouseout", () => {
      this.logoutText.alpha = this.logoutIcon.alpha = 0.7;
    });
    this.playButton = new MemberMenuButton("Play", 16763904, 18, "menu_icon_play");
    this.playButton.x = 0;
    this.playButton.y = 50;
    this.playButton.on(MemberMenuButton.BUTTON_PRESSED, () => this.emit(Layer.Events.MENU_ACCESS));
    this.container.addChild(this.playButton);
    this.profileButton = new MemberMenuButton("Profile", 16763904, 18, "menu_icon_profile");
    this.profileButton.x = 0;
    this.profileButton.y = this.playButton.y + 70;
    this.profileButton.on(MemberMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.PROFILE_ACCESS)
    );
    this.container.addChild(this.profileButton);
    this.shopButton = new MemberMenuButton("Shop", 16763904, 18, "menu_icon_shop");
    this.shopButton.x = 0;
    this.shopButton.y = this.profileButton.y + 70;
    this.shopButton.on(MemberMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.CUSTOMIZATION_ACCESS)
    );
    this.container.addChild(this.shopButton);
    this.rankingButton = new MemberMenuButton("Ranking", 16763904, 18, "menu_icon_ranking");
    this.rankingButton.x = 0;
    this.rankingButton.y = this.shopButton.y + 70;
    this.rankingButton.on(MemberMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.RANKING_ACCESS)
    );
    this.container.addChild(this.rankingButton);
    this.memberButton = new MemberMenuButton("Players", 16763904, 18, "menu_icon_players");
    this.memberButton.x = 0;
    this.memberButton.y = this.rankingButton.y + 70;
    this.memberButton.on(MemberMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.MEMBER_ACCESS)
    );
    this.container.addChild(this.memberButton);
    this.clanButton = new MemberMenuButton("Clans", 16763904, 18, "menu_icon_clans");
    this.clanButton.x = 0;
    this.clanButton.y = this.memberButton.y + 70;
    this.clanButton.on(MemberMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.CLAN_BROWSER_ACCESS)
    );
    this.container.addChild(this.clanButton);
    this.settingsButton = new MemberMenuButton("Settings", 16763904, 18, "menu_icon_settings", !1);
    this.settingsButton.x = 0;
    this.settingsButton.y = this.clanButton.y + 70;
    this.settingsButton.on(MemberMenuButton.BUTTON_PRESSED, () =>
      this.emit(Layer.Events.SETTINGS_ACCESS)
    );
    this.container.addChild(this.settingsButton);
    this.setMode(MemberMenu.MODE_NONE);
  }
  setMode(a) {
    this.mode = a;
    this.playButton.setActive(a === MemberMenu.MODE_NONE);
    this.logoutButton.setActive(a === MemberMenu.MODE_LOGIN);
    this.rankingButton.setActive(a === MemberMenu.MODE_RANKING);
    this.memberButton.setActive(a === MemberMenu.MODE_MEMBER);
    this.clanButton.setActive(a === MemberMenu.MODE_CLAN);
    this.shopButton.setActive(a === MemberMenu.MODE_SHOP);
    this.profileButton.setActive(a === MemberMenu.MODE_PROFILE);
    this.settingsButton.setActive(a === MemberMenu.MODE_SETTINGS);
  }
  resize(a, b) {
    this.x = 0.5 * a - 430;
    this.y = -8;
    this.discordButton.x = 0;
    this.joinDiscordText.x = this.discordButton.x + this.discordButton.width + 2;
    this.zapperButton.x = 0.5 * -a + 0.5 * this.container.width + 5 - 300 * (1 - App.Scale);
    this.getZapperText.x = this.zapperButton.x + this.zapperButton.width + 9;
    this.zapperButton.y = App.ClientHeight - 35 + 500 * (1 - App.Scale);
    this.getZapperText.y = App.ClientHeight - 26 + 500 * (1 - App.Scale);
    this.getZapperText.visible = 860 > App.ClientWidth || 560 > App.ClientHeight ? !1 : !0;
  }
  onLogout() {
    App.Autogen ? this.emit(Layer.Events.LOGOUT_ACCESS) : this.emit(Layer.Events.LOGOUT);
  }
}
MemberMenu.MODE_NONE = "none";
MemberMenu.MODE_RANKING = "ranking";
MemberMenu.MODE_SHOP = "shop";
MemberMenu.MODE_MEMBER = "member";
MemberMenu.MODE_CLAN = "clan";
MemberMenu.MODE_PROFILE = "profile";
MemberMenu.MODE_SETTINGS = "settings";
class MemberMenuButton extends PIXI.Graphics {
  constructor(a = "", b = 16763904, c = 18, d = null, e = !0) {
    super();
    this.interactive = !0;
    this.active = !1;
    this.hitArea = new PIXI.Rectangle(0, 0, 98, 70);
    this.backgroundEnabled = new PIXI.Graphics();
    this.backgroundEnabled.lineStyle(1, 16777215, 0.2, 0);
    this.backgroundEnabled.beginFill(6710886, 0.4);
    this.backgroundEnabled.drawRoundedRect(4, 1, 92, 69, 6);
    this.backgroundEnabled.endFill();
    e &&
      (this.backgroundEnabled.lineStyle(1, 16777215, 0.1, 0),
      this.backgroundEnabled.moveTo(8, 70),
      this.backgroundEnabled.lineTo(92, 70));
    this.backgroundDisabled = new PIXI.Graphics();
    this.backgroundDisabled.drawRect(0, 1, 100, 69);
    e &&
      (this.backgroundDisabled.lineStyle(1, 16777215, 0.1, 0),
      this.backgroundDisabled.moveTo(8, 70),
      this.backgroundDisabled.lineTo(92, 70));
    this.addChild(this.backgroundDisabled);
    this.backgroundHover = new PIXI.Graphics();
    this.backgroundHover.beginFill(0, 0.2);
    this.backgroundHover.drawRect(4, 1, 92, 69);
    this.backgroundHover.visible = !1;
    this.addChild(this.backgroundHover);
    this.activeBackground = this.backgroundDisabled;
    d &&
      ((this.icon = new PIXI.Sprite(App.CombinedTextures[d])),
      (this.icon.x = 0.5 * this.width),
      (this.icon.y = 0.37 * this.height),
      (this.icon.tint = 13421772),
      (this.icon.scale.x = this.icon.scale.y = 0.7),
      (this.icon.anchor.x = this.icon.anchor.y = 0.5),
      this.addChild(this.icon));
    this.label = new PIXI.Text(a, {
      fontSize: c,
      fontFamily: "Arial",
      fill: b,
      lineJoin: "round",
      strokeThickness: 3,
    });
    this.label.resolution = 1.5 * App.DevicePixelRatio;
    this.label.x = 0.5 * (this.width - this.label.width);
    this.label.y = 46;
    this.addChild(this.label);
    this.on("mousedown", () => {
      this.emit(MemberMenuButton.BUTTON_PRESSED);
      this.backgroundHover.visible = !1;
      AudioEffects.ButtonClick.audio.play();
    });
    this.on("touchstart", () => {
      this.emit(MemberMenuButton.BUTTON_PRESSED);
      AudioEffects.ButtonClick.audio.play();
    });
    this.on("mouseover", () => {
      this.active || (this.backgroundHover.visible = !0);
      AudioEffects.ButtonHover.audio.play();
    });
    this.on("mouseout", () => {
      this.backgroundHover.visible = !1;
    });
  }
  setActive(a = !0) {
    (this.active = a)
      ? (this.backgroundDisabled.parent && this.removeChild(this.backgroundDisabled),
        this.addChildAt(this.backgroundEnabled, 0),
        (this.activeBackground = this.backgroundEnabled))
      : (this.backgroundEnabled.parent && this.removeChild(this.backgroundEnabled),
        this.addChildAt(this.backgroundDisabled, 0),
        (this.activeBackground = this.backgroundDisabled));
  }
}
MemberMenuButton.BUTTON_PRESSED = "button_pressed";
var memberbrowsermenu = {};
class MemberBrowserMenu extends Feature {
  constructor() {
    super();
    this.searchTimeout = null;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.container.addChild(this.background);
    this.ox = 40;
    this.oy = 20;
    this.searchValue = "";
    this.titleText = new PIXI.Text("Players", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.titleText.x = 0.5 * this.width - 20;
    this.titleText.y = this.oy + 36;
    this.titleText.anchor.x = 0.5;
    this.container.addChild(this.titleText);
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.MEMBER_CANCEL));
    this.container.addChild(this.closeButton);
    this.container.x = 0.5 * -this.width;
    this.usernameTitle = new PIXI.Text("Name search:", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.usernameTitle.x = this.ox - 12;
    this.usernameTitle.y = this.oy + 78;
    this.container.addChild(this.usernameTitle);
    this.searchField = new InputField("name_search");
    this.searchField.setDimensions(300, 35);
    this.searchField.forceLowerCase = !1;
    this.searchField.setMaxChars(18);
    this.searchField.x = this.ox + 100;
    this.searchField.y = this.oy + 76;
    this.searchField.scale.x = this.searchField.scale.y = 0.8;
    this.searchField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#^&*-._:=[]"
    );
    this.container.addChild(this.searchField);
    this.searchField.addListener(InputField.CHANGE, (a) => {
      this.searchValue = a.data.value;
      this.onSearch();
    });
    this.loaderText = new PIXI.Text("Search results will appear here.", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 13421772,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.loaderText.x = this.ox + 20;
    this.loaderText.y = this.oy + 139;
    this.container.addChild(this.loaderText);
    this.nameText = new PIXI.Text("Name", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.nameText.x = this.ox + 20;
    this.nameText.y = this.oy + 109;
    this.container.addChild(this.nameText);
    this.skillRankingText = new PIXI.Text("Skill rank", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillRankingText.x = this.ox + 275;
    this.skillRankingText.y = this.oy + 109;
    this.container.addChild(this.skillRankingText);
    this.rankingText = new PIXI.Text("Experience rank", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.rankingText.x = this.ox + 400;
    this.rankingText.y = this.oy + 109;
    this.container.addChild(this.rankingText);
    this.nameFieldTableContainerMask = new PIXI.Graphics();
    this.nameFieldTableContainerMask.beginFill(16777215, 1);
    this.nameFieldTableContainerMask.drawRect(-10, 150, 640, 390);
    this.nameFieldTableContainerMask.endFill();
    this.nameFieldTableContainerMask.x = 10;
    this.container.addChild(this.nameFieldTableContainerMask);
    this.nameFieldTableContainer = new PIXI.Container();
    this.nameFieldTableContainer.x = 10;
    this.nameFieldTableContainer.mask = this.nameFieldTableContainerMask;
    this.container.addChild(this.nameFieldTableContainer);
    this.nameFieldScrollbar = new MemberBrowserScrollbar(404);
    this.nameFieldScrollbar.x = 625;
    this.nameFieldScrollbar.y = 150;
    this.container.addChild(this.nameFieldScrollbar);
    this.nameFieldScrollbar.on(MemberBrowserScrollbar.SCROLL, (a) => {
      this.nameFieldTableContainer.height > this.nameFieldTableContainerMask.height &&
        (this.nameFieldTableContainer.y = -(
          a *
          (this.nameFieldTableContainer.height - this.nameFieldTableContainerMask.height)
        ));
    });
  }
  show() {
    this.nameFieldScrollbar.enableWheel();
  }
  hide() {
    this.nameFieldScrollbar.disableWheel();
  }
  async onSearch() {
    this.nameFieldTableContainer.removeChildren();
    this.loaderText.visible = !0;
    0 === this.searchValue.trim().length
      ? (this.loaderText.text = "No results.")
      : (null !== this.searchTimeout && clearTimeout(this.searchTimeout),
        (this.loaderText.text = "Searching.."),
        (this.searchTimeout = setTimeout(() => this.search(), 750)));
  }
  async search() {
    var a = this.searchValue;
    null !== this.searchTimeout && (clearTimeout(this.searchTimeout), (this.searchTimeout = null));
    if (4 > a.trim().length) this.loaderText.text = "Name too short. Enter at least 4 characters.";
    else {
      var b = await APIClient.getUserSearch(a);
      this.nameFieldTableContainer.removeChildren();
      if (0 === a.trim().length) this.loaderText.text = "No results.";
      else if (b.success) {
        0 === b.users.length
          ? (this.loaderText.text = "No results.")
          : (this.loaderText.visible = !1);
        for (a = 0; a < b.users.length; a++) {
          const c = b.users[a],
            d = new MemberTableRow(a, c.id, c.name, parseInt(c.level), c.ranking, c.skill_ranking);
          d.x = this.ox + 20;
          d.y = this.oy + 36 * a + 130;
          d.on("mousedown", () => {
            this.emit(Layer.Events.USER_ACCESS, c.id, !1);
            AudioEffects.ButtonClick.audio.play();
          });
          this.nameFieldTableContainer.addChild(d);
        }
        this.nameFieldScrollbar.reset();
        this.nameFieldTableContainer.y = 0;
      } else this.loaderText.text = "No results (" + b.error + ").";
    }
  }
}
class MemberTableRow extends PIXI.Container {
  constructor(a, b, c, d, e, f) {
    super();
    this.index = a;
    this.interactive = !0;
    a = Math.max(Math.floor((d / 160) * 10) + 1);
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 560, 32);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.icon = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + a]);
    this.icon.x = -48;
    this.icon.y = -2;
    this.icon.scale.x = this.icon.scale.y = 0.5;
    this.addChild(this.icon);
    this.nameText = new PIXI.BitmapText(c, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 0;
    this.nameText.y = 9;
    this.addChild(this.nameText);
    this.skillRankText = new PIXI.BitmapText(f.toString(), { fontName: "Open Sans", fontSize: 22 });
    this.skillRankText.x = 250;
    this.skillRankText.y = 9;
    this.skillRankText.tint = 16763904;
    this.addChild(this.skillRankText);
    this.rankText = new PIXI.BitmapText(e.toString(), { fontName: "Open Sans", fontSize: 22 });
    this.rankText.x = 375;
    this.rankText.y = 9;
    this.rankText.tint = 16763904;
    this.addChild(this.rankText);
  }
}
class MemberBrowserScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(MemberBrowserScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
MemberBrowserScrollbar.SCROLL = "scroll";
var util = {};
Math.PI05 = 0.5 * Math.PI;
Base62Charset = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
Number.prototype.clamp = function (a, b) {
  return this < a ? a : this > b ? b : this;
};
Number.prototype.toPrecision = function (a) {
  a *= Math.pow(10, a);
  return Math.round(this * a) / a;
};
Number.prototype.shortAngle = function (a) {
  if (this > a) {
    var b = this - a;
    a = b < Math.PI ? b : -1 * (2 * Math.PI - this + a);
  } else (b = a - this), (a = b < Math.PI ? -1 * b : 2 * Math.PI - a + this);
  return a;
};
numberWithPeriods = function (a) {
  return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
};
polyAreaTri = function (a, b, c) {
  return (b.y - a.y) * (c.x - b.x) - (b.x - a.x) * (c.y - b.y);
};
polyArea = function (a) {
  for (var b = 0, c = 0, d = a.length; c < d; c++) {
    var e = (c + 1) % d;
    b += a[e].x * a[c].y - a[c].x * a[e].y;
  }
  return b / 2;
};
polyCenter = function (a) {
  for (var b = { x: 0, y: 0 }, c = a.length, d = 0; d < c; d++) (b.x += a[d].x), (b.y += a[d].y);
  b.x /= c;
  b.y /= c;
  return b;
};
polyScaleCenter = function (a, b) {
  for (var c = polyCenter(a), d = a.length, e = 0; e < d; e++) {
    var f = a[e].y - c.y;
    a[e].x += (a[e].x - c.x) * (b - 1);
    a[e].y += f * (b - 1);
  }
};
polyScaleUnitCenter = function (a, b) {
  for (var c = polyCenter(a), d = a.length, e = 0; e < d; e++) {
    var f = a[e].x - c.x,
      g = a[e].y - c.y,
      h = Math.sqrt(f * f + g * g);
    a[e].x += (f / h) * b;
    a[e].y += (g / h) * b;
  }
};
polyCenterArr = function (a) {
  for (var b = { x: 0, y: 0 }, c = a.length, d = 0; d < c; d += 2) (b.x += a[d]), (b.y += a[d + 1]);
  b.x /= 0.5 * c;
  b.y /= 0.5 * c;
  return b;
};
polyRotate = function (a, b, c) {
  c = c || { x: 0, y: 0 };
  for (var d = a.length, e = 0; e < d; e++) {
    var f = a[e].x - c.x,
      g = a[e].y - c.y,
      h = Math.sqrt(f * f + g * g);
    f = Math.atan2(g, f);
    a[e].x = h * Math.cos(f + b) + c.x;
    a[e].y = h * Math.sin(f + b) + c.y;
  }
  return a;
};
polyRotateCopy = function (a, b, c) {
  c = c || { x: 0, y: 0 };
  for (var d = a.length, e = [], f = 0; f < d; f++) {
    var g = a[f].x - c.x,
      h = a[f].y - c.y,
      k = Math.sqrt(g * g + h * h);
    g = Math.atan2(h, g);
    e[f] = { x: k * Math.cos(g + b) + c.x, y: k * Math.sin(g + b) + c.y };
  }
  return e;
};
function getDir(a, b, c) {
  return 0 > (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x) ? -1 : 1;
}
function fastAtan2(a, b) {
  var c = Math.PI;
  if (0 === b) return 0 < a ? c / 2 : 0 === a ? 0 : -c / 2;
  var d = a / b;
  if (-1 > d || 1 < d) {
    if (((d = c / 2 - d / (d * d + 0.28)), 0 > a)) return d - c;
  } else if (((d /= 1 + 0.28 * d * d), 0 > b)) return 0 > a ? d - c : d + c;
  return d;
}
function Intersect(a, b, c, d, e, f, g, h, k) {
  c -= a;
  d -= b;
  g -= e;
  var m = h - f;
  h = (-d * (a - e) + c * (b - f)) / (-g * d + c * m);
  e = (g * (b - f) - m * (a - e)) / (-g * d + c * m);
  return 0 <= h && 1 >= h && 0 <= e && 1 >= e ? ((k.x = a + e * c), (k.y = b + e * d), !0) : !1;
}
function Intersect3(a, b, c, d, e, f, g, h) {
  var k = d - b,
    m = a - c,
    l = c * b - a * d;
  if (0 < (k * e + m * f + l) * (k * g + m * h + l)) return -1;
  var p = h - f;
  var n = e - g;
  l = g * f - e * h;
  g = p * a + n * b + l;
  h = p * c + n * d + l;
  return 0 < g * h ? -1 : 0 === k * n - p * m ? 0 : 1;
}
polyRotateFast = function (a, b) {
  for (var c = 0, d = a.length; c < d; c++) {
    var e = a[c].x,
      f = a[c].y,
      g = Math.sqrt(e * e + f * f);
    e = fastAtan2(f, e);
    a[c].x = g * Math.cos(e + b);
    a[c].y = g * Math.sin(e + b);
  }
};
polyRotateCopyFast = function (a, b) {
  for (var c = [], d = 0, e = a.length; d < e; d++) {
    var f = a[d].x,
      g = a[d].y,
      h = Math.sqrt(f * f + g * g);
    f = fastAtan2(g, f);
    c[d] = { x: h * Math.cos(f + b), y: h * Math.sin(f + b) };
  }
  return c;
};
polyBounds = function (a, b) {
  let c = { x: 0, y: 0, width: 0, height: 0 };
  for (let e = 0, f = a.length; e < f; e++) {
    var d = a[e].x;
    let g = a[e].y;
    d < c.x ? (c.x = d) : d > c.width && (c.width = d);
    g < c.y ? (c.y = g) : g > c.height && (c.height = g);
  }
  c.width -= c.x;
  c.height -= c.y;
  b &&
    ((a = b.x < c.x ? b.x : c.x),
    (d = b.y < c.y ? b.y : c.y),
    (c.width = (b.x + b.width < c.x + c.width ? c.x + c.width : b.x + b.width) - a),
    (c.height = (b.y + b.height < c.y + c.height ? c.y + c.height : b.y + b.height) - d),
    (c.x = a),
    (c.y = d));
  return c;
};
uintToVec4 = function (a) {
  return {
    w: parseInt(a[0] + a[1], 16) / 255,
    x: parseInt(a[2] + a[3], 16) / 255,
    y: parseInt(a[4] + a[5], 16) / 255,
    z: parseInt(a[6] + a[7], 16) / 255,
  };
};
uintToArr = function (a, b) {
  return [
    (parseInt(a[2] + a[3], 16) / 255) * b,
    (parseInt(a[4] + a[5], 16) / 255) * b,
    (parseInt(a[6] + a[7], 16) / 255) * b,
    (parseInt(a[0] + a[1], 16) / 255) * b,
  ];
};
Function.prototype._bind_ = function (a) {
  var b = this;
  return function (c) {
    b.call(a, c);
  };
};
DateUTC = function () {
  var a = new Date();
  return Date.UTC(
    a.getUTCFullYear(),
    a.getUTCMonth(),
    a.getUTCDate(),
    a.getUTCHours(),
    a.getUTCMinutes(),
    a.getUTCSeconds(),
    a.getUTCMilliseconds()
  );
};
dp = function (a, b) {
  return a.x * b.x + a.y * b.y;
};
perp = function (a, b) {
  var c = { x: 0, y: 0 };
  b ? ((c.x = -a.y), (c.y = a.x)) : ((c.x = a.y), (c.y = -a.x));
  return c;
};
mag = function (a) {
  return Math.sqrt(a.x * a.x + a.y * a.y);
};
norm = function (a) {
  var b = mag(a),
    c = { x: 0, y: 0 };
  if (0 === b) return c;
  c.x = a.x / b;
  c.y = a.y / b;
  return c;
};
project = function (a, b) {
  var c = norm(b),
    d = mag(a),
    e = mag(b);
  a = dp(a, b) / (0 === d * e ? 1e-4 : d * e);
  d *= a;
  c.x *= d;
  c.y *= d;
  return c;
};
RandomBrightColor = function () {
  let a = [Math.round(Math.random()), Math.round(Math.random()), Math.round(Math.random())];
  0 === a[0] + a[1] + a[2] && (a[Math.floor(3 * Math.random())] = 1);
  a[0] *= 170 + Math.ceil(86 * Math.random());
  a[1] *= 170 + Math.ceil(86 * Math.random());
  a[2] *= 170 + Math.ceil(86 * Math.random());
  return (a[0] << 16) | (a[1] << 8) | a[2];
};
xorshift128_seed = function (a) {
  xorshift128.s[0] = a;
  xorshift128.s[1] = (a << 1) ^ a;
};
xorshift128 = function () {
  var a = xorshift128.s[0],
    b = xorshift128.s[1],
    c = a + b;
  xorshift128.s[0] = a;
  b ^= b << 23;
  xorshift128.s[1] = b ^ a ^ (b >> 17) ^ (a >> 26);
  return c;
};
Base62Encode = function (a) {
  if (0 === a) return Base62Charset[0];
  for (var b = ""; 0 < a; ) (b = Base62Charset[a % 62] + b), (a = Math.floor(a / 62));
  return b;
};
Base62Decode = function (a) {
  var b = 0,
    c = a.length,
    d;
  for (d = 0; d < c; d++) {
    var e = a.charCodeAt(d);
    e = 58 > e ? e - 48 : 91 > e ? e - 29 : e - 87;
    b += e * Math.pow(62, c - d - 1);
  }
  return b;
};
xorshift128.s = [55403919, 12823250];
setCookie = function (a, b, c) {
  var d = "";
  c && ((d = new Date()), d.setTime(d.getTime() + 864e5 * c), (d = "; expires=" + d.toUTCString()));
  document.cookie = a + "=" + (b || "") + d + "; path=/; domain=ninja.io";
};
var clanbrowsermenu = {};
class ClanBrowserMenu extends Feature {
  constructor() {
    super();
    this.searchTimeout = null;
    this.lastRefresh = 0;
    this.clans = [];
    this.clanPropSort = "members";
    this.clanPropDir = { name: 1, skill: 1, members: -1, experience: 1 };
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.container.addChild(this.background);
    this.ox = 40;
    this.oy = 20;
    this.searchValue = "";
    this.titleText = new PIXI.Text("Clans", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.titleText.x = 0.5 * this.width - 20;
    this.titleText.y = this.oy + 36;
    this.titleText.anchor.x = 0.5;
    this.container.addChild(this.titleText);
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.CLAN_BROWSER_CANCEL));
    this.container.addChild(this.closeButton);
    this.container.x = 0.5 * -this.width;
    this.clanNameTitle = new PIXI.Text("Name search:", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.clanNameTitle.x = this.ox - 12;
    this.clanNameTitle.y = this.oy + 78;
    this.container.addChild(this.clanNameTitle);
    this.searchField = new InputField("name_search");
    this.searchField.setDimensions(300, 35);
    this.searchField.forceLowerCase = !1;
    this.searchField.setMaxChars(18);
    this.searchField.x = this.ox + 100;
    this.searchField.y = this.oy + 76;
    this.searchField.scale.x = this.searchField.scale.y = 0.8;
    this.searchField.setFilter("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890 ");
    this.container.addChild(this.searchField);
    this.searchField.addListener(InputField.CHANGE, (a) => {
      this.searchValue = a.data.value;
      this.onSearch();
    });
    this.loaderText = new PIXI.Text("Search results will appear here.", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 13421772,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.loaderText.x = this.ox + 20;
    this.loaderText.y = this.oy + 139;
    this.container.addChild(this.loaderText);
    this.nameText = new PIXI.Text("Name", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.nameText.x = this.ox + 20;
    this.nameText.y = this.oy + 109;
    this.nameText.tint = 16755200;
    this.nameText.interactive = !0;
    this.nameText.hitArea = new PIXI.Rectangle(0, 0, this.nameText.width, this.nameText.height);
    this.container.addChild(this.nameText);
    this.nameText.on("mouseover", () => {
      this.nameText.tint = 16776960;
    });
    this.nameText.on("mouseout", () => {
      this.nameText.tint = 16755200;
    });
    this.nameText.on("mousedown", () => {
      this.clanPropSort = "name";
      this.clanPropDir[this.clanPropSort] *= -1;
      this.sortClans(this.clanPropSort, this.clanPropDir[this.clanPropSort]);
      AudioEffects.ButtonClick.audio.play();
    });
    this.membersText = new PIXI.Text("Members", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.membersText.x = this.ox + 220;
    this.membersText.y = this.oy + 109;
    this.membersText.tint = 16755200;
    this.membersText.interactive = !0;
    this.membersText.hitArea = new PIXI.Rectangle(
      0,
      0,
      this.membersText.width,
      this.membersText.height
    );
    this.container.addChild(this.membersText);
    this.membersText.on("mouseover", () => {
      this.membersText.tint = 16776960;
    });
    this.membersText.on("mouseout", () => {
      this.membersText.tint = 16755200;
    });
    this.membersText.on("mousedown", () => {
      this.clanPropSort = "members";
      this.clanPropDir[this.clanPropSort] *= -1;
      this.sortClans(this.clanPropSort, this.clanPropDir[this.clanPropSort]);
      AudioEffects.ButtonClick.audio.play();
    });
    this.skillRankingText = new PIXI.Text("Avg. skill", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillRankingText.x = this.ox + 340;
    this.skillRankingText.y = this.oy + 109;
    this.skillRankingText.tint = 16755200;
    this.skillRankingText.interactive = !0;
    this.skillRankingText.hitArea = new PIXI.Rectangle(
      0,
      0,
      this.skillRankingText.width,
      this.skillRankingText.height
    );
    this.container.addChild(this.skillRankingText);
    this.skillRankingText.on("mouseover", () => {
      this.skillRankingText.tint = 16776960;
    });
    this.skillRankingText.on("mouseout", () => {
      this.skillRankingText.tint = 16755200;
    });
    this.skillRankingText.on("mousedown", () => {
      this.clanPropSort = "skill";
      this.clanPropDir[this.clanPropSort] *= -1;
      this.sortClans(this.clanPropSort, this.clanPropDir[this.clanPropSort]);
      AudioEffects.ButtonClick.audio.play();
    });
    this.experienceRankingText = new PIXI.Text("Avg. experience", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.experienceRankingText.x = this.ox + 440;
    this.experienceRankingText.y = this.oy + 109;
    this.experienceRankingText.tint = 16755200;
    this.experienceRankingText.interactive = !0;
    this.experienceRankingText.hitArea = new PIXI.Rectangle(
      0,
      0,
      this.experienceRankingText.width,
      this.experienceRankingText.height
    );
    this.container.addChild(this.experienceRankingText);
    this.experienceRankingText.on("mouseover", () => {
      this.experienceRankingText.tint = 16776960;
    });
    this.experienceRankingText.on("mouseout", () => {
      this.experienceRankingText.tint = 16755200;
    });
    this.experienceRankingText.on("mousedown", () => {
      this.clanPropSort = "experience";
      this.clanPropDir[this.clanPropSort] *= -1;
      this.sortClans(this.clanPropSort, this.clanPropDir[this.clanPropSort]);
      AudioEffects.ButtonClick.audio.play();
    });
    this.nameFieldTableContainerMask = new PIXI.Graphics();
    this.nameFieldTableContainerMask.beginFill(16777215, 1);
    this.nameFieldTableContainerMask.drawRect(-10, 150, 640, 390);
    this.nameFieldTableContainerMask.endFill();
    this.nameFieldTableContainerMask.x = 10;
    this.container.addChild(this.nameFieldTableContainerMask);
    this.nameFieldTableContainer = new PIXI.Container();
    this.nameFieldTableContainer.x = 10;
    this.nameFieldTableContainer.mask = this.nameFieldTableContainerMask;
    this.container.addChild(this.nameFieldTableContainer);
    this.nameFieldScrollbar = new ClanBrowserScrollbar(404);
    this.nameFieldScrollbar.x = 625;
    this.nameFieldScrollbar.y = 150;
    this.container.addChild(this.nameFieldScrollbar);
    this.nameFieldScrollbar.on(ClanBrowserScrollbar.SCROLL, (a) => {
      this.nameFieldTableContainer.height > this.nameFieldTableContainerMask.height &&
        (this.nameFieldTableContainer.y = -(
          a *
          (this.nameFieldTableContainer.height - this.nameFieldTableContainerMask.height)
        ));
    });
  }
  show() {
    super.show();
    let a = Date.now();
    6e4 < a - this.lastRefresh && ((this.lastRefresh = a), this.onSearch(!1));
    this.nameFieldScrollbar.enableWheel();
  }
  hide() {
    this.nameFieldScrollbar.disableWheel();
  }
  onSearch(a = !0) {
    this.nameFieldTableContainer.removeChildren();
    this.loaderText.visible = !0;
    null !== this.searchTimeout && clearTimeout(this.searchTimeout);
    this.loaderText.text = "Searching..";
    a ? (this.searchTimeout = setTimeout(async () => this.search(), 750)) : this.search();
  }
  async search() {
    this.clans = [];
    var a = this.searchValue;
    null !== this.searchTimeout && (clearTimeout(this.searchTimeout), (this.searchTimeout = null));
    0 === a.trim().length && (a = "*");
    a = await APIClient.getClanSearch(a);
    if (a.success) {
      0 === a.clans.length
        ? (this.loaderText.text = "No results.")
        : (this.loaderText.visible = !1);
      this.clans = a.clans;
      for (let b = 0; b < a.clans.length; b++) {
        const c = a.clans[b],
          d = new ClanTableRow(b, c.id, c.name, c.members, c.skill, c.experience, c.level);
        d.x = this.ox + 20;
        d.y = this.oy + 36 * b + 130;
        d.on("mousedown", () => {
          this.emit(Layer.Events.CLAN_ACCESS, c.id);
          AudioEffects.ButtonClick.audio.play();
        });
        c.row = d;
        this.nameFieldTableContainer.addChild(d);
      }
      this.sortClans(this.clanPropSort, this.clanPropDir[this.clanPropSort]);
      this.nameFieldScrollbar.reset();
      this.nameFieldTableContainer.y = 0;
    } else this.loaderText.text = "No results (error).";
  }
  sortClans(a, b = 1) {
    "name" === a
      ? this.clans.sort((c, d) =>
          c[a].toLowerCase() < d[a].toLowerCase()
            ? -b
            : c[a].toLowerCase() > d[a].toLowerCase()
            ? b
            : 0
        )
      : this.clans.sort((c, d) =>
          parseInt(c[a]) < parseInt(d[a]) ? -b : parseInt(c[a]) > parseInt(d[a]) ? b : 0
        );
    for (let c = 0; c < this.clans.length; c++)
      (this.clans[c].row.y = this.oy + 36 * c + 130), this.clans[c].row.setIndex(c);
  }
}
class ClanTableRow extends PIXI.Container {
  constructor(a, b, c, d, e, f, g) {
    super();
    this.index = a;
    this.interactive = !0;
    b = Math.max(Math.floor((parseInt(g) / 160) * 10) + 1);
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 560, 32);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.setIndex(a);
    this.icon = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + b]);
    this.icon.x = -48;
    this.icon.y = -2;
    this.icon.scale.x = this.icon.scale.y = 0.5;
    this.addChild(this.icon);
    this.nameText = new PIXI.BitmapText(c, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 0;
    this.nameText.y = 9;
    this.nameText.tint = 16763904;
    this.addChild(this.nameText);
    this.membersText = new PIXI.BitmapText(numberWithPeriods(parseInt(d)), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.membersText.x = 195;
    this.membersText.y = 9;
    this.addChild(this.membersText);
    this.skillText = new PIXI.BitmapText(numberWithPeriods(parseInt(e)), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.skillText.x = 315;
    this.skillText.y = 9;
    this.addChild(this.skillText);
    this.experienceText = new PIXI.BitmapText(numberWithPeriods(parseInt(f)), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.experienceText.x = 415;
    this.experienceText.y = 9;
    this.addChild(this.experienceText);
  }
  setIndex(a = -1) {
    -1 !== a && (this.index = a);
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
  }
}
class ClanBrowserScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(ClanBrowserScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
ClanBrowserScrollbar.SCROLL = "scroll";
var button = {};
class Button extends PIXI.Graphics {
  constructor(a, b = null, c = null, d = null) {
    super();
    EventDispatcher.call(this);
    this.id = a || "button";
    this.value = "";
    this.interactive = this.enabled = !0;
    this.pressed = !1;
    this.clickInterval = d;
    this.hoverImage = this.image = this.clickTimeout = null;
    null !== b && ((this.image = new PIXI.Sprite(b)), this.addChild(this.image));
    null !== c &&
      ((this.hoverImage = new PIXI.Sprite(c)),
      (this.hoverImage.visible = !1),
      this.addChild(this.hoverImage));
    this.edge = new PIXI.Graphics();
    this.on("mousedown", (e) => this.onMouseDown(e));
    this.on("mouseup", (e) => this.onMouseUp(e));
    this.on("mouseover", () => this.onMouseOver());
    this.on("mouseout", () => this.onMouseOut());
    this.on("touchstart", (e) => this.onMouseDown(e));
    this.on("pointerup", (e) => this.onMouseUp(e));
  }
  setText(a, b, c) {
    this.text
      ? (this.text.text = a)
      : ((this.text = new PIXI.Text(a, {
          fontSize: 22,
          fontFamily: "Arial",
          fill: 16777215,
          lineJoin: "round",
          strokeThickness: 3,
        })),
        (this.text.resolution = 1.5 * App.DevicePixelRatio));
    this.addChild(this.text);
    this.text.x = b || 0;
    this.text.y = c || 5;
    this.draw();
  }
  redraw() {}
  draw() {
    this.image ||
      (this.clear(),
      this.lineStyle(3, 16777215, 0.2, 1),
      this.beginFill(11184810, 0.3),
      this.drawRoundedRect(-10, 0, this.text.width + 21, 36, 6),
      this.endFill(),
      this.edge.clear(),
      this.edge.lineStyle(3, 16777215, 0.4, 1),
      this.edge.drawRoundedRect(-10, 0, this.text.width + 21, 36, 6));
  }
  withinClickInterval() {
    if (null === this.clickInterval) return !1;
    if (null !== this.clickTimeout) return !0;
    this.clickTimeout = setTimeout(() => {
      this.clickTimeout = null;
      this.enable();
    }, this.clickInterval);
    this.disable();
    return !1;
  }
  onMouseDown(a) {
    a.stopPropagation();
    this.interactive &&
      !this.pressed &&
      (this.dispatchEvent(new CustomEvent(Button.BUTTON_PRESSED, { id: this.id })),
      (this.pressed = !0),
      AudioEffects.ButtonClick.audio.play());
  }
  onMouseUp(a) {
    a.stopPropagation();
    this.interactive &&
      !this.withinClickInterval() &&
      this.pressed &&
      (this.dispatchEvent(new CustomEvent(Button.BUTTON_RELEASED, { id: this.id })),
      (this.pressed = !1));
  }
  onMouseOver() {
    this.interactive &&
      (this.edge.parent || this.addChild(this.edge),
      AudioEffects.ButtonHover.audio.play(),
      this.image && this.hoverImage && ((this.image.visible = !1), (this.hoverImage.visible = !0)));
  }
  onMouseOut() {
    this.interactive &&
      (this.edge.parent && this.removeChild(this.edge),
      this.image && this.hoverImage && ((this.image.visible = !0), (this.hoverImage.visible = !1)));
  }
  disable() {
    this.alpha = 0.5;
    this.enabled = this.interactive = !1;
  }
  enable() {
    this.alpha = 1;
    this.enabled = this.interactive = !0;
  }
  setValue(a) {
    this.value = a;
  }
  setSize(a, b) {
    this.text.x = 0.25 * (a - this.text.width);
    this.text.y = 0.25 * (b - this.text.height);
  }
  setTint(a) {
    this.tint = a;
    this.text && (this.text.tint = a);
    this.image ||
      (this.edge.clear(),
      this.edge.lineStyle(3, this.tint, 0.4, 1),
      this.edge.drawRoundedRect(-10, 0, this.text.width + 21, 36, 6));
  }
}
Button.BUTTON_PRESSED = "buttonPressed";
Button.BUTTON_RELEASED = "buttonReleased";
var loginmenu = {};
class LoginMenu extends Feature {
  constructor() {
    super();
    this.storeCredentialFlag = !0;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.background.beginFill(0, 0.3);
    this.background.drawRect(130, 53, 400, 451);
    this.background.endFill();
    this.container.addChild(this.background);
    this.ox = 160;
    this.oy = 40;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 14;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.LOGIN_CANCEL));
    this.container.addChild(this.closeButton);
    this.loginTitle = new PIXI.Text("Login", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.loginTitle.x = 0.5 * this.width - 0.5 * this.loginTitle.width;
    this.loginTitle.y = this.oy + 16;
    this.container.addChild(this.loginTitle);
    this.usernameTitle = new PIXI.Text("Username", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.usernameTitle.x = this.ox;
    this.usernameTitle.y = this.oy + 80;
    this.container.addChild(this.usernameTitle);
    this.passwordTitle = new PIXI.Text("Password", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.passwordTitle.x = this.ox;
    this.passwordTitle.y = this.oy + 140;
    this.container.addChild(this.passwordTitle);
    this.errorMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16711680,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 360,
    });
    this.errorMessage.x = this.ox;
    this.errorMessage.y = this.oy + 280;
    this.recoverTitle = new PIXI.Text("Recover username / password", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.recoverTitle.x = this.ox;
    this.recoverTitle.y = this.oy + 480;
    this.recoverTitle.tint = 16746496;
    App.WhiteLabel !== App.WhiteLabel_POKI && this.container.addChild(this.recoverTitle);
    this.recoverTitle.interactive = !0;
    this.recoverTitle.hitArea = this.recoverTitle.getLocalBounds();
    this.recoverTitle.on("mousedown", () => {
      this.recoverTitle.tint = 16746496;
      this.emit(Layer.Events.RECOVER_ACCESS);
    });
    this.recoverTitle.on("mouseover", () => (this.recoverTitle.tint = 16763904));
    this.recoverTitle.on("mouseout", () => (this.recoverTitle.tint = 16746496));
    this.nameField = new InputField("login_name");
    this.nameField.setDimensions(300, 35);
    this.nameField.forceLowerCase = !1;
    this.nameField.setMaxChars(18);
    this.nameField.x = this.ox;
    this.nameField.y = this.oy + 100;
    this.nameField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#^&*-._:=[]"
    );
    this.container.addChild(this.nameField);
    this.passwordField = new InputField("login_password");
    this.passwordField.setDimensions(300, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(32);
    this.passwordField.setPassword(!0);
    this.passwordField.x = this.ox;
    this.passwordField.y = this.oy + 160;
    this.passwordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.passwordField);
    this.storeCredential = new Checkbox("storeCredential", "Stay logged in", !0);
    this.storeCredential.x = this.ox;
    this.storeCredential.y = this.oy + 204;
    this.storeCredential.setChecked(this.storeCredentialFlag);
    this.storeCredential.on(Checkbox.CHANGE, (a) => (this.storeCredentialFlag = a));
    this.container.addChild(this.storeCredential);
    this.submitButton = new Button("login");
    this.submitButton.selected = !0;
    this.submitButton.setText("Login");
    this.submitButton.scale.x = this.submitButton.scale.y = 0.8;
    this.submitButton.addListener(Button.BUTTON_RELEASED, this.onSubmitButtonReleased.bind(this));
    this.submitButton.x = this.ox + 11;
    this.submitButton.y = this.oy + 244;
    this.submitButton.setTint(16763904);
    this.container.addChild(this.submitButton);
    this.loadingContainer = new PIXI.Container();
    this.loadingBackground = new PIXI.Graphics();
    this.loadingBackground.x = 0;
    this.loadingBackground.y = 0;
    this.loadingBackground.lineStyle(3, 11184810, 0.5, 0);
    this.loadingBackground.beginFill(0, 0.8);
    this.loadingBackground.drawRoundedRect(0, 0, 300, 80, 10);
    this.loadingBackground.endFill();
    this.loadingContainer.addChild(this.loadingBackground);
    this.loadingText = new PIXI.Text("Processing login...", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.loadingText.x = 0.5 * this.loadingBackground.width;
    this.loadingText.y = 0.5 * this.loadingBackground.height;
    this.loadingText.anchor.x = this.loadingText.anchor.y = 0.5;
    this.loadingContainer.addChild(this.loadingText);
    this.loadingContainer.x = 0.5 * -this.loadingBackground.width;
    this.loadingContainer.y = 0.5 * this.container.height - 0.5 * this.loadingBackground.height;
    this.completedContainer = new PIXI.Container();
    this.completedBackground = new PIXI.Graphics();
    this.completedBackground.x = 0;
    this.completedBackground.y = 0;
    this.completedBackground.lineStyle(3, 11184810, 0.5, 0);
    this.completedBackground.beginFill(0, 0.8);
    this.completedBackground.drawRoundedRect(0, 0, 360, 130, 10);
    this.completedBackground.endFill();
    this.completedContainer.addChild(this.completedBackground);
    this.completedText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.completedText.x = 0.5 * this.completedBackground.width;
    this.completedText.y = 0.3 * this.completedBackground.height;
    this.completedText.anchor.x = this.completedText.anchor.y = 0.5;
    this.completedContainer.addChild(this.completedText);
    this.completedButton = new Button("continue");
    this.completedButton.selected = !0;
    this.completedButton.setText("Continue");
    this.completedButton.scale.x = this.completedButton.scale.y = 0.8;
    this.completedButton.addListener(
      Button.BUTTON_RELEASED,
      this.onCompletedButtonReleased.bind(this)
    );
    this.completedButton.x =
      0.5 * this.completedBackground.width - 0.5 * this.completedButton.width;
    this.completedButton.y = this.completedBackground.height - (this.completedButton.height + 16);
    this.completedContainer.addChild(this.completedButton);
    this.completedContainer.x = 0.5 * -this.completedBackground.width;
    this.completedContainer.y = 0.5 * this.container.height - 0.5 * this.completedBackground.height;
    this.container.x = 0.5 * -this.width;
  }
  show() {
    this.container.interactiveChildren = !0;
    this.submitButton.enable();
    this.container.alpha = 1;
  }
  reset() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.passwordField.setText("");
    this.container.interactiveChildren = !0;
    this.submitButton.enable();
    this.container.alpha = 1;
  }
  validateForm() {
    let a = !0,
      b = "",
      c = this.nameField.getText(),
      d = this.passwordField.getText();
    4 > c.length
      ? ((a = !1), (b = "Invalid username."), this.nameField.markInvalid())
      : this.nameField.markNone();
    a && 8 > d.length
      ? ((a = !1), (b = "Invalid password."), this.passwordField.markInvalid())
      : this.passwordField.markNone();
    return { valid: a, error: b };
  }
  onSubmitButtonReleased() {
    const a = this.validateForm();
    a.valid
      ? (this.displayErrorMessage(""),
        this.displayLoadingMessage(),
        this.emit(Layer.Events.LOGIN_SUBMIT, {
          name: this.nameField.text.text,
          password: this.passwordField.text.text,
          store: this.storeCredentialFlag,
        }))
      : this.displayErrorMessage(a.error);
  }
  displayLoadingMessage() {
    this.container.interactiveChildren = !1;
    this.addChild(this.loadingContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
  }
  displayCompletedMessage() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.container.interactiveChildren = !1;
    this.addChild(this.completedContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
    this.completedText.text = "Logged in as " + this.nameField.getText();
  }
  onCompletedButtonReleased() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.passwordField.setText("");
    this.emit(Layer.Events.LOGIN_CANCEL);
  }
  onCancelButtonReleased() {
    this.emit(Layer.Events.LOGIN_CANCEL);
  }
  displayErrorMessage(a) {
    this.errorMessage.text = a;
    this.errorMessage.parent || this.container.addChild(this.errorMessage);
  }
}
var checkbox = {};
class Checkbox extends PIXI.Container {
  constructor(a, b, c) {
    super();
    this.id = a;
    this.labelText = b;
    this.checked = c || !1;
    this.tex_unchecked = App.CombinedTextures.checkbox;
    this.tex_checked = App.CombinedTextures.checkbox_checked;
    this.icon = new PIXI.Sprite(this.checked ? this.tex_checked : this.tex_unchecked);
    this.icon.scale.x = this.icon.scale.y = 0.4;
    this.interactive = !0;
    this.label = new PIXI.Text(this.labelText, {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.label.x = this.icon.x + 34;
    this.label.y = this.icon.y + 3;
    this.label.resolution = 1.5 * App.DevicePixelRatio;
    this.pointerDownListener = this.mouseDownListener = null;
    this.addChild(this.icon);
    this.addChild(this.label);
    this.setEnabled(!0);
  }
  onMouseDown(a) {
    this.checked = !this.checked;
    this.icon.texture = this.checked ? this.tex_checked : this.tex_unchecked;
    this.emit(Checkbox.CHANGE, this.checked);
    AudioEffects.ButtonClick.audio.play();
  }
  setChecked(a, b = !0) {
    this.checked = a;
    this.icon.texture = this.checked ? this.tex_checked : this.tex_unchecked;
    b && this.emit(Checkbox.CHANGE, this.checked);
  }
  setEnabled(a) {
    a
      ? (null === this.mouseDownListener &&
          ((this.mouseDownListener = this.onMouseDown.bind(this)),
          this.on("mousedown", this.mouseDownListener),
          (this.pointerDownListener = this.onMouseDown.bind(this)),
          this.on("touchstart", this.pointerDownListener)),
        (this.alpha = 1))
      : (null !== this.mouseDownListener &&
          (this.removeListener("mousedown", this.mouseDownListener),
          (this.mouseDownListener = null),
          this.removeListener("touchstart", this.pointerDownListener),
          (this.pointerDownListener = null)),
        (this.alpha = 0.25));
  }
  setTint(a) {
    this.label.tint = a;
  }
}
Checkbox.CHANGE = "checkbox_change";
var registermenu = {};
class RegisterMenu extends Feature {
  constructor() {
    super();
    let a = App.WhiteLabel === App.WhiteLabel_POKI ? -96 : 0;
    this.challengeTexture = null;
    this.hasVerifiedEmail = !1;
    this.emailDisabled = !0;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.background.beginFill(0, 0.3);
    this.background.drawRect(100, 53, 460, 451);
    this.background.endFill();
    this.container.addChild(this.background);
    this.ox = 130;
    this.oy = 40;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 14;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.REGISTER_CANCEL));
    this.container.addChild(this.closeButton);
    this.loginTitle = new PIXI.Text("Register", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.loginTitle.x = 0.5 * this.width - 0.5 * this.loginTitle.width;
    this.loginTitle.y = this.oy + 16;
    this.container.addChild(this.loginTitle);
    this.emailCheck = new Checkbox("email_check", "Register without email", !0);
    this.emailCheck.x = this.ox;
    this.emailCheck.y = this.oy + 84;
    this.emailCheck.setChecked(!0);
    this.emailCheck.on(Checkbox.CHANGE, (b) => {
      this.emailTitle.alpha = b ? 0.3 : 1;
      this.emailField.alpha = b ? 0.3 : 1;
      this.emailDisabled = b;
      this.emailField.disabled = b;
    });
    this.emailTitle = new PIXI.Text("Email", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.emailTitle.x = this.ox;
    this.emailTitle.y = this.oy + 118;
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      (this.container.addChild(this.emailCheck), this.container.addChild(this.emailTitle));
    this.usernameTitle = new PIXI.Text("Username", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.usernameTitle.x = this.ox;
    this.usernameTitle.y = this.oy + 180 + a;
    this.container.addChild(this.usernameTitle);
    this.passwordTitle = new PIXI.Text("Password", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.passwordTitle.x = this.ox;
    this.passwordTitle.y = this.oy + 240 + a;
    this.container.addChild(this.passwordTitle);
    this.errorMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16711680,
      strokeThickness: 2,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 380,
    });
    this.errorMessage.x = this.ox;
    this.errorMessage.y = this.oy + 350 + a;
    this.emailField = new PIXI.TextInput({
      input: {
        fontSize: "20px",
        padding: "12px",
        width: "380px",
        height: "12px",
        color: "#EEEEEE",
      },
      box: {
        default: { fill: 2236962, rounded: 4, stroke: { color: 6710886, width: 2 } },
        focused: { fill: 4473924, rounded: 4, stroke: { color: 10066329, width: 2 } },
        disabled: { fill: 2236962, rounded: 4, stroke: { color: 6710886, width: 2 } },
      },
    });
    this.emailTitle.alpha = 0.3;
    this.emailTitle.alpha = 0.3;
    this.emailField.disabled = !0;
    this.emailField.maxLength = 64;
    this.emailField.x = this.ox;
    this.emailField.y = this.oy + 140 + a;
    this.emailField.maxLength = 64;
    this.emailField.restrict = "A-Za-z0-9@.+_-";
    App.WhiteLabel !== App.WhiteLabel_POKI && this.container.addChild(this.emailField);
    this.nameField = new InputField("register_name");
    this.nameField.setDimensions(300, 35);
    this.nameField.forceLowerCase = !1;
    this.nameField.setMaxChars(18);
    this.nameField.x = this.ox;
    this.nameField.y = this.oy + 200 + a;
    this.nameField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-().[]!"
    );
    this.container.addChild(this.nameField);
    this.passwordField = new InputField("register_password");
    this.passwordField.setDimensions(300, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(32);
    this.passwordField.setPassword(!0);
    this.passwordField.x = this.ox;
    this.passwordField.y = this.oy + 260 + a;
    this.passwordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.passwordField);
    this.submitButton = new Button("register");
    this.submitButton.selected = !0;
    this.submitButton.setText("Register");
    this.submitButton.scale.x = this.submitButton.scale.y = 0.8;
    this.submitButton.addListener(Button.BUTTON_RELEASED, this.onSubmitButtonReleased.bind(this));
    this.submitButton.x = this.ox + 11;
    this.submitButton.y = this.oy + 314 + a;
    this.submitButton.setTint(16763904);
    this.container.addChild(this.submitButton);
    this.loadingContainer = new PIXI.Container();
    this.loadingBackground = new PIXI.Graphics();
    this.loadingBackground.x = 0;
    this.loadingBackground.y = 0;
    this.loadingBackground.lineStyle(3, 11184810, 0.5, 0);
    this.loadingBackground.beginFill(0, 0.8);
    this.loadingBackground.drawRoundedRect(0, 0, 300, 80, 10);
    this.loadingBackground.endFill();
    this.loadingContainer.addChild(this.loadingBackground);
    this.loadingText = new PIXI.BitmapText("Processing registration...", {
      fontName: "Open Sans",
      fontSize: 26,
      align: "left",
    });
    this.loadingText.x = 0.5 * this.loadingBackground.width;
    this.loadingText.y = 0.5 * this.loadingBackground.height;
    this.loadingText.tint = 16763904;
    this.loadingText.anchor.x = this.loadingText.anchor.y = 0.5;
    this.loadingContainer.addChild(this.loadingText);
    this.loadingContainer.x = 0.5 * -this.loadingBackground.width;
    this.loadingContainer.y = 0.5 * this.container.height - 0.5 * this.loadingBackground.height;
    this.emailVerificationContainer = new PIXI.Container();
    this.emailVerificationBackground = new PIXI.Graphics();
    this.emailVerificationBackground.x = 0;
    this.emailVerificationBackground.y = 0;
    this.emailVerificationBackground.lineStyle(3, 11184810, 0.5, 0);
    this.emailVerificationBackground.beginFill(0, 0.8);
    this.emailVerificationBackground.drawRoundedRect(0, 0, 440, 240, 10);
    this.emailVerificationBackground.endFill();
    this.emailVerificationContainer.addChild(this.emailVerificationBackground);
    this.emailVerificationContainer.x = 0.5 * -this.emailVerificationContainer.width;
    this.emailVerificationContainer.y =
      0.5 * this.container.height - 0.5 * this.emailVerificationContainer.height;
    this.emailVerificationText = new PIXI.BitmapText("Verify email address", {
      fontName: "Open Sans",
      fontSize: 26,
      align: "center",
      multiline: !0,
    });
    this.emailVerificationText.x = 0.5 * this.emailVerificationContainer.width;
    this.emailVerificationText.y = 40;
    this.emailVerificationText.tint = 16763904;
    this.emailVerificationText.anchor.x = this.emailVerificationText.anchor.y = 0.5;
    this.emailVerificationContainer.addChild(this.emailVerificationText);
    this.emailVerificationWarning = new PIXI.BitmapText(
      "Enter your email address again to verify",
      { fontName: "Open Sans", fontSize: 22, align: "left" }
    );
    this.emailVerificationWarning.x = 0.5 * this.emailVerificationContainer.width;
    this.emailVerificationWarning.y = 66;
    this.emailVerificationWarning.tint = 16733440;
    this.emailVerificationWarning.anchor.x = this.emailVerificationText.anchor.y = 0.5;
    this.emailVerificationContainer.addChild(this.emailVerificationWarning);
    this.emailVerificationField = new PIXI.TextInput({
      input: {
        fontSize: "20px",
        padding: "12px",
        width: "380px",
        height: "35px",
        color: "#EEEEEE",
      },
      box: {
        default: { fill: 2236962, rounded: 4, stroke: { color: 6710886, width: 2 } },
        focused: { fill: 4473924, rounded: 4, stroke: { color: 10066329, width: 2 } },
        disabled: { fill: 2236962, rounded: 4, stroke: { color: 6710886, width: 2 } },
      },
    });
    this.emailVerificationField.maxLength = 64;
    this.emailVerificationField.x =
      0.5 * (this.emailVerificationContainer.width - this.emailVerificationField.width);
    this.emailVerificationField.y = 90;
    this.emailVerificationField.maxLength = 64;
    this.emailVerificationField.restrict = "A-Za-z0-9@.+_-";
    this.emailVerificationContainer.addChild(this.emailVerificationField);
    this.verifyBox = new Checkbox("verify", "", !0);
    this.verifyBox.x = 28;
    this.verifyBox.y = 140;
    this.verifyBox.setChecked(this.hasVerifiedEmail);
    this.verifyBox.on(Checkbox.CHANGE, (b) => (this.hasVerifiedEmail = b));
    this.emailVerificationContainer.addChild(this.verifyBox);
    this.verificationBoxWarning = new PIXI.BitmapText(
      "Verify that you own this email address.\nYou cannot access this account without it.",
      { fontName: "Open Sans", fontSize: 22, align: "left" }
    );
    this.verificationBoxWarning.x = 60;
    this.verificationBoxWarning.y = this.verifyBox.y - 6;
    this.verificationBoxWarning.tint = 16776960;
    this.verificationBoxWarning.anchor.x = this.verificationBoxWarning.anchor.y = 0;
    this.emailVerificationContainer.addChild(this.verificationBoxWarning);
    this.emailVerificationButton = new Button("verify_email");
    this.emailVerificationButton.selected = !0;
    this.emailVerificationButton.setText("Verify");
    this.emailVerificationButton.scale.x = this.emailVerificationButton.scale.y = 0.6;
    this.emailVerificationButton.addListener(
      Button.BUTTON_RELEASED,
      this.onEmailVerificationButtonReleased.bind(this)
    );
    this.emailVerificationButton.x =
      0.5 * (this.emailVerificationContainer.width - this.emailVerificationButton.width) - 50;
    this.emailVerificationButton.y = 190;
    this.emailVerificationContainer.addChild(this.emailVerificationButton);
    this.emailVerificationCancelButton = new Button("verify_cancel_email");
    this.emailVerificationCancelButton.selected = !1;
    this.emailVerificationCancelButton.setText("Cancel");
    this.emailVerificationCancelButton.scale.x = this.emailVerificationCancelButton.scale.y = 0.6;
    this.emailVerificationCancelButton.addListener(
      Button.BUTTON_RELEASED,
      this.onCancelEmailVerificationButtonReleased.bind(this)
    );
    this.emailVerificationCancelButton.x =
      0.5 * (this.emailVerificationContainer.width - this.emailVerificationCancelButton.width) + 50;
    this.emailVerificationCancelButton.y = 190;
    this.emailVerificationContainer.addChild(this.emailVerificationCancelButton);
    this.completedContainer = new PIXI.Container();
    this.completedBackground = new PIXI.Graphics();
    this.completedBackground.x = 0;
    this.completedBackground.y = 0;
    this.completedBackground.lineStyle(3, 11184810, 0.5, 0);
    this.completedBackground.beginFill(0, 0.8);
    this.completedBackground.drawRoundedRect(0, 0, 400, 280, 10);
    this.completedBackground.endFill();
    this.completedContainer.addChild(this.completedBackground);
    this.completedText = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 26,
      align: "center",
      multiline: !0,
    });
    this.completedText.x = 0.5 * this.completedBackground.width;
    this.completedText.y = 0.35 * this.completedBackground.height;
    this.completedText.tint = 16763904;
    this.completedText.anchor.x = this.completedText.anchor.y = 0.5;
    this.completedContainer.addChild(this.completedText);
    this.completedButton = new Button("continue");
    this.completedButton.selected = !0;
    this.completedButton.setText("Continue");
    this.completedButton.scale.x = this.completedButton.scale.y = 0.6;
    this.completedButton.addListener(
      Button.BUTTON_RELEASED,
      this.onCompletedButtonReleased.bind(this)
    );
    this.completedButton.x =
      0.5 * this.completedBackground.width - 0.5 * this.completedButton.width;
    this.completedButton.y = this.completedBackground.height - (this.completedButton.height + 16);
    this.completedContainer.addChild(this.completedButton);
    this.completedContainer.x = 0.5 * -this.completedBackground.width;
    this.completedContainer.y = 0.5 * this.container.height - 0.5 * this.completedBackground.height;
    this.container.x = 0.5 * -this.width;
  }
  validateForm() {
    let a = !0,
      b = "";
    const c = this.emailField.text.trim(),
      d = this.nameField.getText(),
      e = this.passwordField.getText();
    if (!this.emailDisabled)
      if (
        (a &&
          (3 > c.length ||
            !c.match(
              /^[\w-]+(\.[\w-]+)*@([a-z0-9-]+(\.[a-z0-9-]+)*?\.[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})(:\d{4})?$/g
            ))) ||
        -1 !== c.indexOf("@gmai.") ||
        -1 !== c.indexOf("@gamil.") ||
        -1 !== c.indexOf("@gmial.") ||
        -1 !== c.indexOf("@gail.") ||
        -1 !== c.indexOf("@gmali.") ||
        -1 !== c.indexOf("@mgail.") ||
        ".ed" === c.substr(-3) ||
        "ocm" === c.substr(-3) ||
        "cmo" === c.substr(-3) ||
        -1 !== c.indexOf("@gnail.") ||
        -1 !== c.indexOf(".gmail.") ||
        -1 !== c.indexOf("@hayoo") ||
        -1 !== c.indexOf("gmail.com.") ||
        -1 !== c.indexOf("@gmail.org") ||
        (-1 !== c.indexOf("@gmail.") && "com" !== c.substr(-3)) ||
        -1 !== c.indexOf("@youtube.com") ||
        -1 !== c.indexOf("@example.com") ||
        -1 !== c.indexOf("@example.org")
      )
        (b = "Invalid email address."), (a = !1), this.emailField.markInvalid();
      else {
        let f = !1;
        for (let g = 0; g < RegisterMenu.EmailWhitelist.length; g++)
          if (-1 !== c.indexOf(RegisterMenu.EmailWhitelist[g])) {
            f = !0;
            break;
          }
        f
          ? this.emailField.markValid()
          : ((b =
              "This email provider is not supported.\nPlease use Gmail or another major email provider."),
            (a = !1),
            this.emailField.markInvalid());
      }
    a && 4 > d.length
      ? ((b = "Username is too short."), (a = !1), this.nameField.markInvalid())
      : a && this.nameField.markValid();
    a && 8 > e.length
      ? (this.passwordField.setText(""),
        (b = "Password must be at least 8 characters long."),
        (a = !1),
        this.passwordField.markInvalid())
      : a && this.passwordField.markValid();
    a && this.passwordField.markValid();
    return { valid: a, error: b };
  }
  onSubmitButtonReleased() {
    const a = this.validateForm();
    a.valid
      ? (this.displayErrorMessage(""),
        this.emailDisabled
          ? this.submitForm("", this.nameField.getText(), this.passwordField.getText())
          : this.displayEmailVerification())
      : (this.nameField.markInvalid(), this.displayErrorMessage(a.error));
  }
  reset() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.container.interactiveChildren = !0;
    this.submitButton.enable();
    this.container.alpha = 1;
    this.hasVerifiedEmail = !1;
    this.verifyBox.setChecked(!1);
    this.verificationBoxWarning.tint = 16776960;
    this.emailField.markNone();
    this.nameField.markNone();
    this.passwordField.markNone();
  }
  show() {}
  resetRobotChallenge() {
    this.challengeTexture && PIXI.Texture.removeFromCache(this.challengeTexture);
    this.challengeTexture = PIXI.Texture.from(
      APIClient.ChallengeURL + "?cache_id=" + Math.random()
    );
    this.robotChallenge.texture = this.challengeTexture;
  }
  onCancelButtonReleased() {
    this.submitButton.enable();
    this.emit(Layer.Events.REGISTER_CANCEL);
  }
  onCompletedButtonReleased() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.emit(Layer.Events.REGISTER_CANCEL);
  }
  onCancelEmailVerificationButtonReleased() {
    this.emailField.text = "";
    this.emailVerificationField.text = "";
    this.emailField.visible = !0;
    this.hasVerifiedEmail = !1;
    this.verifyBox.setChecked(!1);
    this.emailVerificationContainer.parent && this.removeChild(this.emailVerificationContainer);
    this.reset();
  }
  onEmailVerificationButtonReleased() {
    this.hasVerifiedEmail = !1;
    if (this.verifyBox.checked) {
      this.emailField.visible = !0;
      var a = this.emailField.text.trim().toLowerCase(),
        b = this.emailVerificationField.text.trim().toLowerCase();
      this.emailVerificationField.text = "";
      a !== b
        ? ((this.emailField.text = ""),
          this.emailVerificationContainer.parent &&
            this.removeChild(this.emailVerificationContainer),
          this.reset(),
          this.displayErrorMessage("Email verification failed. Please try again."))
        : (this.emailVerificationContainer.parent &&
            this.removeChild(this.emailVerificationContainer),
          this.displayLoadingMessage(),
          this.submitForm(
            this.emailField.text.trim(),
            this.nameField.getText(),
            this.passwordField.getText()
          ));
    } else this.verificationBoxWarning.tint = 16711680;
  }
  submitForm(a, b, c) {
    this.emit(Layer.Events.REGISTER_SUBMIT, { email: a, name: b, password: c });
  }
  displayLoadingMessage() {
    this.container.interactiveChildren = !1;
    this.addChild(this.loadingContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
  }
  displayEmailVerification() {
    this.emailField.visible = !1;
    this.container.interactiveChildren = !1;
    this.addChild(this.emailVerificationContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
  }
  displayCompletedMessage(a = !0) {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.passwordField.setText("");
    this.container.interactiveChildren = !1;
    this.addChild(this.completedContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
    a
      ? ((this.completedButton.visible = !0),
        (this.completedText.text =
          "A verification email has been sent to\n " +
          this.emailField.text.trim() +
          "\n(Check your spam folder)\n\nImportant: Click the verification link in\nthis email to activate your account!"))
      : ((this.completedButton.visible = !1),
        (this.completedText.text =
          "Your Ninja.io account has been created.\n\nLogging in as " + this.nameField.getText()));
  }
  displayErrorMessage(a) {
    this.submitButton.enable();
    this.errorMessage.text = a;
    this.errorMessage.parent || this.container.addChild(this.errorMessage);
  }
}
RegisterMenu.EmailWhitelist =
  "@gmail.com @icloud.com @yahoo.com @hotmail.com @mail.ru @outlook.com @comcast.net @inbox.ru @yandex.ru @wp.pl @protonmail.com @aol.com @googlemail.com @volny.cz @sdale.org @pdsb.net".split(
    " "
  );
var upresetmenu = {};
class UPResetMenu extends Feature {
  constructor() {
    super();
    this.challengeTexture = null;
    this.preferredCheck = UPResetMenu.CHECK_NAME;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.container.addChild(this.background);
    this.ox = 40;
    this.oy = 20;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.onCancelButtonReleased());
    this.container.addChild(this.closeButton);
    this.accountRecoveryTitle = new PIXI.Text("Account recovery", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.accountRecoveryTitle.x = 0.5 * this.width - 0.5 * this.accountRecoveryTitle.width;
    this.accountRecoveryTitle.y = this.oy + 36;
    this.container.addChild(this.accountRecoveryTitle);
    this.emailTitle = new PIXI.Text("Email", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.emailTitle.x = this.ox;
    this.emailTitle.y = this.oy + 80;
    this.container.addChild(this.emailTitle);
    this.recoverTitle = new PIXI.Text("Recover", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.recoverTitle.x = this.ox;
    this.recoverTitle.y = this.oy + 145;
    this.container.addChild(this.recoverTitle);
    this.captchaTitle = new PIXI.Text("Captcha", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.captchaTitle.x = this.ox;
    this.captchaTitle.y = this.oy + 204;
    this.container.addChild(this.captchaTitle);
    this.errorMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16711680,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.errorMessage.x = this.ox;
    this.errorMessage.y = this.oy + 310;
    this.errorMessage.maxWidth = 380;
    this.container.x = 0.5 * -this.width;
    this.emailField = new PIXI.TextInput({
      input: {
        fontSize: "20px",
        padding: "12px",
        width: "380px",
        height: "12px",
        color: "#EEEEEE",
      },
      box: {
        default: { fill: 2236962, rounded: 4, stroke: { color: 6710886, width: 2 } },
        focused: { fill: 4473924, rounded: 4, stroke: { color: 10066329, width: 2 } },
        disabled: { fill: 2236962, rounded: 4, stroke: { color: 6710886, width: 2 } },
      },
    });
    this.emailField.maxLength = 64;
    this.emailField.x = this.ox;
    this.emailField.y = this.oy + 100;
    this.emailField.maxLength = 64;
    this.emailField.restrict = "A-Za-z0-9@.+_-";
    this.container.addChild(this.emailField);
    this.nameCheck = new Checkbox("name_check", "Username", !0);
    this.nameCheck.x = this.ox;
    this.nameCheck.y = this.oy + 168;
    this.nameCheck.setChecked(!0);
    this.container.addChild(this.nameCheck);
    this.passwordCheck = new Checkbox("password_check", "Password", !0);
    this.passwordCheck.x = this.ox + 150;
    this.passwordCheck.y = this.oy + 168;
    this.passwordCheck.setChecked(!1);
    this.passwordCheck.on(Checkbox.CHANGE, (a) => {
      a && (this.preferredCheck = UPResetMenu.CHECK_PASSWORD);
    });
    this.container.addChild(this.passwordCheck);
    this.nameCheck.on(Checkbox.CHANGE, (a) => {
      a && (this.passwordCheck.setChecked(!1), (this.preferredCheck = UPResetMenu.CHECK_NAME));
    });
    this.passwordCheck.on(Checkbox.CHANGE, (a) => {
      a && (this.nameCheck.setChecked(!1), (this.preferredCheck = UPResetMenu.CHECK_PASSWORD));
    });
    this.robotChallengeField = new InputField("register_name");
    this.robotChallengeField.setDimensions(100, 35);
    this.robotChallengeField.forceUpperCase = !0;
    this.robotChallengeField.setMaxChars(5);
    this.robotChallengeField.x = this.ox;
    this.robotChallengeField.y = this.oy + 228;
    this.robotChallengeField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-().[]"
    );
    this.container.addChild(this.robotChallengeField);
    this.robotChallengeContainer = new PIXI.Container();
    this.robotChallengeContainer.interactive = !0;
    this.robotChallengeContainer.interactiveChildren = !1;
    this.robotChallengeContainer.buttonMode = !0;
    this.robotChallengeContainer.x = this.ox + 142;
    this.robotChallengeContainer.y = this.oy + 245;
    this.container.addChild(this.robotChallengeContainer);
    (async () => {
      this.robotChallenge = new PIXI.Sprite();
      this.robotChallenge.anchor.x = this.robotChallenge.anchor.y = 0.5;
      this.robotChallenge.scale.x = this.robotChallenge.scale.y = 2;
      this.robotChallengeContainer.addChild(this.robotChallenge);
      this.robotChallenge.interactive = !1;
    })();
    this.robotChallengeContainer.hitArea = new PIXI.Rectangle(-40, -20, 80, 40);
    this.robotChallengeContainer.on("mousedown", () => this.resetRobotChallenge());
    this.robotChallengeContainer.on(
      "mouseover",
      () => (this.robotChallenge.scale.x = this.robotChallenge.scale.y = 2.5)
    );
    this.robotChallengeContainer.on(
      "mouseout",
      () => (this.robotChallenge.scale.x = this.robotChallenge.scale.y = 2)
    );
    this.submitButton = new Button("recover");
    this.submitButton.selected = !0;
    this.submitButton.setText("Recover");
    this.submitButton.scale.x = this.submitButton.scale.y = 0.8;
    this.submitButton.addListener(Button.BUTTON_RELEASED, this.onSubmitButtonReleased.bind(this));
    this.submitButton.x = this.ox + 11;
    this.submitButton.y = this.oy + 274;
    this.submitButton.setTint(16763904);
    this.container.addChild(this.submitButton);
    this.loadingContainer = new PIXI.Container();
    this.loadingBackground = new PIXI.Graphics();
    this.loadingBackground.x = 0;
    this.loadingBackground.y = 0;
    this.loadingBackground.lineStyle(3, 11184810, 0.5, 0);
    this.loadingBackground.beginFill(0, 0.8);
    this.loadingBackground.drawRoundedRect(0, 0, 300, 80, 10);
    this.loadingBackground.endFill();
    this.loadingContainer.addChild(this.loadingBackground);
    this.loadingText = new PIXI.Text("Processing request...", {
      fontName: "Arial",
      fontSize: 20,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.loadingText.x = 0.5 * this.loadingBackground.width;
    this.loadingText.y = 0.5 * this.loadingBackground.height;
    this.loadingText.anchor.x = this.loadingText.anchor.y = 0.5;
    this.loadingContainer.addChild(this.loadingText);
    this.loadingContainer.x = 0.5 * -this.loadingBackground.width;
    this.loadingContainer.y = 0.5 * this.container.height - 0.5 * this.loadingBackground.height;
    this.completedContainer = new PIXI.Container();
    this.completedBackground = new PIXI.Graphics();
    this.completedBackground.x = 0;
    this.completedBackground.y = 0;
    this.completedBackground.lineStyle(3, 11184810, 0.5, 0);
    this.completedBackground.beginFill(0, 0.8);
    this.completedBackground.drawRoundedRect(0, 0, 400, 130, 10);
    this.completedBackground.endFill();
    this.completedContainer.addChild(this.completedBackground);
    this.completedText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 20,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.completedText.x = 0.5 * this.completedBackground.width;
    this.completedText.y = 0.3 * this.completedBackground.height;
    this.completedText.anchor.x = this.completedText.anchor.y = 0.5;
    this.completedContainer.addChild(this.completedText);
    this.completedButton = new Button("continue");
    this.completedButton.selected = !0;
    this.completedButton.setText("Continue");
    this.completedButton.scale.x = this.completedButton.scale.y = 0.8;
    this.completedButton.addListener(
      Button.BUTTON_RELEASED,
      this.onCompletedButtonReleased.bind(this)
    );
    this.completedButton.x =
      0.5 * this.completedBackground.width - 0.5 * this.completedButton.width;
    this.completedButton.y = this.completedBackground.height - (this.completedButton.height + 16);
    this.completedContainer.addChild(this.completedButton);
    this.completedContainer.x = 0.5 * -this.completedBackground.width;
    this.completedContainer.y = 0.5 * this.container.height - 0.5 * this.completedBackground.height;
  }
  show() {
    this.resetRobotChallenge();
  }
  resetRobotChallenge() {
    this.robotChallengeField.setText("");
    this.challengeTexture && PIXI.Texture.removeFromCache(this.challengeTexture);
    this.challengeTexture = PIXI.Texture.from(
      APIClient.ChallengeURL + "?cache_id=" + Math.random()
    );
    this.robotChallenge.texture = this.challengeTexture;
  }
  validateForm() {
    let a = !0,
      b = "";
    const c = this.emailField.text.trim(),
      d = this.robotChallengeField.getText();
    a &&
    (3 > c.length ||
      !c.match(
        /^[\w-]+(\.[\w-]+)*@([a-z0-9-]+(\.[a-z0-9-]+)*?\.[a-z]{2,6}|(\d{1,3}\.){3}\d{1,3})(:\d{4})?$/g
      ))
      ? ((b = "Invalid email address."), (a = !1), this.emailField.markInvalid())
      : this.emailField.markValid();
    a && 5 > d.length
      ? (this.robotChallengeField.markInvalid(), (b = "Robot challenge incomplete."), (a = !1))
      : a && this.robotChallengeField.markNone();
    return { valid: a, error: b };
  }
  onSubmitButtonReleased() {
    const a = this.validateForm();
    a.valid
      ? (this.displayErrorMessage(""),
        this.displayLoadingMessage(),
        this.emit(Layer.Events.RECOVER_SUBMIT, {
          email: this.emailField.text.trim(),
          type: this.preferredCheck,
          challenge: this.robotChallengeField.getText(),
        }))
      : this.displayErrorMessage(a.error);
  }
  displayLoadingMessage() {
    this.container.interactiveChildren = !1;
    this.addChild(this.loadingContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
  }
  displayCompletedMessage() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.container.interactiveChildren = !1;
    this.addChild(this.completedContainer);
    this.submitButton.disable();
    this.container.alpha = 0.5;
    this.completedText.text = "A recovery email has been sent to\n " + this.emailField.text.trim();
  }
  onCompletedButtonReleased() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.container.interactiveChildren = !0;
    this.submitButton.enable();
    this.container.alpha = 1;
    this.emailField.markNone();
    this.emailField.text = "";
    this.robotChallengeField.setText("");
    this.emit(Layer.Events.RECOVER_CANCEL);
  }
  onCancelButtonReleased() {
    this.submitButton.enable();
    this.emit(Layer.Events.RECOVER_CANCEL);
  }
  displayErrorMessage(a) {
    this.submitButton.enable();
    this.errorMessage.text = a;
    this.errorMessage.parent || this.container.addChild(this.errorMessage);
  }
  reset() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.resetRobotChallenge();
    this.container.interactiveChildren = !0;
    this.submitButton.enable();
    this.container.alpha = 1;
    this.emailField.markNone();
  }
}
UPResetMenu.CHECK_NAME = "name";
UPResetMenu.CHECK_PASSWORD = "password";
var visualizer = {};
class Visualizer extends PIXI.Container {
  constructor(a, b, c = !0, d = !0, e = !0) {
    super();
    this.renderBackground = c;
    this.interactive = d;
    this.displayAura = e;
    this.customExtra = this.customFace = this.customAura = !1;
    this.w = a;
    this.h = b;
    this.s = 0.004 * this.w;
    this.numParticles = 64;
    this.customization = {};
    this.customAuraFx = {};
    this.customFaceFx = {};
    this.customExtraFx = {};
    this.initialize();
    this.offsetY = this.offsetX = this.time = 0;
    this.head = new PIXI.Sprite();
    this.head.x = this.head.ox = -2;
    this.head.y = this.head.oy = 0.179 * -this.h;
    this.head.scale.x = this.head.scale.y = this.s;
    this.head.anchor.x = 0.5;
    this.head.anchor.y = 0.75;
    this.head.rotation = this.head.or = -0.15;
    this.face = new PIXI.Sprite();
    this.face.rotation = this.face.or = -0;
    this.torsoUpper = new PIXI.Sprite();
    this.torsoUpper.scale.x = this.torsoUpper.scale.y = 1.2 * this.s;
    this.torsoUpper.x = this.torsoUpper.ox = 0;
    this.torsoUpper.y = this.torsoUpper.oy = 0.105 * -this.h;
    this.torsoUpper.anchor.x = 0.5;
    this.torsoUpper.anchor.y = 0.4;
    this.torsoUpper.rotation = this.torsoUpper.or = -0.1;
    this.torsoLower = new PIXI.Sprite();
    this.torsoLower.x = this.torsoLower.ox = 2;
    this.torsoLower.y = this.torsoLower.oy = 0.03 * -this.h;
    this.torsoLower.scale.x = this.torsoLower.scale.y = 1 * this.s;
    this.torsoLower.anchor.x = 0.5;
    this.torsoLower.anchor.y = 0.4;
    this.torsoLower.rotation = this.torsoLower.or = -0.1;
    this.armLeftUpper = new PIXI.Sprite();
    this.armLeftUpper.x = this.armLeftUpper.ox = -12;
    this.armLeftUpper.y = this.armLeftUpper.oy = 0.14 * -this.h;
    this.armLeftUpper.scale.x = this.armLeftUpper.scale.y = 1 * this.s;
    this.armLeftUpper.anchor.x = 0.6;
    this.armLeftUpper.anchor.y = 0.23;
    this.armLeftUpper.rotation = this.armLeftUpper.or = -0.05;
    this.armLeftLower = new PIXI.Sprite();
    this.armLeftLower.x = this.armLeftLower.ox = -17;
    this.armLeftLower.y = this.armLeftLower.oy = 0.02 * this.h;
    this.armLeftLower.scale.x = this.armLeftLower.scale.y = 0.95 * this.s;
    this.armLeftLower.anchor.x = 0.6;
    this.armLeftLower.anchor.y = 0.23;
    this.armLeftLower.rotation = this.armLeftLower.or = 0.55 * Math.PI;
    this.armRightUpper = new PIXI.Sprite();
    this.armRightUpper.x = this.armRightUpper.ox = 15;
    this.armRightUpper.y = this.armRightUpper.oy = 0.17 * -this.h;
    this.armRightUpper.scale.x = this.armRightUpper.scale.y = 1 * this.s;
    this.armRightUpper.anchor.x = 0.55;
    this.armRightUpper.anchor.y = 0.23;
    this.armRightUpper.rotation = this.armRightUpper.or = -0.3;
    this.armRightLower = new PIXI.Sprite();
    this.armRightLower.x = this.armRightLower.ox = 22;
    this.armRightLower.y = this.armRightLower.oy = 0.02 * -this.h;
    this.armRightLower.scale.x = 0.95 * -this.s;
    this.armRightLower.scale.y = 0.95 * this.s;
    this.armRightLower.anchor.x = 0.66;
    this.armRightLower.anchor.y = 0.23;
    this.armRightLower.rotation = this.armRightLower.or = 0.26 * Math.PI;
    this.legLeftUpper = new PIXI.Sprite();
    this.legLeftUpper.x = this.legLeftUpper.ox = -1;
    this.legLeftUpper.y = this.legLeftUpper.oy = 0.085 * this.h;
    this.legLeftUpper.scale.x = this.legLeftUpper.scale.y = 1 * this.s;
    this.legLeftUpper.anchor.x = 0.55;
    this.legLeftUpper.anchor.y = 0.31;
    this.legLeftUpper.rotation = this.legLeftUpper.or = 0.23 * Math.PI;
    this.legLeftLower = new PIXI.Sprite();
    this.legLeftLower.x = this.legLeftLower.ox = 10;
    this.legLeftLower.y = this.legLeftLower.oy = 0.25 * this.h;
    this.legLeftLower.scale.x = this.legLeftLower.scale.y = 1 * this.s;
    this.legLeftLower.anchor.x = 0.58;
    this.legLeftLower.anchor.y = 0.36;
    this.legLeftLower.rotation = this.legLeftLower.or = 0.3 * -Math.PI;
    this.legRightUpper = new PIXI.Sprite();
    this.legRightUpper.x = this.legRightUpper.ox = 9;
    this.legRightUpper.y = this.legRightUpper.oy = 0.07 * this.h;
    this.legRightUpper.scale.x = this.legRightUpper.scale.y = 1 * this.s;
    this.legRightUpper.anchor.x = 0.55;
    this.legRightUpper.anchor.y = 0.3;
    this.legRightUpper.rotation = this.legRightUpper.or = 0.01 * Math.PI;
    this.legRightLower = new PIXI.Sprite();
    this.legRightLower.x = this.legRightLower.ox = -19;
    this.legRightLower.y = this.legRightLower.oy = 0.21 * this.h;
    this.legRightLower.scale.x = this.legRightLower.scale.y = 1 * this.s;
    this.legRightLower.anchor.x = 0.58;
    this.legRightLower.anchor.y = 0.36;
    this.legRightLower.rotation = this.legRightLower.or = 0.22 * -Math.PI;
    this.bandana = new PIXI.Sprite(App.CombinedTextures.bandana_team_alpha);
    this.bandana.x = this.bandana.ox = this.head.x + 13;
    this.bandana.y = this.bandana.oy = this.head.y - 16;
    this.bandana.rotation = this.bandana.or = 0.32 * Math.PI;
    this.bandana.scale.x = 0.9 * this.s;
    this.bandana.scale.y = 0.5 * this.s;
    this.bandana.anchor.x = 0;
    this.bandana.anchor.y = 0.5;
    this.bandana.tint = 12255232;
    this.extra = new PIXI.Container();
    this.ninja = new PIXI.Container();
    this.ninja.x = 0.5 * this.w;
    this.ninja.y = 0.5 * this.h;
    this.marker = new PIXI.Graphics();
    this.marker.alpha = 0;
    this.marker.lineStyle(4, 0, 0.5, 0);
    this.marker.drawRoundedRect(0, 0, this.w, this.h, 8);
    this.marker.endFill();
    this.addChild(this.marker);
    this.aura = new PIXI.Sprite();
    this.aura.x = 0;
    this.aura.y = 0;
    this.aura.scale.x = this.aura.scale.y = 1.4;
    this.aura.anchor.x = this.aura.anchor.y = 0.5;
    this.aura.visible = this.displayAura;
    this.aura.rotation = Math.PI;
    this.on("mouseover", () => {
      this.marker.alpha = 1;
      this.aura.visible = !this.customAura;
      this.drawBackground(!1);
    });
    this.on("mouseout", () => {
      this.marker.alpha = 0;
      this.aura.visible = !1;
      this.drawBackground(!0);
    });
    this.ninja.addChild(this.aura);
    this.ninja.addChild(this.bandana);
    this.ninja.addChild(this.legRightLower);
    this.ninja.addChild(this.legLeftUpper);
    this.ninja.addChild(this.legLeftLower);
    this.ninja.addChild(this.legRightUpper);
    this.ninja.addChild(this.armLeftUpper);
    this.ninja.addChild(this.armLeftLower);
    this.ninja.addChild(this.torsoLower);
    this.ninja.addChild(this.torsoUpper);
    this.ninja.addChild(this.armRightLower);
    this.ninja.addChild(this.armRightUpper);
    this.ninja.addChild(this.head);
    this.ninja.addChild(this.extra);
    this.head.addChild(this.face);
    this.bodyparts = [
      this.head,
      this.armLeftUpper,
      this.armLeftLower,
      this.torsoLower,
      this.torsoUpper,
      this.armRightUpper,
      this.armRightLower,
      this.legLeftUpper,
      this.legLeftLower,
      this.legRightUpper,
      this.legRightLower,
      this.bandana,
    ];
    this.addChild(this.ninja);
    this.topParticles = new PIXI.ParticleContainer(1024, { position: !0, rotation: !0, tint: !0 });
    this.addChild(this.topParticles);
  }
  generateCharacter() {
    this.extra.removeChildren();
    this.foregroundParticles.removeChildren();
    this.topParticles.removeChildren();
    this.customAuraFx = {};
    const a = App.CombinedTextures;
    var b = this.customization;
    this.aura.tint = void 0 === b.orb ? 16777215 : b.orb.data.energy;
    this.face.rotation = 0;
    this.face.vr = 0;
    let c = "head_alpha";
    if (b.hair) {
      var d = !1;
      b.face && b.face.cdata && !1 === b.face.cdata.hair && (d = !0);
      d ? (c += "_slick") : 0 < b.hair.texture.length && (c += "_" + b.hair.texture);
    }
    var e = "torsoupper";
    b.torso && 0 < b.torso.texture.length && (e += "_" + b.torso.texture);
    d = "energy_shell";
    this.customAura = !1;
    this.aura.visible = this.displayAura;
    b.orb &&
      (b.orb.cdata && b.orb.cdata.custom
        ? ((this.customAura = b.orb.cdata.custom),
          (this.aura.visible = !1),
          this.initializeCustomEnergyFx())
        : 0 < b.orb.texture.length && (d += "_" + b.orb.texture));
    var f = "torsolower";
    this.torsoLower.x = this.torsoLower.ox = 2;
    this.torsoLower.y = this.torsoLower.oy = 0.03 * -this.h;
    this.torsoLower.anchor.x = 0.5;
    this.torsoLower.anchor.y = 0.4;
    if (b.belt && 0 < b.belt.texture.length) {
      f += "_" + b.belt.texture;
      var g = b.belt.cdata;
      void 0 !== g &&
        (void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.torsoLower.anchor.x = g.ax), (this.torsoLower.anchor.y = g.ay)),
        void 0 !== g.ox &&
          void 0 !== g.ox &&
          ((this.torsoLower.x = g.ox), (this.torsoLower.y = g.oy)),
        void 0 !== g.s && (this.torsoLower.scale.x = this.torsoLower.scale.y = this.s * g.s));
    }
    var h = "armleftlower";
    this.armLeftLower.x = -17;
    this.armLeftLower.y = 0.02 * this.h;
    this.armLeftLower.anchor.x = 0.6;
    this.armLeftLower.anchor.y = 0.23;
    b.armleftlower &&
      0 < b.armleftlower.texture.length &&
      ((h += "_" + b.armleftlower.texture),
      (g = b.armleftlower.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armLeftLower.x = this.armLeftLower.ox = g.ox),
          (this.armLeftLower.y = this.armLeftLower.oy = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armLeftLower.anchor.x = g.ax), (this.armLeftLower.anchor.y = g.ay))));
    var k = "armleftupper";
    this.armLeftUpper.x = this.armLeftUpper.ox = -13;
    this.armLeftUpper.y = this.armLeftUpper.oy = 0.14 * -this.h;
    this.armLeftUpper.anchor.x = 0.55;
    this.armLeftUpper.anchor.y = 0.23;
    b.armleftupper &&
      0 < b.armleftupper.texture.length &&
      ((k += "_" + b.armleftupper.texture),
      (g = b.armleftupper.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armLeftUpper.x = this.armLeftUpper.ox = g.ox),
          (this.armLeftUpper.y = this.armLeftUpper.oy = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armLeftUpper.anchor.x = g.ax), (this.armLeftUpper.anchor.y = g.ay))));
    var m = "armrightupper";
    this.armRightUpper.x = this.armRightUpper.ox = 15;
    this.armRightUpper.y = this.armRightUpper.oy = 0.17 * -this.h;
    this.armRightUpper.anchor.x = 0.55;
    this.armRightUpper.anchor.y = 0.23;
    b.armrightupper &&
      0 < b.armrightupper.texture.length &&
      ((m += "_" + b.armrightupper.texture),
      (g = b.armrightupper.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armRightUpper.x = this.armRightUpper.ox = g.ox),
          (this.armRightUpper.y = this.armRightUpper.oy = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armRightUpper.anchor.x = g.ax), (this.armRightUpper.anchor.y = g.ay))));
    var l = "armrightlower";
    this.armRightLower.x = 22;
    this.armRightLower.y = 0.02 * -this.h;
    this.armRightLower.anchor.x = 0.66;
    this.armRightLower.anchor.y = 0.23;
    b.armrightlower &&
      0 < b.armrightlower.texture.length &&
      ((l += "_" + b.armrightlower.texture),
      (g = b.armrightlower.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armRightLower.x = this.armRightLower.ox = g.ox),
          (this.armRightLower.y = this.armRightLower.oy = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armRightLower.anchor.x = g.ax), (this.armRightLower.anchor.y = g.ay))));
    var p = "legleftlower";
    this.legLeftLower.x = this.legLeftLower.ox = 10;
    this.legLeftLower.y = this.legLeftLower.oy = 0.25 * this.h;
    this.legLeftLower.anchor.x = 0.58;
    this.legLeftLower.anchor.y = 0.36;
    b.legleftlower &&
      (0 < b.legleftlower.texture.length && (p += "_" + b.legleftlower.texture),
      (g = b.legleftlower.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.legLeftLower.x = this.legLeftLower.ox = g.ox),
          (this.legLeftLower.y = this.legLeftLower.oy = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.legLeftLower.anchor.x = g.ax), (this.legLeftLower.anchor.y = g.ay))));
    g = "legrightlower";
    this.legRightLower.x = this.legRightLower.ox = -19;
    this.legRightLower.y = this.legRightLower.oy = 0.21 * this.h;
    this.legRightLower.anchor.x = 0.58;
    this.legRightLower.anchor.y = 0.36;
    if (b.legrightlower) {
      0 < b.legrightlower.texture.length && (g += "_" + b.legrightlower.texture);
      var n = b.legrightlower.cdata;
      void 0 !== n &&
        (void 0 !== n.ox &&
          void 0 !== n.oy &&
          ((this.legRightLower.x = this.legRightLower.ox = n.ox),
          (this.legRightLower.y = this.legRightLower.oy = n.oy)),
        void 0 !== n.ax &&
          void 0 !== n.ay &&
          ((this.legRightLower.anchor.x = n.ax), (this.legRightLower.anchor.y = n.ay)));
    }
    let r = "legleftupper";
    this.legLeftUpper.x = this.legLeftUpper.ox = -1;
    this.legLeftUpper.y = this.legLeftUpper.oy = 0.085 * this.h;
    this.legLeftUpper.anchor.x = 0.55;
    this.legLeftUpper.anchor.y = 0.31;
    b.legleftupper &&
      (0 < b.legleftupper.texture.length && (r += "_" + b.legleftupper.texture),
      (n = b.legleftupper.cdata),
      void 0 !== n &&
        (void 0 !== n.ox &&
          void 0 !== n.oy &&
          ((this.legLeftUpper.x = this.legLeftUpper.ox = n.ox),
          (this.legLeftUpper.y = this.legLeftUpper.oy = n.oy)),
        void 0 !== n.ax &&
          void 0 !== n.ay &&
          ((this.legLeftUpper.anchor.x = n.ax), (this.legLeftUpper.anchor.y = n.ay))));
    n = "legrightupper";
    this.legRightUpper.x = this.legRightUpper.ox = 9;
    this.legRightUpper.y = this.legRightUpper.oy = 0.07 * this.h;
    this.legRightUpper.anchor.x = 0.55;
    this.legRightUpper.anchor.y = 0.3;
    if (b.legrightupper) {
      0 < b.legrightupper.texture.length && (n += "_" + b.legrightupper.texture);
      var q = b.legrightupper.cdata;
      void 0 !== q &&
        (void 0 !== q.ox &&
          void 0 !== q.oy &&
          ((this.legRightUpper.x = this.legRightUpper.ox = q.ox),
          (this.legRightUpper.y = this.legRightUpper.oy = q.oy)),
        void 0 !== q.ax &&
          void 0 !== q.ay &&
          ((this.legRightUpper.anchor.x = q.ax), (this.legRightUpper.anchor.y = q.ay)));
    }
    this.customFace = !1;
    if (b.face)
      if (b.face.cdata && b.face.cdata.custom)
        (this.customFace = b.face.cdata.custom),
          this.initializeCustomFaceFx(),
          (this.face.visible = !1);
      else if (0 < b.face.texture.length) {
        if (
          ((this.face.texture = a["face_" + b.face.texture]),
          (this.face.visible = !0),
          (q = b.face.cdata))
        )
          void 0 !== q.ax && void 0 !== q.ay
            ? ((this.face.anchor.x = q.ax), (this.face.anchor.y = q.ay))
            : ((this.face.anchor.x = 0), (this.face.anchor.y = 0)),
            void 0 !== q.ox && void 0 !== q.ox
              ? ((this.face.x = q.ox), (this.face.y = q.oy))
              : ((this.face.x = 0), (this.face.y = 0)),
            q.vr && (this.face.vr = 0),
            void 0 !== q.s && (this.face.scale.x = this.face.scale.y = 0.78 * q.s);
      } else this.face.visible = !1;
    else this.face.visible = !1;
    this.customExtra = !1;
    b.extra &&
      b.extra.cdata &&
      b.extra.cdata.custom &&
      ((this.customExtra = b.extra.cdata.custom), this.initializeCustomExtraFx());
    b = a[e];
    f = a[f];
    e = a[k];
    h = a[h];
    m = a[m];
    l = a[l];
    k = a[r];
    p = a[p];
    n = a[n];
    g = a[g];
    d = a[d];
    this.head.texture = a[c];
    this.torsoUpper.texture = b;
    this.torsoLower.texture = f;
    this.armLeftUpper.texture = e;
    this.armLeftLower.texture = h;
    this.armRightUpper.texture = m;
    this.armRightLower.texture = l;
    this.legLeftUpper.texture = k;
    this.legLeftLower.texture = p;
    this.legRightUpper.texture = n;
    this.legRightLower.texture = g;
    this.aura.texture = d;
  }
  initialize() {
    if (this.renderBackground) {
      this.maskGraphic = new PIXI.Graphics();
      this.maskGraphic.beginFill(16777215, 1);
      this.maskGraphic.drawRoundedRect(0, 0, this.w, this.h, 8);
      this.maskGraphic.endFill();
      this.addChild(this.maskGraphic);
      this.gradientTexture = this.generateGradientTexture();
      this.background = new PIXI.Graphics();
      this.drawBackground();
      this.addChild(this.background);
      this.backgroundParticles = new PIXI.Container();
      this.backgroundParticles.mask = this.maskGraphic;
      for (let a = 0; a < this.numParticles; a++) {
        const b = new PIXI.Sprite(App.CombinedTextures.streak);
        b.delta = 20 * Math.random();
        b.theta = Math.random() * Math.PI * 2;
        b.x = 0.5 * this.w + b.delta * Math.cos(b.theta) * Math.random() * this.w * 0.5;
        b.y = 0.5 * this.h + b.delta * Math.sin(b.theta) * Math.random() * this.h * 0.5;
        b.scale.x = 0.1;
        b.scale.y = 0.2;
        b.alpha = 0;
        b.anchor.x = 0;
        b.anchor.y = 0.5;
        b.rotation = Math.atan2(b.theta + Math.PI);
        b.tint = 0;
        this.backgroundParticles.addChild(b);
      }
      this.addChild(this.backgroundParticles);
    }
    this.foregroundParticles = new PIXI.ParticleContainer(1024, {
      position: !0,
      rotation: !0,
      tint: !0,
    });
    this.addChild(this.foregroundParticles);
  }
  drawBackground(a = !0) {
    this.background.clear();
    this.background.lineStyle(3, 0, 0.2, 0);
    this.background.beginTextureFill({ texture: this.gradientTexture });
    this.background.drawRoundedRect(0, 0, this.w, this.h, 8);
    this.background.endFill();
    a &&
      (this.background.lineStyle(0, 0, 0),
      this.background.beginFill(16777215, 0.1),
      this.background.drawCircle(0.5 * this.w, 0.5 * this.h, 0.4 * this.w),
      this.background.endFill());
  }
  applyCustomization(a) {
    this.customization = {};
    a && (this.customization = a);
    this.generateCharacter();
    this.update();
  }
  generateGradientTexture() {
    const a = document.createElement("canvas");
    a.width = this.w;
    a.height = this.h;
    const b = a.getContext("2d");
    let c = b.createLinearGradient(0, 0, 0, this.h);
    c.addColorStop(0, "#729fcf");
    c.addColorStop(1, "#204a87");
    b.fillStyle = c;
    b.fillRect(0, 0, this.w, this.h);
    return new PIXI.Texture.from(a);
  }
  hide() {
    this.ninja.visible = !1;
  }
  show() {
    this.ninja.visible = !0;
  }
  update() {
    var a = this.customization.face;
    a &&
      a.cdata &&
      ((a = a.cdata),
      a.fr && (this.face.rotation = -this.head.rotation),
      a.vr && ((this.face.vr += a.vr), (this.face.rotation += this.face.vr)));
    this.offsetX = 2 * Math.sin(0.01 * this.time);
    this.offsetY = 6 * Math.sin(0.04 * this.time);
    this.updateCustom();
    this.aura.alpha = 1;
    this.aura.rotation = 2 * Math.PI * Math.random();
    for (a = 0; a < this.bodyparts.length; a++) {
      var b = this.bodyparts[a];
      b.x = b.ox + this.offsetX;
      b.y = b.oy - this.offsetY;
      b.rotation =
        b.or +
        0.04 *
          Math.cos(0.04 * this.time + 0.1 * a) *
          (2 === a || 6 === a || 7 === a || 9 === a ? -1 : 1);
    }
    this.aura.x = this.offsetX;
    this.aura.y = -this.offsetY;
    if (this.renderBackground)
      for (a = this.backgroundParticles.children, b = 0; b < this.numParticles; b++) {
        const c = a[b];
        c.delta += 5;
        c.delta *= 0.5;
        c.theta += -0.08 + 0.16 * Math.random();
        c.x += c.delta * Math.cos(c.theta);
        c.y += c.delta * Math.sin(c.theta);
        c.scale.x = 0.01 + 0.05 * c.delta;
        c.rotation = c.theta + Math.PI;
        1 > c.alpha && (c.alpha += 0.02 * Math.random());
        if (c.x > this.w + 8 || -8 > c.x || c.y > this.h + 8 || -8 > c.y)
          (c.x = 0.5 * this.w), (c.y = 0.5 * this.h), (c.alpha = -0.05);
      }
    this.time += 1;
  }
  initializeCustomEnergyFx() {
    switch (this.customAura) {
      case EnergyJetFeet.ID:
        this.customAuraFx.particles = [];
        break;
      case EnergyJetFeet2.ID:
        this.customAuraFx.counter = 0;
        this.customAuraFx.particles1 = [];
        this.customAuraFx.particles2 = [];
        this.customAuraFx.update = () => {
          this.customAuraFx.counter++;
        };
        break;
      case EnergyVacuum.ID:
        this.customAuraFx.rotation = 0;
        this.customAuraFx.index = 0;
        this.customAuraFx.particles = [];
        this.customAuraFx.update = () => {
          this.customAuraFx.rotation -= 0.03;
          this.customAuraFx.index =
            8 === this.customAuraFx.index + 1 ? 0 : this.customAuraFx.index + 1;
        };
        break;
      case EnergyDragon.ID:
        (this.customAuraFx.rotation = 0),
          (this.customAuraFx.particles = []),
          (this.customAuraFx.update = () => {
            this.customAuraFx.rotation -= 0.1;
          });
    }
  }
  initializeCustomFaceFx() {
    this.customFaceFx = {};
    this.customFaceFx.update = () => {};
    switch (this.customFace) {
      case FaceRedFireEyes.ID:
        this.customFaceFx.tint = 16711680;
        this.customFaceFx.particles = [];
        break;
      case FaceFireEyes.ID:
        this.customFaceFx.tint = 16777215;
        this.customFaceFx.particles = [];
        break;
      case FacePinkFireEyes.ID:
        this.customFaceFx.tint = 16738740;
        this.customFaceFx.particles = [];
        break;
      case FaceGreenFireEyes.ID:
        this.customFaceFx.tint = 65280;
        this.customFaceFx.particles = [];
        break;
      case FaceBlueFireEyes.ID:
        this.customFaceFx.tint = 255;
        this.customFaceFx.particles = [];
        break;
      case FaceYellowFireEyes.ID:
        this.customFaceFx.tint = 16776960;
        this.customFaceFx.particles = [];
        break;
      case FaceOrangeFireEyes.ID:
        (this.customFaceFx.tint = 16753920), (this.customFaceFx.particles = []);
    }
  }
  initializeCustomExtraFx() {
    this.customExtraFx = {};
    switch (this.customExtra) {
      case RedCape.ID:
      case GreenCape.ID:
      case BlackCape.ID:
      case YellowCape.ID:
      case BlueCape.ID:
      case PinkCape.ID:
      case OrangeCape.ID:
      case CamoCape.ID:
      case CamoCapeJungle.ID:
      case CamoCapeWinter.ID:
      case CamoCapeDesert.ID:
        let b = [];
        for (var a = 0; 6 > a; a++) b.push(new PIXI.Point(0, 20 * a));
        a = new Player();
        a.torsoupper.p.vx = -1.5;
        let c = new Extra.Map[this.customExtra](App.CombinedTextures[this.customExtra], a);
        c.scale.x = c.scale.y = c.targetScale = 0.9;
        this.customExtraFx.player = a;
        this.customExtraFx.counter = 0;
        this.customExtraFx.cape = c;
        this.customExtraFx.particles = [];
        this.customExtraFx.points = b;
        this.customExtraFx.update = () => {};
        this.extra.addChild(c);
    }
  }
  updateCustom() {
    switch (this.customFace) {
      case FaceFireEyes.ID:
      case FaceRedFireEyes.ID:
      case FacePinkFireEyes.ID:
      case FaceGreenFireEyes.ID:
      case FaceBlueFireEyes.ID:
      case FaceYellowFireEyes.ID:
      case FaceOrangeFireEyes.ID:
        this.updateFireEyes();
    }
    switch (this.customAura) {
      case EnergyJetFeet.ID:
        this.updateJetFeet();
        break;
      case EnergyJetFeet2.ID:
        this.updateJetFeet2();
        break;
      case EnergyVacuum.ID:
        this.updateVacuum();
        break;
      case EnergyDragon.ID:
        this.updateDragon();
    }
    switch (this.customExtra) {
      case RedCape.ID:
      case GreenCape.ID:
      case BlackCape.ID:
      case YellowCape.ID:
      case BlueCape.ID:
      case PinkCape.ID:
      case OrangeCape.ID:
      case CamoCape.ID:
      case CamoCapeJungle.ID:
      case CamoCapeWinter.ID:
      case CamoCapeDesert.ID:
        this.updateCape();
    }
  }
  updateJetFeet() {
    var a = new PIXI.Sprite(App.CombinedTextures[ParticleEffects.EnergyJetFeet.tex]);
    let b = 0.5 > Math.random() ? this.legLeftLower : this.legRightLower;
    a.tint = this.aura.tint;
    a.anchor.x = a.anchor.y = 0.5;
    a.x = this.ninja.x + 35 + b.x + 10 * Math.cos(b.rotation - 0.5 * Math.PI);
    a.y = this.ninja.y + 35 + b.y + 10 * Math.sin(b.rotation - 0.5 * Math.PI);
    a.scale.x = a.scale.y = 1.5;
    a.rotation = Math.random() * Math.PI * 2;
    a.vx = 1 * Math.random();
    a.vy = 1 * Math.random();
    a.ttl = ParticleEffects.EnergyJetFeet.ttl;
    this.foregroundParticles.addChild(a);
    this.customAuraFx.particles.push(a);
    for (let c = 0, d = this.customAuraFx.particles.length; c < d; c++)
      (a = this.customAuraFx.particles[c]),
        (a.x += a.vx),
        (a.y += a.vy),
        (a.scale.x -= 0.03),
        (a.scale.y -= 0.03),
        0 === --a.ttl &&
          (this.foregroundParticles.removeChild(a),
          this.customAuraFx.particles.splice(c, 1),
          d--,
          c--);
  }
  updateJetFeet2() {
    let a, b;
    this.customAuraFx.update();
    if (0 === this.customAuraFx.counter % 2) {
      var c =
        this.ninja.x +
        35 +
        this.legLeftLower.x +
        25 * Math.cos(this.legLeftLower.rotation - 0.5 * Math.PI) +
        8;
      a =
        this.ninja.y +
        35 +
        this.legLeftLower.y +
        25 * Math.sin(this.legLeftLower.rotation - 0.5 * Math.PI) -
        3;
      b = this.legLeftLower.rotation;
    } else
      (c =
        this.ninja.x +
        35 +
        this.legRightLower.x +
        25 * Math.cos(this.legRightLower.rotation - 0.5 * Math.PI) -
        4),
        (a =
          this.ninja.y +
          35 +
          this.legRightLower.y +
          25 * Math.sin(this.legRightLower.rotation - 0.5 * Math.PI) +
          8),
        (b = this.legRightLower.rotation);
    let d = new PIXI.Sprite(App.CombinedTextures[ParticleEffects.EnergyJetFeet2.tex]);
    d.tint = this.aura.tint;
    d.anchor.x = d.anchor.y = 0.5;
    d.scale.x = d.scale.y = 2.5;
    d.rotation = b;
    d.vx = -8 * Math.cos(b - 0.5 * Math.PI);
    d.vy = -12 * Math.sin(b - 0.5 * Math.PI);
    d.x = c - d.vx;
    d.y = a - d.vy;
    d.alpha = 1.2;
    d.ttl = ParticleEffects.EnergyJetFeet2.ttl;
    this.foregroundParticles.addChild(d);
    this.customAuraFx.particles1.push(d);
    d = new PIXI.Sprite(App.CombinedTextures[ParticleEffects.EnergyJetGlow.tex]);
    d.anchor.x = d.anchor.y = 0.5;
    d.x = c;
    d.y = a;
    d.scale.x = d.scale.y = 1;
    d.rotation = Math.random() * Math.PI * 2;
    d.vx = 2 + (-1 + 2 * Math.random());
    d.vy = 3 + (-1.5 + 3 * Math.random());
    d.ttl = ParticleEffects.EnergyJetGlow.ttl;
    this.foregroundParticles.addChild(d);
    this.customAuraFx.particles2.push(d);
    for (let e = 0, f = this.customAuraFx.particles2.length; e < f; e++)
      (c = this.customAuraFx.particles2[e]),
        (c.x += c.vx),
        (c.y += c.vy),
        (c.scale.x -= 0.1),
        (c.scale.y -= 0.1),
        (c.alpha -= 0.05),
        0 === --c.ttl &&
          (this.foregroundParticles.removeChild(c),
          this.customAuraFx.particles2.splice(e, 1),
          f--,
          e--);
    for (let e = 0, f = this.customAuraFx.particles1.length; e < f; e++)
      (c = this.customAuraFx.particles1[e]),
        (c.x += c.vx),
        (c.y += c.vy),
        (c.scale.x -= 0.4),
        (c.scale.y -= 0.4),
        (c.alpha -= 0.2),
        0 === --c.ttl &&
          (this.foregroundParticles.removeChild(c),
          this.customAuraFx.particles1.splice(e, 1),
          f--,
          e--);
  }
  updateVacuum() {
    var a = App.CombinedTextures[ParticleEffects.EnergyVacuum.tex];
    this.customAuraFx.update();
    a = new PIXI.Sprite(a);
    a.tint = this.aura.tint;
    a.anchor.x = a.anchor.y = 0.5;
    a.alpha = 0.01;
    let b = (this.customAuraFx.index * Math.PI) / 4 + this.customAuraFx.rotation;
    a.x = this.ninja.x + 90 * Math.cos(b);
    a.y = this.ninja.y + 90 * Math.sin(b);
    a.scale.x = a.scale.y = 1.5;
    a.rotation = Math.random() * Math.PI * 2;
    a.vx = 0.02 * (0.5 * this.w - a.x);
    a.vy = 0.02 * (0.5 * this.h - a.y);
    a.ttl = ParticleEffects.EnergyVacuum.ttl;
    this.foregroundParticles.addChild(a);
    this.customAuraFx.particles.push(a);
    for (let c = 0, d = this.customAuraFx.particles.length; c < d; c++)
      (a = this.customAuraFx.particles[c]),
        (a.x += a.vx),
        (a.y += a.vy),
        (a.scale.x -= 0.05),
        (a.scale.y -= 0.05),
        (a.alpha += 0.033),
        0 === --a.ttl &&
          (this.foregroundParticles.removeChild(a),
          this.customAuraFx.particles.splice(c, 1),
          d--,
          c--);
  }
  updateDragon() {
    var a = App.CombinedTextures[ParticleEffects.EnergyDragonball.tex];
    this.customAuraFx.update();
    for (let b = 0; 3 > b; b++) {
      let c = new PIXI.Sprite(a);
      c.tint = this.aura.tint;
      c.anchor.x = c.anchor.y = 0.5;
      let d = this.customAuraFx.rotation + (b * Math.PI) / 1.5;
      c.x = this.ninja.x + 80 * Math.cos(d);
      c.y = this.ninja.y + 80 * Math.sin(d);
      c.scale.x = c.scale.y = 1.25;
      c.rotation = Math.random() * Math.PI * 2;
      c.ttl = 10;
      this.foregroundParticles.addChild(c);
      this.customAuraFx.particles.push(c);
    }
    for (let b = 0, c = this.customAuraFx.particles.length; b < c; b++)
      (a = this.customAuraFx.particles[b]),
        (a.scale.x -= 0.1),
        (a.scale.y -= 0.1),
        (a.alpha -= 0.1),
        0 === --a.ttl &&
          (this.foregroundParticles.removeChild(a),
          this.customAuraFx.particles.splice(b, 1),
          c--,
          b--);
  }
  updateFireEyes() {
    var a = App.CombinedTextures[ParticleEffects.FireEyes.tex];
    this.customFaceFx.update();
    let b = new PIXI.Sprite(a);
    b.tint = void 0 !== this.customFaceFx.tint ? this.customFaceFx.tint : 16777215;
    b.anchor.x = b.anchor.y = 0.5;
    b.alpha = 1.1;
    b.x = this.ninja.x + this.head.x - 17;
    b.y = this.ninja.y + this.head.y - 9;
    b.scale.x = b.scale.y = 0.5;
    b.rotation = Math.random() * Math.PI * 2;
    b.vx = 2 + 1 * Math.random();
    b.vy = -1.5 + 1 * Math.random();
    b.ttl = 20;
    this.topParticles.addChild(b);
    this.customFaceFx.particles.push(b);
    b = new PIXI.Sprite(a);
    b.tint = 16777215;
    b.anchor.x = b.anchor.y = 0.5;
    b.alpha = 1.1;
    b.x = this.ninja.x + this.head.x - 17;
    b.y = this.ninja.y + this.head.y - 9;
    b.scale.x = b.scale.y = 0.3;
    b.rotation = Math.random() * Math.PI * 2;
    b.vx = 1.5 + 0.75 * Math.random();
    b.vy = -1 + 0.75 * Math.random();
    b.ttl = 5;
    this.topParticles.addChild(b);
    this.customFaceFx.particles.push(b);
    for (let c = 0, d = this.customFaceFx.particles.length; c < d; c++)
      (a = this.customFaceFx.particles[c]),
        (a.x += a.vx),
        (a.y += a.vy),
        (a.scale.x -= 0.025),
        (a.scale.y -= 0.025),
        (a.alpha -= 0.05),
        0 === --a.ttl &&
          (this.topParticles.removeChild(a), this.customFaceFx.particles.splice(c, 1), d--, c--);
  }
  updateCape() {
    this.customExtraFx.counter += 0.8;
    this.customExtraFx.player.torsoupper.p.vy = 10 * Math.sin(0.1 * this.torsoUpper.y + 1.5);
    this.customExtraFx.cape.update();
    this.extra.x = this.torsoUpper.x + 15;
    this.extra.y = this.torsoUpper.y - 20;
  }
}
var accounttab = {};
class AccountTab extends Feature {
  constructor(a, b) {
    super();
    this.w = a;
    this.h = b;
    this.ox = 20;
    this.oy = 126;
    this.sections = 3;
    this.currentSection = 0;
    this.accountSettingsTitle = new PIXI.Text("Account settings", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.accountSettingsTitle.x = this.ox - 4;
    this.accountSettingsTitle.y = 100;
    this.accountSettingsTitle.tint = 16763904;
    this.addChild(this.accountSettingsTitle);
    this.tableContainerMask = new PIXI.Graphics();
    this.tableContainerMask.beginFill(16777215, 1);
    this.tableContainerMask.drawRect(0, 100, 638, 390);
    this.tableContainerMask.endFill();
    this.tableContainerMask.x = 11;
    this.container.addChild(this.tableContainerMask);
    this.container.mask = this.tableContainerMask;
    this.scrollLeftButton = new Button("scroll_right");
    this.scrollLeftButton.selected = !0;
    this.scrollLeftButton.setText("<< Previous setting");
    this.scrollLeftButton.setTint(16763989);
    this.scrollLeftButton.scale.x = this.scrollLeftButton.scale.y = 0.7;
    this.scrollLeftButton.disable();
    this.scrollLeftButton.addListener(Button.BUTTON_RELEASED, () => {
      for (let c = 0; c < this.container.children.length; c++)
        this.container.children[c] !== this.tableContainerMask &&
          (this.container.children[c].x += 318);
      0 < this.currentSection && this.currentSection--;
      0 === this.currentSection &&
        (this.scrollLeftButton.disable(), 2 < this.sections && this.scrollRightButton.enable());
    });
    this.scrollLeftButton.x = 23;
    this.scrollLeftButton.y = 128;
    this.addChild(this.scrollLeftButton);
    this.scrollRightButton = new Button("scroll_right");
    this.scrollRightButton.selected = !0;
    this.scrollRightButton.setText("Next setting >>");
    this.scrollRightButton.setTint(16763989);
    this.scrollRightButton.scale.x = this.scrollRightButton.scale.y = 0.7;
    this.scrollRightButton.addListener(Button.BUTTON_RELEASED, () => {
      for (let c = 0; c < this.container.children.length; c++)
        this.container.children[c] !== this.tableContainerMask &&
          (this.container.children[c].x -= 318);
      this.currentSection < this.sections - 2 && this.currentSection++;
      this.currentSection >= this.sections - 2 &&
        (this.scrollRightButton.disable(), 2 < this.sections && this.scrollLeftButton.enable());
    });
    this.scrollRightButton.x = 520;
    this.scrollRightButton.y = 128;
    this.addChild(this.scrollRightButton);
    this.passwordBackground = new PIXI.Graphics();
    this.passwordBackground.x = this.ox - 6;
    this.passwordBackground.y = this.oy + 32;
    this.passwordBackground.beginFill(6710886, 0.3);
    this.passwordBackground.drawRoundedRect(0, 0, 314, 336, 8);
    this.passwordBackground.endFill();
    this.container.addChild(this.passwordBackground);
    this.passwordResetTitle = new PIXI.BitmapText("Change password", {
      fontName: "Open Sans",
      fontSize: 26,
    });
    this.passwordResetTitle.x = this.ox;
    this.passwordResetTitle.y = this.oy + 40;
    this.passwordResetTitle.tint = 16746496;
    this.container.addChild(this.passwordResetTitle);
    this.oldPasswordTitle = new PIXI.BitmapText("Current password", {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.oldPasswordTitle.x = this.ox;
    this.oldPasswordTitle.y = this.oy + 78;
    this.oldPasswordTitle.tint = 16777215;
    this.container.addChild(this.oldPasswordTitle);
    this.newPasswordTitle = new PIXI.BitmapText("New password", {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.newPasswordTitle.x = this.ox;
    this.newPasswordTitle.y = this.oy + 143;
    this.newPasswordTitle.tint = 16777215;
    this.container.addChild(this.newPasswordTitle);
    this.repeatPasswordTitle = new PIXI.BitmapText("Repeat new password", {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.repeatPasswordTitle.x = this.ox;
    this.repeatPasswordTitle.y = this.oy + 208;
    this.repeatPasswordTitle.tint = 16777215;
    this.container.addChild(this.repeatPasswordTitle);
    this.savePasswordButton = new Button("save_password");
    this.savePasswordButton.selected = !0;
    this.savePasswordButton.setText("Change password");
    this.savePasswordButton.setTint(16763904);
    this.savePasswordButton.scale.x = this.savePasswordButton.scale.y = 0.8;
    this.savePasswordButton.addListener(
      Button.BUTTON_RELEASED,
      this.onSavePasswordButtonReleased.bind(this)
    );
    this.savePasswordButton.x = this.ox + 10;
    this.savePasswordButton.y = this.oy + 284;
    this.container.addChild(this.savePasswordButton);
    this.oldPasswordField = new InputField("old_password");
    this.oldPasswordField.setDimensions(300, 35);
    this.oldPasswordField.forceLowerCase = !1;
    this.oldPasswordField.setMaxChars(32);
    this.oldPasswordField.setPassword(!0);
    this.oldPasswordField.x = this.ox;
    this.oldPasswordField.y = this.oy + 100;
    this.oldPasswordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.oldPasswordField);
    this.newPasswordField = new InputField("new_password");
    this.newPasswordField.setDimensions(300, 35);
    this.newPasswordField.forceLowerCase = !1;
    this.newPasswordField.setMaxChars(32);
    this.newPasswordField.setPassword(!0);
    this.newPasswordField.x = this.ox;
    this.newPasswordField.y = this.oy + 165;
    this.newPasswordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.newPasswordField);
    this.repeatPasswordField = new InputField("repeat_password");
    this.repeatPasswordField.setDimensions(300, 35);
    this.repeatPasswordField.forceLowerCase = !1;
    this.repeatPasswordField.setMaxChars(32);
    this.repeatPasswordField.setPassword(!0);
    this.repeatPasswordField.x = this.ox;
    this.repeatPasswordField.y = this.oy + 230;
    this.repeatPasswordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.repeatPasswordField);
    this.errorMessage = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
      multiline: !0,
    });
    this.errorMessage.x = this.ox;
    this.errorMessage.y = this.oy + 320;
    this.errorMessage.tint = 16711680;
    this.errorMessage.maxWidth = 300;
    this.container.addChild(this.errorMessage);
    this.successMessage = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
      multiline: !0,
    });
    this.successMessage.x = this.ox;
    this.successMessage.y = this.oy + 320;
    this.successMessage.tint = 65280;
    this.successMessage.maxWidth = 300;
    this.container.addChild(this.successMessage);
    this.changeNameBackground = new PIXI.Graphics();
    this.changeNameBackground.x = this.ox + 312;
    this.changeNameBackground.y = this.oy + 32;
    this.changeNameBackground.beginFill(6710886, 0.3);
    this.changeNameBackground.drawRoundedRect(0, 0, 314, 336, 8);
    this.changeNameBackground.endFill();
    this.container.addChild(this.changeNameBackground);
    this.changeNameTitle = new PIXI.BitmapText("Change username", {
      fontName: "Open Sans",
      fontSize: 26,
    });
    this.changeNameTitle.x = this.ox + 318;
    this.changeNameTitle.y = this.oy + 40;
    this.changeNameTitle.tint = 16746496;
    this.container.addChild(this.changeNameTitle);
    this.newPasswordTitle = new PIXI.BitmapText("Username", {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.newPasswordTitle.x = this.ox + 318;
    this.newPasswordTitle.y = this.oy + 78;
    this.newPasswordTitle.tint = 16777215;
    this.container.addChild(this.newPasswordTitle);
    this.nameField = new InputField("username");
    this.nameField.setDimensions(300, 35);
    this.nameField.forceLowerCase = !1;
    this.nameField.setMaxChars(32);
    this.nameField.x = this.ox + 318;
    this.nameField.y = this.oy + 100;
    this.nameField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-().[]!"
    );
    this.nameField.setText(App.Credential.username);
    this.container.addChild(this.nameField);
    this.newPasswordTitle = new PIXI.BitmapText("Password", {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.newPasswordTitle.x = this.ox + 318;
    this.newPasswordTitle.y = this.oy + 143;
    this.newPasswordTitle.tint = 16777215;
    this.container.addChild(this.newPasswordTitle);
    this.verificationPasswordField = new InputField("password");
    this.verificationPasswordField.setDimensions(300, 35);
    this.verificationPasswordField.forceLowerCase = !1;
    this.verificationPasswordField.setMaxChars(32);
    this.verificationPasswordField.setPassword(!0);
    this.verificationPasswordField.x = this.ox + 318;
    this.verificationPasswordField.y = this.oy + 165;
    this.verificationPasswordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.verificationPasswordField);
    this.usernameInfo = new PIXI.BitmapText(
      "Costs 1.000 gold.\nCan be changed once every 30 days.\n",
      { fontName: "Open Sans", fontSize: 22 }
    );
    this.usernameInfo.x = this.ox + 318;
    this.usernameInfo.y = this.oy + 210;
    this.usernameInfo.tint = 13421772;
    this.container.addChild(this.usernameInfo);
    this.saveUsernameButton = new Button("save_username");
    this.saveUsernameButton.selected = !0;
    this.saveUsernameButton.setText("Change username");
    this.saveUsernameButton.setTint(16763904);
    this.saveUsernameButton.scale.x = this.saveUsernameButton.scale.y = 0.8;
    this.saveUsernameButton.addListener(
      Button.BUTTON_RELEASED,
      this.onSaveUsernameButtonReleased.bind(this)
    );
    this.saveUsernameButton.x = this.ox + 328;
    this.saveUsernameButton.y = this.oy + 284;
    this.container.addChild(this.saveUsernameButton);
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = this.saveUsernameButton.x + this.saveUsernameButton.width + 4;
    this.goldIcon.y = this.saveUsernameButton.y;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.5;
    this.container.addChild(this.goldIcon);
    this.goldInfo = new PIXI.BitmapText("-1.000", { fontName: "Open Sans", fontSize: 22 });
    this.goldInfo.x = this.goldIcon.x + this.goldIcon.width + 4;
    this.goldInfo.y = this.goldIcon.y + 5;
    this.goldInfo.tint = 16711680;
    this.container.addChild(this.goldInfo);
    this.changeUsernameErrorMessage = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
      multiline: !0,
    });
    this.changeUsernameErrorMessage.x = this.ox + 328;
    this.changeUsernameErrorMessage.y = this.oy + 320;
    this.changeUsernameErrorMessage.tint = 16711680;
    this.changeUsernameErrorMessage.maxWidth = 300;
    this.container.addChild(this.changeUsernameErrorMessage);
    this.changeUsernameSuccessMessage = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
      multiline: !0,
    });
    this.changeUsernameSuccessMessage.x = this.ox + 328;
    this.changeUsernameSuccessMessage.y = this.oy + 320;
    this.changeUsernameSuccessMessage.tint = 65280;
    this.changeUsernameSuccessMessage.maxWidth = 300;
    this.container.addChild(this.changeUsernameSuccessMessage);
    this.deactivationBackground = new PIXI.Graphics();
    this.deactivationBackground.x = this.ox + 630;
    this.deactivationBackground.y = this.oy + 32;
    this.deactivationBackground.beginFill(6710886, 0.3);
    this.deactivationBackground.drawRoundedRect(0, 0, 314, 336, 8);
    this.deactivationBackground.endFill();
    this.container.addChild(this.deactivationBackground);
    this.deactivationTitle = new PIXI.BitmapText("Deactivate account", {
      fontName: "Open Sans",
      fontSize: 26,
    });
    this.deactivationTitle.x = this.ox + 638;
    this.deactivationTitle.y = this.oy + 40;
    this.deactivationTitle.tint = 16746496;
    this.container.addChild(this.deactivationTitle);
    this.deactivationInfo = new PIXI.BitmapText(
      "Permanently deactivate this account.\n\nThe email address associated with\nthis account will become available for\nnew account registration.",
      { fontName: "Open Sans", fontSize: 22 }
    );
    this.deactivationInfo.x = this.ox + 636;
    this.deactivationInfo.y = this.oy + 78;
    this.deactivationInfo.tint = 13421772;
    this.container.addChild(this.deactivationInfo);
    this.passwordTitle = new PIXI.BitmapText("Password", { fontName: "Open Sans", fontSize: 22 });
    this.passwordTitle.x = this.ox + 636;
    this.passwordTitle.y = this.oy + 210;
    this.passwordTitle.tint = 16777215;
    this.container.addChild(this.passwordTitle);
    this.passwordField = new InputField("password");
    this.passwordField.setDimensions(300, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(32);
    this.passwordField.setPassword(!0);
    this.passwordField.x = this.ox + 636;
    this.passwordField.y = this.oy + 230;
    this.passwordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.passwordField);
    this.deactivateButton = new Button("deactivate_account");
    this.deactivateButton.selected = !0;
    this.deactivateButton.setText("Deactivate account");
    this.deactivateButton.scale.x = this.deactivateButton.scale.y = 0.8;
    this.deactivateButton.addListener(
      Button.BUTTON_RELEASED,
      this.onDeactivateButtonReleased.bind(this)
    );
    this.deactivateButton.x = this.ox + 646;
    this.deactivateButton.y = this.oy + 284;
    this.deactivateButton.setTint(16711680);
    this.container.addChild(this.deactivateButton);
    this.deactivationErrorMessage = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
      multiline: !0,
    });
    this.deactivationErrorMessage.x = this.ox + 648;
    this.deactivationErrorMessage.y = this.oy + 320;
    this.deactivationErrorMessage.tint = 16711680;
    this.deactivationErrorMessage.maxWidth = 300;
    this.container.addChild(this.deactivationErrorMessage);
  }
  validatePasswordForm() {
    let a = !0,
      b = "";
    const c = this.oldPasswordField.getText(),
      d = this.newPasswordField.getText(),
      e = this.repeatPasswordField.getText();
    8 > c.length
      ? ((a = !1),
        (b = "Password must be at least 8 characters long."),
        this.oldPasswordField.markInvalid())
      : this.oldPasswordField.markNone();
    a && 8 > d.length
      ? ((a = !1),
        (b = "Password must be at least 8 characters long."),
        this.newPasswordField.markInvalid())
      : this.newPasswordField.markNone();
    a && 8 > e.length
      ? ((a = !1),
        (b = "Password must be at least 8 characters long."),
        this.repeatPasswordField.markInvalid())
      : this.repeatPasswordField.markNone();
    a && d !== e
      ? ((a = !1),
        (b = "Passwords do not match."),
        this.newPasswordField.markInvalid(),
        this.repeatPasswordField.markInvalid())
      : (this.newPasswordField.markNone(), this.repeatPasswordField.markNone());
    a && this.displayErrorMessage("");
    this.successMessage.text = "";
    return { valid: a, error: b };
  }
  validateDeactivationForm() {
    let a = !0,
      b = "";
    8 > this.passwordField.getText().length
      ? ((a = !1), (b = "Invalid password."), this.passwordField.markInvalid())
      : this.passwordField.markNone();
    a && this.displayDeactivationErrorMessage("");
    return { valid: a, error: b };
  }
  validateNameChangeForm() {
    let a = !0,
      b = "";
    4 > this.nameField.getText().length
      ? ((b = "Username is too short."), (a = !1), this.nameField.markInvalid())
      : a && this.nameField.markValid();
    const c = this.verificationPasswordField.getText();
    a && 8 > c.length
      ? ((a = !1), (b = "Invalid password."), this.verificationPasswordField.markInvalid())
      : this.verificationPasswordField.markNone();
    a && this.displayUsernameErrorMessage("");
    return { valid: a, error: b };
  }
  async onSavePasswordButtonReleased() {
    this.savePasswordButton.disable();
    var a = this.validatePasswordForm();
    a.valid
      ? ((a = await APIClient.renewPassword(
          this.newPasswordField.getText(),
          this.oldPasswordField.getText(),
          App.Credential.id
        )),
        this.savePasswordButton.enable(),
        !1 === a.success
          ? this.displayErrorMessage(a.error)
          : (this.oldPasswordField.setText(""),
            this.newPasswordField.setText(""),
            this.repeatPasswordField.setText(""),
            (this.successMessage.text = "New password saved.")))
      : (this.displayErrorMessage(a.error), this.savePasswordButton.enable());
  }
  async onSaveUsernameButtonReleased() {
    this.saveUsernameButton.disable();
    var a = this.validateNameChangeForm();
    if (a.valid)
      if (
        ((a = await APIClient.postUsername(
          this.nameField.getText(),
          this.verificationPasswordField.getText(),
          App.Credential.id
        )),
        this.saveUsernameButton.enable(),
        !1 === a.success)
      )
        this.displayUsernameErrorMessage(a.error);
      else {
        a = this.nameField.getText().trim();
        var b = this.verificationPasswordField.getText();
        this.verificationPasswordField.setText("");
        this.changeUsernameSuccessMessage.text = "Username changed.";
        this.saveUsernameButton.disable();
        this.emit(Layer.Events.PROFILE_RENAME, { name: a, password: b });
      }
    else this.displayUsernameErrorMessage(a.error), this.saveUsernameButton.enable();
  }
  async onDeactivateButtonReleased() {
    this.deactivateButton.disable();
    var a = this.validateDeactivationForm();
    a.valid
      ? ((a = await APIClient.deactivateAccount(this.passwordField.getText(), App.Credential.id)),
        this.deactivateButton.enable(),
        !1 === a.success
          ? this.displayDeactivationErrorMessage(a.error)
          : (this.passwordField.setText(""),
            this.displayDeactivationErrorMessage("Account deactivated."),
            Registry.Instance.store(Registry.Key.CREDENTIAL, { available: !1 }),
            setTimeout(() => this.emit(Layer.Events.LOGOUT), 1e3)))
      : (this.displayDeactivationErrorMessage(a.error), this.deactivateButton.enable());
  }
  displayErrorMessage(a) {
    this.errorMessage.text = a;
  }
  displayUsernameErrorMessage(a) {
    this.changeUsernameErrorMessage.text = a;
  }
  displayDeactivationErrorMessage(a) {
    this.deactivationErrorMessage.text = a;
  }
  load() {
    this.nameField.setText(App.Credential.username);
  }
}
AccountTab.LOGOUT = "logout";
var incompleteaccounttab = {};
class IncompleteAccountTab extends Feature {
  constructor(a, b) {
    super();
    this.w = a;
    this.h = b;
    this.ox = 20;
    this.oy = 126;
    this.accountSettingsTitle = new PIXI.Text("Account settings", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.accountSettingsTitle.x = this.ox - 4;
    this.accountSettingsTitle.y = 100;
    this.accountSettingsTitle.tint = 16763904;
    this.addChild(this.accountSettingsTitle);
    this.autogenDescription = new PIXI.Text(
      "Your account does not have a password.\nAccount settings will be available after you set a password for this account.\n\nClick the 'Complete registration' button below to set a password and get full access to account settings.",
      {
        fontSize: 17,
        fontFamily: "Arial",
        fill: 15658734,
        lineJoin: "round",
        strokeThickness: 2,
        lineHeight: 24,
        align: "left",
        wordWrap: !0,
        wordWrapWidth: 600,
      }
    );
    this.autogenDescription.x = this.ox + 10;
    this.autogenDescription.y = 156;
    this.container.addChild(this.autogenDescription);
    this.renameButton = new Button("rename");
    this.renameButton.selected = !0;
    this.renameButton.setText("Complete registration");
    this.renameButton.scale.x = this.renameButton.scale.y = 0.9;
    this.renameButton.addListener(Button.BUTTON_RELEASED, () =>
      this.emit(Layer.Events.RENAME_ACCESS)
    );
    this.renameButton.x = this.ox + 14;
    this.renameButton.y = this.oy + 200;
    this.renameButton.setTint(16763904);
    this.container.addChild(this.renameButton);
  }
}
var levelbar = {};
class LevelBar extends PIXI.Container {
  constructor() {
    super();
    this.ox = 0;
    this.w = 300;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRoundedRect(0, 0, this.w, 16, 8);
    this.background.endFill();
    this.addChild(this.background);
    this.bar = new PIXI.Graphics();
    this.addChild(this.bar);
    this.previousText = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 24 });
    this.previousText.x = this.ox - 4;
    this.previousText.y = -4;
    this.previousText.tint = 16755200;
    this.previousText.anchor.x = 1;
    this.addChild(this.previousText);
    this.previousXpText = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 22 });
    this.previousXpText.x = this.ox + 24;
    this.previousXpText.y = 18;
    this.previousXpText.tint = 13421772;
    this.previousXpText.anchor.x = 1;
    this.addChild(this.previousXpText);
    this.currentText = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 22 });
    this.currentText.x = this.ox;
    this.currentText.y = 32;
    this.currentText.anchor.x = 0.5;
    this.currentText.tint = 16777215;
    this.addChild(this.currentText);
    this.nextText = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 24 });
    this.nextText.x = this.w + 4;
    this.nextText.y = -4;
    this.nextText.tint = 16755200;
    this.addChild(this.nextText);
    this.nextXpText = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 22 });
    this.nextXpText.x = this.w - 28;
    this.nextXpText.y = 16;
    this.nextXpText.tint = 13421772;
    this.nextXpText.anchor.x = 0;
    this.addChild(this.nextXpText);
  }
  load(a, b, c) {
    let d = LevelBar.XPToLevel(a),
      e = LevelBar.XPToLevel(c),
      f = Math.min((1 / (c - a)) * (this.w - this.ox - 16) * (b - a), this.w - 16);
    this.currentText.x = f;
    this.previousXpText.text = numberWithPeriods(Math.ceil(a));
    this.nextXpText.text = numberWithPeriods(Math.ceil(c));
    this.currentText.text = numberWithPeriods(Math.ceil(b));
    this.previousText.text = numberWithPeriods(d);
    this.nextText.text = numberWithPeriods(e);
    this.bar.clear();
    this.bar.beginFill(16777215, 0.3);
    this.bar.drawRect(8, 5, f, 6);
    this.bar.endFill();
    this.bar.lineStyle(1, 16777215, 1);
    this.bar.moveTo(f + 8, -1);
    this.bar.lineTo(f + 8, 20);
  }
}
LevelBar.XPToLevel = (a) => Math.min(Math.max(Math.floor(0.2 * Math.sqrt(a / 15.625)), 1), 160);
var usermenu = {};
class UserMenu extends Feature {
  constructor() {
    super();
    this.id = null;
    this.ox = 20;
    this.oy = 50;
    this.playerName = "";
    this.clanId = -1;
    this.weapons = [];
    this.weaponData = [];
    this.twitchUrl = this.youtubeUrl = "";
    this.display = UserMenu.GENERAL;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.beginFill(6710886, 0.3);
    this.background.drawRoundedRect(20, 22, 620, 270, 8);
    this.background.endFill();
    this.background.beginFill(6710886, 0.3);
    this.background.drawRoundedRect(30, 242, 182, 40, 8);
    this.background.drawRoundedRect(20, 304, 620, 120, 8);
    this.background.endFill();
    this.container.addChild(this.background);
    this.background.interactive = !0;
    this.w = this.width;
    this.h = this.height;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 48;
    this.closeButton.y = this.oy + 14;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.onCloseButtonReleased());
    this.container.addChild(this.closeButton);
    this.generalStatsButton = new PIXI.Graphics();
    this.generalStatsButton.lineStyle(1, 16777215, 0.1, 0);
    this.generalStatsButton.beginFill(16777215, 0.2);
    this.generalStatsButton.drawRect(0, 0, 100, 28, 4);
    this.generalStatsButton.endFill();
    this.generalStatsButton.x = this.ox + 202;
    this.generalStatsButton.y = this.oy + 24;
    this.generalStatsButton.tint = 13421772;
    this.generalStatsButton.interactive = !0;
    this.generalStatsButton.on("mouseover", () => {
      this.generalStatsLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.generalStatsButton.on("mouseout", () => {
      this.generalStatsLabel.alpha = this.display === UserMenu.GENERAL ? 1 : 0.5;
    });
    this.generalStatsButton.on("mousedown", () => {
      this.displayGeneralContainer();
      AudioEffects.ButtonClick.audio.play();
    });
    this.container.addChild(this.generalStatsButton);
    this.generalStatsLabel = new PIXI.Text("General", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.generalStatsLabel.x =
      this.generalStatsButton.x +
      0.5 * (this.generalStatsButton.width - this.generalStatsLabel.width);
    this.generalStatsLabel.y = this.generalStatsButton.y + 2;
    this.container.addChild(this.generalStatsLabel);
    this.weaponStatsButton = new PIXI.Graphics();
    this.weaponStatsButton.lineStyle(1, 16777215, 0.1, 0);
    this.weaponStatsButton.beginFill(16777215, 0.2);
    this.weaponStatsButton.drawRect(0, 0, 100, 28, 4);
    this.weaponStatsButton.endFill();
    this.weaponStatsButton.x = this.generalStatsButton.x + this.generalStatsButton.width + 8;
    this.weaponStatsButton.y = this.oy + 24;
    this.weaponStatsButton.tint = 13421772;
    this.weaponStatsButton.alpha = 0.5;
    this.weaponStatsButton.interactive = !0;
    this.weaponStatsButton.on("mouseover", () => {
      this.weaponStatsLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.weaponStatsButton.on("mouseout", () => {
      this.weaponStatsLabel.alpha = this.display === UserMenu.WEAPONS ? 1 : 0.5;
    });
    this.weaponStatsButton.on("mousedown", () => {
      this.displayWeaponContainer();
      AudioEffects.ButtonClick.audio.play();
    });
    this.container.addChild(this.weaponStatsButton);
    this.weaponStatsLabel = new PIXI.Text("Weapons", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.weaponStatsLabel.alpha = 0.5;
    this.weaponStatsLabel.x =
      this.weaponStatsButton.x + 0.5 * (this.weaponStatsButton.width - this.weaponStatsLabel.width);
    this.weaponStatsLabel.y = this.weaponStatsButton.y + 2;
    this.container.addChild(this.weaponStatsLabel);
    this.contactButton = new PIXI.Graphics();
    this.contactButton.lineStyle(1, 16777215, 0.1, 0);
    this.contactButton.beginFill(16777215, 0.2);
    this.contactButton.drawRect(0, 0, 100, 28, 4);
    this.contactButton.endFill();
    this.contactButton.x = this.weaponStatsButton.x + this.weaponStatsButton.width + 8;
    this.contactButton.y = this.oy + 24;
    this.contactButton.tint = 13421772;
    this.contactButton.alpha = 0.5;
    this.contactButton.interactive = !0;
    this.contactButton.on("mouseover", () => {
      this.contactLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.contactButton.on("mouseout", () => {
      this.contactLabel.alpha = this.display === UserMenu.CONTACT ? 1 : 0.5;
    });
    this.contactButton.on("mousedown", () => {
      this.displayContactContainer();
      AudioEffects.ButtonClick.audio.play();
    });
    this.container.addChild(this.contactButton);
    this.contactLabel = new PIXI.Text("Contact", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.contactLabel.alpha = 1;
    this.contactLabel.x =
      this.contactButton.x + 0.5 * (this.contactButton.width - this.contactLabel.width);
    this.contactLabel.y = this.contactButton.y + 2;
    this.container.addChild(this.contactLabel);
    this.creationLabel = new PIXI.Text("Created", {
      fontName: "Arial",
      fontSize: 15,
      fill: 8947848,
      strokeThickness: 2,
    });
    this.creationLabel.x = this.ox;
    this.creationLabel.y = this.h - 20;
    this.container.addChild(this.creationLabel);
    this.createdText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 15,
      fill: 11184810,
      strokeThickness: 2,
    });
    this.createdText.x = this.ox + 62;
    this.createdText.y = this.h - 20;
    this.container.addChild(this.createdText);
    this.activityLabel = new PIXI.Text("Last seen", {
      fontName: "Arial",
      fontSize: 15,
      fill: 8947848,
      strokeThickness: 2,
    });
    this.activityLabel.x = this.ox;
    this.activityLabel.y = this.h;
    this.container.addChild(this.activityLabel);
    this.activityText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 15,
      fill: 11184810,
      strokeThickness: 2,
    });
    this.activityText.x = this.ox + 72;
    this.activityText.y = this.h;
    this.activityText.tint = 16777215;
    this.container.addChild(this.activityText);
    this.visualizer = new Visualizer(176, 176, !0, !0, !1);
    this.visualizer.x = this.ox + 12;
    this.visualizer.y = this.oy + 54;
    this.visualizer.interactive = !0;
    this.container.addChild(this.visualizer);
    this.overviewTitle = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16763904,
      strokeThickness: 4,
      lineJoin: "round",
    });
    this.overviewTitle.x = this.visualizer.x + 0.5 * this.visualizer.width;
    this.overviewTitle.y = this.oy + 23;
    this.overviewTitle.anchor.x = 0.5;
    this.container.addChild(this.overviewTitle);
    this.clanLabelText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.clanLabelText.x = this.visualizer.x + 0.5 * this.visualizer.width;
    this.clanLabelText.y = this.oy + 232;
    this.clanLabelText.anchor.x = 0.5;
    this.clanLabelText.interactive = !0;
    this.clanLabelText.hitArea = new PIXI.Rectangle(
      0.5 * -this.clanLabelText.width,
      0.25 * -this.clanLabelText.height,
      this.clanLabelText.width,
      40
    );
    this.clanLabelText.on("mouseover", () => {
      this.clanLabelText.tint = 16776960;
      this.clanText.tint = 16711680;
    });
    this.clanLabelText.on("mouseout", () => {
      this.clanLabelText.tint = 16777215;
      this.clanText.tint = 16763904;
    });
    this.clanLabelText.on("mousedown", () => {
      -1 !== this.clanId && this.emit(Layer.Events.CLAN_ACCESS, this.clanId);
    });
    this.container.addChild(this.clanLabelText);
    this.clanText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.clanText.x = this.visualizer.x + 0.5 * this.visualizer.width;
    this.clanText.y = this.oy + 251;
    this.clanText.anchor.x = 0.5;
    this.container.addChild(this.clanText);
    this.generalContainer = new PIXI.Container();
    this.levelLabel = new PIXI.Text("Level", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelLabel.x = this.ox + 210;
    this.levelLabel.y = this.oy + 60;
    this.generalContainer.addChild(this.levelLabel);
    this.levelText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelText.x = this.ox + 233;
    this.levelText.y = this.oy + 86;
    this.generalContainer.addChild(this.levelText);
    this.rankLabel = new PIXI.Text("Level rank", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.rankLabel.x = this.ox + 210;
    this.rankLabel.y = this.oy + 114;
    this.generalContainer.addChild(this.rankLabel);
    this.rankText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.rankText.x = this.ox + 210;
    this.rankText.y = this.oy + 138;
    this.generalContainer.addChild(this.rankText);
    this.skillLabel = new PIXI.Text("Skill rank", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 20,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillLabel.x = this.ox + 210;
    this.skillLabel.y = this.oy + 168;
    this.generalContainer.addChild(this.skillLabel);
    this.skillText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillText.x = this.ox + 210;
    this.skillText.y = this.oy + 192;
    this.generalContainer.addChild(this.skillText);
    this.killsLabel = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsLabel.x = this.ox + 360;
    this.killsLabel.y = this.oy + 60;
    this.generalContainer.addChild(this.killsLabel);
    this.killsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsText.x = this.ox + 360;
    this.killsText.y = this.oy + 84;
    this.generalContainer.addChild(this.killsText);
    this.deathsLabel = new PIXI.Text("Deaths", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.deathsLabel.x = this.ox + 360;
    this.deathsLabel.y = this.oy + 114;
    this.generalContainer.addChild(this.deathsLabel);
    this.deathsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.deathsText.x = this.ox + 360;
    this.deathsText.y = this.oy + 138;
    this.generalContainer.addChild(this.deathsText);
    this.capsLabel = new PIXI.Text("CTF caps", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.capsLabel.x = this.ox + 360;
    this.capsLabel.y = this.oy + 168;
    this.generalContainer.addChild(this.capsLabel);
    this.capsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.capsText.x = this.ox + 360;
    this.capsText.y = this.oy + 192;
    this.capsText.tint = 16777215;
    this.generalContainer.addChild(this.capsText);
    this.levelIcon = new PIXI.Sprite();
    this.levelIcon.x = this.ox + 200;
    this.levelIcon.y = this.oy + 76;
    this.levelIcon.scale.x = this.levelIcon.scale.y = 0.5;
    this.generalContainer.addChild(this.levelIcon);
    this.socialTitle = new PIXI.Text("Streaming & video channels", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.socialTitle.x = this.ox + 12;
    this.socialTitle.y = this.oy + 300;
    this.socialTitle.tint = 16777215;
    this.container.addChild(this.socialTitle);
    this.youtubeButton = new PIXI.Graphics();
    this.youtubeButton.lineStyle(1, 16777215, 0.1, 0);
    this.youtubeButton.drawRoundedRect(0, 0, 240, 34, 4);
    this.youtubeButton.x = this.ox + 12;
    this.youtubeButton.y = this.oy + 328;
    this.youtubeButton.tint = 13421772;
    this.youtubeButton.interactive = !0;
    this.youtubeButton.on("mouseover", () => {
      this.youtubeTitle.tint = 16777215;
      this.youtubeLogo.tint = 16777215;
    });
    this.youtubeButton.on("mouseout", () => {
      this.youtubeTitle.tint = 13421772;
      this.youtubeLogo.tint = 13421772;
    });
    this.youtubeButton.on("mousedown", () => {
      20 < this.youtubeUrl.length && window.open(this.youtubeUrl, "_blank");
    });
    this.youtubeButton.hitArea = new PIXI.Rectangle(0, 0, 240, 34);
    this.container.addChild(this.youtubeButton);
    this.youtubeLogo = new PIXI.Sprite(App.CombinedTextures.youtube_logo);
    this.youtubeLogo.scale.x = this.youtubeLogo.scale.y = 0.5;
    this.youtubeLogo.x = this.ox + 18;
    this.youtubeLogo.y = this.oy + 333;
    this.youtubeLogo.tint = 13421772;
    this.container.addChild(this.youtubeLogo);
    this.youtubeTitle = new PIXI.Text("YouTube", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.youtubeTitle.x = this.ox + 58;
    this.youtubeTitle.y = this.oy + 334;
    this.youtubeTitle.tint = 13421772;
    this.container.addChild(this.youtubeTitle);
    this.twitchButton = new PIXI.Graphics();
    this.twitchButton.lineStyle(1, 16777215, 0.1, 0);
    this.twitchButton.drawRoundedRect(0, 0, 240, 34, 4);
    this.twitchButton.x = this.ox + 12;
    this.twitchButton.y = this.oy + 368;
    this.twitchButton.tint = 13421772;
    this.twitchButton.interactive = !0;
    this.twitchButton.on("mouseover", () => {
      this.twitchTitle.tint = 16777215;
      this.twitchLogo.tint = 16777215;
    });
    this.twitchButton.on("mouseout", () => {
      this.twitchTitle.tint = 13421772;
      this.twitchLogo.tint = 13421772;
    });
    this.twitchButton.on("mousedown", () => {
      20 < this.twitchUrl.length && window.open(this.twitchUrl, "_blank");
    });
    this.twitchButton.hitArea = new PIXI.Rectangle(0, 0, 240, 34);
    this.container.addChild(this.twitchButton);
    this.twitchLogo = new PIXI.Sprite(App.CombinedTextures.twitch_logo);
    this.twitchLogo.scale.x = this.twitchLogo.scale.y = 0.75;
    this.twitchLogo.x = this.ox + 16;
    this.twitchLogo.y = this.oy + 370;
    this.twitchLogo.tint = 13421772;
    this.container.addChild(this.twitchLogo);
    this.twitchTitle = new PIXI.Text("Twitch", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.twitchTitle.x = this.ox + 59;
    this.twitchTitle.y = this.oy + 374;
    this.twitchTitle.tint = 13421772;
    this.container.addChild(this.twitchTitle);
    this.weaponContainer = new PIXI.Container();
    this.weaponTitle = new PIXI.Text("Favorite weapons", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponTitle.x = this.ox + 210;
    this.weaponTitle.y = this.oy + 60;
    this.weaponContainer.addChild(this.weaponTitle);
    this.weaponNameLabel = new PIXI.Text("Type", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponNameLabel.x = this.ox + 210;
    this.weaponNameLabel.y = this.oy + 82;
    this.weaponContainer.addChild(this.weaponNameLabel);
    this.weaponKillsLabel = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponKillsLabel.x = this.ox + 480;
    this.weaponKillsLabel.y = this.oy + 82;
    this.weaponContainer.addChild(this.weaponKillsLabel);
    this.listContainer = new PIXI.Container();
    this.listContainer.x = this.ox + 204;
    this.listContainer.y = this.oy + 60;
    this.weaponListContainer = new PIXI.Container();
    this.listContainer.addChild(this.weaponListContainer);
    this.weaponContainer.addChild(this.listContainer);
    this.scrollbar = new WeaponListScrollbar(172);
    this.scrollbar.x = this.ox + 598;
    this.scrollbar.y = this.oy + 102;
    this.scrollbar.on(WeaponListScrollbar.SCROLL, (a) => {
      this.maskWeaponList(a);
    });
    this.contactContainer = new PIXI.Container();
    this.friendInvitationText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16776960,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.friendInvitationButton = new Button("connect");
    this.friendInvitationButton.selected = !0;
    this.friendInvitationButton.setText("Send friend invitation");
    this.friendInvitationButton.scale.x = this.friendInvitationButton.scale.y = 0.8;
    this.friendInvitationButton.addListener(Button.BUTTON_RELEASED, async () => {
      this.friendInvitationButton.disable();
      let a = await APIClient.postInviteFriend(this.playerName, App.Credential.id);
      this.friendInvitationText.text = a.success
        ? "Friend invitation sent to " + this.playerName
        : a.error;
    });
    this.friendInvitationButton.x = this.ox + 210;
    this.friendInvitationButton.y = this.oy + 70;
    this.friendInvitationButton.setTint(16763904);
    this.contactContainer.addChild(this.friendInvitationButton);
    this.friendInvitationText.x = this.friendInvitationButton.x - 5;
    this.friendInvitationText.y = this.friendInvitationButton.y + 40;
    this.contactContainer.addChild(this.friendInvitationText);
    this.displayGeneralContainer();
  }
  async load(a, b = "id") {
    this.clanId = this.id = -1;
    this.youtubeButton.interactive = !1;
    this.youtubeLogo.alpha = 0.4;
    this.youtubeTitle.alpha = 0.4;
    this.youtubeUrl = "";
    this.youtubeTitle.text = "YouTube";
    this.twitchButton.interactive = !1;
    this.twitchLogo.alpha = 0.4;
    this.twitchTitle.alpha = 0.4;
    this.twitchUrl = "";
    this.twitchTitle.text = "Twitch";
    this.friendInvitationButton.disable();
    this.friendInvitationText.text =
      "guest" === App.Credential.accounttype
        ? "Register or login to invite friends.\nFriends can invite you to join their clan."
        : "Friends can invite you to join their clan.";
    this.visualizer.hide();
    this.overviewTitle.text = "Loading..";
    this.levelText.text = "Loading..";
    this.rankText.text = "Loading..";
    this.skillText.text = "Loading..";
    this.killsText.text = "Loading..";
    this.deathsText.text = "Loading..";
    this.capsText.text = "Loading..";
    this.createdText.text = "Loading..";
    this.activityText.text = "Loading..";
    this.clanLabelText.text = "Loading..";
    this.clanText.text = "";
    if (
      (a = "id" === b ? await APIClient.getUserProfile(a) : await APIClient.getUserProfileByName(a))
    ) {
      this.id = a.id;
      "guest" !== App.Credential.accounttype &&
        this.id !== App.Credential.playerid &&
        this.friendInvitationButton.enable();
      this.playerName = a.name;
      b = new Date(Date.parse(a.seen));
      var c = b.getDate().toString().padStart(2, "0"),
        d = (b.getMonth() + 1).toString().padStart(2, "0"),
        e = b.getFullYear();
      b = Date.now() - 864e5 < b.getTime() ? "Today" : c + "-" + d + "-" + e;
      c = new Date(Date.parse(a.created));
      d = c.getDate().toString().padStart(2, "0");
      e = (c.getMonth() + 1).toString().padStart(2, "0");
      var f = c.getFullYear();
      c = Date.now() - 864e5 < c.getTime() ? "Today" : d + "-" + e + "-" + f;
      d = Math.min(Math.max(Math.floor(0.2 * Math.sqrt(parseInt(a.experience) / 15.625)), 1), 160);
      e = Math.max(Math.floor((d / 160) * 10) + 1);
      this.overviewTitle.text = a.name;
      this.overviewTitle.scale.x = this.overviewTitle.scale.y =
        200 < this.overviewTitle.width ? 200 / this.overviewTitle.width : 1;
      this.levelText.text = numberWithPeriods(d);
      this.skillText.text =
        numberWithPeriods(a.skill_ranking) + "\n" + Game.MapSkillToTitle(a.skill);
      this.killsText.text = numberWithPeriods(a.kills);
      this.deathsText.text = numberWithPeriods(a.deaths);
      this.capsText.text = numberWithPeriods(a.caps);
      this.createdText.text = c;
      this.activityText.text = b;
      this.rankText.text = numberWithPeriods(a.ranking);
      this.visualizer.applyCustomization(a.customization);
      this.visualizer.show();
      this.levelIcon.texture = App.CombinedTextures["skill_icon_" + e];
      -1 !== a.clan_id && null !== a.clan_id
        ? ((this.clanId = a.clan_id),
          (this.clanLabelText.text = "Clan " + a.clan_role + " of "),
          (this.clanText.text = a.clan_name),
          (this.clanLabelText.hitArea = new PIXI.Rectangle(
            0.5 * -this.clanLabelText.width,
            0.25 * -this.clanLabelText.height,
            this.clanLabelText.width,
            40
          )))
        : ((this.clanLabelText.text = "Not in a clan."), (this.clanText.text = ""));
      if (App.WhiteLabel !== App.WhiteLabel_POKI)
        for (b = 0; b < a.social.length; b++)
          switch (((c = a.social[b]), c.type)) {
            case "youtube":
              this.youtubeUrl = c.url;
              this.youtubeButton.interactive = !0;
              this.youtubeLogo.alpha = 1;
              this.youtubeTitle.alpha = 1;
              -1 !== c.url.indexOf("youtube.com/user/")
                ? (this.youtubeTitle.text =
                    "YouTube - " + c.url.substring(c.url.indexOf("youtube.com/user/") + 17))
                : (this.youtubeTitle.text = "YouTube - " + a.name);
              break;
            case "twitch":
              (this.twitchUrl = c.url),
                (this.twitchButton.interactive = !0),
                (this.twitchLogo.alpha = 1),
                (this.twitchTitle.alpha = 1),
                -1 !== c.url.indexOf("twitch.tv/")
                  ? (this.twitchTitle.text =
                      "Twitch - " + c.url.substring(c.url.indexOf("twitch.tv/") + 10))
                  : (this.twitchTitle.text = "Twitch - " + a.name);
          }
      if ((a = await APIClient.getUserWeaponStats(this.id))) {
        this.weaponData = JSON.parse(a);
        this.weaponListContainer.removeChildren();
        this.weapons = [];
        a = this.weaponData;
        for (b = 0; b < a.length; b++)
          (c = a[b]),
            (c = new WeaponItem(c.id, c.kills)),
            (c.x = 0),
            (c.y = 47 + b * WeaponListScrollbar.ItemHeight),
            this.weapons.push(c);
        this.weapons.length >
        Math.floor(WeaponListScrollbar.ListHeight / WeaponListScrollbar.ItemHeight)
          ? this.weaponContainer.addChild(this.scrollbar)
          : this.weaponContainer.removeChild(this.scrollbar);
        this.scrollbar.reset();
        this.maskWeaponList(0);
      }
    }
  }
  maskWeaponList(a) {
    let b = Math.floor(WeaponListScrollbar.ListHeight / WeaponListScrollbar.ItemHeight);
    if (this.weapons.length <= b) this.weaponListContainer.y = 0;
    else {
      this.weaponListContainer.removeChildren();
      this.weaponListContainer.y = -(
        a *
        (this.weapons.length * WeaponListScrollbar.ItemHeight -
          (WeaponListScrollbar.ListHeight - WeaponListScrollbar.ItemHeight))
      );
      a = this.weaponListContainer.y;
      var c = Math.round(Math.abs(a / WeaponListScrollbar.ItemHeight));
      for (let e = 0; e < b; e++) {
        let f = this.weapons[c + e];
        this.weaponListContainer.addChild(f);
        if (0 === e) {
          var d = c * WeaponListScrollbar.ItemHeight + a;
          f.alpha = 0 <= d ? 1 : 1 - (1 / (0.5 * WeaponListScrollbar.ItemHeight)) * Math.abs(d);
        } else
          e === b - 1
            ? ((d = c * WeaponListScrollbar.ItemHeight + a),
              (f.alpha =
                0 > d ? 1 : 1 - (1 / (0.5 * WeaponListScrollbar.ItemHeight)) * Math.abs(d)))
            : (f.alpha = 1);
      }
    }
  }
  displayGeneralContainer() {
    this.generalContainer.parent || this.container.addChild(this.generalContainer);
    this.weaponContainer.parent && this.container.removeChild(this.weaponContainer);
    this.contactContainer.parent && this.container.removeChild(this.contactContainer);
    this.generalStatsLabel.alpha = 1;
    this.generalStatsButton.alpha = 1;
    this.weaponStatsLabel.alpha = 0.5;
    this.weaponStatsButton.alpha = 0.5;
    this.contactLabel.alpha = 0.5;
    this.contactButton.alpha = 0.5;
    this.display = UserMenu.GENERAL;
  }
  displayWeaponContainer() {
    this.weaponContainer.parent || this.container.addChild(this.weaponContainer);
    this.generalContainer.parent && this.container.removeChild(this.generalContainer);
    this.contactContainer.parent && this.container.removeChild(this.contactContainer);
    this.generalStatsLabel.alpha = 0.5;
    this.generalStatsButton.alpha = 0.5;
    this.weaponStatsLabel.alpha = 1;
    this.weaponStatsButton.alpha = 1;
    this.contactLabel.alpha = 0.5;
    this.contactButton.alpha = 0.5;
    this.display = UserMenu.WEAPONS;
  }
  displayContactContainer() {
    this.generalContainer.parent && this.container.removeChild(this.generalContainer);
    this.weaponContainer.parent && this.container.removeChild(this.weaponContainer);
    this.contactContainer.parent || this.container.addChild(this.contactContainer);
    this.generalStatsLabel.alpha = 0.5;
    this.generalStatsButton.alpha = 0.5;
    this.weaponStatsLabel.alpha = 0.5;
    this.weaponStatsButton.alpha = 0.5;
    this.contactLabel.alpha = 1;
    this.contactButton.alpha = 1;
    this.display = UserMenu.CONTACT;
  }
  resize(a, b) {
    this.x = 0.5 * a - 0.5 * this.container.width;
    this.y = -8;
  }
  update() {
    this.visualizer.update();
  }
  onCloseButtonReleased() {
    this.emit(Layer.Events.USER_CANCEL);
  }
}
UserMenu.GENERAL = "general";
UserMenu.WEAPONS = "weapons";
UserMenu.CONTACT = "contact";
class WeaponItem extends PIXI.Container {
  constructor(a, b) {
    super();
    var c = Game.MapEventWepToId(a);
    this.id = c;
    this.name = void 0 !== ItemMap[c] ? ItemMap[c].title : this.id;
    this.kills = b;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRoundedRect(0, 0, 392, 38, 4);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0.5;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.5;
    });
    this.addChild(this.background);
    this.icon = Game.MapEventWepToIcon(a);
    this.icon.x = 25;
    this.icon.y = 23;
    a = this.icon.width;
    b = this.icon.height;
    c = a > b ? (24 < a ? 24 : a) : 12 < b ? 12 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? c / this.icon.width : c / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.nameLabel = new PIXI.Text(this.name, {
      fontName: "Arial",
      fontSize: 17,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.nameLabel.x = 90;
    this.nameLabel.y = 10;
    this.addChild(this.nameLabel);
    this.killsLabel = new PIXI.Text(numberWithPeriods(this.kills), {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsLabel.x = 278;
    this.killsLabel.y = 10;
    this.addChild(this.killsLabel);
  }
}
class WeaponListScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.bh = this.h - 39;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-10, -2, 50, this.h + 30);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, -3, 16, 35, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = this.bh * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c));
  }
  scroll(a) {
    if (this.scrolling) {
      a = a.data.global.y / App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      b = 0 > b ? 0 : b > this.bh ? this.bh : b;
      let c = (1 / this.h) * b * (this.h / this.bh);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(WeaponListScrollbar.SCROLL, c);
    }
  }
  reset() {
    this.scrollButton.y = (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
WeaponListScrollbar.SCROLL = "scroll";
WeaponListScrollbar.ListHeight = 200;
WeaponListScrollbar.ItemHeight = 42;
var overviewtab = {};
class OverviewTab extends Feature {
  constructor(a, b) {
    super();
    this.w = a;
    this.h = b;
    this.ox = 20;
    this.oy = 100;
    this.display = UserMenu.GENERAL;
    this.weapons = [];
    this.weaponData = [];
    this.background = new PIXI.Graphics();
    this.background.x = this.ox - 6;
    this.background.y = this.oy + 4;
    this.background.beginFill(6710886, 0.3);
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.drawRoundedRect(0, 0, 632, 300, 8);
    this.background.drawRoundedRect(0, 304, 632, 96, 8);
    this.background.endFill();
    this.container.addChild(this.background);
    this.background.interactive = !0;
    this.generalStatsButton = new PIXI.Graphics();
    this.generalStatsButton.beginFill(16777215, 0.2);
    this.generalStatsButton.lineStyle(1, 16777215, 0.1, 0);
    this.generalStatsButton.drawRect(0, 0, 100, 28, 4);
    this.generalStatsButton.endFill();
    this.generalStatsButton.x = this.ox + 202;
    this.generalStatsButton.y = this.oy + 12;
    this.generalStatsButton.tint = 13421772;
    this.generalStatsButton.interactive = !0;
    this.generalStatsButton.on("mouseover", () => {
      this.generalStatsLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.generalStatsButton.on("mouseout", () => {
      this.generalStatsLabel.alpha = this.display === OverviewTab.GENERAL ? 1 : 0.5;
    });
    this.generalStatsButton.on("mousedown", () => {
      this.displayGeneralContainer();
      AudioEffects.ButtonHover.audio.play();
    });
    this.generalStatsButton.on("touchstart", () => this.displayGeneralContainer());
    this.container.addChild(this.generalStatsButton);
    this.generalStatsLabel = new PIXI.Text("General", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.generalStatsLabel.x =
      this.generalStatsButton.x +
      0.5 * (this.generalStatsButton.width - this.generalStatsLabel.width);
    this.generalStatsLabel.y = this.generalStatsButton.y + 2;
    this.container.addChild(this.generalStatsLabel);
    this.weaponStatsButton = new PIXI.Graphics();
    this.weaponStatsButton.beginFill(16777215, 0.2);
    this.weaponStatsButton.lineStyle(1, 16777215, 0.1, 0);
    this.weaponStatsButton.drawRect(0, 0, 100, 28, 4);
    this.weaponStatsButton.endFill();
    this.weaponStatsButton.x = this.generalStatsButton.x + this.generalStatsButton.width + 8;
    this.weaponStatsButton.y = this.oy + 12;
    this.weaponStatsButton.tint = 13421772;
    this.weaponStatsButton.alpha = 0.5;
    this.weaponStatsButton.interactive = !0;
    this.weaponStatsButton.on("mouseover", () => {
      this.weaponStatsLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.weaponStatsButton.on("mouseout", () => {
      this.weaponStatsLabel.alpha = this.display === OverviewTab.WEAPONS ? 1 : 0.5;
    });
    this.weaponStatsButton.on("mousedown", () => {
      this.displayWeaponContainer();
      AudioEffects.ButtonClick.audio.play();
    });
    this.weaponStatsButton.on("touchstart", () => this.displayWeaponContainer());
    this.container.addChild(this.weaponStatsButton);
    this.weaponStatsLabel = new PIXI.Text("Weapons", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.weaponStatsLabel.alpha = 0.5;
    this.weaponStatsLabel.x =
      this.weaponStatsButton.x + 0.5 * (this.weaponStatsButton.width - this.weaponStatsLabel.width);
    this.weaponStatsLabel.y = this.weaponStatsButton.y + 2;
    this.container.addChild(this.weaponStatsLabel);
    this.creationLabel = new PIXI.Text("Created", {
      fontName: "Arial",
      fontSize: 15,
      fill: 8947848,
      strokeThickness: 2,
    });
    this.creationLabel.x = this.ox;
    this.creationLabel.y = this.h - 14;
    this.container.addChild(this.creationLabel);
    this.createdText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 15,
      fill: 11184810,
      strokeThickness: 2,
    });
    this.createdText.x = this.ox + 60;
    this.createdText.y = this.h - 14;
    this.container.addChild(this.createdText);
    this.activityLabel = new PIXI.Text("Last seen", {
      fontName: "Arial",
      fontSize: 15,
      fill: 8947848,
      strokeThickness: 2,
    });
    this.activityLabel.x = this.ox;
    this.activityLabel.y = this.h + 6;
    this.container.addChild(this.activityLabel);
    this.activityText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 15,
      fill: 11184810,
      strokeThickness: 2,
    });
    this.activityText.x = this.ox + 68;
    this.activityText.y = this.h + 6;
    this.activityText.tint = 16777215;
    this.container.addChild(this.activityText);
    this.visualizer = new Visualizer(176, 176, !0, !0, !1);
    this.visualizer.x = this.ox + 12;
    this.visualizer.y = 142;
    this.visualizer.interactive = !0;
    this.container.addChild(this.visualizer);
    this.overviewTitle = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16763904,
      strokeThickness: 4,
      lineJoin: "round",
    });
    this.overviewTitle.x = this.visualizer.x + 0.5 * this.visualizer.width;
    this.overviewTitle.y = this.oy + 10;
    this.overviewTitle.anchor.x = 0.5;
    this.container.addChild(this.overviewTitle);
    this.generalContainer = new PIXI.Container();
    this.levelLabel = new PIXI.Text("Level", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelLabel.x = this.ox + 210;
    this.levelLabel.y = this.oy + 46;
    this.generalContainer.addChild(this.levelLabel);
    this.levelText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelText.x = this.ox + 232;
    this.levelText.y = this.oy + 72;
    this.generalContainer.addChild(this.levelText);
    this.rankLabel = new PIXI.Text("Level rank", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.rankLabel.x = this.ox + 210;
    this.rankLabel.y = this.oy + 100;
    this.generalContainer.addChild(this.rankLabel);
    this.rankText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.rankText.x = this.ox + 210;
    this.rankText.y = this.oy + 124;
    this.generalContainer.addChild(this.rankText);
    this.skillLabel = new PIXI.Text("Skill rank", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillLabel.x = this.ox + 210;
    this.skillLabel.y = this.oy + 154;
    this.generalContainer.addChild(this.skillLabel);
    this.skillText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 20,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillText.x = this.ox + 210;
    this.skillText.y = this.oy + 178;
    this.generalContainer.addChild(this.skillText);
    this.killsLabel = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsLabel.x = this.ox + 360;
    this.killsLabel.y = this.oy + 46;
    this.generalContainer.addChild(this.killsLabel);
    this.killsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsText.x = this.ox + 360;
    this.killsText.y = this.oy + 70;
    this.generalContainer.addChild(this.killsText);
    this.deathsLabel = new PIXI.Text("Deaths", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.deathsLabel.x = this.ox + 360;
    this.deathsLabel.y = this.oy + 100;
    this.generalContainer.addChild(this.deathsLabel);
    this.deathsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.deathsText.x = this.ox + 360;
    this.deathsText.y = this.oy + 124;
    this.generalContainer.addChild(this.deathsText);
    this.capsLabel = new PIXI.Text("CTF caps", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.capsLabel.x = this.ox + 360;
    this.capsLabel.y = this.oy + 154;
    this.generalContainer.addChild(this.capsLabel);
    this.capsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.capsText.x = this.ox + 360;
    this.capsText.y = this.oy + 178;
    this.generalContainer.addChild(this.capsText);
    this.levelIcon = new PIXI.Sprite();
    this.levelIcon.x = this.ox + 200;
    this.levelIcon.y = this.oy + 62;
    this.levelIcon.scale.x = this.levelIcon.scale.y = 0.5;
    this.generalContainer.addChild(this.levelIcon);
    this.levelBarTitle = new PIXI.Text("Progress", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelBarTitle.x = 400;
    this.levelBarTitle.y = 324;
    this.generalContainer.addChild(this.levelBarTitle);
    this.levelBar = new LevelBar();
    this.levelBar.x = 280;
    this.levelBar.y = 350;
    this.generalContainer.addChild(this.levelBar);
    this.goldBackground = new PIXI.Graphics();
    this.goldBackground.x = 36;
    this.goldBackground.y = 324;
    this.goldBackground.beginFill(0, 0.2);
    this.goldBackground.drawRoundedRect(0, 0, 170, 52, 4);
    this.goldBackground.endFill();
    this.container.addChild(this.goldBackground);
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = 42;
    this.goldIcon.y = 329;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.65;
    this.addChild(this.goldIcon);
    this.goldText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.goldText.x = this.goldIcon.x + this.goldIcon.width + 10;
    this.goldText.y = this.goldIcon.y + 11;
    this.addChild(this.goldText);
    this.weaponContainer = new PIXI.Container();
    this.weaponTitle = new PIXI.Text("Favorite weapons", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponTitle.x = this.ox + 210;
    this.weaponTitle.y = this.oy + 48;
    this.weaponContainer.addChild(this.weaponTitle);
    this.weaponNameLabel = new PIXI.Text("Type", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponNameLabel.x = this.ox + 210;
    this.weaponNameLabel.y = this.oy + 70;
    this.weaponContainer.addChild(this.weaponNameLabel);
    this.weaponKillsLabel = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponKillsLabel.x = this.ox + 480;
    this.weaponKillsLabel.y = this.oy + 70;
    this.weaponContainer.addChild(this.weaponKillsLabel);
    this.youtubeLogo = new PIXI.Sprite(App.CombinedTextures.youtube_logo);
    this.youtubeLogo.scale.x = this.youtubeLogo.scale.y = 0.5;
    this.youtubeLogo.x = this.ox + 4;
    this.youtubeLogo.y = this.oy + 321;
    this.container.addChild(this.youtubeLogo);
    this.youtubeTitle = new PIXI.Text("YouTube\nchannel", {
      fontName: "Arial",
      fontSize: 15,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 2,
    });
    this.youtubeTitle.x = this.ox + 44;
    this.youtubeTitle.y = this.oy + 318;
    this.youtubeTitle.tint = 16776960;
    this.container.addChild(this.youtubeTitle);
    this.youtubeField = new InputField("youtube_field", !1, 20);
    this.youtubeField.setDimensions(370, 35);
    this.youtubeField.forceLowerCase = !1;
    this.youtubeField.setMaxChars(64);
    this.youtubeField.x = this.ox + 112;
    this.youtubeField.y = this.oy + 318;
    this.youtubeField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890:/?._"
    );
    this.youtubeField.addListener(InputField.CHANGE, (c) => {
      c = c.data.value;
      0 === c.length ||
      0 === c.indexOf("https://www.youtube.com/") ||
      0 === c.indexOf("https://youtube.com/")
        ? (this.youtubeField.markNone(), this.saveYoutubeButton.enable())
        : (this.youtubeField.markInvalid(), this.saveYoutubeButton.disable());
    });
    this.container.addChild(this.youtubeField);
    this.pasteYoutubeButton = new Button("paste_yt");
    this.pasteYoutubeButton.selected = !0;
    this.pasteYoutubeButton.setText("Paste");
    this.pasteYoutubeButton.scale.x = this.pasteYoutubeButton.scale.y = 0.75;
    this.pasteYoutubeButton.addListener(Button.BUTTON_RELEASED, () => {
      navigator.clipboard.readText().then((c) => {
        this.youtubeField.setText(c);
        0 === c.length ||
        0 === c.indexOf("https://www.youtube.com/") ||
        0 === c.indexOf("https://youtube.com/")
          ? (this.youtubeField.markNone(), this.saveYoutubeButton.enable())
          : (this.youtubeField.markInvalid(), this.saveYoutubeButton.disable());
      });
    });
    this.pasteYoutubeButton.x = this.ox + this.youtubeField.x + this.youtubeField.width - 4;
    this.pasteYoutubeButton.y = this.oy + 322;
    this.container.addChild(this.pasteYoutubeButton);
    this.saveYoutubeButton = new Button("save_yt");
    this.saveYoutubeButton.selected = !0;
    this.saveYoutubeButton.setText("Save");
    this.saveYoutubeButton.setTint(16763904);
    this.saveYoutubeButton.scale.x = this.saveYoutubeButton.scale.y = 0.75;
    this.saveYoutubeButton.disable();
    this.saveYoutubeButton.addListener(Button.BUTTON_RELEASED, async () => {
      let c = this.youtubeField.getText();
      this.saveYoutubeButton.disable();
      (await this.submitSocial("youtube", c))
        ? this.youtubeField.markValid()
        : this.youtubeField.markInvalid();
    });
    this.saveYoutubeButton.x = this.pasteYoutubeButton.x + this.pasteYoutubeButton.width + 4;
    this.saveYoutubeButton.y = this.oy + 322;
    this.container.addChild(this.saveYoutubeButton);
    this.twitchLogo = new PIXI.Sprite(App.CombinedTextures.twitch_logo);
    this.twitchLogo.scale.x = this.twitchLogo.scale.y = 0.75;
    this.twitchLogo.x = this.ox + 4;
    this.twitchLogo.y = this.oy + 360;
    this.container.addChild(this.twitchLogo);
    this.twitchTitle = new PIXI.Text("Twitch\nchannel", {
      fontName: "Arial",
      fontSize: 15,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 2,
    });
    this.twitchTitle.x = this.ox + 47;
    this.twitchTitle.y = this.oy + 362;
    this.twitchTitle.tint = 16776960;
    this.container.addChild(this.twitchTitle);
    this.twitchField = new InputField("twitch_field", !1, 20);
    this.twitchField.setDimensions(370, 35);
    this.twitchField.forceLowerCase = !1;
    this.twitchField.setMaxChars(64);
    this.twitchField.x = this.ox + 112;
    this.twitchField.y = this.oy + 362;
    this.twitchField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890:/?._"
    );
    this.twitchField.addListener(InputField.CHANGE, (c) => {
      c = c.data.value;
      0 === c.length ||
      0 === c.indexOf("https://www.twitch.tv/") ||
      0 === c.indexOf("https://twitch.tv/")
        ? (this.twitchField.markNone(), this.saveTwitchButton.enable())
        : (this.twitchField.markInvalid(), this.saveTwitchButton.disable());
    });
    this.container.addChild(this.twitchField);
    this.pasteTwitchButton = new Button("paste_tw");
    this.pasteTwitchButton.selected = !0;
    this.pasteTwitchButton.setText("Paste");
    this.pasteTwitchButton.scale.x = this.pasteTwitchButton.scale.y = 0.75;
    this.pasteTwitchButton.addListener(Button.BUTTON_RELEASED, () => {
      navigator.clipboard.readText().then((c) => {
        this.twitchField.setText(c);
        0 === c.length ||
        0 === c.indexOf("https://www.twitch.tv/") ||
        0 === c.indexOf("https://twitch.tv/")
          ? (this.twitchField.markNone(), this.saveTwitchButton.enable())
          : (this.twitchField.markInvalid(), this.saveTwitchButton.disable());
      });
    });
    this.pasteTwitchButton.x = this.ox + this.twitchField.x + this.twitchField.width - 4;
    this.pasteTwitchButton.y = this.oy + 366;
    this.container.addChild(this.pasteTwitchButton);
    this.saveTwitchButton = new Button("save_yt");
    this.saveTwitchButton.selected = !0;
    this.saveTwitchButton.setText("Save");
    this.saveTwitchButton.setTint(16763904);
    this.saveTwitchButton.scale.x = this.saveTwitchButton.scale.y = 0.75;
    this.saveTwitchButton.disable();
    this.saveTwitchButton.addListener(Button.BUTTON_RELEASED, async () => {
      let c = this.twitchField.getText();
      this.saveTwitchButton.disable();
      (await this.submitSocial("twitch", c))
        ? this.twitchField.markValid()
        : this.twitchField.markInvalid();
    });
    this.saveTwitchButton.x = this.pasteTwitchButton.x + this.pasteTwitchButton.width + 4;
    this.saveTwitchButton.y = this.oy + 366;
    this.container.addChild(this.saveTwitchButton);
    this.listContainer = new PIXI.Container();
    this.listContainer.x = this.ox + 204;
    this.listContainer.y = this.oy + 48;
    this.weaponListContainer = new PIXI.Container();
    this.listContainer.addChild(this.weaponListContainer);
    this.weaponContainer.addChild(this.listContainer);
    this.scrollbar = new WeaponListScrollbar(172);
    this.scrollbar.x = this.ox + 598;
    this.scrollbar.y = this.oy + 90;
    this.scrollbar.on(WeaponListScrollbar.SCROLL, (c) => {
      this.maskWeaponList(c);
    });
    this.displayGeneralContainer();
  }
  async submitSocial(a, b) {
    return (await APIClient.postSocial(a, b, App.Credential.id)).success;
  }
  async load() {
    var a = await APIClient.getProfile(App.Credential.id);
    this.visualizer.hide();
    this.overviewTitle.text = "Loading..";
    this.levelText.text = "Loading..";
    this.rankText.text = "Loading..";
    this.skillText.text = "Loading..";
    this.killsText.text = "Loading..";
    this.deathsText.text = "Loading..";
    this.capsText.text = "Loading..";
    this.createdText.text = "Loading..";
    this.activityText.text = "Loading..";
    this.youtubeField.markNone();
    this.twitchField.markNone();
    if (a) {
      a = JSON.parse(a);
      var b = new Date(Date.parse(a.seen)),
        c = b.getDate().toString().padStart(2, "0"),
        d = (b.getMonth() + 1).toString().padStart(2, "0"),
        e = b.getFullYear();
      b = Date.now() - 864e5 < b.getTime() ? "Today" : c + "-" + d + "-" + e;
      c = new Date(Date.parse(a.created));
      d = c.getDate().toString().padStart(2, "0");
      e = (c.getMonth() + 1).toString().padStart(2, "0");
      var f = c.getFullYear();
      d = Date.now() - 864e5 < c.getTime() ? "Today" : d + "-" + e + "-" + f;
      e = Math.min(Math.max(Math.floor(0.2 * Math.sqrt(parseInt(a.experience) / 15.625)), 1), 160);
      c = Math.max(Math.floor((e / 160) * 10) + 1);
      f = 15.625 * Math.pow(e / 0.2, 2);
      var g = 15.625 * Math.pow((e + 1) / 0.2, 2);
      this.levelBar.load(1 === e ? 0 : f, parseInt(a.experience, 10), g);
      this.overviewTitle.text = a.name;
      this.overviewTitle.scale.x = this.overviewTitle.scale.y =
        200 < this.overviewTitle.width ? 200 / this.overviewTitle.width : 1;
      this.levelText.text = numberWithPeriods(e);
      this.skillText.text =
        numberWithPeriods(a.skill_ranking) + "\n" + Game.MapSkillToTitle(a.skill);
      this.killsText.text = numberWithPeriods(a.kills);
      this.deathsText.text = numberWithPeriods(a.deaths);
      this.capsText.text = numberWithPeriods(a.caps);
      this.createdText.text = d;
      this.activityText.text = b;
      this.rankText.text = numberWithPeriods(a.ranking);
      this.goldText.text = numberWithPeriods(a.gold);
      for (b = 0; b < a.social.length; b++)
        switch (((d = a.social[b]), d.type)) {
          case "youtube":
            this.youtubeField.setText(d.url);
            break;
          case "twitch":
            this.twitchField.setText(d.url);
        }
      this.visualizer.show();
      this.visualizer.applyCustomization(a.customization);
      this.levelIcon.texture = App.CombinedTextures["skill_icon_" + c];
      if ((a = await APIClient.getUserWeaponStats(App.Credential.playerid))) {
        this.weaponData = JSON.parse(a);
        this.weaponListContainer.removeChildren();
        this.weapons = [];
        a = this.weaponData;
        for (b = 0; b < a.length; b++)
          (c = a[b]),
            (c = new WeaponItem(c.id, c.kills)),
            (c.x = 0),
            (c.y = 47 + b * WeaponListScrollbar.ItemHeight),
            this.weapons.push(c);
        this.weapons.length >
        Math.floor(WeaponListScrollbar.ListHeight / WeaponListScrollbar.ItemHeight)
          ? this.weaponContainer.addChild(this.scrollbar)
          : this.weaponContainer.removeChild(this.scrollbar);
        this.scrollbar.reset();
        this.maskWeaponList(0);
      }
    }
  }
  maskWeaponList(a) {
    let b = Math.floor(WeaponListScrollbar.ListHeight / WeaponListScrollbar.ItemHeight);
    if (this.weapons.length <= b) this.weaponListContainer.y = 0;
    else {
      this.weaponListContainer.removeChildren();
      this.weaponListContainer.y = -(
        a *
        (this.weapons.length * WeaponListScrollbar.ItemHeight -
          (WeaponListScrollbar.ListHeight - WeaponListScrollbar.ItemHeight))
      );
      a = this.weaponListContainer.y;
      var c = Math.round(Math.abs(a / WeaponListScrollbar.ItemHeight));
      for (let e = 0; e < b; e++) {
        let f = this.weapons[c + e];
        this.weaponListContainer.addChild(f);
        if (0 === e) {
          var d = c * WeaponListScrollbar.ItemHeight + a;
          f.alpha = 0 <= d ? 1 : 1 - (1 / (0.5 * WeaponListScrollbar.ItemHeight)) * Math.abs(d);
        } else
          e === b - 1
            ? ((d = c * WeaponListScrollbar.ItemHeight + a),
              (f.alpha =
                0 > d ? 1 : 1 - (1 / (0.5 * WeaponListScrollbar.ItemHeight)) * Math.abs(d)))
            : (f.alpha = 1);
      }
    }
  }
  displayGeneralContainer() {
    this.generalContainer.parent || this.container.addChild(this.generalContainer);
    this.weaponContainer.parent && this.container.removeChild(this.weaponContainer);
    this.generalStatsLabel.alpha = 1;
    this.generalStatsButton.alpha = 1;
    this.weaponStatsLabel.alpha = 0.5;
    this.weaponStatsButton.alpha = 0.5;
    this.display = OverviewTab.GENERAL;
  }
  displayWeaponContainer() {
    this.weaponContainer.parent || this.container.addChild(this.weaponContainer);
    this.generalContainer.parent && this.container.removeChild(this.generalContainer);
    this.generalStatsLabel.alpha = 0.5;
    this.generalStatsButton.alpha = 0.5;
    this.weaponStatsLabel.alpha = 1;
    this.weaponStatsButton.alpha = 1;
    this.display = OverviewTab.WEAPONS;
  }
  update() {
    this.visualizer.update();
  }
}
OverviewTab.GENERAL = "general";
OverviewTab.WEAPONS = "weapons";
var clantab = {};
class ClanTab extends Feature {
  constructor(a, b) {
    super();
    this.w = a;
    this.h = b;
    this.ox = 20;
    this.oy = 126;
    this.members = [];
    this.clanSettingsTitle = new PIXI.Text("Clan", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.clanSettingsTitle.x = this.ox - 4;
    this.clanSettingsTitle.y = 100;
    this.clanSettingsTitle.tint = 16763904;
    this.addChild(this.clanSettingsTitle);
    this.creationContainer = new PIXI.Container();
    this.clanCreationBackground = new PIXI.Graphics();
    this.clanCreationBackground.x = this.ox - 6;
    this.clanCreationBackground.y = this.oy;
    this.clanCreationBackground.beginFill(6710886, 0.3);
    this.clanCreationBackground.drawRoundedRect(0, 0, 632, 372, 8);
    this.clanCreationBackground.endFill();
    this.clanCreationBackground.beginFill(6710886, 0.3);
    this.clanCreationBackground.drawRoundedRect(16, 140, 600, 208, 8);
    this.clanCreationBackground.endFill();
    this.creationContainer.addChild(this.clanCreationBackground);
    this.clanSettingsTitle = new PIXI.Text(
      "You are not in a clan. Create your own clan or join an existing clan.\nYou can only be in 1 clan at a time.\nIf you create a clan, you will become the clan leader. Clan leaders can invite\nnew members and promote existing members to the role of 'captain'.\nCaptains can invite new members and remove lower ranking members.\nCreating a clan costs 10.000 gold.",
      {
        fontName: "Arial",
        fontSize: 16,
        fill: 13421772,
        strokeThickness: 2,
        lineJoin: "round",
        wordWrap: !0,
        wordWrapWidth: 640,
      }
    );
    this.clanSettingsTitle.x = this.ox;
    this.clanSettingsTitle.y = this.oy + 5;
    this.creationContainer.addChild(this.clanSettingsTitle);
    this.clanCreationMenuTitle = new PIXI.Text("Create a clan", {
      fontName: "Arial",
      fontSize: 20,
      fill: 16746496,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.clanCreationMenuTitle.x = this.ox + 16;
    this.clanCreationMenuTitle.y = this.oy + 142;
    this.creationContainer.addChild(this.clanCreationMenuTitle);
    this.clanCreationTitle = new PIXI.Text("Clan name", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.clanCreationTitle.x = this.ox + 20;
    this.clanCreationTitle.y = this.oy + 180;
    this.creationContainer.addChild(this.clanCreationTitle);
    this.clanNameField = new InputField("clan_name");
    this.clanNameField.setDimensions(300, 35);
    this.clanNameField.forceLowerCase = !1;
    this.clanNameField.setMaxChars(18);
    this.clanNameField.x = this.ox + 20;
    this.clanNameField.y = this.oy + 208;
    this.clanNameField.setFilter("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890 ");
    this.creationContainer.addChild(this.clanNameField);
    this.createClanButton = new Button("create_clan");
    this.createClanButton.selected = !0;
    this.createClanButton.setText("Create");
    this.createClanButton.setTint(16763904);
    this.createClanButton.scale.x = this.createClanButton.scale.y = 0.8;
    this.createClanButton.addListener(
      Button.BUTTON_RELEASED,
      this.onCreateClanButtonReleased.bind(this)
    );
    this.createClanButton.x = this.ox + 30;
    this.createClanButton.y = this.oy + 265;
    this.creationContainer.addChild(this.createClanButton);
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = this.createClanButton.x + this.createClanButton.width + 4;
    this.goldIcon.y = this.createClanButton.y;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.5;
    this.creationContainer.addChild(this.goldIcon);
    this.goldInfo = new PIXI.Text("-10.000", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16711680,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.goldInfo.x = this.goldIcon.x + this.goldIcon.width + 4;
    this.goldInfo.y = this.goldIcon.y + 6;
    this.creationContainer.addChild(this.goldInfo);
    this.createClanErrorMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16711680,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.createClanErrorMessage.x = this.ox + 24;
    this.createClanErrorMessage.y = this.createClanButton.y + 44;
    this.createClanErrorMessage.tint = 16711680;
    this.createClanErrorMessage.maxWidth = 380;
    this.creationContainer.addChild(this.createClanErrorMessage);
    this.displayContainer = new PIXI.Container();
    this.clanOverviewBackground = new PIXI.Graphics();
    this.clanOverviewBackground.x = this.ox - 6;
    this.clanOverviewBackground.y = this.oy;
    this.clanOverviewBackground.beginFill(6710886, 0.3);
    this.clanOverviewBackground.drawRoundedRect(0, 0, 632, 372, 8);
    this.clanOverviewBackground.endFill();
    this.clanOverviewBackground.beginFill(6710886, 0.3);
    this.clanOverviewBackground.drawRoundedRect(321, 160, 305, 196, 8);
    this.clanOverviewBackground.endFill();
    this.clanOverviewBackground.beginFill(6710886, 0.3);
    this.clanOverviewBackground.drawRoundedRect(12, 12, 48, 48, 4);
    this.clanOverviewBackground.endFill();
    this.displayContainer.addChild(this.clanOverviewBackground);
    this.uploadText = new PIXI.Text("Clan\nbanner\ncoming soon", {
      fontName: "Arial",
      fontSize: 12,
      fill: 12303291,
      strokeThickness: 2,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 80,
      align: "center",
    });
    this.uploadText.x = this.ox - 6;
    this.uploadText.y = this.oy + 10;
    this.displayContainer.addChild(this.uploadText);
    this.nameText = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 30, align: "left" });
    this.nameText.x = this.ox + 68;
    this.nameText.y = this.oy + 20;
    this.nameText.tint = 16776960;
    this.displayContainer.addChild(this.nameText);
    this.memberText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.memberText.x = this.ox + 10;
    this.memberText.y = this.oy + 68;
    this.displayContainer.addChild(this.memberText);
    this.roleLabelText = new PIXI.Text("Your role: ", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.roleLabelText.x = this.ox + 10;
    this.roleLabelText.y = this.oy + 98;
    this.displayContainer.addChild(this.roleLabelText);
    this.hintText = new PIXI.Text(
      "Leaders and captains can right-click\nfriends to invite them into their clan.",
      {
        fontName: "Arial",
        fontSize: 15,
        fill: 13421772,
        strokeThickness: 2,
        lineJoin: "round",
        wordWrap: !0,
        wordWrapWidth: 280,
      }
    );
    this.hintText.x = this.ox + 10;
    this.hintText.y = this.oy + 130;
    this.displayContainer.addChild(this.hintText);
    this.roleText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.roleText.x = this.roleLabelText.x + this.roleLabelText.width + 8;
    this.roleText.y = this.roleLabelText.y;
    this.displayContainer.addChild(this.roleText);
    this.createdText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 15,
      fill: 13412864,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.createdText.x = 478;
    this.createdText.y = this.oy + 5;
    this.displayContainer.addChild(this.createdText);
    this.membersTitle = new PIXI.Text("Members", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16750848,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.membersTitle.x = this.ox + 320;
    this.membersTitle.y = this.oy + 138;
    this.displayContainer.addChild(this.membersTitle);
    this.membersHint = new PIXI.Text("(right-click to manage)", {
      fontName: "Arial",
      fontSize: 15,
      fill: 13421772,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.membersHint.x = this.membersTitle.x + this.membersTitle.width + 6;
    this.membersHint.y = this.membersTitle.y + 1;
    this.displayContainer.addChild(this.membersHint);
    this.listContainer = new PIXI.Container();
    this.listContainer.x = this.ox + 318;
    this.listContainer.y = this.oy + 122;
    this.memberListContainer = new PIXI.Container();
    this.listContainer.addChild(this.memberListContainer);
    this.displayContainer.addChild(this.listContainer);
    this.scrollbar = new MemberListScrollbar(195);
    this.scrollbar.x = this.ox + 598;
    this.scrollbar.y = this.oy + 166;
    this.scrollbar.on(MemberListScrollbar.SCROLL, (c) => {
      this.maskMemberList(c);
    });
    this.memberDropdown = new MemberDropdown();
    this.memberDropdown.on(MemberDropdown.ACTION_PROMOTE, (c) => this.promoteMember(c));
    this.memberDropdown.on(MemberDropdown.ACTION_DEMOTE, (c) => this.demoteMember(c));
    this.memberDropdown.on(MemberDropdown.ACTION_REMOVE, (c) => this.removeMember(c));
    this.leaveClanButton = new Button("leave_clan");
    this.leaveClanButton.setText("Leave clan");
    this.leaveClanButton.setTint(16733525);
    this.leaveClanButton.scale.x = this.leaveClanButton.scale.y = 0.8;
    this.leaveClanButton.addListener(
      Button.BUTTON_RELEASED,
      this.onLeaveClanButtonReleased.bind(this)
    );
    this.leaveClanButton.x = this.ox + 520;
    this.leaveClanButton.y = this.oy + 32;
    this.displayContainer.addChild(this.leaveClanButton);
    this.leaveClanContainer = new PIXI.Container();
    this.leaveClanBackground = new PIXI.Graphics();
    this.leaveClanBackground.x = 0;
    this.leaveClanBackground.y = 0;
    this.leaveClanBackground.lineStyle(3, 11184810, 0.5, 0);
    this.leaveClanBackground.beginFill(0, 0.8);
    this.leaveClanBackground.drawRoundedRect(0, 0, 440, 200, 10);
    this.leaveClanBackground.endFill();
    this.leaveClanBackground.interactive = !0;
    this.leaveClanVerificationText = new PIXI.Text("Are you sure you want to leave this clan?", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 380,
      align: "center",
    });
    this.leaveClanVerificationText.x = 0.5 * this.leaveClanBackground.width;
    this.leaveClanVerificationText.y = 40;
    this.leaveClanVerificationText.anchor.x = this.leaveClanVerificationText.anchor.y = 0.5;
    this.leaveClanAcceptButton = new Button("leave_clan_accept");
    this.leaveClanAcceptButton.setText("Confirm");
    this.leaveClanAcceptButton.scale.x = this.leaveClanAcceptButton.scale.y = 0.8;
    this.leaveClanAcceptButton.addListener(
      Button.BUTTON_RELEASED,
      this.onLeaveClanAcceptButtonReleased.bind(this)
    );
    this.leaveClanAcceptButton.x =
      0.5 * (this.leaveClanBackground.width - this.leaveClanAcceptButton.width) + 70;
    this.leaveClanAcceptButton.y = 140;
    this.leaveClanAcceptButton.setTint(16711680);
    this.leaveClanDeclineButton = new Button("leave_clan_cancel");
    this.leaveClanDeclineButton.setText("Cancel");
    this.leaveClanDeclineButton.scale.x = this.leaveClanDeclineButton.scale.y = 0.8;
    this.leaveClanDeclineButton.addListener(
      Button.BUTTON_RELEASED,
      this.onleaveClanCancelButtonReleased.bind(this)
    );
    this.leaveClanDeclineButton.x =
      0.5 * (this.leaveClanBackground.width - this.leaveClanDeclineButton.width) - 70;
    this.leaveClanDeclineButton.y = 140;
    this.leaveClanDeclineButton.setTint(16763904);
    this.leaveClanErrorText = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "center",
      multiline: !0,
    });
    this.leaveClanErrorText.x = 0.5 * this.leaveClanBackground.width;
    this.leaveClanErrorText.y = 186;
    this.leaveClanErrorText.tint = 16711680;
    this.leaveClanErrorText.anchor.x = this.leaveClanErrorText.anchor.y = 0.5;
    this.leaveClanContainer.addChild(this.leaveClanBackground);
    this.leaveClanContainer.addChild(this.leaveClanAcceptButton);
    this.leaveClanContainer.addChild(this.leaveClanDeclineButton);
    this.leaveClanContainer.addChild(this.leaveClanVerificationText);
    this.leaveClanContainer.addChild(this.leaveClanErrorText);
    this.leaveClanContainer.x = 0.5 * (this.w - this.leaveClanContainer.width);
    this.leaveClanContainer.y = 0.5 * (this.h - this.leaveClanContainer.height);
  }
  async load() {
    let a = await APIClient.getClanByAccountId(App.Credential.playerid);
    a && (a.clan.id ? this.displayOverview(a.clan) : this.displayCreate());
  }
  displayCreate() {
    this.creationContainer.parent || this.container.addChild(this.creationContainer);
    this.displayContainer.parent && this.container.removeChild(this.displayContainer);
  }
  async displayOverview(a) {
    this.displayContainer.parent || this.container.addChild(this.displayContainer);
    this.creationContainer.parent && this.container.removeChild(this.creationContainer);
    var b = new Date(Date.parse(a.created)),
      c = b.getFullYear(),
      d = b.getMonth() + 1;
    b = b.getDate();
    c = c.toString() + "-" + d.toString().padStart(2, "0") + "-" + b.toString().padStart(2, "0");
    this.nameText.text = a.name;
    this.memberText.text = a.members + " members";
    this.roleText.text = a.role;
    this.createdText.text = "Founded on " + c;
    c = await APIClient.getClanMembers(a.id);
    if (c.success) {
      this.members = [];
      this.memberListContainer.removeChildren();
      a = a.role;
      c = c.members;
      for (d = 0; d < c.length; d++) {
        b = {};
        let e = !1,
          f = c[d];
        "leader" === a &&
          "member" === f.role &&
          ((b[MemberDropdown.ACTION_PROMOTE] = "Promote"), (e = !0));
        "leader" === a &&
          "captain" === f.role &&
          ((b[MemberDropdown.ACTION_DEMOTE] = "Demote"), (e = !0));
        if (
          ("leader" === a && ("member" === f.role || "captain" === f.role)) ||
          ("captain" === a && "member" === f.role)
        )
          (b[MemberDropdown.ACTION_REMOVE] = "Remove"), (e = !0);
        let g = new MemberItem(f.id, f.name, f.role, b);
        g.x = 0;
        g.y = 47 + d * MemberListScrollbar.ItemHeight;
        g.on(ClanTab.ACCESS_PROFILE, (h) => this.emit(Layer.Events.USER_ACCESS, h));
        if (e && f.id !== App.Credential.playerid)
          g.on(ClanTab.SHOW_DROPDOWN, (h) => this.showDropdown(f.id, g, h));
        this.members.push(g);
        this.members.length <
          Math.floor(MemberListScrollbar.ListHeight / MemberListScrollbar.ItemHeight) &&
          this.memberListContainer.addChild(g);
      }
      this.members.length >
      Math.floor(MemberListScrollbar.ListHeight / MemberListScrollbar.ItemHeight)
        ? this.displayContainer.addChild(this.scrollbar)
        : this.displayContainer.removeChild(this.scrollbar);
      this.scrollbar.reset();
      this.maskMemberList(0);
    }
  }
  showDropdown(a, b, c) {
    this.memberDropdown.id === a && this.memberDropdown.parent
      ? this.container.removeChild(this.memberDropdown)
      : ((this.memberDropdown.id = a),
        (this.memberDropdown.name = b.name),
        this.container.addChild(this.memberDropdown),
        (this.memberDropdown.x = this.listContainer.x + b.x),
        (this.memberDropdown.y =
          this.listContainer.y + this.memberListContainer.y + b.y + b.height),
        this.memberDropdown.display(c, a));
  }
  validateClanCreationForm() {
    let a = !0,
      b = "",
      c = this.clanNameField.getText().trim();
    2 > c.length || 20 < c.field
      ? ((a = !1),
        (b = "Clan names should be longer than 2 and shorter than 21 characters."),
        this.clanNameField.markInvalid())
      : this.clanNameField.markNone();
    a && (this.createClanErrorMessage.text = "");
    return { valid: a, error: b };
  }
  async onCreateClanButtonReleased() {
    this.createClanButton.disable();
    var a = this.validateClanCreationForm();
    a.valid
      ? ((a = this.clanNameField.getText().trim()),
        (a = await APIClient.postCreateClan(a, App.Credential.id)),
        a.success
          ? ((a = await APIClient.getClanByAccountId(App.Credential.playerid)),
            this.displayOverview(a.clan),
            this.maskMemberList(0),
            this.emit(Layer.Events.CREATE_CLAN))
          : ((this.createClanErrorMessage.text = a.error), this.createClanButton.enable()))
      : ((this.createClanErrorMessage.text = a.error), this.createClanButton.enable());
  }
  async onLeaveClanButtonReleased() {
    this.leaveClanContainer.parent || this.displayContainer.addChild(this.leaveClanContainer);
    this.leaveClanButton.disable();
  }
  async onLeaveClanAcceptButtonReleased() {
    (await APIClient.postLeaveMember(App.Credential.id)).success
      ? (this.leaveClanContainer.parent &&
          this.displayContainer.removeChild(this.leaveClanContainer),
        this.emit(Layer.Events.LEAVE_CLAN),
        this.leaveClanButton.enable(),
        this.displayCreate())
      : ((this.leaveClanErrorText.text = "Error: unable to leave clan."),
        this.leaveClanButton.enable());
  }
  async onleaveClanCancelButtonReleased() {
    this.leaveClanContainer.parent && this.displayContainer.removeChild(this.leaveClanContainer);
    this.leaveClanButton.enable();
    this.leaveClanErrorText.text = "";
  }
  maskMemberList(a) {
    let b = Math.floor(MemberListScrollbar.ListHeight / MemberListScrollbar.ItemHeight);
    if (this.members.length <= b) this.memberListContainer.y = 0;
    else {
      this.memberListContainer.removeChildren();
      this.memberListContainer.y = -(
        a *
        (this.members.length * MemberListScrollbar.ItemHeight -
          (MemberListScrollbar.ListHeight - MemberListScrollbar.ItemHeight))
      );
      a = this.memberListContainer.y;
      var c = Math.round(Math.abs(a / MemberListScrollbar.ItemHeight));
      for (let e = 0; e < b; e++) {
        let f = this.members[c + e];
        this.memberListContainer.addChild(f);
        if (0 === e) {
          var d = c * MemberListScrollbar.ItemHeight + a;
          f.alpha = 0 <= d ? 1 : 1 - (1 / (0.5 * MemberListScrollbar.ItemHeight)) * Math.abs(d);
        } else
          e === b - 1
            ? ((d = c * MemberListScrollbar.ItemHeight + a),
              (f.alpha =
                0 > d ? 1 : 1 - (1 / (0.5 * MemberListScrollbar.ItemHeight)) * Math.abs(d)))
            : (f.alpha = 1);
      }
    }
  }
  async promoteMember(a) {
    this.memberDropdown.parent && this.container.removeChild(this.memberDropdown);
    await APIClient.postPromoteMember(a, App.Credential.id);
    (a = await APIClient.getClanByAccountId(App.Credential.playerid)) &&
      this.displayOverview(a.clan);
  }
  async demoteMember(a) {
    this.memberDropdown.parent && this.container.removeChild(this.memberDropdown);
    await APIClient.postDemoteMember(a, App.Credential.id);
    (a = await APIClient.getClanByAccountId(App.Credential.playerid)) &&
      this.displayOverview(a.clan);
  }
  async removeMember(a) {
    this.memberDropdown.parent && this.container.removeChild(this.memberDropdown);
    await APIClient.postRemoveMember(a, App.Credential.id);
    (a = await APIClient.getClanByAccountId(App.Credential.playerid)) &&
      this.displayOverview(a.clan);
  }
}
ClanTab.SHOW_DROPDOWN = "showDropdown";
ClanTab.ACCESS_PROFILE = "accessProfile";
class MemberListScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.bh = this.h - 39;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-10, -2, 50, this.h + 30);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, -3, 16, 35, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = this.bh * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c));
  }
  scroll(a) {
    if (this.scrolling) {
      a = a.data.global.y / App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      b = 0 > b ? 0 : b > this.bh ? this.bh : b;
      let c = (1 / this.h) * b * (this.h / this.bh);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(MemberListScrollbar.SCROLL, c);
    }
  }
  reset() {
    this.scrollButton.y = (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
MemberListScrollbar.SCROLL = "scroll";
MemberListScrollbar.ListHeight = 208;
MemberListScrollbar.ItemHeight = 30;
class MemberItem extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.id = a;
    this.name = b;
    this.role = c;
    this.options = d;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRoundedRect(0, 0, 276, 26, 4);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0.5;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.5;
    });
    this.background.on("mousedown", () => this.emit(ClanTab.ACCESS_PROFILE, this.id));
    this.background.on("rightdown", () => this.emit(ClanTab.SHOW_DROPDOWN, this.options));
    this.addChild(this.background);
    this.nameLabel = new PIXI.BitmapText(this.name, {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
    });
    this.nameLabel.x = 8;
    this.nameLabel.y = 2;
    this.addChild(this.nameLabel);
    if ("captain" === this.role || "leader" === this.role)
      (this.roleLabel = new PIXI.BitmapText(this.role, {
        fontName: "Open Sans",
        fontSize: 22,
        align: "left",
      })),
        (this.roleLabel.x = 270 - this.roleLabel.width),
        (this.roleLabel.y = 2),
        (this.roleLabel.tint = "leader" === this.role ? 8978312 : 16746632),
        this.addChild(this.roleLabel);
  }
}
class MemberDropdown extends PIXI.Container {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.addChild(this.background);
    this.itemContainer = new PIXI.Graphics();
    this.addChild(this.itemContainer);
  }
  display(a, b) {
    this.background.clear();
    this.itemContainer.removeChildren();
    let c = 0;
    for (let d in a) {
      let e = new MemberDropdownActionRow(a[d], d, 16777215);
      e.on(d, () => this.emit(d, b));
      e.x = 10;
      e.y = 6 + 30 * c;
      this.itemContainer.addChild(e);
      c++;
    }
    this.background.lineStyle(1, 16777215, 0.4, 0);
    this.background.beginFill(5592405, 0.9);
    this.background.drawRoundedRect(0, 0, 110, 2 + 30 * c, 4);
    this.background.endFill();
  }
}
MemberDropdown.ACTION_PROMOTE = "promote";
MemberDropdown.ACTION_DEMOTE = "demote";
MemberDropdown.ACTION_REMOVE = "remove";
class MemberDropdownActionRow extends PIXI.Container {
  constructor(a, b, c, d = !0) {
    super();
    this.text = a;
    this.tintValue = c;
    switch (b) {
      case MemberDropdown.ACTION_PROMOTE:
        this.tintValue = 65280;
        break;
      case MemberDropdown.ACTION_DEMOTE:
        this.tintValue = 16776960;
        break;
      case MemberDropdown.ACTION_REMOVE:
        this.tintValue = 16711680;
    }
    this.actionText = new PIXI.Text(this.text, {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.confirmation = d;
    this.confirming = !1;
    this.interactive = !0;
    this.hitArea = new PIXI.Rectangle(0, 0, 100, 30);
    this.actionText.tint = this.tintValue;
    this.actionText.alpha = 0.7;
    this.on("mouseover", () => {
      this.actionText.alpha = 1;
    });
    this.on("mouseout", () => {
      this.actionText.alpha = 0.7;
      this.confirmation &&
        ((this.confirming = !1),
        (this.actionText.text = this.text),
        (this.actionText.tint = this.tintValue));
    });
    this.on("mousedown", () => {
      this.confirmation
        ? this.confirming
          ? (this.emit(b), (this.actionText.tint = this.tintValue))
          : ((this.actionText.text = "Confirm?"),
            (this.actionText.tint = 16746496),
            (this.confirming = !0))
        : (this.emit(b), (this.actionText.tint = this.tintValue));
    });
    this.addChild(this.actionText);
  }
}
MemberDropdownActionRow.CONFIRM = "confirm";
MemberDropdownActionRow.SELECT = "select";
var settingstab = {};
class SettingsTab extends Feature {
  constructor(a, b) {
    super();
    this.settings = { allow_invite: !1 };
    this.w = a;
    this.h = b;
    this.ox = 20;
    this.oy = 126;
    this.initialized = !1;
    this.background = new PIXI.Graphics();
    this.background.x = this.ox - 6;
    this.background.y = this.oy + 4;
    this.background.beginFill(6710886, 0.3);
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.drawRoundedRect(0, 0, 632, 300, 8);
    this.background.endFill();
    this.container.addChild(this.background);
    this.settingsTitle = new PIXI.Text("Social preferences", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.settingsTitle.x = this.ox - 4;
    this.settingsTitle.y = 100;
    this.settingsTitle.tint = 16763904;
    this.addChild(this.settingsTitle);
    this.allowInviteCheck = new Checkbox(
      "allowInvite",
      "Allow friend invitations",
      this.settings.allow_invite
    );
    this.allowInviteCheck.x = this.ox + 20;
    this.allowInviteCheck.y = this.oy + 40;
    this.allowInviteCheck.on(Checkbox.CHANGE, (c) => (this.settings.allow_invite = c));
    this.container.addChild(this.allowInviteCheck);
    this.allowInviteCheck.setChecked(this.settings.allow_invite);
    this.applyButton = new Button("save");
    this.applyButton.x = this.ox + 20;
    this.applyButton.y = this.background.height - 46;
    this.applyButton.setText("Save preferences");
    this.applyButton.scale.x = this.applyButton.scale.y = 0.8;
    this.applyButton.addListener(Button.BUTTON_RELEASED, this.onApplyButtonReleased.bind(this));
    this.applyButton.setTint(16763904);
    this.container.addChild(this.applyButton);
  }
  async onApplyButtonReleased() {
    this.applyButton.disable();
    await APIClient.postSettings(this.settings, App.Credential.id);
    this.applyButton.enable();
  }
  async load() {
    if (!this.initialized) {
      var a = await APIClient.getSettings(App.Credential.id);
      a.success &&
        ((this.initialized = !0),
        (this.settings = a.settings),
        this.allowInviteCheck.setChecked(this.settings.allow_invite));
    }
  }
}
var profilemenu = {};
class ProfileMenu extends Feature {
  constructor() {
    super();
    this.tab = null;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.lineStyle(2, 16777215, 0.1);
    this.background.moveTo(10, 59);
    this.background.lineTo(650, 59);
    this.container.addChild(this.background);
    this.ox = 0;
    this.oy = 40;
    this.overviewTabButton = new PIXI.Graphics();
    this.overviewTabButton.beginFill(13421772, 0.2);
    this.overviewTabButton.drawRoundedRect(0, 0, 96, 40, 8);
    this.overviewTabButton.endFill();
    this.overviewTabButton.interactive = !0;
    this.overviewTabButton.x = this.ox + 14;
    this.overviewTabButton.y = this.oy + 14;
    this.overviewTabButton.on("mousedown", () => this.openTab(ProfileMenu.TAB_OVERVIEW));
    this.overviewTabButton.on("touchstart", () => this.openTab(ProfileMenu.TAB_OVERVIEW));
    this.container.addChild(this.overviewTabButton);
    this.overviewTabTitle = new PIXI.Text("Overview", {
      fontName: "Open Sans",
      fontSize: 20,
      fill: 13421772,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.overviewTabTitle.scale.x = this.overviewTabTitle.scale.y = 0.9;
    this.overviewTabTitle.anchor.x = this.overviewTabTitle.anchor.y = 0.5;
    this.overviewTabTitle.x = this.overviewTabButton.x + 0.5 * this.overviewTabButton.width;
    this.overviewTabTitle.y = this.overviewTabButton.y + 20;
    this.overviewTabTitle.interactive = !0;
    this.overviewTabTitle.on("mouseover", () => {
      this.overviewTabTitle.scale.x = this.overviewTabTitle.scale.y = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.overviewTabTitle.on(
      "mouseout",
      () => (this.overviewTabTitle.scale.x = this.overviewTabTitle.scale.y = 0.9)
    );
    this.overviewTabButton.on(
      "mouseover",
      () => (this.overviewTabTitle.scale.x = this.overviewTabTitle.scale.y = 1)
    );
    this.overviewTabButton.on(
      "mouseout",
      () => (this.overviewTabTitle.scale.x = this.overviewTabTitle.scale.y = 0.9)
    );
    this.overviewTabTitle.on("mousedown", () => this.openTab(ProfileMenu.TAB_OVERVIEW));
    this.overviewTabTitle.on("touchstart", () => this.openTab(ProfileMenu.TAB_OVERVIEW));
    this.container.addChild(this.overviewTabTitle);
    this.clanTabButton = new PIXI.Graphics();
    this.clanTabButton.beginFill(13421772, 0.2);
    this.clanTabButton.drawRoundedRect(0, 0, 96, 40, 8);
    this.clanTabButton.endFill();
    this.clanTabButton.interactive = !0;
    this.clanTabButton.x = this.ox + this.overviewTabButton.x + this.overviewTabButton.width + 4;
    this.clanTabButton.y = this.oy + 14;
    this.clanTabButton.on("mousedown", () => this.openTab(ProfileMenu.TAB_CLAN));
    this.clanTabButton.on("touchstart", () => this.openTab(ProfileMenu.TAB_CLAN));
    this.container.addChild(this.clanTabButton);
    this.clanTabTitle = new PIXI.Text("Clan", {
      fontName: "Open Sans",
      fontSize: 20,
      fill: 13421772,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.clanTabTitle.scale.x = this.clanTabTitle.scale.y = 0.9;
    this.clanTabTitle.anchor.x = this.clanTabTitle.anchor.y = 0.5;
    this.clanTabTitle.x = this.clanTabButton.x + 0.5 * this.clanTabButton.width;
    this.clanTabTitle.y = this.clanTabButton.y + 20;
    this.clanTabTitle.interactive = !0;
    this.clanTabTitle.on("mouseover", () => {
      this.clanTabTitle.scale.x = this.clanTabTitle.scale.y = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.clanTabTitle.on(
      "mouseout",
      () => (this.clanTabTitle.scale.x = this.clanTabTitle.scale.y = 0.9)
    );
    this.clanTabButton.on(
      "mouseover",
      () => (this.clanTabTitle.scale.x = this.clanTabTitle.scale.y = 1)
    );
    this.clanTabButton.on(
      "mouseout",
      () => (this.clanTabTitle.scale.x = this.clanTabTitle.scale.y = 0.9)
    );
    this.clanTabTitle.on("mousedown", () => this.openTab(ProfileMenu.TAB_CLAN));
    this.clanTabTitle.on("touchstart", () => this.openTab(ProfileMenu.TAB_CLAN));
    this.container.addChild(this.clanTabTitle);
    this.accountTabButton = new PIXI.Graphics();
    this.accountTabButton.beginFill(13421772, 0.2);
    this.accountTabButton.drawRoundedRect(0, 0, 96, 40, 8);
    this.accountTabButton.endFill();
    this.accountTabButton.interactive = !0;
    this.accountTabButton.x = this.ox + this.clanTabButton.x + this.clanTabButton.width + 4;
    this.accountTabButton.y = this.oy + 14;
    this.accountTabButton.on("mousedown", () => this.openTab(ProfileMenu.TAB_ACCOUNT));
    this.accountTabButton.on("touchstart", () => this.openTab(ProfileMenu.TAB_ACCOUNT));
    this.container.addChild(this.accountTabButton);
    this.accountTabTitle = new PIXI.Text("Account", {
      fontName: "Open Sans",
      fontSize: 20,
      fill: 13421772,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.accountTabTitle.scale.x = this.accountTabTitle.scale.y = 0.9;
    this.accountTabTitle.anchor.x = this.accountTabTitle.anchor.y = 0.5;
    this.accountTabTitle.x = this.accountTabButton.x + 0.5 * this.accountTabButton.width;
    this.accountTabTitle.y = this.accountTabButton.y + 20;
    this.accountTabTitle.interactive = !0;
    this.accountTabTitle.alpha = 0.75;
    this.accountTabTitle.on("mouseover", () => {
      this.accountTabTitle.scale.x = this.accountTabTitle.scale.y = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.accountTabTitle.on(
      "mouseout",
      () => (this.accountTabTitle.scale.x = this.accountTabTitle.scale.y = 0.9)
    );
    this.accountTabTitle.on("mousedown", () => this.openTab(ProfileMenu.TAB_ACCOUNT));
    this.accountTabTitle.on("touchstart", () => this.openTab(ProfileMenu.TAB_ACCOUNT));
    this.accountTabButton.on(
      "mouseover",
      () => (this.accountTabTitle.scale.x = this.accountTabTitle.scale.y = 1)
    );
    this.accountTabButton.on(
      "mouseout",
      () => (this.accountTabTitle.scale.x = this.accountTabTitle.scale.y = 0.9)
    );
    this.container.addChild(this.accountTabTitle);
    this.settingsTabButton = new PIXI.Graphics();
    this.settingsTabButton.beginFill(13421772, 0.2);
    this.settingsTabButton.drawRoundedRect(0, 0, 96, 40, 8);
    this.settingsTabButton.endFill();
    this.settingsTabButton.interactive = !0;
    this.settingsTabButton.x = this.ox + this.accountTabButton.x + this.accountTabButton.width + 4;
    this.settingsTabButton.y = this.oy + 14;
    this.settingsTabButton.on("mousedown", () => this.openTab(ProfileMenu.TAB_SETTINGS));
    this.settingsTabButton.on("touchstart", () => this.openTab(ProfileMenu.TAB_SETTINGS));
    this.container.addChild(this.settingsTabButton);
    this.settingsTabTitle = new PIXI.Text("Settings", {
      fontName: "Open Sans",
      fontSize: 20,
      fill: 13421772,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.settingsTabTitle.scale.x = this.settingsTabTitle.scale.y = 0.9;
    this.settingsTabTitle.anchor.x = this.settingsTabTitle.anchor.y = 0.5;
    this.settingsTabTitle.x = this.settingsTabButton.x + 0.5 * this.settingsTabButton.width;
    this.settingsTabTitle.y = this.settingsTabButton.y + 20;
    this.settingsTabTitle.interactive = !0;
    this.settingsTabTitle.on("mouseover", () => {
      this.settingsTabTitle.scale.x = this.settingsTabTitle.scale.y = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.settingsTabTitle.on(
      "mouseout",
      () => (this.settingsTabTitle.scale.x = this.settingsTabTitle.scale.y = 0.9)
    );
    this.settingsTabButton.on(
      "mouseover",
      () => (this.settingsTabTitle.scale.x = this.settingsTabTitle.scale.y = 1)
    );
    this.settingsTabButton.on(
      "mouseout",
      () => (this.settingsTabTitle.scale.x = this.settingsTabTitle.scale.y = 0.9)
    );
    this.settingsTabTitle.on("mousedown", () => this.openTab(ProfileMenu.TAB_SETTINGS));
    this.settingsTabTitle.on("touchstart", () => this.openTab(ProfileMenu.TAB_SETTINGS));
    this.container.addChild(this.settingsTabTitle);
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 14;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.PROFILE_CANCEL));
    this.container.addChild(this.closeButton);
    this.container.x = 0.5 * -this.width;
    this.overviewTab = new OverviewTab(this.width, this.height);
    this.accountTab = new AccountTab(this.width, this.height);
    this.accountTab.on(Layer.Events.LOGOUT, () => this.emit(Layer.Events.LOGOUT));
    this.accountTab.on(Layer.Events.PROFILE_RENAME, (a) =>
      this.emit(Layer.Events.PROFILE_RENAME, a)
    );
    this.incompleteAccountTab = new IncompleteAccountTab(this.width, this.height);
    this.incompleteAccountTab.on(Layer.Events.RENAME_ACCESS, () =>
      this.emit(Layer.Events.RENAME_ACCESS)
    );
    this.clanTab = new ClanTab(this.width, this.height);
    this.clanTab.on(Layer.Events.USER_ACCESS, (a) => this.emit(Layer.Events.USER_ACCESS, a));
    this.clanTab.on(Layer.Events.LEAVE_CLAN, (a) => this.emit(Layer.Events.LEAVE_CLAN, a));
    this.clanTab.on(Layer.Events.CREATE_CLAN, (a) => this.emit(Layer.Events.CREATE_CLAN, a));
    this.settingsTab = new SettingsTab();
  }
  openTab(a, b = !0) {
    b && AudioEffects.ButtonClick.audio.play();
    this.tab = a;
    switch (a) {
      case ProfileMenu.TAB_ACCOUNT:
        this.accountTabTitle.alpha = 1;
        this.accountTabButton.alpha = 0.3;
        App.Autogen
          ? (this.accountTab.parent && this.container.removeChild(this.accountTab),
            this.container.addChild(this.incompleteAccountTab))
          : (this.incompleteAccountTab.parent &&
              this.container.removeChild(this.incompleteAccountTab),
            this.container.addChild(this.accountTab),
            this.accountTab.load());
        this.overviewTabTitle.alpha = 0.75;
        this.overviewTabButton.alpha = 1;
        this.overviewTab.parent && this.container.removeChild(this.overviewTab);
        this.clanTabTitle.alpha = 0.75;
        this.clanTabButton.alpha = 1;
        this.clanTab.parent && this.container.removeChild(this.clanTab);
        this.settingsTabTitle.alpha = 0.75;
        this.settingsTabButton.alpha = 1;
        this.settingsTab.parent && this.container.removeChild(this.settingsTab);
        break;
      case ProfileMenu.TAB_CLAN:
        this.clanTabTitle.alpha = 1;
        this.clanTabButton.alpha = 0.3;
        this.container.addChild(this.clanTab);
        this.clanTab.load();
        this.overviewTabTitle.alpha = 0.75;
        this.overviewTabButton.alpha = 1;
        this.overviewTab.parent && this.container.removeChild(this.overviewTab);
        this.accountTabTitle.alpha = 0.75;
        this.accountTabButton.alpha = 1;
        this.accountTab.parent && this.container.removeChild(this.accountTab);
        this.incompleteAccountTab.parent && this.container.removeChild(this.incompleteAccountTab);
        this.settingsTabTitle.alpha = 0.75;
        this.settingsTabButton.alpha = 1;
        this.settingsTab.parent && this.container.removeChild(this.settingsTab);
        break;
      case ProfileMenu.TAB_OVERVIEW:
        this.overviewTabTitle.alpha = 1;
        this.overviewTabButton.alpha = 0.3;
        this.container.addChild(this.overviewTab);
        this.overviewTab.load();
        this.accountTabTitle.alpha = 0.75;
        this.accountTabButton.alpha = 1;
        this.accountTab.parent && this.container.removeChild(this.accountTab);
        this.clanTabTitle.alpha = 0.75;
        this.clanTabButton.alpha = 1;
        this.clanTab.parent && this.container.removeChild(this.clanTab);
        this.incompleteAccountTab.parent && this.container.removeChild(this.incompleteAccountTab);
        this.settingsTabTitle.alpha = 0.75;
        this.settingsTabButton.alpha = 1;
        this.settingsTab.parent && this.container.removeChild(this.settingsTab);
        break;
      case ProfileMenu.TAB_SETTINGS:
        (this.settingsTabTitle.alpha = 1),
          (this.settingsTabButton.alpha = 0.3),
          this.container.addChild(this.settingsTab),
          this.settingsTab.load(),
          (this.overviewTabTitle.alpha = 0.75),
          (this.overviewTabButton.alpha = 1),
          this.overviewTab.parent && this.container.removeChild(this.overviewTab),
          (this.accountTabTitle.alpha = 0.75),
          (this.accountTabButton.alpha = 1),
          this.accountTab.parent && this.container.removeChild(this.accountTab),
          (this.clanTabTitle.alpha = 0.75),
          (this.clanTabButton.alpha = 1),
          this.clanTab.parent && this.container.removeChild(this.clanTab),
          this.incompleteAccountTab.parent && this.container.removeChild(this.incompleteAccountTab);
    }
  }
  update() {
    this.tab === ProfileMenu.TAB_OVERVIEW && this.overviewTab.update();
  }
  show() {
    this.openTab(this.tab, !1);
  }
  reset() {}
}
ProfileMenu.TAB_OVERVIEW = "tab_overview";
ProfileMenu.TAB_CLAN = "tab_clan";
ProfileMenu.TAB_ACCOUNT = "tab_account";
ProfileMenu.TAB_SETTINGS = "tab_settings";
var userinput = {},
  UserInput = {
    pressed: {},
    hasFocus: !1,
    setFocus: function (a) {
      this.hasFocus = !0;
      this.onFocus = a;
    },
    releaseFocus: function () {
      this.hasFocus = !1;
      this.onFocus = null;
    },
    emulateKeyDown: function (a) {
      this.dispatchEvent(new CustomEvent(UserInput.KEY_DOWN, a));
    },
    emulateKeyUp: function (a) {
      this.dispatchEvent(new CustomEvent(UserInput.KEY_UP, a));
    },
    onKeyDown: function (a) {
      var b = a.keyCode || a.char,
        c = { char: this.getMappedChar(b, a.shiftKey), code: b, ctrl: a.ctrlKey };
      if (this.onFocus) this.onFocus(new CustomEvent(UserInput.KEY_PRESS, c));
      else
        this.dispatchEvent(new CustomEvent(UserInput.KEY_PRESS, c)),
          this.dispatchEvent(new CustomEvent(UserInput.KEY_DOWN, c));
      this.pressed[b] = !0;
      App.FieldHasFocus || 8 !== a.keyCode || a.preventDefault();
    },
    onKeyUp: function (a) {
      var b = a.keyCode || a.char;
      this.pressed[b] &&
        (this.onFocus ||
          this.dispatchEvent(
            new CustomEvent(UserInput.KEY_UP, { char: this.getMappedChar(b, a.shiftKey), code: b })
          ),
        (this.pressed[b] = !1));
    },
    getMappedChar: function (a, b) {
      8 !== a && 191 !== a && 220 !== a && String.fromCharCode(a);
      return b ? characterMapShift[a] : characterMap[a];
    },
    azertyToQwerty: function (a) {
      var b = azertyMap[a];
      return b ? b : a;
    },
  };
EventDispatcher.call(UserInput);
UserInput.KEY_DOWN = "keyDown";
UserInput.KEY_UP = "keyUp";
UserInput.KEY_PRESS = "keyPress";
UserInput.BACKSPACE = 8;
UserInput.ENTER = 13;
UserInput.NUMERIC = "1234567890";
UserInput.ALPHANUMERIC = "1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
UserInput.ALPHA_EXT =
  "\u00e4\u00e7\u00eb\u00e9\u00e8\u00ef\u00ed\u00ec\u00f6\u00f3\u00f2\u00df\u00fc\u00fa\u00f9\u00fd\u00ff\u00c4\u00c7\u00cb\u00c9\u00c8\u00cf\u00cd\u00cc\u00d6\u00d3\u00d2\u00a7\u00dc\u00da\u00d9\u00dd";
UserInput.CHAT_SYMBOLS = ",|{}[]~'`\"?:\\/()*&^%$#@!=;-! ._<>+";
UserInput.WHEEL = "wheel";
UserInput.ExclusiveWheel = null;
document.addEventListener("keydown", (a) => UserInput.onKeyDown(a));
document.addEventListener("keyup", (a) => UserInput.onKeyUp(a));
window.addEventListener("keydown", (a) => {
  ["ArrowDown", "ArrowUp", " "].includes(a.key) && a.preventDefault();
});
window.addEventListener(
  "wheel",
  (a) => {
    a.preventDefault();
    null !== UserInput.ExclusiveWheel
      ? UserInput.ExclusiveWheel(new CustomEvent(UserInput.WHEEL, { delta: a.deltaY }))
      : UserInput.dispatchEvent(new CustomEvent(UserInput.WHEEL, { delta: a.deltaY }));
  },
  { passive: !1 }
);
var characterMapCTRL = [];
characterMapCTRL[16] = "SHT";
characterMapCTRL[17] = "CTL";
characterMapCTRL[18] = "ALT";
characterMapCTRL[32] = "SPC";
characterMapCTRL[37] = "LFT";
characterMapCTRL[38] = "UP";
characterMapCTRL[39] = "RGT";
characterMapCTRL[40] = "DWN";
var arrowsInv = { LFT: "A", UP: "W", RGT: "D", DWN: "S" },
  azertyMap = [];
azertyMap[91] = 87;
azertyMap[81] = 65;
azertyMap[83] = 83;
azertyMap[68] = 68;
azertyMap[65] = 81;
azertyMap[87] = 90;
var characterMapShift = [];
characterMapShift[8] = "";
characterMapShift[9] = "";
characterMapShift[13] = "\n";
characterMapShift[16] = "";
characterMapShift[17] = "";
characterMapShift[18] = "";
characterMapShift[19] = "";
characterMapShift[20] = "";
characterMapShift[27] = "";
characterMapShift[32] = " ";
characterMapShift[33] = "";
characterMapShift[34] = "";
characterMapShift[35] = "";
characterMapShift[36] = "";
characterMapShift[37] = "";
characterMapShift[38] = "";
characterMapShift[39] = "";
characterMapShift[40] = "";
characterMapShift[45] = "";
characterMapShift[46] = "";
characterMapShift[48] = ")";
characterMapShift[49] = "!";
characterMapShift[50] = "@";
characterMapShift[51] = "#";
characterMapShift[52] = "$";
characterMapShift[53] = "%";
characterMapShift[54] = "^";
characterMapShift[55] = "&";
characterMapShift[56] = "*";
characterMapShift[57] = "(";
characterMapShift[59] = ":";
characterMapShift[61] = "+";
characterMapShift[65] = "A";
characterMapShift[66] = "B";
characterMapShift[67] = "C";
characterMapShift[68] = "D";
characterMapShift[69] = "E";
characterMapShift[70] = "F";
characterMapShift[71] = "G";
characterMapShift[72] = "H";
characterMapShift[73] = "I";
characterMapShift[74] = "J";
characterMapShift[75] = "K";
characterMapShift[76] = "L";
characterMapShift[77] = "M";
characterMapShift[78] = "N";
characterMapShift[79] = "O";
characterMapShift[80] = "P";
characterMapShift[81] = "Q";
characterMapShift[82] = "R";
characterMapShift[83] = "S";
characterMapShift[84] = "T";
characterMapShift[85] = "U";
characterMapShift[86] = "V";
characterMapShift[87] = "W";
characterMapShift[88] = "X";
characterMapShift[89] = "Y";
characterMapShift[90] = "Z";
characterMapShift[91] = "";
characterMapShift[92] = "";
characterMapShift[93] = "";
characterMapShift[96] = "0";
characterMapShift[97] = "1";
characterMapShift[98] = "2";
characterMapShift[99] = "3";
characterMapShift[100] = "4";
characterMapShift[101] = "5";
characterMapShift[102] = "6";
characterMapShift[103] = "7";
characterMapShift[104] = "8";
characterMapShift[105] = "9";
characterMapShift[106] = "*";
characterMapShift[107] = "+";
characterMapShift[109] = "_";
characterMapShift[107] = "+";
characterMapShift[111] = "/";
characterMapShift[112] = "";
characterMapShift[113] = "";
characterMapShift[114] = "";
characterMapShift[115] = "";
characterMapShift[116] = "";
characterMapShift[117] = "";
characterMapShift[118] = "";
characterMapShift[119] = "";
characterMapShift[120] = "";
characterMapShift[121] = "";
characterMapShift[122] = "";
characterMapShift[123] = "";
characterMapShift[144] = "";
characterMapShift[145] = "";
characterMapShift[186] = ":";
characterMapShift[187] = "+";
characterMapShift[188] = "<";
characterMapShift[189] = "_";
characterMapShift[190] = ">";
characterMapShift[191] = "?";
characterMapShift[192] = "~";
characterMapShift[219] = "{";
characterMapShift[220] = "|";
characterMapShift[221] = "}";
characterMapShift[222] = '"';
var characterMap = [];
characterMap[8] = "";
characterMap[9] = "";
characterMap[13] = "\n";
characterMap[16] = "";
characterMap[17] = "";
characterMap[18] = "";
characterMap[19] = "";
characterMap[20] = "";
characterMap[27] = "";
characterMap[32] = " ";
characterMap[33] = "";
characterMap[34] = "";
characterMap[35] = "";
characterMap[36] = "";
characterMap[37] = "";
characterMap[38] = "";
characterMap[39] = "";
characterMap[40] = "";
characterMap[45] = "";
characterMap[46] = "";
characterMap[48] = "0";
characterMap[49] = "1";
characterMap[50] = "2";
characterMap[51] = "3";
characterMap[52] = "4";
characterMap[53] = "5";
characterMap[54] = "6";
characterMap[55] = "7";
characterMap[56] = "8";
characterMap[57] = "9";
characterMap[59] = ";";
characterMap[61] = "=";
characterMap[65] = "a";
characterMap[66] = "b";
characterMap[67] = "c";
characterMap[68] = "d";
characterMap[69] = "e";
characterMap[70] = "f";
characterMap[71] = "g";
characterMap[72] = "h";
characterMap[73] = "i";
characterMap[74] = "j";
characterMap[75] = "k";
characterMap[76] = "l";
characterMap[77] = "m";
characterMap[78] = "n";
characterMap[79] = "o";
characterMap[80] = "p";
characterMap[81] = "q";
characterMap[82] = "r";
characterMap[83] = "s";
characterMap[84] = "t";
characterMap[85] = "u";
characterMap[86] = "v";
characterMap[87] = "w";
characterMap[88] = "x";
characterMap[89] = "y";
characterMap[90] = "z";
characterMap[91] = "";
characterMap[92] = "";
characterMap[93] = "";
characterMap[96] = "0";
characterMap[97] = "1";
characterMap[98] = "2";
characterMap[99] = "3";
characterMap[100] = "4";
characterMap[101] = "5";
characterMap[102] = "6";
characterMap[103] = "7";
characterMap[104] = "8";
characterMap[105] = "9";
characterMap[106] = "*";
characterMap[107] = "+";
characterMap[109] = "_";
characterMap[107] = "+";
characterMap[111] = "/";
characterMap[112] = "";
characterMap[113] = "";
characterMap[114] = "";
characterMap[115] = "";
characterMap[116] = "";
characterMap[117] = "";
characterMap[118] = "";
characterMap[119] = "";
characterMap[120] = "";
characterMap[121] = "";
characterMap[122] = "";
characterMap[123] = "";
characterMap[144] = "";
characterMap[145] = "";
characterMap[186] = ";";
characterMap[187] = "=";
characterMap[188] = ",";
characterMap[189] = "-";
characterMap[190] = ".";
characterMap[191] = "/";
characterMap[192] = "`";
characterMap[219] = "[";
characterMap[220] = "\\";
characterMap[221] = "]";
characterMap[222] = "'";
var itemoverview = {};
class ItemOverview extends PIXI.Container {
  constructor() {
    super();
    this.items = [];
    this.title = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 20,
      lineHeight: 16,
      fill: 16750848,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.x = 0;
    this.title.y = 6;
    this.addChild(this.title);
    this.comingSoon = new PIXI.Text("Coming soon..", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.comingSoon.x = 4;
    this.comingSoon.y = 58;
    this.comingSoon.visible = !1;
    this.addChild(this.comingSoon);
    this.background = new PIXI.Graphics();
    this.background.lineStyle(1, 16777215, 0.2, 0);
    this.background.drawRoundedRect(-5, -5, 250, 370, 4);
    this.background.endFill();
    this.background.x = 0;
    this.background.y = 50;
    this.addChild(this.background);
    this.container = new PIXI.Container();
    this.container.x = 0;
    this.container.y = 50;
    this.containerMask = new PIXI.Graphics();
    this.containerMask.beginFill(16777215, 1);
    this.containerMask.drawRoundedRect(0, 0, 240, 360, 4);
    this.containerMask.endFill();
    this.containerMask.x = 0;
    this.containerMask.y = 50;
    this.scrollbar = new IOScrollbar();
    this.scrollbar.x = 248;
    this.scrollbar.y = 50;
    this.addChild(this.scrollbar);
    this.scrollbar.on(IOScrollbar.SCROLL, (a) => {
      this.container.height > this.containerMask.height &&
        (this.container.y = 50 + a * (this.container.height - this.containerMask.height) * -1);
    });
    this.addChild(this.containerMask);
    this.addChild(this.container);
    this.container.mask = this.containerMask;
  }
  show() {
    this.scrollbar.enableWheel();
  }
  hide() {
    this.scrollbar.disableWheel();
  }
  setTitle(a) {
    this.title.text = a;
  }
  select(a) {
    for (let b = 0; b < this.items.length; b++)
      if (this.items[b].data.id === a) {
        this.items[b].select();
        break;
      }
  }
  loadItems(a, b = "", c, d) {
    this.setTitle(b);
    this.container.removeChildren();
    this.container.y = 50;
    this.scrollbar.reset();
    this.comingSoon.visible = 0 === a.length ? !0 : !1;
    for (b = 0; b < a.length; b++) {
      const e = new IOItem(a[b], d);
      e.x = 0;
      e.y = 70 * b;
      this.items.push(e);
      this.container.addChild(e);
      e.on(IOItem.SELECT, (f) => this.onItemSelected(f));
      e.data.id === c && e.select();
    }
  }
  onItemSelected(a) {
    for (let b = 0; b < this.items.length; b++)
      a.id !== this.items[b].data.id && this.items[b].deselect();
    this.emit(ItemOverview.SELECT, a);
  }
}
ItemOverview.SELECT = "select";
class IOScrollbar extends PIXI.Container {
  constructor() {
    super();
    this.scrolling = !1;
    this.h = 370;
    this.bh = this.h - 39;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, 370, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-10, -20, 50, 400);
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (a) => {
      this.scrolling = !0;
      this.oy = a.data.global.y / App.Scale;
      this.scroll(a.data.global.y);
    });
    this.scrollBar.on("mouseup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (a) => this.scroll(a.data.global.y));
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (a) => {
      this.scrolling = !0;
      this.oy = a.data.global.y / App.Scale;
      this.scroll(a.data.global.y);
    });
    this.scrollBar.on("pointermove", (a) => this.scroll(a.data.global.y));
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3;
    this.wheelListener = (a) => {
      a = a.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * a);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      b = 0 > b ? 0 : b > this.bh ? this.bh : b;
      let c = (1 / this.h) * b * (this.h / this.bh);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(IOScrollbar.SCROLL, c);
    }
  }
  reset() {
    this.scrollButton.y = -3;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
IOScrollbar.SCROLL = "scroll";
class IOItem extends PIXI.Container {
  constructor(a, b) {
    super();
    this.selected = !1;
    this.data = a;
    this.itemBackground = new PIXI.Graphics();
    this.itemBackground.lineStyle(1, 16777215, 0.4, 0);
    this.itemBackground.beginFill(16777215, 0.2);
    this.itemBackground.drawRoundedRect(0, 0, 240, 64, 4);
    this.itemBackground.endFill();
    this.itemBackground.alpha = 0.5;
    this.itemBackground.x = 0;
    this.itemBackground.y = 0;
    this.itemBackground.interactive = !0;
    this.itemBackground.on("mouseover", () => this.onMouseOver());
    this.itemBackground.on("mouseout", () => this.onMouseOut());
    this.itemBackground.on("mousedown", () => this.select());
    this.itemBackground.on("pointerdown", () => this.select());
    this.addChild(this.itemBackground);
    var c = a.texture;
    b && 0 < b.length && (c = b + (0 < a.texture.length ? "_" : "") + c);
    b = new PIXI.Sprite(App.CombinedTextures[c]);
    this.timeout = !1;
    c = JSON.parse(a.data);
    let d = 1;
    d = b.height > b.width ? (68 < b.height ? 68 / b.height : 1) : 68 < b.width ? 68 / b.width : 1;
    b.scale.x = d;
    b.scale.y = d;
    b.x = 4;
    b.y = 0.5 * (70 - b.height) - 2;
    this.addChild(b);
    void 0 !== c.tint && (b.tint = parseInt(c.tint, 16));
    c = new PIXI.Text(a.title, {
      fontName: "Arial",
      fontSize: 15,
      lineHeight: 16,
      fill: 16777215,
      wordWrap: !0,
      wordWrapWidth: 100,
      strokeThickness: 2,
      lineJoin: "round",
    });
    c.x = 72 + (0 < b.width - 68 ? b.width - 68 : 0);
    c.y = 24;
    this.addChild(c);
    a = "free" === a.status ? "Free" : a.own ? "Owned" : numberWithPeriods(a.price);
    a = new PIXI.Text(a, {
      fontName: "Arial",
      fontSize: 15,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    a.x = 180;
    a.y = 26;
    this.addChild(a);
  }
  onMouseOver() {
    this.itemBackground.alpha = 1;
    AudioEffects.ButtonHover.audio.play();
  }
  onMouseOut() {
    this.selected || (this.itemBackground.alpha = 0.5);
  }
  select() {
    this.timeout ||
      ((this.timeout = !0),
      setTimeout(() => (this.timeout = !1), 100),
      (this.selected = !0),
      (this.itemBackground.tint = 7864183),
      (this.itemBackground.alpha = 1),
      this.emit(IOItem.SELECT, this.data),
      AudioEffects.ButtonClick.audio.play());
  }
  deselect() {
    this.selected = !1;
    this.itemBackground.tint = 16777215;
    this.itemBackground.alpha = 0.5;
  }
  drawBackground(a, b) {}
}
IOItem.SELECT = "item_select";
var itempicker = {};
class ItemPicker extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.title = a;
    this.type = b;
    this.data = null;
    this.itemTint = 16777215;
    this.prefix = c;
    this.callback = d;
    this.selected = this.timeout = !1;
    this.interactive = this.interactive = this.owned = !0;
    this.hitArea = new PIXI.Rectangle(0, 0, 64, 64);
    this.on("mousedown", () => {
      this.timeout ||
        (this.callback(),
        this.emit(ItemPicker.SELECT, this.type),
        AudioEffects.ButtonClick.audio.play(),
        (this.timeout = !0),
        setTimeout(() => (this.timeout = !1), 100));
    });
    this.on("pointerdown", () => {
      this.timeout ||
        (this.callback(),
        this.emit(ItemPicker.SELECT, this.type),
        AudioEffects.ButtonClick.audio.play(),
        (this.timeout = !0),
        setTimeout(() => (this.timeout = !1), 100));
    });
    this.on("mouseover", () => {
      this.background.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.on("mouseout", () => {
      this.background.alpha = 0.5;
    });
    this.background = new PIXI.Graphics();
    this.draw();
    this.addChild(this.background);
    this.icon = new PIXI.Sprite();
  }
  select() {
    this.selected = !0;
    this.draw();
  }
  deselect() {
    this.selected = !1;
    this.draw();
    this.background.tint = this.owned ? 16777215 : 16711680;
  }
  draw() {
    this.background.clear();
    this.background.alpha = 0.5;
    this.selected || !this.owned
      ? (this.background.lineStyle(3, 16777215, 1, 0), this.background.beginFill(16777215, 0.4))
      : (this.background.lineStyle(1, 16777215, 0.4, 0), this.background.beginFill(16777215, 0.2));
    this.background.drawRoundedRect(0, 0, 64, 64, 4);
    this.background.endFill();
  }
  displayItem(a, b = !0) {
    this.owned = b || a.own;
    this.background.tint = this.owned ? 16777215 : 16763904;
    this.icon.parent && this.removeChild(this.icon);
    b = a.texture;
    this.prefix &&
      0 < this.prefix.length &&
      (b = this.prefix + (0 < a.texture.length ? "_" : "") + b);
    this.icon = new PIXI.Sprite(App.CombinedTextures[b]);
    this.icon.tint = this.itemTint;
    this.icon.anchor.x = this.icon.anchor.y = 0.5;
    this.icon.x = 32;
    this.icon.y = 32;
    this.data = a;
    a =
      void 0 !== this.data.cdata
        ? this.data.cdata
        : "string" === typeof this.data.data
        ? JSON.parse(this.data.data)
        : this.data.data;
    void 0 !== a &&
      (void 0 !== a.r && (this.icon.rotation = a.r),
      void 0 !== a.h && (this.icon.scale.x = this.icon.scale.y = a.h / this.icon.height),
      void 0 !== a.tint && (this.icon.tint = parseInt(a.tint, 16)));
    64 < this.icon.width &&
      64 < this.icon.height &&
      (this.icon.scale.x = this.icon.scale.y = (1 / this.icon.height) * 54);
    "orb" === this.type && (this.icon.tint = this.itemTint);
    this.addChild(this.icon);
  }
  setTint(a) {
    this.itemTint = a;
    this.icon.tint = a;
  }
}
ItemPicker.SELECT = "select";
var colorpicker = {};
function ColorPicker(a) {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.size = a;
  this.barColors = [];
  this.sliceColors = [];
  this.dragSlice = this.dragBar = !1;
  this.barWidth = Math.floor(this.size / 10);
  this.texSlice = this.texBar = null;
  this.barPointer = new PIXI.Graphics();
  this.barPointer.lineStyle(1, 8947848, 1, 0.5, !0);
  this.barPointer.drawRect(0, -3, this.barWidth, 8);
  this.barPointer.lineStyle(1, 15658734, 1, 0.5, !0);
  this.barPointer.drawRect(-1, -4, this.barWidth, 8);
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 1e-4);
  this.background.drawRect(-100, -100, this.size + 100, this.size + 100);
  this.background.endFill();
  this.background.interactive = !0;
  this.addChild(this.background);
  this.colorPointer = new PIXI.Graphics();
  this.colorPointer.lineStyle(1, 8947848, 1, 0.5, !0);
  this.colorPointer.drawRect(-3, -3, 8, 8);
  this.colorPointer.lineStyle(1, 15658734, 1, 0.5, !0);
  this.colorPointer.drawRect(-4, -4, 8, 8);
  this.colorPointer.x = 0;
  this.colorPointer.y = 0;
  this.colorSlice = this.drawColorSlice(16711680);
  this.colorBar = this.drawColorBar();
  this.colorBar.mousedown = this.onColorBarDown.bind(this);
  this.colorBar.mousemove = this.onColorBarMove.bind(this);
  this.colorBar.touchstart = this.onColorBarDown.bind(this);
  this.colorBar.pointermove = this.onColorBarMove.bind(this);
  this.colorBar.x = this.size + 4;
  this.addChild(this.colorSlice);
  this.addChild(this.colorBar);
  this.colorBar.addChild(this.barPointer);
  this.canvas = null;
  this.interactive = !0;
  this.on("mouseout", () => this.onMouseUp());
  this.on("mouseup", () => this.onMouseUp());
}
ColorPicker.prototype = Object.create(PIXI.Container.prototype);
ColorPicker.prototype.constructor = ColorPicker;
ColorPicker.COLOR_SELECTED = "cpColorSelected";
ColorPicker.COLORS = [16711680, 16711935, 255, 65535, 65280, 16776960, 16711680];
ColorPicker.prototype.drawColorSlice = function (a) {
  this.sliceColors = [];
  this.initContext(this.size, this.size);
  var b = this.context.createImageData(this.size, this.size),
    c = b.data,
    d = (a & 16711680) >> 16,
    e = (a & 65280) >> 8;
  a &= 255;
  for (var f, g, h, k, m, l = this.size, p = 0; p < this.size; p++)
    for (var n = 0; n < this.size; n++)
      (m = 4 * (p * l + n)),
        (h = 255 - (255 / l) * n),
        (k = l - p),
        (f = h + (d / l) * n),
        (g = h + (e / l) * n),
        (h += (a / l) * n),
        (c[m] = Math.floor((h / l) * k)),
        (c[m + 1] = Math.floor((g / l) * k)),
        (c[m + 2] = Math.floor((f / l) * k)),
        (c[m + 3] = 255),
        this.sliceColors.push((c[m] << 16) | (c[m + 1] << 8) | c[m + 2]);
  this.context.putImageData(b, 0, 0);
  this.texSlice && this.texSlice.destroy();
  this.texSlice = new PIXI.Texture.from(this.canvas);
  b = new PIXI.Sprite(this.texSlice);
  b.interactive = !0;
  b.buttonMode = !0;
  b.addChild(this.colorPointer);
  b.mousedown = this.onColorSliceDown.bind(this);
  b.mousemove = this.onColorSliceMove.bind(this);
  b.touchstart = this.onColorSliceDown.bind(this);
  b.pointermove = this.onColorSliceMove.bind(this);
  return b;
};
ColorPicker.prototype.drawColorBar = function () {
  this.barColors = [];
  this.initContext(this.barWidth, this.size);
  for (
    var a = this.context.createImageData(this.barWidth, this.size),
      b = a.data,
      c = Math.ceil(this.size / 6),
      d = ColorPicker.COLORS,
      e,
      f,
      g,
      h,
      k,
      m,
      l,
      p = 0;
    p < this.barWidth;
    p++
  )
    for (var n = 0; n < this.size; n++)
      (l = 4 * (n * this.barWidth + p)),
        (m = Math.floor(n / c)),
        (e = (d[m] & 16711680) >> 16),
        (f = (d[m] & 65280) >> 8),
        (g = d[m] & 255),
        (h = (d[(m + 1) % 7] & 16711680) >> 16),
        (k = (d[(m + 1) % 7] & 65280) >> 8),
        (m = d[(m + 1) % 7] & 255),
        (b[l] = g + ((m - g) / c) * (n % c)),
        (b[l + 1] = f + ((k - f) / c) * (n % c)),
        (b[l + 2] = e + ((h - e) / c) * (n % c)),
        (b[l + 3] = 255),
        p || this.barColors.push(0 | (b[l + 2] << 16) | (b[l + 1] << 8) | b[l]);
  this.context.putImageData(a, 0, 0);
  this.texBar && this.texBar.destroy();
  this.texBar = new PIXI.Texture.from(this.canvas);
  a = new PIXI.Sprite(this.texBar);
  a.interactive = !0;
  a.buttonMode = !0;
  return a;
};
ColorPicker.prototype.initContext = function (a, b) {
  this.canvas = document.createElement("canvas");
  this.canvas.width = a;
  this.canvas.height = b;
  this.context = this.canvas.getContext("2d");
};
ColorPicker.prototype.onColorBarDown = function (a) {
  this.getBounds();
  const b = this.toGlobal(new PIXI.Point(this.x, this.y));
  a = Math.floor(a.data.global.y - (b.y - this.y)).clamp(0, this.size - 1);
  this.barPointer.y = a;
  this.updateColorSlice(a);
};
ColorPicker.prototype.onColorBarMove = function (a) {
  if (this.dragBar) {
    const b = this.toGlobal(new PIXI.Point(this.x, this.y));
    a = Math.floor(a.data.global.y - (b.y - this.y)).clamp(0, this.size - 1);
    this.getBounds();
    this.barPointer.y = a;
    this.updateColorSlice(a);
  }
};
ColorPicker.prototype.updateColorSlice = function (a, b) {
  this.dragBar = !0;
  this.colorSlice &&
    (this.colorSlice.removeChild(this.colorPointer), this.removeChild(this.colorSlice));
  this.colorSlice = this.drawColorSlice(a < this.barColors.length ? this.barColors[a] : 16711680);
  this.addChild(this.colorSlice);
  a = this.colorPointer.y * this.size + this.colorPointer.x;
  void 0 === b && this.emit(ColorPicker.COLOR_SELECTED, this.sliceColors[a]);
};
ColorPicker.prototype.onColorSliceDown = function (a) {
  const b = this.toGlobal(new PIXI.Point(this.x, this.y));
  var c = a.data.global.x - (b.x - this.x);
  a = a.data.global.y - (b.y - this.y);
  this.dragSlice = !0;
  c = Math.floor(c).clamp(0, this.size - 1);
  a = Math.floor(a).clamp(0, this.size - 1);
  this.colorPointer.x = c;
  this.colorPointer.y = a;
  this.emit(ColorPicker.COLOR_SELECTED, this.sliceColors[a * this.size + c]);
};
ColorPicker.prototype.onColorSliceMove = function (a) {
  const b = this.toGlobal(new PIXI.Point(this.x, this.y));
  var c = a.data.global.x - (b.x - this.x);
  a = a.data.global.y - (b.y - this.y);
  this.dragSlice &&
    ((c = Math.floor(c).clamp(0, this.size - 1)),
    (a = Math.floor(a).clamp(0, this.size - 1)),
    (this.colorPointer.x = c),
    (this.colorPointer.y = a),
    this.emit(ColorPicker.COLOR_SELECTED, this.sliceColors[a * this.size + c]));
};
ColorPicker.prototype.setSelectedColor = function (a, b, c) {
  var d = this.size / 255,
    e = Math.max(a, b, c),
    f = Math.min(a, b, c);
  c = e === a ? (f === b ? c : b) : f === a ? (c === e ? b : c) : a;
  f = (255 / (0 === e ? 0.001 : e)) * (e - f) * d;
  d *= 255 - e;
  this.colorPointer.x = 511 < Math.floor(f) ? 511 : Math.floor(f);
  this.colorPointer.y = 511 < Math.floor(d) ? 511 : Math.floor(d);
  d = c / e;
  a = Math.ceil(
    (1 / 6) *
      (a === e
        ? b === c
          ? 2 + d
          : 1 - (d - 1)
        : b === e
        ? a === c
          ? 1 - (d - 3)
          : 4 + d
        : b === c
        ? 1 - (d - 5)
        : d) *
      this.size
  );
  this.barPointer.y = a;
  this.updateColorSlice(a, !1);
};
ColorPicker.prototype.onMouseUp = function (a) {
  this.dragSlice = this.dragBar = !1;
};
var purchasepanel = {};
class PurchasePanel extends PIXI.Container {
  constructor() {
    super();
    this.container = new PIXI.Container();
    this.w = 330;
    this.h = 220;
    this.activeItem = null;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.beginFill(0, 0.5);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 0.95);
    this.background.drawRoundedRect(0.5 * (660 - this.w), 0.5 * (524 - this.h), this.w, this.h, 10);
    this.background.endFill();
    this.background.beginFill(4473924, 0.95);
    this.background.drawRoundedRect(
      0.5 * (660 - this.w) + 20,
      0.5 * (524 - this.h) + 36,
      290,
      68,
      6
    );
    this.background.endFill();
    this.background.interactive = !0;
    this.background.hitArea = new PIXI.Rectangle(0, 0, 660, 524);
    this.addChild(this.background);
    this.container.x = 0.5 * (this.background.width - this.w);
    this.container.y = 0.5 * (this.background.height - this.h);
    this.title = new PIXI.Text("Purchase item", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.x = 20;
    this.title.y = 50;
    this.container.addChild(this.title);
    this.itemIcon = new PIXI.Sprite();
    this.itemIcon.x = 40;
    this.itemIcon.y = 80;
    this.itemIcon.anchor.x = this.itemIcon.anchor.y = 0.5;
    this.container.addChild(this.itemIcon);
    this.itemName = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.itemName.x = 100;
    this.itemName.y = 82;
    this.container.addChild(this.itemName);
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = 96;
    this.goldIcon.y = 106;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.5;
    this.container.addChild(this.goldIcon);
    this.itemPrice = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.itemPrice.x = 130;
    this.itemPrice.y = 112;
    this.itemPrice.anchor.x = 0;
    this.container.addChild(this.itemPrice);
    this.currentTitle = new PIXI.Text("Current gold:", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.currentTitle.x = 20;
    this.currentTitle.y = 154;
    this.container.addChild(this.currentTitle);
    this.currentGold = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.currentGold.x = this.currentTitle.x + this.currentTitle.width + 8;
    this.currentGold.y = this.currentTitle.y;
    this.currentGold.anchor.x = 0;
    this.container.addChild(this.currentGold);
    this.remainingTitle = new PIXI.Text("After purchase:", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.remainingTitle.x = 20;
    this.remainingTitle.y = 180;
    this.container.addChild(this.remainingTitle);
    this.remainingGold = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.remainingGold.x = this.remainingTitle.x + this.remainingTitle.width + 8;
    this.remainingGold.y = this.remainingTitle.y;
    this.remainingGold.anchor.x = 0;
    this.container.addChild(this.remainingGold);
    this.purchaseButton = new Button("purchase");
    this.purchaseButton.selected = !0;
    this.purchaseButton.setText("Purchase");
    this.purchaseButton.scale.x = this.purchaseButton.scale.y = 0.8;
    this.purchaseButton.addListener(
      Button.BUTTON_RELEASED,
      this.onPurchaseButtonReleased.bind(this)
    );
    this.purchaseButton.x = 24;
    this.purchaseButton.y = this.h - 8;
    this.purchaseButton.setTint(16763904);
    this.container.addChild(this.purchaseButton);
    this.cancelButton = new Button("cancel");
    this.cancelButton.selected = !0;
    this.cancelButton.setText("Cancel");
    this.cancelButton.scale.x = this.cancelButton.scale.y = 0.8;
    this.cancelButton.addListener(Button.BUTTON_RELEASED, this.onCancelButtonReleased.bind(this));
    this.cancelButton.x = this.w - (this.cancelButton.width + 8);
    this.cancelButton.y = this.h - 8;
    this.container.addChild(this.cancelButton);
    this.addChild(this.container);
    this.successContainer = new PIXI.Graphics();
    this.successContainer.lineStyle(1, 16777215, 0.1, 0);
    this.successContainer.beginFill(3355443, 1);
    this.successContainer.drawRoundedRect(0, 0, this.w, this.h, 10);
    this.successContainer.beginFill(0, 0.3);
    this.successContainer.drawRoundedRect(10, 10, this.w - 20, this.h - 20, 10);
    this.successContainer.endFill();
    this.successContainer.interactive = !0;
    this.successContainer.x = 0.5 * (this.background.width - this.successContainer.width);
    this.successContainer.y = 0.5 * (this.background.height - this.successContainer.height) + 40;
    this.successTitle = new PIXI.Text("Processing transaction..", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 330,
      align: "center",
    });
    this.successTitle.x = 0.5 * this.successContainer.width;
    this.successTitle.y = 0.5 * this.successContainer.height - 60;
    this.successTitle.anchor.x = 0.5;
    this.successTitle.anchor.y = 0.5;
    this.successContainer.addChild(this.successTitle);
    this.successTitleDesc = new PIXI.Text("...", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 330,
      align: "center",
    });
    this.successTitleDesc.x = 0.5 * this.successContainer.width;
    this.successTitleDesc.y = this.successTitle.y + 108;
    this.successTitleDesc.anchor.x = 0.5;
    this.successTitleDesc.anchor.y = 0.5;
    this.successContainer.addChild(this.successTitleDesc);
    this.successContainerItemIcon = new PIXI.Sprite();
    this.successContainerItemIcon.x = 0.5 * this.successContainer.width;
    this.successContainerItemIcon.y = this.successTitle.y + 40;
    this.successContainerItemIcon.anchor.x = this.successContainerItemIcon.anchor.y = 0.5;
    this.successContainer.addChild(this.successContainerItemIcon);
  }
  async display(a) {
    this.activeItem = a;
    this.purchaseButton.disable();
    var b = await APIClient.getCurrency(App.Credential.id);
    b || this.emit(PurchasePanel.CANCEL);
    var c =
      0 < a.prefix.length
        ? a.prefix + (0 < a.data.texture.length ? "_" + a.data.texture : "")
        : a.data.texture;
    this.itemIcon.texture = App.CombinedTextures[c];
    this.successContainerItemIcon.texture = App.CombinedTextures[c];
    b = parseInt(b.currency.gold);
    c = b - parseInt(a.data.price, 10);
    0 <= c
      ? (this.purchaseButton.enable(), (this.remainingGold.tint = 16763904))
      : (this.remainingGold.tint = 16711680);
    this.itemName.text = a.data.title;
    this.itemPrice.text = numberWithPeriods(a.data.price);
    this.currentGold.text = numberWithPeriods(b.toString());
    this.remainingGold.text = numberWithPeriods(c.toString());
    a = 64 / this.itemIcon.width;
    this.itemIcon.x = 56;
    this.itemIcon.y = 110;
    this.itemIcon.scale.x = this.itemIcon.scale.y = 1 < a ? 1 : a;
  }
  onCancelButtonReleased() {
    this.emit(PurchasePanel.CANCEL);
  }
  async onPurchaseButtonReleased() {
    this.successTitle.tint = 16777215;
    this.purchaseButton.disable();
    this.addChild(this.successContainer);
    this.successTitle.text = "Processing transaction..";
    this.successTitleDesc.text = "...";
    (await APIClient.postPurchase("customization", this.activeItem.data.id, App.Credential.id))
      .success
      ? ((this.successTitle.tint = 16763904),
        (this.successTitle.text = "Transaction completed."),
        (this.successTitleDesc.text = "The product has been added to your inventory."))
      : ((this.successTitle.tint = 16711680), (this.successTitle.text = "Transaction failed."));
    setTimeout(() => {
      this.successContainer.parent && this.removeChild(this.successContainer);
      this.emit(PurchasePanel.UPDATE);
    }, 4e3);
  }
}
PurchasePanel.CANCEL = "cancel";
PurchasePanel.UPDATE = "update";
var weaponcontainer = {};
class WeaponContainer extends PIXI.Graphics {
  constructor() {
    super();
    this.title = new PIXI.Text("Coming soon..", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.x = 30;
    this.title.y = 100;
    this.addChild(this.title);
  }
}
var customizationmenu = {};
class CustomizationMenu extends Feature {
  constructor() {
    super();
    this.initial = !0;
    this.customizationPickers = [];
    this.display = CustomizationMenu.PLAYER;
    this.rewardToken = this.selectedItem = null;
    this.goldAnimation = !1;
    this.ox = 16;
    this.oy = 10;
    this.gold = 0;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(8, 8, 644, 508, 10);
    this.background.endFill();
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(1118481, 0.3);
    this.background.drawRect(14, 45, 632, 422, 10);
    this.background.endFill();
    this.container.addChild(this.background);
    this.playerContainer = new PIXI.Container();
    this.container.addChild(this.playerContainer);
    this.weaponContainer = new WeaponContainer();
    this.weaponContainer.visible = !1;
    this.container.addChild(this.weaponContainer);
    this.container.x = -330;
    this.savedText = new PIXI.Text("Customization saved.", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 52224,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.savedText.x = this.width - 340;
    this.savedText.y = this.height - 4;
    this.playerContainer.addChild(this.savedText);
    this.savedText.visible = !1;
    this.customizationTitle = new PIXI.Text("Shop", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.customizationTitle.x = this.ox + 2;
    this.customizationTitle.y = this.oy + 48;
    this.container.addChild(this.customizationTitle);
    this.errorMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 16711680,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.errorMessage.x = this.width - 340;
    this.errorMessage.y = this.height - 4;
    this.playerContainer.addChild(this.errorMessage);
    this.container.x = 0.5 * -this.width;
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = 21;
    this.goldIcon.y = this.height - 10;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.5;
    this.playerContainer.addChild(this.goldIcon);
    this.goldText = new PIXI.Text("loading...", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.goldText.x = 57;
    this.goldText.y = this.goldIcon.y + 6;
    this.playerContainer.addChild(this.goldText);
    this.goldRewardText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.goldRewardText.x = this.goldText.x;
    this.goldRewardText.y = this.goldText.y;
    this.playerContainer.addChild(this.goldRewardText);
    this.goldRewardText.visible = !1;
    this.playerCustomizationButton = new PIXI.Graphics();
    this.playerCustomizationButton.beginFill(16777215, 0.2);
    this.playerCustomizationButton.lineStyle(1, 16777215, 0.1, 0);
    this.playerCustomizationButton.drawRect(0, 0, 100, 28, 4);
    this.playerCustomizationButton.endFill();
    this.playerCustomizationButton.x = this.ox + 112;
    this.playerCustomizationButton.y = this.oy + 48;
    this.playerCustomizationButton.tint = 13421772;
    this.playerCustomizationButton.alpha = 1;
    this.playerCustomizationButton.interactive = !0;
    this.playerCustomizationButton.on("mouseover", () => {
      this.playerCustomizationLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.playerCustomizationButton.on("mouseout", () => {
      this.playerCustomizationLabel.alpha = this.display === CustomizationMenu.PLAYER ? 1 : 0.5;
    });
    this.playerCustomizationButton.on("mousedown", () => {
      this.display = CustomizationMenu.PLAYER;
      this.playerContainer.visible = !0;
      this.weaponContainer.visible = !1;
      this.playerCustomizationLabel.alpha = 1;
      this.weaponCustomizationLabel.alpha = 0.5;
      this.playerCustomizationButton.alpha = 1;
      this.weaponCustomizationButton.alpha = 0.5;
      AudioEffects.ButtonClick.audio.play();
    });
    this.container.addChild(this.playerCustomizationButton);
    this.playerCustomizationLabel = new PIXI.Text("Ninja", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16759552,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.playerCustomizationLabel.alpha = 1;
    this.playerCustomizationLabel.x =
      this.playerCustomizationButton.x +
      0.5 * (this.playerCustomizationButton.width - this.playerCustomizationLabel.width);
    this.playerCustomizationLabel.y = this.playerCustomizationButton.y + 2;
    this.container.addChild(this.playerCustomizationLabel);
    this.weaponCustomizationButton = new PIXI.Graphics();
    this.weaponCustomizationButton.beginFill(16777215, 0.2);
    this.weaponCustomizationButton.lineStyle(1, 16777215, 0.1, 0);
    this.weaponCustomizationButton.drawRect(0, 0, 100, 28, 4);
    this.weaponCustomizationButton.endFill();
    this.weaponCustomizationButton.x =
      this.playerCustomizationButton.x + this.playerCustomizationButton.width + 8;
    this.weaponCustomizationButton.y = this.oy + 48;
    this.weaponCustomizationButton.tint = 13421772;
    this.weaponCustomizationButton.alpha = 0.5;
    this.weaponCustomizationButton.interactive = !0;
    this.weaponCustomizationButton.on("mouseover", () => {
      this.weaponCustomizationLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.weaponCustomizationButton.on("mouseout", () => {
      this.weaponCustomizationLabel.alpha = this.display === CustomizationMenu.WEAPONS ? 1 : 0.5;
    });
    this.weaponCustomizationButton.on("mousedown", () => {
      this.display = CustomizationMenu.WEAPONS;
      this.playerContainer.visible = !1;
      this.weaponContainer.visible = !0;
      this.playerCustomizationLabel.alpha = 0.5;
      this.weaponCustomizationLabel.alpha = 1;
      this.playerCustomizationButton.alpha = 0.5;
      this.weaponCustomizationButton.alpha = 1;
      AudioEffects.ButtonClick.audio.play();
    });
    this.container.addChild(this.weaponCustomizationButton);
    this.weaponCustomizationLabel = new PIXI.Text("Weapons", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16759552,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.weaponCustomizationLabel.alpha = 0.5;
    this.weaponCustomizationLabel.x =
      this.weaponCustomizationButton.x +
      0.5 * (this.weaponCustomizationButton.width - this.weaponCustomizationLabel.width);
    this.weaponCustomizationLabel.y = this.weaponCustomizationButton.y + 2;
    this.container.addChild(this.weaponCustomizationLabel);
    this.submitButton = new Button("save");
    this.submitButton.selected = !0;
    this.submitButton.setText("Save");
    this.submitButton.scale.x = this.submitButton.scale.y = 0.8;
    this.submitButton.addListener(Button.BUTTON_RELEASED, this.onSubmitButtonReleased.bind(this));
    this.submitButton.x = this.width - (this.submitButton.width + 12);
    this.submitButton.y = this.height - 8;
    this.playerContainer.addChild(this.submitButton);
    this.submitButton.disable();
    this.purchaseButton = new Button("purchase");
    this.purchaseButton.selected = !0;
    this.purchaseButton.setText("Buy");
    this.purchaseButton.scale.x = this.purchaseButton.scale.y = 0.8;
    this.purchaseButton.addListener(
      Button.BUTTON_RELEASED,
      this.onPurchaseButtonReleased.bind(this)
    );
    this.purchaseButton.x = this.width - (this.purchaseButton.width + 84);
    this.purchaseButton.y = this.height - 8;
    this.purchaseButton.setTint(16763904);
    this.playerContainer.addChild(this.purchaseButton);
    this.purchaseButton.disable();
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 36;
    this.closeButton.y = this.oy + 40;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.onCancelButtonReleased());
    this.closeButton.mobileSetup();
    this.container.addChild(this.closeButton);
    this.rewardButton = new PIXI.Sprite(App.CombinedTextures.reward_button);
    this.rewardButton.scale.x = this.rewardButton.scale.y = 0.97;
    this.rewardButton.x = this.ox + 133;
    this.rewardButton.y = this.height - 16;
    this.rewardButton.interactive = !0;
    this.playerContainer.addChild(this.rewardButton);
    this.rewardButton.on("mousedown", () => {
      this.onRewardButtonReleased();
    });
    this.rewardButton.on("mouseover", () => {
      this.rewardButton.texture = App.CombinedTextures.reward_button_down;
    });
    this.rewardButton.on("mouseout", () => {
      this.rewardButton.texture = App.CombinedTextures.reward_button;
    });
    this.errorRewardMessage = new PIXI.Text("Disable AdBlock", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 16711680,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.errorRewardMessage.x = this.rewardButton.x;
    this.errorRewardMessage.y = this.rewardButton.y + 14;
    this.errorRewardMessage.visible = !1;
    this.playerContainer.addChild(this.errorRewardMessage);
    this.countdownMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 4,
      lineJoin: "round",
    });
    this.countdownMessage.x = this.errorRewardMessage.x + 10;
    this.countdownMessage.y = this.errorRewardMessage.y;
    this.countdownMessage.visible = !1;
    this.playerContainer.addChild(this.countdownMessage);
    this.visualizer = new Visualizer(176, 176, !0, !0, !1);
    this.visualizer.x = 0.5 * this.width - 0.5 * this.visualizer.width + 140;
    this.visualizer.y = 0.5 * this.height - 0.5 * this.visualizer.height - 11;
    this.visualizer.interactive = !0;
    this.playerContainer.addChild(this.visualizer);
    this.purchasePanel = new PurchasePanel();
    this.purchasePanel.x = 0.5 * this.width - 0.5 * this.purchasePanel.width;
    this.purchasePanel.y = 0.5 * this.height - 0.5 * this.purchasePanel.height;
    this.purchasePanel.on(PurchasePanel.CANCEL, () => {
      this.playerContainer.removeChild(this.purchasePanel);
      this.purchaseButton.enable();
    });
    this.purchasePanel.on(PurchasePanel.UPDATE, () => {
      this.playerContainer.removeChild(this.purchasePanel);
      this.initial = !0;
      this.customization = null;
      this.show();
      this.onCustomizationSelected(this.selectedItem.data);
    });
    this.itemOverview = new ItemOverview();
    this.itemOverview.x = this.ox + 10;
    this.itemOverview.y = this.oy + 78;
    this.playerContainer.addChild(this.itemOverview);
    this.itemOverview.on(ItemOverview.SELECT, (a) => this.onCustomizationSelected(a));
    this.hairPicker = new ItemPicker("Hair style", "hair", "head_alpha", () =>
      this.itemOverview.loadItems(
        App.Customization.HAIR,
        "Hair style",
        this.activeCustomization.hair ? this.activeCustomization.hair.id : 0,
        "head_alpha"
      )
    );
    this.hairPicker.x = this.visualizer.x + 52;
    this.hairPicker.y = this.visualizer.y - 72;
    this.hairPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.hairPicker);
    this.playerContainer.addChild(this.hairPicker);
    this.beltPicker = new ItemPicker("Belt", "belt", "torsolower", () =>
      this.itemOverview.loadItems(
        App.Customization.BELT,
        "Belt",
        this.activeCustomization.belt ? this.activeCustomization.belt.id : 0,
        "torsolower"
      )
    );
    this.beltPicker.x = this.visualizer.x - 72;
    this.beltPicker.y = this.visualizer.y + 182;
    this.beltPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.beltPicker);
    this.playerContainer.addChild(this.beltPicker);
    this.legLeftUpperPicker = new ItemPicker("Right leg", "legleftupper", "legleftupper", () =>
      this.itemOverview.loadItems(
        App.Customization.LEGLEFTUPPER,
        "Right leg",
        this.activeCustomization.legleftupper ? this.activeCustomization.legleftupper.id : 0,
        "legleftupper"
      )
    );
    this.legLeftUpperPicker.x = this.visualizer.x + 12;
    this.legLeftUpperPicker.y = this.visualizer.y + 182;
    this.legLeftUpperPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.legLeftUpperPicker);
    this.playerContainer.addChild(this.legLeftUpperPicker);
    this.legRightUpperPicker = new ItemPicker("Left leg", "legrightupper", "legrightupper", () =>
      this.itemOverview.loadItems(
        App.Customization.LEGRIGHTUPPER,
        "Left leg",
        this.activeCustomization.legrightupper ? this.activeCustomization.legrightupper.id : 0,
        "legrightupper"
      )
    );
    this.legRightUpperPicker.x = this.visualizer.x + 98;
    this.legRightUpperPicker.y = this.visualizer.y + 182;
    this.legRightUpperPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.legRightUpperPicker);
    this.playerContainer.addChild(this.legRightUpperPicker);
    this.legRightLowerPicker = new ItemPicker("Right foot", "legrightlower", "legrightlower", () =>
      this.itemOverview.loadItems(
        App.Customization.LEGRIGHTLOWER,
        "Right foot",
        this.activeCustomization.legrightlower ? this.activeCustomization.legrightlower.id : 0,
        "legleftlower"
      )
    );
    this.legRightLowerPicker.x = this.visualizer.x + 12;
    this.legRightLowerPicker.y = this.visualizer.y + 263;
    this.legRightLowerPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.legRightLowerPicker);
    this.playerContainer.addChild(this.legRightLowerPicker);
    this.legLeftLowerPicker = new ItemPicker("Left foot", "legleftlower", "legleftlower", () =>
      this.itemOverview.loadItems(
        App.Customization.LEGLEFTLOWER,
        "Left foot",
        this.activeCustomization.legleftlower ? this.activeCustomization.legleftlower.id : 0,
        "legrightlower"
      )
    );
    this.legLeftLowerPicker.x = this.visualizer.x + 98;
    this.legLeftLowerPicker.y = this.visualizer.y + 263;
    this.legLeftLowerPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.legLeftLowerPicker);
    this.playerContainer.addChild(this.legLeftLowerPicker);
    this.torsoPicker = new ItemPicker("Torso", "torso", "torsoupper", () =>
      this.itemOverview.loadItems(
        App.Customization.TORSO,
        "Torso",
        this.activeCustomization.torso ? this.activeCustomization.torso.id : 0,
        "torsoupper"
      )
    );
    this.torsoPicker.x = this.visualizer.x + 132;
    this.torsoPicker.y = this.visualizer.y - 72;
    this.torsoPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.torsoPicker);
    this.playerContainer.addChild(this.torsoPicker);
    this.orbPicker = new ItemPicker("Flight aura", "orb", "energy_shell", () =>
      this.itemOverview.loadItems(
        App.Customization.ORB,
        "Flight aura",
        this.activeCustomization.orb ? this.activeCustomization.orb.id : 0,
        "energy_shell"
      )
    );
    this.orbPicker.x = this.visualizer.x + 182;
    this.orbPicker.y = this.visualizer.y + 182;
    this.orbPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a, !0));
    this.customizationPickers.push(this.orbPicker);
    this.playerContainer.addChild(this.orbPicker);
    this.facePicker = new ItemPicker("Face", "face", "face", () =>
      this.itemOverview.loadItems(
        App.Customization.FACE,
        "Face",
        this.activeCustomization.face ? this.activeCustomization.face.id : 0,
        "face"
      )
    );
    this.facePicker.x = this.visualizer.x - 28;
    this.facePicker.y = this.visualizer.y - 72;
    this.facePicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.facePicker);
    this.playerContainer.addChild(this.facePicker);
    this.armRightUpperPicker = new ItemPicker(
      "Left shoulder",
      "armrightupper",
      "armrightupper",
      () =>
        this.itemOverview.loadItems(
          App.Customization.ARMRIGHTUPPER,
          "Left shoulder",
          this.activeCustomization.armrightupper ? this.activeCustomization.armrightupper.id : 0,
          "armrightupper"
        )
    );
    this.armRightUpperPicker.x = this.visualizer.x + 182;
    this.armRightUpperPicker.y = this.visualizer.y + 15;
    this.armRightUpperPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.armRightUpperPicker);
    this.playerContainer.addChild(this.armRightUpperPicker);
    this.armLeftUpperPicker = new ItemPicker("Right shoulder", "armleftupper", "armleftupper", () =>
      this.itemOverview.loadItems(
        App.Customization.ARMLEFTUPPER,
        "Right shoulder",
        this.activeCustomization.armleftupper ? this.activeCustomization.armleftupper.id : 0,
        "armleftupper"
      )
    );
    this.armLeftUpperPicker.x = this.visualizer.x - 72;
    this.armLeftUpperPicker.y = this.visualizer.y + 15;
    this.armLeftUpperPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.armLeftUpperPicker);
    this.playerContainer.addChild(this.armLeftUpperPicker);
    this.armLeftLowerPicker = new ItemPicker("Right hand", "armleftlower", "armleftlower", () =>
      this.itemOverview.loadItems(
        App.Customization.ARMLEFTLOWER,
        "Right hand",
        this.activeCustomization.armleftlower ? this.activeCustomization.armleftlower.id : 0,
        "armleftlower"
      )
    );
    this.armLeftLowerPicker.x = this.visualizer.x - 72;
    this.armLeftLowerPicker.y = this.visualizer.y + 96;
    this.armLeftLowerPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.armLeftLowerPicker);
    this.playerContainer.addChild(this.armLeftLowerPicker);
    this.armRightLowerPicker = new ItemPicker("Left hand", "armrightlower", "armrightlower", () =>
      this.itemOverview.loadItems(
        App.Customization.ARMRIGHTLOWER,
        "Left hand",
        this.activeCustomization.armrightlower ? this.activeCustomization.armrightlower.id : 0,
        "armrightlower"
      )
    );
    this.armRightLowerPicker.x = this.visualizer.x + 182;
    this.armRightLowerPicker.y = this.visualizer.y + 96;
    this.armRightLowerPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.armRightLowerPicker);
    this.playerContainer.addChild(this.armRightLowerPicker);
    this.extraPicker = new ItemPicker("Extra", "extra", "", () =>
      this.itemOverview.loadItems(
        App.Customization.EXTRA,
        "Extra",
        this.activeCustomization.extra ? this.activeCustomization.extra.id : 0,
        ""
      )
    );
    this.extraPicker.x = this.visualizer.x + 182;
    this.extraPicker.y = this.visualizer.y + 263;
    this.extraPicker.on(ItemPicker.SELECT, (a) => this.onSelectCustomization(a));
    this.customizationPickers.push(this.extraPicker);
    this.playerContainer.addChild(this.extraPicker);
    this.colorPicker = new ColorPicker(178);
    this.colorPicker.x = this.orbPicker.x - 532;
    this.colorPicker.y = this.orbPicker.y - 80;
    this.colorPicker.on(ColorPicker.COLOR_SELECTED, (a) => {
      this.orbPicker.setTint(a);
      if (!this.activeCustomization.orb || Array.isArray(this.activeCustomization.orb.data))
        this.activeCustomization.orb = { id: 32, texture: "energy_shell", data: {} };
      this.activeCustomization.orb.data.energy = "0x" + a.toString(16).padStart(6, "0");
      this.submitButton.enabled || this.submitButton.enable();
      this.visualizer.applyCustomization(this.activeCustomization);
    });
    this.customization = null;
    this.particleContainer = new ParticleContainer();
    this.container.addChild(this.particleContainer);
  }
  async show() {
    this.itemOverview.show();
    this.savedText.visible = !1;
    this.activeCustomization = JSON.parse(JSON.stringify(App.Credential.customization));
    if (this.initial) {
      if (!this.customization) {
        var a = await APIClient.getCustomization(App.Credential.id);
        if (!a) return;
        a = JSON.parse(a);
        a = a.customization;
        for (var b in App.Customization) App.Customization[b] = [];
        for (b = 0; b < a.length; b++) {
          const c = a[b],
            d = App.Customization[c.type.toUpperCase()];
          d && d.push(c);
        }
      }
      this.hairPicker.select();
      this.selectedItem = this.hairPicker;
      this.itemOverview.loadItems(
        App.Customization.HAIR,
        "Hair style",
        App.Credential.customization.hair ? App.Credential.customization.hair.id : null,
        "head_alpha"
      );
    }
    this.activeCustomization.hair
      ? this.hairPicker.displayItem(this.activeCustomization.hair)
      : (this.hairPicker.displayItem({ id: 2, texture: "", data: {} }),
        (this.activeCustomization.hair = { id: 2, texture: "", data: {} }));
    this.activeCustomization.orb
      ? this.orbPicker.displayItem(this.activeCustomization.orb)
      : (this.orbPicker.displayItem({ id: 32, texture: "", data: {} }),
        (this.activeCustomization.orb = { id: 32, texture: "", data: {} }));
    this.activeCustomization.torso
      ? this.torsoPicker.displayItem(this.activeCustomization.torso)
      : (this.torsoPicker.displayItem({ id: 33, texture: "", data: {} }),
        (this.activeCustomization.torso = { id: 33, texture: "", data: {} }));
    this.activeCustomization.belt
      ? this.beltPicker.displayItem(this.activeCustomization.belt)
      : (this.beltPicker.displayItem({ id: 68, texture: "", data: {} }),
        (this.activeCustomization.belt = { id: 68, texture: "", data: {} }));
    this.activeCustomization.face
      ? this.facePicker.displayItem(this.activeCustomization.face)
      : (this.facePicker.displayItem({ id: 45, texture: "", data: {} }),
        (this.activeCustomization.face = { id: 45, texture: "", data: {} }));
    this.activeCustomization.armleftlower
      ? this.armLeftLowerPicker.displayItem(this.activeCustomization.armleftlower)
      : (this.armLeftLowerPicker.displayItem({ id: 52, texture: "", data: {} }),
        (this.activeCustomization.armleftlower = { id: 52, texture: "", data: {} }));
    this.activeCustomization.armrightupper
      ? this.armRightUpperPicker.displayItem(this.activeCustomization.armrightupper)
      : (this.armRightUpperPicker.displayItem({ id: 62, texture: "", data: {} }),
        (this.activeCustomization.armrightupper = { id: 62, texture: "", data: {} }));
    this.activeCustomization.armleftupper
      ? this.armLeftUpperPicker.displayItem(this.activeCustomization.armleftupper)
      : (this.armLeftUpperPicker.displayItem({ id: 60, texture: "", data: {} }),
        (this.activeCustomization.armleftupper = { id: 60, texture: "", data: {} }));
    this.activeCustomization.armrightlower
      ? this.armRightLowerPicker.displayItem(this.activeCustomization.armrightlower)
      : (this.armRightLowerPicker.displayItem({ id: 54, texture: "", data: {} }),
        (this.activeCustomization.armrightlower = { id: 54, texture: "", data: {} }));
    this.activeCustomization.legleftlower
      ? this.legLeftLowerPicker.displayItem(this.activeCustomization.legleftlower)
      : (this.legLeftLowerPicker.displayItem({ id: 58, texture: "", data: {} }),
        (this.activeCustomization.legleftlower = { id: 58, texture: "", data: {} }));
    this.activeCustomization.legrightlower
      ? this.legRightLowerPicker.displayItem(this.activeCustomization.legrightlower)
      : (this.legRightLowerPicker.displayItem({ id: 56, texture: "", data: {} }),
        (this.activeCustomization.legrightlower = { id: 56, texture: "", data: {} }));
    this.activeCustomization.legleftupper
      ? this.legLeftUpperPicker.displayItem(this.activeCustomization.legleftupper)
      : (this.legLeftUpperPicker.displayItem({ id: 64, texture: "", data: {} }),
        (this.activeCustomization.legleftupper = { id: 64, texture: "", data: {} }));
    this.activeCustomization.legrightupper
      ? this.legRightUpperPicker.displayItem(this.activeCustomization.legrightupper)
      : (this.legRightUpperPicker.displayItem({ id: 66, texture: "", data: {} }),
        (this.activeCustomization.legrightupper = { id: 66, texture: "", data: {} }));
    this.activeCustomization.extra
      ? this.extraPicker.displayItem(this.activeCustomization.extra)
      : (this.extraPicker.displayItem({ id: 211, texture: "", data: {} }),
        (this.activeCustomization.extra = { id: 211, texture: "", data: {} }));
    this.initial = !1;
    this.visualizer.applyCustomization(this.activeCustomization);
    App.Credential.customization.orb &&
      this.orbPicker.setTint(parseInt(App.Credential.customization.orb.data.energy, 16));
    this.selectedItem && this.selectedItem.data
      ? (this.selectedItem.select(),
        this.itemOverview.select(this.activeCustomization[this.selectedItem.data.type]))
      : (this.selectedItem.select(),
        this.activeCustomization.hair &&
          this.itemOverview.select(this.activeCustomization.hair.id));
    a = await APIClient.getCurrency(App.Credential.id);
    b = a.currency.gold.toString();
    this.gold = parseInt(a.currency.gold);
    this.goldText.text = numberWithPeriods(b);
  }
  hide() {
    this.itemOverview.hide();
  }
  onSelectCustomization(a, b = !1) {
    var c = !1;
    this.colorPicker.parent && (this.removeChild(this.colorPicker), (c = !0));
    b && !c && (this.colorPicker.parent || this.addChild(this.colorPicker));
    for (b = 0; b < this.customizationPickers.length; b++)
      (c = this.customizationPickers[b]),
        a !== c.type ? c.deselect() : (c.select(), (this.selectedItem = c));
  }
  onCustomizationSelected(a) {
    a.own || "free" === a.status
      ? this.submitButton.enabled || (this.submitButton.enable(), this.purchaseButton.disable())
      : (this.submitButton.disable(), this.purchaseButton.enable());
    for (const b of this.customizationPickers) b.type === a.type && b.displayItem(a, !1);
    this.activeCustomization[a.type] || (this.activeCustomization[a.type] = { data: {} });
    this.activeCustomization[a.type].texture = a.texture;
    this.activeCustomization[a.type].id = a.id;
    this.activeCustomization[a.type].cdata =
      "string" === typeof a.data ? JSON.parse(a.data) : a.data;
    this.visualizer.applyCustomization(this.activeCustomization);
  }
  displayPurchasePopup(a) {
    this.purchasePanel.parent || this.playerContainer.addChild(this.purchasePanel);
    this.purchasePanel.display(a);
  }
  reset() {
    this.initial = !0;
  }
  validateForm() {
    return { valid: !0, error: "" };
  }
  async onSubmitButtonReleased() {
    this.savedText.visible = !1;
    this.validateForm();
    this.submitButton.disable();
    this.displayErrorMessage("");
    let a = await APIClient.postCustomization(this.activeCustomization, App.Credential.id);
    a.success
      ? (this.emit(Layer.Events.UPDATE_CREDENTIAL, a.credential), (this.savedText.visible = !0))
      : (this.submitButton.enable(), this.displayErrorMessage("Invalid customization."));
  }
  onPurchaseButtonReleased() {
    this.colorPicker.parent && this.removeChild(this.colorPicker);
    this.purchaseButton.disable();
    this.displayPurchasePopup(this.selectedItem);
  }
  displayLoadingMessage() {}
  displayCompletedMessage() {}
  onCompletedButtonReleased() {}
  onCancelButtonReleased() {
    this.emit(Layer.Events.CUSTOMIZATION_CANCEL);
  }
  onRewardButtonReleased() {
    this.triggerRewardedBreak();
  }
  disableRewardButton() {
    this.rewardButton.interactive = !1;
    this.rewardButton.alpha = 0.5;
  }
  enableRewardButton() {
    this.rewardButton.interactive = !0;
    this.rewardButton.alpha = 1;
  }
  displayLimitReached() {
    this.rewardButton.alpha = 0.2;
    this.rewardButton.interactive = !1;
    this.countdownMessage.visible = !0;
    this.countdownMessage.text = "Daily limit reached.";
  }
  displayRewardCountdown() {
    this.rewardButton.alpha = 0.2;
    this.rewardButton.interactive = !1;
    this.countdownMessage.visible = !0;
    let a = 59;
    this.countdownMessage.text = "Next in.. 60";
    null !== this.rewardInterval &&
      (clearInterval(this.rewardInterval), (this.rewardInterval = null));
    this.rewardInterval = setInterval(() => {
      this.countdownMessage.text = "Next in.. " + a.toString();
      0 >= a &&
        (clearInterval(this.rewardInterval),
        (this.rewardInterval = null),
        (this.countdownMessage.visible = !1),
        (this.countdownMessage.text = ""),
        this.enableRewardButton());
      a--;
    }, 1e3);
  }
  triggerRewardedBreak() {
    this.disableRewardButton();
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.ShowRewardedShopAd = !0;
        App.CrazySDK.requestAd("rewarded");
        break;
      case App.WhiteLabel_POKI:
      case App.WhiteLabel_POKI_MAIN:
        App.PokiSDK.rewardedBreak().then((a) => {
          a ? this.claimRewards() : this.emit(Layer.Events.REWARDS_CLAIMED, !1, 0);
        });
    }
  }
  async claimRewards() {
    let a = await APIClient.postClaimShopReward(App.Credential.id);
    a.success ? this.displayRewardDialog(a.limit ? !0 : !1) : this.displayWarning(a.error);
  }
  displayRewardDialog(a = !1) {
    AudioEffects.GoldPickup[
      Math.floor(Math.random() * AudioEffects.GoldPickup.length)
    ].audio.play();
    this.goldRewardText.alpha = 1;
    this.goldRewardText.visible = !0;
    this.goldRewardText.x = this.goldText.x + 16;
    this.goldRewardText.y = this.goldText.y;
    this.goldAnimation = !0;
    this.goldRewardText.text = "+100";
    this.gold += 100;
    this.goldText.text = numberWithPeriods(this.gold);
    let b = this.goldIcon.x + 0.5 * this.goldIcon.width,
      c = this.goldIcon.y + 0.5 * this.goldIcon.height;
    for (let d = 0; 20 > d; d++) {
      let e = ParticleEffects.GoldGlitter;
      e.x = b;
      e.y = c;
      e.vx = -2 + 4 * Math.random();
      e.vy = -2 + 4 * Math.random();
      e.vr = -0.3 + 0.6 * Math.random();
      e.a = 0.7;
      let f = e.s;
      e.s = 1;
      this.particleContainer.spawn(e);
      e.s = f;
    }
    setTimeout(() => {
      this.goldAnimation = !1;
    }, 3e3);
    a ? this.displayLimitReached() : this.displayRewardCountdown();
  }
  update() {
    this.visualizer.update();
    this.goldAnimation &&
      ((this.goldRewardText.alpha -= 0.01),
      (this.goldRewardText.y -= 0.5),
      0.01 >= this.goldRewardText.alpha && (this.goldAnimation = !1),
      this.particleContainer.update());
  }
  displayWarning(a = "Disable AdBlock") {
    this.errorRewardMessage.visible = !0;
    this.rewardButton.visible = !1;
    this.errorRewardMessage.text = a;
    setTimeout(() => {
      this.errorRewardMessage.visible = !1;
      this.rewardButton.visible = !0;
      this.enableRewardButton();
    }, 3e3);
  }
  displayErrorMessage(a) {
    this.errorMessage.text = a;
  }
}
CustomizationMenu.PLAYER = "player";
CustomizationMenu.WEAPONS = "weapons";
var inputfield = {};
function InputField(a, b, c = 26, d = !0) {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.id = a || "button";
  this.focus = !1;
  this.marker = new PIXI.BitmapText(">", { fontName: "Open Sans", align: "left", fontSize: c });
  this.text = d
    ? new PIXI.BitmapText("", { fontName: "Open Sans", align: "left", fontSize: c })
    : new PIXI.Text("", {
        fontSize: 22,
        fontFamily: "Arial",
        fill: 16777215,
        lineJoin: "round",
        strokeThickness: 3,
        align: "left",
      });
  this.text.tint = 16777215;
  this.text.anchor.y = 1;
  this.passwordText = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    align: "left",
    fontSize: c,
  });
  this.passwordText.anchor.y = 1;
  this.previousText = "";
  this.background = new PIXI.Graphics();
  this.background.alpha = 0.3;
  this.markingColor = 16777215;
  b || this.addChild(this.background);
  this.addChild(this.marker);
  this.addChild(this.text);
  this.addChild(this.passwordText);
  this.minimal = !1;
  this.marker.x = 2;
  this.marker.y = 6;
  this.marker.visible = !1;
  this.marker.tint = 11184810;
  this.text.x = 15 - (26 - c);
  this.text.y = (d ? 30 : 26) - (26 - c);
  this.passwordText.x = 15 - (26 - c);
  this.passwordText.y = (d ? 30 : 26) - (26 - c);
  this.passwordMode = !1;
  this.filterEnabled = !0;
  this.filtered = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
  this.inversed = this.mouseOver = !1;
  this.noMouse = b || !1;
  this.interactive = !this.noMouse;
  this.maxChars = 32;
  this.boundGlobalPointerInputListener = this.boundGlobalInputListener = null;
  this.centerInput = this.forceUpperCase = this.forceLowerCase = !1;
  this.configuredWidth = 100;
  this.configuredHeight = 30;
  this.onInput = async function (e) {
    let f = this.preProcessInput(e);
    if (this.isFiltered(e)) {
      var g = e.data.char;
      if (e.data.code !== UserInput.ENTER) {
        var h = this.text.text;
        e.data.ctrl && "v" === g
          ? navigator.clipboard.readText().then((k) => {
              this.applyInput(k, "", h, e);
            })
          : this.applyInput(f, g, h, e);
      }
    }
  };
  this.applyInput = function (e, f, g, h) {
    0 === e.length && h.data.code === UserInput.BACKSPACE
      ? (this.text.text = "" + f)
      : (e.length >= this.maxChars && (e = e.slice(0, this.maxChars - 1)),
        " " === e && (e = e.slice(0, e.length - 1)),
        " " === f && 0 === e.length && (e = " "),
        (this.text.text =
          e + (this.forceLowerCase ? f.toLowerCase() : this.forceUpperCase ? f.toUpperCase() : f)));
    g !== this.text.text &&
      this.dispatchEvent(new CustomEvent(InputField.CHANGE, { value: this.text.text }));
    this.passwordMode && (this.passwordText.text = "*".repeat(this.text.text.length));
    this.text.scale.x = this.text.scale.y = 1 - 0.006 * this.text.text.length;
    this.passwordMode ||
      (this.text.width + 20 > this.configuredWidth
        ? this.setDimensions(this.text.width + 20, this.configuredHeight, !1)
        : this.setDimensions(this.configuredWidth, this.configuredHeight, !1));
  };
  this.preProcessInput = function (e) {
    var f = this.text.text;
    switch (e.data.code) {
      case UserInput.BACKSPACE:
        0 < f.length && (f = f.slice(0, f.length - 1));
        break;
      case UserInput.ENTER:
        " " === f[0] && (f = f.slice(1)),
          (this.text.text = f),
          this.setFocus(!1),
          this.dispatchEvent(new CustomEvent(InputField.SUBMIT, { value: f }));
    }
    return f;
  };
  this.isFiltered = function (e) {
    return this.filterEnabled
      ? -1 !== this.filtered.indexOf(e.data.char)
        ? !this.inversed
        : !1
      : !0;
  };
  this.setFilter = function (e, f) {
    this.filtered = e;
    this.inversed = f || !1;
  };
  this.onMouseDown = function (e) {
    this.interactive &&
      ((this.mouseOver = !0),
      this.setFocus(!0),
      this.dispatchEvent(new CustomEvent(Button.BUTTON_PRESSED, { id: this.id })),
      AudioEffects.ButtonClick.audio.play());
  };
  this.onGlobalMouseDown = function (e) {
    this.focus && !this.mouseOver && this.setFocus(!1);
  };
  this.setFocus = function (e) {
    (e && UserInput.hasFocus && this.focus) ||
      ((this.focus = e)
        ? (UserInput.setFocus(this.onInput.bind(this)),
          (this.marker.visible = !0),
          UserInput.hasListener(UserInput.KEY_PRESS, this.boundOnInput) ||
            UserInput.addListener(UserInput.KEY_PRESS, this.boundOnInput),
          this.ignoreMouse ||
            null !== this.boundGlobalInputListener ||
            ((this.boundGlobalInputListener = this.onGlobalMouseDown.bind(this)),
            (this.boundGlobalPointerInputListener = this.onGlobalMouseDown.bind(this)),
            App.Renderer.plugins.interaction.on("mousedown", this.boundGlobalInputListener),
            App.Renderer.plugins.interaction.on("touchstart", this.boundGlobalPointerInputListener),
            (this.background.alpha = 0.6)))
        : (UserInput.releaseFocus(this.onInput.bind(this)),
          (this.marker.visible = !1),
          UserInput.hasListener(UserInput.KEY_PRESS, this.boundOnInput) &&
            UserInput.removeListener(UserInput.KEY_PRESS, this.boundOnInput),
          this.ignoreMouse ||
            null === this.boundGlobalInputListener ||
            (App.Renderer.plugins.interaction.removeListener(
              "mousedown",
              this.boundGlobalInputListener
            ),
            App.Renderer.plugins.interaction.removeListener(
              "touchstart",
              this.boundGlobalPointerInputListener
            ),
            (this.boundGlobalPointerInputListener = this.boundGlobalInputListener = null),
            (this.background.alpha = 0.3))),
      e && (this.previousText = this.getText()),
      this.emit(InputField.FOCUS, e));
  };
  this.setPassword = function (e) {
    (this.passwordMode = e)
      ? ((this.text.visible = !1), (this.passwordText.visible = !0))
      : ((this.text.visible = !0), (this.passwordText.visible = !1));
  };
  this.onMouseOver = function (e) {
    this.mouseOver = !0;
    this.background.alpha = this.focus ? 1 : 0.6;
    AudioEffects.ButtonHover.audio.play();
  };
  this.onMouseOut = function (e) {
    this.mouseOver = !1;
    this.background.alpha = this.focus ? 0.6 : 0.3;
  };
  this.setMaxChars = function (e) {
    this.maxChars = e;
  };
  this.setText = function (e) {
    this.previousText = e;
    this.text.text = e;
    this.passwordMode && (this.passwordText.text = "*".repeat(e.length));
    this.text.scale.x = this.text.scale.y = 1 - 0.006 * this.text.text.length;
    this.text.width + 20 > this.configuredWidth
      ? this.setDimensions(this.text.width + 20, this.configuredHeight, !1)
      : this.setDimensions(this.configuredWidth, this.configuredHeight, !1);
  };
  this.getText = function () {
    return this.text.text;
  };
  this.boundOnInput = this.onInput.bind(this);
  this.ignoreMouse ||
    ((this.touchstart = this.mousedown = this.onMouseDown),
    (this.move = this.mouseover = this.onMouseOver),
    (this.pointerup = this.mouseout = this.onMouseOut));
}
InputField.SUBMIT = "submitInput";
InputField.FOCUS = "focusInput";
InputField.CHANGE = "changeInput";
InputField.prototype = Object.create(PIXI.Container.prototype);
InputField.prototype.constructor = InputField;
EventDispatcher.call(InputField.prototype);
InputField.prototype.setDimensions = function (a, b, c = !0) {
  this.ignoreMouse ||
    (c && ((this.configuredWidth = a), (this.configuredHeight = b)),
    this.background.clear(),
    this.minimal || this.background.lineStyle(2, this.markingColor, 1, 0),
    this.background.beginFill(5592405, 1),
    this.background.drawRoundedRect(this.minimal ? 10 : 0, 0, this.minimal ? a - 10 : a, b, 4),
    this.background.endFill(),
    this.centerInput && (this.text.x = 0.5 * (this.width - this.text.width) + 6));
};
InputField.prototype.hideBorders = function () {
  this.minimal = !0;
  this.setDimensions(this.configuredWidth, this.configuredHeight, !1);
};
InputField.prototype.markNone = function () {
  this.markingColor = 16777215;
  this.background.tint = 16777215;
  this.setDimensions(this.configuredWidth, this.configuredHeight, !1);
};
InputField.prototype.markValid = function () {
  this.markingColor = 65280;
  this.background.tint = 65280;
  this.setDimensions(this.configuredWidth, this.configuredHeight, !1);
};
InputField.prototype.markInvalid = function () {
  this.markingColor = 16711680;
  this.background.tint = 16711680;
  this.setDimensions(this.configuredWidth, this.configuredHeight, !1);
};
var socialmenu = {};
class SocialMenu extends Feature {
  constructor() {
    super();
    this.autoCollapsed = this.down = this.dragging = this.collapsed = !1;
    this.friends = [];
    this.friendScrollRatio = 0;
    this.invites = [];
    this.inviteScrollRatio = 0;
    this.members = [];
    this.memberScrollRatio = 0;
    this.clanInvitations = [];
    this.clanInvitationScrollRatio = 0;
    this.autoRefreshFriendsCounter = 60;
    this.ignoreInput = !1;
    this.oy = this.ox = this.friendsLastLoadedDate = 0;
    this.container = new PIXI.Container();
    this.lineStyle(1, 16777215, 0.1, 0);
    this.beginFill(3355443, 0.9);
    this.drawRoundedRect(0, 0, 380, 256, 4);
    this.endFill();
    this.interactive = !0;
    this.listContainer = new PIXI.Container();
    this.scrollbar = new SocialMenuScrollbar(212);
    this.scrollbar.x = 354;
    this.scrollbar.y = 42;
    this.scrollbar.on(SocialMenuScrollbar.SCROLL, (a) => {
      switch (this.mode) {
        case SocialMenu.MODE_FRIENDS:
          this.maskFriendList(a);
          break;
        case SocialMenu.MODE_INVITATIONS:
          this.maskInvitationList(a);
          break;
        case SocialMenu.MODE_CLAN_MEMBERS:
          this.maskMemberList(a);
          break;
        case SocialMenu.MODE_CLAN_INVITATIONS:
          this.maskClanInvitationList(a);
      }
    });
    this.friendsButton = new Button("friends");
    this.friendsButton.setText("Friends");
    this.friendsButton.scale.x = this.friendsButton.scale.y = 0.7;
    this.friendsButton.addListener(Button.BUTTON_RELEASED, this.onFriendsButtonReleased.bind(this));
    this.friendsButton.x = 16;
    this.friendsButton.y = 8;
    this.invitationsButton = new Button("invitations");
    this.invitationsButton.setText("Invitations");
    this.invitationsButton.scale.x = this.invitationsButton.scale.y = 0.7;
    this.invitationsButton.addListener(
      Button.BUTTON_RELEASED,
      this.onInvitationsButtonReleased.bind(this)
    );
    this.invitationsButton.x = this.friendsButton.x + this.friendsButton.width + 6;
    this.invitationsButton.y = 8;
    this.clanButton = new Button("clan");
    this.clanButton.setText("Clan");
    this.clanButton.scale.x = this.clanButton.scale.y = 0.7;
    this.clanButton.addListener(Button.BUTTON_RELEASED, this.onClanButtonReleased.bind(this));
    this.clanButton.x = this.invitationsButton.x + this.invitationsButton.width + 6;
    this.clanButton.y = 8;
    this.clanChatButton = new Button("clan_chat");
    this.clanChatButton.setText("Clan chat");
    this.clanChatButton.scale.x = this.clanChatButton.scale.y = 0.7;
    this.clanChatButton.addListener(
      Button.BUTTON_RELEASED,
      this.onClanChatButtonReleased.bind(this)
    );
    this.clanChatButton.x = this.clanButton.x + this.clanButton.width + 6;
    this.clanChatButton.y = 8;
    this.friendDropdown = new FriendDropdown();
    this.friendDropdown.on(SocialMenu.REFRESH, () => this.refresh());
    this.friendDropdown.on(SocialMenu.SHOW_CHAT, (a) => this.showChat(a));
    this.friendDropdown.on(SocialMenu.SEND_GOLD, (a) => this.showGoldForm(a));
    this.clanDropdown = new SocialMemberDropdown();
    this.clanDropdown.on(SocialMenu.REFRESH, () => this.refresh());
    this.clanDropdown.on(SocialMenu.SHOW_CHAT, (a) => this.showChat(a));
    -1 === parseInt(App.Credential.clan_id) || App.WhiteLabel === App.WhiteLabel_POKI
      ? this.clanChatButton.disable()
      : this.clanChatButton.enable();
    this.friendText = new PIXI.Text(
      "Join a game and right click on a player in the leaderboard to send a friend invitation.",
      {
        fontName: "Arial",
        fontSize: 16,
        lineHeight: 18,
        fill: 13421568,
        strokeThickness: 2,
        lineJoin: "round",
        wordWrap: !0,
        wordWrapWidth: 330,
      }
    );
    this.friendText.x = 10;
    this.friendText.y = 40;
    this.friendText.resolution = 1.5 * App.DevicePixelRatio;
    this.infoText = new PIXI.Text("Right-click friend for more actions.", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 13408512,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.infoText.x = 10;
    this.infoText.y = 234;
    this.infoText.resolution = 1.5 * App.DevicePixelRatio;
    this.infoText.maxWidth = 350;
    this.collapseButton = new PIXI.Sprite(App.CombinedTextures["chat-hide"]);
    this.collapseButton.scale.x = this.collapseButton.scale.y = 0.6;
    this.collapseButton.interactive = !0;
    this.collapseButton.x = 347;
    this.collapseButton.y = 2;
    this.collapseButton.alpha = 0.7;
    this.on("mousedown", (a) => {
      a.stopPropagation();
      this.down = !0;
      this.ox = a.data.global.x / this.parent.scale.x;
      this.oy = a.data.global.y / this.parent.scale.y;
    });
    this.on("mouseup", (a) => {
      a.stopPropagation();
      this.down = this.dragging = !1;
    });
    this.on("mouseupoutside", (a) => {
      a.stopPropagation();
      this.down = this.dragging = !1;
    });
    this.on("mousemove", (a) => {
      if (this.down && !this.ignoreInput) {
        let b = a.data.global.x / this.parent.scale.x;
        a = a.data.global.y / this.parent.scale.y;
        let c = b - this.ox,
          d = a - this.oy;
        this.x += c;
        this.y += d;
        this.ox = b;
        this.oy = a;
        0 < Math.sqrt(c * c + d * d) &&
          ((this.chatWindow.x -= c),
          (this.chatWindow.y -= d),
          (this.goldWindow.x -= c),
          (this.goldWindow.y -= d),
          (this.dragging = !0));
      }
    });
    this.on("mouseover", () => {
      this.collapsed || this.scrollbar.enableWheel();
    });
    this.on("mouseout", () => this.scrollbar.disableWheel());
    this.collapseButton.on("mouseover", (a) => {
      a.stopPropagation();
      this.collapseButton.alpha = 1;
    });
    this.collapseButton.on("mouseout", (a) => {
      a.stopPropagation();
      this.collapseButton.alpha = 0.7;
    });
    this.collapseButton.on("mousedown", (a) => {
      this.down = !0;
      this.ox = a.data.global.x;
      this.oy = a.data.global.y;
      AudioEffects.ButtonClick.audio.play();
    });
    this.collapseButton.on("mouseup", () => this.collapseMenu());
    this.container.addChild(this.infoText);
    this.container.addChild(this.listContainer);
    this.container.addChild(this.invitationsButton);
    this.container.addChild(this.friendsButton);
    this.container.addChild(this.clanButton);
    this.container.addChild(this.clanChatButton);
    this.addChild(this.container);
    this.addChild(this.collapseButton);
    this.chatWindow = new ChatWindow();
    this.chatWindow.on("rightdown", () => {
      this.chatWindow.active = !1;
      this.removeChild(this.chatWindow);
    });
    this.chatWindow.on(ChatWindow.CLOSE, () => {
      this.chatWindow.active = !1;
      this.removeChild(this.chatWindow);
    });
    this.goldWindow = new GoldWindow();
    this.goldWindow.on("rightdown", () => {
      this.goldWindow.active = !1;
      this.removeChild(this.goldWindow);
    });
    this.goldWindow.on(GoldWindow.CLOSE, () => {
      this.goldWindow.active = !1;
      this.removeChild(this.goldWindow);
    });
    this.x = (App.ClientWidth - this.width) / App.Scale;
    this.y =
      600 > App.ClientHeight
        ? (App.ClientHeight - this.height) / App.Scale
        : (600 - this.height) / App.Scale;
    this.loadConversationInterval = null;
    600 > App.ClientHeight && this.collapseMenu();
  }
  repositionForGame() {
    this.y =
      700 > App.ClientHeight
        ? (App.ClientHeight - this.height) / App.Scale
        : (700 - this.height) / App.Scale;
  }
  repositionForMenu() {
    this.y =
      600 > App.ClientHeight
        ? (App.ClientHeight - this.height) / App.Scale
        : (600 - this.height) / App.Scale;
  }
  collapseMenu(a = !1, b = !0) {
    this.autoCollapsed = a;
    this.down = !1;
    if (!this.scrollbar.scrolling)
      if (this.dragging) this.dragging = !1;
      else {
        this.collapsed = !this.collapsed;
        a = this.x;
        var c = this.y;
        this.collapsed
          ? (this.scrollbar.disableWheel(),
            this.clear(),
            (this.x =
              this.x + this.width > 0.5 * App.ClientWidth
                ? App.ClientWidth - (this.width + 22) * App.Scale
                : -(this.width - 22) * App.Scale),
            this.removeChild(this.container),
            (this.collapseButton.alpha = 0.7),
            (this.collapseButton.scale.x = this.collapseButton.scale.y = 0.9),
            (this.collapseButton.texture = App.CombinedTextures.chat))
          : (b && this.scrollbar.enableWheel(),
            this.lineStyle(1, 16777215, 0.1, 0),
            this.beginFill(3355443, 0.9),
            this.drawRoundedRect(0, 0, 380, 256, 4),
            this.endFill(),
            this.addChild(this.container),
            this.setChildIndex(this.collapseButton, this.children.length - 1),
            0 > this.x && (this.x = 0),
            this.y > App.ClientHeight - this.container.height &&
              (this.y = App.ClientHeight - this.container.height),
            (this.collapseButton.scale.x = this.collapseButton.scale.y = 0.6),
            (this.collapseButton.texture = App.CombinedTextures["chat-hide"]),
            (this.collapseButton.alpha = 1));
        this.chatWindow.x += a - this.x;
        this.chatWindow.y += c - this.y;
        this.chatWindow.parent && this.setChildIndex(this.chatWindow, this.children.length - 1);
      }
  }
  maskFriendList(a) {
    let b = Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight);
    if (this.friends.length <= b) this.listContainer.y = 0;
    else {
      this.listContainer.removeChildren();
      this.listContainer.y = -(
        a *
        (this.friends.length * SocialMenu.ItemHeight -
          (SocialMenu.ListHeight - SocialMenu.ItemHeight))
      );
      var c = this.listContainer.y,
        d = Math.round(Math.abs(c / SocialMenu.ItemHeight));
      for (let f = 0; f < b; f++) {
        let g = this.friends[d + f];
        this.listContainer.addChild(g);
        if (0 === f) {
          var e = d * SocialMenu.ItemHeight + c;
          g.alpha = 0 <= e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e);
        } else
          f === b - 1
            ? ((e = d * SocialMenu.ItemHeight + c),
              (g.alpha = 0 > e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e)))
            : (g.alpha = 1);
      }
      this.friendScrollRatio = a;
    }
  }
  maskInvitationList(a) {
    let b = Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight);
    if (this.invites.length <= b) this.listContainer.y = 0;
    else {
      this.listContainer.removeChildren();
      this.listContainer.y = -(
        a *
        (this.invites.length * SocialMenu.ItemHeight -
          (SocialMenu.ListHeight - SocialMenu.ItemHeight))
      );
      var c = this.listContainer.y,
        d = Math.round(Math.abs(c / SocialMenu.ItemHeight));
      for (let f = 0; f < b; f++) {
        let g = this.invites[d + f];
        this.listContainer.addChild(g);
        if (0 === f) {
          var e = d * SocialMenu.ItemHeight + c;
          g.alpha = 0 <= e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e);
        } else
          f === b - 1
            ? ((e = d * SocialMenu.ItemHeight + c),
              (g.alpha = 0 > e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e)))
            : (g.alpha = 1);
      }
      this.inviteScrollRatio = a;
    }
  }
  maskClanInvitationList(a) {
    let b = Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight);
    if (this.clanInvitations.length <= b) this.listContainer.y = 0;
    else {
      this.listContainer.removeChildren();
      this.listContainer.y = -(
        a *
        (this.clanInvitations.length * SocialMenu.ItemHeight -
          (SocialMenu.ListHeight - SocialMenu.ItemHeight))
      );
      var c = this.listContainer.y,
        d = Math.round(Math.abs(c / SocialMenu.ItemHeight));
      for (let f = 0; f < b; f++) {
        let g = this.clanInvitations[d + f];
        this.listContainer.addChild(g);
        if (0 === f) {
          var e = d * SocialMenu.ItemHeight + c;
          g.alpha = 0 <= e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e);
        } else
          f === b - 1
            ? ((e = d * SocialMenu.ItemHeight + c),
              (g.alpha = 0 > e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e)))
            : (g.alpha = 1);
      }
      this.clanInvitationScrollRatio = a;
    }
  }
  maskMemberList(a) {
    let b = Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight);
    if (this.members.length <= b) this.listContainer.y = 0;
    else {
      this.listContainer.removeChildren();
      this.listContainer.y = -(
        a *
        (this.members.length * SocialMenu.ItemHeight -
          (SocialMenu.ListHeight - SocialMenu.ItemHeight))
      );
      var c = this.listContainer.y,
        d = Math.round(Math.abs(c / SocialMenu.ItemHeight));
      for (let f = 0; f < b; f++) {
        let g = this.members[d + f];
        this.listContainer.addChild(g);
        if (0 === f) {
          var e = d * SocialMenu.ItemHeight + c;
          g.alpha = 0 <= e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e);
        } else
          f === b - 1
            ? ((e = d * SocialMenu.ItemHeight + c),
              (g.alpha = 0 > e ? 1 : 1 - (1 / (0.5 * SocialMenu.ItemHeight)) * Math.abs(e)))
            : (g.alpha = 1);
      }
      this.memberScrollRatio = a;
    }
  }
  async refresh() {
    switch (this.mode) {
      case SocialMenu.MODE_FRIENDS:
        this.loadFriends();
        break;
      case SocialMenu.MODE_INVITATIONS:
        this.loadInvitations();
        break;
      case SocialMenu.MODE_CLAN_MEMBERS:
        this.loadClanMembers();
        break;
      case SocialMenu.MODE_CLAN_INVITATIONS:
        this.loadClanInvitations();
    }
  }
  async loadConversations() {
    var a = await APIClient.getMessages(App.Credential.id);
    if ((a = JSON.parse(a)))
      ChatWindow.UpdateConversations(a),
        this.chatWindow.active && this.chatWindow.loadConversation();
  }
  async loadFriends(a = !1) {
    var b = Date.now();
    if (
      !(2e3 > b - this.friendsLastLoadedDate) &&
      ((this.friendsLastLoadedDate = b),
      this.friendsButton.setTint(16763904),
      this.invitationsButton.setTint(16777215),
      this.clanButton.setTint(16777215),
      (this.mode = SocialMenu.MODE_FRIENDS),
      this.friendsButton.disable(),
      (this.friendsButton.interactive = !0),
      (b = await APIClient.getFriends(App.Credential.id)),
      !1 !== b.success)
    ) {
      this.friends = [];
      b = JSON.parse(b);
      this.friendsButton.enable();
      this.listContainer.removeChildren();
      if (b.friends) {
        this.friendText.parent && this.container.removeChild(this.friendText);
        for (let c = 0; c < b.friends.length; c++) {
          const d = b.friends[c];
          let e = new FriendItem(d.id, d.name, d.seen, d.clan_id);
          e.x = 10;
          e.y = 47 + c * SocialMenu.ItemHeight;
          e.on(SocialMenu.REFRESH, () => this.refresh());
          e.on(SocialMenu.ACCESS_PROFILE, (f) => this.emit(Layer.Events.USER_ACCESS, f));
          e.on(SocialMenu.SHOW_FRIEND_DROPDOWN, () => this.showFriendDropdown(d.id, e));
          this.friends.push(e);
          this.friends.length <= Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight) &&
            this.listContainer.addChild(e);
          void 0 === SocialMenu.Friends[d.id] &&
            (SocialMenu.Friends[d.id] = { name: d.name, seen: d.seen });
        }
        b.friends.length > Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight)
          ? this.container.addChild(this.scrollbar)
          : this.container.removeChild(this.scrollbar);
        null === this.loadConversationInterval &&
          (this.loadConversationInterval = setInterval(() => {
            0 < this.friends.length && this.loadConversations();
            this.autoRefreshFriendsCounter--;
            0 >= this.autoRefreshFriendsCounter &&
              (this.collapsed || this.down || this.friendDropdown.parent || this.loadFriends(),
              (this.autoRefreshFriendsCounter = SocialMenu.AutoRefreshFriends));
          }, 4e4));
      } else
        this.container.addChild(this.friendText),
          this.container.removeChild(this.scrollbar),
          null !== this.loadConversationInterval &&
            (clearInterval(this.loadConversationInterval), (this.loadConversationInterval = null));
      this.friendDropdown.parent && this.container.removeChild(this.friendDropdown);
      a && ((this.friendScrollRatio = 0), this.scrollbar.reset());
      this.maskFriendList(this.friendScrollRatio);
    }
  }
  async loadInvitations(a = !1) {
    this.friendText.parent && this.container.removeChild(this.friendText);
    this.friendsButton.setTint(16777215);
    this.invitationsButton.setTint(16763904);
    this.clanButton.setTint(16777215);
    this.mode = SocialMenu.MODE_INVITATIONS;
    this.invitationsButton.disable();
    this.invitationsButton.interactive = !0;
    var b = await APIClient.getInvitations(App.Credential.id);
    if (!1 !== b.success) {
      b = JSON.parse(b);
      this.invites = [];
      this.invitationsButton.enable();
      this.listContainer.removeChildren();
      if (b.invitations) {
        for (let d = 0; d < b.invitations.length; d++) {
          var c = b.invitations[d];
          c = new AcceptInvitationItem(c.id, c.userId, c.name);
          c.x = 10;
          c.y = 40 + d * SocialMenu.ItemHeight;
          c.on(SocialMenu.REFRESH, () => this.refresh());
          c.on(SocialMenu.ACCESS_PROFILE, (e) => this.emit(Layer.Events.USER_ACCESS, e));
          this.invites.push(c);
          this.invites.length <= Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight) &&
            this.listContainer.addChild(c);
        }
        b.invitations.length > Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight)
          ? this.container.addChild(this.scrollbar)
          : this.container.removeChild(this.scrollbar);
      } else this.container.removeChild(this.scrollbar);
      this.friendDropdown.parent && this.container.removeChild(this.friendDropdown);
      a && ((this.inviteScrollRatio = 0), this.scrollbar.reset());
      this.maskInvitationList(this.inviteScrollRatio);
    }
  }
  showFriendDropdown(a, b) {
    this.friendDropdown.id === a && this.friendDropdown.parent
      ? this.container.removeChild(this.friendDropdown)
      : ((this.friendDropdown.id = a),
        (this.friendDropdown.name = b.name),
        this.friendDropdown.update({
          clanInvite:
            null !== b.clan ||
            -1 === parseInt(App.Credential.clan_id) ||
            ("captain" !== App.Credential.clan_role && "leader" !== App.Credential.clan_role)
              ? !1
              : !0,
        }),
        this.container.addChild(this.friendDropdown),
        (this.friendDropdown.x = b.x),
        (this.friendDropdown.y = b.y + b.parent.y + b.height));
  }
  showClanDropdown(a, b) {
    this.clanDropdown.id === a && this.clanDropdown.parent
      ? this.container.removeChild(this.clanDropdown)
      : ((this.clanDropdown.id = a),
        (this.clanDropdown.name = b.name),
        this.container.addChild(this.clanDropdown),
        (this.clanDropdown.x = b.x),
        (this.clanDropdown.y = b.y + b.parent.y + b.height));
  }
  showGoldForm(a) {
    this.goldWindow.load(a);
    this.goldWindow.active = !0;
    this.goldWindow.x = -10;
    this.goldWindow.y = 30;
    this.addChild(this.goldWindow);
    this.setChildIndex(this.goldWindow, this.children.length - 1);
    this.friendDropdown.parent && this.container.removeChild(this.friendDropdown);
  }
  showChat(a, b) {
    this.chatWindow.loadConversation(a);
    this.chatWindow.active = !0;
    this.chatWindow.x = this.x < 0.5 * App.ClientWidth ? 0 : -20;
    this.chatWindow.y = 36;
    this.addChild(this.chatWindow);
    this.setChildIndex(this.chatWindow, this.children.length - 1);
    this.friendDropdown.parent && this.container.removeChild(this.friendDropdown);
  }
  async loadInvitees() {
    this.mode = SocialMenu.MODE_INVITEES;
    !1 !== (await APIClient.getInvitees(App.Credential.id)).success &&
      this.listContainer.removeChildren();
  }
  async loadClanMembers(a = !1) {
    this.friendText.parent && this.container.removeChild(this.friendText);
    this.friendsButton.setTint(16777215);
    this.invitationsButton.setTint(16777215);
    this.clanButton.setTint(16763904);
    this.mode = SocialMenu.MODE_CLAN_MEMBERS;
    this.clanButton.disable();
    this.clanButton.interactive = !0;
    const b = await APIClient.getClanMembers(App.Credential.clan_id);
    if (!1 !== b.success) {
      this.members = [];
      this.clanButton.enable();
      this.listContainer.removeChildren();
      if (b.members) {
        0 < b.members.length && App.WhiteLabel !== App.WhiteLabel_POKI
          ? this.clanChatButton.enable()
          : this.clanChatButton.disable();
        for (let c = 0; c < b.members.length; c++) {
          const d = b.members[c],
            e = new ClanMemberItem(d.id, d.name, d.role);
          e.x = 10;
          e.y = 40 + c * SocialMenu.ItemHeight;
          e.on(SocialMenu.REFRESH, () => this.refresh());
          e.on(SocialMenu.ACCESS_PROFILE, (f) => this.emit(Layer.Events.USER_ACCESS, f));
          if (SocialMenu.Friends[d.id])
            e.on(SocialMenu.SHOW_CLAN_DROPDOWN, () => this.showClanDropdown(d.id, e));
          this.members.push(e);
          this.members.length <= Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight) &&
            this.listContainer.addChild(e);
        }
        b.members.length > Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight)
          ? this.container.addChild(this.scrollbar)
          : this.container.removeChild(this.scrollbar);
      } else this.container.removeChild(this.scrollbar);
      this.friendDropdown.parent && this.container.removeChild(this.friendDropdown);
      a && ((this.memberScrollRatio = 0), this.scrollbar.reset());
      this.maskMemberList(this.memberScrollRatio);
    }
  }
  async loadClanInvitations(a = !1) {
    this.friendText.parent && this.container.removeChild(this.friendText);
    this.friendsButton.setTint(16777215);
    this.invitationsButton.setTint(16777215);
    this.clanButton.setTint(16763904);
    this.mode = SocialMenu.MODE_CLAN_INVITATIONS;
    this.clanButton.disable();
    this.clanButton.interactive = !0;
    const b = await APIClient.getClanInvitations(App.Credential.id);
    if (!1 !== b.success) {
      this.clanInvitations = [];
      this.clanButton.enable();
      this.listContainer.removeChildren();
      if (b.invitations) {
        for (let d = 0; d < b.invitations.length; d++) {
          var c = b.invitations[d];
          c = new AcceptClanInvitationItem(c.clan_id, c.clan_name, c.initiator_name);
          c.x = 10;
          c.y = 40 + d * SocialMenu.ItemHeight;
          c.on(SocialMenu.REFRESH, () => this.refresh());
          c.on(Layer.Events.JOIN_CLAN, () => this.emit(Layer.Events.JOIN_CLAN));
          this.clanInvitations.push(c);
          this.clanInvitations.length <=
            Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight) &&
            this.listContainer.addChild(c);
        }
        b.invitations.length > Math.floor(SocialMenu.ListHeight / SocialMenu.ItemHeight)
          ? this.container.addChild(this.scrollbar)
          : this.container.removeChild(this.scrollbar);
      } else this.container.removeChild(this.scrollbar);
      this.friendDropdown.parent && this.container.removeChild(this.friendDropdown);
      a && ((this.clanInvitationScrollRatio = 0), this.scrollbar.reset());
      this.maskClanInvitationList(this.clanInvitationScrollRatio);
    }
  }
  onInvitationsButtonReleased() {
    this.loadInvitations(!0);
  }
  onFriendsButtonReleased() {
    this.loadFriends(!0);
  }
  onClanButtonReleased() {
    -1 !== parseInt(App.Credential.clan_id)
      ? this.loadClanMembers(!0)
      : this.loadClanInvitations(!0);
  }
  onClanChatButtonReleased() {
    this.emit(Layer.Events.CLAN_CHAT_ACCESS);
  }
  show() {
    this.loadFriends();
  }
  hide() {
    null !== this.loadConversationInterval &&
      (clearInterval(this.loadConversationInterval), (this.loadConversationInterval = null));
    this.scrollbar.disableWheel();
  }
  update() {}
  collapse() {
    this.collapsed = !0;
    this.resize();
    this.scrollbar.disableWheel();
  }
  expand() {
    this.collapsed = !1;
    this.resize();
  }
  resize(a, b) {
    this.parent &&
      ((this.x = this.collapsed ? (a - 400) / App.Scale : (a - this.width) / App.Scale),
      this.y + this.height > b && (this.y = (b - this.height) / App.Scale));
  }
}
SocialMenu.REFRESH = "refresh";
SocialMenu.ACCESS_PROFILE = "access_profile";
SocialMenu.MODE_INVITATIONS = "invitations";
SocialMenu.MODE_INVITEES = "invitees";
SocialMenu.MODE_FRIENDS = "friends";
SocialMenu.MODE_CLAN_INVITATIONS = "clan_invitations";
SocialMenu.MODE_CLAN_MEMBERS = "clan_members";
SocialMenu.SHOW_FRIEND_DROPDOWN = "show_dropdown";
SocialMenu.SHOW_CLAN_DROPDOWN = "show_clan_dropdown";
SocialMenu.SHOW_CHAT = "show_chat";
SocialMenu.SEND_GOLD = "send_gold";
SocialMenu.MODE_GAME = !1;
SocialMenu.Friends = {};
SocialMenu.AutoRefreshFriends = 10;
SocialMenu.ListHeight = 208;
SocialMenu.ItemHeight = 30;
class FriendItem extends PIXI.Graphics {
  constructor(a, b, c, d) {
    super();
    this.id = a;
    this.name = b;
    this.seen = new Date(Date.parse(c) - 6e4 * new Date().getTimezoneOffset());
    this.clan = d;
    this.beginFill(16777215, 0.15);
    this.drawRoundedRect(0, 0, 340, 26, 4);
    this.endFill();
    this.interactive = !0;
    this.tint = 12303291;
    this.on("mouseover", () => {
      this.tint = 16777215;
    });
    this.on("mouseout", () => {
      this.tint = 12303291;
    });
    this.on("mousedown", () => this.emit(SocialMenu.ACCESS_PROFILE, this.id));
    this.on("rightdown", () => this.emit(SocialMenu.SHOW_FRIEND_DROPDOWN, this.id));
    30 > Math.round((Date.now() - this.seen.getTime()) / 1e3)
      ? this.beginFill(65280, 1)
      : this.beginFill(8947848, 1);
    this.drawCircle(320, 13, 8);
    this.endFill();
    this.nameLabel = new PIXI.BitmapText(this.name, { fontName: "Open Sans", fontSize: 22 });
    this.nameLabel.x = 8;
    this.nameLabel.y = 2;
    this.addChild(this.nameLabel);
  }
}
class ClanMemberItem extends PIXI.Graphics {
  constructor(a, b, c) {
    super();
    this.id = a;
    this.name = b;
    this.role = c;
    this.isFriend = !1;
    SocialMenu.Friends[this.id]
      ? ((this.isFriend = !0),
        (this.seen = new Date(
          Date.parse(SocialMenu.Friends[this.id].seen) - 6e4 * new Date().getTimezoneOffset()
        )))
      : (this.seen = this.id === App.Credential.playerid ? new Date() : new Date(0));
    this.beginFill(16777215, 0.15);
    this.drawRoundedRect(0, 0, 340, 26, 4);
    this.endFill();
    this.interactive = !0;
    this.tint = 12303291;
    this.on("mouseover", () => {
      this.tint = 16777215;
    });
    this.on("mouseout", () => {
      this.tint = 12303291;
    });
    this.on("mousedown", () => this.emit(SocialMenu.ACCESS_PROFILE, this.id));
    this.on("rightdown", () => this.emit(SocialMenu.SHOW_CLAN_DROPDOWN, this.id));
    30 > Math.round((Date.now() - this.seen.getTime()) / 1e3)
      ? this.beginFill(65280, 1)
      : this.beginFill(8947848, 1);
    this.drawCircle(320, 13, 8);
    this.endFill();
    this.nameLabel = new PIXI.BitmapText(this.name, { fontName: "Open Sans", fontSize: 22 });
    this.nameLabel.x = 8;
    this.nameLabel.y = 2;
    this.addChild(this.nameLabel);
    this.isFriend && (this.nameLabel.tint = 12320699);
    if ("captain" === this.role || "leader" === this.role)
      (this.roleLabel = new PIXI.BitmapText(this.role, {
        fontName: "Open Sans",
        fontSize: 22,
        align: "left",
      })),
        (this.roleLabel.x = 300 - this.roleLabel.width),
        (this.roleLabel.y = 2),
        (this.roleLabel.tint = "leader" === this.role ? 8978312 : 16746632),
        this.addChild(this.roleLabel);
  }
}
class AcceptClanInvitationItem extends PIXI.Graphics {
  constructor(a, b, c) {
    super();
    this.id = a;
    this.clanName = b;
    this.initiatorName = c;
    this.beginFill(16777215, 0.15);
    this.drawRoundedRect(0, 0, 340, 26, 4);
    this.endFill();
    this.interactive = !0;
    this.tint = 12303291;
    this.on("mouseover", () => {
      this.tint = 16777215;
    });
    this.on("mouseout", () => {
      this.tint = 12303291;
    });
    this.nameLabel = new PIXI.BitmapText(this.clanName + " by " + this.initiatorName, {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.nameLabel.x = 8;
    this.nameLabel.y = 2;
    this.addChild(this.nameLabel);
    this.acceptButton = new Button("accept");
    this.acceptButton.setText("Accept");
    this.acceptButton.scale.x = this.acceptButton.scale.y = 0.55;
    this.acceptButton.addListener(Button.BUTTON_RELEASED, this.onAccept.bind(this));
    this.acceptButton.x = 225;
    this.acceptButton.y = 3;
    this.acceptButton.setTint(8978312);
    this.addChild(this.acceptButton);
    this.cancelButton = new Button("decline");
    this.cancelButton.setText("Decline");
    this.cancelButton.scale.x = this.cancelButton.scale.y = 0.55;
    this.cancelButton.addListener(Button.BUTTON_RELEASED, this.onDecline.bind(this));
    this.cancelButton.x = 287;
    this.cancelButton.y = 3;
    this.cancelButton.setTint(16746632);
    this.addChild(this.cancelButton);
  }
  async onAccept() {
    this.acceptButton.disable();
    !1 !== (await APIClient.postAcceptInviteMember(this.id, App.Credential.id)).success &&
      (this.acceptButton.enable(),
      this.emit(Layer.Events.JOIN_CLAN),
      this.emit(SocialMenu.REFRESH));
  }
  async onDecline() {
    this.cancelButton.disable();
    !1 !== (await APIClient.postDeclineInviteMember(this.id, App.Credential.id)).success &&
      (this.cancelButton.enable(), this.emit(SocialMenu.REFRESH));
  }
}
class AcceptInvitationItem extends PIXI.Graphics {
  constructor(a, b, c) {
    super();
    this.id = a;
    this.name = c;
    this.userId = b;
    this.beginFill(16777215, 0.2);
    this.drawRoundedRect(0, 0, 340, 26, 4);
    this.endFill();
    this.interactive = !0;
    this.tint = 12303291;
    this.on("mouseover", () => {
      this.tint = 16777215;
    });
    this.on("mouseout", () => {
      this.tint = 12303291;
    });
    this.on("mousedown", () => this.emit(SocialMenu.ACCESS_PROFILE, b));
    this.nameLabel = new PIXI.BitmapText(this.name, { fontName: "Open Sans", fontSize: 22 });
    this.nameLabel.x = 8;
    this.nameLabel.y = 2;
    this.addChild(this.nameLabel);
    this.acceptButton = new Button("accept");
    this.acceptButton.setText("Accept");
    this.acceptButton.scale.x = this.acceptButton.scale.y = 0.55;
    this.acceptButton.addListener(Button.BUTTON_RELEASED, this.onAccept.bind(this));
    this.acceptButton.x = 225;
    this.acceptButton.y = 3;
    this.acceptButton.setTint(8978312);
    this.addChild(this.acceptButton);
    this.cancelButton = new Button("decline");
    this.cancelButton.setText("Decline");
    this.cancelButton.scale.x = this.cancelButton.scale.y = 0.55;
    this.cancelButton.addListener(Button.BUTTON_RELEASED, this.onDecline.bind(this));
    this.cancelButton.x = 287;
    this.cancelButton.y = 3;
    this.cancelButton.setTint(16746632);
    this.addChild(this.cancelButton);
  }
  async onAccept() {
    this.acceptButton.disable();
    !1 !== (await APIClient.postAcceptFriend(this.userId, App.Credential.id)).success &&
      (this.acceptButton.enable(), this.emit(SocialMenu.REFRESH));
  }
  async onDecline() {
    this.cancelButton.disable();
    !1 !== (await APIClient.postDeclineFriend(this.userId, App.Credential.id)).success &&
      (this.cancelButton.enable(), this.emit(SocialMenu.REFRESH));
  }
}
class SocialMenuScrollbar extends PIXI.Graphics {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.bh = this.h - 39;
    this.oy = 0;
    this.alpha = 0.5;
    this.lineStyle(1, 16777215, 0.8, 0);
    this.drawRoundedRect(0, -5, 20, this.h, 4);
    this.endFill();
    this.interactive = !0;
    this.hitArea = new PIXI.Rectangle(-10, -4, 32, this.h);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, -3, 16, 35, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = this.bh * this.start;
    this.on("mouseover", () => {
      this.alpha = 0.8;
    });
    this.on("mouseout", () => {
      this.alpha = 0.5;
    });
    this.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.ExclusiveWheel = this.wheelListener;
  }
  disableWheel() {
    UserInput.ExclusiveWheel = null;
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      b = 0 > b ? 0 : b > this.bh ? this.bh : b;
      let c = (1 / this.h) * b * (this.h / this.bh);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(SocialMenuScrollbar.SCROLL, c);
    }
  }
  reset() {
    this.scrollButton.y = (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
SocialMenuScrollbar.SCROLL = "scroll";
class FriendDropdown extends PIXI.Container {
  constructor() {
    super();
    this.id = null;
    this.background = new PIXI.Graphics();
    this.messageRow = new FriendDropdownActionRow(
      "Message",
      FriendDropdown.Action.MESSAGE,
      16777215
    );
    this.messageRow.on(FriendDropdownActionRow.SELECT, () =>
      this.emit(SocialMenu.SHOW_CHAT, this.id)
    );
    this.unfriendRow = new FriendDropdownActionRow(
      "Unfriend",
      FriendDropdown.Action.UNFRIEND,
      11141120,
      !0
    );
    this.unfriendRow.on(FriendDropdownActionRow.CONFIRM, () => this.onUnfriend());
    this.goldRow = new FriendDropdownActionRow(
      "Send gold",
      FriendDropdown.Action.SEND_GOLD,
      16763904
    );
    this.goldRow.on(FriendDropdownActionRow.SELECT, () => this.emit(SocialMenu.SEND_GOLD, this.id));
    this.clanRow = new FriendDropdownActionRow(
      "Invite to clan",
      FriendDropdown.Action.CLAN_INVITE,
      5635925
    );
    this.clanRow.on(FriendDropdownActionRow.SELECT, () => this.onInviteToClan());
    this.messageRow.x = 10;
    this.messageRow.y = 4;
    this.goldRow.x = 10;
    this.goldRow.y = 34;
    this.unfriendRow.x = 10;
    this.unfriendRow.y = 64;
    this.clanRow.x = 10;
    this.clanRow.y = 64;
    this.addChild(this.background);
    App.WhiteLabel !== App.WhiteLabel_POKI && this.addChild(this.messageRow);
    this.addChild(this.goldRow);
    this.addChild(this.unfriendRow);
    this.update();
  }
  update(a) {
    this.background.clear();
    this.background.lineStyle(1, 16777215, 0.4, 0.3);
    this.background.beginFill(5592405, 0.9);
    a && a.clanInvite
      ? (this.clanRow.parent || this.addChild(this.clanRow),
        this.background.drawRoundedRect(0, 0, 128, 130, 4),
        (this.unfriendRow.y = 94))
      : (this.clanRow.parent && this.removeChild(this.clanRow),
        this.background.drawRoundedRect(0, 0, 110, 94, 4),
        (this.unfriendRow.y = 64));
    this.background.endFill();
  }
  async onUnfriend() {
    (await APIClient.postUnfriend(this.id, App.Credential.id)) && this.emit(SocialMenu.REFRESH);
  }
  async onInviteToClan() {
    let a = await APIClient.postInviteMember(this.id, App.Credential.id);
    a
      ? !1 === a.success
        ? App.Console.log(a.error)
        : (App.Console.log("Clan invitation sent."), this.emit(SocialMenu.REFRESH))
      : App.Console.log("Unable to send clan invitation.");
  }
}
FriendDropdown.Action = {
  MESSAGE: "message",
  SEND_GOLD: "send_gold",
  UNFRIEND: "unfriend",
  CLAN_INVITE: "clanInvite",
};
class FriendDropdownActionRow extends PIXI.Container {
  constructor(a, b, c, d = !1) {
    super();
    this.text = a;
    this.tintValue = c;
    this.actionText = new PIXI.BitmapText(this.text, { fontName: "Open Sans", fontSize: 24 });
    this.confirmation = d;
    this.confirming = !1;
    this.interactive = !0;
    this.hitArea = new PIXI.Rectangle(0, 0, 100, 30);
    this.actionText.tint = this.tintValue;
    this.actionText.alpha = 0.7;
    this.on("mouseover", () => {
      this.actionText.alpha = 1;
    });
    this.on("mouseout", () => {
      this.actionText.alpha = 0.7;
      this.confirmation && ((this.confirming = !1), (this.actionText.text = this.text));
    });
    this.on("mousedown", () => {
      this.confirmation
        ? this.confirming
          ? this.emit(FriendDropdownActionRow.CONFIRM)
          : ((this.actionText.text = "Confirm?"), (this.confirming = !0))
        : this.emit(FriendDropdownActionRow.SELECT);
    });
    this.addChild(this.actionText);
  }
}
FriendDropdownActionRow.CONFIRM = "confirm";
FriendDropdownActionRow.SELECT = "select";
class SocialMemberDropdown extends PIXI.Container {
  constructor() {
    super();
    this.id = null;
    this.background = new PIXI.Graphics();
    this.background.lineStyle(1, 16777215, 0.4, 0);
    this.background.beginFill(5592405, 0.9);
    this.background.drawRoundedRect(0, 0, 110, 32, 4);
    this.background.endFill();
    this.messageRow = new SocialMemberDropdownActionRow(
      "Message",
      SocialMemberDropdown.Action.MESSAGE,
      16777215
    );
    this.messageRow.on(SocialMemberDropdownActionRow.SELECT, () =>
      this.emit(SocialMenu.SHOW_CHAT, this.id)
    );
    this.messageRow.x = 10;
    this.messageRow.y = 4;
    this.addChild(this.background);
    App.WhiteLabel !== App.WhiteLabel_POKI && this.addChild(this.messageRow);
  }
  async onUnfriend() {
    (await APIClient.postUnfriend(this.id, App.Credential.id)) && this.emit(SocialMenu.REFRESH);
  }
}
SocialMemberDropdown.Action = { MESSAGE: "message" };
class SocialMemberDropdownActionRow extends PIXI.Container {
  constructor(a, b, c, d = !1) {
    super();
    this.text = a;
    this.tintValue = c;
    this.actionText = new PIXI.BitmapText(this.text, { fontName: "Open Sans", fontSize: 24 });
    this.confirmation = d;
    this.confirming = !1;
    this.interactive = !0;
    this.hitArea = new PIXI.Rectangle(0, 0, 100, 30);
    this.actionText.tint = this.tintValue;
    this.actionText.alpha = 0.7;
    this.on("mouseover", () => {
      this.actionText.alpha = 1;
    });
    this.on("mouseout", () => {
      this.actionText.alpha = 0.7;
      this.confirmation && ((this.confirming = !1), (this.actionText.text = this.text));
    });
    this.on("mousedown", () => {
      this.confirmation
        ? this.confirming
          ? this.emit(SocialMemberDropdownActionRow.CONFIRM)
          : ((this.actionText.text = "Confirm?"), (this.confirming = !0))
        : this.emit(SocialMemberDropdownActionRow.SELECT);
    });
    this.addChild(this.actionText);
  }
}
SocialMemberDropdownActionRow.CONFIRM = "confirm";
SocialMemberDropdownActionRow.SELECT = "select";
class GoldWindow extends PIXI.Container {
  constructor() {
    super();
    this.id = null;
    this.dragging = this.active = !1;
    this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.lineStyle(1, 16777215, 0.1);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRoundedRect(0, 0, 170, 110, 4);
    this.background.endFill();
    this.addChild(this.background);
    this.on("mousedown", (a) => {
      this.dragging = !0;
      this.ox = a.data.global.x;
      this.oy = a.data.global.y;
    });
    this.on("mouseup", () => {
      this.dragging = !1;
      this.parent.ignoreInput = !1;
    });
    this.on("mouseupoutside", () => {
      this.dragging = !1;
      this.parent.ignoreInput = !1;
    });
    this.on("mousemove", (a) => {
      if (this.dragging) {
        var b = a.data.global.x;
        a = a.data.global.y;
        var c = a - this.oy;
        this.x += b - this.ox;
        this.y += c;
        this.ox = b;
        this.oy = a;
        this.parent && (this.parent.ignoreInput = !0);
      }
    });
    this.title = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      multiline: !0,
      align: "center",
    });
    this.title.x = 4;
    this.title.y = 3;
    this.title.tint = 16763904;
    this.errorMsg = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 22 });
    this.errorMsg.x = 0.5 * this.background.width;
    this.errorMsg.y = 82;
    this.errorMsg.anchor.x = 0.5;
    this.errorMsg.tint = 16746496;
    this.inputField = new InputField("gold_value");
    this.inputField.setDimensions(80, 30);
    this.inputField.forceLowerCase = !1;
    this.inputField.setMaxChars(4);
    this.inputField.x = 0.5 * (this.background.width - this.inputField.width);
    this.inputField.y = 48;
    this.inputField.setFilter(UserInput.NUMERIC);
    this.inputField.addListener(InputField.SUBMIT, (a) => this.onSubmitGold(a.data.value));
    this.addChild(this.background);
    this.addChild(this.title);
    this.addChild(this.errorMsg);
    this.addChild(this.inputField);
  }
  load(a) {
    this.id = a;
    this.title.text = "Send gold to " + SocialMenu.Friends[this.id].name + "\n(max 1000/hour)";
    this.errorMsg.text = "";
    this.inputField.setText("0");
  }
  async onSubmitGold(a) {
    a = parseInt(a, 10);
    1e3 < a && (this.errorMsg.text = "1000 is the maximum.");
    const b = await APIClient.postFriendGold(this.id, a, App.Credential.id);
    b &&
      (b.success
        ? (this.inputField.setText("0"), (this.errorMsg.text = a + " gold sent"))
        : (this.errorMsg.text = b.error));
  }
}
class ChatWindow extends PIXI.Graphics {
  constructor() {
    super();
    this.id = null;
    this.dragging = !1;
    this.interactive = !0;
    this.active = !1;
    this.convo = null;
    this.messages = [];
    this.oy = this.ox = 0;
    this.lineStyle(1, 16777215, 0.1);
    this.beginFill(3355443, 0.9);
    this.drawRoundedRect(0, 0, 400, 220, 4);
    this.endFill();
    this.on("mousedown", (a) => {
      this.dragging = !0;
      this.ox = a.data.global.x;
      this.oy = a.data.global.y;
    });
    this.on("mouseup", () => {
      this.dragging = !1;
      this.parent.ignoreInput = !1;
    });
    this.on("mouseupoutside", () => {
      this.dragging = !1;
      this.parent.ignoreInput = !1;
    });
    this.on("mousemove", (a) => {
      if (this.dragging) {
        var b = a.data.global.x;
        a = a.data.global.y;
        var c = a - this.oy;
        this.x += b - this.ox;
        this.y += c;
        this.ox = b;
        this.oy = a;
        this.parent && (this.parent.ignoreInput = !0);
      }
    });
    this.title = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 22 });
    this.title.x = 4;
    this.title.y = 3;
    this.title.tint = 16763904;
    this.scrollbar = new SocialMenuScrollbar(186, 1);
    this.scrollbar.x = 378;
    this.scrollbar.y = 8;
    this.closeButton = new PIXI.Sprite(App.CombinedTextures.exit);
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.alpha = 0.5;
    this.closeButton.interactive = !0;
    this.closeButton.x = this.width - 28;
    this.closeButton.y = 2;
    this.closeButton.on("mousedown", (a) => {
      this.closeButton.alpha = 0.5;
      this.emit(ChatWindow.CLOSE);
    });
    this.closeButton.on("mouseover", (a) => {
      this.closeButton.alpha = 1;
    });
    this.closeButton.on("mouseout", (a) => {
      this.closeButton.alpha = 0.5;
    });
    this.inputField = new InputField("chat_msg");
    this.inputField.setDimensions(400, 30);
    this.inputField.forceLowerCase = !1;
    this.inputField.setMaxChars(72);
    this.inputField.x = 0;
    this.inputField.y = this.height - 30;
    this.inputField.setFilter(
      UserInput.ALPHANUMERIC + UserInput.CHAT_SYMBOLS + UserInput.ALPHA_EXT
    );
    this.inputField.addListener(InputField.SUBMIT, (a) => this.onSubmitMessage(a.data.value));
    for (let a = 0; a < ChatWindow.MaxMessages; a++) {
      const b = new PIXI.BitmapText("", {
        fontName: "Open Sans",
        fontSize: 22,
        multiline: !0,
        align: "left",
      });
      b.maxWidth = 360;
      b.interactive = !1;
      b.hitArea = new PIXI.Rectangle(0, 0, 0, 0);
      this.addChild(b);
      this.messages.push(b);
    }
    this.addChild(this.title);
    this.addChild(this.inputField);
    this.addChild(this.closeButton);
  }
  async onSubmitMessage(a) {
    const b = await APIClient.postFriendMessage(this.id, a, App.Credential.id);
    this.inputField.setText("");
    SocialMenu.MODE_GAME || this.inputField.setFocus(!0);
    b.success
      ? ChatWindow.PutMessage({ target: this.id, message: a, created: Date.now() }, !0)
      : ChatWindow.PutMessage(
          { target: this.id, message: b.error, created: Date.now(), error: !0 },
          !0
        );
    this.loadConversation();
  }
  loadConversation(a) {
    void 0 !== a && (this.id = a);
    this.title.text = "Messaging " + SocialMenu.Friends[this.id].name;
    this.convo =
      void 0 === ChatWindow.Conversations[this.id]
        ? (ChatWindow.Conversations[this.id] = { messages: [] })
        : ChatWindow.Conversations[this.id];
    a = 0;
    for (let b = ChatWindow.MaxMessages - 1; 0 <= b; b--) {
      const c = this.convo.messages[b],
        d = this.messages[b];
      c
        ? ((d.text =
            (c.own ? (c.error ? "Error: " : "You: ") : SocialMenu.Friends[this.id].name + ": ") +
            c.text),
          (a += d.height + 4),
          (d.x = 8),
          (d.y = 192 - a),
          (d.tint = c.own ? (c.error ? 16711680 : 13434828) : 13421823),
          (d.alpha = 16 > d.y ? 0 : 1))
        : (d.text = "");
    }
  }
}
ChatWindow.Conversations = {};
ChatWindow.CLOSE = "close";
ChatWindow.PutMessage = (a, b) => {
  let c = ChatWindow.Conversations[a.target];
  void 0 === c && (c = ChatWindow.Conversations[a.target] = { messages: [] });
  c.messages.length === ChatWindow.MaxMessages && c.messages.shift();
  c.messages.push({ own: b, text: a.message, created: a.created, error: a.error ? !0 : !1 });
  b ||
    ("1" === a.system
      ? App.Console.log("[SYS] " + a.message, 16763904)
      : App.Console.log("[PM] " + SocialMenu.Friends[a.target].name + ": " + a.message, 3407667));
};
ChatWindow.UpdateConversations = (a) => {
  for (let b = 0; b < a.messages.length; b++) ChatWindow.PutMessage(a.messages[b], !1);
};
ChatWindow.MaxMessages = 8;
var imgbutton = {};
class ImgButton extends PIXI.Sprite {
  constructor(a = ImgButton.TYPE_CLOSE, b = !0) {
    let c = null;
    switch (a) {
      case ImgButton.TYPE_CLOSE:
        c = App.CombinedTextures.exit;
    }
    super(c);
    this.type = a;
    this.enabled = b;
    this.interactive = !0;
    this.alpha = this.enabled ? 0.7 : 0.4;
    this.on("mouseover", () => this.onMouseOver());
    this.on("mouseout", () => this.onMouseOut());
    this.on("mousedown", () => this.onMouseDown());
    this.on("touchstart", () => this.onMouseDown());
  }
  mobileSetup() {
    App.IsMobile &&
      this.type === ImgButton.TYPE_CLOSE &&
      ((this.scale.x = this.scale.y *= 1.4), (this.x -= 10), (this.y -= 2));
  }
  onMouseOver() {
    this.enabled && ((this.alpha = 1), AudioEffects.ButtonHover.audio.play());
  }
  onMouseDown() {
    this.enabled &&
      ((this.alpha = 0.7), this.emit(ImgButton.CLICK), AudioEffects.ButtonClick.audio.play());
  }
  onMouseOut() {
    this.enabled && (this.alpha = 0.7);
  }
  setEnabled(a) {
    this.alpha = (this.enabled = a) ? 0.7 : 0.4;
  }
}
ImgButton.TYPE_CLOSE = "close";
ImgButton.CLICK = "click";
var rankingmenu = {};
class RankingMenu extends Feature {
  constructor() {
    super();
    this.lastRefresh = 0;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.container.addChild(this.background);
    this.ox = 40;
    this.oy = 20;
    this.display = RankingMenu.GLOBAL_RANKING;
    this.titleText = new PIXI.Text("Ranking & statistics", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.titleText.x = 0.5 * this.width - 20;
    this.titleText.y = this.oy + 36;
    this.titleText.anchor.x = 0.5;
    this.container.addChild(this.titleText);
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.RANKING_CANCEL));
    this.container.addChild(this.closeButton);
    this.globalRankingButton = new PIXI.Graphics();
    this.globalRankingButton.lineStyle(1, 16777215, 0.1, 0);
    this.globalRankingButton.beginFill(16777215, 0.2);
    this.globalRankingButton.drawRect(0, 0, 130, 24, 4);
    this.globalRankingButton.endFill();
    this.globalRankingButton.x = 0.5 * this.background.width - 220;
    this.globalRankingButton.y = this.oy + 68;
    this.globalRankingButton.tint = 13421772;
    this.globalRankingButton.alpha = 0.5;
    this.globalRankingButton.interactive = !0;
    this.globalRankingButton.on("mouseover", () => {
      this.globalRankingLabel.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.globalRankingButton.on("mouseout", () => {
      this.globalRankingLabel.alpha = this.display === RankingMenu.GLOBAL_RANKING ? 1 : 0.5;
    });
    this.globalRankingButton.on("mousedown", () => this.displayGlobalRanking());
    this.globalRankingButton.on("touchstart", () => this.displayGlobalRanking());
    this.container.addChild(this.globalRankingButton);
    this.globalRankingLabel = new PIXI.Text("Experience", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16759552,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.globalRankingLabel.alpha = 0.7;
    this.globalRankingLabel.x =
      this.globalRankingButton.x +
      0.5 * (this.globalRankingButton.width - this.globalRankingLabel.width);
    this.globalRankingLabel.y = this.globalRankingButton.y + 1;
    this.container.addChild(this.globalRankingLabel);
    this.skillRankingButton = new PIXI.Graphics();
    this.skillRankingButton.lineStyle(1, 16777215, 0.1, 0);
    this.skillRankingButton.beginFill(16777215, 0.2);
    this.skillRankingButton.drawRect(0, 0, 130, 24, 4);
    this.skillRankingButton.endFill();
    this.skillRankingButton.x = this.globalRankingButton.x + this.globalRankingButton.width + 8;
    this.skillRankingButton.y = this.globalRankingButton.y;
    this.skillRankingButton.tint = 13421772;
    this.skillRankingButton.alpha = 1;
    this.skillRankingButton.interactive = !0;
    this.skillRankingButton.on("mouseover", () => {
      this.skillRankingLabel.alpha = 1;
    });
    this.skillRankingButton.on("mouseout", () => {
      this.skillRankingLabel.alpha = this.display === RankingMenu.SKILL_RANKING ? 1 : 0.5;
    });
    this.skillRankingButton.on("mousedown", () => this.displaySkillRanking());
    this.skillRankingButton.on("touchstart", () => this.displaySkillRanking());
    this.container.addChild(this.skillRankingButton);
    this.skillRankingLabel = new PIXI.Text("Skill", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16759552,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.skillRankingLabel.alpha = 1;
    this.skillRankingLabel.x =
      this.skillRankingButton.x +
      0.5 * (this.skillRankingButton.width - this.skillRankingLabel.width);
    this.skillRankingLabel.y = this.skillRankingButton.y + 1;
    this.container.addChild(this.skillRankingLabel);
    this.weaponStatsButton = new PIXI.Graphics();
    this.weaponStatsButton.lineStyle(1, 16777215, 0.1, 0);
    this.weaponStatsButton.beginFill(16777215, 0.2);
    this.weaponStatsButton.drawRect(0, 0, 130, 24, 4);
    this.weaponStatsButton.endFill();
    this.weaponStatsButton.x = this.skillRankingButton.x + this.skillRankingButton.width + 8;
    this.weaponStatsButton.y = this.skillRankingButton.y;
    this.weaponStatsButton.tint = 13421772;
    this.weaponStatsButton.alpha = 0.5;
    this.weaponStatsButton.interactive = !0;
    this.weaponStatsButton.on("mouseover", () => {
      this.weaponStatsLabel.alpha = 1;
    });
    this.weaponStatsButton.on("mouseout", () => {
      this.weaponStatsLabel.alpha = this.display === RankingMenu.WEAPON_STATS ? 1 : 0.5;
    });
    this.weaponStatsButton.on("mousedown", () => this.displayWeaponStats());
    this.weaponStatsButton.on("touchstart", () => this.displayWeaponStats());
    this.container.addChild(this.weaponStatsButton);
    this.weaponStatsLabel = new PIXI.Text("Weapons", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16759552,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.weaponStatsLabel.alpha = 0.5;
    this.weaponStatsLabel.x =
      this.weaponStatsButton.x + 0.5 * (this.weaponStatsButton.width - this.weaponStatsLabel.width);
    this.weaponStatsLabel.y = this.weaponStatsButton.y + 1;
    this.container.addChild(this.weaponStatsLabel);
    this.globalRankingContainer = new PIXI.Container();
    this.skillRankingContainer = new PIXI.Container();
    this.weaponStatsContainer = new PIXI.Container();
    this.weaponTypeContainer = new PIXI.Container();
    this.nameText = new PIXI.Text("Name", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.nameText.x = this.ox + 66;
    this.nameText.y = this.oy + 104;
    this.globalRankingContainer.addChild(this.nameText);
    this.levelText = new PIXI.Text("Level", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelText.x = this.ox + 246;
    this.levelText.y = this.oy + 104;
    this.globalRankingContainer.addChild(this.levelText);
    this.experienceText = new PIXI.Text("Experience", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.experienceText.x = this.ox + 366;
    this.experienceText.y = this.oy + 104;
    this.globalRankingContainer.addChild(this.experienceText);
    this.socialGlText = new PIXI.Text("Channels", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.socialGlText.x = this.ox + 506;
    this.socialGlText.y = this.oy + 104;
    this.globalRankingContainer.addChild(this.socialGlText);
    this.globalRankingTableContainerMask = new PIXI.Graphics();
    this.globalRankingTableContainerMask.beginFill(16777215, 1);
    this.globalRankingTableContainerMask.drawRect(-10, 150, 640, 390);
    this.globalRankingTableContainerMask.endFill();
    this.globalRankingTableContainerMask.x = 10;
    this.globalRankingContainer.addChild(this.globalRankingTableContainerMask);
    this.globalRankingTableContainer = new PIXI.Container();
    this.globalRankingTableContainer.x = 10;
    this.globalRankingTableContainer.mask = this.globalRankingTableContainerMask;
    this.globalRankingContainer.addChild(this.globalRankingTableContainer);
    this.globalRanking = new GlobalRankingScrollbar(404);
    this.globalRanking.x = 625;
    this.globalRanking.y = 150;
    this.globalRankingContainer.addChild(this.globalRanking);
    this.globalRanking.on(GlobalRankingScrollbar.SCROLL, (a) => {
      this.globalRankingTableContainer.height > this.globalRankingTableContainerMask.height &&
        (this.globalRankingTableContainer.y = -(
          a *
          (this.globalRankingTableContainer.height - this.globalRankingTableContainerMask.height)
        ));
    });
    this.nameSkillText = new PIXI.Text("Name", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.nameSkillText.x = this.ox + 66;
    this.nameSkillText.y = this.oy + 104;
    this.skillRankingContainer.addChild(this.nameSkillText);
    this.skillTitleText = new PIXI.Text("Title", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillTitleText.x = this.ox + 270;
    this.skillTitleText.y = this.oy + 104;
    this.skillRankingContainer.addChild(this.skillTitleText);
    this.skillText = new PIXI.Text("Skill", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillText.x = this.ox + 410;
    this.skillText.y = this.oy + 104;
    this.skillRankingContainer.addChild(this.skillText);
    this.socialText = new PIXI.Text("Channels", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.socialText.x = this.ox + 506;
    this.socialText.y = this.oy + 104;
    this.skillRankingContainer.addChild(this.socialText);
    this.skillRankingTableContainerMask = new PIXI.Graphics();
    this.skillRankingTableContainerMask.beginFill(16777215, 1);
    this.skillRankingTableContainerMask.drawRect(-10, 150, 640, 390);
    this.skillRankingTableContainerMask.endFill();
    this.skillRankingTableContainerMask.x = 10;
    this.skillRankingContainer.addChild(this.skillRankingTableContainerMask);
    this.skillRankingTableContainer = new PIXI.Container();
    this.skillRankingTableContainer.x = 10;
    this.skillRankingTableContainer.mask = this.skillRankingTableContainerMask;
    this.skillRankingContainer.addChild(this.skillRankingTableContainer);
    this.skillRanking = new SkillRankingScrollbar(404);
    this.skillRanking.x = 625;
    this.skillRanking.y = 150;
    this.skillRankingContainer.addChild(this.skillRanking);
    this.skillRanking.on(SkillRankingScrollbar.SCROLL, (a) => {
      this.skillRankingTableContainer.height > this.skillRankingTableContainerMask.height &&
        (this.skillRankingTableContainer.y = -(
          a *
          (this.skillRankingTableContainer.height - this.skillRankingTableContainerMask.height)
        ));
    });
    this.weaponTypeText = new PIXI.Text("Weapon type", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponTypeText.x = this.ox - 4;
    this.weaponTypeText.y = this.oy + 104;
    this.weaponStatsContainer.addChild(this.weaponTypeText);
    this.weaponKillsText = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponKillsText.x = this.ox + 390;
    this.weaponKillsText.y = this.oy + 104;
    this.weaponStatsContainer.addChild(this.weaponKillsText);
    this.weaponStatsTableContainerMask = new PIXI.Graphics();
    this.weaponStatsTableContainerMask.beginFill(16777215, 1);
    this.weaponStatsTableContainerMask.drawRect(-10, 150, 640, 390);
    this.weaponStatsTableContainerMask.endFill();
    this.weaponStatsTableContainerMask.x = 10;
    this.weaponStatsContainer.addChild(this.weaponStatsTableContainerMask);
    this.weaponStatsTableContainer = new PIXI.Container();
    this.weaponStatsTableContainer.x = 10;
    this.weaponStatsTableContainer.mask = this.weaponStatsTableContainerMask;
    this.weaponStatsContainer.addChild(this.weaponStatsTableContainer);
    this.weaponStats = new WeaponStatsScrollbar(404);
    this.weaponStats.x = 625;
    this.weaponStats.y = 150;
    this.weaponStatsContainer.addChild(this.weaponStats);
    this.weaponStats.on(WeaponStatsScrollbar.SCROLL, (a) => {
      this.weaponStatsTableContainer.height > this.weaponStatsTableContainerMask.height &&
        (this.weaponStatsTableContainer.y = -(
          a *
          (this.weaponStatsTableContainer.height - this.weaponStatsTableContainerMask.height)
        ));
    });
    this.weaponTypeIcon = null;
    this.weaponTypeLabel = new PIXI.Text("loading...", {
      fontName: "Arial",
      fontSize: 20,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponTypeLabel.x = this.ox + 280;
    this.weaponTypeLabel.y = this.oy + 110;
    this.weaponTypeContainer.addChild(this.weaponTypeLabel);
    this.weaponTypeNameText = new PIXI.Text("Name", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponTypeNameText.x = this.ox + 70;
    this.weaponTypeNameText.y = this.oy + 150;
    this.weaponTypeContainer.addChild(this.weaponTypeNameText);
    this.weaponTypeKillsText = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.weaponTypeKillsText.x = this.ox + 390;
    this.weaponTypeKillsText.y = this.oy + 150;
    this.weaponTypeContainer.addChild(this.weaponTypeKillsText);
    this.weaponTypeTableContainerMask = new PIXI.Graphics();
    this.weaponTypeTableContainerMask.beginFill(16777215, 1);
    this.weaponTypeTableContainerMask.drawRect(-10, 200, 640, 350);
    this.weaponTypeTableContainerMask.endFill();
    this.weaponTypeTableContainerMask.x = 10;
    this.weaponTypeContainer.addChild(this.weaponTypeTableContainerMask);
    this.weaponTypeTableContainer = new PIXI.Container();
    this.weaponTypeTableContainer.x = 10;
    this.weaponTypeTableContainer.y = 50;
    this.weaponTypeTableContainer.mask = this.weaponTypeTableContainerMask;
    this.weaponTypeContainer.addChild(this.weaponTypeTableContainer);
    this.weaponType = new WeaponTypeStatsScrollbar(354);
    this.weaponType.x = 625;
    this.weaponType.y = 200;
    this.weaponTypeContainer.addChild(this.weaponType);
    this.weaponType.on(WeaponTypeStatsScrollbar.SCROLL, (a) => {
      this.weaponTypeTableContainer.height > this.weaponTypeTableContainerMask.height &&
        (this.weaponTypeTableContainer.y =
          -(a * (this.weaponTypeTableContainer.height - this.weaponTypeTableContainerMask.height)) +
          50);
    });
    this.container.x = 0.5 * -this.width;
    this.displaySkillRanking();
  }
  onCloseButtonReleased() {
    this.emit(Layer.Events.RANKING_CANCEL);
  }
  async show() {
    this.globalRanking.disableWheel();
    this.skillRanking.disableWheel();
    this.weaponStats.disableWheel();
    this.weaponType.disableWheel();
    switch (this.display) {
      case RankingMenu.GLOBAL_RANKING:
        this.globalRanking.enableWheel();
        break;
      case RankingMenu.SKILL_RANKING:
        this.skillRanking.enableWheel();
        break;
      case RankingMenu.WEAPON_STATS:
        this.weaponStats.enableWheel();
        break;
      case RankingMenu.WEAPON_USERS:
        this.weaponType.enableWheel();
    }
    var a = Date.now();
    if (
      !(6e4 > a - this.lastRefresh) &&
      ((this.lastRefresh = a),
      (a = await APIClient.getRanking()),
      a.success && a.level_ranking && a.skill_ranking)
    ) {
      this.globalRankingTableContainer.removeChildren();
      for (var b = 0; b < a.level_ranking.length; b++) {
        const d = a.level_ranking[b];
        var c = new GlobalRankingTableRow(b, d.id, d.name, d.level, d.experience, d.tw, d.yt);
        c.x = this.ox + 20;
        c.y = this.oy + 36 * b + 130;
        c.on("mousedown", () => {
          this.emit(Layer.Events.USER_ACCESS, d.account_id, !1);
          AudioEffects.ButtonClick.audio.play();
        });
        c.on("touchstart", () => {
          this.emit(Layer.Events.USER_ACCESS, d.account_id, !1);
          AudioEffects.ButtonClick.audio.play();
        });
        this.globalRankingTableContainer.addChild(c);
      }
      this.skillRankingTableContainer.removeChildren();
      for (b = 0; b < a.skill_ranking.length; b++) {
        const d = a.skill_ranking[b];
        c = new SkillRankingTableRow(
          b,
          d.id,
          d.name,
          Game.MapSkillToTitle(d.skill),
          d.skill,
          d.yt,
          d.tw
        );
        c.x = this.ox + 20;
        c.y = this.oy + 36 * b + 130;
        c.on("mousedown", () => {
          this.emit(Layer.Events.USER_ACCESS, d.account_id, !1);
          AudioEffects.ButtonClick.audio.play();
        });
        c.on("touchstart", () => {
          this.emit(Layer.Events.USER_ACCESS, d.account_id, !1);
          AudioEffects.ButtonClick.audio.play();
        });
        this.skillRankingTableContainer.addChild(c);
      }
      a = await APIClient.getWeaponRanking();
      if (a.success && a.ranking)
        for (this.weaponStatsTableContainer.removeChildren(), b = 0; b < a.ranking.length; b++) {
          const d = a.ranking[b];
          c = new WeaponStatsTableRow(b, d.id, d.kills);
          c.x = this.ox - 20;
          c.y = this.oy + 42 * b + 130;
          c.on("mousedown", () => {
            this.displayWeaponUsers(d.id);
            AudioEffects.ButtonClick.audio.play();
          });
          c.on("touchstart", () => {
            this.displayWeaponUsers(d.id);
            AudioEffects.ButtonClick.audio.play();
          });
          this.weaponStatsTableContainer.addChild(c);
        }
    }
  }
  hide() {
    this.globalRanking.disableWheel();
    this.skillRanking.disableWheel();
    this.weaponStats.disableWheel();
    this.weaponType.disableWheel();
  }
  displayGlobalRanking() {
    this.globalRanking.enableWheel();
    this.skillRanking.disableWheel();
    this.weaponStats.disableWheel();
    this.weaponType.disableWheel();
    AudioEffects.ButtonClick.audio.play();
    this.globalRankingContainer.parent || this.container.addChild(this.globalRankingContainer);
    this.weaponStatsContainer.parent && this.container.removeChild(this.weaponStatsContainer);
    this.weaponTypeContainer.parent && this.container.removeChild(this.weaponTypeContainer);
    this.skillRankingContainer.parent && this.container.removeChild(this.skillRankingContainer);
    this.globalRankingButton.alpha = 1;
    this.globalRankingLabel.alpha = 1;
    this.weaponStatsButton.alpha = 0.5;
    this.weaponStatsLabel.alpha = 0.5;
    this.skillRankingButton.alpha = 0.5;
    this.skillRankingLabel.alpha = 0.5;
    this.display = RankingMenu.GLOBAL_RANKING;
  }
  displaySkillRanking() {
    this.globalRanking.disableWheel();
    this.skillRanking.enableWheel();
    this.weaponStats.disableWheel();
    this.weaponType.disableWheel();
    AudioEffects.ButtonClick.audio.play();
    this.skillRankingContainer.parent || this.container.addChild(this.skillRankingContainer);
    this.weaponTypeContainer.parent && this.container.removeChild(this.weaponTypeContainer);
    this.weaponStatsContainer.parent && this.container.removeChild(this.weaponStatsContainer);
    this.globalRankingContainer.parent && this.container.removeChild(this.globalRankingContainer);
    this.globalRankingButton.alpha = 0.5;
    this.globalRankingLabel.alpha = 0.5;
    this.weaponStatsButton.alpha = 0.5;
    this.weaponStatsLabel.alpha = 0.5;
    this.skillRankingButton.alpha = 1;
    this.skillRankingLabel.alpha = 1;
    this.display = RankingMenu.SKILL_RANKING;
  }
  displayWeaponStats() {
    this.globalRanking.disableWheel();
    this.skillRanking.disableWheel();
    this.weaponStats.enableWheel();
    this.weaponType.disableWheel();
    AudioEffects.ButtonClick.audio.play();
    this.weaponStatsContainer.parent || this.container.addChild(this.weaponStatsContainer);
    this.globalRankingContainer.parent && this.container.removeChild(this.globalRankingContainer);
    this.weaponTypeContainer.parent && this.container.removeChild(this.weaponTypeContainer);
    this.skillRankingContainer.parent && this.container.removeChild(this.skillRankingContainer);
    this.globalRankingButton.alpha = 0.5;
    this.globalRankingLabel.alpha = 0.5;
    this.weaponStatsButton.alpha = 1;
    this.weaponStatsLabel.alpha = 1;
    this.skillRankingButton.alpha = 0.5;
    this.skillRankingLabel.alpha = 0.5;
    this.display = RankingMenu.WEAPON_STATS;
  }
  async displayWeaponUsers(a) {
    this.globalRanking.disableWheel();
    this.skillRanking.disableWheel();
    this.weaponStats.disableWheel();
    this.weaponType.enableWheel();
    this.weaponTypeContainer.parent || this.container.addChild(this.weaponTypeContainer);
    this.weaponStatsContainer.parent && this.container.removeChild(this.weaponStatsContainer);
    this.weaponTypeIcon &&
      this.weaponTypeIcon.parent &&
      (this.weaponTypeContainer.removeChild(this.weaponTypeIcon), (this.weaponTypeIcon = null));
    this.weaponTypeIcon = Game.MapEventWepToIcon(a);
    this.weaponTypeIcon.x = this.ox + 190;
    this.weaponTypeIcon.y = this.oy + 130;
    var b = this.weaponTypeIcon.width,
      c = this.weaponTypeIcon.height;
    let d = b > c ? (38 < b ? 38 : b) : 32 < c ? 32 : c;
    this.weaponTypeIcon.scale.x = this.weaponTypeIcon.scale.y =
      b > c ? d / this.weaponTypeIcon.width : d / this.weaponTypeIcon.height;
    this.weaponTypeIcon.rotation = -0.2;
    this.weaponTypeContainer.addChild(this.weaponTypeIcon);
    b = Game.MapEventWepToId(a);
    b = void 0 !== ItemMap[b] ? ItemMap[b].title : a;
    this.weaponTypeLabel.text = "Loading...";
    this.weaponTypeTableContainer.removeChildren();
    a = await APIClient.getWeaponRankingType(a);
    this.weaponTypeTableContainer.removeChildren();
    this.weaponTypeLabel.text = b;
    if (a.success && a.ranking)
      for (b = 0; b < a.ranking.length; b++) {
        const e = a.ranking[b];
        c = new WeaponTypeStatsTableRow(b, e.id, e.name, e.kills);
        c.x = this.ox - 20;
        c.y = this.oy + 42 * b + 130;
        c.on("mousedown", () => {
          this.emit(Layer.Events.USER_ACCESS, e.accountId, !1);
          AudioEffects.ButtonClick.audio.play();
        });
        c.on("touchstart", () => {
          this.emit(Layer.Events.USER_ACCESS, e.accountId, !1);
          AudioEffects.ButtonClick.audio.play();
        });
        this.weaponTypeTableContainer.addChild(c);
      }
  }
}
RankingMenu.GLOBAL_RANKING = "globalRanking";
RankingMenu.SKILL_RANKING = "skillRanking";
RankingMenu.WEAPON_STATS = "weaponStats";
RankingMenu.WEAPON_USERS = "weaponUsers";
class GlobalRankingTableRow extends PIXI.Container {
  constructor(a, b, c, d, e, f, g) {
    super();
    this.index = a;
    this.interactive = !0;
    a = Math.max(Math.floor((d / 160) * 10) + 1);
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 560, 32);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.icon = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + a]);
    this.icon.x = -48;
    this.icon.y = -2;
    this.icon.scale.x = this.icon.scale.y = 0.5;
    this.addChild(this.icon);
    this.rankText = new PIXI.BitmapText(b, { fontName: "Open Sans", fontSize: 22 });
    this.rankText.x = 0;
    this.rankText.y = 9;
    this.rankText.tint = 16763904;
    this.addChild(this.rankText);
    this.nameText = new PIXI.BitmapText(c, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 40;
    this.nameText.y = 9;
    this.addChild(this.nameText);
    this.levelText = new PIXI.BitmapText(numberWithPeriods(d), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.levelText.x = 220;
    this.levelText.y = 9;
    this.addChild(this.levelText);
    this.experienceText = new PIXI.BitmapText(numberWithPeriods(e), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.experienceText.x = 340;
    this.experienceText.y = 9;
    this.addChild(this.experienceText);
    this.ytIcon = new PIXI.Sprite(App.CombinedTextures.youtube_logo);
    this.ytIcon.scale.x = this.ytIcon.scale.y = 0.4;
    this.ytIcon.x = 478;
    this.ytIcon.y = 9;
    this.addChild(this.ytIcon);
    "" !== g
      ? ((this.ytIcon.interactive = !0),
        (this.ytIcon.alpha = 0.8),
        this.ytIcon.on("mouseover", () => (this.ytIcon.alpha = 1)),
        this.ytIcon.on("mouseout", () => (this.ytIcon.alpha = 0.8)),
        this.ytIcon.on("mousedown", (h) => {
          window.open(g, "_blank");
          h.stopPropagation();
        }),
        this.ytIcon.on("touchstart", (h) => {
          window.open(g, "_blank");
          h.stopPropagation();
        }))
      : (this.ytIcon.alpha = 0.1);
    this.twIcon = new PIXI.Sprite(App.CombinedTextures.twitch_logo);
    this.twIcon.scale.x = this.twIcon.scale.y = 0.6;
    this.twIcon.x = 516;
    this.twIcon.y = 5;
    this.addChild(this.twIcon);
    "" !== f
      ? ((this.twIcon.interactive = !0),
        this.twIcon.on("mouseover", () => (this.twIcon.alpha = 1)),
        this.twIcon.on("mouseout", () => (this.twIcon.alpha = 0.8)),
        this.twIcon.on("mousedown", (h) => {
          window.open(f, "_blank");
          h.stopPropagation();
        }),
        this.twIcon.on("touchstart", (h) => {
          window.open(f, "_blank");
          h.stopPropagation();
        }))
      : (this.twIcon.alpha = 0.1);
    App.WhiteLabel === App.WhiteLabel_POKI &&
      ((this.ytIcon.interactive = !1),
      (this.ytIcon.alpha = 0.1),
      (this.twIcon.interactive = !1),
      (this.twIcon.alpha = 0.1));
  }
}
class GlobalRankingScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(GlobalRankingScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
GlobalRankingScrollbar.SCROLL = "scroll";
class SkillRankingTableRow extends PIXI.Container {
  constructor(a, b, c, d, e, f = "", g = "") {
    super();
    this.index = a;
    this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 560, 32);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.rankText = new PIXI.BitmapText(b, { fontName: "Open Sans", fontSize: 22 });
    this.rankText.x = 0;
    this.rankText.y = 9;
    this.rankText.tint = 16763904;
    this.addChild(this.rankText);
    this.nameText = new PIXI.BitmapText(c, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 40;
    this.nameText.y = 9;
    this.addChild(this.nameText);
    this.titleText = new PIXI.BitmapText(d, { fontName: "Open Sans", fontSize: 22 });
    this.titleText.x = 232;
    this.titleText.y = 9;
    this.addChild(this.titleText);
    this.skillText = new PIXI.BitmapText(numberWithPeriods(e), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.skillText.x = 372;
    this.skillText.y = 9;
    this.addChild(this.skillText);
    this.ytIcon = new PIXI.Sprite(App.CombinedTextures.youtube_logo);
    this.ytIcon.scale.x = this.ytIcon.scale.y = 0.4;
    this.ytIcon.x = 478;
    this.ytIcon.y = 9;
    this.addChild(this.ytIcon);
    "" !== f
      ? ((this.ytIcon.interactive = !0),
        (this.ytIcon.alpha = 0.8),
        this.ytIcon.on("mouseover", () => (this.ytIcon.alpha = 1)),
        this.ytIcon.on("mouseout", () => (this.ytIcon.alpha = 0.8)),
        this.ytIcon.on("mousedown", (h) => {
          window.open(f, "_blank");
          h.stopPropagation();
        }),
        this.ytIcon.on("touchstart", (h) => {
          window.open(f, "_blank");
          h.stopPropagation();
        }))
      : (this.ytIcon.alpha = 0.1);
    this.twIcon = new PIXI.Sprite(App.CombinedTextures.twitch_logo);
    this.twIcon.scale.x = this.twIcon.scale.y = 0.6;
    this.twIcon.x = 516;
    this.twIcon.y = 5;
    this.addChild(this.twIcon);
    "" !== g
      ? ((this.twIcon.interactive = !0),
        this.twIcon.on("mouseover", () => (this.twIcon.alpha = 1)),
        this.twIcon.on("mouseout", () => (this.twIcon.alpha = 0.8)),
        this.twIcon.on("mousedown", (h) => {
          window.open(g, "_blank");
          h.stopPropagation();
        }),
        this.twIcon.on("touchstart", (h) => {
          window.open(g, "_blank");
          h.stopPropagation();
        }))
      : (this.twIcon.alpha = 0.1);
    App.WhiteLabel === App.WhiteLabel_POKI &&
      ((this.ytIcon.interactive = !1),
      (this.ytIcon.alpha = 0.1),
      (this.twIcon.interactive = !1),
      (this.twIcon.alpha = 0.1));
  }
}
class SkillRankingScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(SkillRankingScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
SkillRankingScrollbar.SCROLL = "scroll";
class WeaponStatsTableRow extends PIXI.Container {
  constructor(a, b, c) {
    super();
    var d = Game.MapEventWepToId(b);
    this.id = d;
    d = void 0 !== ItemMap[d] ? ItemMap[d].title : this.id;
    this.index = a.toString();
    this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 590, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.icon = Game.MapEventWepToIcon(b);
    this.icon.x = 20;
    this.icon.y = 23;
    a = this.icon.width;
    b = this.icon.height;
    let e = a > b ? (24 < a ? 24 : a) : 12 < b ? 12 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? e / this.icon.width : e / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.nameText = new PIXI.BitmapText(d, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 86;
    this.nameText.y = 10;
    this.nameText.tint = 16763904;
    this.addChild(this.nameText);
    this.killsText = new PIXI.BitmapText(numberWithPeriods(c), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.killsText.x = 400;
    this.killsText.y = 10;
    this.addChild(this.killsText);
  }
}
class WeaponStatsScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(WeaponStatsScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
WeaponStatsScrollbar.SCROLL = "scroll";
class WeaponTypeStatsTableRow extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.index = a;
    this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 590, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.icon = new PIXI.Sprite();
    this.icon.x = 12;
    this.icon.y = 23;
    a = this.icon.width;
    b = this.icon.height;
    let e = a > b ? (24 < a ? 24 : a) : 12 < b ? 12 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? e / this.icon.width : e / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.indexText = new PIXI.BitmapText((this.index + 1).toString(), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.indexText.x = 20;
    this.indexText.y = 10;
    this.indexText.tint = 16763904;
    this.addChild(this.indexText);
    this.nameText = new PIXI.BitmapText(c, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 78;
    this.nameText.y = 10;
    this.nameText.tint = 16763904;
    this.addChild(this.nameText);
    this.killsText = new PIXI.BitmapText(numberWithPeriods(d), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.killsText.x = 400;
    this.killsText.y = 10;
    this.addChild(this.killsText);
  }
}
class WeaponTypeStatsScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(WeaponTypeStatsScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
WeaponTypeStatsScrollbar.SCROLL = "scroll";
var newsmenu = {};
class NewsMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.container.addChild(this.background);
    this.ox = 20;
    this.oy = 60;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy - 6;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.NEWS_CANCEL));
    this.container.addChild(this.closeButton);
    this.newsTitle = new PIXI.Text("News", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.newsTitle.x = 0.5 * this.width - 20;
    this.newsTitle.y = this.oy - 4;
    this.newsTitle.anchor.x = 0.5;
    this.container.addChild(this.newsTitle);
    this.container.x = 0.5 * -this.width;
    this.newsItemContainer = new PIXI.Container();
    this.newsItemContainer.x = this.ox;
    this.newsItemContainer.y = this.oy + 50;
    this.container.addChild(this.newsItemContainer);
  }
  async show() {
    const a = await APIClient.getNews();
    this.newsItemContainer.removeChildren();
    let b = 0;
    for (let d = 0; d < a.length; d++) {
      var c = a[d];
      c = new NewsItem(c.title, c.message, c.created);
      c.x = 5;
      c.y = b;
      this.newsItemContainer.addChild(c);
      b += c.height + 10;
    }
  }
}
class NewsItem extends PIXI.Container {
  constructor(a, b, c) {
    super();
    c = new Date(Date.parse(c));
    const d = c.getDate().toString().padStart(2, "0"),
      e = (c.getMonth() + 1).toString().padStart(2, "0"),
      f = c.getFullYear();
    c = Date.now() - 864e5 < c.getTime() ? "Today" : d + "-" + e + "-" + f;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 0;
    this.addChild(this.background);
    this.title = new PIXI.Text(c + " - " + a, {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.x = 10;
    this.title.y = 0;
    this.title.tint = 16746496;
    this.addChild(this.title);
    this.message = new PIXI.Text(b, {
      fontName: "Arial",
      fontSize: 14,
      fill: 13421772,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 580,
    });
    this.message.x = 10;
    this.message.y = 30;
    this.message.tint = 16777215;
    this.addChild(this.message);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRoundedRect(0, -10, 600, this.height + 20, 8);
    this.background.endFill();
  }
}
var partnermenu = {};
class PartnerMenu extends Feature {
  constructor() {
    super();
    this.partners = [
      { title: "crazygames.com", url: "https://www.crazygames.com/c/io" },
      { title: "silvergames.com", url: "https://www.silvergames.com/" },
      { title: "pacogames.com", url: "https://www.pacogames.com/" },
      { title: "iogames.space", url: "https://www.iogames.space/" },
      { title: "gametop.com", url: "https://www.gametop.com/" },
    ];
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.container.addChild(this.background);
    this.ox = 20;
    this.oy = 60;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy - 6;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.PARTNER_CANCEL));
    this.container.addChild(this.closeButton);
    this.partnerTitle = new PIXI.BitmapText("Partners", { fontName: "Open Sans", fontSize: 30 });
    this.partnerTitle.x = 0.5 * this.width;
    this.partnerTitle.y = this.oy;
    this.partnerTitle.anchor.x = 0.5;
    this.partnerTitle.tint = 16763904;
    this.container.addChild(this.partnerTitle);
    this.container.x = 0.5 * -this.width;
    for (let a = 0; a < this.partners.length; a++) {
      let b = this.partners[a],
        c = new PIXI.BitmapText(b.title, { fontName: "Open Sans", fontSize: 26 });
      c.x = 0.5 * this.width;
      c.y = this.oy + 44 * a + 92;
      c.anchor.x = 0.5;
      c.tint = 16763904;
      c.interactive = !0;
      c.hitArea = new PIXI.Rectangle(0.5 * -c.width, 8, c.width, c.height);
      c.on("mouseover", () => {
        c.scale.x = c.scale.y = 1.1;
      });
      c.on("mouseout", () => {
        c.scale.x = c.scale.y = 1;
      });
      c.on("mousedown", () => window.open(b.url, "_blank"));
      this.background.beginFill(16777215, 0.1);
      this.background.drawRect(200, this.oy + 44 * (a + 1) + 2, 260, 40);
      this.background.endFill();
      this.container.addChild(c);
    }
  }
  show() {}
}
var serverlistmenu = {};
class ServerListMenu extends Feature {
  constructor() {
    super();
    this.oy = this.ox = 20;
    this.gameList = [];
    this.activeMode = ServerListMenu.MODE_ALL;
    this.activeRegion = ServerListMenu.REGION_ALL;
    this.activePrivate = ServerListMenu.PRIVATE_ALL;
    this.activeRanked = ServerListMenu.RANKED_ALL;
    this.activeCustom = ServerListMenu.CUSTOM_ALL;
    this.sortedCol = ServerListMenu.COL_PLAYERS;
    this.playerSort = this.nameSort = this.regionSort = this.modeSort = ServerListMenu.SORT_DEFAULT;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.beginFill(2105376, 1);
    this.background.drawRect(15, 120, 628, 345);
    this.background.endFill();
    this.background.lineStyle(1, 16777215, 0.25);
    this.background.moveTo(18, this.oy + 125);
    this.background.lineTo(612, this.oy + 125);
    this.container.addChild(this.background);
    this.container.x = 0.5 * -this.width;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.SERVER_LIST_CANCEL));
    this.container.addChild(this.closeButton);
    this.serverListingTitle = new PIXI.Text("Game list", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.serverListingTitle.x = this.ox;
    this.serverListingTitle.y = this.oy + 40;
    this.container.addChild(this.serverListingTitle);
    this.passwordLabel = new PIXI.Text("Password", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.passwordLabel.x = this.ox + 267;
    this.passwordLabel.y = this.oy + 107;
    this.container.addChild(this.passwordLabel);
    this.passwordField = new InputField("password");
    this.passwordField.setDimensions(110, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(8);
    this.passwordField.x = this.ox + 346;
    this.passwordField.y = this.oy + 100;
    this.passwordField.setPassword(!0);
    this.passwordField.setFilter("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890");
    this.container.addChild(this.passwordField);
    this.filterPrivate = new Checkbox("private", "Private", !0);
    this.filterPrivate.x = this.ox + 502;
    this.filterPrivate.y = this.oy + 50;
    this.filterPrivate.scale.x = this.filterPrivate.scale.y = 0.9;
    this.filterPrivate.on(Checkbox.CHANGE, (a) =>
      this.filter(
        this.activeMode,
        this.activeRegion,
        a ? ServerListMenu.PRIVATE_ALL : !1,
        this.activeRanked,
        this.activeCustom
      )
    );
    this.container.addChild(this.filterPrivate);
    this.privateIcon = new PIXI.Sprite(App.CombinedTextures.lock_icon);
    this.privateIcon.x = this.ox + 470;
    this.privateIcon.y = this.filterPrivate.y - 3;
    this.privateIcon.scale.x = this.privateIcon.scale.y = 0.4;
    this.container.addChild(this.privateIcon);
    this.filterRanked = new Checkbox("ranked", "Ranked", !0);
    this.filterRanked.x = this.ox + 502;
    this.filterRanked.y = this.oy + 80;
    this.filterRanked.scale.x = this.filterRanked.scale.y = 0.9;
    this.filterRanked.on(Checkbox.CHANGE, (a) =>
      this.filter(
        this.activeMode,
        this.activeRegion,
        this.activePrivate,
        a ? ServerListMenu.RANKED_ALL : !1,
        this.activeCustom
      )
    );
    this.container.addChild(this.filterRanked);
    this.rankedIcon = new PIXI.Sprite(App.CombinedTextures.ranked_icon);
    this.rankedIcon.x = this.ox + 470;
    this.rankedIcon.y = this.filterRanked.y - 3;
    this.rankedIcon.scale.x = this.rankedIcon.scale.y = 0.4;
    this.container.addChild(this.rankedIcon);
    this.filterCustom = new Checkbox("custom", "Custom", !0);
    this.filterCustom.x = this.ox + 502;
    this.filterCustom.y = this.oy + 110;
    this.filterCustom.scale.x = this.filterCustom.scale.y = 0.9;
    this.filterCustom.on(Checkbox.CHANGE, (a) =>
      this.filter(
        this.activeMode,
        this.activeRegion,
        this.activePrivate,
        this.activeRanked,
        a ? ServerListMenu.CUSTOM_ALL : !1
      )
    );
    this.container.addChild(this.filterCustom);
    this.customIcon = new PIXI.Sprite(App.CombinedTextures.gears_icon);
    this.customIcon.x = this.ox + 470;
    this.customIcon.y = this.filterCustom.y - 3;
    this.customIcon.scale.x = this.customIcon.scale.y = 0.4;
    this.container.addChild(this.customIcon);
    this.modeText = new PIXI.Text("Mode", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.modeText.x = this.ox + 15;
    this.modeText.y = this.oy + 144;
    this.container.addChild(this.modeText);
    this.regionText = new PIXI.Text("Region", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.regionText.x = this.ox + 75;
    this.regionText.y = this.oy + 144;
    this.container.addChild(this.regionText);
    this.nameText = new PIXI.Text("Name", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.nameText.x = this.ox + 146;
    this.nameText.y = this.oy + 144;
    this.container.addChild(this.nameText);
    this.playersText = new PIXI.Text("Players", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.playersText.x = this.ox + 360;
    this.playersText.y = this.oy + 144;
    this.container.addChild(this.playersText);
    this.modeSorting = new PIXI.Graphics();
    this.modeSorting.interactive = !0;
    this.modeSorting.x = this.modeText.x - 4;
    this.modeSorting.y = this.modeText.y;
    this.modeSorting.beginFill(16777215, 0.2);
    this.modeSorting.drawRect(0, 0, 54, 22, 8);
    this.modeSorting.endFill();
    this.modeSorting.alpha = 0.5;
    this.modeSorting.on("mouseover", () => (this.modeSorting.alpha = 1));
    this.modeSorting.on("mouseout", () => (this.modeSorting.alpha = 0.5));
    this.modeSorting.on("mousedown", () => {
      this.sortedCol = ServerListMenu.COL_MODE;
      this.modeSort =
        this.modeSort === ServerListMenu.SORT_UP
          ? ServerListMenu.SORT_DOWN
          : ServerListMenu.SORT_UP;
      this.sort(this.modeSort);
    });
    this.container.addChild(this.modeSorting);
    this.regionSorting = new PIXI.Graphics();
    this.regionSorting.interactive = !0;
    this.regionSorting.x = this.regionText.x - 4;
    this.regionSorting.y = this.regionText.y;
    this.regionSorting.beginFill(16777215, 0.2);
    this.regionSorting.drawRect(0, 0, 64, 22, 8);
    this.regionSorting.endFill();
    this.regionSorting.alpha = 0.5;
    this.regionSorting.on("mouseover", () => (this.regionSorting.alpha = 1));
    this.regionSorting.on("mouseout", () => (this.regionSorting.alpha = 0.5));
    this.regionSorting.on("mousedown", () => {
      this.sortedCol = ServerListMenu.COL_REGION;
      this.regionSort =
        this.regionSort === ServerListMenu.SORT_UP
          ? ServerListMenu.SORT_DOWN
          : ServerListMenu.SORT_UP;
      this.sort(ServerListMenu.SORT_DEFAULT, this.regionSort);
    });
    this.container.addChild(this.regionSorting);
    this.nameSorting = new PIXI.Graphics();
    this.nameSorting.interactive = !0;
    this.nameSorting.x = this.nameText.x - 4;
    this.nameSorting.y = this.nameText.y;
    this.nameSorting.beginFill(16777215, 0.2);
    this.nameSorting.drawRect(0, 0, 54, 22, 8);
    this.nameSorting.endFill();
    this.nameSorting.alpha = 0.5;
    this.nameSorting.on("mouseover", () => (this.nameSorting.alpha = 1));
    this.nameSorting.on("mouseout", () => (this.nameSorting.alpha = 0.5));
    this.nameSorting.on("mousedown", () => {
      this.sortedCol = ServerListMenu.COL_NAME;
      this.nameSort =
        this.nameSort === ServerListMenu.SORT_UP
          ? ServerListMenu.SORT_DOWN
          : ServerListMenu.SORT_UP;
      this.sort(ServerListMenu.SORT_DEFAULT, ServerListMenu.SORT_DEFAULT, this.nameSort);
    });
    this.container.addChild(this.nameSorting);
    this.playerSorting = new PIXI.Graphics();
    this.playerSorting.interactive = !0;
    this.playerSorting.x = this.playersText.x - 4;
    this.playerSorting.y = this.playersText.y;
    this.playerSorting.beginFill(16777215, 0.2);
    this.playerSorting.drawRect(0, 0, 68, 22, 8);
    this.playerSorting.endFill();
    this.playerSorting.alpha = 0.5;
    this.playerSorting.on("mouseover", () => (this.playerSorting.alpha = 1));
    this.playerSorting.on("mouseout", () => (this.playerSorting.alpha = 0.5));
    this.playerSorting.on("mousedown", () => {
      this.sortedCol = ServerListMenu.COL_PLAYERS;
      this.playerSort =
        this.playerSort === ServerListMenu.SORT_UP
          ? ServerListMenu.SORT_DOWN
          : ServerListMenu.SORT_UP;
      this.sort(
        ServerListMenu.SORT_DEFAULT,
        ServerListMenu.SORT_DEFAULT,
        ServerListMenu.SORT_DEFAULT,
        this.playerSort
      );
    });
    this.container.addChild(this.playerSorting);
    this.serverInfoText = new PIXI.Text("0 players in 0 servers", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 13421772,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.serverInfoText.x = 36;
    this.serverInfoText.y = this.background.height - 16;
    this.container.addChild(this.serverInfoText);
    this.refreshButton = new Button("refresh");
    this.refreshButton.selected = !0;
    this.refreshButton.setText("Refresh");
    this.refreshButton.scale.x = this.refreshButton.scale.y = 0.8;
    this.refreshButton.addListener(Button.BUTTON_RELEASED, () =>
      this.emit(Layer.Events.SERVER_LIST_REFRESH)
    );
    this.refreshButton.x = this.width - 100;
    this.refreshButton.y = this.height - 10;
    this.refreshButton.setTint(8978312);
    this.container.addChild(this.refreshButton);
    this.serverListContainer = new PIXI.Container();
    this.serverListContainer.y = 36;
    this.serverListTableContainerMask = new PIXI.Graphics();
    this.serverListTableContainerMask.beginFill(16777215, 1);
    this.serverListTableContainerMask.drawRect(-10, 150, 640, 316);
    this.serverListTableContainerMask.endFill();
    this.serverListTableContainerMask.x = 10;
    this.serverListContainer.addChild(this.serverListTableContainerMask);
    this.serverListTableContainer = new PIXI.Container();
    this.serverListTableContainer.x = 0;
    this.serverListTableContainer.mask = this.serverListTableContainerMask;
    this.serverListContainer.addChild(this.serverListTableContainer);
    this.serverListScrollbar = new ServerListScrollbar(318);
    this.serverListScrollbar.x = 615;
    this.serverListScrollbar.y = 154;
    this.serverListContainer.addChild(this.serverListScrollbar);
    this.serverListScrollbar.on(ServerListScrollbar.SCROLL, (a) => {
      this.serverListTableContainer.height > this.serverListTableContainerMask.height &&
        (this.serverListTableContainer.y = -(
          a *
          (this.serverListTableContainer.height - this.serverListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.serverListContainer);
    this.modeList = new Dropdown("modeSelect", "Mode", 200, 200);
    this.modeList.addListener(Button.BUTTON_RELEASED, (a) => this.onModeListSelect(a.data.value));
    this.modeList.x = 26;
    this.modeList.y = 130;
    this.modeList.addItem("All modes", ServerListMenu.MODE_ALL, "");
    this.modeList.addItem(
      "Deathmatch",
      ServerListMenu.MODE_DEATHMATCH,
      "",
      App.CombinedTextures.dm_icon_notxt
    );
    this.modeList.addItem(
      "Team Deathmatch",
      ServerListMenu.MODE_TEAM_DEATHMATCH,
      "",
      App.CombinedTextures.tdm_icon_notxt
    );
    this.modeList.addItem(
      "Capture the flag",
      ServerListMenu.MODE_CAPTURE_THE_FLAG,
      "",
      App.CombinedTextures.ctf_icon_notxt
    );
    this.modeList.addItem(
      "Dodgeball",
      ServerListMenu.MODE_DODGEBALL,
      "",
      App.CombinedTextures.db_icon_notxt
    );
    this.modeList.scale.x = this.modeList.scale.y = 0.9;
    this.container.addChild(this.modeList);
    this.regionList = new Dropdown("regionSelect", "Region", 200, 200);
    this.regionList.addListener(Button.BUTTON_RELEASED, (a) =>
      this.onRegionListSelect(a.data.value)
    );
    this.regionList.x = 26;
    this.regionList.y = 100;
    this.regionList.addItem(
      "All regions",
      ServerListMenu.REGION_ALL,
      "",
      App.CombinedTextures.globe,
      0.4,
      4
    );
    this.regionList.addItem(
      "North America",
      ServerListMenu.REGION_NA_EAST,
      "",
      App.CombinedTextures.globe_na,
      0.4,
      4
    );
    this.regionList.addItem(
      "Europe",
      ServerListMenu.REGION_EU_WEST,
      "",
      App.CombinedTextures.globe_eu,
      0.4,
      4
    );
    this.regionList.addItem(
      "Asia",
      ServerListMenu.REGION_AS_SOUTH,
      "",
      App.CombinedTextures.globe_as,
      0.4,
      4
    );
    this.regionList.scale.x = this.regionList.scale.y = 0.9;
    this.container.addChild(this.regionList);
  }
  onModeListSelect(a) {
    this.filter(a, this.activeRegion, this.activePrivate, this.activeRanked, this.activeCustom);
  }
  onRegionListSelect(a) {
    this.filter(this.activeMode, a, this.activePrivate, this.activeRanked, this.activeCustom);
  }
  show() {
    this.refresh();
    Dropdown.AddInstance(this.regionList);
    Dropdown.AddInstance(this.modeList);
    this.serverListScrollbar.enableWheel();
  }
  hide() {
    this.serverListScrollbar.disableWheel();
  }
  async refresh() {
    this.refreshButton.disable();
    this.gameList = await APIClient.getGames();
    this.sort();
    setTimeout(() => this.refreshButton.enable(), 4e3);
  }
  sort(
    a = ServerListMenu.SORT_DEFAULT,
    b = ServerListMenu.SORT_DEFAULT,
    c = ServerListMenu.SORT_DEFAULT,
    d = ServerListMenu.SORT_DEFAULT
  ) {
    a === ServerListMenu.SORT_DOWN
      ? this.gameList.sort((e, f) => (e.mode < f.mode ? -1 : e.mode > f.mode ? 1 : 0))
      : a === ServerListMenu.SORT_UP &&
        this.gameList.sort((e, f) => (e.mode < f.mode ? 1 : e.mode > f.mode ? -1 : 0));
    b === ServerListMenu.SORT_DOWN
      ? this.gameList.sort((e, f) => (e.region < f.region ? -1 : e.region > f.region ? 1 : 0))
      : b === ServerListMenu.SORT_UP &&
        this.gameList.sort((e, f) => (e.region < f.region ? 1 : e.region > f.region ? -1 : 0));
    c === ServerListMenu.SORT_DOWN
      ? this.gameList.sort((e, f) => (e.name < f.name ? -1 : e.name > f.name ? 1 : 0))
      : c === ServerListMenu.SORT_UP &&
        this.gameList.sort((e, f) => (e.name < f.name ? 1 : e.name > f.name ? -1 : 0));
    d === ServerListMenu.SORT_DOWN
      ? this.gameList.sort((e, f) =>
          parseInt(e.players) < parseInt(f.players)
            ? -1
            : parseInt(e.players) > parseInt(f.players)
            ? 1
            : 0
        )
      : d === ServerListMenu.SORT_UP &&
        this.gameList.sort((e, f) =>
          parseInt(e.players) < parseInt(f.players)
            ? 1
            : parseInt(e.players) > parseInt(f.players)
            ? -1
            : 0
        );
    this.filter(
      this.activeMode,
      this.activeRegion,
      this.activePrivate,
      this.activeRanked,
      this.activeCustom
    );
  }
  filter(
    a = ServerListMenu.MODE_ALL,
    b = ServerListMenu.REGION_ALL,
    c = ServerListMenu.PRIVATE_ALL,
    d = ServerListMenu.RANKED_ALL,
    e = ServerListMenu.CUSTOM_ALL
  ) {
    let f = 0,
      g = 0,
      h = 0,
      k = !1;
    this.serverListTableContainer.removeChildren();
    this.serverListTableContainer.y = 0;
    this.serverListScrollbar.reset();
    this.activeMode = a;
    this.activeRegion = b;
    this.activePrivate = c;
    this.activeRanked = d;
    this.activeCustom = e;
    for (let l = 0; l < this.gameList.length; l++) {
      const p = this.gameList[l];
      if (a !== ServerListMenu.MODE_ALL && Game.MODE_MAP[p.mode] !== a) {
        k = !0;
        continue;
      }
      if (b !== ServerListMenu.REGION_ALL && p.region !== b) {
        k = !0;
        continue;
      }
      var m = parseInt(p.private);
      let n = parseInt(p.ranked),
        r = parseInt(p.custom);
      m && n && r
        ? (k = !(
            c === ServerListMenu.PRIVATE_ALL ||
            d === ServerListMenu.RANKED_ALL ||
            e === ServerListMenu.CUSTOM_ALL
          ))
        : m && n
        ? (k = !(c === ServerListMenu.PRIVATE_ALL || d === ServerListMenu.RANKED_ALL))
        : m && r
        ? (k = !(c === ServerListMenu.PRIVATE_ALL || e === ServerListMenu.CUSTOM_ALL))
        : n && r
        ? (k = !(d === ServerListMenu.RANKED_ALL || e === ServerListMenu.CUSTOM_ALL))
        : m
        ? (k = c !== ServerListMenu.PRIVATE_ALL)
        : n
        ? (k = d !== ServerListMenu.RANKED_ALL)
        : r && (k = e !== ServerListMenu.CUSTOM_ALL);
      k ||
        (g++,
        (h += parseInt(p.players, 10)),
        f++,
        (m = new ServerListTableRow(
          f + 1,
          ServerListMenu.REGION_MAP[p.region],
          p.server_id,
          p.name,
          p.mode,
          p.players,
          p.private,
          p.ranked,
          p.custom
        )),
        (m.x = this.ox + 20),
        (m.y = this.oy + 36 * f + 100),
        m.on(ServerListTableRow.JOIN_GAME, (q) => {
          this.passwordField.markNone();
          let t = this.passwordField.getText().trim();
          1 === parseInt(p.private) && 0 === t.length
            ? this.passwordField.markInvalid()
            : this.emit(Layer.Events.JOIN_GAME, q, p.server_id, t);
        }),
        m.on(ServerListTableRow.DISPLAY_DETAILS, () =>
          this.emit(Layer.Events.SERVER_DETAIL_ACCESS, p)
        ),
        this.serverListTableContainer.addChild(m));
    }
    this.serverInfoText.text = "" + h + " players in " + g + " servers" + (k ? " [filtered]" : "");
  }
  setPasswordInvalid() {
    this.passwordField.markInvalid();
  }
}
ServerListMenu.MODE_ALL = "all";
ServerListMenu.REGION_ALL = "all";
ServerListMenu.PRIVATE_ALL = "all";
ServerListMenu.RANKED_ALL = "all";
ServerListMenu.CUSTOM_ALL = "all";
ServerListMenu.MODE_DEATHMATCH = "dm";
ServerListMenu.MODE_TEAM_DEATHMATCH = "tdm";
ServerListMenu.MODE_CAPTURE_THE_FLAG = "ctf";
ServerListMenu.MODE_DODGEBALL = "db";
ServerListMenu.REGION_NA_EAST = "na_east";
ServerListMenu.REGION_EU_WEST = "eu_west";
ServerListMenu.REGION_AS_SOUTH = "as_south";
ServerListMenu.REGION_MAP = {
  [ServerListMenu.REGION_NA_EAST]: "na",
  [ServerListMenu.REGION_EU_WEST]: "eu",
  [ServerListMenu.REGION_AS_SOUTH]: "as",
};
ServerListMenu.SORT_UP = "up";
ServerListMenu.SORT_DOWN = "down";
ServerListMenu.SORT_DEFAULT = "default";
ServerListMenu.COL_MODE = "mode";
ServerListMenu.COL_REGION = "region";
ServerListMenu.COL_NAME = "name";
ServerListMenu.COL_PLAYERS = "players";
class ServerListTableRow extends PIXI.Container {
  constructor(a, b, c, d, e, f, g, h, k) {
    super();
    this.id = c;
    this.index = a.toString();
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.1);
    this.background.drawRect(-10, 2, 570, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    this.hitArea = new PIXI.Rectangle(-10, 2, 570, 38);
    this.interactive = !0;
    this.on("mouseover", () => {
      this.background.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.on("mouseout", () => {
      this.background.alpha = 0 === this.index % 2 ? 0.3 : 0;
    });
    this.addChild(this.background);
    this.background.on("mousedown", () => {
      this.emit(ServerListTableRow.DISPLAY_DETAILS);
      AudioEffects.ButtonClick.audio.play();
    });
    this.modeIcon = new PIXI.Sprite(App.CombinedTextures[Game.MODE_MAP[e] + "_icon"]);
    this.modeIcon.x = 0;
    this.modeIcon.y = 5;
    this.addChild(this.modeIcon);
    this.regionIcon = new PIXI.Sprite(App.CombinedTextures["globe_" + b]);
    this.regionIcon.x = 56;
    this.regionIcon.y = 8;
    this.regionIcon.scale.x = this.regionIcon.scale.y = 0.4;
    this.addChild(this.regionIcon);
    this.regionText = new PIXI.BitmapText(b.toUpperCase(), { fontName: "Open Sans", fontSize: 22 });
    this.regionText.x = 84;
    this.regionText.y = 10;
    this.regionText.tint = 16763904;
    this.addChild(this.regionText);
    this.nameText = new PIXI.BitmapText(d, { fontName: "Open Sans", fontSize: 22 });
    this.nameText.x = 132;
    this.nameText.y = 10;
    this.nameText.tint = 16777215;
    this.addChild(this.nameText);
    220 < this.nameText.width && (this.nameText.width = 220);
    this.playerText = new PIXI.BitmapText(f + (12 === parseInt(f) ? " (full)" : ""), {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.playerText.x = 360;
    this.playerText.y = 10;
    this.playerText.tint = 12 === parseInt(f) ? 16763904 : 16777215;
    this.addChild(this.playerText);
    a = 1 === parseInt(g);
    h = 1 === parseInt(h);
    k = 1 === parseInt(k);
    a &&
      ((this.privateIcon = new PIXI.Sprite(App.CombinedTextures.lock_icon)),
      (this.privateIcon.x = 400),
      (this.privateIcon.y = 8),
      (this.privateIcon.scale.x = this.privateIcon.scale.y = 0.4),
      this.addChild(this.privateIcon));
    h &&
      ((this.rankedIcon = new PIXI.Sprite(App.CombinedTextures.ranked_icon)),
      (this.rankedIcon.x = 430),
      (this.rankedIcon.y = 8),
      (this.rankedIcon.scale.x = this.rankedIcon.scale.y = 0.4),
      this.addChild(this.rankedIcon));
    k &&
      ((this.customIcon = new PIXI.Sprite(App.CombinedTextures.gears_icon)),
      (this.customIcon.x = 460),
      (this.customIcon.y = 8),
      (this.customIcon.scale.x = this.customIcon.scale.y = 0.4),
      this.addChild(this.customIcon));
    this.joinButton = new Button("join");
    this.joinButton.selected = !1;
    this.joinButton.setText("Join");
    this.joinButton.scale.x = this.joinButton.scale.y = 0.7;
    this.joinButton.setTint(16763904);
    this.joinButton.addListener(Button.BUTTON_RELEASED, () => {
      this.emit(ServerListTableRow.JOIN_GAME, d, this.id);
    });
    this.joinButton.x = 514;
    this.joinButton.y = 8;
    this.addChild(this.joinButton);
  }
}
ServerListTableRow.JOIN_GAME = "joinGame";
ServerListTableRow.DISPLAY_DETAILS = "displayDetails";
class ServerListScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(ServerListScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
ServerListScrollbar.SCROLL = "scroll";
var servercustomizationmenu = {};
class ServerCustomizationMenu extends Feature {
  constructor() {
    super();
    this.ox = 0;
    this.oy = 20;
    this.maps = [];
    this.drops = [];
    this.settings = { maps: [], weapons: [], drops: [], shuriken: !0 };
    this.selectedMode = null;
    this.container.x = 0.5 * -this.width;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(14, 136, 208, 330, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(226, 136, 208, 330, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(438, 136, 208, 330, 10);
    this.background.endFill();
    this.background.interactive = !0;
    this.container.addChild(this.background);
    this.serverCustomizationTitle = new PIXI.Text("Customize game", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.serverCustomizationTitle.x = this.ox + 20;
    this.serverCustomizationTitle.y = this.oy + 40;
    this.container.addChild(this.serverCustomizationTitle);
    this.weaponTypeLabel = new PIXI.Text(
      "Select the weapons and maps that should be available in the server.\n- Deselecting all weapons will disable the weapon menu.\n- Deselecting all maps will enable one random map.",
      { fontSize: 16, fontFamily: "Arial", fill: 16777215, lineJoin: "round", strokeThickness: 2 }
    );
    this.weaponTypeLabel.x = this.ox + 24;
    this.weaponTypeLabel.y = this.oy + 70;
    this.weaponTypeLabel.tint = 16777215;
    this.container.addChild(this.weaponTypeLabel);
    this.weaponTypeLabel = new PIXI.Text("Weapons", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.weaponTypeLabel.x = this.ox + 20;
    this.weaponTypeLabel.y = this.oy + 134;
    this.container.addChild(this.weaponTypeLabel);
    this.mapLabel = new PIXI.Text("Maps", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.mapLabel.x = this.ox + 230;
    this.mapLabel.y = this.oy + 134;
    this.container.addChild(this.mapLabel);
    this.dropLabel = new PIXI.Text("Item drops", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.dropLabel.x = this.ox + 440;
    this.dropLabel.y = this.oy + 134;
    this.container.addChild(this.dropLabel);
    this.acceptButton = new Button("accept");
    this.acceptButton.setText("Apply");
    this.acceptButton.scale.x = this.acceptButton.scale.y = 0.8;
    this.acceptButton.addListener(Button.BUTTON_RELEASED, () => this.onAccept());
    this.acceptButton.x = this.width - 80;
    this.acceptButton.y = this.height - 10;
    this.acceptButton.setTint(16763904);
    this.container.addChild(this.acceptButton);
    this.weaponListContainer = new PIXI.Container();
    this.weaponListContainer.x = 0;
    this.weaponListContainer.y = 32;
    this.weaponListTableContainerMask = new PIXI.Graphics();
    this.weaponListTableContainerMask.beginFill(16777215, 1);
    this.weaponListTableContainerMask.drawRect(20, 148, 180, 320);
    this.weaponListTableContainerMask.endFill();
    this.weaponListTableContainerMask.x = -4;
    this.weaponListContainer.addChild(this.weaponListTableContainerMask);
    this.weaponListTableContainer = new PIXI.Container();
    this.weaponListTableContainer.x = 13;
    this.weaponListTableContainer.mask = this.weaponListTableContainerMask;
    this.weaponListContainer.addChild(this.weaponListTableContainer);
    this.weaponSelectionListScrollbar = new SelectionListScrollbar(322);
    this.weaponSelectionListScrollbar.x = 200;
    this.weaponSelectionListScrollbar.y = 152;
    this.weaponListContainer.addChild(this.weaponSelectionListScrollbar);
    this.weaponSelectionListScrollbar.on(SelectionListScrollbar.SCROLL, (b) => {
      this.weaponListTableContainer.height > this.weaponListTableContainerMask.height &&
        (this.weaponListTableContainer.y = -(
          b *
          (this.weaponListTableContainer.height - this.weaponListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.weaponListContainer);
    let a = 0;
    for (let b in ItemMap) {
      let c = ItemMap[b];
      if (c.equip === ItemMap.Equip.PRIMARY || c.equip === ItemMap.Equip.SECONDARY) {
        this.settings.weapons.push(b);
        const d = new WeaponSelectionListTableRow(a, b, c.title);
        d.x = this.ox + 4;
        d.y = this.oy + 42 * a + 130;
        d.on(WeaponSelectionListTableRow.CHANGE, (e) =>
          this.onWeaponSelectionChange(e, d.selected)
        );
        this.weaponListTableContainer.addChild(d);
        a++;
      }
    }
    this.mapListContainer = new PIXI.Container();
    this.mapListContainer.x = 212;
    this.mapListContainer.y = 32;
    this.mapListTableContainerMask = new PIXI.Graphics();
    this.mapListTableContainerMask.beginFill(16777215, 1);
    this.mapListTableContainerMask.drawRect(20, 148, 180, 320);
    this.mapListTableContainerMask.endFill();
    this.mapListTableContainerMask.x = -4;
    this.mapListContainer.addChild(this.mapListTableContainerMask);
    this.mapListTableContainer = new PIXI.Container();
    this.mapListTableContainer.x = 0;
    this.mapListTableContainer.mask = this.mapListTableContainerMask;
    this.mapListContainer.addChild(this.mapListTableContainer);
    this.mapSelectionListScrollbar = new SelectionListScrollbar(322);
    this.mapSelectionListScrollbar.x = 200;
    this.mapSelectionListScrollbar.y = 152;
    this.mapListContainer.addChild(this.mapSelectionListScrollbar);
    this.mapSelectionListScrollbar.on(SelectionListScrollbar.SCROLL, (b) => {
      this.mapListTableContainer.height > this.mapListTableContainerMask.height &&
        (this.mapListTableContainer.y = -(
          b *
          (this.mapListTableContainer.height - this.mapListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.mapListContainer);
    this.dropListContainer = new PIXI.Container();
    this.dropListContainer.x = 424;
    this.dropListContainer.y = 32;
    this.dropListTableContainerMask = new PIXI.Graphics();
    this.dropListTableContainerMask.beginFill(16777215, 1);
    this.dropListTableContainerMask.drawRect(20, 148, 180, 320);
    this.dropListTableContainerMask.endFill();
    this.dropListTableContainerMask.x = -4;
    this.dropListContainer.addChild(this.dropListTableContainerMask);
    this.dropListTableContainer = new PIXI.Container();
    this.dropListTableContainer.x = 0;
    this.dropListTableContainer.mask = this.dropListTableContainerMask;
    this.dropListContainer.addChild(this.dropListTableContainer);
    this.dropSelectionListScrollbar = new SelectionListScrollbar(322);
    this.dropSelectionListScrollbar.x = 200;
    this.dropSelectionListScrollbar.y = 152;
    this.dropListContainer.addChild(this.dropSelectionListScrollbar);
    this.dropSelectionListScrollbar.on(SelectionListScrollbar.SCROLL, (b) => {
      this.dropListTableContainer.height > this.dropListTableContainerMask.height &&
        (this.dropListTableContainer.y = -(
          b *
          (this.dropListTableContainer.height - this.dropListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.dropListContainer);
    this.setShuriken = new Checkbox("shuriken", "Spawn with Shuriken", !0);
    this.setShuriken.x = this.ox + 32;
    this.setShuriken.y = this.height - 6;
    this.setShuriken.scale.x = this.setShuriken.scale.y = 0.9;
    this.setShuriken.setTint(16776960);
    this.setShuriken.on(Checkbox.CHANGE, (b) => this.onSetShuriken(b));
    this.container.addChild(this.setShuriken);
    this.loadContent();
  }
  onSetShuriken(a) {
    this.settings.shuriken = a;
  }
  onWeaponSelectionChange(a, b) {
    b
      ? this.settings.weapons.push(a)
      : this.settings.weapons.splice(this.settings.weapons.indexOf(a), 1);
  }
  onMapSelectionChange(a, b) {
    b ? this.settings.maps.push(a) : this.settings.maps.splice(this.settings.maps.indexOf(a), 1);
  }
  onDropSelectionChange(a, b) {
    b ? this.settings.drops.push(a) : this.settings.drops.splice(this.settings.drops.indexOf(a), 1);
  }
  onAccept() {
    this.emit(ServerCustomizationMenu.ACCEPT, this.settings);
  }
  onCancel() {
    this.emit(ServerCustomizationMenu.CANCEL);
  }
  async loadContent() {
    var a = await APIClient.getItemDrops();
    if (a) {
      this.drops = a;
      this.settings.drops = [];
      this.dropListTableContainer.removeChildren();
      a = 0;
      for (let b = 0; b < this.drops.length; b++) {
        const c = this.drops[b];
        this.settings.drops.push(c.item_id);
        const d = new DropSelectionListTableRow(a, c.item_id, c.prefab_id, c.name);
        d.x = this.ox + 4;
        d.y = this.oy + 42 * a + 130;
        d.on(DropSelectionListTableRow.CHANGE, (e) => this.onDropSelectionChange(e, d.selected));
        this.dropListTableContainer.addChild(d);
        a++;
      }
      if ((a = await APIClient.getMaps())) (this.maps = a), this.filterMaps();
    }
  }
  setMode(a) {
    this.selectedMode !== a && ((this.selectedMode = a), this.filterMaps());
  }
  filterMaps() {
    this.mapSelectionListScrollbar.reset();
    this.mapListTableContainer.y = 0;
    this.settings.maps = [];
    this.mapListTableContainer.removeChildren();
    let a = 0;
    for (let b = 0; b < this.maps.length; b++) {
      const c = this.maps[b];
      if (
        !(
          this.selectedMode === c.mode ||
          (c.mode === Game.MODE_CTF && this.selectedMode === Game.MODE_DM) ||
          (c.mode === Game.MODE_CTF && this.selectedMode === Game.MODE_TDM)
        )
      )
        continue;
      this.settings.maps.push(c.id);
      const d = new MapSelectionListTableRow(a, c.id, c.title, c.mode);
      d.x = this.ox + 4;
      d.y = this.oy + 42 * a + 130;
      d.on(MapSelectionListTableRow.CHANGE, (e) => this.onMapSelectionChange(e, d.selected));
      this.mapListTableContainer.addChild(d);
      a++;
    }
    this.emit(ServerCustomizationMenu.INIT, this.settings);
  }
}
ServerCustomizationMenu.ACCEPT = "cust_accept";
ServerCustomizationMenu.CANCEL = "cust_cancel";
ServerCustomizationMenu.INIT = "cust_init";
ServerCustomizationMenu.SHOW = "cust_show";
class WeaponSelectionListTableRow extends PIXI.Container {
  constructor(a, b, c) {
    super();
    this.id = b;
    this.index = a;
    this.selected = this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRect(0, 2, 200, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.tint = 65280;
    this.background.alpha = 0.6;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.6;
    });
    this.background.on("mousedown", () => {
      this.selected = !this.selected;
      this.background.tint = this.selected ? 65280 : 16777215;
      this.emit(WeaponSelectionListTableRow.CHANGE, this.id);
      AudioEffects.ButtonClick.audio.play();
    });
    this.addChild(this.background);
    this.icon = new SpriteMap[b]();
    this.icon.x = 23;
    this.icon.y = 26;
    a = this.icon.width;
    b = this.icon.height;
    let d = a > b ? (64 <= a ? 64 : a) : 42 <= b ? 42 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? d / this.icon.width : d / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.nameText = new PIXI.Text(c, {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.nameText.x = 75;
    this.nameText.y = 12;
    this.nameText.tint = 16777215;
    this.addChild(this.nameText);
  }
}
WeaponSelectionListTableRow.CHANGE = "wsl_change";
class MapSelectionListTableRow extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.id = b;
    this.index = a;
    this.selected = this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRect(0, 2, 200, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.tint = 65280;
    this.background.alpha = 0.6;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.6;
    });
    this.background.on("mousedown", () => {
      this.selected = !this.selected;
      this.background.tint = this.selected ? 65280 : 16777215;
      this.emit(MapSelectionListTableRow.CHANGE, this.id);
      AudioEffects.ButtonClick.audio.play();
    });
    this.addChild(this.background);
    this.icon = new PIXI.Sprite(App.CombinedTextures[Game.MODE_MAP[d] + "_icon"]);
    this.icon.x = 10;
    this.icon.y = 10;
    a = this.icon.width;
    b = this.icon.height;
    d = a > b ? (64 <= a ? 64 : a) : 42 <= b ? 42 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? d / this.icon.width : d / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.nameText = new PIXI.Text(c, {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.nameText.x = 48;
    this.nameText.y = 12;
    this.addChild(this.nameText);
  }
}
MapSelectionListTableRow.CHANGE = "msl_change";
class DropSelectionListTableRow extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.id = b;
    this.index = a;
    this.selected = this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRect(0, 2, 200, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.tint = 65280;
    this.background.alpha = 0.6;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.6;
    });
    this.background.on("mousedown", () => {
      this.selected = !this.selected;
      this.background.tint = this.selected ? 65280 : 16777215;
      this.emit(DropSelectionListTableRow.CHANGE, this.id);
      AudioEffects.ButtonClick.audio.play();
    });
    this.addChild(this.background);
    this.icon = new SpriteMap[c]();
    this.icon.x = 30;
    this.icon.y = 22;
    a = this.icon.width;
    b = this.icon.height;
    c = a > b ? (10 <= a ? 10 : a) : 10 <= b ? 10 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? c / this.icon.width : c / this.icon.height;
    this.icon.rotation = 0;
    this.addChild(this.icon);
    this.nameText = new PIXI.Text(d, {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.nameText.x = 56;
    this.nameText.y = 12;
    this.addChild(this.nameText);
  }
}
DropSelectionListTableRow.CHANGE = "dsl_change";
class SelectionListScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-4, -4, 32, this.h + 8);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, 0, 16, 32, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c));
  }
  scroll(a) {
    if (this.scrolling) {
      a = a.data.global.y / App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      -3 > b ? (b = -3) : b > this.h - 39 && (b = this.h - 39);
      let c = this.h / (this.h - 39);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(SelectionListScrollbar.SCROLL, (1 / this.h) * (b + 3) * c);
    }
  }
  reset() {
    this.scrollButton.y = -3 + (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
SelectionListScrollbar.SCROLL = "scroll";
var servercreationmenu = {};
class ServerCreationMenu extends Feature {
  constructor() {
    super();
    this.price = 0;
    this.duration = ServerCreationMenu.DURATION_B;
    this.mode = Game.MODE_DM;
    this.customization = { maps: [], weapons: [], drops: [], shuriken: !0 };
    this.isPrivate = !1;
    this.isRanked = !0;
    this.isCustom = !1;
    this.onClientConnectBinding = this.onClientConnect.bind(this);
    this.createdServerName = "";
    this.createdServerId = -1;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(18, 40, 624, 44, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(18, 120, 624, 104, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(18, 258, 624, 44, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(18, 336, 624, 44, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(18, 414, 624, 44, 10);
    this.background.endFill();
    this.background.interactive = !0;
    this.container.addChild(this.background);
    this.ox = -20;
    this.oy = 20;
    this.container.x = 0.5 * -this.width;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.SERVER_CREATION_CANCEL));
    this.container.addChild(this.closeButton);
    this.customizationMenu = new ServerCustomizationMenu();
    this.customizationMenu.on(ServerCustomizationMenu.ACCEPT, (a) => {
      this.customization = a;
      this.container.removeChild(this.customizationMenu);
    });
    this.customizationMenu.on(ServerCustomizationMenu.INIT, (a) => (this.customization = a));
    this.customizationMenu.on(ServerCustomizationMenu.CANCEL, () =>
      this.container.removeChild(this.customizationMenu)
    );
    this.confirmationBackground = new PIXI.Graphics();
    this.confirmationBackground.beginFill(4473924, 1);
    this.confirmationBackground.drawRect(0, 0, 400, 300);
    this.confirmationBackground.endFill();
    this.confirmationBackground.beginFill(0, 0.3);
    this.confirmationBackground.drawRect(8, 8, 384, 284);
    this.confirmationBackground.endFill();
    this.confirmationBackground.interactive = !0;
    this.confirmationContainer = new PIXI.Container();
    this.confirmationContainer.addChild(this.confirmationBackground);
    this.confirmationContainer.x = 0.5 * (this.container.width - this.confirmationContainer.width);
    this.confirmationContainer.y =
      0.5 * (this.container.height - this.confirmationContainer.height);
    this.confirmationAccept = new Button();
    this.confirmationAccept.setText("Accept & create");
    this.confirmationAccept.scale.x = this.confirmationAccept.scale.y = 0.8;
    this.confirmationAccept.addListener(Button.BUTTON_RELEASED, () => this.onCreateServerConfirm());
    this.confirmationAccept.x = this.confirmationBackground.width - 222;
    this.confirmationAccept.y = this.confirmationBackground.height - 52;
    this.confirmationAccept.setTint(16763904);
    this.confirmationContainer.addChild(this.confirmationAccept);
    this.confirmationDecline = new Button();
    this.confirmationDecline.setText("Cancel");
    this.confirmationDecline.scale.x = this.confirmationDecline.scale.y = 0.8;
    this.confirmationDecline.addListener(Button.BUTTON_RELEASED, () => this.onCreateServerCancel());
    this.confirmationDecline.x = this.confirmationBackground.width - 322;
    this.confirmationDecline.y = this.confirmationBackground.height - 52;
    this.confirmationDecline.setTint(16777215);
    this.confirmationContainer.addChild(this.confirmationDecline);
    this.serverCreationConfirmationTitle = new PIXI.BitmapText("Confirm server creation", {
      fontName: "Open Sans",
      fontSize: 26,
    });
    this.serverCreationConfirmationTitle.x =
      0.5 * (this.confirmationBackground.width - this.serverCreationConfirmationTitle.width);
    this.serverCreationConfirmationTitle.y = 12;
    this.serverCreationConfirmationTitle.tint = 16763904;
    this.confirmationContainer.addChild(this.serverCreationConfirmationTitle);
    this.confirmationInfoTitle = new PIXI.BitmapText(
      "You are about to create a new game server.\nYou can't create a new server until this one ends.\nImportant:\nInappropriate server names can result in\npermanent account closure.",
      { fontName: "Open Sans", fontSize: 22, align: "center" }
    );
    this.confirmationInfoTitle.x =
      0.5 * (this.confirmationBackground.width - this.confirmationInfoTitle.width);
    this.confirmationInfoTitle.y = 42;
    this.confirmationInfoTitle.tint = 16753920;
    this.confirmationContainer.addChild(this.confirmationInfoTitle);
    this.errorMessage = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "center",
    });
    this.errorMessage.x = 0.5 * (this.confirmationBackground.width - this.errorMessage.width);
    this.errorMessage.y = this.confirmationBackground.height - 124;
    this.errorMessage.tint = 16711680;
    this.confirmationContainer.addChild(this.errorMessage);
    this.successBackground = new PIXI.Graphics();
    this.successBackground.beginFill(4473924, 1);
    this.successBackground.drawRect(0, 0, 400, 200);
    this.successBackground.endFill();
    this.successBackground.beginFill(0, 0.3);
    this.successBackground.drawRect(8, 8, 384, 184);
    this.successBackground.endFill();
    this.successBackground.interactive = !0;
    this.successContainer = new PIXI.Container();
    this.successContainer.addChild(this.successBackground);
    this.successContainer.x = 0.5 * (this.container.width - this.successContainer.width);
    this.successContainer.y = 0.5 * (this.container.height - this.successContainer.height);
    this.serverCreationSuccessTitle = new PIXI.BitmapText("Server created", {
      fontName: "Open Sans",
      fontSize: 26,
    });
    this.serverCreationSuccessTitle.x =
      0.5 * (this.successBackground.width - this.serverCreationSuccessTitle.width);
    this.serverCreationSuccessTitle.y = 12;
    this.serverCreationSuccessTitle.tint = 16763904;
    this.successContainer.addChild(this.serverCreationSuccessTitle);
    this.successInfoTitle = new PIXI.BitmapText(
      "Your server has been created.\nIt will soon be visible in the server lobby.",
      { fontName: "Open Sans", fontSize: 22, align: "center" }
    );
    this.successInfoTitle.x = 0.5 * (this.successBackground.width - this.successInfoTitle.width);
    this.successInfoTitle.y = 42;
    this.successInfoTitle.tint = 16753920;
    this.successContainer.addChild(this.successInfoTitle);
    this.successAccept = new Button();
    this.successAccept.setText("Join game");
    this.successAccept.scale.x = this.successAccept.scale.y = 0.8;
    this.successAccept.addListener(Button.BUTTON_RELEASED, () => this.onSuccessJoinGameAccept());
    this.successAccept.x = 240;
    this.successAccept.y = this.successBackground.height - 52;
    this.successAccept.setTint(16763904);
    this.successContainer.addChild(this.successAccept);
    this.toLobbyAccept = new Button();
    this.toLobbyAccept.setText("Go to lobby");
    this.toLobbyAccept.scale.x = this.toLobbyAccept.scale.y = 0.8;
    this.toLobbyAccept.addListener(Button.BUTTON_RELEASED, () => this.onSuccessToLobbyAccept());
    this.toLobbyAccept.x = 60;
    this.toLobbyAccept.y = this.successBackground.height - 52;
    this.toLobbyAccept.setTint(16763904);
    this.successContainer.addChild(this.toLobbyAccept);
    this.serverCreationTitle = new PIXI.Text("Create game", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.serverCreationTitle.x = this.ox + 40;
    this.serverCreationTitle.y = this.oy + 33;
    this.container.addChild(this.serverCreationTitle);
    this.serverCreationTypeLabel = new PIXI.BitmapText("Type", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationTypeLabel.x = this.ox + 44;
    this.serverCreationTypeLabel.y = this.oy + 110;
    this.serverCreationTypeLabel.tint = 16777215;
    this.container.addChild(this.serverCreationTypeLabel);
    this.customizationButton = new Button("customize");
    this.customizationButton.setText("Customize game");
    this.customizationButton.scale.x = this.customizationButton.scale.y = 0.8;
    this.customizationButton.addListener(Button.BUTTON_RELEASED, () =>
      this.onCustomizeServerInit()
    );
    this.customizationButton.x = this.width - 332;
    this.customizationButton.y = this.height - 14;
    this.customizationButton.setTint(8978312);
    this.customizationButton.alpha = 0.5;
    this.customizationButton.interactive = !1;
    this.container.addChild(this.customizationButton);
    this.createButton = new Button("create");
    this.createButton.setText("Create game");
    this.createButton.scale.x = this.createButton.scale.y = 0.8;
    this.createButton.addListener(Button.BUTTON_RELEASED, () => this.onCreateServerInit());
    this.createButton.x = this.width - 150;
    this.createButton.y = this.height - 14;
    this.createButton.setTint(16763904);
    this.container.addChild(this.createButton);
    this.setPrivate = new Checkbox("private", "Private", !1);
    this.setPrivate.x = this.ox + 82;
    this.setPrivate.y = this.oy + 150;
    this.setPrivate.scale.x = this.setPrivate.scale.y = 0.9;
    this.setPrivate.on(Checkbox.CHANGE, (a) => this.onSetPrivate(a));
    this.container.addChild(this.setPrivate);
    this.privateIcon = new PIXI.Sprite(App.CombinedTextures.lock_icon);
    this.privateIcon.x = this.ox + 50;
    this.privateIcon.y = this.setPrivate.y - 3;
    this.privateIcon.scale.x = this.privateIcon.scale.y = 0.4;
    this.container.addChild(this.privateIcon);
    this.setRanked = new Checkbox("ranked", "Ranked", !0);
    this.setRanked.x = this.ox + 82;
    this.setRanked.y = this.oy + 180;
    this.setRanked.scale.x = this.setRanked.scale.y = 0.9;
    this.setRanked.on(Checkbox.CHANGE, (a) => this.onSetRanked(a));
    this.container.addChild(this.setRanked);
    this.rankedIcon = new PIXI.Sprite(App.CombinedTextures.ranked_icon);
    this.rankedIcon.x = this.ox + 50;
    this.rankedIcon.y = this.setRanked.y - 3;
    this.rankedIcon.scale.x = this.rankedIcon.scale.y = 0.4;
    this.container.addChild(this.rankedIcon);
    this.setCustom = new Checkbox("custom", "Custom", !1);
    this.setCustom.x = this.ox + 82;
    this.setCustom.y = this.oy + 210;
    this.setCustom.scale.x = this.setCustom.scale.y = 0.9;
    this.setCustom.on(Checkbox.CHANGE, (a) => this.onSetCustom(a));
    this.container.addChild(this.setCustom);
    this.customIcon = new PIXI.Sprite(App.CombinedTextures.gears_icon);
    this.customIcon.x = this.ox + 50;
    this.customIcon.y = this.setCustom.y - 3;
    this.customIcon.scale.x = this.customIcon.scale.y = 0.4;
    this.container.addChild(this.customIcon);
    this.serverCreationPriceLabel = new PIXI.BitmapText("Price", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationPriceLabel.x = this.ox + 44;
    this.serverCreationPriceLabel.y = this.oy + 330;
    this.serverCreationPriceLabel.tint = 16777215;
    this.container.addChild(this.serverCreationPriceLabel);
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = this.ox + 54;
    this.goldIcon.y = this.oy + 366;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.4;
    this.container.addChild(this.goldIcon);
    this.serverCreationPriceValue = new PIXI.BitmapText("0", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationPriceValue.x = this.goldIcon.x + this.goldIcon.width + 8;
    this.serverCreationPriceValue.y = this.goldIcon.y;
    this.serverCreationPriceValue.tint = 16763904;
    this.container.addChild(this.serverCreationPriceValue);
    this.serverCreationNameLabel = new PIXI.BitmapText("Name", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationNameLabel.x = this.ox + 44;
    this.serverCreationNameLabel.y = this.oy + 406;
    this.serverCreationNameLabel.tint = 16777215;
    this.container.addChild(this.serverCreationNameLabel);
    this.nameField = new InputField("name");
    this.nameField.setDimensions(280, 35);
    this.nameField.forceLowerCase = !1;
    this.nameField.setMaxChars(20);
    this.nameField.x = this.ox + 54;
    this.nameField.y = this.oy + 438;
    this.nameField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-& !*"
    );
    this.container.addChild(this.nameField);
    this.serverCreationPasswordLabel = new PIXI.BitmapText("Password", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationPasswordLabel.x = this.nameField.x + this.nameField.width + 16;
    this.serverCreationPasswordLabel.y = this.oy + 406;
    this.serverCreationPasswordLabel.tint = 16777215;
    this.container.addChild(this.serverCreationPasswordLabel);
    this.passwordField = new InputField("password");
    this.passwordField.setDimensions(110, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(8);
    this.passwordField.setPassword(!0);
    this.passwordField.x = this.nameField.x + this.nameField.width + 32;
    this.passwordField.y = this.oy + 438;
    this.passwordField.setFilter("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890");
    this.container.addChild(this.passwordField);
    this.serverCreationModeLabel = new PIXI.BitmapText("Mode", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationModeLabel.x = this.ox + 44;
    this.serverCreationModeLabel.y = this.oy + 250;
    this.serverCreationModeLabel.tint = 16777215;
    this.container.addChild(this.serverCreationModeLabel);
    this.modeList = new Dropdown("modeSelect", "", 200, 200);
    this.modeList.addListener(Button.BUTTON_RELEASED, (a) => this.onModeListSelect(a.data.value));
    this.modeList.x = this.ox - 10;
    this.modeList.y = this.oy + 290;
    this.modeList.addItem("Deathmatch", Game.MODE_DM, "", App.CombinedTextures.dm_icon_notxt);
    this.modeList.addItem(
      "Team Deathmatch",
      Game.MODE_TDM,
      "",
      App.CombinedTextures.tdm_icon_notxt
    );
    this.modeList.addItem(
      "Capture the flag",
      Game.MODE_CTF,
      "",
      App.CombinedTextures.ctf_icon_notxt
    );
    this.modeList.addItem("Dodgeball", Game.MODE_DB, "", App.CombinedTextures.db_icon_notxt);
    this.modeList.scale.x = this.modeList.scale.y = 0.9;
    this.container.addChild(this.modeList);
    this.serverCreationDurationLabel = new PIXI.BitmapText("Duration", {
      fontName: "Open Sans",
      fontSize: 24,
    });
    this.serverCreationDurationLabel.x = this.ox + 244;
    this.serverCreationDurationLabel.y = this.oy + 250;
    this.serverCreationDurationLabel.tint = 16777215;
    this.container.addChild(this.serverCreationDurationLabel);
    this.durationList = new Dropdown("duration", "", 120, 120);
    this.durationList.addListener(Button.BUTTON_RELEASED, (a) =>
      this.onDurationListSelect(a.data.value)
    );
    this.durationList.x = this.ox + 190;
    this.durationList.y = this.oy + 290;
    this.durationList.addItem("30 min", ServerCreationMenu.DURATION_A, "");
    this.durationList.addItem("1 hour", ServerCreationMenu.DURATION_B, "");
    this.durationList.addItem("1.5 hours", ServerCreationMenu.DURATION_C, "");
    this.durationList.addItem("2 hours", ServerCreationMenu.DURATION_D, "");
    this.durationList.addItem("3 hours", ServerCreationMenu.DURATION_E, "");
    this.durationList.addItem("4 hours", ServerCreationMenu.DURATION_F, "");
    this.durationList.addItem("6 hours", ServerCreationMenu.DURATION_G, "");
    this.durationList.scale.x = this.durationList.scale.y = 0.9;
    this.durationList.setValue(this.duration);
    this.container.addChild(this.durationList);
    this.serverCreationEndLabel = new PIXI.BitmapText("(last round will complete)", {
      fontName: "Open Sans",
      fontSize: 20,
    });
    this.serverCreationEndLabel.x = this.durationList.x + this.durationList.width + 12;
    this.serverCreationEndLabel.y = this.durationList.y - 2;
    this.serverCreationEndLabel.tint = 16763904;
    this.container.addChild(this.serverCreationEndLabel);
    this.serverList = new Dropdown("serverSelect", "Region", 180, 256);
    this.serverList.x = this.ox + 40;
    this.serverList.y = this.oy + 70;
    this.serverList.addListener(Button.BUTTON_RELEASED, (a) => {
      this.emit(Layer.Events.SERVER_CREATION_REGION, a.data.value);
    });
    this.container.addChild(this.serverList);
    this.serverList.setTint(16777215);
    this.updatePrice();
  }
  show() {
    super.show();
    Dropdown.AddInstance(this.serverList);
    Dropdown.AddInstance(this.durationList);
    Dropdown.AddInstance(this.modeList);
    this.serverList.clear();
    for (var a = 0; a < App.Servers.length; a++) {
      let b = App.Servers[a];
      this.serverList.addItem(b.title, b.id, b.players + " players");
    }
    0 < App.Servers.length &&
      (void 0 !== App.ConnectedServer.id
        ? this.serverList.setValue(App.ConnectedServer.id)
        : this.serverList.setValue(App.Servers[Math.floor(Math.random() * App.Servers.length)].id));
  }
  onModeListSelect(a) {
    this.mode = a;
    this.updatePrice();
  }
  onDurationListSelect(a) {
    this.duration = a;
    this.updatePrice();
  }
  onSetPrivate(a) {
    this.isPrivate = a;
    this.updatePrice();
  }
  onSetRanked(a) {
    this.isRanked = a;
    this.updatePrice();
  }
  onSetCustom(a) {
    this.isCustom = a;
    this.updatePrice();
    a
      ? ((this.customizationButton.alpha = 1), (this.customizationButton.interactive = !0))
      : ((this.customizationButton.alpha = 0.5), (this.customizationButton.interactive = !1));
  }
  updatePrice() {
    let a = 100;
    this.isPrivate
      ? ((a += 100),
        (this.serverCreationPasswordLabel.alpha = 1),
        (this.passwordField.alpha = 1),
        (this.passwordField.interactive = !0))
      : ((this.serverCreationPasswordLabel.alpha = 0.5),
        (this.passwordField.alpha = 0.5),
        this.passwordField.setText(""),
        (this.passwordField.interactive = !1));
    this.isRanked && (a += 0);
    this.isCustom && (a += 0);
    a += ServerCreationMenu.DURATION_PRICE_MAP[this.duration];
    this.serverCreationPriceValue.text = a.toString();
  }
  onCustomizeServerInit() {
    this.customizationMenu.setMode(this.mode);
    this.container.addChild(this.customizationMenu);
  }
  onCreateServerCancel() {
    this.enableCreationInput();
    this.hideConfirmationContainer();
  }
  setErrorMessage(a = "") {
    this.errorMessage.text = a;
    this.errorMessage.x = 0.5 * (this.confirmationBackground.width - this.errorMessage.width);
  }
  onClientConnect() {
    this.setErrorMessage("");
  }
  onClientDisconnect() {}
  async onCreateServerInit() {
    this.disableCreationInput();
    this.setErrorMessage();
    this.confirmationAccept.enable();
    this.confirmationDecline.enable();
    this.container.addChild(this.confirmationContainer);
    await App.Layer.updateCredentialsIfExpired();
    App.Client.isConnected() ||
      (App.Client.hasListener(Client.CONNECT, this.onClientConnect) ||
        App.Client.addListener(Client.CONNECT, this.onClientConnectBinding),
      App.Client.connect(),
      this.setErrorMessage("Connecting.. please wait."));
  }
  hideConfirmationContainer() {
    this.container.removeChild(this.confirmationContainer);
  }
  disableCreationInput() {
    this.createButton.interactive = !1;
    this.createButton.alpha = 0.5;
    this.closeButton.setEnabled(!1);
    this.modeList.interactive = !1;
    this.modeList.alpha = 0.5;
    this.modeList.collapse();
    this.serverList.interactive = !1;
    this.serverList.alpha = 0.5;
    this.serverList.collapse();
    this.durationList.interactive = !1;
    this.durationList.alpha = 0.5;
    this.durationList.collapse();
    this.nameField.interactive = !1;
    this.nameField.alpha = 0.5;
    this.setPrivate.setEnabled(!1);
    this.setRanked.setEnabled(!1);
    this.setCustom.setEnabled(!1);
    this.isCustom &&
      ((this.customizationButton.interactive = !1), (this.customizationButton.alpha = 0.5));
    this.isPrivate && ((this.passwordField.interactive = !1), (this.passwordField.alpha = 0.5));
  }
  enableCreationInput() {
    this.createButton.interactive = !0;
    this.createButton.alpha = 1;
    this.closeButton.setEnabled(!0);
    this.modeList.interactive = !0;
    this.modeList.alpha = 1;
    this.serverList.interactive = !0;
    this.serverList.alpha = 1;
    this.durationList.interactive = !0;
    this.durationList.alpha = 1;
    this.isCustom &&
      ((this.customizationButton.interactive = !0), (this.customizationButton.alpha = 1));
    this.nameField.interactive = !0;
    this.nameField.alpha = 1;
    this.setPrivate.setEnabled(!0);
    this.setRanked.setEnabled(!0);
    this.setCustom.setEnabled(!0);
    this.isPrivate && ((this.passwordField.interactive = !0), (this.passwordField.alpha = 1));
  }
  async onCreateServerConfirm() {
    if (App.Client.isConnected()) {
      this.confirmationAccept.disable();
      this.confirmationDecline.disable();
      var a = App.ConnectedServer.id,
        b =
          (this.isPrivate ? "private," : "") +
          (this.isCustom ? "custom," : "") +
          (this.isRanked ? "ranked" : ""),
        c = this.mode,
        d = this.duration,
        e = this.nameField.getText().trim(),
        f = this.passwordField.getText().trim(),
        g = App.Credential.id,
        h = {
          weapons: this.isCustom ? this.customization.weapons.map((k) => k.substr(1)) : [],
          maps: this.customization.maps,
          drops: this.customization.drops,
          shuriken: this.customization.shuriken,
        };
      (a = await APIClient.postCreateGame(a, b, c, d, e, f, h, g)) && !0 === a.success
        ? (this.disableCreationInput(),
          (this.createdServerName = a.token.name),
          (this.createdServerId = a.token.gameId),
          this.emit(Layer.Events.SERVER_CREATION_SESSION_INIT, a.token))
        : (this.setErrorMessage(a.error),
          this.confirmationAccept.enable(),
          this.confirmationDecline.enable());
    } else this.setErrorMessage("Not connected to any server.");
  }
  setCreatedStatus(a) {
    this.confirmationAccept.enable();
    this.confirmationDecline.enable();
    a.success
      ? (this.hideConfirmationContainer(), this.container.addChild(this.successContainer))
      : this.setErrorMessage(a.info);
  }
  onSuccessJoinGameAccept() {
    this.enableCreationInput();
    this.container.removeChild(this.successContainer);
    if (-1 !== this.createdServerId) {
      let a = this.passwordField.getText().trim();
      this.emit(Layer.Events.JOIN_GAME, this.createdServerName, this.createdServerId, a);
      this.createdServerId = -1;
      this.createdServerName = "";
    }
  }
  onSuccessToLobbyAccept() {
    this.enableCreationInput();
    this.container.removeChild(this.successContainer);
    this.emit(Layer.Events.SERVER_CREATION_JOIN_LOBBY);
    this.createdServerId = -1;
    this.createdServerName = "";
  }
}
ServerCreationMenu.DURATION_A = "30m";
ServerCreationMenu.DURATION_B = "60m";
ServerCreationMenu.DURATION_C = "90m";
ServerCreationMenu.DURATION_D = "120m";
ServerCreationMenu.DURATION_E = "180m";
ServerCreationMenu.DURATION_F = "240m";
ServerCreationMenu.DURATION_G = "360m";
ServerCreationMenu.DURATION_PRICE_MAP = {
  [ServerCreationMenu.DURATION_A]: 50,
  [ServerCreationMenu.DURATION_B]: 100,
  [ServerCreationMenu.DURATION_C]: 200,
  [ServerCreationMenu.DURATION_D]: 300,
  [ServerCreationMenu.DURATION_E]: 400,
  [ServerCreationMenu.DURATION_F]: 500,
  [ServerCreationMenu.DURATION_G]: 600,
};
var chatclient = {};
class ChatClient extends PIXI.utils.EventEmitter {
  constructor() {
    super();
    this.socket = null;
  }
  connect(a) {
    this.socket && this.socket.readyState !== WebSocket.CLOSED && this.disconnect();
    a = -1 === window.location.hostname.indexOf("local") ? !0 : !1;
    let b = btoa(JSON.stringify(App.Credential));
    this.socket = new WebSocket(
      (a ? "wss" : "ws") + "://" + (a ? ChatClient.SERVER_DOMAIN : "localhost") + "?auth=" + b
    );
    this.socket.binaryType = "arraybuffer";
    this.socket.onopen = this.onOpen.bind(this);
    this.socket.onmessage = this.onMessage.bind(this);
    this.socket.onclose = this.onClose.bind(this);
    this.socket.onerror = this.onError.bind(this);
  }
  disconnect() {
    this.socket.close();
  }
  onOpen(a) {
    this.emit(ChatClient.CONNECT);
  }
  onMessage(a) {
    let b;
    try {
      b = JSON.parse(a.data);
    } catch (c) {
      return;
    }
    switch (b.type) {
      case ChatClient.TYPE_MSG:
        this.emit(ChatClient.MESSAGE, b);
        break;
      case ChatClient.TYPE_STATUS:
        this.emit(ChatClient.STATUS, b);
    }
  }
  onClose(a) {
    this.emit(ChatClient.DISCONNECT);
  }
  onError(a) {
    console.log("Chat client connection error");
  }
  compose(a = ChatClient.TYPE_MSG, b) {
    a = { type: a };
    void 0 !== b && (a.msg = b);
    return JSON.stringify(a);
  }
  send(a = ChatClient.TYPE_MSG, b) {
    this.socket.readyState === WebSocket.OPEN && ((a = this.compose(a, b)), this.socket.send(a));
  }
  isConnected() {
    return null !== this.socket && this.socket.readyState === WebSocket.OPEN;
  }
}
ChatClient.TYPE_LOCAL = -1;
ChatClient.TYPE_JOIN_CLAN_CHAT = 0;
ChatClient.TYPE_LEAVE_CLAN_CHAT = 1;
ChatClient.TYPE_MSG = 2;
ChatClient.TYPE_STATUS = 3;
ChatClient.MSG_PUBLIC = 0;
ChatClient.MSG_CLAN = 1;
ChatClient.MSG_FRIEND = 2;
ChatClient.SERVER_DOMAIN = "api.ninja.io:8081";
ChatClient.SERVER_PORT = 8081;
ChatClient.CONNECT = "connect";
ChatClient.DISCONNECT = "disconnect";
ChatClient.MESSAGE = "message";
ChatClient.STATUS = "status";
var clanchatmenu = {};
class ClanChatMenu extends Feature {
  constructor() {
    super();
    this.client = new ChatClient();
    this.client.on(ChatClient.CONNECT, () => this.onConnect());
    this.client.on(ChatClient.DISCONNECT, () => this.onDisconnect());
    this.client.on(ChatClient.MESSAGE, (a) => this.onMessage(a));
    this.client.on(ChatClient.STATUS, (a) => this.onStatus(a));
    this.messages = [];
    this.lines = [];
    this.down = this.dragging = !1;
    this.background = new PIXI.Graphics();
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRoundedRect(0, 0, 400, 320, 4);
    this.background.interactive = !0;
    this.container.addChild(this.background);
    this.background.on("mousedown", (a) => {
      a.stopPropagation();
      this.down = !0;
      this.ox = a.data.global.x;
      this.oy = a.data.global.y;
    });
    this.background.on("mouseup", (a) => {
      a.stopPropagation();
      this.down = this.dragging = !1;
    });
    this.background.on("mousemove", (a) => {
      if (this.down) {
        let b = a.data.global.x;
        a = a.data.global.y;
        let c = b - this.ox,
          d = a - this.oy;
        this.x += c;
        this.y += d;
        this.ox = b;
        this.oy = a;
        0 < Math.sqrt(c * c + d * d) && (this.dragging = !0);
      }
    });
    this.title = new PIXI.BitmapText(App.Credential.clan_name + " clan chat", {
      fontName: "Open Sans",
      fontSize: 22,
    });
    this.title.x = 4;
    this.title.y = 3;
    this.title.tint = 16763904;
    this.container.addChild(this.title);
    this.inputField = new InputField("chat_msg");
    this.inputField.setDimensions(400, 30);
    this.inputField.forceLowerCase = !1;
    this.inputField.setMaxChars(72);
    this.inputField.x = 0;
    this.inputField.y = this.height - 30;
    this.inputField.setFilter(
      UserInput.ALPHANUMERIC + UserInput.CHAT_SYMBOLS + UserInput.ALPHA_EXT
    );
    this.inputField.addListener(InputField.SUBMIT, (a) => this.onSubmitMessage(a.data.value));
    this.container.addChild(this.inputField);
    this.closeButton = new PIXI.Sprite(App.CombinedTextures.exit);
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.alpha = 0.5;
    this.closeButton.interactive = !0;
    this.closeButton.x = this.width - 28;
    this.closeButton.y = 2;
    this.closeButton.on("mousedown", (a) => {
      this.closeButton.alpha = 0.5;
      this.emit(Layer.Events.CLAN_CHAT_CANCEL);
      AudioEffects.ButtonClick.audio.play();
    });
    this.closeButton.on("mouseover", (a) => {
      this.closeButton.alpha = 1;
      AudioEffects.ButtonHover.audio.play();
    });
    this.closeButton.on("mouseout", (a) => {
      this.closeButton.alpha = 0.5;
    });
    this.container.addChild(this.closeButton);
    for (let a = 0; a < ClanChatMenu.MaxMessages; a++) {
      const b = new PIXI.BitmapText("", {
        fontName: "Open Sans",
        fontSize: 22,
        multiline: !0,
        align: "left",
      });
      b.x = 5;
      b.maxWidth = 360;
      b.interactive = !1;
      b.hitArea = new PIXI.Rectangle(0, 0, 0, 0);
      this.addChild(b);
      this.lines.push(b);
    }
  }
  async onSubmitMessage(a) {
    a = a.trim();
    0 < a.length && this.client.send(ChatClient.TYPE_MSG, a);
    this.inputField.setText("");
    this.inputField.setFocus(!0);
  }
  onMessage(a) {
    this.addMessage(a);
  }
  onStatus(a) {
    this.title.text = App.Credential.clan_name + " clan chat [" + a.online + " online]";
  }
  addMessage(a) {
    this.messages.length === ClanChatMenu.MaxMessages && this.messages.shift();
    this.messages.push(a);
    this.updateConversation();
  }
  updateConversation() {
    let a = 290;
    for (let b = this.messages.length - 1; 0 <= b; b--) {
      const c = this.messages[b],
        d = this.lines[b];
      -1 === c.id
        ? ((d.text = c.msg), (d.tint = 16776960))
        : -2 === c.id
        ? ((d.text = c.msg), (d.tint = 16711680))
        : ((d.text = c.from + ": " + c.msg), (d.tint = 16777215));
      a -= d.height + 3;
      d.y = a;
      d.alpha = 16 > a ? 0 : 1;
    }
  }
  addLocalInfoMessage(a) {
    this.addMessage({ type: ChatClient.TYPE_LOCAL, from: "local", id: -1, msg: a });
  }
  removeMessages() {
    for (let a = 0; a < this.messages.length; a++) {
      let b = this.messages[a];
      b.msg = "";
      b.id = -1;
      b.from = "";
    }
    this.updateConversation();
  }
  onConnect() {
    this.title.text = App.Credential.clan_name + " clan chat [connected]";
    this.client.send(ChatClient.TYPE_JOIN_CLAN_CHAT);
  }
  onDisconnect() {
    this.title.text = App.Credential.clan_name + " clan chat [disconnected]";
  }
  show() {
    super.show();
    this.title.text = App.Credential.clan_name + " clan chat [connecting]";
    this.client.connect();
  }
  hide() {
    super.hide();
    this.client.disconnect();
    this.removeMessages();
  }
}
ClanChatMenu.MaxMessages = 12;
var clanmenu = {};
class ClanMenu extends Feature {
  constructor() {
    super();
    this.searchTimeout = null;
    this.members = [];
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.interactive = !0;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504, 10);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.background.beginFill(6710886, 0.3);
    this.background.drawRoundedRect(24, 48, 48, 48, 4);
    this.background.endFill();
    this.background.drawRoundedRect(22, 138, 307, 356, 4);
    this.background.endFill();
    this.background.beginFill(6710886, 0.3);
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.drawRoundedRect(340, 138, 296, 190, 8);
    this.background.endFill();
    this.container.addChild(this.background);
    this.ox = 40;
    this.oy = 20;
    this.searchValue = "";
    this.titleText = new PIXI.Text("Clan profile", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.titleText.x = 0.5 * this.width - 20;
    this.titleText.y = this.oy + 36;
    this.titleText.anchor.x = 0.5;
    this.container.addChild(this.titleText);
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.CLAN_CANCEL));
    this.container.addChild(this.closeButton);
    this.uploadText = new PIXI.Text("Clan\nbanner", {
      fontName: "Arial",
      fontSize: 12,
      fill: 12303291,
      strokeThickness: 2,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 80,
      align: "center",
    });
    this.uploadText.x = this.ox - 12;
    this.uploadText.y = this.oy + 76;
    this.container.addChild(this.uploadText);
    this.nameText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.nameText.x = this.ox + 44;
    this.nameText.y = this.oy + 78;
    this.container.addChild(this.nameText);
    this.memberText = new PIXI.Text("- members", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.memberText.x = this.ox - 14;
    this.memberText.y = this.oy + 128;
    this.container.addChild(this.memberText);
    this.statsText = new PIXI.Text("Clan statistics", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.statsText.x = this.ox + 300;
    this.statsText.y = this.oy + 128;
    this.container.addChild(this.statsText);
    this.levelIcon = new PIXI.Sprite();
    this.levelIcon.x = this.ox + 305;
    this.levelIcon.y = this.oy + 180;
    this.levelIcon.scale.x = this.levelIcon.scale.y = 0.5;
    this.container.addChild(this.levelIcon);
    this.levelLabel = new PIXI.Text("Avg. level", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelLabel.x = this.ox + 314;
    this.levelLabel.y = this.oy + 164;
    this.container.addChild(this.levelLabel);
    this.levelText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelText.x = this.ox + 341;
    this.levelText.y = this.oy + 188;
    this.container.addChild(this.levelText);
    this.levelRankLabel = new PIXI.Text("Level rank", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelRankLabel.x = this.ox + 314;
    this.levelRankLabel.y = this.oy + 218;
    this.container.addChild(this.levelRankLabel);
    this.levelRankText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.levelRankText.x = this.ox + 314;
    this.levelRankText.y = this.oy + 242;
    this.container.addChild(this.levelRankText);
    this.skillRankLabel = new PIXI.Text("Skill rank", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillRankLabel.x = this.ox + 314;
    this.skillRankLabel.y = this.oy + 272;
    this.container.addChild(this.skillRankLabel);
    this.skillRankText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.skillRankText.x = this.ox + 314;
    this.skillRankText.y = this.oy + 296;
    this.container.addChild(this.skillRankText);
    this.killsLabel = new PIXI.Text("Kills", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsLabel.x = this.ox + 460;
    this.killsLabel.y = this.oy + 164;
    this.container.addChild(this.killsLabel);
    this.killsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.killsText.x = this.ox + 460;
    this.killsText.y = this.oy + 188;
    this.container.addChild(this.killsText);
    this.deathsLabel = new PIXI.Text("Deaths", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.deathsLabel.x = this.ox + 460;
    this.deathsLabel.y = this.oy + 218;
    this.container.addChild(this.deathsLabel);
    this.deathsText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.deathsText.x = this.ox + 460;
    this.deathsText.y = this.oy + 242;
    this.container.addChild(this.deathsText);
    this.ctfLabel = new PIXI.Text("CTF caps", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16746496,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.ctfLabel.x = this.ox + 460;
    this.ctfLabel.y = this.oy + 272;
    this.container.addChild(this.ctfLabel);
    this.ctfText = new PIXI.Text("Loading..", {
      fontName: "Arial",
      fontSize: 17,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.ctfText.x = this.ox + 460;
    this.ctfText.y = this.oy + 296;
    this.container.addChild(this.ctfText);
    this.createdText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 15,
      fill: 13412864,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.createdText.x = 478;
    this.createdText.y = this.oy + 72;
    this.container.addChild(this.createdText);
    this.listContainer = new PIXI.Container();
    this.listContainer.x = this.ox - 14;
    this.listContainer.y = this.oy + 122;
    this.memberListContainer = new PIXI.Container();
    this.listContainer.addChild(this.memberListContainer);
    this.container.addChild(this.listContainer);
    this.scrollbar = new ClanMemberListScrollbar(350);
    this.scrollbar.x = this.ox + 265;
    this.scrollbar.y = this.oy + 166;
    this.scrollbar.on(ClanMemberListScrollbar.SCROLL, (a) => {
      this.maskMemberList(a);
    });
    this.container.x = 0.5 * -this.width;
  }
  show(a) {
    super.show();
    this.loadClan(a);
    this.scrollbar.enableWheel();
  }
  hide() {
    this.scrollbar.disableWheel();
  }
  async loadClan(a) {
    var b = await APIClient.getClanByClanId(a);
    if (b.success) {
      var c = b.clan,
        d = new Date(Date.parse(c.created)),
        e = d.getFullYear(),
        f = d.getMonth() + 1;
      d = d.getDate();
      e = e.toString() + "-" + f.toString().padStart(2, "0") + "-" + d.toString().padStart(2, "0");
      f = Math.min(
        Math.max(
          Math.floor(0.2 * Math.sqrt(parseInt(c.experience) / parseInt(b.memberCount) / 15.625)),
          1
        ),
        160
      );
      d = Math.max(Math.floor((f / 160) * 10) + 1);
      this.nameText.text = c.name;
      this.memberText.text = b.memberCount + " members";
      this.createdText.text = "Founded on " + e;
      this.levelText.text = numberWithPeriods(f);
      this.levelIcon.texture = App.CombinedTextures["skill_icon_" + d];
      this.levelRankText.text = c.experience_ranking.toString();
      this.skillRankText.text =
        c.skill_ranking.toString() +
        "\n" +
        Game.MapSkillToTitle(parseInt(c.skill) / parseInt(b.memberCount));
      this.killsText.text = numberWithPeriods(c.kills);
      this.deathsText.text = numberWithPeriods(c.deaths);
      this.ctfText.text = numberWithPeriods(c.caps);
      b = await APIClient.getClanMembers(a);
      if (b.success) {
        this.members = [];
        this.memberListContainer.removeChildren();
        a = b.members;
        for (b = 0; b < a.length; b++)
          (c = a[b]),
            (c = new ClanMemberMenuItem(c.id, c.name, c.role, {})),
            (c.x = 0),
            (c.y = 47 + b * ClanMemberListScrollbar.ItemHeight),
            c.on(ClanMenu.ACCESS_PROFILE, (g) => this.emit(Layer.Events.USER_ACCESS, g)),
            this.members.push(c),
            this.members.length <
              Math.floor(ClanMemberListScrollbar.ListHeight / ClanMemberListScrollbar.ItemHeight) &&
              this.memberListContainer.addChild(c);
        this.members.length >
        Math.floor(ClanMemberListScrollbar.ListHeight / ClanMemberListScrollbar.ItemHeight)
          ? this.container.addChild(this.scrollbar)
          : this.container.removeChild(this.scrollbar);
        this.scrollbar.reset();
        this.maskMemberList(0);
      }
    }
  }
  maskMemberList(a) {
    let b = Math.floor(ClanMemberListScrollbar.ListHeight / ClanMemberListScrollbar.ItemHeight);
    if (this.members.length <= b) this.memberListContainer.y = 0;
    else {
      this.memberListContainer.removeChildren();
      this.memberListContainer.y = -(
        a *
        (this.members.length * ClanMemberListScrollbar.ItemHeight -
          (ClanMemberListScrollbar.ListHeight - ClanMemberListScrollbar.ItemHeight))
      );
      a = this.memberListContainer.y;
      var c = Math.round(Math.abs(a / ClanMemberListScrollbar.ItemHeight));
      for (let e = 0; e < b; e++) {
        let f = this.members[c + e];
        this.memberListContainer.addChild(f);
        if (0 === e) {
          var d = c * ClanMemberListScrollbar.ItemHeight + a;
          f.alpha = 0 <= d ? 1 : 1 - (1 / (0.5 * ClanMemberListScrollbar.ItemHeight)) * Math.abs(d);
        } else
          e === b - 1
            ? ((d = c * ClanMemberListScrollbar.ItemHeight + a),
              (f.alpha =
                0 > d ? 1 : 1 - (1 / (0.5 * ClanMemberListScrollbar.ItemHeight)) * Math.abs(d)))
            : (f.alpha = 1);
      }
    }
  }
}
ClanMenu.ACCESS_PROFILE = "accessProfile";
class ClanMemberListScrollbar extends PIXI.Container {
  constructor(a, b = 0) {
    super();
    this.scrolling = !1;
    this.start = b;
    this.h = a;
    this.bh = this.h - 39;
    this.oy = 0;
    this.scrollBar = new PIXI.Graphics();
    this.scrollBar.lineStyle(1, 16777215, 0.4, 0);
    this.scrollBar.drawRoundedRect(0, -5, 20, this.h, 4);
    this.scrollBar.endFill();
    this.scrollBar.x = 0;
    this.scrollBar.y = 0;
    this.scrollBar.interactive = !0;
    this.scrollBar.alpha = 0.5;
    this.addChild(this.scrollBar);
    this.scrollBar.hitArea = new PIXI.Rectangle(-10, -2, 50, this.h + 30);
    this.scrollButton = new PIXI.Graphics();
    this.scrollButton.lineStyle(1, 16777215, 0.4, 0);
    this.scrollButton.beginFill(16777215, 0.2);
    this.scrollButton.drawRoundedRect(0, -3, 16, 35, 4);
    this.scrollButton.endFill();
    this.addChild(this.scrollButton);
    this.scrollButton.x = 2;
    this.scrollButton.y = this.bh * this.start;
    this.scrollBar.on("mouseover", () => {
      this.scrollBar.alpha = 1;
    });
    this.scrollBar.on("mouseout", () => {
      this.scrollBar.alpha = 0.5;
    });
    this.scrollBar.on("mouseupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("mousedown", (c) => {
      c.stopPropagation();
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
    });
    this.scrollBar.on("mouseup", (c) => {
      c.stopPropagation();
      this.scrolling = !1;
    });
    this.scrollBar.on("mousemove", (c) => {
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointerup", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerupoutside", () => {
      this.scrolling = !1;
    });
    this.scrollBar.on("pointerdown", (c) => {
      this.scrolling = !0;
      this.oy = c.data.global.y / App.Scale;
      this.scroll(c.data.global.y);
    });
    this.scrollBar.on("pointermove", (c) => this.scroll(c.data.global.y));
    this.wheelListener = (c) => {
      c = c.data.delta;
      this.scrolling = !0;
      this.scroll(this.oy + 0.2 * c);
      this.scrolling = !1;
    };
  }
  enableWheel() {
    UserInput.hasListener(UserInput.WHEEL, this.wheelListener) ||
      UserInput.addListener(UserInput.WHEEL, this.wheelListener);
  }
  disableWheel() {
    UserInput.removeListener(UserInput.WHEEL, this.wheelListener);
  }
  scroll(a) {
    if (this.scrolling) {
      a /= App.Scale;
      let b = this.scrollButton.y + (a - this.oy);
      b = 0 > b ? 0 : b > this.bh ? this.bh : b;
      let c = (1 / this.h) * b * (this.h / this.bh);
      this.scrollButton.y = b;
      this.oy = a;
      this.emit(ClanMemberListScrollbar.SCROLL, c);
    }
  }
  reset() {
    this.scrollButton.y = (this.h - 39) * this.start;
  }
  onMouseOver() {
    this.scrollButton.alpha = 1;
  }
  onMouseOut() {
    this.scrollButton.alpha = 0.5;
  }
}
ClanMemberListScrollbar.SCROLL = "scroll";
ClanMemberListScrollbar.ListHeight = 355;
ClanMemberListScrollbar.ItemHeight = 30;
class ClanMemberMenuItem extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.id = a;
    this.name = b;
    this.role = c;
    this.options = d;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRoundedRect(0, 0, 276, 26, 4);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.alpha = 0.5;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.5;
    });
    this.background.on("mousedown", () => this.emit(ClanMenu.ACCESS_PROFILE, this.id));
    this.addChild(this.background);
    this.nameLabel = new PIXI.BitmapText(this.name, {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
    });
    this.nameLabel.x = 8;
    this.nameLabel.y = 2;
    this.addChild(this.nameLabel);
    if ("captain" === this.role || "leader" === this.role)
      (this.roleLabel = new PIXI.BitmapText(this.role, {
        fontName: "Open Sans",
        fontSize: 22,
        align: "left",
      })),
        (this.roleLabel.x = 270 - this.roleLabel.width),
        (this.roleLabel.y = 2),
        (this.roleLabel.tint = "leader" === this.role ? 8978312 : 16746632),
        this.addChild(this.roleLabel);
  }
}
var loadingmenu = {};
class LoadingMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 0;
    this.background.beginFill(0, 0);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.lineStyle(3, 11184810, 0.5, 0);
    this.background.beginFill(0, 0.8);
    this.background.drawRoundedRect(130, 100, 400, 140, 8);
    this.background.endFill();
    this.container.addChild(this.background);
    this.background.hitArea = new PIXI.Rectangle(0, 0, 660, 524);
    this.background.interactive = !0;
    this.cancelCount = LoadingMenu.CANCEL_COUNT;
    this.title = new PIXI.BitmapText("Loading...", { fontName: "Open Sans", fontSize: 30 });
    this.title.x = 290;
    this.title.y = 150;
    this.title.tint = 16763904;
    this.container.addChild(this.title);
    this.container.x = 0.5 * -this.container.width;
    this.container.y = 40;
    this.visualizer = new Visualizer(176, 176, !1, !1, !0);
    this.visualizer.scale.x = -0.7;
    this.visualizer.scale.y = 0.7;
    this.visualizer.x = 268;
    this.visualizer.y = 110;
    this.container.addChild(this.visualizer);
    this.cancelButton = new Button("cancel");
    this.cancelButton.selected = !0;
    this.cancelButton.setText("Cancel");
    this.cancelButton.scale.x = this.cancelButton.scale.y = 0.8;
    this.cancelButton.addListener(Button.BUTTON_RELEASED, () =>
      this.emit(Layer.Events.LOADING_CANCEL)
    );
    this.cancelButton.x = this.title.x + 0.5 * (this.title.width - this.cancelButton.width);
    this.cancelButton.y = this.title.y + 40;
    this.cancelButton.setTint(16763904);
    this.container.addChild(this.cancelButton);
    this.cancelButton.visible = !1;
  }
  update() {
    this.visualizer.update();
    0 === this.cancelCount ? (this.cancelButton.visible = !0) : this.cancelCount--;
  }
  show() {
    this.cancelButton.visible = !1;
    this.cancelCount = LoadingMenu.CANCEL_COUNT;
    this.visualizer.applyCustomization(App.Credential.customization);
    this.setTitle("Loading...");
  }
  setTitle(a) {
    this.title.text = a;
  }
}
LoadingMenu.CANCEL_COUNT = 60;
var renamemenu = {};
class RenameMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.2, 0);
    this.background.beginFill(0, 0.4);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(120, 88, 420, 348, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(130, 97, 400, 330, 10);
    this.background.endFill();
    this.background.interactive = !0;
    this.container.addChild(this.background);
    this.ox = 160;
    this.oy = 108;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 160;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.RENAME_CANCEL));
    this.container.addChild(this.closeButton);
    this.loginTitle = new PIXI.Text("Complete registration", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.loginTitle.x = this.ox - 10;
    this.loginTitle.y = this.oy + 48;
    this.container.addChild(this.loginTitle);
    this.renameDescription = new PIXI.Text(
      "Choose a username and a password.\nAll your current progress will be saved.",
      {
        fontSize: 16,
        fontFamily: "Arial",
        fill: 15658734,
        lineJoin: "round",
        strokeThickness: 2,
        lineHeight: 24,
        align: "left",
        wordWrap: !0,
        wordWrapWidth: 380,
      }
    );
    this.renameDescription.x = this.ox - 10;
    this.renameDescription.y = this.oy + 88;
    this.container.addChild(this.renameDescription);
    this.usernameTitle = new PIXI.Text("Username", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.usernameTitle.x = this.ox;
    this.usernameTitle.y = this.oy + 140;
    this.container.addChild(this.usernameTitle);
    this.passwordTitle = new PIXI.Text("Password", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16755200,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.passwordTitle.x = this.ox;
    this.passwordTitle.y = this.oy + 200;
    this.container.addChild(this.passwordTitle);
    this.errorMessage = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 16,
      fill: 16711680,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.errorMessage.x = this.ox;
    this.errorMessage.y = this.oy + 310;
    this.nameField = new InputField("rename_name");
    this.nameField.setDimensions(300, 35);
    this.nameField.forceLowerCase = !1;
    this.nameField.setMaxChars(18);
    this.nameField.x = this.ox;
    this.nameField.y = this.oy + 160;
    this.nameField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#^&*-._:=[]"
    );
    this.container.addChild(this.nameField);
    this.passwordField = new InputField("rename_password");
    this.passwordField.setDimensions(300, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(32);
    this.passwordField.setPassword(!0);
    this.passwordField.x = this.ox;
    this.passwordField.y = this.oy + 220;
    this.passwordField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_-.@!#$%^&*()[]"
    );
    this.container.addChild(this.passwordField);
    this.submitButton = new Button("rename");
    this.submitButton.selected = !0;
    this.submitButton.setText("Save");
    this.submitButton.scale.x = this.submitButton.scale.y = 0.8;
    this.submitButton.addListener(Button.BUTTON_RELEASED, this.onSubmitButtonReleased.bind(this));
    this.submitButton.x = this.ox + 11;
    this.submitButton.y = this.oy + 274;
    this.submitButton.setTint(16763904);
    this.container.addChild(this.submitButton);
    this.loadingContainer = new PIXI.Container();
    this.loadingBackground = new PIXI.Graphics();
    this.loadingBackground.x = 0;
    this.loadingBackground.y = 0;
    this.loadingBackground.lineStyle(3, 11184810, 0.5, 0);
    this.loadingBackground.beginFill(0, 0.8);
    this.loadingBackground.drawRoundedRect(0, 0, 300, 80, 10);
    this.loadingBackground.endFill();
    this.loadingContainer.addChild(this.loadingBackground);
    this.loadingText = new PIXI.Text("Updating account...", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.loadingText.x = 0.5 * this.loadingBackground.width;
    this.loadingText.y = 0.5 * this.loadingBackground.height;
    this.loadingText.anchor.x = this.loadingText.anchor.y = 0.5;
    this.loadingContainer.addChild(this.loadingText);
    this.loadingContainer.x = 0.5 * -this.loadingBackground.width;
    this.loadingContainer.y = 0.5 * this.container.height - 0.5 * this.loadingBackground.height;
    this.completedContainer = new PIXI.Container();
    this.completedBackground = new PIXI.Graphics();
    this.completedBackground.x = 0;
    this.completedBackground.y = 0;
    this.completedBackground.lineStyle(3, 11184810, 0.5, 0);
    this.completedBackground.beginFill(0, 0.8);
    this.completedBackground.drawRoundedRect(0, 0, 260, 140, 10);
    this.completedBackground.endFill();
    this.completedContainer.addChild(this.completedBackground);
    this.completedText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
      align: "center",
      wordWrap: !0,
      wordWrapWidth: 330,
    });
    this.completedText.x = 0.5 * this.completedBackground.width;
    this.completedText.y = 0.3 * this.completedBackground.height;
    this.completedText.anchor.x = this.completedText.anchor.y = 0.5;
    this.completedContainer.addChild(this.completedText);
    this.completedButton = new Button("continue");
    this.completedButton.selected = !0;
    this.completedButton.setText("Continue");
    this.completedButton.scale.x = this.completedButton.scale.y = 0.8;
    this.completedButton.addListener(
      Button.BUTTON_RELEASED,
      this.onCompletedButtonReleased.bind(this)
    );
    this.completedButton.x =
      0.5 * this.completedBackground.width - 0.5 * this.completedButton.width;
    this.completedButton.y = this.completedBackground.height - (this.completedButton.height + 16);
    this.completedButton.setTint(16763904);
    this.completedContainer.addChild(this.completedButton);
    this.completedContainer.x = 0.5 * -this.completedBackground.width;
    this.completedContainer.y = 0.5 * this.container.height - 0.5 * this.completedBackground.height;
    this.container.x = 0.5 * -this.width;
  }
  show() {
    this.nameField.setText(App.Credential.username);
  }
  reset() {}
  validateForm() {
    let a = !0,
      b = "",
      c = this.nameField.getText(),
      d = this.passwordField.getText();
    4 > c.length
      ? ((a = !1),
        (b = "Username too short. Use at least 4 characters."),
        this.nameField.markInvalid())
      : this.nameField.markNone();
    a && 8 > d.length
      ? ((a = !1),
        (b = "Password too short. Use at least 8 characters."),
        this.passwordField.markInvalid())
      : this.passwordField.markNone();
    return { valid: a, error: b };
  }
  async onSubmitButtonReleased() {
    var a = this.validateForm();
    a.valid
      ? (this.displayErrorMessage(""),
        this.displayLoadingMessage(),
        (a = await APIClient.postAutogenRename(
          this.nameField.text.text,
          this.passwordField.text.text,
          App.Credential.id
        )),
        this.loadingContainer.parent && this.removeChild(this.loadingContainer),
        (this.container.alpha = 1),
        a.success
          ? (Registry.Instance.remove(Registry.Key.AUTOGEN),
            (App.Autogen = !1),
            this.emit(Layer.Events.RENAME_COMPLETED),
            this.displayCompletedMessage())
          : (this.displayErrorMessage(a.error),
            this.submitButton.enable(),
            this.nameField.markInvalid(),
            (this.nameField.interactive = !0),
            (this.passwordField.interactive = !0)))
      : this.displayErrorMessage(a.error);
  }
  displayLoadingMessage() {
    this.addChild(this.loadingContainer);
    this.submitButton.disable();
    this.nameField.interactive = !1;
    this.passwordField.interactive = !1;
  }
  displayCompletedMessage() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.addChild(this.completedContainer);
    this.submitButton.disable();
    this.completedText.text = "Registration completed.";
    this.nameField.interactive = !1;
    this.passwordField.interactive = !1;
  }
  onCompletedButtonReleased() {
    this.loadingContainer.parent && this.removeChild(this.loadingContainer);
    this.completedContainer.parent && this.removeChild(this.completedContainer);
    this.passwordField.setText("");
    this.emit(Layer.Events.RENAME_CANCEL);
  }
  onCancelButtonReleased() {
    this.emit(Layer.Events.RENAME_CANCEL);
  }
  displayErrorMessage(a) {
    this.errorMessage.text = a;
    this.errorMessage.parent || this.container.addChild(this.errorMessage);
  }
}
var logoutmenu = {};
class LogoutMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.2, 0);
    this.background.beginFill(0, 0.4);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(120, 88, 420, 348, 10);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(130, 97, 400, 330, 10);
    this.background.endFill();
    this.background.interactive = !0;
    this.container.addChild(this.background);
    this.ox = 160;
    this.oy = 108;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 160;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.LOGOUT_CANCEL));
    this.container.addChild(this.closeButton);
    this.loginTitle = new PIXI.Text("Logout", {
      fontName: "Arial",
      fontSize: 19,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.loginTitle.x = this.ox - 10;
    this.loginTitle.y = this.oy + 48;
    this.container.addChild(this.loginTitle);
    this.autogenDescription = new PIXI.Text(
      "Important: No password has been set for this account.\n\nLogging out means you will lose all progress.\n\nClick on 'Complete registration' to save your progress.",
      {
        fontSize: 16,
        fontFamily: "Arial",
        fill: 15658734,
        lineJoin: "round",
        strokeThickness: 2,
        lineHeight: 24,
        align: "left",
        wordWrap: !0,
        wordWrapWidth: 330,
      }
    );
    this.autogenDescription.x = this.ox - 10;
    this.autogenDescription.y = this.oy + 88;
    this.container.addChild(this.autogenDescription);
    this.renameButton = new Button("rename");
    this.renameButton.selected = !0;
    this.renameButton.setText("Complete registration");
    this.renameButton.scale.x = this.renameButton.scale.y = 0.8;
    this.renameButton.addListener(Button.BUTTON_RELEASED, this.onRenameButtonReleased.bind(this));
    this.renameButton.x = this.ox + 4;
    this.renameButton.y = this.oy + 300;
    this.renameButton.setTint(16763904);
    this.container.addChild(this.renameButton);
    this.logoutButton = new Button("logout");
    this.logoutButton.selected = !0;
    this.logoutButton.setText("Logout");
    this.logoutButton.scale.x = this.logoutButton.scale.y = 0.8;
    this.logoutButton.addListener(Button.BUTTON_RELEASED, this.onLogoutButtonReleased.bind(this));
    this.logoutButton.x = this.renameButton.x + this.renameButton.width + 16;
    this.logoutButton.y = this.oy + 300;
    this.logoutButton.setTint(16711680);
    this.container.addChild(this.logoutButton);
    this.container.x = 0.5 * -this.width;
  }
  show() {
    this.loginTitle.text = "Logout - " + App.Credential.username;
  }
  reset() {}
  onRenameButtonReleased() {
    this.emit(Layer.Events.RENAME_ACCESS);
  }
  onLogoutButtonReleased() {
    this.emit(Layer.Events.LOGOUT);
  }
}
var game = {};
class Game extends PIXI.Container {
  constructor(a) {
    super();
    this.sessionId = a;
    this.settings = Registry.Instance[Registry.Key.SETTINGS];
    this.canvas = new Canvas();
    this.manager = new Manager(this.sessionId);
    this.manager.setCamera(this.canvas.getCamera());
    this.manager.mute(!this.settings.sound.enabled);
    this.manager.on(Protocol.GAME, (b) => this.emit(Protocol.GAME, b));
    this.manager.on(ModelEvent.PLAYER_SPAWN, () => this.onPlayerSpawn());
    this.manager.on(ModelEvent.PLAYER_DEATH, (b) => this.onPlayerDeath(b));
    this.manager.on(ModelEvent.PLAYER_SCORE, (b) => this.onPlayerScore(b));
    this.manager.on(ModelEvent.PLAYER_COMBO, () => this.onPlayerCombo());
    this.manager.on(ModelEvent.PLAYER_SPREE, () => this.onPlayerSpree());
    this.manager.on(ModelEvent.DB_ROUND_END, (b) => this.onDbRoundEnd(b));
    this.manager.on(ModelEvent.UPDATE_ENVIRONMENT, () => this.onUpdateEnvironment());
    this.manager.on(ModelEvent.MESSAGE, (b) => this.onModelMessage(b));
    this.manager.on(ModelEvent.INITIAL, () => this.canvas.initial());
    this.manager.on(ModelEvent.SUBMERGE, (b) => this.canvas.onSubmerge(b));
    this.manager.on(ModelEvent.SURFACE, (b) => this.canvas.onSurface(b));
    this.canvas.on(CanvasEvent.MOUSE_DOWN, () => this.onMouseDown());
    this.canvas.on(CanvasEvent.MOUSE_UP, () => this.onMouseUp());
    this.canvas.on(CanvasEvent.RIGHT_DOWN, () => this.onRightDown());
    this.canvas.on(CanvasEvent.RIGHT_UP, () => this.onRightUp());
    this.canvas.on(CanvasEvent.MOUSE_MOVE, (b) => this.onMouseMove(b));
    this.canvas.on(CanvasEvent.REQUEST_LOCAL_OBJECT, (b) => this.manager.requestLocalObject(b));
    this.canvas.on(CanvasEvent.SCALE, (b) =>
      this.canvas.layers.forEach((c) => (c.scale.x = c.scale.y = b))
    );
    this.onKeyDownListener = (b) => this.onKeyDown(b);
    this.onKeyUpListener = (b) => this.onKeyUp(b);
    this.canvas.setManager(this.manager);
    this.clients = {};
    this.numClients = 0;
    this.onDisplayAdButton = this.mode = null;
    this.ignoreMovementJoystickViewing = this.readyToSpawn = !1;
    this.lastJoystickNV = { x: 0, y: 0 };
    this.mutePref = !1;
    this.hud = new Hud(this.manager);
    this.hud.on(HudEvent.SELECT_ITEM, (b) => this.onSelectItem(b));
    this.hud.on(HudEvent.MUTE_SOUND, (b) => {
      this.onMute(b);
    });
    this.hud.on(HudEvent.EXIT, () => this.emit(Layer.Events.DISCONNECT));
    this.inputBuffer = [];
    this.lastInputUpdateTime = 0;
    this.reticle = new PIXI.Sprite(App.CombinedTextures.cursor_def);
    this.reticle.anchor.x = 0.5;
    this.reticle.anchor.y = 0.5;
    this.reticle.alpha = 0.8;
    this.reticle.x = 0.5 * App.ClientWidth;
    this.reticle.y = 0.5 * App.ClientHeight;
    App.IsMobile && (this.reticle.visible = !1);
    this.reticle.hitArea = new PIXI.Rectangle(0, 0, 0, 0);
    this.animTimeout = this.busyTimeout = null;
    this.canvas.layers.forEach((b) => this.addChild(b));
    this.addChild(this.hud);
    this.settings.graphics.reticleLine &&
      ((this.reticleLine = new PIXI.Sprite(App.CombinedTextures.reticle_line)),
      (this.reticleLine.alpha = 0.4),
      (this.reticleLine.anchor.x = 1),
      (this.reticleLine.anchor.y = 0.5),
      this.addChild(this.reticleLine),
      App.IsMobile && (this.reticleLine.visible = !1));
    this.addChild(this.reticle);
    this.gameover = !1;
    this.input = new InputState();
    this.interpreter = new Interpreter(this);
    this.interpreter.addCommand(GameCommands.MESSAGE, (b) => this.onCmdMessage(b));
    this.interpreter.addCommand(GameCommands.CLEAR, () => this.onCmdClear());
    this.interpreter.addCommand(GameCommands.SHUTDOWN, () => this.onCmdShutdown());
    this.interpreter.addCommand(GameCommands.LOAD, (b) => this.onCmdLoad(b));
    this.interpreter.addCommand(GameCommands.SPAWN, () => this.onCmdSpawn());
    this.interpreter.addCommand(GameCommands.PAUSE, () => this.onCmdPause());
    this.interpreter.addCommand(GameCommands.SPECTATE, () => this.onCmdSpectate());
    this.interpreter.addCommand(GameCommands.JOIN, () => this.onCmdJoin());
    this.interpreter.addCommand(GameCommands.KILL, () => this.onCmdKill());
    this.interpreter.addCommand(GameCommands.LOGIN, (b) => this.onCmdLogin(b));
    this.interpreter.addCommand(GameCommands.CLIENTS, () => this.onCmdClients());
    this.interpreter.addCommand(GameCommands.COMMANDS, () => this.onCmdCommands());
    this.interpreter.addCommand(GameCommands.KICK, (b) => this.onCmdKick(b));
    this.interpreter.addCommand(GameCommands.BALANCE, () => this.onCmdBalance());
    this.interpreter.addCommand(GameCommands.PARAMS, () => this.onCmdParams());
    this.interpreter.addCommand(GameCommands.MEMSTATS, () => this.onCmdMemStats());
    this.interpreter.addCommand(GameCommands.WAVE, () => this.onCmdWave());
    this.interpreter.addCommand(GameCommands.SALUTE, () => this.onCmdSalute());
    this.interpreter.setDefaultCommand(GameCommands.MESSAGE);
    App.Console.on(CommandConsole.SHOW, () => this.onShowConsole());
    App.Console.on(CommandConsole.HIDE, () => this.onHideConsole());
    this.onGameDataMap = {
      [Protocol.Game.INFO]: (b) => {
        this.onInfo(b);
      },
      [Protocol.Game.MESSAGE]: (b) => {
        this.onMessage(b);
      },
      [Protocol.Game.STATUS]: (b) => {
        this.onStatus(b);
      },
    };
    this.gameStatusMap = {
      [GameStatus.Player.JOIN]: (b) => {
        this.playerJoined(b);
      },
      [GameStatus.Player.LEAVE]: (b) => {
        this.playerLeft(b);
      },
      [GameStatus.Player.SPEC]: (b) => {
        b.spec ? this.setSpectator(b.sid) : this.setParticipant(b.sid);
      },
      [GameStatus.Player.LIST]: (b) => {
        for (let c = 0, d = b.players.length; c < d; c++) this.playerJoined(b.players[c], !0);
      },
      [GameStatus.Game.RUNNING]: (b) => {
        this.resumeGame(b);
      },
      [GameStatus.Game.PAUSED]: (b) => {
        this.pauseGame();
      },
      [GameStatus.Game.GAMEOVER]: (b) => {
        this.endGame(b);
      },
      [GameStatus.Game.COUNTDOWN]: (b) => {
        this.onNextGameCountdown(b);
      },
      [GameStatus.Game.LEADER]: (b) => {
        this.onLeaderStatus(b);
      },
      [GameStatus.Game.TEAM]: (b) => {
        this.onTeamStatus(b);
      },
      [GameStatus.Settings.WORLD]: (b) => {
        this.applySettings(b.settings);
        this.applyStats(b.stats);
        b.running ? this.resumeGame(b) : this.pauseGame();
      },
    };
    this.frameCount = 0;
    this.player = null;
    this.timeSinceLastUpdate = this.playerFacing = 0;
    this.manager.onPlayerSpawn = (b) => this.clients[b];
    App.Console.linkInterpreter(this.interpreter);
    UserInput.addListener(UserInput.KEY_DOWN, this.onKeyDownListener);
    UserInput.addListener(UserInput.KEY_UP, this.onKeyUpListener);
  }
  onStatus(a) {
    this.gameStatusMap[a.d.t](a.d.s);
  }
  mute(a) {
    this.manager.mute(a ? !0 : !1);
    this.hud.setMuted(a ? !0 : !1);
  }
  step(a) {
    let b = this.manager.getLocalPlayer();
    if (b && b.alive) {
      if (b.primaryItem) {
        var c = b.primaryItem.itemType,
          d = this.reticle.scale.x;
        if (ItemMap[c].resizeReticle) {
          c = ItemMap[c].resizeReticle;
          let e = 0.01 * (b.p.vx * b.p.vx + b.p.vy * b.p.vy),
            f = c.max - c.min,
            g = App.Time - b.lastInjuredTime;
          2e3 > g && (e += 0.01 * (2e3 - g));
          c = c.min + (e * f > f ? f : e * f);
          this.reticle.scale.x = this.reticle.scale.y += c < d ? 0.1 * -(d - c) : 0.1 * (c - d);
        } else 1 !== d && (this.reticle.scale.x = this.reticle.scale.y = 1);
      }
      b.facingChanged &&
        ((this.playerFacing = Math.round(1e3 * b.facing)),
        this.input.update("_", this.playerFacing),
        (b.facingChanged = !1),
        this.reticleLine &&
          this.reticleLine.visible &&
          ((this.reticleLine.x = this.reticle.x),
          (this.reticleLine.y = this.reticle.y),
          (d = 0.5 * App.ClientWidth - this.reticle.x),
          (c = 0.5 * App.ClientHeight - this.reticle.y),
          (d = Math.sqrt(d * d + c * c)),
          (this.reticleLine.scale.x = 0.003 * d),
          (this.reticleLine.alpha = 0.5 < 8e-4 * d ? 0.5 : 8e-4 * d),
          (this.reticleLine.rotation = b.facing + Math.PI)));
    }
    this.manager.update(a);
    this.canvas.update(this.manager.suspended, a);
    this.timeSinceLastUpdate += a;
    this.frameCount++;
    this.timeSinceLastUpdate >= 1e3 / 30 && (this.dispatchInput(), (this.timeSinceLastUpdate = 0));
  }
  showReticleLine() {
    this.reticleLine && (this.reticleLine.visible = !0);
  }
  hideReticleLine() {
    this.reticleLine && (this.reticleLine.visible = !1);
  }
  dispatchInput() {
    null !== this.playerFacing &&
      (this.inputBuffer.push("_", this.playerFacing), (this.playerFacing = null));
    0 < this.inputBuffer.length &&
      (this.manager.updatePlayerInput(this.inputBuffer),
      this.emit(Protocol.GAME, { t: Protocol.Game.INPUT, d: this.inputBuffer }),
      (this.lastInputUpdateTime = App.Time));
    this.inputBuffer = [];
  }
  dispatchInputIfInDelta() {
    33 < App.Time - this.lastInputUpdateTime && this.dispatchInput();
  }
  onBinData(a) {
    this.manager.pushUpdates(a.d);
  }
  onData(a) {
    this.onGameDataMap[a.t](a);
  }
  onInfo(a) {
    App.Console.log("# " + a.msg, 13421772);
  }
  onMessage(a) {
    let b = this.clients[a.sender];
    if (void 0 === b) console.log("warning: client does not exist: " + a.sender);
    else {
      if (App.WhiteLabel !== App.WhiteLabel_POKI)
        if ("admin" === b.type) App.Console.log("[admin] " + b.name + ": " + a.msg, 13434624);
        else {
          if (-1 !== Game.Muted.indexOf(b.sid)) return;
          var c = Team.LabelColors[b.team];
          App.Console.log(b.name + ": " + a.msg, c);
        }
      b.spec || this.manager.showPlayerChat(b.sid, a.msg);
    }
  }
  setSpectator(a) {}
  setParticipant(a) {}
  applyStats(a) {
    this.hud.updateTeamStats(a);
  }
  applySettings(a) {
    this.manager.applySettings(a);
    this.mode = a.mode;
    this.hud.setGameMode(this.mode);
    this.hud.setAvailableItems(a.items);
    this.gameover || this.hud.displayWeaponMenu(!0);
  }
  playerJoined(a, b) {
    this.clients[a.sid] = a;
    this.numClients++;
    this.gameover ||
      (a.sid === this.sessionId
        ? ((this.player = a), (a.local = !0), b || void 0 === a.team || this.hud.addClient(a))
        : void 0 !== a.team && this.hud.addClient(a));
  }
  onTeamStatus(a) {
    let b = this.clients[a.sid];
    this.hud.removeClient(b);
    b.team = a.index;
    b.sid === this.sessionId &&
      this.hud.textBarMessage(
        "You have joined team " + Team.Colors[b.team],
        Team.HexColors[b.team]
      );
    this.hud.addClient(b);
  }
  playerLeft(a) {
    let b = this.clients[a.sid];
    void 0 === b
      ? console.log("warning: playerLeft() - client does not exist")
      : (-1 !== Game.Muted.indexOf(b.sid) && Game.Muted.splice(Game.Muted.indexOf(b.sid), 1),
        this.hud.removeClient(b),
        delete this.clients[a.sid],
        this.numClients--);
  }
  shutdown() {
    this.manager.destroy();
    UserInput.removeListener(UserInput.KEY_DOWN, this.onKeyDownListener);
    UserInput.removeListener(UserInput.KEY_UP, this.onKeyUpListener);
    App.Console.unlinkInterpreter(this.interpreter);
    this.hud.cleanup();
  }
  pauseGame() {
    this.reticle.scale.x = this.reticle.scale.y = 1;
    this.gameover || (this.manager.suspend(), App.Console.log("Game paused"));
  }
  resumeGame() {
    this.emit(Game.MATCH_START);
    this.gameover = !1;
    this.canvas.endVictoryAnimation();
    this.manager.resume();
    this.hud.displayWeaponMenu(!0);
    App.Console.log("Game resumed");
  }
  endGame(a) {
    this.emit(Game.MATCH_END);
    this.reticle.scale.x = this.reticle.scale.y = 1;
    this.gameover = !0;
    this.hideReticleLine();
    if (this.onDisplayAdButton) this.onDisplayAdButton();
    if (!a.skip) {
      var b = "";
      if (1 === a.mode) {
        var c = !1;
        let d = this.manager.getLocalPlayer(),
          e;
        switch (this.mode) {
          case Game.MODE_CTF:
            -1 === a.winner
              ? (b = "The game ended in a draw.")
              : ((b = Team.Names[a.winner]),
                (b = b.charAt(0).toUpperCase() + b.slice(1)),
                (b = "Team " + b + " has won the game!"),
                (c = d && a.winner === d.team));
            setTimeout(() => {
              this.manager.suspend();
              (e = this.manager.getLastScoringPlayer()) &&
                this.canvas.initCTFVictoryAnimation(e.torsoupper.id);
            }, 150);
            break;
          case Game.MODE_TDM:
            -1 === a.winner
              ? (b = "The game ended in a draw.")
              : ((b = Team.Names[a.winner]),
                (b = b.charAt(0).toUpperCase() + b.slice(1)),
                (b = "Team " + b + " has won the game!"),
                (c = d && a.winner === d.team));
            setTimeout(() => this.manager.suspend(), 150);
            break;
          case Game.MODE_DM:
            c = this.clients[a.winner];
            b = c.name + " has won the game!";
            setTimeout(() => {
              this.manager.suspend();
              (e = this.manager.getPlayerById(a.winner)) &&
                this.canvas.initDMVictoryAnimation(e.torsoupper.id);
            }, 150);
            c = d && c.id === d.id;
            break;
          case Game.MODE_DB:
            -1 === a.winner
              ? (b = "The game ended in a draw.")
              : ((b = Team.Names[a.winner]),
                (b = b.charAt(0).toUpperCase() + b.slice(1)),
                (b = "Team " + b + " has won the game!"),
                (c = d && a.winner === d.team));
            setTimeout(() => this.manager.suspend(), 150);
            break;
          case Game.MODE_TR:
            (e = this.clients[d.id]),
              (b = "Training match has ended."),
              setTimeout(() => {
                this.manager.suspend();
                (e = this.manager.getPlayerById(d.id)) &&
                  this.canvas.initDMVictoryAnimation(e.torsoupper.id);
              }, 150),
              (c = !1);
        }
        if (c)
          switch (App.WhiteLabel) {
            case App.WhiteLabel_CG:
              App.CrazySDK.happytime();
              break;
            case App.WhiteLabel_POKI:
            case App.WhiteLabel_POKI_MAIN:
              App.PokiSDK && App.PokiSDK.happyTime(1);
          }
        a.completed && App.Console.log("This game has completed. Shutting down.", 16766720);
      } else
        (b = a.completed ? "This game has completed. Shutting down." : "Starting next round.."),
          this.manager.suspend();
      this.hud.setGameoverState({ msg: b, countdown: a.countdown, completed: a.completed });
      App.Console.log(b, 16766720);
      if (a.leaderboard) {
        a.leaderboard.name = [];
        for (let d = 0, e = a.leaderboard.id.length; d < e; d++)
          (b = this.clients[a.leaderboard.id[d]]) && a.leaderboard.name.push(b.name);
        this.hud.setLeaderboard(a.leaderboard);
      }
    }
  }
  onStartNewGame() {
    this.reticle.scale.x = this.reticle.scale.y = 1;
    this.readyToSpawn = !1;
    this.manager.clear();
    this.hud.setPlayMode();
    this.hud.emptyLeaderboard();
    this.canvas.endVictoryAnimation();
    this.manager.resume();
    for (let a in this.clients) this.hud.addClient(this.clients[a]);
    this.hud.textBarMessage("Loading map...", 11184810);
  }
  onNextGameCountdown(a) {
    0 === a.count
      ? (this.hud.setGameoverCount(5), this.onStartNewGame())
      : this.hud.setGameoverCount(a.count);
  }
  onLeaderStatus(a) {
    let b = this.clients[a.id];
    b
      ? this.mode === Game.MODE_DM && App.Console.log(b.name + " takes the lead!")
      : console.log("WARNING: onLeaderStatus - client " + a.id + " does not exist");
  }
  focus() {
    this.manager.focus();
  }
  onPlayerSpawn() {
    App.IsMobile || this.showReticleLine();
    App.Console.isActive() &&
      (null !== this.busyTimeout && clearTimeout(this.busyTimeout),
      (this.busyTimeout = setTimeout(() => this.requestDisplayChatBubble(), 400)));
  }
  onPlayerDeath(a) {
    a.killer !== a.victim && this.hud.registerKill(a.killer);
    a.victim.sid === this.player.sid &&
      ((this.reticle.scale.x = this.reticle.scale.y = 1), this.hideReticleLine());
  }
  onPlayerScore(a) {
    this.hud.registerScore(a.player);
  }
  onDbRoundEnd(a) {
    this.hud.registerDbRoundWin(a.team);
  }
  displayHelp() {
    this.hud.displayHelpImage();
  }
  onPlayerCombo() {}
  onPlayerSpree() {}
  onUpdateEnvironment() {}
  onSelectItem(a) {
    a &&
      this.emit(Protocol.GAME, {
        t: Protocol.Game.COMMAND,
        cmd: { name: GameCommands.PREFERENCE, pref: { item: a.itemId } },
      });
    (this.readyToSpawn && a) ||
      ((this.readyToSpawn = !0),
      this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.SPAWN } }));
  }
  onModelMessage(a) {
    this.hud.textBarMessage(a.text, a.color);
  }
  onKeyUp(a) {
    if (void 0 !== a.data.char) {
      var b = a.data.char.toUpperCase();
      characterMapCTRL[a.data.code] && (b = characterMapCTRL[a.data.code]);
      if ((a = this.input.update(b, 0))) this.inputBuffer.push(a, 0), this.dispatchInputIfInDelta();
    }
  }
  onMouseDown() {
    App.Console.isActive() && App.Console.setActive(!1);
    if (this.readyToSpawn) {
      let a = { d: 1 };
      this.input.update("LM", a) && (this.inputBuffer.push("LM", a), this.dispatchInputIfInDelta());
    } else
      (this.readyToSpawn = !0),
        this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.SPAWN } });
  }
  onMouseUp() {
    let a = { d: 0 };
    this.input.update("LM", a) &&
      (this.inputBuffer.push("LM", a),
      this.dispatchInputIfInDelta(),
      this.canvas.getCamera().tracking &&
        !this.gameover &&
        this.manager.getLocalPlayer().alive &&
        this.manager.trackPlayer(this.player.sid));
  }
  onMouseMove(a) {
    this.reticle.x = a.x;
    this.reticle.y = a.y;
  }
  onRightDown() {
    this.input.update("RM", ["RM", 1]) &&
      (this.inputBuffer.push("RM", 1), this.dispatchInputIfInDelta());
    this.player && this.player.spec && this.manager.setTrackObject(null);
  }
  onRightUp() {
    this.input.update("RM", ["RM", 0]) &&
      (this.inputBuffer.push("RM", 0), this.dispatchInputIfInDelta());
  }
  onKeyDown(a) {
    if (!App.Console.isActive() && void 0 !== a.data.char) {
      var b = a.data.char.toUpperCase();
      characterMapCTRL[a.data.code] && (b = characterMapCTRL[a.data.code]);
      switch (a.data.code) {
        case 191:
          App.Console.isActive() || (App.Console.setActive(!0), App.Console.addInputString("/"));
          break;
        case 13:
          App.Console.setActive(!0);
          break;
        case 49:
          this.onCmdWave();
          break;
        case 50:
          this.onCmdSalute();
      }
      if ((a = this.input.update(b, 1))) this.inputBuffer.push(a, 1), this.dispatchInputIfInDelta();
    }
  }
  requestDisplayChatBubble() {
    App.Console.isActive() &&
      (this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.BUSY } }),
      (this.busyTimeout = null));
  }
  requestHideChatBubble() {
    App.Console.isActive() ||
      (this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.DONE } }),
      (this.busyTimeout = null));
  }
  updateJoystickMoveState(a) {
    a.left
      ? (this.inputBuffer.push("A", 1), this.inputBuffer.push("D", 0))
      : a.right
      ? (this.inputBuffer.push("A", 0), this.inputBuffer.push("D", 1))
      : (this.inputBuffer.push("A", 0), this.inputBuffer.push("D", 0));
    a.jump ? this.inputBuffer.push("W", 1) : this.inputBuffer.push("W", 0);
    a.fly
      ? (this.inputBuffer.push("X", 0),
        this.inputBuffer.push("S", 0),
        this.inputBuffer.push("RM", 1))
      : (a.crouch
          ? (this.inputBuffer.push("X", 0), this.inputBuffer.push("S", 1))
          : (a.prone ? this.inputBuffer.push("X", 1) : this.inputBuffer.push("X", 0),
            this.inputBuffer.push("S", 0)),
        this.inputBuffer.push("RM", 0));
    this.ignoreMovementJoystickViewing ||
      this.canvas.mousePositionFromNormalizedVector({ x: a.nx, y: a.ny }, 0.2);
    this.dispatchInputIfInDelta();
  }
  updateJoystickTargetState(a) {
    a.end
      ? ((this.ignoreMovementJoystickViewing = !1),
        this.canvas.mousePositionFromNormalizedVector({
          x: 0.1 * this.lastJoystickNV.x,
          y: 0.1 * this.lastJoystickNV.y,
        }))
      : ((this.ignoreMovementJoystickViewing = !0),
        this.canvas.mousePositionFromNormalizedVector({ x: a.nx, y: a.ny }),
        (this.lastJoystickNV.x = a.nx),
        (this.lastJoystickNV.y = a.ny));
    a.fire ? this.inputBuffer.push("LM", { d: 1 }) : this.inputBuffer.push("LM", { d: 0 });
    a.throw ? this.inputBuffer.push("E", 1) : this.inputBuffer.push("E", 0);
    a.switch ? this.inputBuffer.push("Q", 1) : this.inputBuffer.push("Q", 0);
    this.dispatchInputIfInDelta();
  }
  onEscapeMenuAccess() {
    this.hud.displayEscapeMenu();
  }
  onMute(a) {
    this.mutePref = a ? !0 : null;
    this.manager.mute(a);
  }
  onCmdMessage(a) {
    0 < a.length && this.emit(Protocol.GAME, { t: Protocol.Game.MESSAGE, msg: a });
  }
  onCmdClear() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.CLEAR } });
  }
  onCmdShutdown() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.SHUTDOWN } });
  }
  onCmdLoad(a) {
    this.emit(Protocol.GAME, {
      t: Protocol.Game.COMMAND,
      cmd: { name: GameCommands.LOAD, map: a },
    });
  }
  onCmdSpawn() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.SPAWN } });
  }
  onCmdPause() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.PAUSE } });
  }
  onCmdSpectate() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.SPECTATE } });
  }
  onCmdJoin() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.JOIN } });
  }
  onCmdKill() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.KILL } });
  }
  onCmdLogin(a) {
    a &&
      0 < a.length &&
      this.emit(Protocol.GAME, {
        t: Protocol.Game.COMMAND,
        cmd: { name: GameCommands.LOGIN },
        password: a,
      });
  }
  onCmdClients() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.CLIENTS } });
  }
  onCmdCommands() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.COMMANDS } });
  }
  onCmdKick(a) {
    null !== a &&
      0 < a.length &&
      this.emit(Protocol.GAME, {
        t: Protocol.Game.COMMAND,
        cmd: { name: GameCommands.KICK },
        id: a,
      });
  }
  onCmdBalance() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.BALANCE } });
  }
  onCmdParams() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.PARAMS } });
  }
  onCmdMemStats() {
    this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.MEMSTATS } });
  }
  onCmdWave() {
    null === this.animTimeout &&
      (this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.WAVE } }),
      (this.animTimeout = setTimeout(() => {
        this.animTimeout = null;
      }, 2e3)));
  }
  onCmdSalute() {
    null === this.animTimeout &&
      (this.emit(Protocol.GAME, { t: Protocol.Game.COMMAND, cmd: { name: GameCommands.SALUTE } }),
      (this.animTimeout = setTimeout(() => {
        this.animTimeout = null;
      }, 2e3)));
  }
  resize() {}
  onShowConsole() {
    null !== this.busyTimeout && clearTimeout(this.busyTimeout);
    this.busyTimeout = setTimeout(() => this.requestDisplayChatBubble(), 400);
  }
  onHideConsole() {
    null !== this.busyTimeout && clearTimeout(this.busyTimeout);
    this.busyTimeout = setTimeout(() => this.requestHideChatBubble(), 400);
  }
}
Game.Muted = [];
Game.MODE_CTF = "captureTheFlag";
Game.MODE_DM = "deathmatch";
Game.MODE_TDM = "teamDeathmatch";
Game.MODE_DB = "dodgeball";
Game.MODE_TR = "training";
Game.MODE_1V1 = "1v1";
Game.MATCH_END = "matchEnd";
Game.MATCH_START = "matchStart";
Game.MODE_MAP = {
  [Game.MODE_CTF]: "ctf",
  [Game.MODE_DM]: "dm",
  [Game.MODE_TDM]: "tdm",
  [Game.MODE_DB]: "db",
  [Game.MODE_TR]: "tr",
  [Game.MODE_1V1]: "1v1",
};
Game.MODE_TITLES = {
  [Game.MODE_CTF]: "Capture the flag",
  [Game.MODE_DM]: "Deathmatch",
  [Game.MODE_TDM]: "Team deathmatch",
  [Game.MODE_DB]: "Dodgeball",
  [Game.MODE_TR]: "Training",
  [Game.MODE_1V1]: "1 vs 1",
};
Game.EVENT_DEATH = "death";
Game.RankTitles =
  "Newbie Beginner Novice Initiated Trained Competent Adept Skilled Proficient Advanced Expert Elite Champion Master Grandmaster Ninja".split(
    " "
  );
Game.MapSkillToTitle = function (a) {
  return 49500 <= a
    ? Game.RankTitles[Game.RankTitles.length - 1]
    : Game.RankTitles[Math.floor((1 / 30) * (Math.sqrt(6 * a + 11025) - 135)) + 1];
};
Game.MapEventWepToId = function (a) {
  void 0 !== Game.WeaponMapping[a] &&
    -1 === Game.WeaponMapping[a].indexOf("_") &&
    (a = Game.WeaponMapping[a]);
  return "i" + a;
};
Game.MapEventWepToIcon = function (a) {
  void 0 !== Game.WeaponMapping[a] && (a = Game.WeaponMapping[a]);
  if (-1 === a) return null;
  a = "i" + a;
  return SpriteMap[a]
    ? ((a = new SpriteMap[a]()), (a.scale.x *= 0.35), (a.scale.y *= 0.35), a)
    : null;
};
Game.WeaponMapping = {
  "-1": "0",
  213: "11",
  204: "30",
  24: "31",
  25: "25_",
  22: "21_",
  20: "20_",
  23: "23_",
  26: "32",
  27: "33",
  28: "34",
  21: "21_",
  29: "35",
  30: "36",
  31: "37",
};
var serverdetailmenu = {};
class ServerDetailMenu extends Feature {
  constructor() {
    super();
    this.isPrivate = !1;
    this.isRanked = !0;
    this.isCustom = !1;
    this.maps = [];
    this.drops = [];
    this.weapons = [];
    this.mode = null;
    this.serverId = this.serverName = "";
    this.oy = this.ox = 20;
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 1);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(14, 136, 208, 210, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(226, 136, 208, 210, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(438, 136, 208, 210, 10);
    this.background.endFill();
    this.background.beginFill(3355443, 1);
    this.background.drawRect(14, 60, 632, 36, 10);
    this.background.endFill();
    this.background.interactive = !0;
    this.container.addChild(this.background);
    this.container.x = 0.5 * -this.width;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy + 34;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.SERVER_DETAIL_CANCEL));
    this.container.addChild(this.closeButton);
    this.serverListingTitle = new PIXI.Text("Server details", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.serverListingTitle.x = this.ox;
    this.serverListingTitle.y = this.oy + 40;
    this.container.addChild(this.serverListingTitle);
    this.weaponListContainer = new PIXI.Container();
    this.weaponListContainer.x = 0;
    this.weaponListContainer.y = 32;
    this.weaponListTableContainerMask = new PIXI.Graphics();
    this.weaponListTableContainerMask.beginFill(16777215, 1);
    this.weaponListTableContainerMask.drawRect(20, 148, 180, 200);
    this.weaponListTableContainerMask.endFill();
    this.weaponListTableContainerMask.x = -4;
    this.weaponListContainer.addChild(this.weaponListTableContainerMask);
    this.weaponListTableContainer = new PIXI.Container();
    this.weaponListTableContainer.x = 0;
    this.weaponListTableContainer.mask = this.weaponListTableContainerMask;
    this.weaponListContainer.addChild(this.weaponListTableContainer);
    this.weaponSelectionListScrollbar = new SelectionListScrollbar(202);
    this.weaponSelectionListScrollbar.x = 200;
    this.weaponSelectionListScrollbar.y = 152;
    this.weaponListContainer.addChild(this.weaponSelectionListScrollbar);
    this.weaponSelectionListScrollbar.on(SelectionListScrollbar.SCROLL, (a) => {
      this.weaponListTableContainer.height > this.weaponListTableContainerMask.height &&
        (this.weaponListTableContainer.y = -(
          a *
          (this.weaponListTableContainer.height - this.weaponListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.weaponListContainer);
    this.mapListContainer = new PIXI.Container();
    this.mapListContainer.x = 212;
    this.mapListContainer.y = 32;
    this.mapListTableContainerMask = new PIXI.Graphics();
    this.mapListTableContainerMask.beginFill(16777215, 1);
    this.mapListTableContainerMask.drawRect(20, 148, 180, 200);
    this.mapListTableContainerMask.endFill();
    this.mapListTableContainerMask.x = -4;
    this.mapListContainer.addChild(this.mapListTableContainerMask);
    this.mapListTableContainer = new PIXI.Container();
    this.mapListTableContainer.x = 0;
    this.mapListTableContainer.mask = this.mapListTableContainerMask;
    this.mapListContainer.addChild(this.mapListTableContainer);
    this.mapSelectionListScrollbar = new SelectionListScrollbar(202);
    this.mapSelectionListScrollbar.x = 200;
    this.mapSelectionListScrollbar.y = 152;
    this.mapListContainer.addChild(this.mapSelectionListScrollbar);
    this.mapSelectionListScrollbar.on(SelectionListScrollbar.SCROLL, (a) => {
      this.mapListTableContainer.height > this.mapListTableContainerMask.height &&
        (this.mapListTableContainer.y = -(
          a *
          (this.mapListTableContainer.height - this.mapListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.mapListContainer);
    this.dropListContainer = new PIXI.Container();
    this.dropListContainer.x = 424;
    this.dropListContainer.y = 32;
    this.dropListTableContainerMask = new PIXI.Graphics();
    this.dropListTableContainerMask.beginFill(16777215, 1);
    this.dropListTableContainerMask.drawRect(20, 148, 180, 200);
    this.dropListTableContainerMask.endFill();
    this.dropListTableContainerMask.x = -4;
    this.dropListContainer.addChild(this.dropListTableContainerMask);
    this.dropListTableContainer = new PIXI.Container();
    this.dropListTableContainer.x = 0;
    this.dropListTableContainer.mask = this.dropListTableContainerMask;
    this.dropListContainer.addChild(this.dropListTableContainer);
    this.dropSelectionListScrollbar = new SelectionListScrollbar(202);
    this.dropSelectionListScrollbar.x = 200;
    this.dropSelectionListScrollbar.y = 152;
    this.dropListContainer.addChild(this.dropSelectionListScrollbar);
    this.dropSelectionListScrollbar.on(SelectionListScrollbar.SCROLL, (a) => {
      this.dropListTableContainer.height > this.dropListTableContainerMask.height &&
        (this.dropListTableContainer.y = -(
          a *
          (this.dropListTableContainer.height - this.dropListTableContainerMask.height)
        ));
    });
    this.container.addChild(this.dropListContainer);
    this.modeIcon = new PIXI.Sprite();
    this.modeIcon.x = this.ox + 4;
    this.modeIcon.y = this.oy + 83;
    this.container.addChild(this.modeIcon);
    this.regionIcon = new PIXI.Sprite();
    this.regionIcon.x = this.ox + 39;
    this.regionIcon.y = this.oy + 87;
    this.regionIcon.scale.x = this.regionIcon.scale.y = 0.4;
    this.container.addChild(this.regionIcon);
    this.serverTitleLabel = new PIXI.Text("", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.serverTitleLabel.x = this.ox + 70;
    this.serverTitleLabel.y = this.oy + 90;
    this.container.addChild(this.serverTitleLabel);
    this.weaponTypeLabel = new PIXI.Text("Weapons", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.weaponTypeLabel.x = this.ox + 4;
    this.weaponTypeLabel.y = this.oy + 134;
    this.container.addChild(this.weaponTypeLabel);
    this.mapLabel = new PIXI.Text("Maps", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.mapLabel.x = this.ox + 214;
    this.mapLabel.y = this.oy + 134;
    this.container.addChild(this.mapLabel);
    this.dropLabel = new PIXI.Text("Item drops", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.dropLabel.x = this.ox + 424;
    this.dropLabel.y = this.oy + 134;
    this.container.addChild(this.dropLabel);
    this.privateIcon = new PIXI.Sprite(App.CombinedTextures.lock_icon);
    this.privateIcon.x = this.width - 110;
    this.privateIcon.y = this.serverTitleLabel.y - 5;
    this.privateIcon.scale.x = this.privateIcon.scale.y = 0.4;
    this.container.addChild(this.privateIcon);
    this.rankedIcon = new PIXI.Sprite(App.CombinedTextures.ranked_icon);
    this.rankedIcon.x = this.privateIcon.x + 30;
    this.rankedIcon.y = this.serverTitleLabel.y - 5;
    this.rankedIcon.scale.x = this.rankedIcon.scale.y = 0.4;
    this.container.addChild(this.rankedIcon);
    this.customIcon = new PIXI.Sprite(App.CombinedTextures.gears_icon);
    this.customIcon.x = this.rankedIcon.x + 30;
    this.customIcon.y = this.serverTitleLabel.y - 5;
    this.customIcon.scale.x = this.customIcon.scale.y = 0.4;
    this.container.addChild(this.customIcon);
    this.activePlayersText = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
      align: "right",
    });
    this.activePlayersText.x = this.width - 100;
    this.activePlayersText.y = this.serverTitleLabel.y;
    this.activePlayersText.anchor.x = 1;
    this.container.addChild(this.activePlayersText);
    this.shurikenLabel = new PIXI.Text("", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16772608,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.shurikenLabel.x = this.ox + 40;
    this.shurikenLabel.y = this.oy + 382;
    this.container.addChild(this.shurikenLabel);
    this.shurikenIcon = new PIXI.Sprite(App.CombinedTextures.shuriken);
    this.shurikenIcon.x = this.ox + 10;
    this.shurikenIcon.y = this.oy + 380;
    this.shurikenIcon.scale.x = this.shurikenIcon.scale.y = 0.7;
    this.container.addChild(this.shurikenIcon);
    this.passwordLabel = new PIXI.Text("Password", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 2,
      lineJoin: "round",
    });
    this.passwordLabel.x = this.ox + 10;
    this.passwordLabel.y = this.oy + 426;
    this.container.addChild(this.passwordLabel);
    this.passwordField = new InputField("password");
    this.passwordField.setDimensions(110, 35);
    this.passwordField.forceLowerCase = !1;
    this.passwordField.setMaxChars(8);
    this.passwordField.x = this.ox + 100;
    this.passwordField.y = this.oy + 420;
    this.passwordField.setPassword(!0);
    this.passwordField.setFilter("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890");
    this.container.addChild(this.passwordField);
    this.joinButton = new Button("join");
    this.joinButton.selected = !1;
    this.joinButton.setText("Join now");
    this.joinButton.scale.x = this.joinButton.scale.y = 0.8;
    this.joinButton.setTint(16763904);
    this.joinButton.addListener(Button.BUTTON_RELEASED, () => {
      this.joinButton.disable();
      this.emit(Layer.Events.SERVER_DETAIL_CANCEL);
      this.emit(
        Layer.Events.JOIN_GAME,
        this.serverName,
        this.serverId,
        this.passwordField.getText().trim()
      );
    });
    this.joinButton.x = this.width - (this.joinButton.width + 16);
    this.joinButton.y = this.height - 16;
    this.container.addChild(this.joinButton);
  }
  async show(a) {
    super.show();
    this.passwordField.setText("");
    this.weaponListTableContainer.removeChildren();
    this.mapListTableContainer.removeChildren();
    this.weaponSelectionListScrollbar.reset();
    this.weaponListTableContainer.y = 0;
    this.mapSelectionListScrollbar.reset();
    this.mapListTableContainer.y = 0;
    this.mode = a.mode;
    var b = (this.isCustom = 1 === parseInt(a.custom) && void 0 !== a.data) ? a.data.weapons : [];
    let c = this.isCustom ? a.data.maps : [];
    var d = this.isCustom ? a.data.drops : [],
      e = this.isCustom ? a.data.shuriken : !0;
    this.shurikenLabel.text = e ? "Shuriken enabled" : "Shuriken disabled";
    this.serverName = a.name;
    this.serverId = a.server_id;
    this.shurikenLabel.alpha = e ? 1 : 0.3;
    this.shurikenIcon.alpha = e ? 1 : 0.3;
    this.serverTitleLabel.text = a.name;
    this.activePlayersText.text = a.players.toString() + " players in game";
    this.activePlayersText.x = this.width - 28;
    this.modeIcon.texture = App.CombinedTextures[Game.MODE_MAP[this.mode] + "_icon"];
    this.regionIcon.texture = App.CombinedTextures["globe_" + ServerListMenu.REGION_MAP[a.region]];
    this.privateIcon.x = this.serverTitleLabel.x + this.serverTitleLabel.width + 10;
    this.rankedIcon.x = this.privateIcon.x + 30;
    this.customIcon.x = this.rankedIcon.x + 30;
    this.privateIcon.alpha = 1 === parseInt(a.private) ? 1 : 0.3;
    this.rankedIcon.alpha = 1 === parseInt(a.ranked) ? 1 : 0.3;
    this.customIcon.alpha = 1 === parseInt(a.custom) ? 1 : 0.3;
    0 === parseInt(a.private)
      ? ((this.passwordField.interactive = !1),
        (this.passwordField.alpha = 0.3),
        (this.passwordLabel.alpha = 0.3))
      : ((this.passwordField.interactive = !0),
        (this.passwordField.alpha = 1),
        (this.passwordLabel.alpha = 1));
    a = this.drops;
    if (0 === this.drops.length && ((a = await APIClient.getItemDrops()), !a)) return;
    this.drops = a;
    this.dropListTableContainer.removeChildren();
    a = 0;
    for (e = 0; e < this.drops.length; e++) {
      var f = this.drops[e];
      f = new DropDisplayTableRow(
        a,
        f.item_id,
        f.prefab_id,
        f.name,
        !this.isCustom || (this.isCustom && -1 !== d.indexOf(f.item_id))
      );
      f.x = this.ox + 4;
      f.y = this.oy + 42 * a + 130;
      this.dropListTableContainer.addChild(f);
      a++;
    }
    d = 0;
    for (let g in ItemMap)
      if (
        ((a = ItemMap[g]), a.equip === ItemMap.Equip.PRIMARY || a.equip === ItemMap.Equip.SECONDARY)
      )
        (a = new WeaponDisplayTableRow(
          d,
          g,
          a.title,
          !this.isCustom || (this.isCustom && -1 !== b.indexOf(g.substr(1)))
        )),
          (a.x = this.ox + 4),
          (a.y = this.oy + 42 * d + 130),
          this.weaponListTableContainer.addChild(a),
          d++;
    b = this.maps;
    if (0 === this.maps.length && ((b = await APIClient.getMaps()), !b)) return;
    this.maps = b;
    this.isCustom || (c = this.maps.map((g) => g.id));
    this.filterMaps(c);
    this.joinButton.enable();
  }
  filterMaps(a) {
    let b = 0;
    for (let d = 0; d < this.maps.length; d++) {
      var c = this.maps[d];
      if (
        this.mode === c.mode ||
        (c.mode === Game.MODE_CTF && this.mode === Game.MODE_DM) ||
        (c.mode === Game.MODE_CTF && this.mode === Game.MODE_TDM)
      )
        (c = new MapDisplayTableRow(
          b,
          c.id,
          c.title,
          c.mode,
          !this.isCustom || (this.isCustom && -1 !== a.indexOf(c.id))
        )),
          (c.x = this.ox + 4),
          (c.y = this.oy + 42 * b + 130),
          this.mapListTableContainer.addChild(c),
          b++;
    }
  }
}
class WeaponDisplayTableRow extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.id = b;
    this.index = a;
    this.interactive = !0;
    this.selected = d;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRect(0, 2, 200, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.tint = this.selected ? 65280 : 16711680;
    this.background.alpha = 0.6;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.6;
    });
    this.addChild(this.background);
    this.icon = new SpriteMap[b]();
    this.icon.x = 23;
    this.icon.y = 26;
    a = this.icon.width;
    b = this.icon.height;
    d = a > b ? (64 <= a ? 64 : a) : 42 <= b ? 42 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? d / this.icon.width : d / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.nameText = new PIXI.Text(c, {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.nameText.x = 75;
    this.nameText.y = 12;
    this.nameText.tint = 16777215;
    this.addChild(this.nameText);
  }
}
class MapDisplayTableRow extends PIXI.Container {
  constructor(a, b, c, d, e) {
    super();
    this.id = b;
    this.index = a;
    this.interactive = !0;
    this.selected = e;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRect(0, 2, 200, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.tint = this.selected ? 65280 : 16711680;
    this.background.alpha = 0.6;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.6;
    });
    this.addChild(this.background);
    this.icon = new PIXI.Sprite(App.CombinedTextures[Game.MODE_MAP[d] + "_icon"]);
    this.icon.x = 10;
    this.icon.y = 10;
    a = this.icon.width;
    b = this.icon.height;
    d = a > b ? (64 <= a ? 64 : a) : 42 <= b ? 42 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? d / this.icon.width : d / this.icon.height;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.nameText = new PIXI.Text(c, {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.nameText.x = 48;
    this.nameText.y = 12;
    this.addChild(this.nameText);
  }
}
class DropDisplayTableRow extends PIXI.Container {
  constructor(a, b, c, d, e) {
    super();
    this.id = b;
    this.index = a;
    this.interactive = !0;
    this.selected = e;
    this.background = new PIXI.Graphics();
    this.background.beginFill(16777215, 0.2);
    this.background.drawRect(0, 2, 200, 38);
    this.background.endFill();
    this.background.interactive = !0;
    this.background.tint = this.selected ? 65280 : 16711680;
    this.background.alpha = 0.6;
    this.background.on("mouseover", () => {
      this.background.alpha = 1;
    });
    this.background.on("mouseout", () => {
      this.background.alpha = 0.6;
    });
    this.addChild(this.background);
    this.icon = new SpriteMap[c]();
    this.icon.x = 30;
    this.icon.y = 22;
    a = this.icon.width;
    b = this.icon.height;
    c = a > b ? (10 <= a ? 10 : a) : 10 <= b ? 10 : b;
    this.icon.scale.x = this.icon.scale.y = a > b ? c / this.icon.width : c / this.icon.height;
    this.icon.rotation = 0;
    this.addChild(this.icon);
    this.nameText = new PIXI.Text(d, {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 2,
    });
    this.nameText.x = 56;
    this.nameText.y = 12;
    this.addChild(this.nameText);
  }
}
var guestprofilemenu = {};
class GuestProfileMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.interactive = !0;
    this.background.x = 0;
    this.background.y = 40;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(10, 10, 640, 504);
    this.background.endFill();
    this.background.drawRect(15, 42, 630, 2);
    this.container.addChild(this.background);
    this.ox = 20;
    this.oy = 60;
    this.closeButton = new ImgButton();
    this.closeButton.x = this.background.width - 40;
    this.closeButton.y = this.oy - 6;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.GUEST_PROFILE_HIDE));
    this.container.addChild(this.closeButton);
    this.guestProfileTitle = new PIXI.Text("Profile", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.guestProfileTitle.x = 0.5 * this.width - 20;
    this.guestProfileTitle.y = this.oy - 4;
    this.guestProfileTitle.anchor.x = 0.5;
    this.container.addChild(this.guestProfileTitle);
    this.container.x = 0.5 * -this.width;
    this.profileItemContainer = new PIXI.Container();
    this.profileItemContainer.x = this.ox;
    this.profileItemContainer.y = this.oy + 50;
    this.container.addChild(this.profileItemContainer);
    this.registerDesc = new PIXI.Text(
      "You are currently on a guest account.\n\nPlease login or register to get full access to all game features.",
      { fontName: "Arial", fontSize: 16, fill: 16763904, strokeThickness: 2, lineJoin: "round" }
    );
    this.registerDesc.x = this.ox + 10;
    this.registerDesc.y = this.oy + 50;
    this.container.addChild(this.registerDesc);
    this.loginButton = new Button("login");
    this.loginButton.selected = !0;
    this.loginButton.setText("Login");
    this.loginButton.scale.x = this.loginButton.scale.y = 0.8;
    this.loginButton.addListener(Button.BUTTON_RELEASED, () =>
      this.emit(Layer.Events.LOGIN_ACCESS)
    );
    this.loginButton.x = this.ox + 20;
    this.loginButton.y = this.oy + 140;
    this.loginButton.setTint(16763904);
    this.container.addChild(this.loginButton);
    this.registerButton = new Button("register");
    this.registerButton.selected = !0;
    this.registerButton.setText("Register");
    this.registerButton.scale.x = this.registerButton.scale.y = 0.8;
    this.registerButton.addListener(Button.BUTTON_RELEASED, () =>
      this.emit(Layer.Events.REGISTER_ACCESS)
    );
    this.registerButton.x = this.loginButton.x + this.loginButton.width + 20;
    this.registerButton.y = this.oy + 140;
    this.registerButton.setTint(16763904);
    this.container.addChild(this.registerButton);
  }
  setTitle(a) {
    this.guestProfileTitle.text = a;
  }
  async show() {}
}
var highscoremenu = {};
class HighscoreMenu extends Feature {
  constructor() {
    super();
    this.display =
      0.5 < Math.random() ? HighscoreMenu.DISPLAY_EXPERIENCE : HighscoreMenu.DISPLAY_SKILL;
    this.skillRanking = [];
    this.experienceRanking = [];
    this.thumbnailContainer = new PIXI.Container();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = -6;
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRect(0, 46, 100, 524);
    this.background.endFill();
    this.container.addChild(this.background);
    this.topTitle = new PIXI.Text("Top players", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.topTitle.x = 50;
    this.topTitle.y = 46;
    this.topTitle.anchor.x = 0.5;
    this.topTitle.resolution = 1.5 * App.DevicePixelRatio;
    this.container.addChild(this.topTitle);
    this.skillButtonBg = new PIXI.Graphics();
    this.skillButtonBg.beginFill(16777215, 0.2);
    this.skillButtonBg.lineStyle(1, 16777215, 0.1, 0);
    this.skillButtonBg.drawRect(0, 0, 96, 22);
    this.container.addChild(this.skillButtonBg);
    this.skillButtonBg.x = 2;
    this.skillButtonBg.y = 80;
    this.skillButtonBg.alpha = this.display === HighscoreMenu.DISPLAY_SKILL ? 1 : 0.5;
    this.skillButtonBg.interactive = !0;
    this.skillButton = new PIXI.Text("Skill", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.skillButton.x = 50;
    this.skillButton.y = 81;
    this.skillButton.anchor.x = 0.5;
    this.skillButton.resolution = 1.5 * App.DevicePixelRatio;
    this.skillButton.interactive = !1;
    this.container.addChild(this.skillButton);
    this.skillButton.alpha = this.display === HighscoreMenu.DISPLAY_SKILL ? 1 : 0.5;
    this.experienceButtonBg = new PIXI.Graphics();
    this.experienceButtonBg.beginFill(16777215, 0.2);
    this.experienceButtonBg.lineStyle(1, 16777215, 0.1, 0);
    this.experienceButtonBg.drawRect(0, 0, 96, 22);
    this.container.addChild(this.experienceButtonBg);
    this.experienceButtonBg.x = 2;
    this.experienceButtonBg.y = 106;
    this.experienceButtonBg.alpha = this.display === HighscoreMenu.DISPLAY_EXPERIENCE ? 1 : 0.5;
    this.experienceButtonBg.interactive = !0;
    this.experienceButton = new PIXI.Text("Experience", {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 16,
      fill: 16776960,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.experienceButton.x = 50;
    this.experienceButton.y = 107;
    this.experienceButton.anchor.x = 0.5;
    this.experienceButton.resolution = 1.5 * App.DevicePixelRatio;
    this.experienceButton.interactive = !1;
    this.container.addChild(this.experienceButton);
    this.experienceButton.alpha = this.display === HighscoreMenu.DISPLAY_EXPERIENCE ? 1 : 0.5;
    this.skillButtonBg.on("mouseover", () => {
      this.skillButton.alpha = 1;
    });
    this.skillButtonBg.on("mouseout", () => {
      this.display !== HighscoreMenu.DISPLAY_SKILL && (this.skillButton.alpha = 0.5);
    });
    this.skillButtonBg.on("mousedown", () => {
      this.display !== HighscoreMenu.DISPLAY_SKILL &&
        ((this.display = HighscoreMenu.DISPLAY_SKILL),
        (this.skillButton.alpha = 1),
        (this.experienceButton.alpha = 0.5),
        this.refresh());
    });
    this.skillButtonBg.on("touchstart", () => {
      this.display !== HighscoreMenu.DISPLAY_SKILL &&
        ((this.display = HighscoreMenu.DISPLAY_SKILL),
        (this.skillButton.alpha = 1),
        (this.experienceButton.alpha = 0.5),
        this.refresh());
    });
    this.experienceButtonBg.on("mouseover", () => {
      this.experienceButton.alpha = 1;
    });
    this.experienceButtonBg.on("mouseout", () => {
      this.display !== HighscoreMenu.DISPLAY_EXPERIENCE && (this.experienceButton.alpha = 0.5);
    });
    this.experienceButtonBg.on("mousedown", () => {
      this.display !== HighscoreMenu.DISPLAY_EXPERIENCE &&
        ((this.display = HighscoreMenu.DISPLAY_EXPERIENCE),
        (this.skillButton.alpha = 0.5),
        (this.experienceButton.alpha = 1),
        this.refresh());
    });
    this.experienceButtonBg.on("touchstart", () => {
      this.display !== HighscoreMenu.DISPLAY_EXPERIENCE &&
        ((this.display = HighscoreMenu.DISPLAY_EXPERIENCE),
        (this.skillButton.alpha = 0.5),
        (this.experienceButton.alpha = 1),
        this.refresh());
    });
    this.container.addChild(this.thumbnailContainer);
    this.load();
  }
  async load() {
    let a = await APIClient.getRankingType("skill", 10);
    this.skillRanking = a.ranking;
    a = await APIClient.getRankingType("level", 10);
    this.experienceRanking = a.ranking;
    this.refresh();
  }
  refresh() {
    this.thumbnailContainer.removeChildren();
    let a;
    switch (this.display) {
      case HighscoreMenu.DISPLAY_SKILL:
        a = this.skillRanking;
        break;
      case HighscoreMenu.DISPLAY_EXPERIENCE:
        a = this.experienceRanking;
    }
    for (let b = 0; b < a.length; b++) {
      let c = new Thumbnail(200, 200, !0, !1);
      c.applyCustomization(a[b].cust);
      c.x = 65 + (0 !== b % 2 ? 45 : 0);
      c.y = 135 + 38 * b;
      c.scale.x = -0.4;
      c.scale.y = 0.4;
      c.hitArea = new PIXI.Circle(100, 110, 70);
      c.anchor.x = c.anchor.y = 0.5;
      c.on("mouseover", () => {
        c.scale.x = -0.5;
        c.scale.y = 0.5;
        c.x += 10;
        c.y -= 10;
        this.thumbnailContainer.setChildIndex(c, this.thumbnailContainer.children.length - 1);
      });
      c.on("mouseout", () => {
        c.scale.x = -0.4;
        c.scale.y = 0.4;
        c.x -= 10;
        c.y += 10;
      });
      c.on("mousedown", () => {
        this.emit(Layer.Events.USER_ACCESS, a[b].id);
      });
      c.on("touchstart", () => {
        this.emit(Layer.Events.USER_ACCESS, a[b].id);
      });
      this.thumbnailContainer.addChild(c);
    }
  }
  resize(a, b) {
    this.x = 0.5 * a + 330;
    this.y = -8;
  }
}
HighscoreMenu.DISPLAY_SKILL = "skill";
HighscoreMenu.DISPLAY_EXPERIENCE = "experience";
var particlecontainer = {};
class ParticleContainer extends PIXI.Container {
  constructor() {
    super();
    this.lastUpdate = 0;
  }
  spawnDirect(a) {
    this.addChild(a);
  }
  spawn(a, b) {
    for (b ||= 1; 0 < b--; ) {
      if (a.randV) {
        var c = a.randV;
        if (c.angular) {
          var d = 0;
          c.dir && (d = c.dir);
          d = d + c.minAngle + Math.random() * (c.maxAngle - c.minAngle);
          c = c.minDelta + Math.random() * (c.maxDelta - c.minDelta);
          a.nvx = a.vx + c * Math.cos(d);
          a.nvy = a.vy + c * Math.sin(d);
        } else
          (a.nvx = a.vx + c.minX + Math.random() * c.rangeX),
            (a.nvy = a.vy + c.minY + Math.random() * c.rangeY);
        10 === a._r && (a.r = Math.atan2(a.nvy, a.nvx) + 0.5 * Math.PI);
      }
      c = new PIXI.Sprite(App.CombinedTextures[a.tex]);
      c.startTTL = a.ttl;
      a.anchor
        ? ((c.anchor.x = a.anchor.x), (c.anchor.y = a.anchor.y))
        : (c.anchor.x = c.anchor.y = 0.5);
      c.x = a.x;
      c.y = a.y;
      c.rotation = a.r || 0;
      c.alpha = a.a || 1;
      c.vx = a.nvx ? a.nvx : a.vx ? a.vx : 0;
      c.vy = a.nvy ? a.nvy : a.vy ? a.vy : 0;
      c.ttl = a.ttl;
      void 0 !== a.s && (c.scale.x = c.scale.y = a.s);
      a.rs &&
        ((d = Math.random() * (a.rs.max - a.rs.min)),
        (c.scale.x *= a.rs.min + d),
        (c.scale.y *= a.rs.min + d));
      a.vat && (c.vat = a.vat);
      a.vs && (c.vs = a.vs);
      a.vr ? (c.vr = a.vr) : 10 === a._r && (c.dr = !0);
      void 0 !== a.va && (c.va = a.va);
      a.gs && (c.gs = a.gs);
      a.collide && (c.collide = a.collide);
      a.appear && ((c.alpha = 0), (c.appear = a.appear));
      void 0 !== a.tt && (c.tint = a.tt);
      this.addChild(c);
    }
  }
  update() {
    var a = App.Time;
    let b = 1;
    var c = a - this.lastUpdate;
    34 < c && (b = 50 < c ? 3 : 2);
    this.lastUpdate = a;
    for (a = this.children.length; 0 < a--; )
      (c = this.children[a]),
        0 >= c.ttl
          ? this.removeChild(c)
          : ((c.x += c.vx),
            (c.y += c.vy),
            c.vr
              ? (c.rotation += c.vr)
              : c.dr && (c.rotation = Math.atan2(c.vy, c.vx) + 0.5 * Math.PI),
            void 0 !== c.va
              ? (c.vat && c.ttl < c.vat
                  ? (c.alpha -= 1 / (c.vat * b))
                  : void 0 !== c.appear
                  ? 0 < c.appear
                    ? ((c.alpha = 0), c.appear--)
                    : 0 === c.appear && ((c.alpha = 0.75), (c.appear = void 0))
                  : (c.alpha += c.va * b),
                (c.alpha = Math.max(c.alpha, 0)))
              : (c.alpha = (1 / c.startTTL) * c.ttl),
            c.vs && ((c.scale.x += c.vs), (c.scale.y += c.vs)),
            c.gs &&
              ((c.vx += (PC.GRAVITY.x / PC.PM_RATIO) * c.gs),
              (c.vy += (PC.GRAVITY.y / PC.PM_RATIO) * c.gs)),
            c.collide && this.checkCollision(c),
            (c.ttl -= b));
  }
  checkCollision(a) {
    var b = a.x + a.vx;
    let c = a.y + a.vy,
      d = ParticleContainer.FB.search(b, c, b + a.vx, c + a.vy),
      e = Math.min(d.length, 8);
    for (let f = 0; f < e; f++) {
      let g = ParticleContainer.Segments[d[f]];
      if (0 <= Intersect3(a.x, a.y, b, c, g.x1, g.y1, g.x1 + g.x2, g.y1 + g.y2)) {
        b = (2 * (a.vx * g.x2 + a.vy * g.y2)) / (g.x2 * g.x2 + g.y2 * g.y2);
        a.vx = 0.5 * (b * g.x2 - a.vx);
        a.vy = 0.5 * (b * g.y2 - a.vy);
        break;
      }
    }
  }
  clear() {
    this.removeChildren();
    ParticleContainer.Segments = [];
    ParticleContainer.FB = { search: () => [] };
  }
}
ParticleContainer.FB = { search: () => [] };
ParticleContainer.Segments = [];
ParticleContainer.AddLineSegment = function (a) {
  ParticleContainer.Segments.push(a);
};
ParticleContainer.ProcessCollisionMesh = function () {
  let a = ParticleContainer.Segments.length;
  if (0 !== a) {
    ParticleContainer.FB = new Flatbush(a);
    for (let b = 0; b < a; b++) {
      let c = ParticleContainer.Segments[b],
        d = c.x1 + c.x2,
        e = c.y1 + c.y2;
      ParticleContainer.FB.add(
        (c.x1 < d ? c.x1 : d) - 8,
        (c.y1 < e ? c.y1 : e) - 8,
        (c.x1 < d ? d : c.x1) + 8,
        (c.y1 < e ? e : c.y1) + 8
      );
      ParticleContainer.Segments[b] = c;
    }
    ParticleContainer.FB.finish();
  }
};
var rewardsmenu = {};
class RewardsMenu extends Feature {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.x = 0;
    this.background.y = 40;
    this.background.beginFill(0, 0.5);
    this.background.drawRect(0, 0, 660, 524);
    this.background.endFill();
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.99);
    this.background.drawRect(130, 100, 390, 324);
    this.background.endFill();
    this.background.beginFill(0, 0.3);
    this.background.drawRect(140, 110, 370, 304);
    this.background.endFill();
    this.background.drawRect(145, 142, 360, 2);
    this.container.addChild(this.background);
    this.ox = 20;
    this.oy = 60;
    this.title = new PIXI.Text("Rewards", {
      fontName: "Arial",
      fontSize: 19,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.x = 0.5 * (this.background.width - this.title.width);
    this.title.y = 158;
    this.container.addChild(this.title);
    this.rewardsList = new PIXI.Container();
    this.rewardsList.x = 140;
    this.rewardsList.y = 150;
    this.container.addChild(this.rewardsList);
    this.closeButton = new ImgButton();
    this.closeButton.x = 480;
    this.closeButton.y = 154;
    this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
    this.closeButton.on(ImgButton.CLICK, () => this.emit(Layer.Events.REWARDS_CANCEL));
    this.container.addChild(this.closeButton);
    this.treasureIcon = new PIXI.Sprite(App.CombinedTextures.treasure);
    this.treasureIcon.x = 156;
    this.treasureIcon.y = 400;
    this.treasureIcon.interactive = !1;
    this.container.addChild(this.treasureIcon);
    this.totalAmount = new PIXI.Text("", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 5,
      lineJoin: "round",
    });
    this.totalAmount.x = 180;
    this.totalAmount.y = 422;
    this.totalAmount.anchor.x = 0.5;
    this.container.addChild(this.totalAmount);
    this.warningText = new PIXI.Text("Disable AdBlock to claim reward", {
      fontName: "Arial",
      fontSize: 18,
      lineHeight: 16,
      fill: 16711680,
      strokeThickness: 4,
      lineJoin: "round",
    });
    this.warningText.x = 220;
    this.warningText.y = 412;
    this.warningText.resolution = 1.5 * App.DevicePixelRatio;
    this.container.addChild(this.warningText);
    this.warningText.visible = !1;
    this.rewardButton = new PIXI.Sprite(App.CombinedTextures.reward_button_claim);
    this.rewardButton.scale.x = this.rewardButton.scale.y = 0.95;
    this.rewardButton.x = 220;
    this.rewardButton.y = 394;
    this.rewardButton.interactive = !0;
    this.container.addChild(this.rewardButton);
    this.disableRewardButton();
    this.rewardButton.on("mousedown", () => {
      this.triggerRewardedBreak();
    });
    this.rewardButton.on("mouseover", () => {
      this.rewardButton.texture = App.CombinedTextures.reward_button_claim_down;
    });
    this.rewardButton.on("mouseout", () => {
      this.rewardButton.texture = App.CombinedTextures.reward_button_claim;
    });
    this.rewardContainer = new PIXI.Container();
    this.rewardContainer.visible = !1;
    this.rewardBackground = new PIXI.Graphics();
    this.rewardBackground.beginFill(0, 0.5);
    this.rewardBackground.drawRect(0, 0, 660, 524);
    this.rewardBackground.endFill();
    this.rewardBackground.lineStyle(1, 16777215, 0.1, 0);
    this.rewardBackground.beginFill(3355443, 1);
    this.rewardBackground.drawRoundedRect(165, 150, 330, 220, 10);
    this.rewardBackground.beginFill(0, 0.3);
    this.rewardBackground.drawRoundedRect(175, 160, 310, 200, 10);
    this.rewardBackground.endFill();
    this.rewardBackground.interactive = !0;
    this.rewardContainer.addChild(this.rewardBackground);
    this.rewardBackground.x = 0;
    this.rewardBackground.y = 40;
    this.rewardedAmountCounter = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 26,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 5,
      lineJoin: "round",
    });
    this.rewardedAmountCounter.resolution = 2 * App.DevicePixelRatio;
    this.rewardedAmountCounter.anchor.x = 0.5;
    this.rewardContainer.addChild(this.rewardedAmountCounter);
    this.rewardedTreasureIcon = new PIXI.Sprite(App.CombinedTextures.treasure);
    this.rewardedTreasureIcon.x = 330;
    this.rewardedTreasureIcon.y = 250;
    this.rewardedTreasureIcon.scale.x = this.rewardedTreasureIcon.scale.y = 1.2;
    this.rewardedTreasureIcon.anchor.x = this.rewardedTreasureIcon.anchor.y = 0.5;
    this.rewardedTreasureIcon.interactive = !1;
    this.rewardContainer.addChild(this.rewardedTreasureIcon);
    this.rewardedAmountCounter.x = this.rewardedTreasureIcon.x;
    this.rewardedAmountCounter.y = this.rewardedTreasureIcon.y + 50;
    this.rewardedAmount = new PIXI.Text("Gold added to account!", {
      fontName: "Arial",
      fontSize: 20,
      lineHeight: 16,
      fill: 16763904,
      strokeThickness: 5,
      lineJoin: "round",
    });
    this.rewardedAmount.x = this.rewardedTreasureIcon.x;
    this.rewardedAmount.y = this.rewardedTreasureIcon.y + 100;
    this.rewardedAmount.anchor.x = 0.5;
    this.rewardedAmount.resolution = 1.5 * App.DevicePixelRatio;
    this.rewardContainer.addChild(this.rewardedAmount);
    this.container.x = 0.5 * -this.width;
    this.rewardContainer.x = 0.5 * -this.width;
    this.addChild(this.rewardContainer);
    this.time = 0;
    this.particles = [];
    this.animationContainer = new PIXI.Sprite();
    this.particleContainer = new ParticleContainer();
  }
  update() {
    if (this.rewardContainer.visible) {
      var a = this.rewardedTreasureIcon.x,
        b = this.rewardedTreasureIcon.y;
      for (let d = 0, e = this.particles.length; d < e; d++) {
        var c = this.particles[d];
        let f = a - c.x,
          g = b - c.y;
        10 > Math.sqrt(f * f + g * g)
          ? ((this.rewardedAmountCounter.scale.x += 0.001),
            (this.rewardedAmountCounter.scale.y += 0.001),
            (this.rewardedTreasureIcon.scale.x += 0.001),
            (this.rewardedTreasureIcon.scale.y += 0.001),
            this.animationContainer.removeChild(c),
            this.particles.splice(d, 1),
            d--,
            e--,
            AudioEffects.GoldPickup[
              Math.floor(Math.random() * AudioEffects.GoldPickup.length)
            ].audio.play())
          : ((c.x += 0.02 * f),
            (c.y += 0.04 * g),
            (c.rotation += c.vr),
            (c.vx *= 0.99),
            (c.vy *= 0.99),
            (c.alpha -= 0.004),
            (c.scale.x -= 0.002),
            (c.scale.y -= 0.002));
      }
      5 < this.particles.length &&
        ((c = ParticleEffects.GoldGlitter),
        (c.x = a),
        (c.y = b),
        (c.vx = -2 + 4 * Math.random()),
        (c.vy = -2 + 4 * Math.random()),
        (c.vr = -0.3 + 0.6 * Math.random()),
        (c.a = 0.7),
        (a = c.s),
        (c.s = 1),
        this.particleContainer.spawn(c),
        (c.s = a));
      this.particleContainer.update();
    }
  }
  displayRewardDialog(a) {
    this.container.visible = !1;
    this.rewardContainer.visible = !0;
    this.rewardedTreasureIcon.scale.x = this.rewardedTreasureIcon.scale.y = 1.2;
    this.rewardedAmountCounter.scale.x = this.rewardedAmountCounter.scale.y = 1;
    let b = parseInt(a, 10);
    this.time = 0;
    this.rewardedAmountCounter.text = "0";
    this.rewardContainer.addChild(this.animationContainer);
    this.rewardContainer.addChild(this.particleContainer);
    let c = 0;
    a = Math.round((b / 30) * 1e3);
    let d = this.rewardedTreasureIcon.x,
      e = this.rewardedTreasureIcon.y,
      f = setInterval(() => {
        let g = new PIXI.Sprite(App.CombinedTextures.gold1);
        g.anchor.x = g.anchor.y = 0.5;
        g.x = d + 100 * Math.cos(0.5 * c);
        g.y = e - 150 + 10 * Math.sin(0.5 * c);
        g.scale.x = 0.4;
        g.scale.y = 0.4;
        g.vx = 0;
        g.vy = 0;
        g.vr = 0.5 < Math.random() ? -0.2 : 0.2;
        this.particles.push(g);
        this.animationContainer.addChild(g);
        for (let h = 0; 10 > h; h++) {
          let k = ParticleEffects.GoldGlitter;
          k.x = g.x;
          k.y = g.y;
          k.vx = -1 + 2 * Math.random();
          k.vy = -1 + 2 * Math.random();
          k.vr = -0.3 + 0.6 * Math.random();
          k.a = 0.7;
          let m = k.s;
          k.s = 0.5;
          this.particleContainer.spawn(k);
          k.s = m;
        }
        c++;
        this.rewardedAmountCounter.text = c.toString();
        c >= b && (clearInterval(f), (f = null));
      }, 1e3 / 30);
    setTimeout(() => {
      null !== f && clearInterval(f);
    }, a);
    setTimeout(() => {
      this.emit(Layer.Events.REWARDS_CANCEL);
      this.rewardContainer.removeChild(this.animationContainer);
      this.rewardContainer.removeChild(this.particleContainer);
      this.animationContainer.removeChildren();
      this.particleContainer.clear();
      this.particles = [];
    }, a + 2e3);
  }
  displayRegular() {
    this.rewardContainer.visible = !1;
    this.container.visible = !0;
  }
  displayWarning() {
    this.rewardButton.visible = !1;
    this.warningText.visible = !0;
    setTimeout(() => {
      this.rewardButton.visible = !0;
      this.warningText.visible = !1;
      this.enableRewardButton();
    }, 4e3);
  }
  triggerRewardedBreak() {
    this.disableRewardButton();
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.ShowRewardedAd = !0;
        App.CrazySDK.requestAd("rewarded");
        break;
      case App.WhiteLabel_POKI:
      case App.WhiteLabel_POKI_MAIN:
        App.PokiSDK.rewardedBreak().then((a) => {
          a
            ? this.claimRewards()
            : (this.emit(Layer.Events.REWARDS_CLAIMED, !1, 0), this.displayWarning());
        });
    }
  }
  async claimRewards() {
    let a = await APIClient.postClaimRewards(App.Credential.id);
    a.success
      ? ((App.HadRewards = !1),
        this.emit(Layer.Events.REWARDS_CLAIMED, !0, a.reward),
        this.displayRewardDialog(a.reward))
      : this.emit(Layer.Events.REWARDS_CLAIMED, !1, 0);
  }
  disableRewardButton() {
    this.rewardButton.alpha = 0.5;
    this.rewardButton.interactive = !1;
  }
  enableRewardButton() {
    this.rewardButton.alpha = 1;
    this.rewardButton.interactive = !0;
  }
  async show() {
    this.displayRegular();
    var a = await APIClient.getRewards(App.Credential.id);
    this.rewardsList.removeChildren();
    if (a.success) {
      null === a.rewards && (a.rewards = []);
      a = a.rewards;
      var b = 0,
        c = 0;
      for (let d in RewardRow.TYPE) {
        let e = new RewardRow(d, RewardRow.TYPE_AMOUNT[d]);
        e.x = 14;
        e.y = 54 + 64 * c;
        this.rewardsList.addChild(e);
        e.setInactive();
        for (let f = 0; f < a.length; f++) {
          let g = a[f];
          if (d === g.type) {
            e.setActive();
            b += parseInt(g.reward);
            break;
          }
        }
        c++;
      }
      0 < b && this.enableRewardButton();
      this.totalAmount.text = b.toString();
    }
  }
}
class RewardRow extends PIXI.Graphics {
  constructor(a, b) {
    super();
    this.lineStyle(1, 16777215, 0.1, 0);
    this.beginFill(3355443, 0.99);
    this.drawRect(0, 0, 340, 60);
    this.endFill();
    this.unlockedTitle = RewardRow.TYPE[a];
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold);
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.5;
    this.goldIcon.x = 10;
    this.goldIcon.y = 4;
    this.addChild(this.goldIcon);
    this.goldAmount = new PIXI.Text(b, {
      fontName: "Arial",
      fontSize: 15,
      fill: 16763904,
      strokeThickness: 4,
      lineJoin: "round",
    });
    this.goldAmount.x = this.goldIcon.x + 0.5 * this.goldIcon.width + 1;
    this.goldAmount.y = 34;
    this.goldAmount.anchor.x = 0.5;
    this.addChild(this.goldAmount);
    this.title = new PIXI.Text(this.unlockedTitle + " [locked]", {
      fontName: "Arial",
      fontSize: 18,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.x = 50;
    this.title.y = 6;
    this.addChild(this.title);
    this.desc = new PIXI.Text(RewardRow.TYPE_DESC[a], {
      fontName: "Arial",
      fontSize: 15,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.desc.x = 50;
    this.desc.y = 33;
    this.addChild(this.desc);
    this.alpha = 0.5;
  }
  setActive() {
    this.alpha = 1;
    this.title.text = this.unlockedTitle;
  }
  setInactive() {
    this.alpha = 0.5;
  }
}
RewardRow.TYPE = { day: "Daily reward", "10m": "10 minutes played", "30m": "30 minutes played" };
RewardRow.TYPE_AMOUNT = { day: 150, "10m": 125, "30m": 150 };
RewardRow.TYPE_DESC = {
  day: "Join every day to get this reward.",
  "10m": "Play for 10 minutes to get this reward.",
  "30m": "Play for 30 minutes to get this reward.",
};
var layer = {};
class Layer extends PIXI.Container {
  constructor() {
    super();
    this.mode = null;
    this.member = !1;
    this.w = App.ClientWidth;
    this.h = App.ClientHeight;
    this.features = [];
    this.updateFeatures = [];
    this.gameMenu = new GameMenu();
    this.guestMenu = new GuestMenu();
    this.memberMenu = new MemberMenu();
    this.memberBrowserMenu = new MemberBrowserMenu();
    this.clanBrowserMenu = new ClanBrowserMenu();
    this.loginMenu = new LoginMenu();
    this.registerMenu = new RegisterMenu();
    this.upResetMenu = new UPResetMenu();
    this.profileMenu = new ProfileMenu();
    this.customizationMenu = new CustomizationMenu();
    this.userMenu = new UserMenu();
    this.rankingMenu = new RankingMenu();
    this.newsMenu = new NewsMenu();
    this.partnerMenu = new PartnerMenu();
    this.serverListMenu = new ServerListMenu();
    this.serverCreationMenu = new ServerCreationMenu();
    this.clanMenu = new ClanMenu();
    this.loadingMenu = new LoadingMenu();
    this.renameMenu = new RenameMenu();
    this.logoutMenu = new LogoutMenu();
    this.serverDetailMenu = new ServerDetailMenu();
    this.guestProfileMenu = new GuestProfileMenu();
    this.highscoreMenu = new HighscoreMenu();
    this.rewardsMenu = new RewardsMenu();
    this.mainMenuHides = [
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverListMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.serverCreationMenu,
      this.renameMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu,
    ];
    this.loginMenu.hides.push(
      this.registerMenu,
      this.upResetMenu,
      this.profileMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.memberBrowserMenu.hides.push(
      this.loginMenu,
      this.registerMenu,
      this.upResetMenu,
      this.profileMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.clanBrowserMenu.hides.push(
      this.loginMenu,
      this.registerMenu,
      this.upResetMenu,
      this.profileMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.registerMenu.hides.push(
      this.loginMenu,
      this.upResetMenu,
      this.profileMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.upResetMenu.hides.push(
      this.loginMenu,
      this.registerMenu,
      this.profileMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.profileMenu.hides.push(
      this.loginMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.userMenu.hides.push(
      this.loginMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.rankingMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.newsMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.newsMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.partnerMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.partnerMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverListMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.serverListMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverCreationMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.clanMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverCreationMenu,
      this.serverListMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.serverCreationMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverListMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.renameMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.renameMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverListMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.serverCreationMenu,
      this.logoutMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.logoutMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverListMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.serverCreationMenu,
      this.renameMenu,
      this.serverDetailMenu,
      this.guestProfileMenu,
      this.rewardsMenu
    );
    this.guestProfileMenu.hides.push(
      this.loginMenu,
      this.profileMenu,
      this.registerMenu,
      this.upResetMenu,
      this.customizationMenu,
      this.userMenu,
      this.rankingMenu,
      this.newsMenu,
      this.serverListMenu,
      this.loadingMenu,
      this.memberBrowserMenu,
      this.clanBrowserMenu,
      this.clanMenu,
      this.serverCreationMenu,
      this.renameMenu,
      this.serverDetailMenu,
      this.rewardsMenu
    );
    this.features.push(this.gameMenu);
    this.features.push(this.guestMenu);
    this.features.push(this.memberMenu);
    this.features.push(this.memberBrowserMenu);
    this.features.push(this.clanBrowserMenu);
    this.features.push(this.loginMenu);
    this.features.push(this.registerMenu);
    this.features.push(this.upResetMenu);
    this.features.push(this.profileMenu);
    this.features.push(this.customizationMenu);
    this.features.push(this.userMenu);
    this.features.push(this.rankingMenu);
    this.features.push(this.newsMenu);
    this.features.push(this.partnerMenu);
    this.features.push(this.serverListMenu);
    this.features.push(this.serverCreationMenu);
    this.features.push(this.clanMenu);
    this.features.push(this.loadingMenu);
    this.features.push(this.renameMenu);
    this.features.push(this.logoutMenu);
    this.features.push(this.serverDetailMenu);
    this.features.push(this.guestProfileMenu);
    this.features.push(this.highscoreMenu);
    this.features.push(this.rewardsMenu);
    this.updateFeatures.push(
      this.profileMenu,
      this.userMenu,
      this.loadingMenu,
      this.rewardsMenu,
      this.customizationMenu
    );
    this.cursor = new PIXI.Sprite(App.CombinedTextures.mouse_pointer);
    this.cursor.x = 0.5 * App.ClientWidth;
    this.cursor.y = 0.5 * App.ClientHeight;
    this.cursor.anchor.x = 0;
    this.cursor.anchor.y = 0;
    this.cursor.scale.x = this.cursor.scale.y = 0.25;
    this.cursor.visible = !1;
    this.interactive = !0;
    this.onKeyDownListener = this.onKeyDown.bind(this);
    this.on("mousemove", (a) => {
      this.cursor.x = (a.data.global.x - this.x) / this.scale.x;
      this.cursor.y = (a.data.global.y - this.y) / this.scale.y;
    });
    this.on("mouseover", (a) => {
      this.cursor.visible = !0;
      this.cursor.parent && this.setChildIndex(this.cursor, this.children.length - 1);
    });
    this.on("mouseout", (a) => {
      this.cursor.visible = !1;
    });
    this.on("mousedown", (a) => {
      this.cursor.visible = !0;
      this.cursor.parent && this.setChildIndex(this.cursor, this.children.length - 1);
    });
    this.on("touchstart", (a) => {
      this.cursor.visible = !1;
    });
    this.setupEventRouting();
    switch (new URLSearchParams(window.location.search).get("action")) {
      case "login":
        this.onLoginShow();
    }
  }
  setupEventRouting() {
    this.gameMenu.on(Layer.Events.DISCONNECT, () => this.emit(Layer.Events.DISCONNECT));
    this.gameMenu.on(Layer.Events.JOYSTICK_MOVE_STATE, (a) =>
      this.emit(Layer.Events.JOYSTICK_MOVE_STATE, a)
    );
    this.gameMenu.on(Layer.Events.JOYSTICK_TARGET_STATE, (a) =>
      this.emit(Layer.Events.JOYSTICK_TARGET_STATE, a)
    );
    this.gameMenu.on(Layer.Events.DISPLAY_HELP, () => this.emit(Layer.Events.DISPLAY_HELP));
    this.gameMenu.on(Layer.Events.MUTE_TOGGLE, (a) => this.emit(Layer.Events.MUTE_TOGGLE, a));
    this.gameMenu.on(Layer.Events.ESCAPE_MENU_ACCESS, () =>
      this.emit(Layer.Events.ESCAPE_MENU_ACCESS)
    );
    this.guestMenu.on(Layer.Events.MENU_ACCESS, () => this.onMenuAccess());
    this.guestMenu.on(Layer.Events.LOGIN_ACCESS, () => this.onLoginShow());
    this.guestMenu.on(Layer.Events.REGISTER_ACCESS, () => this.onRegisterShow());
    this.guestMenu.on(Layer.Events.RANKING_ACCESS, () => this.onRankingShow());
    this.guestMenu.on(Layer.Events.CUSTOMIZATION_ACCESS, () => this.onGuestCustomizationAccess());
    this.guestMenu.on(Layer.Events.MEMBER_ACCESS, () => this.onMemberShow());
    this.guestMenu.on(Layer.Events.CLAN_BROWSER_ACCESS, () => this.onClanBrowserShow());
    this.guestMenu.on(Layer.Events.PARTNER_ACCESS, () => this.onPartnerShow());
    this.guestMenu.on(Layer.Events.GUEST_PROFILE_ACCESS, () => this.onGuestProfileAccess());
    this.guestMenu.on(Layer.Events.SETTINGS_ACCESS, () => this.onSettingsAccess());
    this.guestProfileMenu.on(Layer.Events.GUEST_PROFILE_HIDE, () => this.onGuestProfileHide());
    this.guestProfileMenu.on(Layer.Events.LOGIN_ACCESS, () => this.onLoginShow());
    this.guestProfileMenu.on(Layer.Events.REGISTER_ACCESS, () => this.onRegisterShow());
    this.memberMenu.on(Layer.Events.MENU_ACCESS, () => this.onMenuAccess());
    this.memberMenu.on(Layer.Events.LOGOUT, () => this.onLogout());
    this.memberMenu.on(Layer.Events.RANKING_ACCESS, () => this.onRankingShow());
    this.memberMenu.on(Layer.Events.MEMBER_ACCESS, () => this.onMemberShow());
    this.memberMenu.on(Layer.Events.CLAN_BROWSER_ACCESS, () => this.onClanBrowserShow());
    this.memberMenu.on(Layer.Events.CUSTOMIZATION_ACCESS, () => this.onCustomizationShow());
    this.memberMenu.on(Layer.Events.LOGOUT_ACCESS, () => this.onLogoutAccess());
    this.memberMenu.on(Layer.Events.SETTINGS_ACCESS, () => this.onSettingsAccess());
    this.memberMenu.on(Layer.Events.PROFILE_ACCESS, () => this.onProfileAccess());
    this.memberBrowserMenu.on(Layer.Events.MEMBER_CANCEL, () => this.onMemberCancel());
    this.memberBrowserMenu.on(Layer.Events.USER_ACCESS, (a) => this.onUserAccess(a));
    this.clanBrowserMenu.on(Layer.Events.CLAN_ACCESS, (a) => this.onClanAccess(a));
    this.clanBrowserMenu.on(Layer.Events.CLAN_BROWSER_CANCEL, () => this.onClanBrowserCancel());
    this.loginMenu.on(Layer.Events.LOGIN_SUBMIT, (a) => this.onLoginSubmit(a));
    this.loginMenu.on(Layer.Events.LOGIN_CANCEL, () => this.onLoginCancel());
    this.loginMenu.on(Layer.Events.RECOVER_ACCESS, () => this.onRecoverShow());
    this.registerMenu.on(Layer.Events.REGISTER_SUBMIT, (a) => this.onRegisterSubmit(a));
    this.registerMenu.on(Layer.Events.REGISTER_CANCEL, () => this.onRegisterCancel());
    this.upResetMenu.on(Layer.Events.RECOVER_SUBMIT, (a) => this.onRecoverSubmit(a));
    this.upResetMenu.on(Layer.Events.RECOVER_CANCEL, () => this.onRecoverCancel());
    this.profileMenu.on(Layer.Events.PROFILE_ACCESS, () => this.onProfileAccess());
    this.profileMenu.on(Layer.Events.PROFILE_CANCEL, () => this.onProfileCancel());
    this.profileMenu.on(Layer.Events.PROFILE_RENAME, (a) => this.onProfileRename(a));
    this.profileMenu.on(Layer.Events.USER_ACCESS, (a) => this.onUserAccess(a));
    this.profileMenu.on(Layer.Events.LEAVE_CLAN, () => this.onProfileLeaveClan());
    this.profileMenu.on(Layer.Events.CREATE_CLAN, () => this.onProfileCreateClan());
    this.profileMenu.on(Layer.Events.RENAME_ACCESS, () => this.onRenameAccess());
    this.profileMenu.on(Layer.Events.LOGOUT, () => this.onAccountDeactivateLogout());
    this.customizationMenu.on(Layer.Events.CUSTOMIZATION_CANCEL, () =>
      this.onCustomizationCancel()
    );
    this.customizationMenu.on(Layer.Events.UPDATE_CREDENTIAL, (a) =>
      this.emit(Layer.Events.UPDATE_CREDENTIAL, a, !0)
    );
    this.customizationMenu.on(Layer.Events.REWARDS_CLAIMED, (a) =>
      this.onRewardedShopAdFinished(a)
    );
    this.userMenu.on(Layer.Events.USER_UNFRIEND, () => this.onUserUnfriend());
    this.userMenu.on(Layer.Events.USER_CANCEL, () => this.onUserCancel());
    this.userMenu.on(Layer.Events.CLAN_ACCESS, (a) => this.onClanAccess(a));
    this.rankingMenu.on(Layer.Events.USER_ACCESS, (a) => this.onUserAccess(a));
    this.rankingMenu.on(Layer.Events.RANKING_CANCEL, () => this.onRankingCancel());
    this.newsMenu.on(Layer.Events.NEWS_CANCEL, () => this.onNewsCancel());
    this.serverListMenu.on(Layer.Events.SERVER_LIST_CANCEL, () => this.onServerListClose());
    this.serverListMenu.on(Layer.Events.JOIN_GAME, (a, b, c) => this.onServerListJoinGame(a, b, c));
    this.serverListMenu.on(Layer.Events.SERVER_LIST_REFRESH, () => this.onServerListRefresh());
    this.serverListMenu.on(Layer.Events.SERVER_DETAIL_ACCESS, (a) => this.onServerDetailAccess(a));
    this.serverCreationMenu.on(Layer.Events.SERVER_CREATION_INIT, () =>
      this.onServerCreationInit()
    );
    this.serverCreationMenu.on(Layer.Events.SERVER_CREATION_CANCEL, () =>
      this.onServerCreationClose()
    );
    this.serverCreationMenu.on(Layer.Events.SERVER_CREATION_REGION, (a) =>
      this.onServerCreationRegion(a)
    );
    this.serverCreationMenu.on(Layer.Events.SERVER_CREATION_JOIN_LOBBY, () =>
      this.onServerCreationJoinLobby()
    );
    this.serverCreationMenu.on(Layer.Events.SERVER_CREATION_SESSION_INIT, (a) =>
      this.onServerCreationInitSession(a)
    );
    this.serverCreationMenu.on(Layer.Events.JOIN_GAME, (a, b, c) =>
      this.onServerCreationJoinGame(a, b, c)
    );
    this.loadingMenu.on(Layer.Events.LOADING_CANCEL, () => this.onLoadingCancel());
    this.partnerMenu.on(Layer.Events.PARTNER_CANCEL, () => this.onPartnerCancel());
    this.clanMenu.on(Layer.Events.CLAN_CANCEL, () => this.onClanCancel());
    this.clanMenu.on(Layer.Events.USER_ACCESS, (a) => this.onUserAccess(a));
    this.renameMenu.on(Layer.Events.RENAME_COMPLETED, () => this.onRenameCompleted());
    this.renameMenu.on(Layer.Events.RENAME_CANCEL, () => this.onRenameCancel());
    this.logoutMenu.on(Layer.Events.LOGOUT, () => this.onLogout());
    this.logoutMenu.on(Layer.Events.LOGOUT_CANCEL, () => this.onLogoutCancel());
    this.logoutMenu.on(Layer.Events.RENAME_ACCESS, () => this.onRenameAccess());
    this.serverDetailMenu.on(Layer.Events.SERVER_DETAIL_CANCEL, () => this.onServerDetailCancel());
    this.serverDetailMenu.on(Layer.Events.JOIN_GAME, (a, b, c) =>
      this.onServerListJoinGame(a, b, c)
    );
    this.highscoreMenu.on(Layer.Events.USER_ACCESS, (a) => this.onUserAccess(a));
    this.rewardsMenu.on(Layer.Events.REWARDS_CANCEL, () => this.onRewardsCancel());
    this.rewardsMenu.on(Layer.Events.REWARDS_CLAIMED, (a, b) => this.onRewardsClaimed(a, b));
  }
  async setMode(a) {
    if (this.mode !== a) {
      switch (a) {
        case Layer.MODE_GAME:
          this.setModeGame();
          break;
        case Layer.MODE_MENU:
          this.setModeMenu();
      }
      this.mode = a;
      await this.updateCredentialsIfExpired();
      this.mode === Layer.MODE_GAME && this.addChild(this.cursor);
    }
  }
  async updateCredentialsIfExpired(a = !1) {
    let b = Registry.Instance.credential;
    void 0 === b || !1 === b.available || void 0 === b.accounttype
      ? this.applyGuestSetup()
      : a || Date.now() > 1e3 * b.ts + 24e4
      ? ((a = await APIClient.getCredentials(App.Credential.id)),
        (b = a.success ? a.credential : { available: !1 }),
        "guest" === b.accounttype
          ? App.Autogen
            ? ((a = Registry.Instance.retrieve(Registry.Key.AUTOGEN)),
              void 0 !== a.name &&
                void 0 !== a.password &&
                ((b = await APIClient.postLogin(a.name, atob(a.password))),
                this.emit(Layer.Events.UPDATE_CREDENTIAL, b, !0),
                "guest" !== b.accounttype ? this.applyMemberSetup() : this.applyGuestSetup()))
            : (this.emit(Layer.Events.UPDATE_CREDENTIAL, b, !0), this.applyGuestSetup())
          : (this.emit(Layer.Events.UPDATE_CREDENTIAL, b, !0), this.applyMemberSetup()))
      : "guest" === b.accounttype
      ? this.applyGuestSetup()
      : this.applyMemberSetup();
  }
  onKeyDown(a) {
    if (27 === a.data.code) {
      this.mainMenuHides.forEach((b) => this.hideFeature(b));
      switch (this.setup) {
        case Layer.SETUP_GUEST:
          this.guestMenu.setMode(GuestMenu.MODE_NONE);
          break;
        case Layer.SETUP_MEMBER:
          this.memberMenu.setMode(MemberMenu.MODE_NONE);
      }
      this.emit(Layer.Events.SHOW_MENU);
    }
  }
  setModeGame() {
    UserInput.removeListener(UserInput.KEY_DOWN, this.onKeyDownListener);
    this.guestMenu.parent && this.removeChild(this.guestMenu);
    this.loginMenu.parent && this.removeChild(this.loginMenu);
    this.memberMenu.parent && this.removeChild(this.memberMenu);
    this.registerMenu.parent && this.removeChild(this.registerMenu);
    this.upResetMenu.parent && this.removeChild(this.upResetMenu);
    this.serverListMenu.parent && this.removeChild(this.serverListMenu);
    this.serverCreationMenu.parent && this.removeChild(this.serverCreationMenu);
    this.loadingMenu.parent && this.removeChild(this.loadingMenu);
    this.highscoreMenu.parent && this.removeChild(this.highscoreMenu);
    this.addChild(this.gameMenu);
    this.gameMenu.show();
    SocialMenu.MODE_GAME = !0;
    this.socialMenu &&
      this.socialMenu.parent &&
      (this.socialMenu.collapsed || this.socialMenu.collapseMenu(!0, !1),
      this.socialMenu.repositionForGame());
  }
  setModeMenu() {
    UserInput.addListener(UserInput.KEY_DOWN, this.onKeyDownListener);
    this.gameMenu.parent && this.removeChild(this.gameMenu);
    this.cursor.parent && this.removeChild(this.cursor);
    SocialMenu.MODE_GAME = !1;
    this.socialMenu &&
      this.socialMenu.parent &&
      (this.socialMenu.autoCollapsed && this.socialMenu.collapseMenu(!1, !1),
      this.socialMenu.collapsed || this.socialMenu.repositionForMenu());
  }
  update() {
    for (let a = 0; a < this.updateFeatures.length; a++)
      this.updateFeatures[a].parent && this.updateFeatures[a].update();
  }
  resize(a, b) {
    this.w = a;
    this.h = b;
    for (let c = 0; c < this.features.length; c++) this.features[c].resize(a, b);
  }
  async onLoginSubmit(a) {
    const b = await APIClient.postLogin(a.name, a.password);
    !1 === b.success
      ? (this.loginMenu.reset(),
        this.loginMenu.displayErrorMessage(
          void 0 !== b.error ? b.error : "Invalid username or password"
        ))
      : (this.emit(Layer.Events.UPDATE_CREDENTIAL, b, a.store),
        this.loginMenu.displayCompletedMessage(),
        this.applyMemberSetup());
  }
  applyGuestSetup() {
    this.setup = Layer.SETUP_GUEST;
    this.memberMenu.parent && this.removeChild(this.memberMenu);
    this.customizationMenu.parent &&
      (this.customizationMenu.hide(),
      this.removeChild(this.customizationMenu),
      this.emit(Layer.Events.SHOW_MENU));
    this.mode === Layer.MODE_MENU &&
      (this.addChild(this.guestMenu),
      this.highscoreMenu.parent || this.addChild(this.highscoreMenu));
    if (this.socialMenu && this.socialMenu.parent) {
      this.socialMenu.hide();
      this.removeChild(this.socialMenu);
      for (let a = 0; a < this.features.length; a++)
        if (this.features[a] === this.socialMenu) {
          this.features.splice(a, 1);
          break;
        }
    }
    if (this.clanChatMenu && this.clanChatMenu.parent) this.onClanChatCancel();
  }
  applyMemberSetup() {
    this.guestMenu.parent && this.removeChild(this.guestMenu);
    this.mode === Layer.MODE_MENU &&
      (this.addChild(this.memberMenu),
      this.highscoreMenu.parent || this.addChild(this.highscoreMenu));
    this.socialMenu &&
      this.socialMenu.parent &&
      this.setChildIndex(this.socialMenu, this.children.length - 1);
    this.setup !== Layer.SETUP_MEMBER &&
      ((this.setup = Layer.SETUP_MEMBER),
      this.socialMenu ||
        ((this.socialMenu = new SocialMenu()),
        this.socialMenu.on(Layer.Events.USER_ACCESS, (a) => this.onUserAccess(a)),
        this.socialMenu.on(Layer.Events.JOIN_CLAN, () => this.onSocialmenuJoinClan()),
        this.socialMenu.on(Layer.Events.CLAN_CHAT_ACCESS, () => this.onClanChatAccess()),
        this.socialMenu.show()),
      this.socialMenu.loadFriends(),
      this.features.push(this.socialMenu),
      App.IsMobile || this.addChild(this.socialMenu),
      this.socialMenu.resize(this.w, this.h),
      this.clanChatMenu ||
        ((this.clanChatMenu = new ClanChatMenu()),
        this.clanChatMenu.on(Layer.Events.CLAN_CHAT_CANCEL, () => this.onClanChatCancel())));
  }
  onClanChatCancel() {
    this.clanChatMenu.hide();
    this.removeChild(this.clanChatMenu);
    for (let a = 0; a < this.features.length; a++)
      if (this.features[a] === this.clanChatMenu) {
        this.features.splice(a, 1);
        break;
      }
  }
  hideFeature(a) {
    this.removeChild(a);
    a.hide();
  }
  onLoginShow() {
    this.loginMenu.hides.forEach((a) => this.hideFeature(a));
    if (this.guestMenu.mode === GuestMenu.MODE_LOGIN) this.onLoginCancel();
    else
      this.loginMenu.show(),
        this.guestMenu.setMode(GuestMenu.MODE_LOGIN),
        this.emit(Layer.Events.HIDE_MENU),
        this.loginMenu.parent || this.addChild(this.loginMenu);
  }
  onLoginCancel() {
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
    this.loginMenu.parent && this.removeChild(this.loginMenu);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onRegisterShow() {
    this.registerMenu.hides.forEach((a) => this.hideFeature(a));
    if (this.guestMenu.mode === GuestMenu.MODE_REGISTER) this.onRegisterCancel();
    else
      this.guestMenu.setMode(GuestMenu.MODE_REGISTER),
        this.emit(Layer.Events.HIDE_MENU),
        this.registerMenu.parent || this.addChild(this.registerMenu),
        this.registerMenu.show();
  }
  onRegisterCancel() {
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
    this.registerMenu.parent && this.removeChild(this.registerMenu);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onLogout() {
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.loginMenu.hides.forEach((b) => this.hideFeature(b));
    const a = { available: !1 };
    Registry.Instance.remove(Registry.Key.AUTOGEN);
    App.Autogen = !1;
    Registry.Instance.store(Registry.Key.CREDENTIAL, a);
    this.applyGuestSetup();
    this.registerMenu.reset();
    this.loginMenu.reset();
    this.customizationMenu.reset();
    this.emit(Layer.Events.UPDATE_CREDENTIAL, a);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onAccountDeactivateLogout() {
    this.applyGuestSetup();
    this.registerMenu.reset();
    this.loginMenu.reset();
    this.customizationMenu.reset();
    this.profileMenu.parent && this.removeChild(this.profileMenu);
    this.emit(Layer.Events.UPDATE_CREDENTIAL, { available: !1 });
    this.emit(Layer.Events.SHOW_MENU);
  }
  async onRegisterSubmit(a) {
    const b = await APIClient.postRegistration(a.name, a.email, a.password);
    !1 === b.success
      ? (this.registerMenu.reset(), this.registerMenu.displayErrorMessage(b.error))
      : 0 === a.email.length
      ? (this.registerMenu.displayCompletedMessage(!1),
        setTimeout(async () => {
          const c = await APIClient.postLogin(a.name, a.password);
          this.emit(Layer.Events.UPDATE_CREDENTIAL, c, !0);
          this.applyMemberSetup();
          this.onRegisterCancel();
        }, 4e3))
      : this.registerMenu.displayCompletedMessage();
  }
  onRecoverShow() {
    this.upResetMenu.hides.forEach((a) => this.hideFeature(a));
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
    this.upResetMenu.parent || this.addChild(this.upResetMenu);
    this.upResetMenu.show();
  }
  onRecoverCancel() {
    this.onLoginShow();
  }
  async onRecoverSubmit(a) {
    a = await APIClient.postRecovery(a.email, a.type, a.challenge);
    !1 === a.success
      ? (this.upResetMenu.reset(), this.upResetMenu.displayErrorMessage(a.error))
      : this.upResetMenu.displayCompletedMessage();
  }
  onProfileShow() {
    this.profileMenu.hides.forEach((a) => this.hideFeature(a));
    this.profileMenu.parent || this.addChild(this.profileMenu);
    this.profileMenu.show();
    this.emit(Layer.Events.HIDE_MENU);
    null === this.profileMenu.tab && this.profileMenu.openTab(ProfileMenu.TAB_OVERVIEW);
  }
  onGuestProfileAccess() {
    this.guestProfileMenu.hides.forEach((a) => this.hideFeature(a));
    if (this.guestMenu.mode === GuestMenu.MODE_GUEST_PROFILE) this.onGuestProfileHide();
    else
      this.emit(Layer.Events.HIDE_MENU),
        this.guestProfileMenu.parent || this.addChild(this.guestProfileMenu),
        this.guestMenu.setMode(GuestMenu.MODE_GUEST_PROFILE),
        this.guestProfileMenu.setTitle("Profile");
  }
  onGuestCustomizationAccess() {
    this.guestProfileMenu.hides.forEach((a) => this.hideFeature(a));
    if (this.guestMenu.mode === GuestMenu.MODE_SHOP) this.onGuestProfileHide();
    else
      this.emit(Layer.Events.HIDE_MENU),
        this.guestProfileMenu.parent || this.addChild(this.guestProfileMenu),
        this.guestMenu.setMode(GuestMenu.MODE_SHOP),
        this.guestProfileMenu.setTitle("Shop");
  }
  onGuestProfileHide() {
    this.guestProfileMenu.parent && this.removeChild(this.guestProfileMenu);
    this.emit(Layer.Events.SHOW_MENU);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
  }
  onSettingsAccess() {
    this.mainMenuHides.forEach((a) => this.hideFeature(a));
    if (
      this.guestMenu.mode === GuestMenu.MODE_SETTINGS ||
      this.memberMenu.mode === MemberMenu.MODE_SETTINGS
    )
      this.onSettingsHide();
    else {
      switch (this.setup) {
        case Layer.SETUP_GUEST:
          this.guestMenu.setMode(GuestMenu.MODE_SETTINGS);
          break;
        case Layer.SETUP_MEMBER:
          this.memberMenu.setMode(MemberMenu.MODE_SETTINGS);
      }
      this.emit(Layer.Events.SHOW_MENU);
      this.emit(Layer.Events.SETTINGS_ACCESS);
    }
  }
  onSettingsHide() {
    switch (this.setup) {
      case Layer.SETUP_GUEST:
        this.guestMenu.setMode(GuestMenu.MODE_NONE);
        break;
      case Layer.SETUP_MEMBER:
        this.memberMenu.setMode(MemberMenu.MODE_NONE);
    }
    this.emit(Layer.Events.SETTINGS_HIDE);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onProfileAccess() {
    this.emit(Layer.Events.HIDE_MENU);
    this.profileMenu.hides.forEach((a) => this.hideFeature(a));
    if (this.memberMenu.mode === MemberMenu.MODE_PROFILE) this.onProfileCancel();
    else
      this.profileMenu.parent || this.addChild(this.profileMenu),
        this.memberMenu.setMode(MemberMenu.MODE_PROFILE),
        this.profileMenu.show(),
        null === this.profileMenu.tab && this.profileMenu.openTab(ProfileMenu.TAB_OVERVIEW);
  }
  onProfileCancel() {
    this.profileMenu.parent && this.removeChild(this.profileMenu);
    this.emit(Layer.Events.SHOW_MENU);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
  }
  async onProfileRename(a) {
    a = await APIClient.postLogin(a.name, a.password);
    this.emit(Layer.Events.UPDATE_CREDENTIAL, a, !0);
  }
  async onSocialmenuJoinClan() {
    let a = await APIClient.getCredentials(App.Credential.id);
    a.success &&
      ((credential = a.credential), this.emit(Layer.Events.UPDATE_CREDENTIAL, credential, !0));
    this.socialMenu.refresh();
  }
  onClanChatAccess() {
    this.clanChatMenu.parent ||
      (this.addChild(this.clanChatMenu),
      this.clanChatMenu.show(),
      this.clanChatMenu.resize(this.w, this.h),
      (this.clanChatMenu.x =
        this.socialMenu.x + (this.socialMenu.x < 0.5 * App.ClientWidth ? 0 : -20)),
      (this.clanChatMenu.y = this.socialMenu.y + 36));
  }
  async onProfileLeaveClan() {
    let a = await APIClient.getCredentials(App.Credential.id);
    a.success &&
      ((credential = a.credential), this.emit(Layer.Events.UPDATE_CREDENTIAL, credential, !0));
    this.socialMenu.refresh();
  }
  async onProfileCreateClan() {
    let a = await APIClient.getCredentials(App.Credential.id);
    a.success &&
      ((credential = a.credential), this.emit(Layer.Events.UPDATE_CREDENTIAL, credential, !0));
    this.socialMenu.refresh();
  }
  onServerCreationShow() {
    this.serverCreationMenu.hides.forEach((a) => this.hideFeature(a));
    this.serverCreationMenu.parent || this.addChild(this.serverCreationMenu);
    this.serverCreationMenu.show();
  }
  onServerCreationInit() {}
  onServerCreationClose() {
    this.serverCreationMenu.parent && this.removeChild(this.serverCreationMenu);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onServerCreationRegion(a) {
    this.emit(Layer.Events.JOIN_SERVER, a);
  }
  onServerCreationJoinLobby() {
    this.onServerListingShow();
  }
  onServerCreationInitSession(a) {
    this.emit(Layer.Events.CREATE_SERVER, a);
  }
  onServerListingShow() {
    this.serverListMenu.hides.forEach((a) => this.hideFeature(a));
    this.serverListMenu.parent || this.addChild(this.serverListMenu);
    this.serverListMenu.show();
  }
  onServerListClose() {
    this.serverListMenu.parent && this.removeChild(this.serverListMenu);
    this.serverListMenu.hide();
    this.emit(Layer.Events.SHOW_MENU);
  }
  onServerListRefresh() {
    this.serverListMenu.refresh();
  }
  async onServerListJoinGame(a, b, c) {
    await this.updateCredentialsIfExpired();
    this.loadingMenu.parent || (this.addChild(this.loadingMenu), this.loadingMenu.show());
    this.emit(Layer.Events.JOIN_GAME, a, b, c);
  }
  onJoinGameMode() {
    this.loadingMenu.parent || (this.addChild(this.loadingMenu), this.loadingMenu.show());
    this.socialMenu &&
      300 > this.socialMenu.y &&
      (this.socialMenu.y =
        App.ClientHeight - (100 > this.socialMenu.height ? 200 : this.socialMenu.height));
  }
  onServerCreationJoinGame(a, b, c) {
    this.loadingMenu.parent || (this.addChild(this.loadingMenu), this.loadingMenu.show());
    this.emit(Layer.Events.JOIN_GAME, a, b, c);
  }
  onCustomizationShow() {
    if (
      this.guestMenu.mode === GuestMenu.MODE_SHOP ||
      this.memberMenu.mode === MemberMenu.MODE_SHOP
    )
      this.onCustomizationCancel();
    else
      this.mainMenuHides.forEach((a) => this.hideFeature(a)),
        this.customizationMenu.show(),
        this.addChild(this.customizationMenu),
        this.emit(Layer.Events.HIDE_MENU),
        this.memberMenu.setMode(MemberMenu.MODE_SHOP);
  }
  onCustomizationCancel() {
    this.customizationMenu.hide();
    this.customizationMenu.parent && this.removeChild(this.customizationMenu);
    this.emit(Layer.Events.SHOW_MENU);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
  }
  onUserAccess(a, b = "id") {
    this.userMenu.hides.forEach((c) => this.hideFeature(c));
    this.userMenu.load(a, b);
    this.addChild(this.userMenu);
    this.emit(Layer.Events.HIDE_MENU);
  }
  onUserCancel() {
    this.userMenu.parent && this.removeChild(this.userMenu);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onUserUnfriend() {
    this.socialMenu.refresh();
  }
  onRankingShow() {
    this.rankingMenu.hides.forEach((a) => this.hideFeature(a));
    if (
      this.guestMenu.mode === GuestMenu.MODE_RANKING ||
      this.memberMenu.mode === MemberMenu.MODE_RANKING
    )
      this.onRankingCancel();
    else {
      switch (this.setup) {
        case Layer.SETUP_GUEST:
          this.guestMenu.setMode(GuestMenu.MODE_RANKING);
          break;
        case Layer.SETUP_MEMBER:
          this.memberMenu.setMode(MemberMenu.MODE_RANKING);
      }
      this.addChild(this.rankingMenu);
      this.emit(Layer.Events.HIDE_MENU);
      this.rankingMenu.show();
    }
  }
  onMemberShow() {
    this.memberBrowserMenu.hides.forEach((a) => this.hideFeature(a));
    if (
      this.guestMenu.mode === GuestMenu.MODE_MEMBER ||
      this.memberMenu.mode === MemberMenu.MODE_MEMBER
    )
      this.onMemberCancel();
    else {
      this.memberBrowserMenu.show();
      this.addChild(this.memberBrowserMenu);
      switch (this.setup) {
        case Layer.SETUP_GUEST:
          this.guestMenu.setMode(GuestMenu.MODE_MEMBER);
          break;
        case Layer.SETUP_MEMBER:
          this.memberMenu.setMode(MemberMenu.MODE_MEMBER);
      }
      this.emit(Layer.Events.HIDE_MENU);
    }
  }
  onMemberCancel() {
    this.memberBrowserMenu.parent && this.removeChild(this.memberBrowserMenu);
    this.memberBrowserMenu.hide();
    this.emit(Layer.Events.SHOW_MENU);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
  }
  onClanBrowserShow() {
    this.clanBrowserMenu.hides.forEach((a) => this.hideFeature(a));
    if (
      this.guestMenu.mode === GuestMenu.MODE_CLAN ||
      this.memberMenu.mode === MemberMenu.MODE_CLAN
    )
      this.onClanBrowserCancel();
    else {
      this.emit(Layer.Events.HIDE_MENU);
      switch (this.setup) {
        case Layer.SETUP_GUEST:
          this.guestMenu.setMode(GuestMenu.MODE_CLAN);
          break;
        case Layer.SETUP_MEMBER:
          this.memberMenu.setMode(MemberMenu.MODE_CLAN);
      }
      this.addChild(this.clanBrowserMenu);
      this.clanBrowserMenu.show();
    }
  }
  onClanBrowserCancel() {
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
    this.clanBrowserMenu.parent && this.removeChild(this.clanBrowserMenu);
    this.clanBrowserMenu.hide();
    this.emit(Layer.Events.SHOW_MENU);
  }
  onRankingCancel() {
    this.rankingMenu.parent && this.removeChild(this.rankingMenu);
    this.rankingMenu.hide();
    this.emit(Layer.Events.SHOW_MENU);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
  }
  onLoadingCancel() {
    this.loadingMenu.parent && this.removeChild(this.loadingMenu);
    this.loadingMenu.hide();
  }
  onNewsAccess() {
    this.newsMenu.hides.forEach((a) => this.hideFeature(a));
    if (
      this.guestMenu.mode === GuestMenu.MODE_NEWS ||
      this.memberMenu.mode === MemberMenu.MODE_NEWS
    )
      this.onNewsCancel();
    else {
      switch (this.setup) {
        case Layer.SETUP_GUEST:
          this.guestMenu.setMode(GuestMenu.MODE_NEWS);
          break;
        case Layer.SETUP_MEMBER:
          this.memberMenu.setMode(MemberMenu.MODE_NEWS);
      }
      this.newsMenu.show();
      this.addChild(this.newsMenu);
      this.emit(Layer.Events.HIDE_MENU);
    }
  }
  onNewsCancel() {
    this.newsMenu.parent && this.removeChild(this.newsMenu);
    this.emit(Layer.Events.SHOW_MENU);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
  }
  onPartnerShow() {
    this.partnerMenu.hides.forEach((a) => this.hideFeature(a));
    if (this.guestMenu.mode === GuestMenu.MODE_PARTNER) this.onPartnerCancel();
    else
      this.guestMenu.setMode(GuestMenu.MODE_PARTNER),
        this.partnerMenu.show(),
        this.addChild(this.partnerMenu),
        this.emit(Layer.Events.HIDE_MENU);
  }
  onPartnerCancel() {
    this.partnerMenu.parent && this.removeChild(this.partnerMenu);
    this.emit(Layer.Events.SHOW_MENU);
    this.memberMenu.setMode(MemberMenu.MODE_NONE);
    this.guestMenu.setMode(GuestMenu.MODE_NONE);
  }
  onMenuAccess() {
    this.mainMenuHides.forEach((a) => this.hideFeature(a));
    switch (this.setup) {
      case Layer.SETUP_GUEST:
        this.guestMenu.setMode(GuestMenu.MODE_NONE);
        break;
      case Layer.SETUP_MEMBER:
        this.memberMenu.setMode(MemberMenu.MODE_NONE);
    }
    this.emit(Layer.Events.SHOW_MENU);
  }
  onClanAccess(a) {
    if (
      this.guestMenu.mode === GuestMenu.MODE_RANKING ||
      this.memberMenu.mode === MemberMenu.MODE_RANKING
    )
      this.onRankingCancel();
    else if (
      this.guestMenu.mode === GuestMenu.MODE_MEMBER ||
      this.memberMenu.mode === MemberMenu.MODE_MEMBER
    )
      this.onMemberCancel();
    this.clanMenu.hides.forEach((b) => this.hideFeature(b));
    this.clanMenu.show(a);
    this.addChild(this.clanMenu);
    this.emit(Layer.Events.HIDE_MENU);
  }
  onClanCancel() {
    this.clanMenu.parent && this.removeChild(this.clanMenu);
    this.clanMenu.hide();
    this.emit(Layer.Events.SHOW_MENU);
  }
  onServerCreateResult(a) {
    this.serverCreationMenu.setCreatedStatus(a);
  }
  onServerReject(a) {
    switch (a.mode) {
      case 1:
        this.serverListMenu.setPasswordInvalid();
    }
    this.loadingMenu.parent && this.loadingMenu.setTitle(a.info);
  }
  onServerFull() {
    this.loadingMenu.parent && this.loadingMenu.setTitle("This region is full.");
  }
  onConnectionError() {
    this.loadingMenu.parent && this.loadingMenu.setTitle("Connection failed.");
  }
  async onServerAuthFailed() {
    this.loadingMenu.parent && this.loadingMenu.setTitle("Access denied.");
    await this.updateCredentialsIfExpired(!0);
  }
  onRenameAccess() {
    this.renameMenu.hides.forEach((a) => this.hideFeature(a));
    this.addChild(this.renameMenu);
    this.renameMenu.show();
  }
  async onRenameCompleted() {
    let a = await APIClient.getCredentials(App.Credential.id);
    a.success && this.emit(Layer.Events.UPDATE_CREDENTIAL, a.credential, !0);
  }
  onRenameCancel() {
    this.renameMenu.parent && this.removeChild(this.renameMenu);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onLogoutAccess() {
    this.logoutMenu.hides.forEach((a) => this.hideFeature(a));
    this.addChild(this.logoutMenu);
    this.logoutMenu.show();
  }
  onLogoutCancel() {
    this.logoutMenu.parent && this.removeChild(this.logoutMenu);
    this.emit(Layer.Events.SHOW_MENU);
  }
  onServerDetailAccess(a) {
    this.serverDetailMenu.hides.forEach((b) => this.hideFeature(b));
    this.serverDetailMenu.show(a);
    this.addChild(this.serverDetailMenu);
  }
  onServerDetailCancel() {
    this.serverDetailMenu.parent && this.removeChild(this.serverDetailMenu);
  }
  onRewardsAccess() {
    this.rewardsMenu.hides.forEach((a) => this.hideFeature(a));
    this.rewardsMenu.parent || this.addChild(this.rewardsMenu);
    this.rewardsMenu.show();
  }
  onRewardsCancel() {
    this.rewardsMenu.parent && this.removeChild(this.rewardsMenu);
    this.rewardsMenu.hide();
  }
  onRewardsClaimed(a, b) {
    a && this.emit(Layer.Events.REWARDS_CLAIMED, b);
  }
  onRewardedAdFinished(a) {
    a ? this.rewardsMenu.claimRewards() : this.rewardsMenu.displayWarning();
  }
  onRewardedShopAdFinished(a, b = !1) {
    a
      ? b
        ? this.customizationMenu.claimRewards()
        : this.customizationMenu.displayRewardDialog()
      : this.customizationMenu.displayWarning();
  }
}
Layer.MODE_MENU = "menu";
Layer.MODE_GAME = "game";
Layer.SETUP_GUEST = "guest_setup";
Layer.SETUP_MEMBER = "member_setup";
Layer.Events = {
  DISCONNECT: "disconnect",
  LOGIN_ACCESS: "login_access",
  LOGIN_SUBMIT: "login_submit",
  LOGIN_CANCEL: "login_cancel",
  LOGOUT: "logout",
  RECOVER_ACCESS: "recover_access",
  RECOVER_SUBMIT: "recover_submit",
  RECOVER_CANCEL: "recover_cancel",
  REGISTER_ACCESS: "register_access",
  REGISTER_SUBMIT: "register_submit",
  REGISTER_CANCEL: "register_cancel",
  PROFILE_ACCESS: "profile_access",
  PROFILE_CANCEL: "profile_cancel",
  PROFILE_RENAME: "profile_rename",
  HIDE_MENU: "hide_menu",
  SHOW_MENU: "show_menu",
  UPDATE_CREDENTIAL: "update_credential",
  CUSTOMIZATION_ACCESS: "customization_access",
  CUSTOMIZATION_CANCEL: "customization_cancel",
  USER_ACCESS: "user_access",
  USER_CANCEL: "user_cancel",
  USER_UNFRIEND: "user_unfriend",
  RANKING_ACCESS: "ranking_access",
  RANKING_CANCEL: "ranking_cancel",
  MEMBER_ACCESS: "member_access",
  MEMBER_CANCEL: "member_cancel",
  NEWS_ACCESS: "news_access",
  NEWS_CANCEL: "news_cancel",
  PARTNER_ACCESS: "partner_access",
  PARTNER_CANCEL: "partner_cancel",
  LEAVE_CLAN: "leave_clan",
  CREATE_CLAN: "create_clan",
  JOIN_CLAN: "join_clan",
  JOIN_GAME: "join_game",
  JOIN_GAME_FAIL: "join_game_fail",
  JOIN_SERVER: "join_server",
  CREATE_SERVER: "create_server",
  SERVER_LIST_REFRESH: "server_list_refresh",
  SERVER_LIST_CANCEL: "server_list_cancel",
  SERVER_CREATION_CANCEL: "server_creation_cancel",
  SERVER_CREATION_INIT: "server_creation_init",
  SERVER_CREATION_REGION: "server_creation_region",
  SERVER_CREATION_JOIN_LOBBY: "server_creation_join_lobby",
  SERVER_CREATION_SESSION_INIT: "server_creation_session_init",
  SERVER_CREATED: "server_created",
  CLAN_CHAT_ACCESS: "clan_chat_access",
  CLAN_CHAT_CANCEL: "clan_chat_cancel",
  LOADING_CANCEL: "loading_cancel",
  CLAN_BROWSER_ACCESS: "clan_browser_access",
  CLAN_BROWSER_CANCEL: "clan_browser_cancel",
  CLAN_ACCESS: "clan_access",
  CLAN_CANCEL: "clan_cancel",
  RENAME_ACCESS: "rename_access",
  RENAME_SUBMIT: "rename_submit",
  RENAME_CANCEL: "rename_cancel",
  RENAME_COMPLETED: "rename_completed",
  LOGOUT_CANCEL: "logout_cancel",
  LOGOUT_ACCESS: "logout_access",
  JOYSTICK_MOVE_STATE: "joystick_move_state",
  JOYSTICK_TARGET_STATE: "joystick_target_state",
  DISPLAY_HELP: "display_help",
  MUTE_TOGGLE: "mute_toggle",
  SERVER_DETAIL_ACCESS: "server_detail_access",
  SERVER_DETAIL_CANCEL: "server_detail_cancel",
  MENU_ACCESS: "menu_access",
  GUEST_PROFILE_ACCESS: "guest_profile_access",
  GUEST_PROFILE_HIDE: "guest_profile_hide",
  SETTINGS_ACCESS: "settings_access",
  SETTINGS_HIDE: "settings_hide",
  ESCAPE_MENU_ACCESS: "escape_menu_access",
  REWARDS_ACCESS: "rewards_access",
  REWARDS_CLAIMED: "rewards_claimed",
  REWARDS_CANCEL: "rewards_cancel",
};
var assetloader = {};
class AssetLoader {
  constructor(a, b, c) {
    this.loader = new PIXI.Loader();
    this.loader.onComplete.add(this.onAssetsLoaded.bind(this));
    this.folder = c;
    this.onProgress = this.onComplete = null;
    this.target = a;
    this.queue = [];
    this.initialQueueLength = 0;
    this.source = null;
    this.table = b;
  }
  load(a) {
    this.source = a;
    for (var b in a) a[b] instanceof Array && 0 < a[b].length && this.queue.push(b);
    this.initialQueueLength = this.queue.length;
    b = this.queue[this.queue.length - 1];
    this.importAssets(b, this.folder + "/" + b);
  }
  onAssetsLoaded(a) {
    for (var b in a.resources) this.table[b] = a.resources[b];
    this.target[this.queue[this.queue.length - 1]] = a.resources;
    this.queue.pop();
    if (0 < this.queue.length) {
      if (
        ((b = this.queue[this.queue.length - 1]),
        this.importAssets(b, this.folder + "/" + b),
        this.onProgress)
      )
        this.onProgress({
          progress: (1 / this.initialQueueLength) * (this.initialQueueLength - this.queue.length),
        });
    } else this.onComplete && (this.onProgress({ progress: 1 }), this.onComplete());
  }
  importAssets(a, b) {
    this.loader.reset();
    a = this.source[a];
    for (var c = 0, d = a.length; c < d; c++) this.loader.add(a[c].id, b + "/" + a[c].file);
    this.loader.load();
  }
}
AssetLoader.COMPLETE = "assetLoaderComplete";
var protocol = {};
Protocol = {
  CONNECT: "connection",
  CONNECTED: "onconnected",
  DISCONNECT: "disconnect",
  DISCONNECTED: "ondisconnected",
  ECHO: "a",
  ECHO_RESP: "b",
  INFO: "c",
  SESSION: "d",
  Session: {
    REGISTER: "e",
    CREATE: "f",
    CREATE_RESP: "g",
    JOIN_MODE: "h",
    JOIN_RESP: "i",
    JOIN_GAME: "j",
    LEAVE: "k",
    LEAVE_RESP: "l",
    LIST_GAMES: "m",
    LIST_GAMES_RESP: "n",
    CLIENT_AUTH: "o1",
  },
  GAME: "p",
  GAME_BIN: "q",
  Game: {
    UPDATE: "r",
    REQ: "t",
    INPUT: "v",
    INFO: "w",
    MESSAGE: "x",
    COMMAND: "y",
    ACTION: "z",
    STATUS: "aa",
    TRIGGER_RESPAWN: "ab",
  },
  SIGNAL_FULL: "ad",
};
var thumbnail = {};
class Thumbnail extends PIXI.Sprite {
  constructor(a, b, c = !0, d = !1) {
    super();
    this.interactive = c;
    this.displayAura = d;
    this.w = a;
    this.h = b;
    this.s = 0.004 * this.w;
    this.numParticles = 64;
    this.customization = {};
    this.offsetY = this.offsetX = this.time = 0;
    this.head = new PIXI.Sprite();
    this.head.x = -2;
    this.head.y = 0.179 * -this.h;
    this.head.scale.x = this.head.scale.y = this.s;
    this.head.anchor.x = 0.5;
    this.head.anchor.y = 0.75;
    this.head.rotation = -0.15;
    this.face = new PIXI.Sprite();
    this.face.rotation = -0;
    this.torsoUpper = new PIXI.Sprite();
    this.torsoUpper.scale.x = this.torsoUpper.scale.y = 1.2 * this.s;
    this.torsoUpper.x = 0;
    this.torsoUpper.y = 0.105 * -this.h;
    this.torsoUpper.anchor.x = 0.5;
    this.torsoUpper.anchor.y = 0.4;
    this.torsoUpper.rotation = -0.1;
    this.torsoLower = new PIXI.Sprite();
    this.torsoLower.x = 2;
    this.torsoLower.y = 0.03 * -this.h;
    this.torsoLower.scale.x = this.torsoLower.scale.y = 1 * this.s;
    this.torsoLower.anchor.x = 0.5;
    this.torsoLower.anchor.y = 0.4;
    this.torsoLower.rotation = -0.1;
    this.armLeftUpper = new PIXI.Sprite();
    this.armLeftUpper.x = -12;
    this.armLeftUpper.y = 0.14 * -this.h;
    this.armLeftUpper.scale.x = this.armLeftUpper.scale.y = 1 * this.s;
    this.armLeftUpper.anchor.x = 0.6;
    this.armLeftUpper.anchor.y = 0.23;
    this.armLeftUpper.rotation = -0.05;
    this.armLeftLower = new PIXI.Sprite();
    this.armLeftLower.x = -17;
    this.armLeftLower.y = 0.02 * this.h;
    this.armLeftLower.scale.x = this.armLeftLower.scale.y = 0.95 * this.s;
    this.armLeftLower.anchor.x = 0.6;
    this.armLeftLower.anchor.y = 0.23;
    this.armLeftLower.rotation = 0.55 * Math.PI;
    this.armRightUpper = new PIXI.Sprite();
    this.armRightUpper.x = 15;
    this.armRightUpper.y = 0.17 * -this.h;
    this.armRightUpper.scale.x = this.armRightUpper.scale.y = 1 * this.s;
    this.armRightUpper.anchor.x = 0.55;
    this.armRightUpper.anchor.y = 0.23;
    this.armRightUpper.rotation = -0.3;
    this.armRightLower = new PIXI.Sprite();
    this.armRightLower.x = 22;
    this.armRightLower.y = 0.02 * -this.h;
    this.armRightLower.scale.x = 0.95 * -this.s;
    this.armRightLower.scale.y = 0.95 * this.s;
    this.armRightLower.anchor.x = 0.66;
    this.armRightLower.anchor.y = 0.23;
    this.armRightLower.rotation = 0.26 * Math.PI;
    this.legLeftUpper = new PIXI.Sprite();
    this.legLeftUpper.x = -1;
    this.legLeftUpper.y = 0.085 * this.h;
    this.legLeftUpper.scale.x = this.legLeftUpper.scale.y = 1 * this.s;
    this.legLeftUpper.anchor.x = 0.55;
    this.legLeftUpper.anchor.y = 0.31;
    this.legLeftUpper.rotation = 0.23 * Math.PI;
    this.legLeftLower = new PIXI.Sprite();
    this.legLeftLower.x = 10;
    this.legLeftLower.y = 0.25 * this.h;
    this.legLeftLower.scale.x = this.legLeftLower.scale.y = 1 * this.s;
    this.legLeftLower.anchor.x = 0.58;
    this.legLeftLower.anchor.y = 0.36;
    this.legLeftLower.rotation = 0.3 * -Math.PI;
    this.legRightUpper = new PIXI.Sprite();
    this.legRightUpper.x = 9;
    this.legRightUpper.y = 0.07 * this.h;
    this.legRightUpper.scale.x = this.legRightUpper.scale.y = 1 * this.s;
    this.legRightUpper.anchor.x = 0.55;
    this.legRightUpper.anchor.y = 0.3;
    this.legRightUpper.rotation = 0.01 * Math.PI;
    this.legRightLower = new PIXI.Sprite();
    this.legRightLower.x = -19;
    this.legRightLower.y = 0.21 * this.h;
    this.legRightLower.scale.x = this.legRightLower.scale.y = 1 * this.s;
    this.legRightLower.anchor.x = 0.58;
    this.legRightLower.anchor.y = 0.36;
    this.legRightLower.rotation = 0.22 * -Math.PI;
    this.bandana = new PIXI.Sprite(App.CombinedTextures.bandana_team_alpha);
    this.bandana.x = this.head.x + 13;
    this.bandana.y = this.head.y - 16;
    this.bandana.rotation = 0.32 * Math.PI;
    this.bandana.scale.x = 0.9 * this.s;
    this.bandana.scale.y = 0.5 * this.s;
    this.bandana.anchor.x = 0;
    this.bandana.anchor.y = 0.5;
    this.bandana.tint = 12255232;
    this.ninja = new PIXI.Container();
    this.ninja.x = 0.5 * this.w;
    this.ninja.y = 0.5 * this.h;
    this.aura = new PIXI.Sprite();
    this.aura.x = 0;
    this.aura.y = 0;
    this.aura.scale.x = this.aura.scale.y = 1.4;
    this.aura.anchor.x = this.aura.anchor.y = 0.5;
    this.aura.visible = this.displayAura;
    this.aura.rotation = Math.PI;
    this.on("mouseover", () => {
      this.aura.visible = !0;
    });
    this.on("mouseout", () => {
      this.aura.visible = !1;
    });
    this.ninja.addChild(this.aura);
    this.ninja.addChild(this.bandana);
    this.ninja.addChild(this.legRightLower);
    this.ninja.addChild(this.legLeftUpper);
    this.ninja.addChild(this.legLeftLower);
    this.ninja.addChild(this.legRightUpper);
    this.ninja.addChild(this.armLeftUpper);
    this.ninja.addChild(this.armLeftLower);
    this.ninja.addChild(this.torsoLower);
    this.ninja.addChild(this.torsoUpper);
    this.ninja.addChild(this.armRightLower);
    this.ninja.addChild(this.armRightUpper);
    this.ninja.addChild(this.head);
    this.head.addChild(this.face);
    this.bodyparts = [
      this.head,
      this.armLeftUpper,
      this.armLeftLower,
      this.torsoLower,
      this.torsoUpper,
      this.armRightUpper,
      this.armRightLower,
      this.legLeftUpper,
      this.legLeftLower,
      this.legRightUpper,
      this.legRightLower,
      this.bandana,
    ];
    this.addChild(this.ninja);
  }
  generateCharacter() {
    const a = App.CombinedTextures;
    var b = this.customization;
    this.aura.tint = void 0 === b.orb ? 16777215 : b.orb.data.energy;
    this.face.rotation = 0;
    this.face.vr = 0;
    let c = "head_alpha";
    if (b.hair) {
      var d = !1;
      b.face && b.face.cdata && !1 === b.face.cdata.hair && (d = !0);
      d ? (c += "_slick") : 0 < b.hair.texture.length && (c += "_" + b.hair.texture);
    }
    var e = "torsoupper";
    b.torso && 0 < b.torso.texture.length && (e += "_" + b.torso.texture);
    d = "energy_shell";
    this.aura.alpha = 1;
    b.orb &&
      (b.orb.cdata && b.orb.cdata.custom
        ? ((this.aura.visible = !1), (this.aura.alpha = 0))
        : 0 < b.orb.texture.length && (d += "_" + b.orb.texture));
    var f = "torsolower";
    this.torsoLower.x = 2;
    this.torsoLower.y = 0.03 * -this.h;
    this.torsoLower.anchor.x = 0.5;
    this.torsoLower.anchor.y = 0.4;
    if (b.belt && 0 < b.belt.texture.length) {
      f += "_" + b.belt.texture;
      var g = b.belt.cdata;
      void 0 !== g &&
        (void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.torsoLower.anchor.x = g.ax), (this.torsoLower.anchor.y = g.ay)),
        void 0 !== g.ox &&
          void 0 !== g.ox &&
          ((this.torsoLower.x = g.ox), (this.torsoLower.y = g.oy)),
        void 0 !== g.s && (this.torsoLower.scale.x = this.torsoLower.scale.y = this.s * g.s));
    }
    var h = "armleftlower";
    this.armLeftLower.x = -17;
    this.armLeftLower.y = 0.02 * this.h;
    this.armLeftLower.anchor.x = 0.6;
    this.armLeftLower.anchor.y = 0.23;
    b.armleftlower &&
      0 < b.armleftlower.texture.length &&
      ((h += "_" + b.armleftlower.texture),
      (g = b.armleftlower.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armLeftLower.x = g.ox), (this.armLeftLower.y = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armLeftLower.anchor.x = g.ax), (this.armLeftLower.anchor.y = g.ay))));
    var k = "armleftupper";
    this.armLeftUpper.x = -13;
    this.armLeftUpper.y = 0.14 * -this.h;
    this.armLeftUpper.anchor.x = 0.55;
    this.armLeftUpper.anchor.y = 0.23;
    b.armleftupper &&
      0 < b.armleftupper.texture.length &&
      ((k += "_" + b.armleftupper.texture),
      (g = b.armleftupper.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armLeftUpper.x = g.ox), (this.armLeftUpper.y = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armLeftUpper.anchor.x = g.ax), (this.armLeftUpper.anchor.y = g.ay))));
    var m = "armrightupper";
    this.armRightUpper.x = 15;
    this.armRightUpper.y = 0.17 * -this.h;
    this.armRightUpper.anchor.x = 0.55;
    this.armRightUpper.anchor.y = 0.23;
    b.armrightupper &&
      0 < b.armrightupper.texture.length &&
      ((m += "_" + b.armrightupper.texture),
      (g = b.armrightupper.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armRightUpper.x = g.ox), (this.armRightUpper.y = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armRightUpper.anchor.x = g.ax), (this.armRightUpper.anchor.y = g.ay))));
    var l = "armrightlower";
    this.armRightLower.x = 22;
    this.armRightLower.y = 0.02 * -this.h;
    this.armRightLower.anchor.x = 0.66;
    this.armRightLower.anchor.y = 0.23;
    b.armrightlower &&
      0 < b.armrightlower.texture.length &&
      ((l += "_" + b.armrightlower.texture),
      (g = b.armrightlower.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.armRightLower.x = g.ox), (this.armRightLower.y = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.armRightLower.anchor.x = g.ax), (this.armRightLower.anchor.y = g.ay))));
    var p = "legleftlower";
    this.legLeftLower.x = 10;
    this.legLeftLower.y = 0.25 * this.h;
    this.legLeftLower.anchor.x = 0.58;
    this.legLeftLower.anchor.y = 0.36;
    b.legleftlower &&
      (0 < b.legleftlower.texture.length && (p += "_" + b.legleftlower.texture),
      (g = b.legleftlower.cdata),
      void 0 !== g &&
        (void 0 !== g.ox &&
          void 0 !== g.oy &&
          ((this.legLeftLower.x = g.ox), (this.legLeftLower.y = g.oy)),
        void 0 !== g.ax &&
          void 0 !== g.ay &&
          ((this.legLeftLower.anchor.x = g.ax), (this.legLeftLower.anchor.y = g.ay))));
    g = "legrightlower";
    this.legRightLower.x = -19;
    this.legRightLower.y = 0.21 * this.h;
    this.legRightLower.anchor.x = 0.58;
    this.legRightLower.anchor.y = 0.36;
    if (b.legrightlower) {
      0 < b.legrightlower.texture.length && (g += "_" + b.legrightlower.texture);
      var n = b.legrightlower.cdata;
      void 0 !== n &&
        (void 0 !== n.ox &&
          void 0 !== n.oy &&
          ((this.legRightLower.x = n.ox), (this.legRightLower.y = n.oy)),
        void 0 !== n.ax &&
          void 0 !== n.ay &&
          ((this.legRightLower.anchor.x = n.ax), (this.legRightLower.anchor.y = n.ay)));
    }
    let r = "legleftupper";
    this.legLeftUpper.x = -1;
    this.legLeftUpper.y = 0.085 * this.h;
    this.legLeftUpper.anchor.x = 0.55;
    this.legLeftUpper.anchor.y = 0.31;
    b.legleftupper &&
      (0 < b.legleftupper.texture.length && (r += "_" + b.legleftupper.texture),
      (n = b.legleftupper.cdata),
      void 0 !== n &&
        (void 0 !== n.ox &&
          void 0 !== n.oy &&
          ((this.legLeftUpper.x = n.ox), (this.legLeftUpper.y = n.oy)),
        void 0 !== n.ax &&
          void 0 !== n.ay &&
          ((this.legLeftUpper.anchor.x = n.ax), (this.legLeftUpper.anchor.y = n.ay))));
    n = "legrightupper";
    this.legRightUpper.x = 9;
    this.legRightUpper.y = 0.07 * this.h;
    this.legRightUpper.anchor.x = 0.55;
    this.legRightUpper.anchor.y = 0.3;
    if (b.legrightupper) {
      0 < b.legrightupper.texture.length && (n += "_" + b.legrightupper.texture);
      let q = b.legrightupper.cdata;
      void 0 !== q &&
        (void 0 !== q.ox &&
          void 0 !== q.oy &&
          ((this.legRightUpper.x = q.ox), (this.legRightUpper.y = q.oy)),
        void 0 !== q.ax &&
          void 0 !== q.ay &&
          ((this.legRightUpper.anchor.x = q.ax), (this.legRightUpper.anchor.y = q.ay)));
    }
    b.face
      ? (this.face.removeChildren(),
        (this.face.tint = 16777215),
        b.face.cdata && b.face.cdata.custom && this.initializeCustomFaceFx(b.face.cdata.custom),
        0 < b.face.texture.length
          ? ((this.face.texture = a["face_" + b.face.texture]),
            (this.face.visible = !0),
            (b = b.face.cdata),
            void 0 !== b &&
              (void 0 !== b.ax && void 0 !== b.ay
                ? ((this.face.anchor.x = b.ax), (this.face.anchor.y = b.ay))
                : ((this.face.anchor.x = 0), (this.face.anchor.y = 0)),
              void 0 !== b.ox && void 0 !== b.ox
                ? ((this.face.x = b.ox), (this.face.y = b.oy))
                : ((this.face.x = 0), (this.face.y = 0)),
              b.vr && (this.face.vr = 0),
              void 0 !== b.s && (this.face.scale.x = this.face.scale.y = this.s * b.s * 0.95)))
          : (this.face.visible = !1))
      : (this.face.visible = !1);
    b = a[e];
    f = a[f];
    e = a[k];
    h = a[h];
    m = a[m];
    l = a[l];
    k = a[r];
    p = a[p];
    n = a[n];
    g = a[g];
    d = a[d];
    this.head.texture = a[c];
    this.torsoUpper.texture = b;
    this.torsoLower.texture = f;
    this.armLeftUpper.texture = e;
    this.armLeftLower.texture = h;
    this.armRightUpper.texture = m;
    this.armRightLower.texture = l;
    this.legLeftUpper.texture = k;
    this.legLeftLower.texture = p;
    this.legRightUpper.texture = n;
    this.legRightLower.texture = g;
    this.aura.texture = d;
  }
  initializeCustomFaceFx(a) {
    let b = new PIXI.Sprite(App.CombinedTextures[ParticleEffects.FireEyes.tex]);
    b.scale.x = b.scale.y = 0.5;
    b.x = -30;
    b.y = -33;
    switch (a) {
      case FaceRedFireEyes.ID:
        this.face.tint = 16711680;
        this.face.addChild(b);
        break;
      case FaceFireEyes.ID:
        this.face.tint = 16777215;
        this.face.addChild(b);
        break;
      case FacePinkFireEyes.ID:
        this.face.tint = 16738740;
        this.face.addChild(b);
        break;
      case FaceGreenFireEyes.ID:
        this.face.tint = 65280;
        this.face.addChild(b);
        break;
      case FaceBlueFireEyes.ID:
        this.face.tint = 255;
        this.face.addChild(b);
        break;
      case FaceYellowFireEyes.ID:
        this.face.tintt = 16776960;
        this.face.addChild(b);
        break;
      case FaceOrangeFireEyes.ID:
        (this.face.tint = 16753920), this.face.addChild(b);
    }
  }
  applyCustomization(a) {
    this.customization = {};
    a && (this.customization = a);
    this.generateCharacter();
  }
}
class App extends PIXI.Container {
  constructor() {
    super();
    this.credential = {};
    this.servers = [];
    this.status = {};
    this.stage = this.pixi = null;
    this.settings = {};
    this.gameplayStopped = !0;
    this.threadUpdate = this.resizeOnLoad = this.matchStarted = !1;
    this.client = new Client();
    this.client.addListener(Protocol.INFO, (a) => this.onInfo(a.data));
    this.client.addListener(Protocol.DISCONNECT, (a) => this.onDisconnect());
    this.client.addListener(Protocol.SESSION, (a) => this.onSessionData(a.data));
    this.client.addListener(Client.CONNECT, (a) => this.onConnect(a));
    this.client.addListener(Client.AUTH_FAILED, (a) => this.onRegisterFailed(a));
    this.client.addListener(Client.SERVER_FULL, (a) => this.onServerFull(a));
    this.client.addListener(Client.CONNECTION_ERROR, (a) => this.onConnectionError(a));
    this.client.onCloseForImmediateReconnect =
      this.onClientDisconnectForImmediateReconnect.bind(this);
    App.Client = this.client;
    this.authenticated = !1;
    this.user = new User();
    this.game = null;
    this.matchStarted = !1;
    this.background =
      this.adLoaderBackground =
      this.onConnectRetryMode =
      this.gameOutputListener =
      this.gameBinInputListener =
      this.gameInputListener =
        null;
    this.onMouseDownListener = (a) => this.onMouseDown(a);
    this.inCommercialBreak = !1;
    this.startTime = Date.now();
    this.autoJoinGame = null;
    this.autoJoinOnCreate = !1;
    this.checkInterval = null;
    this.lastUpdateTime = Date.now();
    this.hasLoaded = !1;
    this.redrawTimeout = this.adFaderInterval = this.adLoaderTimeout = null;
    this.stepCallback = (a) => this.onStep(a);
    this.lastServerReload = Date.now();
    this.lastBannerReload = Date.now();
    this.adElement = document.getElementById("adwrapper");
    document.addEventListener("visibilitychange", () => this.setFocus(document.hidden ? !1 : !0));
  }
  async load() {
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.CrazySDK.init();
        App.CrazySDK.addEventListener("adStarted", () => this.adStarted());
        App.CrazySDK.addEventListener("adError", () => this.adError());
        App.CrazySDK.addEventListener("adFinished", () => this.adFinished());
        App.CrazySDK.addEventListener("bannerRendered", (a) => {
          console.log(`Banner for container ${a.containerId} has been rendered!`);
        });
        App.CrazySDK.addEventListener("bannerError", (a) => {
          console.log(`Banner render error: ${a.error}`);
        });
        App.CrazySDK.addEventListener("adblockDetectionExecuted", (a) => {
          App.AdblockDetected = a.hasAdblock ? !0 : !1;
        });
        this.proceed();
        break;
      case App.WhiteLabel_POKI:
      case App.WhiteLabel_POKI_MAIN:
        App.PokiSDK &&
          App.PokiSDK.init()
            .then(() => {
              console.log("Poki SDK successfully initialized");
              App.AdblockDetected = !1;
              App.PokiSDK.gameLoadingStart();
              this.proceed();
            })
            .catch(() => {
              console.log("Initialized, but the user likely has adblock");
              App.AdblockDetected = !0;
              App.PokiSDK.gameLoadingStart();
              this.proceed();
            });
        PokiSDK.setDebug(!1);
        break;
      default:
        this.proceed();
    }
  }
  async proceed() {
    App.UpdatePreloader(0.2);
    var a = Registry.Instance.retrieve(Registry.Key.CREDENTIAL);
    const b = Registry.Instance.retrieve(Registry.Key.MASTER);
    App.FirstRun = b.firstRun;
    App.FirstRun
      ? ((this.credential = await APIClient.postAutoRegistration()),
        this.credential.credentials &&
          (Registry.Instance.store(Registry.Key.AUTOGEN, {
            name: this.credential.name,
            password: btoa(this.credential.password),
          }),
          (this.credential = this.credential.credentials)),
        Registry.Instance.store(Registry.Key.CREDENTIAL, this.credential),
        (Registry.Instance.credential = this.credential))
      : (this.credential =
          void 0 === a.accounttype ||
          !1 === a.available ||
          null === a.playerid ||
          null === a.id ||
          void 0 === a.level
            ? await this.fetchGuestCredential()
            : a);
    (a = Registry.Instance.retrieve(Registry.Key.AUTOGEN)) && !0 !== a.error && (App.Autogen = !0);
    App.Credential = this.credential;
    App.UpdatePreloader(0.3);
    this.settings = Registry.Instance[Registry.Key.SETTINGS];
    this.settings.sound.enabled || Howler.mute(!0);
    a = {
      backgroundColor: 0,
      antialias: this.settings.graphics.aa,
      transparent: !1,
      resolution: App.DevicePixelRatio,
      autoDensity: !0,
      width: App.ClientWidth,
      height: App.ClientHeight,
    };
    PIXI.settings.WRAP_MODE = PIXI.WRAP_MODES.REPEAT;
    PIXI.Mesh.BATCHABLE_SIZE = 65536;
    PIXI.GraphicsGeometry.BATCHABLE_SIZE = 65536;
    this.pixi = new PIXI.Application(a);
    App.Renderer = this.pixi.renderer;
    App.Renderer.plugins.interaction.useSystemTicker = !1;
    App.Renderer.view.oncontextmenu = (c) => c.preventDefault();
    this.view = this.pixi.view;
    this.view.style.display = "block";
    this.view.id = "view";
    App.Stage = this.stage = this.pixi.stage;
    document.body.appendChild(this.view);
    window.onresize = () => this.onResize();
    App.UpdatePreloader(0.4);
    this.interpreter = new Interpreter(this);
    this.interpreter.addCommand(App.CMD_CONNECT, this.onCmdConnect);
    this.interpreter.addCommand(App.CMD_DISCONNECT, this.onCmdDisconnect);
    this.interpreter.addCommand(App.CMD_UNLINK, this.onCmdUnlink);
    this.interpreter.on(Interpreter.INVALID_COMMAND, (c) => this.onCmdInvalid(c));
    a = new AssetLoader(App.AssetTree, App.Assets, App.RESOURCE_FOLDER);
    a.onProgress = (c) => {
      App.UpdatePreloader(0.4 + 0.6 * c.progress);
    };
    a.onComplete = () => this.start();
    a.load(App.RESOURCES);
  }
  async fetchGuestCredential(a) {
    return await APIClient.getGuestCredentials(
      void 0 !== a && null !== a ? a : "Ninja" + Math.floor(1e3 * Math.random())
    );
  }
  async start() {
    switch (App.WhiteLabel) {
      case App.WhiteLabel_POKI:
      case App.WhiteLabel_POKI_MAIN:
        App.PokiSDK && App.PokiSDK.gameLoadingFinished();
    }
    App.RemovePreloader();
    App.CombinedTextures = App.Assets.combined.textures;
    App.GenerateTexturesFromSheet(App.Assets.seamless.textures);
    App.Console = new CommandConsole();
    App.Console.ignoreInput = !0;
    App.Console.linkInterpreter(this.interpreter);
    App.Layer = new Layer();
    App.Layer.on(Layer.Events.DISCONNECT, this.onLayerDisconnect.bind(this));
    App.Layer.on(Layer.Events.HIDE_MENU, this.onLayerHideMenu.bind(this));
    App.Layer.on(Layer.Events.SHOW_MENU, this.onLayerShowMenu.bind(this));
    App.Layer.on(Layer.Events.UPDATE_CREDENTIAL, this.onLayerUpdateCredential.bind(this));
    App.Layer.on(Layer.Events.JOIN_GAME, this.onLayerJoinGame.bind(this));
    App.Layer.on(Layer.Events.JOIN_SERVER, this.onLayerJoinServer.bind(this));
    App.Layer.on(Layer.Events.CREATE_SERVER, this.onLayerCreateServer.bind(this));
    App.Layer.on(Layer.Events.RENAME_COMPLETED, this.onLayerRenameCompleted.bind(this));
    App.Layer.on(Layer.Events.JOYSTICK_MOVE_STATE, this.onJoystickMoveState.bind(this));
    App.Layer.on(Layer.Events.JOYSTICK_TARGET_STATE, this.onJoystickTargetState.bind(this));
    App.Layer.on(Layer.Events.DISPLAY_HELP, this.onLayerDisplayHelp.bind(this));
    App.Layer.on(Layer.Events.MUTE_TOGGLE, this.onLayerMute.bind(this));
    App.Layer.on(Layer.Events.SETTINGS_ACCESS, this.onLayerShowSettings.bind(this));
    App.Layer.on(Layer.Events.SETTINGS_HIDE, this.onLayerHideSettings.bind(this));
    App.Layer.on(Layer.Events.ESCAPE_MENU_ACCESS, this.onEscapeMenuAccess.bind(this));
    App.Layer.on(Layer.Events.REWARDS_CLAIMED, this.onRewardsClaimed.bind(this));
    App.Layer.resize(App.ClientWidth, App.ClientHeight);
    await App.Layer.setMode(Layer.MODE_MENU);
    App.Stats = new Stats();
    App.Stats.x = App.ClientWidth - 12;
    App.Stats.y = 12;
    this.cursor = new PIXI.Sprite(App.CombinedTextures.mouse_pointer);
    this.adLoaderBackground = new PIXI.Graphics();
    this.adLoaderBackground.beginFill(0, 1);
    this.adLoaderBackground.drawRect(0, 0, 10, 10);
    this.adLoaderBackground.endFill();
    this.adLoaderBackground.width = App.ClientWidth;
    this.adLoaderBackground.height = App.ClientHeight;
    this.adLoaderBackground.interactive = !0;
    this.adLoaderBackground.on("mousemove", (b) => {
      this.cursor.x = b.data.global.x;
      this.cursor.y = b.data.global.y;
    });
    this.continueButton = new Button("adbtn");
    this.continueButton.setText("- Click here to continue -");
    this.continueButton.addListener(Button.BUTTON_RELEASED, this.onTriggerVideoAd.bind(this));
    this.continueButton.setTint(16763904);
    this.continueButton.scale.x = this.continueButton.scale.y = 1.1;
    this.gradient = new Gradient(App.ClientWidth, App.ClientHeight);
    this.gradient.sc = 1;
    this.gradient.minY = -1e3;
    this.gradient.maxY = 0;
    this.gradient.colors("#0D0D0D", "#22252f");
    this.gradient.offset(0);
    this.gradient.interactive = !0;
    this.gradient.on("touchstart", () => {
      this.cursor.visible = !1;
    });
    this.gradient.on("mousemove", (b) => {
      this.cursor.x = b.data.global.x;
      this.cursor.y = b.data.global.y;
    });
    this.sky = new PIXI.Graphics();
    this.sky.pivot.x = 0.5;
    this.sky.beginFill(16777215, 1);
    for (var a = 0; 300 > a; a++)
      this.sky.drawCircle(
        Math.random() * App.ClientWidth,
        Math.random() * App.ClientHeight * 0.75,
        0.5 + 0.5 * Math.random()
      );
    this.sky.endFill();
    this.background = new Background(6, 5, 600, 150, 50, 50);
    this.background.draw("generic", 5263964);
    this.background.x = 0;
    this.background.y = -200;
    this.gradient.on("mousemove", (b) => {
      1 > this.scale.x
        ? ((this.background.x =
            700 + 0.02 * (-b.data.global.x - 0.5 * App.ClientWidth) + -400 * (1 - this.scale.x)),
          (this.background.y = -100 + 0.02 * -b.data.global.y),
          (this.sky.x = 0.01 * -b.data.global.x + -400 * (1 - this.scale.x)))
        : ((this.background.x = 700 + 0.02 * (-b.data.global.x - 0.5 * App.ClientWidth)),
          (this.background.y = -100 + 0.02 * -b.data.global.y),
          (this.sky.x = 0.01 * -b.data.global.x));
      this.sky.y = 0.01 * -b.data.global.y;
    });
    App.WhiteLabel === App.WhiteLabel_POKI_MAIN &&
      ((this.pokiLogo = new PIXI.Sprite(App.CombinedTextures["poki-badge"])),
      (this.pokiLogo.scale.x = this.pokiLogo.scale.y = 1),
      (this.pokiLogo.anchor.x = 1),
      (this.pokiLogo.anchor.y = 1),
      (this.pokiLogo.interactive = !0),
      this.pokiLogo.on("touchstart", () => window.open("https://poki.com/en/g/ninja-io", "_blank")),
      this.pokiLogo.on("mousedown", () => window.open("https://poki.com/en/g/ninja-io", "_blank")),
      this.pokiLogo.on("mouseover", () => (this.pokiLogo.scale.x = this.pokiLogo.scale.y = 1.05)),
      this.pokiLogo.on("mouseout", () => (this.pokiLogo.scale.x = this.pokiLogo.scale.y = 1)));
    this.youtubeLogo = new PIXI.Sprite(App.CombinedTextures.youtube_logo);
    this.youtubeLogo.scale.x = this.youtubeLogo.scale.y = 0.45;
    this.youtubeLogo.interactive = !0;
    this.youtubeLogo.on("mouseover", () => {
      this.youtubeLogo.scale.x = this.youtubeLogo.scale.y = 0.5;
      AudioEffects.ButtonHover.audio.play();
    });
    this.youtubeLogo.on(
      "mouseout",
      () => (this.youtubeLogo.scale.x = this.youtubeLogo.scale.y = 0.45)
    );
    this.youtubeLogo.on("mousedown", () =>
      window.open("https://www.youtube.com/channel/UCET8PfVdLECAMYwDYIUY3rA", "_blank")
    );
    this.youtubeLogo.on("touchstart", () =>
      window.open("https://www.youtube.com/channel/UCET8PfVdLECAMYwDYIUY3rA", "_blank")
    );
    this.twitterLogo = new PIXI.Sprite(App.CombinedTextures.twitter_logo);
    this.twitterLogo.scale.x = this.twitterLogo.scale.y = 0.4;
    this.twitterLogo.interactive = !0;
    this.twitterLogo.on("mouseover", () => {
      this.twitterLogo.scale.x = this.twitterLogo.scale.y = 0.45;
      AudioEffects.ButtonHover.audio.play();
    });
    this.twitterLogo.on(
      "mouseout",
      () => (this.twitterLogo.scale.x = this.twitterLogo.scale.y = 0.4)
    );
    this.twitterLogo.on("mousedown", () =>
      window.open("https://twitter.com/ninjaio_game", "_blank")
    );
    this.twitterLogo.on("touchstart", () =>
      window.open("https://twitter.com/ninjaio_game", "_blank")
    );
    this.redditLogo = new PIXI.Sprite(App.CombinedTextures.reddit_logo);
    this.redditLogo.scale.x = this.redditLogo.scale.y = 0.4;
    this.redditLogo.interactive = !0;
    this.redditLogo.on("mouseover", () => {
      this.redditLogo.scale.x = this.redditLogo.scale.y = 0.45;
      AudioEffects.ButtonHover.audio.play();
    });
    this.redditLogo.on("mouseout", () => (this.redditLogo.scale.x = this.redditLogo.scale.y = 0.4));
    this.redditLogo.on("mousedown", () =>
      window.open("https://www.reddit.com/r/ninjaio", "_blank")
    );
    this.redditLogo.on("touchstart", () =>
      window.open("https://www.reddit.com/r/ninjaio", "_blank")
    );
    App.SelectedMode = Registry.GetLocalStorageItem(App.ModePreference);
    "string" !== App.SelectedMode &&
      ((a = Math.random()),
      (App.SelectedMode =
        0.3 > a ? Game.MODE_TDM : 0.3 <= a && 0.6 > a ? Game.MODE_CTF : Game.MODE_DM));
    this.showMenu();
    this.cursor.x = 0.5 * App.ClientWidth;
    this.cursor.y = 0.5 * App.ClientHeight;
    this.cursor.anchor.x = 0;
    this.cursor.anchor.y = 0;
    this.cursor.scale.x = this.cursor.scale.y = 0.25;
    App.IsMobile
      ? ((this.cursor.visible = !1), setInterval(() => this.onResize(!0), 5e3))
      : this.stage.addChild(App.Console);
    this.stage.addChild(App.Stats);
    this.stage.addChild(App.Layer);
    App.WhiteLabel === App.WhiteLabel_POKI_MAIN && this.stage.addChild(this.pokiLogo);
    this.stage.addChild(this.cursor);
    requestAnimationFrame(this.stepCallback);
    this.hasLoaded = !0;
    this.onResize();
    this.menu.resize();
  }
  onMouseDown() {
    Dropdown.CollapseInstances();
  }
  showMenu() {
    App.Console.ignoreInput = !0;
    App.Console.onConsoleInputFocus(!1);
    if (App.WhiteLabel !== App.WhiteLabel_NONE || 1300 > App.ClientWidth) App.Console.visible = !1;
    App.Renderer.plugins.interaction.on("mousedown", this.onMouseDownListener);
    this.menu = new Menu(this.servers);
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        this.adElement &&
          ((this.adElement.style.display = "block"),
          App.CrazySDK.requestResponsiveBanner(["banner-container"]));
        break;
      case App.WhiteLabel_POKI_MAIN:
        this.adElement &&
          App.PokiSDK &&
          ((this.adElement.style.display = "block"),
          App.PokiSDK.displayAd(this.adElement, "728x90"));
        break;
      default:
        this.adElement &&
          window.aiptag &&
          ((this.adElement.style.display = "block"),
          aiptag.cmd.display.push(function () {
            aipDisplayTag.display("ninja-io_300x250");
          }));
    }
    this.menu.y = -8;
    this.menu.on(Menu.GUEST_NAME_CHANGE, (a) => this.onGuestNameChange(a));
    this.menu.on(Menu.CUSTOMIZATION_ACCESS, () => App.Layer.onCustomizationShow());
    this.menu.on(Menu.SERVER_CREATION_ACCESS, () => App.Layer.onServerCreationShow());
    this.menu.on(Menu.SERVER_LISTING_ACCESS, () => App.Layer.onServerListingShow());
    this.menu.on(Menu.RENAME_ACCESS, () => App.Layer.onRenameAccess());
    this.menu.on(Menu.JOIN_GAME_MODE, (a) => this.onRequestJoinGameMode(a));
    this.menu.on(Menu.JOIN_SERVER, (a, b) => this.onRequestChooseServer(a, b));
    this.menu.on(Menu.REWARDS_ACCESS, () => App.Layer.onRewardsAccess());
    this.menu.on(Menu.NEWS_ACCESS, () => App.Layer.onNewsAccess());
    this.menu.setPlayerData({
      name: this.credential.username,
      guest: -1 === this.credential.playerid ? !0 : !1,
      customization: this.credential.customization,
    });
    this.menu.setServerData(this.servers);
    this.menu.setServerStatus(this.status);
    this.menu.init();
    this.stage.addChild(this.gradient);
    this.stage.addChild(this.sky);
    this.stage.addChild(this.background);
    this.stage.addChild(this.menu);
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      ((this.youtubeLogo.x = 0.5 * App.ClientWidth + 320),
      (this.redditLogo.x = 0.5 * App.ClientWidth + 362),
      (this.twitterLogo.x = 0.5 * App.ClientWidth + 400),
      (this.youtubeLogo.y = 5),
      (this.twitterLogo.y = 3),
      (this.redditLogo.y = 4),
      this.stage.addChild(this.youtubeLogo),
      this.stage.addChild(this.twitterLogo),
      this.stage.addChild(this.redditLogo));
    this.onResize();
    App.Console.parent && this.stage.setChildIndex(App.Console, this.stage.children.length - 1);
    App.Layer.parent && this.stage.setChildIndex(App.Layer, this.stage.children.length - 1);
    this.checkInterval ||
      ((this.checkInterval = setInterval(() => {
        let a = Date.now();
        6e4 <= a - this.lastServerReload && ((this.lastServerReload = a), this.requestServerList());
        if (6e4 <= a - this.lastBannerReload)
          switch (((this.lastBannerReload = a), App.WhiteLabel)) {
            case App.WhiteLabel_CG:
              this.adElement &&
                ((this.adElement.style.display = "block"),
                App.CrazySDK.requestResponsiveBanner(["banner-container"]));
          }
      }, App.CheckIntervalRate)),
      this.requestServerList());
    App.WhiteLabel === App.WhiteLabel_POKI_MAIN && this.stage.addChild(this.pokiLogo);
  }
  setFocus(a) {
    if ((App.HasFocus = a))
      this.game ? (this.game.focus(), this.game.resize()) : this.menu && this.menu.resize();
  }
  onConnect() {
    this.onConnectRetryMode &&
      (this.onRequestJoinGameMode(this.onConnectRetryMode), (this.onConnectRetryMode = null));
    App.ConnectedServer = App.SelectedServer;
  }
  async onDisconnect() {
    null !== this.game && this.leaveGame(!0);
  }
  onStep(a) {
    const b = a - this.lastUpdateTime;
    0 > b && (this.lastUpdateTime = a);
    App.Time = App.StartTime + a;
    13 < b &&
      ((this.lastUpdateTime = a),
      (App.FrameTime = (60 * b) / 1e3),
      this.game
        ? this.game.step(b)
        : (App.Layer && App.Layer.update(), this.menu && this.menu.active && this.menu.step()),
      App.Renderer && App.Renderer.render(this.stage, { clear: !1 }));
    requestAnimationFrame(this.stepCallback);
  }
  async onRequestChooseServer(a, b) {
    await this.applyServerSettings(a);
    b();
  }
  onLayerJoinServer(a) {
    let b = null;
    for (let c = 0; c < this.servers.length; c++)
      if (this.servers[c].id === a) {
        b = this.servers[c];
        break;
      }
    this.applyServerSettings(b);
  }
  async applyServerSettings(a) {
    await App.Layer.updateCredentialsIfExpired();
    App.SelectedServer = a;
    this.client.setServer(App.SelectedServer);
    this.menu.selectServer(a.id);
    Registry.SetLocalStorageItem(App.ServerPreference, App.SelectedServer.uid);
  }
  onLayerCreateServer(a) {
    if (this.client.isConnected()) this.client.emit({ type: Protocol.Session.CREATE, params: a });
    else
      App.Layer.onServerCreateResult({
        success: !1,
        info: "Server creation failed. \nNot connected to any server.\nGold will be refunded automatically.",
      });
  }
  onLayerRenameCompleted() {
    this.menu.setPlayerData({
      name: this.credential.username,
      guest: -1 === this.credential.playerid ? !0 : !1,
      customization: this.credential.customization,
    });
  }
  onJoystickMoveState(a) {
    this.game && this.game.updateJoystickMoveState(a);
  }
  onJoystickTargetState(a) {
    this.game && this.game.updateJoystickTargetState(a);
  }
  onRegisterFailed() {
    this.authenticated = !1;
    App.Layer.onServerAuthFailed();
  }
  onClientDisconnectForImmediateReconnect() {
    this.client.connect();
  }
  async onRequestJoinGameMode(a) {
    await App.Layer.updateCredentialsIfExpired();
    App.Layer.onJoinGameMode();
    this.client.isConnected()
      ? ((App.SelectedMode = a),
        Registry.SetLocalStorageItem(App.ModePreference, App.SelectedMode),
        this.requestJoinGameMode(a))
      : ((this.onConnectRetryMode = a), this.client.connect());
  }
  async requestServerList() {
    let a = await APIClient.getServers();
    if (a) {
      this.servers = a.servers;
      this.servers.sort(() => 0.5 - Math.random());
      this.status = a.status;
      var b = this.servers[0];
      if (App.FirstRun) {
        var c = App.GetNearestGeoServer(this.servers);
        c && (b = c);
      }
      if (0 < this.servers.length) {
        if (App.FirstRun) App.SelectedServer = b;
        else {
          c = Registry.GetLocalStorageItem(App.ServerPreference);
          for (let d = 0; d < this.servers.length; d++) {
            let e = this.servers[d];
            if (e.uid === c || null === c) {
              App.SelectedServer = e;
              break;
            }
          }
        }
        App.Servers = this.servers;
      }
      null === App.SelectedServer && (App.SelectedServer = b);
      this.client.setServer(App.SelectedServer);
      null !== this.menu &&
        (0 < this.servers.length && this.menu.setServerData(this.servers),
        this.menu.setServerStatus(this.status),
        this.menu.setServerHeadline(a.headline));
    }
  }
  requestJoinGame(a) {}
  requestJoinGameMode(a) {
    this.autoJoinOnCreate = !0;
    this.client.emit({ type: Protocol.Session.JOIN_MODE, mode: a });
  }
  requestLeaveGame(a) {
    this.client.emit({ type: Protocol.Session.LEAVE });
  }
  onSessionData(a) {
    switch (a.type) {
      case Protocol.Session.CREATE_RESP:
        a.success &&
          this.autoJoinOnCreate &&
          this.client.emit({ type: Protocol.Session.JOIN_GAME, name: a.name });
        this.autoJoinOnCreate || (App.Console.log(a.info), App.Layer.onServerCreateResult(a));
        this.autoJoinOnCreate = !1;
        break;
      case Protocol.Session.JOIN_RESP:
        this.onJoinResp(a);
        this.autoJoinOnCreate = !1;
        break;
      case Protocol.Session.LEAVE_RESP:
        this.onLeaveResp(a);
        break;
      case Protocol.Session.INFO:
        this.onInfo(a);
        break;
      case Protocol.Session.CLIENT_AUTH:
        this.onClientAuth(a);
    }
  }
  onClientAuth(a) {
    App.Console.log("connection established");
    null !== this.autoJoinGame
      ? (App.Console.log("Joining game " + this.autoJoinGame.name + "..."),
        this.client.emit({
          type: Protocol.Session.JOIN_GAME,
          name: this.autoJoinGame.name,
          password: this.autoJoinGame.password,
        }),
        (this.autoJoinGame = null))
      : a.authenticated && (this.authenticated = !0);
  }
  onServerFull() {
    App.Layer.onServerFull();
  }
  onConnectionError() {
    App.Layer.onConnectionError();
  }
  onInfo(a) {
    App.Console.log(a.info);
  }
  onJoinResp(a) {
    if (a.granted) this.initGameMode(a.sid);
    else App.Layer.onServerReject(a);
  }
  onLeaveResp(a) {
    a.granted && this.leaveGame();
  }
  async leaveGame() {
    this.gameInputListener && this.client.removeListener(Protocol.GAME, this.gameInputListener);
    this.gameBinInputListener &&
      this.client.removeListener(Protocol.GAME_BIN, this.gameBinInputListener);
    this.gameOutputListener && this.game.removeListener(Protocol.GAME, this.gameOutputListener);
    this.adLoaderBackground &&
      this.adLoaderBackground.parent &&
      (this.stage.removeChild(this.adLoaderBackground),
      this.stage.removeChild(this.continueButton));
    this.gameOutputListener = this.gameBinInputListener = this.gameInputListener = null;
    this.stage.removeChild(this.game);
    this.game.shutdown();
    this.game = null;
    App.Renderer.plugins.interaction.removeListener("mousemove");
    App.Renderer.plugins.interaction.removeListener("mouseup");
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.CrazySDK.gameplayStop();
        break;
      case App.WhiteLabel_POKI_MAIN:
      case App.WhiteLabel_POKI:
        !this.gameplayStopped &&
          App.PokiSDK &&
          ((this.gameplayStopped = !0), console.log("gameplayStop"), App.PokiSDK.gameplayStop());
    }
    this.adLoaderTimeout && clearTimeout(this.adLoaderTimeout);
    this.adFaderInterval && clearInterval(this.adFaderInterval);
    await App.Layer.setMode(Layer.MODE_MENU);
    this.showMenu();
    this.stage.addChild(this.cursor);
    this.interactive = this.stage.interactive = !1;
    this.client.disconnect();
  }
  onGameData(a) {
    this.client.emit(a);
  }
  initGameMode(a) {
    App.Console.visible = !0;
    this.game = new Game(a);
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.CrazySDK.gameplayStart();
        break;
      case App.WhiteLabel_POKI:
      case App.WhiteLabel_POKI_MAIN:
        App.PokiSDK &&
          (this.muteIfRequired(!0),
          (this.adPlaying = !0),
          console.log("commercialBreak"),
          App.PokiSDK.commercialBreak().then(() => {
            this.adPlaying = !1;
            this.muteIfRequired(!1);
            null !== this.game &&
              this.gameplayStopped &&
              ((this.gameplayStopped = !1),
              console.log("gameplayStart"),
              App.PokiSDK.gameplayStart());
          }));
    }
    this.game.onDisplayAdButton = this.onDisplayAdButton.bind(this);
    App.WhiteLabel === App.WhiteLabel_POKI_MAIN &&
      App.PokiSDK &&
      App.PokiSDK.destroyAd(this.adElement);
    this.adElement &&
      (window.aiptag || App.CrazySDK || App.PokiSDK) &&
      (this.adElement.style.display = "none");
    App.Console.ignoreInput = !1;
    this.stage.removeChild(this.gradient);
    this.stage.removeChild(this.sky);
    this.stage.removeChild(this.background);
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      (this.stage.removeChild(this.youtubeLogo),
      this.stage.removeChild(this.twitterLogo),
      this.stage.removeChild(this.redditLogo));
    App.WhiteLabel === App.WhiteLabel_POKI_MAIN && this.stage.removeChild(this.pokiLogo);
    this.gameOutputListener = this.onGameData.bind(this);
    this.game.on(Protocol.GAME, this.gameOutputListener);
    this.game.on(Layer.Events.DISCONNECT, () => this.onLayerDisconnect());
    this.game.on(Game.MATCH_START, () => {
      this.matchStarted = !0;
      switch (App.WhiteLabel) {
        case App.WhiteLabel_CG:
          App.CrazySDK.gameplayStart();
          break;
        case App.WhiteLabel_POKI:
        case App.WhiteLabel_POKI_MAIN:
          App.PokiSDK &&
            this.gameplayStopped &&
            !this.adPlaying &&
            ((this.gameplayStopped = !1),
            console.log("gameplayStart"),
            App.PokiSDK.gameplayStart());
      }
    });
    this.game.on(Game.MATCH_END, () => {
      this.matchStarted = !1;
      switch (App.WhiteLabel) {
        case App.WhiteLabel_CG:
          App.CrazySDK.gameplayStop();
          break;
        case App.WhiteLabel_POKI:
        case App.WhiteLabel_POKI_MAIN:
          App.PokiSDK &&
            !this.gameplayStopped &&
            ((this.gameplayStopped = !0), console.log("gameplayStop"), App.PokiSDK.gameplayStop());
      }
    });
    this.gameInputListener = (b) => this.game.onData(b.data);
    this.gameBinInputListener = (b) => this.game.onBinData(b.data);
    this.client.addListener(Protocol.GAME, this.gameInputListener);
    this.client.addListener(Protocol.GAME_BIN, this.gameBinInputListener);
    this.stage.removeChild(this.menu);
    this.stage.removeChild(this.cursor);
    this.menu = null;
    Dropdown.RemoveInstances();
    App.Renderer.plugins.interaction.removeListener("mousedown", this.onMouseDownListener);
    this.stage.addChildAt(this.game, 0);
    this.game.resize();
    this.interactive = this.stage.interactive = !1;
    this.checkInterval && (clearInterval(this.checkInterval), (this.checkInterval = null));
    App.Layer.setMode(Layer.MODE_GAME);
  }
  onCmdConnect() {
    App.Console.log("command not implemented");
  }
  onCmdDisconnect() {
    App.Console.log("command not implemented");
  }
  onCmdUnlink() {
    App.Console.unlinkInterpreter(this.interpreter);
    App.Console.log("command interpreter unlinked");
  }
  onCmdInvalid(a) {}
  onDisplayAdButton() {
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.CrazySDK.gameplayStop();
    }
    this.adLoaderTimeout = setTimeout(() => {
      this.menu ||
        (this.continueButton.parent ||
          ((this.adLoaderBackground.alpha = 0),
          this.stage.addChild(this.adLoaderBackground),
          this.stage.addChild(this.continueButton)),
        this.stage.addChild(this.cursor),
        (this.adFaderInterval = setInterval(() => {
          this.adLoaderBackground.alpha += 0.04;
          0.8 <= this.adLoaderBackground.alpha &&
            (clearInterval(this.adFaderInterval), (this.adLoaderBackground.alpha = 0.8));
        }, 50)));
    }, 5e3);
  }
  onTriggerVideoAd() {
    switch (App.WhiteLabel) {
      case App.WhiteLabel_CG:
        App.CrazySDK.requestAd("midgame");
        break;
      case App.WhiteLabel_POKI:
      case App.WhiteLabel_POKI_MAIN:
        App.PokiSDK &&
          (this.muteIfRequired(!0),
          (this.adPlaying = !0),
          console.log("commercialBreak"),
          App.PokiSDK.commercialBreak().then(() => {
            this.adPlaying = !1;
            console.log("Commercial break finished, proceeding to game");
            this.gameplayStopped &&
              this.matchStarted &&
              ((this.gameplayStopped = !1),
              console.log("gameplayStart"),
              App.PokiSDK.gameplayStart());
            this.muteIfRequired(!1);
          }));
        break;
      default:
        "undefined" !== typeof adplayer &&
          aiptag.cmd.player.push(function () {
            adplayer.startPreRoll();
          });
    }
    this.adLoaderBackground &&
      this.adLoaderBackground.parent &&
      ((this.adLoaderBackground.alpha = 0),
      this.stage.removeChild(this.adLoaderBackground),
      this.stage.removeChild(this.continueButton));
    this.menu ||
      (this.stage.removeChild(this.cursor),
      (this.interactive = !1),
      this.stage.removeChild(this.gradient),
      this.stage.removeChild(this.sky),
      this.stage.removeChild(this.background));
  }
  drawBackground() {
    this.background.setup(6, 5, 600, 150, 50, 50);
    this.background.draw("generic", 5263964);
    this.gradient.resize(App.ClientWidth, App.ClientHeight);
    this.sky.clear();
    this.sky.beginFill(16777215, 1);
    for (let a = 0; 300 > a; a++)
      this.sky.drawCircle(
        Math.random() * App.ClientWidth,
        Math.random() * App.ClientHeight * 0.75,
        0.5 + 0.5 * Math.random()
      );
    this.sky.endFill();
  }
  onResize(a = !1) {
    App.WindowResized = !0;
    var b = App.ClientWidth;
    let c = App.ClientHeight,
      d = !1;
    this.hasLoaded || (this.resizeOnLoad = !0);
    App.Renderer &&
      (App.IsMobile
        ? ((App.ClientWidth = window.innerWidth), (App.ClientHeight = window.innerHeight))
        : ((App.ClientWidth = window.innerWidth > screen.width ? screen.width : window.innerWidth),
          (App.ClientHeight =
            window.innerHeight > screen.height ? screen.height : window.innerHeight)),
      (d = b !== App.ClientWidth || c !== App.ClientHeight));
    (d || this.resizeOnLoad) &&
      this.hasLoaded &&
      ((App.Console.visible = 1300 > App.ClientWidth && null === this.game ? !1 : !0),
      null !== this.redrawTimeout &&
        (clearTimeout(this.redrawTimeout), (this.redrawTimeout = null)),
      (this.redrawTimeout = setTimeout(() => {
        this.hasLoaded && null !== this.menu && (a || this.drawBackground());
        this.redrawTimeout = null;
      }, 500)),
      (this.adLoaderBackground.width = App.ClientWidth),
      (this.adLoaderBackground.height = App.ClientHeight),
      App.Renderer.resize(App.ClientWidth, App.ClientHeight));
    App.Stats && (App.Stats.x = App.ClientWidth - 12);
    App.Layer && App.Layer.resize(App.ClientWidth, App.ClientHeight);
    b =
      App.ClientWidth - 300 * App.Scale < App.ClientHeight
        ? App.ClientWidth / 860
        : App.ClientHeight / 560;
    this.hasLoaded &&
      ((App.Scale = b),
      560 > App.ClientWidth - 300 * App.Scale || 560 > App.ClientHeight
        ? ((App.Layer.scale.x = App.Layer.scale.y = b),
          this.menu &&
            ((this.menu.scale.x = this.menu.scale.y = b),
            (this.menu.x = (1 - b) * App.ClientWidth * 0.5)),
          (App.Layer.x = (1 - b) * App.ClientWidth * 0.5))
        : ((App.Scale = 1),
          (App.Layer.scale.x = App.Layer.scale.y = 1),
          this.menu && ((this.menu.scale.x = this.menu.scale.y = 1), (this.menu.x = 0)),
          (App.Layer.x = 0)),
      (this.continueButton.x = 0.5 * (App.ClientWidth - this.continueButton.width)),
      (this.continueButton.y = 0.5 * App.ClientHeight),
      (this.youtubeLogo.y = 5 * App.Scale),
      (this.redditLogo.y = 4 * App.Scale),
      (this.twitterLogo.y = 3 * App.Scale),
      (this.youtubeLogo.x = 0.5 * App.ClientWidth + 320 * App.Scale),
      (this.redditLogo.x = 0.5 * App.ClientWidth + 362 * App.Scale),
      (this.twitterLogo.x = 0.5 * App.ClientWidth + 400 * App.Scale),
      (this.youtubeLogo.scale.x = this.youtubeLogo.scale.y = 0.45 * App.Scale),
      (this.redditLogo.scale.x = this.redditLogo.scale.y = 0.4 * App.Scale),
      (this.twitterLogo.scale.x = this.twitterLogo.scale.y = 0.4 * App.Scale),
      this.pokiLogo &&
        ((this.pokiLogo.x = App.ClientWidth - 8), (this.pokiLogo.y = App.ClientHeight - 8)));
    this.setFocus(!0);
  }
  onLayerDisconnect() {
    this.client.emit({ type: Protocol.Session.LEAVE });
  }
  onLayerShowSettings() {
    this.menu && this.menu.showSettings();
  }
  onLayerHideSettings() {
    this.menu && this.menu.hideSettings();
  }
  onEscapeMenuAccess() {
    if (this.game) this.game.onEscapeMenuAccess();
  }
  onRewardsClaimed() {
    this.menu && this.menu.hideRewardButton();
  }
  onLayerMute(a) {
    this.game &&
      (this.game.mute(a), a && (Registry.Instance[Registry.Key.SETTINGS].sound.enabled = !a));
  }
  onLayerDisplayHelp() {
    this.game && this.game.displayHelp();
  }
  onLayerHideMenu() {
    this.menu && (this.menu.hideItems(), (this.menu.active = !1));
  }
  onLayerShowMenu() {
    this.menu && (this.menu.showItems(), (this.menu.active = !0), this.menu.hideSettings());
  }
  onLayerJoinGame(a, b, c) {
    if (!this.client.isConnected() || (App.SelectedServer && App.SelectedServer.id !== b))
      for (let d = 0; d < this.servers.length; d++) {
        let e = this.servers[d];
        if (e.id === b) {
          App.SelectedServer = e;
          this.autoJoinGame = { name: a, password: c };
          this.menu.selectServer(b);
          this.client.setServer(App.SelectedServer);
          this.client.connect();
          break;
        }
      }
    else
      this.client.setServer(App.SelectedServer),
        this.client.emit({ type: Protocol.Session.JOIN_GAME, name: a, password: c });
  }
  async onGuestNameChange(a) {
    App.Credential = this.credential = await this.fetchGuestCredential(a);
  }
  async onLayerUpdateCredential(a, b) {
    this.credential = !1 === a.available ? await this.fetchGuestCredential() : a;
    App.Credential = this.credential;
    b
      ? (Registry.Instance.store(Registry.Key.CREDENTIAL, a), (Registry.Instance.credential = a))
      : (Registry.Instance.store(Registry.Key.CREDENTIAL, { available: !1 }),
        (Registry.Instance.credential = { available: !1 }));
    this.menu &&
      (this.menu.setPlayerData({
        name: this.credential.username,
        guest: -1 === this.credential.playerid ? !0 : !1,
        customization: this.credential.customization,
      }),
      this.client.isConnected() && this.client.disconnect(!0),
      this.menu.checkRewards(!0));
  }
  adStarted() {
    this.muteIfRequired(!0);
  }
  adFinished() {
    this.muteIfRequired(!1);
    if (App.ShowRewardedAd) App.Layer.onRewardedAdFinished(!0);
    if (App.ShowRewardedShopAd) App.Layer.onRewardedShopAdFinished(!0, !0);
    App.ShowRewardedAd = !1;
    App.ShowRewardedShopAd = !1;
  }
  adError() {
    this.muteIfRequired(!1);
    if (App.ShowRewardedAd) App.Layer.onRewardedAdFinished(!1);
    if (App.ShowRewardedShopAd) App.Layer.onRewardedShopAdFinished(!1, !0);
    App.ShowRewardedAd = !1;
    App.ShowRewardedShopAd = !1;
  }
  muteIfRequired(a) {
    null !== this.game &&
      (a
        ? this.settings && this.settings.sound
          ? this.settings.sound.enabled && this.game.mute(!0)
          : this.game.mute(!0)
        : this.settings && this.settings.sound
        ? this.settings.sound.enabled && this.game.mute(!1)
        : this.game.mutePref || this.game.mute(!1));
  }
}
App.UpdatePreloader = function (a) {
  void 0 !== window.setPreloaderPercentage && window.setPreloaderPercentage(a);
};
App.RemovePreloader = function () {
  const a = document.getElementById("preloader");
  let b = 1;
  const c = setInterval(() => {
    a && (0 < b - 0.025 ? ((a.style.opacity = b), (b -= 0.025)) : (a.remove(), clearInterval(c)));
  }, 1e3 / 60);
};
App.GenerateTexturesFromSheet = function (a) {
  for (let b in a)
    App.CombinedTextures[b] = App.Renderer.generateTexture(new PIXI.Sprite(a[b]), {
      scaleMode: PIXI.SCALE_MODES.LINEAR,
      resolution: 1,
      multisample: PIXI.MSAA_QUALITY.HIGH,
    });
};
App.CrazySDK = null;
App.PokiSDK = null;
App.WhiteLabel_NONE = "ninja.io";
App.WhiteLabel_CG = "cg";
App.WhiteLabel_POKI = "poki";
App.WhiteLabel_POKI_MAIN = "poki_main";
let whitelabel = window.location.host.split(".")[1] ? window.location.host.split(".")[0] : !1;
switch (whitelabel) {
  case App.WhiteLabel_CG:
    App.WhiteLabel = App.WhiteLabel_CG;
    window.CrazyGames && (App.CrazySDK = window.CrazyGames.CrazySDK.getInstance());
    break;
  case App.WhiteLabel_POKI:
    App.WhiteLabel = App.WhiteLabel_POKI;
    window.PokiSDK && (App.PokiSDK = window.PokiSDK);
    break;
  default:
    (App.WhiteLabel = App.WhiteLabel_POKI_MAIN), (App.PokiSDK = window.PokiSDK);
}
"remove" in Element.prototype ||
  (Element.prototype.remove = function () {
    this.parentNode && this.parentNode.removeChild(this);
  });
let mobileDetect = new MobileDetect(navigator.userAgent);
App.IsMobile = mobileDetect.mobile();
App.CMD_CONNECT = "connect";
App.CMD_DISCONNECT = "disconnect";
App.CMD_UNLINK = "unlink";
App.CheckIntervalRate = 1e4;
App.ServerPreference = "server_preference";
App.ModePreference = "mode_preference";
App.Renderer = null;
App.Stage = null;
App.Console = null;
App.Stats = null;
App.Layer = null;
App.ClientVersion = "0.2.0";
App.HasFocus = !0;
App.Scale = 1;
App.StartTime = Date.now();
App.Time = App.StartTime;
App.FrameTime = 0;
App.LastRewardCheck = 0;
App.HadRewards = !1;
App.ShowRewardedAd = !1;
App.AdblockDetected = !1;
App.ShowRewardedShopAd = !1;
App.WindowResized = !1;
App.HelpDisplayed = !1;
App.DevicePixelRatio = window.devicePixelRatio;
App.ClientWidth = window.innerWidth > screen.width ? screen.width : window.innerWidth;
App.ClientHeight = window.innerHeight > screen.height ? screen.height : window.innerHeight;
App.ConnectedServer = {};
App.Servers = [];
App.SelectedServer = null;
App.SelectedMode = null;
App.TransformedMouseX = 0.5 * App.ClientWidth;
App.TransformedMouseY = 0.5 * App.ClientHeight;
App.Client = {};
App.AssetTree = {};
App.Assets = {};
App.UIVisible = !1;
App.FieldHasFocus = !1;
App.Autogen = !1;
App.FirstRun = !1;
App.Credential = {};
App.Customization = {
  HAIR: [],
  TORSO: [],
  ORB: [],
  FACE: [],
  BELT: [],
  ARMLEFTLOWER: [],
  ARMLEFTUPPER: [],
  ARMRIGHTLOWER: [],
  ARMRIGHTUPPER: [],
  LEGLEFTLOWER: [],
  LEGLEFTUPPER: [],
  LEGRIGHTLOWER: [],
  LEGRIGHTUPPER: [],
  EXTRA: [],
};
App.TimeToColourMap = [
  1381653, 5263964, 6910590, 8557987, 10271433, 10933980, 11331555, 11727327, 10682326, 8650663,
  8650642, 10354563, 10092383, 12123972, 13762089, 14810665, 16514601, 16707113, 16701225, 16691497,
  15234048, 10768128, 7353856, 4267776,
];
App.ContinentMap = { Europe: "eu_west", America: "na_east", Asia: "as_south", Africa: "eu_west" };
App.GetNearestGeoServer = (a) => {
  var b = Intl.DateTimeFormat().resolvedOptions().timeZone;
  b = b.substr(0, b.indexOf("/"));
  b = App.ContinentMap[b];
  void 0 === b && (b = "eu_west");
  let c = null;
  for (let d = 0; d < a.length; d++) {
    let e = a[d];
    if (e.region === b)
      if (null === c) {
        if (((c = e), 100 > parseInt(c.players))) break;
      } else if (100 <= parseInt(c.players) && 100 > parseInt(e.players)) {
        c = e;
        break;
      }
  }
  return c;
};
App.RESOURCE_FOLDER = "./assets-dev";
App.RESOURCES = {
  combined: [{ id: "combined", file: "combined.json" }],
  seamless: [{ id: "seamless", file: "seamless.json" }],
  fonts: [{ id: "opensans", file: "opensans.fnt" }],
};
class AudioManager {
  constructor(a) {
    this.muted = !1;
    this.parent = a;
    this.queue = [];
    this.onAgentStateChangeListener = this.onAgentStateChange.bind(this);
    this.onAddedListener = this.onAdded.bind(this);
    this.onContactListener = this.onContact.bind(this);
    this.onRemovedListener = this.onRemoved.bind(this);
    this.onCreateEffectListener = this.onCreateEffect.bind(this);
    this.parent.on(ModelEvent.AGENT_STATE, this.onAgentStateChangeListener);
    this.parent.on(ModelEvent.GAMEOBJECT_ADDED, this.onAddedListener);
    this.parent.on(ModelEvent.GAMEOBJECT_CONTACT, this.onContactListener);
    this.parent.on(ModelEvent.GAMEOBJECT_DELETED, this.onRemovedListener);
    this.parent.on(ModelEvent.CREATE_EFFECT, this.onCreateEffectListener);
  }
  update(a) {
    if (0 !== this.queue.length) {
      var b = this.queue.length;
      for (let c = 0; c < b; c++) {
        let d = this.queue[c];
        d.delay -= a;
        0 >= d.delay &&
          (d.agent.alive && AudioManager.PlayEffect(d.audio, d.agent, !0),
          this.queue.splice(c, 1),
          c--,
          b--);
      }
    }
  }
  clear() {
    this.queue = [];
  }
  mute() {
    Howler.mute(!0);
    this.parent.removeListener(ModelEvent.AGENT_STATE, this.onAgentStateChangeListener);
    this.parent.removeListener(ModelEvent.GAMEOBJECT_ADDED, this.onAddedListener);
    this.parent.removeListener(ModelEvent.GAMEOBJECT_CONTACT, this.onContactListener);
    this.parent.removeListener(ModelEvent.GAMEOBJECT_DELETED, this.onRemovedListener);
    this.parent.removeListener(ModelEvent.CREATE_EFFECT, this.onCreateEffectListener);
    this.muted = !0;
  }
  unmute() {
    Howler.mute(!1);
    this.parent.on(ModelEvent.AGENT_STATE, this.onAgentStateChangeListener);
    this.parent.on(ModelEvent.GAMEOBJECT_ADDED, this.onAddedListener);
    this.parent.on(ModelEvent.GAMEOBJECT_CONTACT, this.onContactListener);
    this.parent.on(ModelEvent.GAMEOBJECT_DELETED, this.onRemovedListener);
    this.parent.on(ModelEvent.CREATE_EFFECT, this.onCreateEffectListener);
    this.muted = !1;
  }
  onAgentStateChange(a) {
    let b = a.agent;
    a = a.state;
    switch (a.s) {
      case StateChange.Item.INIT_USE:
        this.onInitUseFX(b, a.t);
        break;
      case StateChange.Item.USE:
        this.onUseFX(b, a.t);
        break;
      case StateChange.Item.RELOAD:
        if (0 === a.c) this.onReload(b, a.t);
    }
  }
  onAdded(a) {
    if (a.audio && a.audio.onAdded) {
      let c = a.audio;
      for (let d = 0; d < c.onAdded.length; d++) {
        var b = c.onAdded[d];
        b instanceof Array
          ? ((b = b[Math.floor(Math.random() * b.length)]),
            void 0 !== b.volume && b.volume(b.volume),
            AudioManager.PlayEffect(b, a))
          : (void 0 !== b.volume && b.volume(b.volume), AudioManager.PlayEffect(b, a));
      }
    }
  }
  onCreateEffect(a) {
    if ("saw" === a.type) {
      var b = a.cat;
      b === EntityCategory.LIMB || b === EntityCategory.LOCAL || b === EntityCategory.AGENT
        ? ((b =
            AudioEffects.BodyImpact instanceof Array
              ? AudioEffects.BodyImpact[Math.floor(Math.random() * AudioEffects.BodyImpact.length)]
              : AudioEffects.BodyImpact),
          b.audio.volume(1),
          AudioManager.PlayEffect(b, a.go))
        : ((b = ParticleEffects.ChainsawRaycast[PP.AUDIO]),
          b.audio.volume(1),
          AudioManager.PlayEffect(b, a.go));
    }
  }
  onInitUseFX(a, b) {
    if (!(AudioManager.CamDistance(a.p) > 0.75 * App.ClientWidth)) {
      b = ItemMap[b].onInitUse.audio;
      for (let c = 0, d = b.length; c < d; c++)
        b[c].audio.stereo(AudioManager.Stereo(a.p)), AudioManager.PlayEffect(b[c], a, !0);
    }
  }
  onUseFX(a, b) {
    if (!(AudioManager.CamDistance(a.p) > 0.75 * App.ClientWidth))
      if (((b = ItemMap[b].onUse), 1 === b.audio.length))
        b.audio[0].audio.stereo(AudioManager.Stereo(a.p)),
          b.postUseAudio &&
            this.queue.push({
              audio: b.postUseAudio[0].audio,
              delay: b.postUseAudio[0].delay,
              agent: a,
            }),
          AudioManager.PlayEffect(b.audio[0], a, !0);
      else
        for (let c = 0, d = b.length; c < d; c++)
          b[c].audio.stereo(AudioManager.Stereo(a.p)), AudioManager.PlayEffect(b[c], a, !0);
  }
  onRemoved(a) {
    if (!(AudioManager.CamDistance(a.p) > 0.75 * App.ClientWidth)) {
      var b = a.audio;
      if (b && b.onRemove)
        for (let d = 0; d < b.onRemove.length; d++) {
          var c = b.onRemove[d];
          c instanceof Array
            ? ((c = c[Math.floor(Math.random() * c.length)]),
              c.audio.stereo(AudioManager.Stereo(a.p)),
              c.audio.play())
            : (c.audio.stereo(AudioManager.Stereo(a.p)), c.audio.play());
        }
    }
  }
  onContact(a) {
    if (!(AudioManager.CamDistance(a.go.p) > 0.75 * App.ClientWidth)) {
      var b = a.go.audio;
      if (b) {
        let f = [];
        var c = !1;
        if (b.checkAltContact) {
          c = a.contact.a;
          var d = a.contact.b;
          (c = a.go.id === c ? this.parent.bodies[d] : this.parent.bodies[c]) &&
          c.audio &&
          c.audio.altContact
            ? ((f = c.audio.altContact), (c = !0))
            : (c = !1);
        }
        !c && b.onContact && (f = b.onContact);
        for (b = 0; b < f.length; b++)
          if (((c = f[b]), c instanceof Array)) {
            c = c[Math.floor(Math.random() * c.length)];
            d = a.go.p;
            if (c.delta) {
              var e = (0.4 * Math.sqrt(d.vx * d.vx + d.vy * d.vy)).clamp(0.05, 0.5);
              c.audio.volume(e);
            }
            c.audio.stereo(AudioManager.Stereo(d));
            c.audio.play();
          } else
            (d = a.go.p),
              c.delta &&
                ((e = (0.4 * Math.sqrt(d.vx * d.vx + d.vy * d.vy)).clamp(0.05, 0.5)),
                c.audio.volume(e)),
              c.audio.stereo(AudioManager.Stereo(d)),
              c.audio.play();
      }
    }
  }
  onReload(a, b) {
    AudioManager.CamDistance(a.p) > 0.75 * App.ClientWidth ||
      void 0 !== ItemMap[b].reloadAudio ||
      (AudioEffects.Reload.audio.stereo(AudioManager.Stereo(a.p)),
      AudioEffects.Reload.audio.play());
  }
}
AudioManager.Cam = null;
AudioManager.CamDistance = function (a) {
  let b = -AudioManager.Cam.x + 0.5 * App.ClientWidth - a.x;
  a = -AudioManager.Cam.y + 0.5 * App.ClientHeight - a.y;
  return Math.sqrt(b * b + a * a);
};
AudioManager.Stereo = function (a) {
  a = ((a.x - (-AudioManager.Cam.x + 0.5 * App.ClientWidth)) / (0.5 * App.ClientWidth)) * 0.5;
  return -1 > a ? -1 : 1 < a ? 1 : a;
};
AudioManager.PlayEffect = function (a, b, c) {
  (!c && AudioManager.CamDistance(b.p) > 0.75 * App.ClientWidth) ||
    (Array.isArray(a) && (a = a[Math.floor(Math.random() * a.length)]),
    a.single
      ? a.audio.playing(b.id)
        ? a.audio.seek() > a.sub_end && a.audio.seek(a.sub_start)
        : a.audio.play()
      : (b.p && a.audio.stereo(AudioManager.Stereo(b.p)), a.audio.play()));
};
var audiofx = {},
  AudioFolder =
    App.WhiteLabel === App.WhiteLabel_POKI
      ? App.RESOURCE_FOLDER + "/audio/"
      : "." + App.RESOURCE_FOLDER + "/audio/",
  AudioEffects = {
    Victory: { audio: new Howl({ src: [AudioFolder + "victory.mp3"] }) },
    ButtonHover: { audio: new Howl({ src: [AudioFolder + "buttonhover.mp3"], volume: 0.2 }) },
    ButtonClick: { audio: new Howl({ src: [AudioFolder + "buttonclick.mp3"], volume: 0.2 }) },
    SMGFire: { audio: new Howl({ src: [AudioFolder + "smg-shot.mp3"] }) },
    MAC10Fire: { audio: new Howl({ src: [AudioFolder + "mac10-shot-1.mp3"], volume: 0.15 }) },
    ShotgunFire: { audio: new Howl({ src: [AudioFolder + "shotgun-shot.mp3"] }) },
    ShotgunPump: { audio: new Howl({ src: [AudioFolder + "sg-pump.mp3"], volume: 0.4 }) },
    BarrettFire: { audio: new Howl({ src: [AudioFolder + "barrett-shot.mp3"], volume: 0.5 }) },
    RifleFire: { audio: new Howl({ src: [AudioFolder + "rifle-shot.mp3"] }) },
    AK47Fire: { audio: new Howl({ src: [AudioFolder + "ak47-shot.mp3"] }) },
    BowFire: { audio: new Howl({ src: [AudioFolder + "bow-shot-1.mp3"], volume: 0.75 }) },
    CarbineFire: { audio: new Howl({ src: [AudioFolder + "carbine-shot-1.mp3"], volume: 0.75 }) },
    ShockrifleFire: { audio: new Howl({ src: [AudioFolder + "shockrifle-shot.mp3"] }) },
    RLRocketFire: { audio: new Howl({ src: [AudioFolder + "rl-launch.mp3"], volume: 0.75 }) },
    DeagleFire: { audio: new Howl({ src: [AudioFolder + "deagle-shot.mp3"] }) },
    FlamethrowerFire: {
      audio: new Howl({ src: [AudioFolder + "flamethrower-shot.mp3"] }),
      single: !0,
      sub_start: 0.3,
      sub_end: 1.4,
    },
    EnergyJetFeet: {
      audio: new Howl({ src: [AudioFolder + "jetfeet.mp3"], volume: 0.5 }),
      single: !0,
      sub_start: 0.2,
      sub_end: 0.66,
    },
    ArrowImpact: [
      { audio: new Howl({ src: [AudioFolder + "arrow-impact-1.mp3"], volume: 0.15 }) },
      { audio: new Howl({ src: [AudioFolder + "arrow-impact-2.mp3"], volume: 0.15 }) },
      { audio: new Howl({ src: [AudioFolder + "arrow-impact-3.mp3"], volume: 0.15 }) },
    ],
    RLImpact: [
      { audio: new Howl({ src: [AudioFolder + "rl-impact-1.mp3"], volume: 0.5 }) },
      { audio: new Howl({ src: [AudioFolder + "rl-impact-2.mp3"], volume: 0.5 }) },
    ],
    X75Fire: { audio: new Howl({ src: [AudioFolder + "x75-shot.mp3"], volume: 0.5 }) },
    X75Impact: [
      { audio: new Howl({ src: [AudioFolder + "x75-impact-1.mp3"], volume: 0.5 }) },
      { audio: new Howl({ src: [AudioFolder + "x75-impact-2.mp3"], volume: 0.5 }) },
      { audio: new Howl({ src: [AudioFolder + "x75-impact-3.mp3"], volume: 0.5 }) },
    ],
    Walk: { audio: new Howl({ src: [AudioFolder + "walk-1.mp3"] }) },
    Flip: { audio: new Howl({ src: [AudioFolder + "flip-1.mp3"] }) },
    Tap: { audio: new Howl({ src: [AudioFolder + "metal-tap.mp3"] }), delta: 0.5 },
    ChainsawNeutral: { audio: new Howl({ src: [AudioFolder + "chainsaw-neutral.mp3"] }) },
    ChainsawEngaged: {
      audio: new Howl({ src: [AudioFolder + "chainsaw-engaged.mp3"] }),
      single: !0,
      sub_start: 0.4,
      sub_end: 0.7,
    },
    MinigunEngaged: {
      audio: new Howl({ src: [AudioFolder + "minigun.mp3"] }),
      single: !0,
      sub_start: 0.64,
      sub_end: 0.96,
      immediate: !0,
    },
    Fly: {
      audio: new Howl({ src: [AudioFolder + "fly.mp3"] }),
      single: !0,
      sub_start: 0.2,
      sub_end: 1.1,
    },
    ExplosionCluster: [
      { audio: new Howl({ src: [AudioFolder + "explosion-cluster-1.mp3"], volume: 0.75 }) },
      { audio: new Howl({ src: [AudioFolder + "explosion-cluster-2.mp3"] }) },
    ],
    ExplosionNade: [
      { audio: new Howl({ src: [AudioFolder + "explosion-nade.mp3"], volume: 0.5 }) },
    ],
    ExplosionNadeLauncher: [
      { audio: new Howl({ src: [AudioFolder + "explosion-1.mp3"], volume: 0.5 }) },
    ],
    ShurikenDrop: {
      audio: new Howl({ src: [AudioFolder + "shuriken-drop.mp3"] }),
      delta: 0.1,
      single: !0,
    },
    LawLaunch: { audio: new Howl({ src: [AudioFolder + "law-launch.mp3"] }) },
    NadeLauncher: { audio: new Howl({ src: [AudioFolder + "nadelauncher.mp3"] }) },
    Reload: { audio: new Howl({ src: [AudioFolder + "reloading.mp3"] }) },
    AmmoPickup: [{ audio: new Howl({ src: [AudioFolder + "ammo-pickup-1.mp3"], volume: 0.8 }) }],
    RicochetTiny: { audio: new Howl({ src: [AudioFolder + "ricochet-1.mp3"] }) },
    Thud: [
      { audio: new Howl({ src: [AudioFolder + "impact-1.mp3"] }), delta: 1 },
      { audio: new Howl({ src: [AudioFolder + "impact-2.mp3"] }), delta: 1 },
    ],
    LightThud: { audio: new Howl({ src: [AudioFolder + "light-thud.mp3"] }), delta: 0.1 },
    HeavyThud: { audio: new Howl({ src: [AudioFolder + "heavy-thud.mp3"] }), delta: 1 },
    LaserGunShot1: { audio: new Howl({ src: [AudioFolder + "lasergun-shot-1.mp3"] }) },
    LaserGunImpact: [
      { audio: new Howl({ src: [AudioFolder + "laser-impact-2.mp3"] }) },
      { audio: new Howl({ src: [AudioFolder + "laser-impact-3.mp3"] }) },
    ],
    LaserImpact1: { audio: new Howl({ src: [AudioFolder + "laser-impact-1.mp3"] }) },
    PulseGunShot: { audio: new Howl({ src: [AudioFolder + "lasergun-shot-3.mp3"] }) },
    LinkGunEngaged: {
      audio: new Howl({ src: [AudioFolder + "linkgun-engaged.mp3"], volume: 0.5 }),
      single: !0,
      sub_start: 0.05,
      sub_end: 0.15,
    },
    PulseGunImpact: {
      audio: new Howl({ src: [AudioFolder + "laser-impact-4.mp3"], volume: 0.25 }),
    },
    Rico: [
      { audio: new Howl({ src: [AudioFolder + "rico-1.mp3"], volume: 0.25 }) },
      { audio: new Howl({ src: [AudioFolder + "rico-2.mp3"], volume: 0.25 }) },
      { audio: new Howl({ src: [AudioFolder + "rico-3.mp3"], volume: 0.25 }) },
    ],
    BodyImpact: [
      { audio: new Howl({ src: [AudioFolder + "body-impact-1.mp3"], volume: 0.25, delta: 0.1 }) },
      { audio: new Howl({ src: [AudioFolder + "body-impact-2.mp3"], volume: 0.25, delta: 0.1 }) },
      { audio: new Howl({ src: [AudioFolder + "body-impact-3.mp3"], volume: 0.25, delta: 0.1 }) },
      { audio: new Howl({ src: [AudioFolder + "body-impact-4.mp3"], volume: 0.25, delta: 0.1 }) },
    ],
    Throw: [
      { audio: new Howl({ src: [AudioFolder + "throw-1.mp3"], volume: 0.25 }) },
      { audio: new Howl({ src: [AudioFolder + "throw-2.mp3"], volume: 0.25 }) },
    ],
    WaterSplash: [
      { audio: new Howl({ src: [AudioFolder + "splash-1.mp3"], volume: 0.2 }) },
      { audio: new Howl({ src: [AudioFolder + "splash-2.mp3"], volume: 0.2 }) },
      { audio: new Howl({ src: [AudioFolder + "splash-3.mp3"], volume: 0.2 }) },
    ],
    SnowballImpact: [
      { audio: new Howl({ src: [AudioFolder + "snowball-impact-1.mp3"], volume: 0.35 }) },
      { audio: new Howl({ src: [AudioFolder + "snowball-impact-2.mp3"], volume: 0.35 }) },
      { audio: new Howl({ src: [AudioFolder + "snowball-impact-3.mp3"], volume: 0.35 }) },
    ],
    GoldPickup: [
      { audio: new Howl({ src: [AudioFolder + "gold-pickup-1.mp3"], volume: 0.75 }) },
      { audio: new Howl({ src: [AudioFolder + "gold-pickup-2.mp3"], volume: 0.75 }) },
      { audio: new Howl({ src: [AudioFolder + "gold-pickup-3.mp3"], volume: 0.75 }) },
    ],
    GoldDrop: { audio: new Howl({ src: [AudioFolder + "gold-drop-1.mp3"], volume: 0.1 }) },
    Objective: { audio: new Howl({ src: [AudioFolder + "flag-cap.mp3"], volume: 0.5 }) },
    GrabObjective: { audio: new Howl({ src: [AudioFolder + "flag-grab.mp3"], volume: 0.7 }) },
    Powerup: { audio: new Howl({ src: [AudioFolder + "powerup.mp3"], volume: 0.25 }) },
    Teleport: { audio: new Howl({ src: [AudioFolder + "teleport.mp3"], volume: 0.5 }) },
    Spawn: { audio: new Howl({ src: [AudioFolder + "spawn.mp3"], volume: 0.2 }) },
    Jump: { audio: new Howl({ src: [AudioFolder + "jump.mp3"], volume: 0.5 }) },
    ItemSpawn: { audio: new Howl({ src: [AudioFolder + "item-spawn.mp3"], volume: 0.3 }) },
    BallBounce: { audio: new Howl({ src: [AudioFolder + "ball-bounce.mp3"], volume: 0.3 }) },
  };
var background = {};
class Background extends PIXI.Graphics {
  constructor(a = 6, b = 10, c = 500, d = 150, e = 200, f = 150) {
    super();
    this.mountains = a;
    this.amplitude = b;
    this.stepWidth = c;
    this.stepHeight = d;
    this.varyX = e;
    this.varyY = f;
    this.lastY = this.lastX = 0;
  }
  setup(a = 6, b = 10, c = 500, d = 150, e = 200, f = 150) {
    this.mountains = a;
    this.amplitude = b;
    this.stepWidth = c;
    this.stepHeight = d;
    this.varyX = e;
    this.varyY = f;
    this.lastY = this.lastX = 0;
  }
  center(a, b) {
    this.x = 0.2 * a;
    this.y = 0.2 * b;
  }
  update(a) {
    let b = a.x - this.lastX,
      c = a.y - this.lastY;
    this.lastX = a.x;
    this.lastY = a.y;
    this.y = -1500 > this.y + 0.2 * c ? -1500 : this.y + 0.2 * c;
    this.x += 0.2 * b;
  }
  draw(a, b) {
    if (0 !== b && 16777215 !== b) {
      this.clear();
      var c = 0,
        d = 600;
      switch (a) {
        case "dust":
          this.amplitude = 3;
          this.varyX = 200;
          this.varyY = 30;
          this.stepWidth = 500;
          this.stepHeight = 50;
          d = 400;
          break;
        case "stars":
          this.amplitude = 10;
          this.varyX = 200;
          this.varyY = 150;
          this.stepWidth = 500;
          this.stepHeight = 150;
          break;
        default:
          (this.amplitude = 10),
            (this.varyX = 200),
            (this.varyY = 150),
            (this.stepWidth = 500),
            (this.stepHeight = 150);
      }
      a = 4 + 4 * Math.random();
      a = Background.ChangeBrightness(b, -a, 0.5);
      this.generate(a, c, d, 1, 4);
      c += 200;
      d += 150;
      a = 14 + 4 * Math.random();
      a = Background.ChangeBrightness(b, -a, 1);
      this.generate(a, c, d, 1, 5);
    }
  }
  generate(a, b, c, d = 1, e = 5) {
    var f = this.stepWidth;
    let g = this.stepHeight,
      h = [],
      k = [],
      m = (b -= 0.5 * (this.mountains * f - 0.5 * App.ClientWidth));
    for (let p = 0; p < this.mountains; p++) {
      var l = f + (-this.varyX + Math.random() * this.varyX * 2);
      let n = { x: m, y: c },
        r = { x: m + 0.5 * l, y: c - (g + (-this.varyY + Math.random() * this.varyY * 2)) };
      l = { x: m + l, y: c + (-this.varyY + Math.random() * this.varyY * 2) };
      m = l.x;
      c = l.y;
      h.push([n, r], [r, l]);
    }
    for (f = 0; f < e; f++) h = this.subdivide(h, this.amplitude);
    for (e = 0; e < h.length; e++) k.push(h[e][0], h[e][1]);
    k.push({ x: m + 1e3, y: c + 2e3 });
    k.push({ x: b - 1e3, y: c + 2e3 });
    this.beginFill(a, d);
    this.drawPolygon(k);
    this.endFill();
  }
  subdivide(a, b) {
    let c = [];
    for (let e = 0; e < a.length; e++) {
      var d = a[e];
      let f = d[0];
      d = d[1];
      let g = { x: f.x + 0.5 * (d.x - f.x), y: f.y + 0.5 * (d.y - f.y) };
      g.y += -b + Math.random() * b * 2;
      c.push([f, g], [g, d]);
    }
    return c;
  }
}
Background.ChangeBrightness = function (a, b) {
  let c = (a >> 16) + b;
  255 < c ? (c = 255) : 0 > c && (c = 0);
  let d = ((a >> 8) & 255) + b;
  255 < d ? (d = 255) : 0 > d && (d = 0);
  a = (a & 255) + b;
  255 < a ? (a = 255) : 0 > a && (a = 0);
  return a | (d << 8) | (c << 16);
};
class Camera {
  constructor() {
    this.y = this.x = 0;
    this.target = null;
    this.shaking = 0;
    this.scale = 1.8;
    this.tracking = !1;
  }
  position(a, b) {
    this.x = a;
    this.y = b;
  }
  move(a, b) {
    this.x += a;
    this.y += b;
  }
  shake(a) {
    a = a || this.shaking;
    let b = 0.5 * a,
      c = -a + Math.random() * a * 2,
      d = -a + Math.random() * a * 2;
    this.x += Math.abs(c) < b ? (0 > c ? -b : b) : c;
    this.y += Math.abs(d) < b ? (0 > d ? -b : b) : d;
    this.shaking = 0 < a - 0.1 ? a - 0.1 : 0;
  }
  jerk(a, b) {
    this.x += a * Math.cos(b);
    this.y += a * Math.sin(b);
  }
}
var gradient = {};
class Gradient extends PIXI.Graphics {
  constructor(a, b) {
    super();
    this.w = a;
    this.h = b;
    this.c1 = "#729fcf";
    this.c2 = "#204a87";
    this.drawTimeout = null;
  }
  resize(a, b) {
    this.w = a;
    this.h = b;
    this.colors(this.c2, this.c1);
  }
  colors(a, b) {
    this.c1 = b;
    this.c2 = a;
    null !== this.drawTimeout && (clearTimeout(this.drawTimeout), (this.drawTimeout = null));
    this.drawTimeout = setTimeout(() => {
      this.parent && this.draw();
    }, 100);
  }
  draw() {
    this.clear();
    this.beginTextureFill({ texture: this.generateGradientTexture() });
    this.drawRect(0, 0, this.w, this.h, 8);
    this.endFill();
  }
  offset(a) {}
  generateGradientTexture() {
    const a = document.createElement("canvas");
    a.width = this.w;
    a.height = this.h;
    const b = a.getContext("2d");
    let c = b.createLinearGradient(0, 0, 0, this.h);
    c.addColorStop(0, this.c1);
    c.addColorStop(1, this.c2);
    b.fillStyle = c;
    b.fillRect(0, 0, this.w, this.h);
    return new PIXI.Texture.from(a);
  }
}
var canvas = {};
class Canvas extends PIXI.utils.EventEmitter {
  constructor() {
    super();
    this.settings = Registry.Instance[Registry.Key.SETTINGS];
    this.manager = null;
    this.displayed = [];
    this.dynamicObjects = {};
    this.emitters = {};
    this.players = {};
    this.dissolve = [];
    this.staticBuffer = [];
    this.lineSegments = [];
    this.fb = null;
    this.onStaticObjectAddedBinding = this.onStaticObjectAdded.bind(this);
    this.onGameObjectAddedBinding = this.onGameObjectAdded.bind(this);
    this.gradient = new Gradient(App.ClientWidth, App.ClientHeight);
    this.gradient.interactive = !0;
    this.world = new PIXI.Container();
    this.parallax = new Parallax();
    this.background = new Background();
    this._1 = new PIXI.Container();
    this._2 = new PIXI.Graphics();
    this._3 = new PIXI.Container();
    this._4 = new PIXI.Container();
    this._5 = new PIXI.Container();
    this._2.lineStyle(3, 0, 0.2);
    this.bgParticleContainer = new ParticleContainer();
    this.fgParticleContainer = new ParticleContainer();
    this.world.addChild(this._1);
    this.world.addChild(this.bgParticleContainer);
    this.world.addChild(this._2);
    this.world.addChild(this._3);
    this.world.addChild(this._4);
    this.world.addChild(this._5);
    this.world.addChild(this.fgParticleContainer);
    this.labelContainer = new LabelContainer();
    this.fxMap = {
      punch: this.punchFx.bind(this),
      exp: this.explosionFx.bind(this),
      saw: this.sawFx.bind(this),
      linkgun: this.linkGunFx.bind(this),
    };
    this.world.filterArea = App.Renderer.screen;
    this.energyBoundaryRadius = 5e6;
    this.hasEnergyBoundary = !1;
    this.staticEmitters = {};
    this.background.interactiveChildren = !1;
    this.parallax.interactiveChildren = !1;
    this.world.interactiveChildren = !1;
    this.labelContainer.interactiveChildren = !1;
    this.layers = [this.gradient, this.background, this.parallax, this.world, this.labelContainer];
    this.ropes = {};
    this.cam = new Camera();
    this.cam.scale =
      1.6 / (App.ClientWidth > App.ClientHeight ? 1920 / App.ClientWidth : 1080 / App.ClientHeight);
    this.mouse = { x: 0.5 * App.ClientWidth, y: 0.5 * App.ClientHeight };
    this.frameCount = 0;
    this.rightdown = !1;
    this.lineSize = 0.6 * PC.PM_RATIO;
    this.minDelta = 0.8 * PC.PM_RATIO;
    this.setBackgroundGradient("000000", "265d93", -2e3, 2e3);
    this.zoomFunction = null;
    this.gradient.on("mousedown", (a) => {
      this.onMouseDown(a);
    });
    App.Renderer.plugins.interaction.on("mousemove", (a) => this.onMouseMove(a));
    App.Renderer.plugins.interaction.on("mouseup", (a) => this.onMouseUp(a));
    App.TransformedMouseX = this.mouse.x / this.cam.scale;
    App.TransformedMouseY = this.mouse.y / this.cam.scale;
    App.WindowResized = !0;
    document.body.onmousedown = (a) => {
      if (2 === a.button) this.onRightDown();
      else
        this.rightdown &&
          ((a.data = { global: { x: a.offsetX, y: a.offsetY } }), this.onMouseDown(a));
    };
    document.body.onmouseup = (a) => {
      if (2 === a.button) this.onRightUp();
      else
        this.rightdown &&
          ((a.data = { global: { x: a.offsetX, y: a.offsetY } }), this.onMouseUp(a));
    };
  }
  setManager(a) {
    this.manager = a;
    a.on(ModelEvent.ENERGY_RADIUS, this.onEnergyRadiusChange.bind(this));
    a.on(ModelEvent.GAMEOBJECT_ADDED, this.onStaticObjectAddedBinding);
    a.on(ModelEvent.GAMEOBJECT_DELETED, this.onGameObjectRemoved.bind(this));
    a.on(ModelEvent.GAMEOBJECT_CONTACT, this.onGameObjectContact.bind(this));
    a.on(ModelEvent.UPDATE_LABEL, (b) => this.labelContainer.onUpdateLabel(b));
    a.on(ModelEvent.REMOVE_LABEL, (b) => this.labelContainer.onRemoveLabel(b));
    a.on(ModelEvent.AGENT_STATE, this.onAgentStateChange.bind(this));
    a.on(ModelEvent.CLEAR, this.onClear.bind(this));
    a.on(ModelEvent.PLAYER_SCORE, this.onPlayerScore.bind(this));
    a.on(ModelEvent.CREATE_EFFECT, (b) => this.fxMap[b.type](b));
    a.on(ModelEvent.UPDATE_ENVIRONMENT, this.onUpdateEnvironment.bind(this));
    a.on(ModelEvent.FOCUS, this.onFocus.bind(this));
    a.on(ModelEvent.PLAYER_DEATH, this.onPlayerDeath.bind(this));
    a.on(ModelEvent.PLAYER_COMBO, this.onPlayerCombo.bind(this));
  }
  onEnergyRadiusChange(a) {
    this.hasEnergyBoundary ||
      ((this.energyBoundary = new PIXI.Graphics()),
      this.energyBoundary.lineStyle(10, 0, 0, 0),
      this.energyBoundary.drawCircle(0, 0, 1e3),
      this.energyBoundary.endFill(),
      (this.energyBoundary.width = this.energyBoundary.height = 2 * this.energyBoundaryRadius),
      this.world.addChild(this.energyBoundary),
      (this.hasEnergyBoundary = !0));
    this.energyBoundaryRadius = a;
    this.energyBoundary.width = this.energyBoundary.height = 40 * a;
  }
  initDMVictoryAnimation(a) {
    this.zoomFunction = () => {
      5 > this.cam.scale
        ? ((this.cam.scale += 0.002),
          this.emit(CanvasEvent.SCALE, this.cam.scale),
          (this.parallax.scale.x = this.parallax.scale.y = 1))
        : (this.zoomFunction = null);
    };
    this.cam.target = a;
  }
  initCTFVictoryAnimation(a) {
    this.zoomFunction = () => {
      5 > this.cam.scale
        ? ((this.cam.scale += 0.002),
          this.emit(CanvasEvent.SCALE, this.cam.scale),
          (this.parallax.scale.x = this.parallax.scale.y = 1))
        : (this.zoomFunction = null);
    };
    this.cam.target = a;
  }
  endVictoryAnimation() {
    this.zoomFunction && (this.zoomFunction = null);
    this.cam.tracking = !1;
    this.cam.target = null;
    App.WindowResized = !0;
  }
  onUpdateEnvironment(a) {
    if (a) {
      var b = a.weather;
      a = a.gradient;
      this.setBackgroundGradient(a.topColor, a.bottomColor, a.topY, a.bottomY);
      this.setParallax(b);
      this.background.center(0, 0.5 * (parseInt(a.topY) - parseInt(a.bottomY)));
      this.background.draw(b.precipitation.type, parseInt(a.topColor, 16));
      a = this.background.parent.getChildIndex(this.background);
      var c = this.parallax.parent.getChildIndex(this.parallax);
      "stars" === b.precipitation.type
        ? c > a && this.background.parent.setChildIndex(this.background, c)
        : c < a && this.parallax.parent.setChildIndex(this.parallax, a);
    }
  }
  setBackgroundGradient(a, b, c, d) {
    this.gradient.minY = parseInt(d);
    this.gradient.maxY = parseInt(c);
    this.gradient.colors("#" + a, "#" + b);
  }
  setParallax(a) {
    this.parallax.initialize(a);
  }
  onPlayerDeath(a) {
    let b = a.victim;
    var c = a.killer;
    (a = a.local) &&
      c.sid === a &&
      b.sid !== a &&
      ((c = ParticleEffects.XP10),
      (c.origin = 4),
      (c.point = { x: b.p.x / PC.PM_RATIO, y: b.p.y / PC.PM_RATIO }),
      (c.n = 1),
      this.createEffect(c, b));
  }
  onPlayerCombo() {}
  initial() {
    this.manager.removeListener(ModelEvent.GAMEOBJECT_ADDED, this.onStaticObjectAddedBinding);
    this.manager.on(ModelEvent.GAMEOBJECT_ADDED, this.onGameObjectAddedBinding);
    this.processStaticBuffer();
  }
  onStaticObjectAdded(a) {
    let b = BaseSprite.Create(a);
    if (b && ((a.visual = b), a.update(), a.visual.update && a.visual.update(), a.at))
      for (let d = 0; d < a.at.length; d++) {
        var c = a.at[d];
        switch (c.type) {
          case GameAttribute.EMITTER:
            c = new ParticleEmitter(
              a,
              [ParticleEffects[c.et]],
              null,
              parseFloat(c.f),
              0,
              -1,
              parseFloat(c.p),
              parseFloat(c.w),
              parseFloat(c.h)
            );
            0 === a.p.type || 1 === a.p.type
              ? (void 0 === this.staticEmitters[a.id] && (this.staticEmitters[a.id] = []),
                this.staticEmitters[a.id].push({ go: a, emitter: c }))
              : this.addEmitter(a, c);
            break;
          case GameAttribute.LABEL:
            let e = new PIXI.BitmapText(c.text, {
              fontName: "Open Sans",
              fontSize: c.size,
              align: "left",
            });
            e.tint = parseInt(c.color, 16);
            e.anchor.x = 0.5;
            e.anchor.y = 0.5;
            b.addChild(e);
        }
      }
    this.addStaticObject(a);
  }
  onGameObjectAdded(a) {
    if (a.isPlayer) this.addPlayer(a);
    else {
      if (a.p.prefab) {
        a.visual = SpriteFactory.CreateSprite(a.g);
        a.update();
        if (void 0 !== a.g.emitters)
          for (var b = 0; b < a.g.emitters.length; b++) {
            var c = a.g.emitters[b];
            c.parent = a;
            this.addEmitter(a, c);
          }
        if (void 0 !== a.g.trails)
          for (b = 0; b < a.g.trails.length; b++) this.createRope(a, a.g.trails[b]);
      } else if ((b = BaseSprite.Create(a)))
        if (((a.visual = b), a.update(), a.visual.update && a.visual.update(), a.at))
          for (b = 0; b < a.at.length; b++)
            switch (((c = a.at[b]), c.type)) {
              case GameAttribute.EMITTER:
                let d = new ParticleEmitter(a, [ParticleEffects[c.et]]);
                d.probability = parseFloat(c.p);
                d.frequency = parseFloat(c.f);
                d.width = parseFloat(c.w);
                d.height = parseFloat(c.h);
                this.addEmitter(a, d);
            }
      this.addDynamicObject(a);
    }
    if (a.g.onAdd) this.onAddFX(a);
  }
  processStaticBuffer() {
    let a = this.staticBuffer.length;
    if (0 !== a) {
      this.fb = new Flatbush(a);
      for (var b = 0; b < a; b++) {
        var c = this.staticBuffer[b];
        let d = c.visual.x + c.bounds.x,
          e = c.visual.y + c.bounds.y;
        this.fb.add(d, e, d + c.bounds.width, e + c.bounds.height);
      }
      a = this.lineSegments.length;
      for (b = 0; b < a; b++)
        (c = this.lineSegments[b]),
          ParticleContainer.AddLineSegment(c),
          (1 !== c.l && 4 !== c.l) || this.addLineSegment(c);
      this.fb.finish();
      ParticleContainer.ProcessCollisionMesh();
    }
  }
  addPlayer(a) {
    for (let b = 0; 11 > b; b++) {
      let c = a.bodyparts[b];
      c.visual.z = 500 + b;
      this.addDynamicObject(c);
    }
    this.addDynamicObject(a);
    a.onRequestCreateRope = this.createRope.bind(this);
    a.onRequestCreateEffect = this.createEffect.bind(this);
    a.onRequestCreateEmitter = this.addEmitter.bind(this, a);
    a.onRequestRemoveEmitter = this.removeEmitter.bind(this, a);
    this.labelContainer.addLabel(a.id, a, a.torsoupper, {
      text: a.name,
      size: 14,
      alpha: 0.8,
      color: "#A8DBFB",
    });
    a.onSpawn();
    a.update(!0);
    a.isLocal && this.labelContainer.setVisibleTeam(a.team);
    this.players[a.id] = a;
  }
  addDynamicObject(a) {
    a.visual &&
      ((a.visual.layer = "_3"),
      (this.dynamicObjects[a.id] = a),
      this._3.addChild(a.visual),
      void 0 !== a.g.z && (a.visual.z = a.g.z),
      a.p.bullet || this.applyZIndex(a));
  }
  addStaticObject(a) {
    a.visual &&
      ((a.visual.layer = "_" + Math.ceil((a.g.z + 0.1) / 200)),
      (a.visual.z = a.g.z),
      this.staticBuffer.push(a));
    if (!a.p.s) {
      var b = BaseSprite.ExtractOutline(a);
      if (0 < b.length) {
        a = Math.ceil((a.g.z + 0.1) / 200);
        for (let c = 0; c < b.length; c++) {
          let d = b[c];
          d.l = a;
          this.isOverlappingLineSegment(d) || this.lineSegments.push(d);
        }
      }
    }
  }
  isOverlappingLineSegment(a, b = 16) {
    for (let c = 0, d = this.lineSegments.length; c < d; c++) {
      let e = this.lineSegments[c],
        f = e.x1 - a.x1,
        g = e.y1 - a.y1;
      if (f * f + g * g > b)
        if (((f = e.x1 + e.x2 - a.x1), (g = e.y1 + e.y2 - a.y1), f * f + g * g > b)) continue;
        else {
          if (((f = e.x1 - (a.x1 + a.x2)), (g = e.y1 - (a.y1 + a.y2)), f * f + g * g > b)) continue;
        }
      else if (
        ((f = e.x1 + e.x2 - (a.x1 + a.x2)), (g = e.y1 + e.y2 - (a.y1 + a.y2)), f * f + g * g > b)
      )
        continue;
      this.lineSegments.splice(c, 1);
      return !0;
    }
    return !1;
  }
  addLineSegment(a) {
    this._2.moveTo(a.x1, a.y1);
    this._2.lineTo(a.x2 + a.x1, a.y2 + a.y1);
  }
  onAgentStateChange(a) {
    let b = a.agent;
    a = a.state;
    switch (a.s) {
      case StateChange.Item.USE:
        this.onUseFX(b, a.t);
        if (b.primaryItem && b.primaryItem.onUse) b.primaryItem.onUse();
        break;
      case StateChange.Agent.ALIVE:
        if (!b.alive)
          for (let c in b.ragdoll)
            if (((a = b.ragdoll[c]), !a.attached)) {
              let d = new ParticleEmitter(null, [ParticleEffects.GoreTrail]);
              d.parent = a;
              d.probability = 0.3;
              d.ttl = 140 + Math.round(80 * Math.random());
              d.sub = [ParticleEffects.GoreTrailWater];
              this.addEmitter(a, d);
            }
    }
  }
  onPlayerScore(a) {
    a = a.player;
    let b = new ParticleEmitter(
      a,
      [ParticleEffects.CaptureObjectiveParticles],
      null,
      1,
      1,
      50,
      1,
      40,
      60
    );
    this.addEmitter(a, b);
  }
  onGameObjectRemoved(a) {
    if (a.g.onTrigger && a.triggered) this.onTriggerFX(a);
    if (a.g.onRemove) this.onRemoveFX(a);
    if (a.g.onRemoveContact) this.onRemoveContactFX(a);
    if (2 === a.p.type || 1 === a.p.type) {
      if (a.isPlayer) {
        let b = Date.now().toString();
        a.stopJetting();
        a.onDissolve();
        for (let c in a.ragdoll) {
          let d = a.ragdoll[c];
          delete this.emitters[d.id];
          delete this.dynamicObjects[d.id];
          let e = d.id + b;
          d.id = e;
          this.dynamicObjects[e] = d;
          this.dissolve.push(d);
          this.addEmitter(
            d,
            new ParticleEmitter(
              d,
              [ParticleEffects.Dissolve, ParticleEffects.DissolveElectric],
              null,
              4,
              1,
              100,
              0.5,
              0,
              0,
              16777215,
              1
            )
          );
        }
        delete this.players[a.id];
      }
      this.removeDynamicObject(a);
    } else this.removeStaticObject(a);
  }
  onGameObjectContact(a) {
    let b = a.contact;
    a = a.go;
    if (
      a.g.onContact &&
      (a.g.onRemoveContact && (a.g.onRemoveContact = null),
      this.onContactFX(a, b),
      a.g.hideOnContact && (this.dynamicObjects[a.id].visual.alpha = 0),
      a.contact && a.contact.damage)
    ) {
      if (void 0 !== b.a.body._parent) {
        var c = this.dynamicObjects[b.a.body._parent];
        var d = b.a.ref.id;
      } else
        void 0 !== b.b.body._parent &&
          ((c = this.dynamicObjects[b.b.body._parent]), (d = b.b.ref.id));
      if (void 0 !== c) {
        if (a.g.onImpact)
          for (let e = 0, f = a.g.onImpact.length; e < f; e++) {
            let g = a.g.onImpact[e];
            g.parent = c.ragdoll[d];
            this.addEmitter(g.parent, g);
          }
        if (void 0 !== b.o && void 0 !== b.tr && b.o.team !== b.tr.team && (c = c.addInjury(d, 0)))
          for (d = 0; d < c.length; d++) this.addEmitter(c[d].parent, c[d]);
      }
    }
    a.isPlayer &&
      ((c = ParticleEffects.BounceImpact),
      (c.origin = 4),
      (c.point = b.p),
      (c.n = 3),
      this.createEffect(c, a));
  }
  addEmitter(a, b) {
    if (a && !b.attached) {
      if (void 0 !== b.id)
        if (void 0 === a.g.emitterIds) a.g.emitterIds = [b.id];
        else if (-1 !== a.g.emitterIds.indexOf(b.id)) return;
      b.attached = !0;
      var c = this.emitters[a.id];
      c || ((c = this.emitters[a.id] = []), (c.id = a.id));
      c.push(b);
    }
  }
  updateEmitters(a) {
    let b = this.emitters[a.id],
      c = 0;
    if (b) {
      let d = b.length;
      for (; 0 < d; ) {
        let e = b[--d];
        if (-1 !== e.ttl && 0 === e.ttl)
          b.splice(d, 1),
            void 0 !== e.id && a.g.emitterIds.splice(a.g.emitterIds.indexOf(e.id), 1),
            c++,
            0 === b.length && delete this.emitters[a.id];
        else if ((e.ttl--, e.count++ === e.frequency)) {
          e.count = 0;
          let f = e.sub ? (e.parent.p.sub ? e.sub : e.emits) : e.emits;
          if (void 0 !== f.length)
            for (let g = 0; g < f.length; g++) {
              if (1 > e.probability && e.probability < Math.random()) continue;
              let h = f[g];
              h.offset = e.area
                ? {
                    x: e.offset.x - 0.5 * e.width + Math.random() * e.width,
                    y: e.offset.y - 0.5 * e.height + Math.random() * e.height,
                  }
                : e.offset;
              void 0 !== e.tint && (h.tt = e.tint);
              this.createEffect(h, e.parent);
            }
          else
            (f.offset = e.area
              ? {
                  x: e.offset.x - 0.5 * e.width + Math.random() * e.width,
                  y: e.offset.y - 0.5 * e.height + Math.random() * e.height,
                }
              : e.offset),
              void 0 !== e.tint && (f.tt = e.tint),
              this.createEffect(f, e.parent);
        }
      }
    }
    return c;
  }
  removeEmitter(a, b) {
    let c = this.emitters[a.id];
    c &&
      (void 0 !== b.id && a.g.emitterIds.splice(a.g.emitterIds.indexOf(b.id), 1),
      (b.attached = !1),
      (b = c.indexOf(b)),
      c.splice(b, 1),
      0 === c.length && delete this.emitters[a.id]);
  }
  requestLocalObject(a, b) {
    var c = { l: a.local };
    a.p1
      ? ((c.p1 = a.p1), (c.p2 = a.p2))
      : (a.exp && (c.exp = a.exp), (c.x = b.p.x / PC.PM_RATIO), (c.y = b.p.y / PC.PM_RATIO));
    if (a.randV) {
      let d = a.randV;
      c.vx = d.minX + Math.random() * d.rangeX;
      c.vy = d.minY + Math.random() * d.rangeY;
    }
    c = { ttl: a.ttl, pr: a.prefab, p: c };
    a.type && ((c.type = a.type), (c.id = b.id));
    this.emit(CanvasEvent.REQUEST_LOCAL_OBJECT, c);
  }
  onSubmerge(a) {
    let b = a.go;
    if (a.splash && !a.ss) {
      a = ParticleEffects.WaterSplash;
      for (let c = 0; 4 > c; c++)
        (a.origin = 4),
          (a.point = { x: b.p.x / PC.PM_RATIO, y: (b.p.y + (b.isPlayer ? 20 : 0)) / PC.PM_RATIO }),
          (a.n = 1),
          this.createEffect(a, b);
    }
    if (void 0 !== b.p.prefab || b.isPlayer)
      (a = new ParticleEmitter(b, [ParticleEffects.WaterBubbles], null, 1, 1, -1, 1, 30, 30)),
        void 0 === b._bubbles && ((b._bubbles = a), this.addEmitter(b, a));
  }
  onSurface(a) {
    let b = a.go;
    if (a.splash) {
      a = ParticleEffects.WaterSplashExit;
      for (let c = 0; 4 > c; c++)
        (a.origin = 4),
          (a.point = {
            x: (b.p.x - 0.2 * b.p.vx) / PC.PM_RATIO,
            y: (b.p.y + (b.isPlayer ? 20 : 0) - 0.2 * b.p.vy) / PC.PM_RATIO,
          }),
          (a.n = 3),
          this.createEffect(a, b);
    }
    void 0 !== b._bubbles && (this.removeEmitter(b, b._bubbles), delete b._bubbles);
  }
  punchFx(a) {
    let b = a.go,
      c = a.point;
    a = a.c;
    a === EntityCategory.LIMB || a === EntityCategory.LOCAL || a === EntityCategory.AGENT
      ? ((a = b.p.sub ? ParticleEffects.GoreTrailWater : ParticleEffects.Bloodsplat3),
        (a.origin = 4),
        (a.point = c),
        (a.n = 3),
        this.createEffect(a, b),
        (a.origin = void 0),
        (a.point = void 0),
        (a.n = 1))
      : ((a = ParticleEffects.PunchImpact), (a.origin = 4), (a.point = c), this.createEffect(a, b));
  }
  explosionFx(a) {
    let b = a.go;
    a.exp.p.exp.mod
      ? this.addEmitter(b, new ParticleEmitter(b, [ParticleEffects.Plasma1], null, 1, 1, 200, 0.2))
      : (this.addEmitter(
          b,
          new ParticleEmitter(
            b,
            [ParticleEffects.SmokeTrail2],
            null,
            4,
            1,
            200,
            0.2,
            0,
            0,
            16777215,
            1
          )
        ),
        b.p.sub ||
          this.addEmitter(
            b,
            new ParticleEmitter(
              b,
              [ParticleEffects.FlameTrail2],
              null,
              4,
              1,
              200,
              0.2,
              0,
              0,
              16777215,
              2
            )
          ));
  }
  sawFx(a) {
    let b = a.go,
      c = a.point;
    var d = a.c;
    d === EntityCategory.LIMB || d === EntityCategory.LOCAL || d === EntityCategory.AGENT
      ? ((a = b.p.sub ? ParticleEffects.GoreTrailWater : ParticleEffects.Bloodsplat3),
        (a.origin = 4),
        (a.point = c),
        (a.n = 10),
        this.createEffect(a, b),
        (a.origin = void 0),
        (a.point = void 0),
        (a.n = 1))
      : ((d = a.normal),
        (a = ParticleEffects.ChainsawSparks),
        (a.origin = 4),
        (a.point = c),
        this.createEffect(a, b),
        (a = ParticleEffects.ChainsawSparks2),
        (a.origin = 4),
        (a.point = c),
        (a.nx = d.x * a.nm),
        (a.ny = d.y * a.nm),
        this.createEffect(a, b));
  }
  linkGunFx(a) {
    let b = a.go;
    var c = a.point,
      d = a.c;
    a.impact &&
      (d === EntityCategory.LIMB || d === EntityCategory.LOCAL || d === EntityCategory.AGENT
        ? ((d = b.p.sub ? ParticleEffects.GoreTrailWater : ParticleEffects.Bloodsplat3),
          (d.origin = 4),
          (d.point = c),
          (d.n = 10),
          this.createEffect(d, b),
          (d.n = 1),
          (d.origin = void 0),
          (d.point = void 0),
          (d = ParticleEffects.LinkGunRayImpact),
          (d.origin = 4),
          (d.point = c),
          this.createEffect(d, b),
          (d.origin = void 0),
          (d.point = void 0),
          (d.n = 1),
          a.target &&
            this.addEmitter(
              a.target,
              new ParticleEmitter(a.target, [ParticleEffects.PlasmaElectric], null, 1, 1, 200, 0.2)
            ))
        : ((d = ParticleEffects.LinkGunRayImpact),
          (d.origin = 4),
          (d.point = c),
          this.createEffect(d, b),
          (d.origin = void 0),
          (d.point = void 0)));
    c = b.id + "_lg";
    a.origin.x += (0.3 * b.p.vx) / 20;
    a.origin.y += (0.3 * b.p.vy) / 20;
    this.createLinkGunBeam(c, a.origin, a.point, a.impact);
  }
  createRope(a, b = null, c = null) {
    let d, e;
    a &&
      ((d =
        null === b
          ? new FastRope(App.CombinedTextures[b.FX.tex], a)
          : new b(App.CombinedTextures[b.FX.tex], a)),
      (e = null === c ? a.id : c));
    this.ropes[e] = d;
    this._3.addChild(d);
    return d;
  }
  createLinkGunBeam(a, b, c, d) {
    let e = c.x - b.x;
    c = c.y - b.y;
    var f = Math.sqrt(e * e + c * c);
    if (void 0 === this.ropes[a]) {
      var g = [];
      for (var h = 0; 16 > h; h++) {
        var k = new PIXI.Point(
          20 * b.x + ((20 * e) / 16) * h * 1.1,
          20 * b.y + ((20 * c) / 16) * h * 1.1
        );
        g.push(k);
      }
      a = this.ropes[a] = new PIXI.SimpleRope(App.CombinedTextures.ray_gun_beam, g, -1);
      a.alpha = 1.1;
      a.alphaDrop = 0.1;
      a.ttl = 10;
      this._3.addChild(a);
    } else a = this.ropes[a];
    f = 1 * f + 1;
    for (g = 0; 16 > g; g++)
      (k = h = 0),
        0 === g ||
          (15 === g && d) ||
          ((h = 0.5 * -f + Math.random() * f), (k = 0.5 * -f + Math.random() * f)),
        (k = 20 * b.y + ((20 * c) / 16) * g * 1.0625 + k),
        (a.geometry.points[g].x = 20 * b.x + ((20 * e) / 16) * g * 1.0625 + h),
        (a.geometry.points[g].y = k);
  }
  createEffect(a, b, c) {
    a[PP.DYNAMIC_ALT] &&
      this.dynamicObjects[c.a.body.m_userData] &&
      this.dynamicObjects[c.b.body.m_userData] &&
      (a = a[PP.DYNAMIC_ALT]);
    if (b) {
      if (a[PP.CAM_SHAKE] && (a[PP.GLOBAL] || b.isLocal)) {
        var d = b.p.x + (this.cam.x - 0.5 * App.ClientWidth),
          e = b.p.y + (this.cam.y - 0.5 * App.ClientHeight);
        d * d + e * e < App.ClientWidth * App.ClientWidth && this.cam.shake(a[PP.CAM_SHAKE]);
      }
      a[PP.CAM_JERK] && (a[PP.GLOBAL] || b.isLocal) && this.cam.jerk(a[PP.CAM_JERK], b.facing);
      if (App.HasFocus && (!b || b.visual.parent))
        if (
          (a[PP.AMOUNT_RANDOM] &&
            (a[PP.AMOUNT] =
              a[PP.AMOUNT_RANDOM].min +
              Math.random() * (a[PP.AMOUNT_RANDOM].max - a[PP.AMOUNT_RANDOM].min)),
          a[PP.LOCAL])
        )
          for (
            c = a[PP.TYPE],
              "linkgun" === c || "saw" === c
                ? ((c = -b.getWeaponRotation()),
                  (d = b.getPrimaryAnchor(a.origin)),
                  (a.p1 = {
                    x: (-this.cam.x + d.x / 1 / this.cam.scale) / PC.PM_RATIO,
                    y: (-this.cam.y + d.y / 1 / this.cam.scale) / PC.PM_RATIO,
                  }),
                  (a.p2 = {
                    x: a.p1.x + (a.delta * Math.cos(c)) / PC.PM_RATIO,
                    y: a.p1.y + (a.delta * Math.sin(c)) / PC.PM_RATIO,
                  }))
                : "exp" === c
                ? (a.exp = b.p.explosive)
                : "punch" === c &&
                  ((c = b.facing + Math.PI),
                  (d = b.getPrimaryAnchor(a.origin)),
                  (a.p1 = {
                    x: (-this.cam.x + d.x / 1 / this.cam.scale) / PC.PM_RATIO,
                    y: (-this.cam.y + d.y / 1 / this.cam.scale) / PC.PM_RATIO,
                  }),
                  (a.p2 = {
                    x: a.p1.x + (a.delta * Math.cos(c) * 0.25) / PC.PM_RATIO,
                    y: a.p1.y + (a.delta * Math.sin(c) * 0.25) / PC.PM_RATIO,
                  })),
              c = a[PP.AMOUNT];
            0 < c--;

          )
            this.requestLocalObject(a, b);
        else {
          if (a[PP.ORIGIN])
            if (((d = a[PP.ORIGIN]), 1 === d || 2 === d))
              (d = b.getPrimaryAnchor(d)),
                (a.x = -this.cam.x + d.x / 1 / this.cam.scale + 0.24 * b.p.vx),
                (a.y = -this.cam.y + d.y / 1 / this.cam.scale + 0.24 * b.p.vy);
            else if (4 === d) (a.x = a.point.x * PC.PM_RATIO), (a.y = a.point.y * PC.PM_RATIO);
            else if (3 === d) {
              e = a[PP.ANCHOR_RELATIVE].x;
              let f = a[PP.ANCHOR_RELATIVE].y;
              d = Math.sqrt(e * e + f * f);
              0 !== d
                ? ((e = Math.atan2(f, e)),
                  (a.x = b.p.x + d * Math.cos(e + b.visual.rotation)),
                  (a.y = b.p.y + d * Math.sin(e + b.visual.rotation)))
                : ((a.x = b.p.x), (a.y = b.p.y));
            } else
              c
                ? ((a.x = c.p.x * PC.PM_RATIO), (a.y = c.p.y * PC.PM_RATIO))
                : b && ((a.x = b.p.x), (a.y = b.p.y));
          else
            c
              ? ((a.x = c.p.x * PC.PM_RATIO), (a.y = c.p.y * PC.PM_RATIO))
              : b && ((a.x = b.p.x), (a.y = b.p.y));
          a.offset && ((a.x += a.offset.x), (a.y += a.offset.y));
          switch (a[PP.VELOCITY]) {
            case 1:
              a.vx = -b.p.vx * (a[PP.VELOCITY_MULTIPLIER] || 0);
              a.vy = -b.p.vy * (a[PP.VELOCITY_MULTIPLIER] || 0);
              break;
            case 2:
              a.vx = a.vy = 0;
              break;
            case 3:
              a.vx = a[PP.VELOCITY_MULTIPLIER] * Math.cos(-b.getWeaponRotation()) + 0.24 * b.p.vx;
              a.vy = a[PP.VELOCITY_MULTIPLIER] * Math.sin(-b.getWeaponRotation()) + 0.24 * b.p.vy;
              break;
            case 4:
              c =
                Math.sqrt(b.p.vx * b.p.vx + b.p.vy * b.p.vy) *
                (Math.random() + 0.5) *
                a[PP.VELOCITY_MULTIPLIER];
              a.vx = -1.5 + 3 * Math.random();
              a.vy = (3 > c ? 3 : c) * (0 > b.p.vy ? 1 : -1);
              break;
            case 5:
              a.vx = b.p.vx * (a[PP.VELOCITY_MULTIPLIER] || 0);
              a.vy = b.p.vy * (a[PP.VELOCITY_MULTIPLIER] || 0);
              break;
            case 6:
              c = a[PP.DELTA_RANDOM]
                ? a[PP.DELTA_RANDOM].min +
                  Math.random() * (a[PP.DELTA_RANDOM].max - a[PP.DELTA_RANDOM].min)
                : a.d;
              a.vx = c * Math.cos(b.visual.rotation - 0.5 * Math.PI);
              a.vy = c * Math.sin(b.visual.rotation - 0.5 * Math.PI);
              break;
            case 7:
              c = Math.sqrt(b.p.vx * b.p.vx + b.p.vy * b.p.vy) * a[PP.VELOCITY_MULTIPLIER];
              d = Math.atan2(b.p.vy, b.p.vx);
              3 > c && (c = 3);
              a.vx = c * Math.cos(d + (-0.4 + 0.8 * Math.random()));
              a.vy = c * Math.sin(d + (-0.4 + 0.8 * Math.random()));
              break;
            case 8:
              c && c.normal
                ? ((a.vx = c.normal.x), (a.vy = c.normal.y))
                : ((a.vx = a.nx), (a.vy = a.ny));
              a[PP.NORMAL_MULTIPLIER] &&
                ((a.vx *= a[PP.NORMAL_MULTIPLIER]), (a.vy *= a[PP.NORMAL_MULTIPLIER]));
              break;
            case 9:
              a.vx = -a[PP.VELOCITY_MULTIPLIER] * Math.cos(-b.getWeaponRotation()) + 0.24 * b.p.vx;
              a.vy = -a[PP.VELOCITY_MULTIPLIER] * Math.sin(-b.getWeaponRotation()) + 0.24 * b.p.vy;
              break;
            case 10:
              a.vx =
                2 * Math.cos(b.p.r - 0.5 * Math.PI + (-0.3 + 0.6 * Math.random())) + b.p.vx / 7;
              a.vy =
                2 * Math.sin(b.p.r - 0.5 * Math.PI + (-0.3 + 0.6 * Math.random())) + b.p.vy / 7;
              a.x -= b.p.vx / 7;
              a.y -= b.p.vy / 7;
              break;
            case 11:
              c = Math.atan2(a.offset.y, a.offset.x);
              a.vx = -1 * Math.cos(c) + b.p.vx / 5;
              a.vy = -0.5 * Math.sin(c) + b.p.vy / 5;
              a.x -= b.p.vx / 5;
              a.y -= b.p.vy / 5;
              break;
            case 12:
              c = Math.atan2(a.offset.y, a.offset.x);
              a.vx = 5 * Math.cos(c) + b.p.vx / 5;
              a.vy = 5 * Math.sin(c) + b.p.vy / 5;
              a.x -= b.p.vx / 5;
              a.y -= b.p.vy / 5;
              break;
            default:
              void 0 !== a[PP.EJECTION_DELTA]
                ? ((c = -a[PP.EJECTION_ANGLE] + Math.random() * a[PP.EJECTION_ANGLE] * 2),
                  (d =
                    a[PP.EJECTION_DELTA].min +
                    Math.random() * (a[PP.EJECTION_DELTA].max - a[PP.EJECTION_DELTA].min)),
                  (e =
                    b.getWeaponRotation() +
                    (b.facingDir === Player.FACING_LEFT ? 1.5 * Math.PI : 0.5 * Math.PI)),
                  (a.vx = d * Math.cos(e + c) + b.p.vx / PC.PM_RATIO),
                  (a.vy = d * -Math.sin(e + c) + b.p.vy / PC.PM_RATIO))
                : (a.vx = a.vy = 0);
          }
          switch (a[PP.ROTATION]) {
            case 1:
              a.r = Math.atan2(b.p.vy, b.p.vx);
              break;
            case 2:
              a.r = Math.random() * Math.PI * 2;
              break;
            case 3:
              a.r = -b.getWeaponRotation();
              break;
            case 4:
              a.r = -b.getWeaponRotation() + 0.5 * Math.PI;
              break;
            case 5:
              a.r = -b.getWeaponRotation() + Math.PI;
              break;
            case 6:
              a.r = b.p.r;
              break;
            case 7:
              a.r = b.visual.lastRotation;
          }
          a[PP.ANGULAR_RANDOM] &&
            (a[PP.ANGULAR] = a[PP.ANGULAR_RANDOM].min + Math.random() * a[PP.ANGULAR_RANDOM].max);
          a[PP.SCALE_FACTOR] &&
            (a.s = Math.sqrt(b.p.vx * b.p.vx + b.p.vy * b.p.vy) * a[PP.SCALE_FACTOR]);
          a[PP.APPEAR] && (a.appear = a[PP.APPEAR]);
          if (a[PP.FOREGROUND]) {
            if (
              (this.fgParticleContainer.spawn(a, a[PP.AMOUNT]),
              a[PP.FILTERS] && !1 !== this.settings.graphics.shockwaveFx)
            )
              for (c = a[PP.FILTERS].length; 0 < c; )
                (d = new a[PP.FILTERS][--c](
                  new PIXI.Point(b.visual.x + this.cam.x, b.visual.y + this.cam.y)
                )),
                  (d.radius = 200 * this.cam.scale),
                  (d.origin = { x: b.visual.x, y: b.visual.y }),
                  this.addFilter(d);
          } else this.bgParticleContainer.spawn(a, a[PP.AMOUNT]);
        }
    }
  }
  onContactFX(a, b) {
    var c;
    let d;
    void 0 !== b.a.body._parent
      ? (c = this.dynamicObjects[b.a.body._parent])
      : void 0 !== b.b.body._parent && (c = this.dynamicObjects[b.b.body._parent]);
    void 0 !== c && c.g.onImpact
      ? ((d = c.g.onImpact),
        c.p.sub
          ? a.g.onAgentContactSubmerged && (d = d.concat(a.g.onAgentContactSubmerged))
          : a.g.onAgentContact && (d = d.concat(a.g.onAgentContact)))
      : (d = a.g.onContact);
    for (c = 0; c < d.length; c++) this.createEffect(d[c], a, b);
  }
  onAddFX(a) {
    let b = a.g.onAdd;
    for (let c = 0; c < b.length; c++) this.createEffect(b[c], a);
  }
  onRemoveFX(a) {
    if (!a.triggered) {
      let b = a.g.onRemove;
      for (let c = 0; c < b.length; c++) this.createEffect(b[c], a);
    }
  }
  onRemoveContactFX(a) {
    let b = a.g.onRemoveContact;
    for (let c = 0; c < b.length; c++) this.createEffect(b[c], a);
  }
  onTriggerFX(a) {
    let b = a.g.onTrigger;
    for (let c = 0; c < b.length; c++) this.createEffect(b[c], a);
  }
  onUseFX(a, b) {
    if ((b = ItemMap[b])) {
      b = b.onUse.visual;
      for (let c = 0; c < b.length; c++) this.createEffect(b[c], a);
    }
  }
  removeStaticObject(a) {
    a.visual && a.visual.parent && this[a.visual.layer].removeChild(a.visual);
  }
  removeDynamicObject(a) {
    void 0 !== this.emitters[a.id] && delete this.emitters[a.id];
    a.visual && a.visual.parent && this._3.removeChild(a.visual);
    delete this.dynamicObjects[a.id];
  }
  getCamera() {
    return this.cam;
  }
  updateCameraPosition() {
    let a = 0;
    var b = 0;
    if (this.cam.target) {
      var c = this.dynamicObjects[this.cam.target];
      c &&
        ((b = -c.p.y + (App.ClientHeight - this.mouse.y) / this.cam.scale),
        (a = 0.2 * (-c.p.x + (App.ClientWidth - this.mouse.x) / this.cam.scale - this.cam.x)),
        (b = 0.2 * (b - this.cam.y)));
    } else {
      let d = App.TransformedMouseX - (App.ClientWidth / this.cam.scale) * 0.5,
        e = App.TransformedMouseY - (App.ClientHeight / this.cam.scale) * 0.5;
      c = Math.sqrt(d * d + e * e);
      100 < c &&
        ((b = Math.atan2(e, d)), (a = -c * Math.cos(b) * 0.04), (b = -c * Math.sin(b) * 0.04));
    }
    this.cam.x += a;
    this.cam.y += b;
  }
  applyZIndex(a) {
    let b = a.visual.z,
      c = this[a.visual.layer],
      d = c.children.length,
      e = d - 1;
    for (; 0 < e && c.children[e - 1].z > b; ) e--;
    e < d - 1 && c.setChildIndex(a.visual, e);
  }
  update(a) {
    if (App.WindowResized) {
      var b = App.ClientWidth > App.ClientHeight ? 1920 / App.ClientWidth : 1080 / App.ClientHeight;
      this.cam.scale = 1.6 / b;
      this.emit(CanvasEvent.SCALE, this.cam.scale);
      this.parallax.scale.x = this.parallax.scale.y = 1;
      App.WindowResized = !1;
      this.parallax.distribute();
      this.gradient.resize(App.ClientWidth * b, App.ClientHeight * b);
    }
    this.frameCount++;
    this.updateCameraPosition();
    this.world.filters && this.updateFilters(a);
    if (a) null !== this.zoomFunction && this.zoomFunction();
    else {
      for (var c in this.emitters)
        (a = this.dynamicObjects[c] || this.emitters[c][0].parent),
          a.visual.parent && this.updateEmitters(a);
      this.bgParticleContainer.update();
      this.fgParticleContainer.update();
      this.cam.shaking && this.cam.shake();
    }
    for (var d in this.ropes)
      (c = this.ropes[d]),
        0 === c.ttl ? (this._3.removeChild(c), delete this.ropes[d]) : (c.alpha -= c.alphaDrop),
        void 0 !== c.update && c.update(),
        c.ttl--;
    this.world.x = this.cam.x * this.cam.scale;
    this.world.y = this.cam.y * this.cam.scale;
    this.parallax.update(this.cam);
    this.background.update(this.cam);
    this.labelContainer.update(
      this.cam,
      this.mouse.x / this.cam.scale,
      this.mouse.y / this.cam.scale
    );
    if (null !== this.fb) {
      d = this.fb.search(
        -this.cam.x - 40,
        -this.cam.y - 40,
        -this.cam.x + 40 + App.ClientWidth / this.cam.scale,
        -this.cam.y + 40 + App.ClientHeight / this.cam.scale
      );
      for (let f = 0, g = this.displayed.length; f < g; f++)
        if (((a = this.displayed[f]), (c = this.staticBuffer[a]), -1 === d.indexOf(a))) {
          if (c.visual.parent) {
            if (this.staticEmitters[c.id]) {
              a = this.staticEmitters[c.id];
              b = a.length;
              for (var e = 0; e < b; e++) this.removeEmitter(c, a[e].emitter);
            }
            this[c.visual.layer].removeChild(c.visual);
          }
        } else if (c.visual.parent) c.g.updateUniforms && (c.visual.shader.uniforms.t += 1);
        else if (
          (this[c.visual.layer].addChild(c.visual),
          c.p.prefab || this.applyZIndex(c),
          this.staticEmitters[c.id])
        )
          for (a = this.staticEmitters[c.id], b = a.length, e = 0; e < b; e++)
            (a[e].emitter.attached = !1), this.addEmitter(c, a[e].emitter);
      this.displayed = d;
    }
    if (0 < this.dissolve.length)
      for (d = 0; d < this.dissolve.length; d++)
        (c = this.dissolve[d]),
          (c.visual.y -= 0.1),
          (c.visual.alpha -= 0.01),
          0.01 > c.visual.alpha && (this.removeDynamicObject(c), this.dissolve.splice(d, 1), d--);
  }
  addFilter(a) {
    let b = this.world.filters;
    this.world.filters = b ? b.concat([a]) : [a];
  }
  updateFilters(a) {
    let b = this.world.filters,
      c = b.length;
    for (; 0 < c; ) {
      let d = b[--c];
      if (void 0 !== d.time && !a)
        if (1 > d.time) d.time += 0.05;
        else {
          this.removeFilter(c);
          break;
        }
      d.center &&
        ((d.center.x = 1 * (d.origin.x + this.cam.x) * this.cam.scale),
        (d.center.y = 1 * (d.origin.y + this.cam.y) * this.cam.scale));
    }
  }
  removeFilter(a) {
    1 >= this.world.filters.length ? (this.world.filters = null) : this.world.filters.splice(a, 1);
  }
  onRightDown() {
    this.rightdown = !0;
    App.UIVisible || this.emit(CanvasEvent.RIGHT_DOWN);
  }
  onRightUp() {
    this.rightdown = !1;
    App.UIVisible || this.emit(CanvasEvent.RIGHT_UP);
  }
  onMouseDown(a) {
    App.UIVisible || this.emit(CanvasEvent.MOUSE_DOWN);
  }
  onMouseUp(a) {
    this.emit(CanvasEvent.MOUSE_UP);
  }
  onMouseMove(a) {
    this.mousePositionFromEvent(a);
    this.emit(CanvasEvent.MOUSE_MOVE, this.mouse);
  }
  mousePositionFromNormalizedVector(a, b = 0.35) {
    let c = 0.5 * App.ClientWidth + a.x * App.ClientWidth * b;
    a = 0.5 * App.ClientHeight + a.y * App.ClientWidth * b;
    this.mouse.x = c;
    this.mouse.y = a;
    App.TransformedMouseX = c / this.cam.scale;
    App.TransformedMouseY = a / this.cam.scale;
  }
  mousePositionFromEvent(a) {
    this.mouse.x = a.data.global.x;
    this.mouse.y = a.data.global.y;
    App.TransformedMouseX = this.mouse.x / this.cam.scale;
    App.TransformedMouseY = this.mouse.y / this.cam.scale;
  }
  isTouchEvent(a) {
    return void 0 !== a.data && "touch" === a.data.pointerType;
  }
  onClear() {
    this.bgParticleContainer.clear();
    this.fgParticleContainer.clear();
    this.world.filters = [];
    this.labelContainer.clear();
    this.emitters = {};
    this.background.clear();
    this._2.clear();
    this._2.lineStyle(3, 0, 0.2);
    this._1.children.forEach((a) => a.destroy({ children: !0 }));
    this._2.children.forEach((a) => a.destroy({ children: !0 }));
    this._3.children.forEach((a) => a.destroy({ children: !0 }));
    this._4.children.forEach((a) => a.destroy({ children: !0 }));
    this._5.children.forEach((a) => a.destroy({ children: !0 }));
    this._1.removeChildren();
    this._2.removeChildren();
    this._3.removeChildren();
    this._4.removeChildren();
    this._5.removeChildren();
    this.displayed = [];
    this.dynamicObjects = {};
    this.emitters = {};
    this.players = {};
    this.ropes = {};
    this.dissolve = [];
    BaseSprite.MeshIDMap = {};
    BaseSprite.MeshIDGroups = [];
    this.staticEmitters = {};
    this.parallax.clear();
    this.staticBuffer = [];
    this.lineSegments = [];
    this.fb = null;
    this.manager.on(ModelEvent.GAMEOBJECT_ADDED, this.onStaticObjectAddedBinding);
    this.manager.removeListener(ModelEvent.GAMEOBJECT_ADDED, this.onGameObjectAddedBinding);
  }
  onFocus() {}
}
var canvasevent = {};
function CanvasEvent(a, b) {
  CustomEvent.call(this, a, b);
}
CanvasEvent.MOUSE_DOWN = "c_md";
CanvasEvent.MOUSE_UP = "c_mu";
CanvasEvent.MOUSE_MOVE = "c_m";
CanvasEvent.RIGHT_DOWN = "c_rd";
CanvasEvent.RIGHT_UP = "c_ru";
CanvasEvent.REQUEST_LOCAL_OBJECT = "c_rlo";
CanvasEvent.SCALE = "c_sc";
var energydragon = {};
class EnergyDragon extends PIXI.Sprite {
  constructor(a, b, c, d) {
    super();
    this.target = a;
    this.trail = { ...ParticleEffects.EnergyDragonball };
    this.tint = this.trail.tt = d;
    this.theta = 0;
    this.torsoloweremitter1 = new ParticleEmitter(this.target.torsolower, this.trail);
    this.torsoloweremitter2 = new ParticleEmitter(this.target.torsolower, this.trail);
    this.torsoloweremitter3 = new ParticleEmitter(this.target.torsolower, this.trail);
    this.emitter = [this.torsoloweremitter1, this.torsoloweremitter2, this.torsoloweremitter3];
  }
  update(a) {
    this.theta += 0 > this.target.p.vx ? -0.15 : 0.15;
    this.torsoloweremitter1.offset.x = 35 * Math.cos(this.theta);
    this.torsoloweremitter1.offset.y = 35 * Math.sin(this.theta);
    this.torsoloweremitter2.offset.x = 35 * Math.cos(this.theta + Math.PI / 1.5);
    this.torsoloweremitter2.offset.y = 35 * Math.sin(this.theta + Math.PI / 1.5);
    this.torsoloweremitter3.offset.x = 35 * Math.cos(this.theta + Math.PI / 0.75);
    this.torsoloweremitter3.offset.y = 35 * Math.sin(this.theta + Math.PI / 0.75);
    AudioManager.PlayEffect(AudioEffects.Fly, this.target);
  }
}
EnergyDragon.Material = {};
EnergyDragon.ID = "dragon";
var energyjetfeet = {};
class EnergyJetFeet extends PIXI.Sprite {
  constructor(a, b, c, d) {
    super();
    this.target = a;
    this.trail = { ...ParticleEffects.EnergyJetFeet };
    this.tint = this.trail.tt = d;
    this.leftlegemitter = new ParticleEmitter(this.target.legleftlower, [this.trail]);
    this.rightlegemitter = new ParticleEmitter(this.target.legrightlower, [this.trail]);
    this.emitter = [this.leftlegemitter, this.rightlegemitter];
  }
  update(a) {
    this.leftlegemitter.offset.x =
      10 * Math.cos(this.target.legleftlower.visual.rotation - 0.5 * Math.PI);
    this.leftlegemitter.offset.y =
      10 * Math.sin(this.target.legleftlower.visual.rotation - 0.5 * Math.PI);
    this.rightlegemitter.offset.x =
      10 * Math.cos(this.target.legrightlower.visual.rotation - 0.5 * Math.PI);
    this.rightlegemitter.offset.y =
      10 * Math.sin(this.target.legrightlower.visual.rotation - 0.5 * Math.PI);
    AudioManager.PlayEffect(AudioEffects.EnergyJetFeet, this.target);
  }
}
EnergyJetFeet.Material = {};
EnergyJetFeet.ID = "jetfeet";
var energyjetfeet2 = {};
class EnergyJetFeet2 extends PIXI.Sprite {
  constructor(a, b, c, d) {
    super();
    this.target = a;
    this.trail = { ...ParticleEffects.EnergyJetFeet2 };
    this.tint = this.trail.tt = d;
    this.leftlegemitter = new ParticleEmitter(this.target.legleftlower, [
      this.trail,
      ParticleEffects.EnergyJetGlow,
    ]);
    this.rightlegemitter = new ParticleEmitter(this.target.legrightlower, [
      this.trail,
      ParticleEffects.EnergyJetGlow,
    ]);
    this.emitter = [this.leftlegemitter, this.rightlegemitter];
  }
  update(a) {
    this.leftlegemitter.offset.x =
      8 * Math.cos(this.target.legleftlower.visual.rotation - 0.5 * Math.PI);
    this.leftlegemitter.offset.y =
      8 * Math.sin(this.target.legleftlower.visual.rotation - 0.5 * Math.PI);
    this.rightlegemitter.offset.x =
      8 * Math.cos(this.target.legrightlower.visual.rotation - 0.5 * Math.PI);
    this.rightlegemitter.offset.y =
      8 * Math.sin(this.target.legrightlower.visual.rotation - 0.5 * Math.PI);
    AudioManager.PlayEffect(AudioEffects.EnergyJetFeet, this.target);
  }
}
EnergyJetFeet2.Material = {};
EnergyJetFeet2.ID = "jetfeet2";
var energyvacuum = {};
class EnergyVacuum extends PIXI.Sprite {
  constructor(a, b, c, d) {
    super();
    this.target = a;
    this.trail = { ...ParticleEffects.EnergyVacuum };
    this.tint = this.trail.tt = d;
    this.theta = this.index = 0;
    this.torsoloweremitter1 = new ParticleEmitter(this.target.torsolower, this.trail);
    this.torsoloweremitter2 = new ParticleEmitter(this.target.torsolower, this.trail);
    this.emitter = [this.torsoloweremitter1, this.torsoloweremitter2];
  }
  update(a) {
    this.theta += 0 > this.target.p.vx ? -0.03 : 0.03;
    this.index = 8 === this.index + 1 ? 0 : this.index + 1;
    a = (this.index * Math.PI) / 4 + this.theta;
    this.torsoloweremitter1.offset.x = 35 * Math.cos(a);
    this.torsoloweremitter1.offset.y = 35 * Math.sin(a);
    this.torsoloweremitter2.offset.x = 35 * Math.cos(a + Math.PI);
    this.torsoloweremitter2.offset.y = 35 * Math.sin(a + Math.PI);
    AudioManager.PlayEffect(AudioEffects.Fly, this.target);
  }
}
EnergyVacuum.Material = {};
EnergyVacuum.ID = "vacuum";
var fastrope = {};
class FastRope extends PIXI.Mesh {
  constructor(a, b, c = null, d = null, e = null) {
    d = new PIXI.RopeGeometry(
      a.height,
      null === d ? [new PIXI.Point(), new PIXI.Point(), new PIXI.Point(), new PIXI.Point()] : d,
      0
    );
    a = null === e ? new PIXI.MeshMaterial(a) : e;
    super(d, a);
    this.autoUpdate = !0;
    this.target = b;
    this.ttl = -1;
    this.target
      ? ((this.x = this.target.p.x), (this.y = this.target.p.y))
      : ((this.x = c.x), (this.y = c.y));
    this.vy = this.vx = this.alphaDrop = 0;
    this.delta = 20;
    this.points = this.geometry.points;
  }
  _render(a) {
    const b = this.geometry;
    if (this.autoUpdate || b._width !== this.shader.texture.height)
      (b._width = this.shader.texture.height), b.update();
    super._render(a);
  }
  update() {
    this.target
      ? ((this.points[0].x = this.target.p.x), (this.points[0].y = this.target.p.y))
      : ((this.points[0].x += this.vx), (this.points[0].y += this.vy));
    for (let b = 1; b < this.points.length; b++) {
      let c = this.points[b];
      var a = this.points[b].x - this.points[b - 1].x;
      let d = this.points[b].y - this.points[b - 1].y;
      Math.sqrt(a * a + d * d) > this.delta &&
        ((a = Math.atan2(d, a)),
        (c.x = this.points[b - 1].x + this.delta * Math.cos(a)),
        (c.y = this.points[b - 1].y + this.delta * Math.sin(a)));
    }
  }
}
var blackcape = {};
class BlackCape extends FastRope {
  constructor(a, b) {
    let c = [];
    for (var d = 0; 6 > d; d++) c.push(new PIXI.Point(0, 21.4 * d));
    d = new PIXI.MeshMaterial(a, { program: BlackCape.Program, uniforms: { t: 0, v: [0, 0] } });
    super(a, b, null, c, d);
    this.x = this.target.torsoupper.p.x;
    this.y = this.target.torsoupper.p.y;
    this.targetScale = 0.33;
    this.scale.x = this.targetScale;
    this.scale.y = this.targetScale;
    this.delta = 21.4;
    this.counter = this.wave = 0;
  }
  update() {
    this.counter += 0.01;
    let a = this.target.torsoupper.p.vx,
      b = this.target.torsoupper.p.vy;
    this.shader.uniforms.t += 0.005 * Math.sqrt(a * a + b * b) + 0.05;
    this.shader.uniforms.v[0] = a;
    this.shader.uniforms.v[1] = b;
    this.wave = -0.4 * Math.abs(Math.sin(0.2 * this.counter));
    var c = this.target.torsoupper.p.r;
    let d = PC.GRAVITY.y;
    void 0 !== this.target.animations[Animation.ROLL_LEFT]
      ? (d *= -4)
      : void 0 !== this.target.animations[Animation.ROLL_RIGHT]
      ? (d *= -4)
      : void 0 !== this.target.animations[Animation.PRONE_LEFT]
      ? (d = 2)
      : void 0 !== this.target.animations[Animation.PRONE_RIGHT]
      ? (d = 2)
      : (this.rotation = 0);
    this.target.facingDir === Player.FACING_LEFT
      ? ((this.scale.x = this.targetScale),
        (a = 0 < a ? 0.2 * a : a - 0.5),
        (this.x = this.target.torsoupper.p.x - 7 * Math.cos(c - 0.75)),
        (this.y = this.target.torsoupper.p.y - 7 * Math.sin(c - 0.75)))
      : ((this.scale.x = -this.targetScale),
        (a *= -1),
        (a = 0 < a ? 0.2 * a : a - 0.5),
        (this.x = this.target.torsoupper.p.x - 7 * Math.cos(c - 2.5)),
        (this.y = this.target.torsoupper.p.y - 7 * Math.sin(c - 2.5)));
    for (c = 1; 6 > c; c++) {
      let f = this.points[c],
        g = this.points[c - 1];
      f.x -= 0.2 * a * c + this.wave * (6 - c) * 0.1;
      f.y -= 0.4 * b - d * (0.8 - 0.1 * c) * 0.2;
      var e = f.x - g.x;
      let h = f.y - g.y;
      e * e + h * h > this.delta * this.delta &&
        ((e = Math.atan2(h, e)),
        (f.x = g.x + this.delta * Math.cos(e)),
        (f.y = g.y + this.delta * Math.sin(e)));
    }
  }
}
BlackCape.FX = { tex: "blackcape" };
BlackCape.ID = "blackcape";
BlackCape.VertexSource =
  "\nprecision mediump float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\nuniform float t;\nuniform vec2 v;\n\nvarying vec2 vTextureCoord;\nvoid main(void)\n{\n    float mx = aVertexPosition.x / 5.0;\n    float my = aVertexPosition.y / 5.0;\n    float delta = length(aVertexPosition) / 128.0;\n    float frequency = delta * length(v) * 0.125 + t;\n    float amplitude = delta * delta * 0.004;\n    vec2 offset = vec2(sin(frequency + my) * amplitude, sin(frequency + mx) * amplitude);\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy + offset, 0.0, 1.0);\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}";
BlackCape.FragmentSource =
  "\nprecision mediump float;\nvarying vec2 vTextureCoord;\nuniform vec4 uColor;\nuniform float t;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float m = 1.0 - abs(sin(vTextureCoord.x * 150.0 - t * 0.5)) * 0.25;\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vec4(uColor.rgb * m, uColor.a);\n}\n";
BlackCape.Program = new PIXI.Program(BlackCape.VertexSource, BlackCape.FragmentSource, "blackcape");
var bluecape = {};
class BlueCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
BlueCape.FX = { tex: "bluecape" };
BlueCape.ID = "bluecape";
var camocape = {};
class CamoCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
CamoCape.FX = { tex: "camocape" };
CamoCape.ID = "camocape";
var camocape_desert = {};
class CamoCapeDesert extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
CamoCapeDesert.FX = { tex: "camocape_desert" };
CamoCapeDesert.ID = "camocape_desert";
var camocape_jungle = {};
class CamoCapeJungle extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
CamoCapeJungle.FX = { tex: "camocape_jungle" };
CamoCapeJungle.ID = "camocape_jungle";
var camocape_winter = {};
class CamoCapeWinter extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
CamoCapeWinter.FX = { tex: "camocape_winter" };
CamoCapeWinter.ID = "camocape_winter";
var greencape = {};
class GreenCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
GreenCape.FX = { tex: "greencape" };
GreenCape.ID = "greencape";
var redcape = {};
class RedCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
RedCape.FX = { tex: "redcape" };
RedCape.ID = "redcape";
var yellowcape = {};
class YellowCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
YellowCape.FX = { tex: "yellowcape" };
YellowCape.ID = "yellowcape";
var pinkcape = {};
class PinkCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
PinkCape.FX = { tex: "pinkcape" };
PinkCape.ID = "pinkcape";
var orangecape = {};
class OrangeCape extends BlackCape {
  constructor(a, b) {
    super(a, b);
  }
  update() {
    super.update();
  }
}
OrangeCape.FX = { tex: "orangecape" };
OrangeCape.ID = "orangecape";
var extra = {};
class Extra {
  constructor() {}
}
Extra.Map = {
  blackcape: BlackCape,
  greencape: GreenCape,
  redcape: RedCape,
  yellowcape: YellowCape,
  bluecape: BlueCape,
  pinkcape: PinkCape,
  orangecape: OrangeCape,
  camocape: CamoCape,
  camocape_jungle: CamoCapeJungle,
  camocape_winter: CamoCapeWinter,
  camocape_desert: CamoCapeDesert,
};
var facefireeyes = {};
class FaceFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail = { ...ParticleEffects.FireEyes };
    this.emitter = new ParticleEmitter(this.target.head, this.trail);
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter.offset.x = 6 * Math.cos(a);
    this.emitter.offset.y = 4 * Math.sin(a);
  }
}
FaceFireEyes.ID = "fireeyes";
var faceredfireeyes = {};
class FaceRedFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail1 = { ...ParticleEffects.FireEyes };
    this.trail1.tt = 16711680;
    this.trail2 = { ...ParticleEffects.FireEyesCenter };
    this.trail2.tt = 16777215;
    this.emitter1 = new ParticleEmitter(this.target.head, this.trail1);
    this.emitter2 = new ParticleEmitter(this.target.head, this.trail2);
    this.emitter = [this.emitter2, this.emitter1];
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter1.offset.x = 6 * Math.cos(a);
    this.emitter1.offset.y = 4 * Math.sin(a);
    this.emitter2.offset.x = this.emitter1.offset.x;
    this.emitter2.offset.y = this.emitter1.offset.y;
  }
}
FaceRedFireEyes.ID = "fireeyesred";
var facegreenfireeyes = {};
class FaceGreenFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail1 = { ...ParticleEffects.FireEyes };
    this.trail1.tt = 65280;
    this.trail2 = { ...ParticleEffects.FireEyesCenter };
    this.trail2.tt = 16777215;
    this.emitter1 = new ParticleEmitter(this.target.head, this.trail1);
    this.emitter2 = new ParticleEmitter(this.target.head, this.trail2);
    this.emitter = [this.emitter2, this.emitter1];
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter1.offset.x = 6 * Math.cos(a);
    this.emitter1.offset.y = 4 * Math.sin(a);
    this.emitter2.offset.x = this.emitter1.offset.x;
    this.emitter2.offset.y = this.emitter1.offset.y;
  }
}
FaceGreenFireEyes.ID = "fireeyesgreen";
var facebluefireeyes = {};
class FaceBlueFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail1 = { ...ParticleEffects.FireEyes };
    this.trail1.tt = 255;
    this.trail2 = { ...ParticleEffects.FireEyesCenter };
    this.trail2.tt = 16777215;
    this.emitter1 = new ParticleEmitter(this.target.head, this.trail1);
    this.emitter2 = new ParticleEmitter(this.target.head, this.trail2);
    this.emitter = [this.emitter2, this.emitter1];
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter1.offset.x = 6 * Math.cos(a);
    this.emitter1.offset.y = 4 * Math.sin(a);
    this.emitter2.offset.x = this.emitter1.offset.x;
    this.emitter2.offset.y = this.emitter1.offset.y;
  }
}
FaceBlueFireEyes.ID = "fireeyesblue";
var faceyellowfireeyes = {};
class FaceYellowFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail1 = { ...ParticleEffects.FireEyes };
    this.trail1.tt = 16776960;
    this.trail2 = { ...ParticleEffects.FireEyesCenter };
    this.trail2.tt = 16777215;
    this.emitter1 = new ParticleEmitter(this.target.head, this.trail1);
    this.emitter2 = new ParticleEmitter(this.target.head, this.trail2);
    this.emitter = [this.emitter2, this.emitter1];
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter1.offset.x = 6 * Math.cos(a);
    this.emitter1.offset.y = 4 * Math.sin(a);
    this.emitter2.offset.x = this.emitter1.offset.x;
    this.emitter2.offset.y = this.emitter1.offset.y;
  }
}
FaceYellowFireEyes.ID = "fireeyesyellow";
var facepinkfireeyes = {};
class FacePinkFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail1 = { ...ParticleEffects.FireEyes };
    this.trail1.tt = 16738740;
    this.trail2 = { ...ParticleEffects.FireEyesCenter };
    this.trail2.tt = 16777215;
    this.emitter1 = new ParticleEmitter(this.target.head, this.trail1);
    this.emitter2 = new ParticleEmitter(this.target.head, this.trail2);
    this.emitter = [this.emitter2, this.emitter1];
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter1.offset.x = 6 * Math.cos(a);
    this.emitter1.offset.y = 4 * Math.sin(a);
    this.emitter2.offset.x = this.emitter1.offset.x;
    this.emitter2.offset.y = this.emitter1.offset.y;
  }
}
FacePinkFireEyes.ID = "fireeyespink";
var faceorangefireeyes = {};
class FaceOrangeFireEyes extends PIXI.Sprite {
  constructor(a) {
    super();
    this.target = a;
    this.trail1 = { ...ParticleEffects.FireEyes };
    this.trail1.tt = 16753920;
    this.trail2 = { ...ParticleEffects.FireEyesCenter };
    this.trail2.tt = 16777215;
    this.emitter1 = new ParticleEmitter(this.target.head, this.trail1);
    this.emitter2 = new ParticleEmitter(this.target.head, this.trail2);
    this.emitter = [this.emitter2, this.emitter1];
  }
  update(a) {
    a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r - 0.5
        : this.target.head.p.r + 0.5 + Math.PI;
    this.emitter1.offset.x = 6 * Math.cos(a);
    this.emitter1.offset.y = 4 * Math.sin(a);
    this.emitter2.offset.x = this.emitter1.offset.x;
    this.emitter2.offset.y = this.emitter1.offset.y;
  }
}
FaceOrangeFireEyes.ID = "fireeyesorange";
var customface = {};
class CustomFace extends PIXI.Sprite {
  constructor() {
    super();
  }
  update() {}
}
CustomFace.Map = {
  fireeyes: FaceFireEyes,
  fireeyesred: FaceRedFireEyes,
  fireeyesgreen: FaceGreenFireEyes,
  fireeyesblue: FaceBlueFireEyes,
  fireeyesyellow: FaceYellowFireEyes,
  fireeyespink: FacePinkFireEyes,
  fireeyesorange: FaceOrangeFireEyes,
};
var quadmesh = {};
class QuadMesh extends PIXI.Mesh {
  constructor(a) {
    super(QuadMesh.Geometry, a);
  }
}
QuadMesh.Geometry = new PIXI.Geometry();
QuadMesh.Geometry.addAttribute("aVertexPosition", [-45, -45, 45, -45, 45, 45, -45, 45], 2);
QuadMesh.Geometry.addAttribute("aTextureCoord", [0, 0, 1, 0, 1, 1, 0, 1], 2);
QuadMesh.Geometry.addIndex([0, 1, 2, 0, 2, 3]);
QuadMesh.VertexSource =
  "\nprecision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nvarying vec2 vUvs;\nvoid main() {\n    vUvs = aTextureCoord;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n}";
QuadMesh.FragmentSource =
  "\nprecision highp float;\nvarying vec2 vUvs;\nuniform vec4 color;\nuniform sampler2D uSampler2;\nvoid main() {\n\tvec4 pixel = texture2D(uSampler2, vUvs);\n\tpixel *= color;\n    gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
QuadMesh.Program = new PIXI.Program(QuadMesh.VertexSource, QuadMesh.FragmentSource, "energy");
var energy = {};
class Energy extends QuadMesh {
  constructor(a, b, c, d, e) {
    super(new PIXI.MeshMaterial(App.CombinedTextures[b]));
    this.target = a;
    this.trail = e ? { ...e } : { ...ParticleEffects.EnergyTrail };
    this.trail.tex = c;
    this.tint = this.trail.tt = d;
    this.emitter = new ParticleEmitter(this.target.torsolower, this.trail);
    this.scale.x = this.scale.y = 0.9;
  }
  update(a) {
    this.x = a.x;
    this.y = a.y;
    this.rotation = Math.random() * Math.PI * 2;
    AudioManager.PlayEffect(AudioEffects.Fly, this.target);
  }
}
Energy.Material = {};
Energy.Map = {
  vacuum: EnergyVacuum,
  dragon: EnergyDragon,
  jetfeet: EnergyJetFeet,
  jetfeet2: EnergyJetFeet2,
};
var prefablist = {},
  PrefabList = {
    Fist: -1,
    ShotgunPellet: 1,
    SubmachineGunBullet: 2,
    LauncherNade: 3,
    BarrettBullet: 4,
    ShockRifleBullet: 5,
    PulseGunBullet: 6,
    FlameThrowerLiquid: 7,
    RPGRocket: 8,
    RifleBullet: 9,
    LaserGunBullet: 10,
    AK47Bullet: 12,
    Nade: 20,
    ClusterNade: 21,
    ClusterNadeFragment: 22,
    ShurikenBlade: 23,
    SnowballProjectile: 25,
    MinigunBullet: 26,
    MAC10Bullet: 28,
    Arrow: 29,
    RLRocket: 30,
    CarbineBullet: 31,
    X75Nade: 75,
    TinyShrapnel: 101,
    Rifle: 200,
    Shotgun: 201,
    NadeLauncher: 202,
    SubmachineGun: 203,
    Chainsaw: 204,
    Barrett: 205,
    ShockRifle: 207,
    PulseGun: 208,
    FlameThrower: 209,
    RPG: 210,
    LaserGun: 211,
    Shuriken: 212,
    LinkGun: 213,
    DesertEagle: 214,
    Snowball: 215,
    AK47: 216,
    Minigun: 217,
    X75: 218,
    MAC10: 219,
    Bow: 220,
    RocketLauncher: 221,
    Carbine: 222,
    Bouncyball: 300,
    HealthBox: 400,
    NadeBox: 401,
    ClusterNadeBox: 402,
    SnowballBox: 403,
    ShurikenBox: 404,
    Flag: 600,
    ShotgunAmmo: 700,
    RifleAmmo: 701,
    AK47Ammo: 702,
    BarrettAmmo: 703,
    ChainsawAmmo: 704,
    DesertEagleAmmo: 705,
    FlameThrowerAmmo: 706,
    LaserGunAmmo: 707,
    LinkGunAmmo: 708,
    MAC10Ammo: 709,
    MinigunAmmo: 710,
    NadeLauncherAmmo: 711,
    PulseGunAmmo: 712,
    RPGAmmo: 713,
    ShockRifleAmmo: 714,
    SMGAmmo: 715,
    X75Ammo: 716,
    Gold: 800,
  },
  PrefabClasses = {
    1: ShotgunPellet,
    2: SubmachineGunBullet,
    3: LauncherNade,
    4: BarrettBullet,
    5: ShockRifleBullet,
    6: PulseGunBullet,
    7: FlameThrowerLiquid,
    8: RPGRocket,
    9: RifleBullet,
    10: LaserGunBullet,
    12: AK47Bullet,
    20: Nade,
    21: ClusterNade,
    22: ClusterNadeFragment,
    23: ShurikenBlade,
    24: DesertEagleBullet,
    25: SnowballProjectile,
    26: MinigunBullet,
    27: X75Nade,
    28: MAC10Bullet,
    29: Arrow,
    30: RLRocket,
    31: CarbineBullet,
    101: TinyShrapnel,
    200: Rifle,
    201: Shotgun,
    202: NadeLauncher,
    203: SubmachineGun,
    204: Chainsaw,
    205: Barrett,
    207: ShockRifle,
    208: PulseGun,
    209: FlameThrower,
    210: RPG,
    211: LaserGun,
    213: LinkGun,
    214: DesertEagle,
    216: AK47,
    217: Minigun,
    218: X75,
    219: MAC10,
    220: Bow,
    221: RocketLauncher,
    222: Carbine,
    300: Bouncyball,
    400: HealthBox,
    401: NadeBox,
    402: ClusterNadeBox,
    403: SnowballBox,
    404: ShurikenBox,
    600: Flag,
    700: ShotgunAmmo,
    701: RifleAmmo,
    702: AK47Ammo,
    703: BarrettAmmo,
    704: ChainsawAmmo,
    705: DesertEagleAmmo,
    706: FlameThrowerAmmo,
    707: LaserGunAmmo,
    708: LinkGunAmmo,
    709: MAC10Ammo,
    710: MinigunAmmo,
    711: NadeLauncherAmmo,
    712: PulseGunAmmo,
    713: RPGAmmo,
    714: ShockRifleAmmo,
    715: SMGAmmo,
    716: X75Ammo,
    800: Gold,
  };
var particleeffects = {},
  PP = {
    AMOUNT: "n",
    TEXTURE: "tex",
    TTL: "ttl",
    SCALE: "s",
    SCALE_CHANGE: "vs",
    SCALE_RANDOM: "rs",
    ALPHA: "a",
    ALPHA_CHANGE: "va",
    GRAVITY_SCALE: "gs",
    ROTATION: "_r",
    ANGULAR: "vr",
    ANGULAR_RANDOM: "vrs",
    VELOCITY_RANDOM: "randV",
    ORIGIN: "origin",
    FOREGROUND: "_fg",
    FILTERS: "filters",
    ANCHOR: "anchor",
    ANCHOR_RELATIVE: "arl",
    COLLIDE: "collide",
    NORMAL: "normal",
    VELOCITY_MULTIPLIER: "vm",
    VELOCITY: "_v",
    EJECTION_ANGLE: "ea",
    EJECTION_DELTA: "ed",
    DELTA_RANDOM: "dr",
    VELOCITY_ALPHA_TTL: "vat",
    PREFAB: "prefab",
    TYPE: "type",
    RAY_DELTA: "delta",
    LOCAL: "local",
    AMOUNT_RANDOM: "rn",
    SCALE_FACTOR: "sf",
    NORMAL_MULTIPLIER: "nm",
    APPEAR: "_appear",
    CAM_JERK: "cj",
    CAM_SHAKE: "cs",
    GLOBAL: "gl",
    AUDIO: "au",
    TINT: "tt",
    DYNAMIC_ALT: "da",
    BUFFER_ID: "bi",
    ROPE: "rp",
  },
  ParticleEffects = {};
PE = ParticleEffects.TestCross = {};
PE[PP.TEXTURE] = "testcross";
PE[PP.TTL] = 200;
PE[PP.SCALE] = 0.5;
PE[PP.ALPHA] = 0.5;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.TunnelSparks = {};
PE[PP.TEXTURE] = "sparks2";
PE[PP.ANCHOR] = { x: 0.5, y: 0.5 };
PE[PP.TTL] = 20;
PE[PP.SCALE] = 1.5;
PE[PP.SCALE_CHANGE] = -0.05;
PE[PP.ALPHA] = 1e-4;
PE[PP.ROTATION] = 6;
PE[PP.ALPHA_CHANGE] = 0.04;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.ArrowImpactDynamic = {};
PE[PP.TEXTURE] = "arrow";
PE[PP.TTL] = 40;
PE[PP.SCALE] = 0.6;
PE[PP.ALPHA] = 1;
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ROTATION] = 7;
PE[PP.ANCHOR] = { x: 0.6, y: 0.5 };
PE[PP.VELOCITY] = 5;
PE[PP.VELOCITY_MULTIPLIER] = 0.1;
PE[PP.ALPHA_CHANGE] = -0.025;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.3, max: 0.6 };
PE[PP.BUFFER_ID] = "arrow2";
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.ArrowImpactStatic = {};
PE[PP.TEXTURE] = "arrow";
PE[PP.TTL] = 300;
PE[PP.SCALE] = 0.6;
PE[PP.ALPHA] = 1;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ROTATION] = 7;
PE[PP.ANCHOR] = { x: 0.6, y: 0.5 };
PE[PP.VELOCITY_ALPHA_TTL] = 10;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.DYNAMIC_ALT] = ParticleEffects.ArrowImpactDynamic;
PE = ParticleEffects.XP10 = {};
PE[PP.TEXTURE] = "10xp";
PE[PP.TTL] = 40;
PE[PP.ALPHA] = 1.6;
PE[PP.ALPHA_CHANGE] = -0.04;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -0.5, rangeX: 1, minY: -1, rangeY: 0.01 };
PE = ParticleEffects.PlayerSpawn = {};
PE[PP.AMOUNT] = 5;
PE[PP.TEXTURE] = "playerspawn";
PE[PP.TTL] = 30;
PE[PP.ALPHA] = 0.3;
PE[PP.SCALE] = 2;
PE[PP.SCALE_CHANGE] = -0.025;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.05, max: 0.1 };
PE[PP.GRAVITY_SCALE] = 0.01;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.ShockRifleOrbImpact = {};
PE[PP.TEXTURE] = "shockrifle_orb_impact";
PE[PP.TTL] = 6;
PE[PP.SCALE] = 0.8;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 2;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.Electricity1 = {};
PE[PP.TEXTURE] = "electricity1";
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.8;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.Electricity2 = {};
PE[PP.TEXTURE] = "electricity1";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = -0.02;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.Plasma1 = {};
PE[PP.TEXTURE] = "plasma1";
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.35;
PE[PP.SCALE_RANDOM] = { min: 0.35, max: 0.7 };
PE[PP.SCALE_CHANGE] = 1e-5;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.PlasmaElectric = {};
PE[PP.TEXTURE] = "plasma_electric";
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.5;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE[PP.SCALE_RANDOM] = { min: 0.3, max: 0.9 };
PE = ParticleEffects.PlasmaSparks = {};
PE[PP.TEXTURE] = "plasma_electric";
PE[PP.TTL] = 100;
PE[PP.SCALE] = 0.5;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE[PP.SCALE_RANDOM] = { min: 0.3, max: 0.9 };
PE[PP.ORIGIN] = 4;
PE = ParticleEffects.NadeExplosion = {};
PE[PP.TEXTURE] = "explosion";
PE[PP.TTL] = 16;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_CHANGE] = 0.09;
PE[PP.ALPHA_CHANGE] = -0.015;
PE[PP.ROTATION] = 2;
PE[PP.ORIGIN] = "";
PE[PP.FOREGROUND] = !0;
PE[PP.FILTERS] = [PIXI.filters.ShockwaveFilter];
PE[PP.CAM_SHAKE] = 5;
PE[PP.GLOBAL] = !0;
PE = ParticleEffects.PlasmaNadeExplosion = {};
PE[PP.TEXTURE] = "plasma_exp";
PE[PP.TTL] = 8;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_CHANGE] = 0.15;
PE[PP.ALPHA] = 1.15;
PE[PP.ALPHA_CHANGE] = -0.1;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.2, max: 0.4 };
PE[PP.ORIGIN] = "";
PE[PP.FOREGROUND] = !0;
PE[PP.FILTERS] = [PIXI.filters.ShockwaveFilter];
PE[PP.CAM_SHAKE] = 2;
PE[PP.GLOBAL] = !0;
PE = ParticleEffects.TeleportTwirl = {};
PE[PP.TEXTURE] = "twirl";
PE[PP.TTL] = 16;
PE[PP.SCALE] = 1;
PE[PP.ROTATION] = 2;
PE[PP.ORIGIN] = "";
PE[PP.ALPHA] = 1e-5;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.FOREGROUND] = !0;
PE[PP.GLOBAL] = !0;
PE = ParticleEffects.ClusterNadeExplosion = {};
PE[PP.TEXTURE] = "explosion3";
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.04;
PE[PP.SCALE_CHANGE] = 0.06;
PE[PP.ALPHA_CHANGE] = -0.015;
PE[PP.ROTATION] = 2;
PE[PP.ORIGIN] = "";
PE[PP.FOREGROUND] = !0;
PE[PP.FILTERS] = [PIXI.filters.ShockwaveFilter];
PE[PP.CAM_SHAKE] = 2;
PE[PP.GLOBAL] = !0;
PE = ParticleEffects.LauncherNadeExplosion = {};
PE[PP.TEXTURE] = "explosion2";
PE[PP.TTL] = 14;
PE[PP.SCALE] = 0.08;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.ALPHA_CHANGE] = -0.07;
PE[PP.ROTATION] = 2;
PE[PP.ORIGIN] = "";
PE[PP.FOREGROUND] = !0;
PE[PP.FILTERS] = [PIXI.filters.ShockwaveFilter];
PE[PP.CAM_SHAKE] = 5;
PE[PP.GLOBAL] = !0;
PE = ParticleEffects.RLNadeExplosion = {};
PE[PP.TEXTURE] = "explosion";
PE[PP.TTL] = 14;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_CHANGE] = 0.1;
PE[PP.ALPHA_CHANGE] = -0.07;
PE[PP.ROTATION] = 2;
PE[PP.ORIGIN] = "";
PE[PP.FOREGROUND] = !0;
PE[PP.FILTERS] = [PIXI.filters.ShockwaveFilter];
PE[PP.CAM_SHAKE] = 3;
PE[PP.GLOBAL] = !0;
PE = ParticleEffects.NadeExplosionSmoke = {};
PE[PP.TEXTURE] = "smoke1";
PE[PP.TTL] = 75;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 1.6 };
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.ALPHA] = 0.8;
PE[PP.ALPHA_CHANGE] = -0.0106;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.02;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.TINT] = 16777215;
PE = ParticleEffects.RLSmoke = {};
PE[PP.TEXTURE] = "smoke1";
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.1, max: 0.4 };
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.ALPHA] = 0.8;
PE[PP.ALPHA_CHANGE] = -0.016;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.01;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -1.5, rangeX: 3, minY: -1.5, rangeY: 3 };
PE[PP.TINT] = 16777215;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.ClusterNadeExplosionSmoke = {};
PE[PP.TEXTURE] = "smoke1";
PE[PP.TTL] = 75;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_RANDOM] = { min: 0.3, max: 1 };
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 0.8;
PE[PP.ALPHA_CHANGE] = -0.0106;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.02;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.TINT] = 16777215;
PE = ParticleEffects.NadeExplosionParticles = {};
PE[PP.AMOUNT] = 16;
PE[PP.TEXTURE] = "tinyspark";
PE[PP.TTL] = 100;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_RANDOM] = { min: 0.6, max: 1.8 };
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 5;
PE[PP.GRAVITY_SCALE] = 0.3;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -20, rangeX: 40, minY: -30, rangeY: 40 };
PE = ParticleEffects.CaptureObjectiveParticles = {};
PE[PP.AMOUNT] = 10;
PE[PP.TEXTURE] = "playercapture";
PE[PP.TTL] = 10;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.1;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = -1;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.WaterBubbles = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "waterbubble";
PE[PP.TTL] = 120;
PE[PP.ALPHA] = 0.9;
PE[PP.ALPHA_CHANGE] = -0.045;
PE[PP.SCALE_RANDOM] = { min: 0.04, max: 0.14 };
PE[PP.SCALE_CHANGE] = -3e-4;
PE[PP.GRAVITY_SCALE] = -0.002;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -0.1, rangeX: 0.2, minY: -0.1, rangeY: 0.2 };
PE = ParticleEffects.RifleMuzzleFlash = {};
PE[PP.TEXTURE] = "muzzleflash1";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.25;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.X75MuzzleFlash = {};
PE[PP.TEXTURE] = "muzzleflash2";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.25;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.LaserGunMuzzleFlash = {};
PE[PP.TEXTURE] = "lasermuzzleflash1";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.75;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !1;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.LinkGunMuzzleFlash = {};
PE[PP.TEXTURE] = "link_gun_muzzle_flash";
PE[PP.ANCHOR] = { x: 0.7, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.45;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.GreenLaserImpact = {};
PE[PP.TEXTURE] = "greenlaserimpact";
PE[PP.TTL] = 6;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.ALPHA_CHANGE] = -0.06;
PE[PP.ROTATION] = 2;
PE[PP.ORIGIN] = "";
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.ShockRifleMuzzleFlash = {};
PE[PP.TEXTURE] = "shockriflemuzzleflash";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 3;
PE[PP.SCALE] = 0.8;
PE[PP.ALPHA_CHANGE] = -0.33;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.SMGMuzzleFlash = {};
PE[PP.TEXTURE] = "muzzleflash1";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.15;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.MAC10MuzzleFlash = {};
PE[PP.TEXTURE] = "muzzleflash1";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.11;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.PulseGunMuzzleFlash = {};
PE[PP.TEXTURE] = "pulsegunmuzzleflash";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.3;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 3;
PE = ParticleEffects.ShotgunMuzzleFlash = {};
PE[PP.TEXTURE] = "shotgunmuzzleflash";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.9;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 4;
PE = ParticleEffects.NadeLauncherFireSparks = {};
PE[PP.AMOUNT] = 5;
PE[PP.TEXTURE] = "tinyspark";
PE[PP.TTL] = 30;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_CHANGE] = -0.01;
PE[PP.ALPHA_CHANGE] = -0.03;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 1;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.COLLIDE] = !0;
PE[PP.CAM_JERK] = 4;
PE = ParticleEffects.LargeRicochet = {};
PE[PP.AMOUNT] = 15;
PE[PP.TEXTURE] = "tinyspark";
PE[PP.TTL] = 100;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0;
PE[PP.ALPHA] = 0.95;
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY_MULTIPLIER] = 0.01;
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.VELOCITY_RANDOM] = { minX: -8, rangeX: 16, minY: -8, rangeY: 16 };
PE[PP.COLLIDE] = !0;
PE[PP.NORMAL] = !0;
PE = ParticleEffects.MediumRicochet = {};
PE[PP.AMOUNT] = 5;
PE[PP.TEXTURE] = "tinyspark";
PE[PP.TTL] = 40;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = 0;
PE[PP.SCALE_RANDOM] = { min: 0.7, max: 1 };
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 5;
PE[PP.VELOCITY_MULTIPLIER] = 0.05;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.VELOCITY_RANDOM] = { minX: -8, rangeX: 16, minY: -8, rangeY: 16 };
PE[PP.COLLIDE] = !0;
PE[PP.NORMAL] = !0;
PE = ParticleEffects.SmallRicochet = {};
PE[PP.AMOUNT] = 5;
PE[PP.TEXTURE] = "spark";
PE[PP.TTL] = 30;
PE[PP.VELOCITY] = 8;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.SCALE] = 0.7;
PE[PP.SCALE_RANDOM] = { min: 0.7, max: 1 };
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.NORMAL_MULTIPLIER] = 4;
PE[PP.VELOCITY_RANDOM] = { minX: -2, rangeX: 4, minY: -2, rangeY: 4 };
PE = ParticleEffects.TinyRicochet = {};
PE[PP.AMOUNT] = 3;
PE[PP.TEXTURE] = "tinyspark";
PE[PP.TTL] = 30;
PE[PP.VELOCITY] = 8;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_RANDOM] = { min: 0.7, max: 1 };
PE[PP.ALPHA] = 0.6;
PE[PP.ROTATION] = 10;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.NORMAL_MULTIPLIER] = 3;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE = ParticleEffects.Bloodsplat1 = {};
PE[PP.TEXTURE] = "gore3";
PE[PP.TTL] = 60;
PE[PP.SCALE] = 0.2;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.016;
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.VELOCITY] = 5;
PE[PP.VELOCITY_MULTIPLIER] = 0.1;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY_RANDOM] = { minX: -3, rangeX: 6, minY: -3, rangeY: 6 };
PE[PP.COLLIDE] = !0;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.Bloodsplat2 = {};
PE[PP.TEXTURE] = "gore2";
PE[PP.ANCHOR] = { x: 0.2, y: 0.5 };
PE[PP.TTL] = 15;
PE[PP.VELOCITY_MULTIPLIER] = 0.05;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.065;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.SCALE_RANDOM] = { min: 0.5, max: 1 };
PE[PP.ROTATION] = 1;
PE[PP.VELOCITY] = 5;
PE[PP.COLLIDE] = !0;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.Bloodsplat3 = {};
PE[PP.TEXTURE] = "gore4";
PE[PP.TTL] = 60;
PE[PP.SCALE] = 0.3;
PE[PP.ALPHA] = 1;
PE[PP.SCALE_CHANGE] = -0.003;
PE[PP.ALPHA_CHANGE] = -0.015;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY_RANDOM] = { minX: -5, rangeX: 10, minY: -5, rangeY: 10 };
PE[PP.COLLIDE] = !0;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.GoreTrail = {};
PE[PP.TEXTURE] = "gore3";
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.05;
PE[PP.ALPHA] = 1;
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.VELOCITY_MULTIPLIER] = 0.1;
PE[PP.GRAVITY_SCALE] = 0.3;
PE[PP.VELOCITY] = 6;
PE[PP.SCALE_RANDOM] = { min: 0.1, max: 2 };
PE[PP.DELTA_RANDOM] = { min: 1, max: 4 };
PE[PP.COLLIDE] = !0;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.GoreTrailWater = {};
PE[PP.TEXTURE] = "gore3";
PE[PP.TTL] = 200;
PE[PP.SCALE] = 0.05;
PE[PP.ALPHA] = 0.8;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA_CHANGE] = -0.004;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.VELOCITY_RANDOM] = { minX: -0.1, rangeX: 0.2, minY: -0.1, rangeY: 0.2 };
PE[PP.SCALE_RANDOM] = { min: 0.1, max: 2 };
PE[PP.COLLIDE] = !1;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.Bleeding = {};
PE[PP.TEXTURE] = "gore1";
PE[PP.TTL] = 40;
PE[PP.SCALE] = 0.25;
PE[PP.SCALE_CHANGE] = 1e-4;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.025;
PE[PP.VELOCITY_MULTIPLIER] = 0.1;
PE[PP.GRAVITY_SCALE] = 0.3;
PE[PP.ROTATION] = 10;
PE[PP.DELTA_RANDOM] = { min: 0.1, max: 0.3 };
PE[PP.FOREGROUND] = !0;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.BleedingInWater = {};
PE[PP.TEXTURE] = "gore1";
PE[PP.TTL] = 100;
PE[PP.SCALE] = 0.25;
PE[PP.SCALE_CHANGE] = 1e-4;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.VELOCITY_MULTIPLIER] = 0.001;
PE[PP.GRAVITY_SCALE] = 0.005;
PE[PP.ROTATION] = 10;
PE[PP.DELTA_RANDOM] = { min: 0.1, max: 0.3 };
PE[PP.FOREGROUND] = !0;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.LauncherNadeSparkTrail = {};
PE[PP.TEXTURE] = "flame2";
PE[PP.TTL] = 3;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_RANDOM] = { min: 0.5, max: 0.7 };
PE[PP.SCALE_CHANGE] = -0.1;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.3;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 1;
PE[PP.VELOCITY_MULTIPLIER] = 0.05;
PE[PP.GRAVITY_SCALE] = 0.2;
PE = ParticleEffects.LauncherNadeSmokeTrail = {};
PE[PP.TEXTURE] = "smoke3";
PE[PP.TTL] = 25;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 1.6 };
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 0.3;
PE[PP.ALPHA_CHANGE] = -0.012;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.02;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE = ParticleEffects.X75NadeSparkTrail = {};
PE[PP.TEXTURE] = "green-exp";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 0.6 };
PE[PP.SCALE_CHANGE] = -0.02;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.GRAVITY_SCALE] = 0.2;
PE = ParticleEffects.BulletTrail = {};
PE[PP.TEXTURE] = "bullettrail";
PE[PP.TTL] = 30;
PE[PP.SCALE] = 1.9;
PE[PP.ALPHA] = 0.18;
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.ROTATION] = 1;
PE[PP.ANCHOR] = { x: 0.4, y: 0.5 };
PE = ParticleEffects.ArrowTrail = {};
PE[PP.TEXTURE] = "bullettrail";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.5;
PE[PP.ALPHA] = 0.5;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.ROTATION] = 1;
PE[PP.ANCHOR] = { x: 1.5, y: 0.5 };
PE = ParticleEffects.TinyBulletTrail = {};
PE[PP.TEXTURE] = "bullettrail2";
PE[PP.TTL] = 5;
PE[PP.SCALE] = 0.5;
PE[PP.ALPHA] = 0.5;
PE[PP.ALPHA_CHANGE] = -0.1;
PE[PP.ROTATION] = 1;
PE[PP.ANCHOR] = { x: 0.4, y: 0.5 };
PE[PP.SCALE_FACTOR] = 0.0033;
PE = ParticleEffects.MAC10BulletTrail = {};
PE[PP.TEXTURE] = "bullettrail2";
PE[PP.TTL] = 5;
PE[PP.SCALE] = 0.5;
PE[PP.ALPHA] = 0.2;
PE[PP.ALPHA_CHANGE] = -0.04;
PE[PP.ROTATION] = 1;
PE[PP.ANCHOR] = { x: 0.4, y: 0.5 };
PE[PP.SCALE_FACTOR] = 4e-4;
PE = ParticleEffects.PulseGunOrbTrail = {};
PE[PP.TEXTURE] = "pulsegun_orb_trail";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.03;
PE[PP.ALPHA] = 0.18;
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.ROTATION] = 1;
PE[PP.ANCHOR] = { x: 0.9, y: 0.5 };
PE = ParticleEffects.Teleport1 = {};
PE[PP.TEXTURE] = "flag1";
PE[PP.TTL] = 100;
PE[PP.SCALE] = 0;
PE[PP.SCALE_CHANGE] = 0.04;
PE[PP.ALPHA] = 0.4;
PE[PP.ALPHA_CHANGE] = -0.004;
PE[PP.ROTATION] = 0;
PE[PP.ANGULAR] = 0.01;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.Flag1 = {};
PE[PP.TEXTURE] = "flag1";
PE[PP.TTL] = 100;
PE[PP.SCALE] = 1;
PE[PP.SCALE_CHANGE] = 0;
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.006;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.GoldGlitter = {};
PE[PP.TEXTURE] = "glitter";
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = -0.02;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.SnowFlake = {};
PE[PP.TEXTURE] = "precip_snow";
PE[PP.TTL] = 330;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_CHANGE] = 0;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.003;
PE[PP.ROTATION] = 0.01;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.Glitter = {};
PE[PP.TEXTURE] = "glitter";
PE[PP.TTL] = 5;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = -0.06;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.06;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = -0.1;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.GlitterTail = {};
PE[PP.TEXTURE] = "glitter";
PE[PP.TTL] = 30;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_CHANGE] = -0.005;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.0333;
PE[PP.GRAVITY_SCALE] = -0.03;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.EnergyShell = {};
PE[PP.TEXTURE] = "energy_shell";
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.64;
PE[PP.ALPHA] = 1;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ROTATION] = 2;
PE[PP.FOREGROUND] = !0;
PE[PP.TINT] = !0;
PE = ParticleEffects.EnergyTrail = {};
PE[PP.TEXTURE] = "energy_trail_electric";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.64;
PE[PP.SCALE_RANDOM] = { min: 0.1, max: 1 };
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.VELOCITY] = 6;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.ChainsawSmoke = {};
PE[PP.TEXTURE] = "smoke3";
PE[PP.TTL] = 14;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_CHANGE] = 0.03;
PE[PP.ALPHA] = 0.8;
PE[PP.ALPHA_CHANGE] = -0.06;
PE[PP.ORIGIN] = 1;
PE[PP.GRAVITY_SCALE] = -0.2;
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.EJECTION_DELTA] = { min: 2, max: 4 };
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_SHAKE] = 1;
PE = ParticleEffects.MinigunSmoke = {};
PE[PP.TEXTURE] = "smoke3";
PE[PP.TTL] = 40;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.ALPHA] = 0.11;
PE[PP.ALPHA_CHANGE] = -0.002;
PE[PP.ORIGIN] = 1;
PE[PP.GRAVITY_SCALE] = -0.05;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_SHAKE] = 1;
PE[PP.AMOUNT] = 1;
PE = ParticleEffects.ChainsawSparks = {};
PE[PP.TEXTURE] = "spark1";
PE[PP.ANCHOR] = { x: 0.5, y: 0 };
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 2;
PE[PP.ALPHA_CHANGE] = -0.07;
PE[PP.VELOCITY_RANDOM] = { minX: -5, rangeX: 10, minY: -5, rangeY: 10 };
PE = ParticleEffects.ChainsawSparks2 = {};
PE[PP.TEXTURE] = "spark";
PE[PP.TTL] = 30;
PE[PP.VELOCITY] = 8;
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.NORMAL_MULTIPLIER] = 2;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE = ParticleEffects.PunchImpact = {};
PE[PP.TEXTURE] = "dust2";
PE[PP.TTL] = 30;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.NORMAL_MULTIPLIER] = 1;
PE[PP.FOREGROUND] = !0;
PE[PP.SCALE] = 0.5;
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.SCALE_RANDOM] = { min: 0.1, max: 0.5 };
PE = ParticleEffects.BounceImpact = {};
PE[PP.AMOUNT] = 2;
PE[PP.TEXTURE] = "bounce";
PE[PP.TTL] = 30;
PE[PP.GRAVITY_SCALE] = 0.04;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.003;
PE[PP.ALPHA] = 0.4;
PE[PP.ALPHA_CHANGE] = -0.012;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY] = 2;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE = ParticleEffects.WaterSplash = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "watersplash";
PE[PP.TTL] = 40;
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.SCALE_RANDOM] = { min: 0.2, max: 0.9 };
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.015;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY] = 4;
PE[PP.VELOCITY_MULTIPLIER] = 0.02;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.WaterSplashExit = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "watersplash";
PE[PP.TTL] = 40;
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.SCALE_RANDOM] = { min: 0.2, max: 0.5 };
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.015;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY] = 7;
PE[PP.VELOCITY_MULTIPLIER] = 0.03;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.SparkTrail1 = {};
PE[PP.TEXTURE] = "spark1";
PE[PP.ANCHOR] = { x: 0.5, y: 0 };
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 2;
PE[PP.ALPHA_CHANGE] = -0.07;
PE[PP.VELOCITY_RANDOM] = { minX: -5, rangeX: 10, minY: -5, rangeY: 10 };
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.SparkTrail2 = {};
PE[PP.TEXTURE] = "spark2";
PE[PP.AMOUNT] = 2;
PE[PP.ANCHOR] = { x: 0.5, y: 0 };
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 2;
PE[PP.ALPHA_CHANGE] = -0.07;
PE[PP.VELOCITY_RANDOM] = { minX: -5, rangeX: 10, minY: -5, rangeY: 10 };
PE = ParticleEffects.LinkGunRayImpact = {};
PE[PP.TEXTURE] = "link_ray_impact";
PE[PP.AMOUNT] = 1;
PE[PP.ANCHOR] = { x: 0.5, y: 0.5 };
PE[PP.TTL] = 5;
PE[PP.SCALE] = 0.25;
PE[PP.SCALE_CHANGE] = 0.3;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 2;
PE[PP.ALPHA_CHANGE] = -0.2;
PE[PP.VELOCITY_RANDOM] = { minX: -2, rangeX: 4, minY: -2, rangeY: 4 };
PE = ParticleEffects.SmokeTrail1 = {};
PE[PP.TEXTURE] = "smoke3";
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.02;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 1.6 };
PE[PP.ALPHA] = 0.3;
PE[PP.ALPHA_CHANGE] = -0.006;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.02;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE = ParticleEffects.SmokeTrail2 = {};
PE[PP.TEXTURE] = "smoke4";
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 0.8 };
PE[PP.ALPHA] = 0.5;
PE[PP.ALPHA_CHANGE] = -0.01;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.01;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.Dissolve = {};
PE[PP.TEXTURE] = "smoke4";
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 0.8 };
PE[PP.ALPHA] = 0.5;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.01;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.DissolveElectric = {};
PE[PP.TEXTURE] = "plasma_electric";
PE[PP.TTL] = 1;
PE[PP.SCALE] = 0.3;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE[PP.SCALE_RANDOM] = { min: 0.3, max: 0.9 };
PE = ParticleEffects.FlameTrail2 = {};
PE[PP.TEXTURE] = "flame3";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.15;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 0.8 };
PE[PP.SCALE_CHANGE] = 0.015;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY] = 1;
PE[PP.GRAVITY_SCALE] = -0.1;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.FlameThrowerTrail = {};
PE[PP.TEXTURE] = "flame3";
PE[PP.TTL] = 15;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_RANDOM] = { min: 0.8, max: 0.9 };
PE[PP.SCALE_CHANGE] = 0.045;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.075;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY] = 1;
PE[PP.GRAVITY_SCALE] = -0.1;
PE[PP.FOREGROUND] = !1;
PE = ParticleEffects.FlameThrowerPilot = {};
PE[PP.TEXTURE] = "flame5";
PE[PP.ANCHOR] = { x: 0.5, y: 0.5 };
PE[PP.TTL] = 25;
PE[PP.SCALE] = 0.35;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.ROTATION] = 4;
PE[PP.VELOCITY] = 3;
PE[PP.VELOCITY_MULTIPLIER] = 10;
PE[PP.GRAVITY_SCALE] = 0.09;
PE[PP.ORIGIN] = 1;
PE[PP.COLLIDE] = !0;
PE[PP.APPEAR] = 4;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.FlameBlast1 = {};
PE[PP.AMOUNT] = 2;
PE[PP.TEXTURE] = "flame4";
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 0.8 };
PE[PP.SCALE_CHANGE] = 0.05;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.1;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.1, max: 0.2 };
PE[PP.VELOCITY_RANDOM] = { minX: -0.1, rangeX: 0.2, minY: -0.1, rangeY: 0.2 };
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.BallTrail = {};
PE[PP.TEXTURE] = "ball";
PE[PP.TTL] = 10;
PE[PP.SCALE] = 0.45;
PE[PP.ALPHA] = 0.3;
PE[PP.ALPHA_CHANGE] = -0.1;
PE[PP.ROTATION] = 6;
PE[PP.VELOCITY] = 1;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.ShotgunCartridge = {};
PE[PP.TEXTURE] = "tinycartridge";
PE[PP.TTL] = 150;
PE[PP.SCALE] = 0.25;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 4;
PE[PP.ANGULAR_RANDOM] = { min: -0.15, max: 0.3 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 3.5, max: 5 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.SMGCartridge = {};
PE[PP.TEXTURE] = "tinycartridge";
PE[PP.TTL] = 150;
PE[PP.SCALE] = 0.2;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 4;
PE[PP.ANGULAR_RANDOM] = { min: -0.15, max: 0.3 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 3.5, max: 5 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.RifleCartridge = {};
PE[PP.TEXTURE] = "smallcartridge";
PE[PP.TTL] = 150;
PE[PP.SCALE] = 0.25;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 4;
PE[PP.ANGULAR_RANDOM] = { min: -0.15, max: 0.3 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 3.5, max: 5 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.X75Cartridge = {};
PE[PP.TEXTURE] = "green-exp";
PE[PP.TTL] = 60;
PE[PP.SCALE] = 0.1;
PE[PP.SCALE_CHANGE] = -0.004;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0.018;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.5, max: 1 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 2, max: 3 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.MinigunCartridge = {};
PE[PP.TEXTURE] = "smallcartridge";
PE[PP.TTL] = 150;
PE[PP.SCALE] = 0.18;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 4;
PE[PP.ANGULAR_RANDOM] = { min: -0.15, max: 0.3 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 3.5, max: 5 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.ShockRifleCartridge = {};
PE[PP.AMOUNT] = 5;
PE[PP.TEXTURE] = "shockriflecartridge";
PE[PP.TTL] = 20;
PE[PP.SCALE] = 0.25;
PE[PP.SCALE_RANDOM] = { min: 0.1, max: 1 };
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ORIGIN] = 2;
PE[PP.COLLIDE] = !1;
PE[PP.FOREGROUND] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE[PP.VELOCITY_RANDOM] = { minX: -2, rangeX: 4, minY: -2, rangeY: 4 };
PE = ParticleEffects.SnowPuff = {};
PE[PP.AMOUNT] = 5;
PE[PP.TEXTURE] = "snowpuff";
PE[PP.TTL] = 30;
PE[PP.SCALE] = 1;
PE[PP.SCALE_CHANGE] = 0.03;
PE[PP.SCALE_RANDOM] = { min: 1, max: 2 };
PE[PP.ALPHA] = 0.6;
PE[PP.ALPHA_CHANGE] = -0.02;
PE[PP.ROTATION] = 2;
PE[PP.GRAVITY_SCALE] = 0.05;
PE[PP.COLLIDE] = !0;
PE[PP.FOREGROUND] = !0;
PE[PP.NORMAL_MULTIPLIER] = 30;
PE[PP.VELOCITY_RANDOM] = { minX: -2, rangeX: 4, minY: -2, rangeY: 4 };
PE = ParticleEffects.SnowballTrail = {};
PE[PP.TEXTURE] = "snowpuff";
PE[PP.AMOUNT] = 1;
PE[PP.ANCHOR] = { x: 0.5, y: 0 };
PE[PP.TTL] = 40;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 1;
PE[PP.ROTATION] = 10;
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ALPHA_CHANGE] = -0.025;
PE[PP.ROTATION] = 2;
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE = ParticleEffects.BarrettCartridge = {};
PE[PP.TEXTURE] = "smallcartridge";
PE[PP.TTL] = 150;
PE[PP.SCALE] = 0.3;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 4;
PE[PP.ANGULAR_RANDOM] = { min: -0.15, max: 0.3 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 3.5, max: 5 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.NadeLauncherCartridge = {};
PE[PP.TEXTURE] = "m79cartridge";
PE[PP.TTL] = 150;
PE[PP.SCALE] = 0.3;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = 0;
PE[PP.ROTATION] = 4;
PE[PP.ANGULAR_RANDOM] = { min: -0.15, max: 0.3 };
PE[PP.GRAVITY_SCALE] = 0.1;
PE[PP.ORIGIN] = 2;
PE[PP.EJECTION_DELTA] = { min: 3.5, max: 5 };
PE[PP.EJECTION_ANGLE] = 0.15;
PE[PP.COLLIDE] = !0;
PE[PP.VELOCITY_ALPHA_TTL] = 16;
PE = ParticleEffects.HealParticles = {};
PE[PP.AMOUNT] = 10;
PE[PP.TEXTURE] = "healparticle";
PE[PP.TTL] = 40;
PE[PP.ALPHA] = 1;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.6, max: 1 };
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ANGULAR_RANDOM] = { min: -0.05, max: 0.1 };
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.ItemSpawnParticles = {};
PE[PP.AMOUNT] = 10;
PE[PP.TEXTURE] = "spark";
PE[PP.TTL] = 20;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.SCALE] = 1;
PE[PP.SCALE_RANDOM] = { min: 2, max: 3 };
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ANGULAR_RANDOM] = { min: -0.05, max: 0.1 };
PE[PP.VELOCITY_RANDOM] = { minX: -2, rangeX: 4, minY: -2, rangeY: 4 };
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.NadeParticles = {};
PE[PP.AMOUNT] = 10;
PE[PP.TEXTURE] = "nadeparticle";
PE[PP.TTL] = 40;
PE[PP.ALPHA] = 1;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.6, max: 1 };
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ANGULAR_RANDOM] = { min: -0.05, max: 0.05 };
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.ClusterNadeParticles = {};
PE[PP.AMOUNT] = 10;
PE[PP.TEXTURE] = "clusternadeparticle";
PE[PP.TTL] = 40;
PE[PP.ALPHA] = 1;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.6, max: 1 };
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ANGULAR_RANDOM] = { min: -0.05, max: 0.1 };
PE[PP.VELOCITY_RANDOM] = { minX: -1, rangeX: 2, minY: -1, rangeY: 2 };
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.AmmoPickupParticles = {};
PE[PP.AMOUNT] = 20;
PE[PP.TEXTURE] = "spark";
PE[PP.TTL] = 70;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.014;
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.6, max: 1.2 };
PE[PP.GRAVITY_SCALE] = 0.25;
PE[PP.ANGULAR_RANDOM] = { min: -0.05, max: 0.1 };
PE[PP.VELOCITY_RANDOM] = { minX: -6, rangeX: 12, minY: -6, rangeY: 12 };
PE[PP.FOREGROUND] = !1;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.GoldPickupParticles = {};
PE[PP.AMOUNT] = 10;
PE[PP.TEXTURE] = "glitter";
PE[PP.TTL] = 5;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.2;
PE[PP.SCALE] = 1;
PE[PP.SCALE_CHANGE] = -0.15;
PE[PP.ANGULAR_RANDOM] = { min: -0.3, max: 0.6 };
PE[PP.VELOCITY_RANDOM] = { minX: -6, rangeX: 12, minY: -6, rangeY: 12 };
PE[PP.FOREGROUND] = !0;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.EnergyBoundaryParticles = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "smoke1";
PE[PP.TTL] = 150;
PE[PP.ALPHA] = 1e-4;
PE[PP.ALPHA_CHANGE] = 0.025;
PE[PP.SCALE] = 1.2;
PE[PP.SCALE_CHANGE] = -0.006;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.FOREGROUND] = !0;
PE[PP.TINT] = 8912896;
PE = ParticleEffects.SmallDustEmitter = {};
PE[PP.TEXTURE] = "dust1";
PE[PP.TTL] = 350;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 3.6 };
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 0.02;
PE[PP.ALPHA_CHANGE] = 0.0015;
PE[PP.VELOCITY_ALPHA_TTL] = 40;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.VELOCITY_RANDOM] = { minX: -2, rangeX: -0.5, minY: -0.5, rangeY: 1 };
PE = ParticleEffects.TinyShrapnel = {};
PE[PP.AMOUNT_RANDOM] = { min: 1, max: 3 };
PE[PP.TTL] = 90;
PE[PP.LOCAL] = 1;
PE[PP.PREFAB] = PrefabList.TinyShrapnel;
PE[PP.VELOCITY_RANDOM] = { minX: -20, rangeX: 40, minY: -20, rangeY: 40 };
PE = ParticleEffects.FistRaycast = {};
PE[PP.AMOUNT] = 1;
PE[PP.LOCAL] = 1;
PE[PP.ROTATION] = 3;
PE[PP.TYPE] = "punch";
PE[PP.RAY_DELTA] = 24;
PE[PP.ORIGIN] = "hands";
PE = ParticleEffects.ChainsawRaycast = {};
PE[PP.AMOUNT] = 1;
PE[PP.LOCAL] = 1;
PE[PP.ROTATION] = 3;
PE[PP.TYPE] = "saw";
PE[PP.RAY_DELTA] = 45.5;
PE[PP.ORIGIN] = 1;
PE[PP.AUDIO] = AudioEffects.LightThud;
PE = ParticleEffects.LinkGunRaycast = {};
PE[PP.AMOUNT] = 1;
PE[PP.LOCAL] = 1;
PE[PP.ROTATION] = 3;
PE[PP.TYPE] = "linkgun";
PE[PP.RAY_DELTA] = 700;
PE[PP.ORIGIN] = 1;
PE[PP.AUDIO] = AudioEffects.LightThud;
PE = ParticleEffects.NadeShockWave = {};
PE[PP.AMOUNT] = 1;
PE[PP.LOCAL] = 1;
PE[PP.TYPE] = "exp";
PE = ParticleEffects.X75NadeShrapnel = {};
PE[PP.TEXTURE] = "green-exp";
PE[PP.AMOUNT_RANDOM] = { min: 4, max: 8 };
PE[PP.TTL] = 30;
PE[PP.VELOCITY] = 2;
PE[PP.VELOCITY_RANDOM] = { minX: -10, rangeX: 20, minY: -10, rangeY: 20 };
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_RANDOM] = { min: 0.2, max: 0.35 };
PE[PP.SCALE_CHANGE] = -1e-4;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.5, max: 1 };
PE[PP.GRAVITY_SCALE] = 0.2;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.033;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.RPG_BACKBLAST = {};
PE[PP.TEXTURE] = "rpg_backblast";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 4;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.3;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.2;
PE[PP.ROTATION] = 5;
PE[PP.ORIGIN] = 2;
PE[PP.FOREGROUND] = !0;
PE[PP.CAM_JERK] = 8;
PE = ParticleEffects.RPG_MUZZLEBLAST = {};
PE[PP.TEXTURE] = "muzzleflash3";
PE[PP.ANCHOR] = { x: 0, y: 0.5 };
PE[PP.TTL] = 3;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_CHANGE] = 0.1;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.3;
PE[PP.ROTATION] = 3;
PE[PP.ORIGIN] = 1;
PE[PP.FOREGROUND] = !0;
PE = ParticleEffects.RPGFlameTrail = {};
PE[PP.TEXTURE] = "flame6";
PE[PP.TTL] = 1;
PE[PP.ANCHOR] = { x: 0.5, y: 1.5 };
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_RANDOM] = { min: 0.5, max: 0.7 };
PE[PP.SCALE_CHANGE] = -0.1;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.3;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 1;
PE[PP.VELOCITY_MULTIPLIER] = 0.05;
PE[PP.GRAVITY_SCALE] = 0.2;
PE = ParticleEffects.RPGBackBlastSmoke = {};
PE[PP.AMOUNT] = 3;
PE[PP.TEXTURE] = "smoke3";
PE[PP.ORIGIN] = 2;
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 1.6 };
PE[PP.SCALE_CHANGE] = 0.04;
PE[PP.ALPHA] = 0.3;
PE[PP.ALPHA_CHANGE] = -0.006;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.02, max: 0.04 };
PE[PP.GRAVITY_SCALE] = -0.02;
PE[PP.VELOCITY] = 9;
PE[PP.VELOCITY_MULTIPLIER] = 2;
PE[PP.COLLIDE] = !0;
PE = ParticleEffects.RPGNadeSmokeTrail = {};
PE[PP.TEXTURE] = "smoke3";
PE[PP.ORIGIN] = 3;
PE[PP.ANCHOR_RELATIVE] = { x: 50, y: 0 };
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.9;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 1.6 };
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 0.3;
PE[PP.ALPHA_CHANGE] = -0.006;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.02;
PE[PP.VELOCITY_RANDOM] = { minX: -0.4, rangeX: 0.8, minY: -0.4, rangeY: 0.8 };
PE = ParticleEffects.RLRocketSmokeTrail = {};
PE[PP.TEXTURE] = "smoke3";
PE[PP.ORIGIN] = 3;
PE[PP.ANCHOR_RELATIVE] = { x: -30, y: 0 };
PE[PP.TTL] = 50;
PE[PP.SCALE] = 0.3;
PE[PP.SCALE_RANDOM] = { min: 0.4, max: 1.6 };
PE[PP.SCALE_CHANGE] = 0.01;
PE[PP.ALPHA] = 0.3;
PE[PP.ALPHA_CHANGE] = -0.006;
PE[PP.ROTATION] = 2;
PE[PP.ANGULAR] = 2;
PE[PP.ANGULAR_RANDOM] = { min: -0.002, max: 0.004 };
PE[PP.GRAVITY_SCALE] = -0.01;
PE[PP.VELOCITY_RANDOM] = { minX: -0.4, rangeX: 0.8, minY: -0.4, rangeY: 0.8 };
PE = ParticleEffects.RLRocketFlameTrail = {};
PE[PP.TEXTURE] = "flame6";
PE[PP.TTL] = 1;
PE[PP.ANCHOR] = { x: 0.5, y: 1.4 };
PE[PP.SCALE] = 0.6;
PE[PP.SCALE_RANDOM] = { min: 0.5, max: 0.7 };
PE[PP.SCALE_CHANGE] = -0.1;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.3;
PE[PP.ROTATION] = 10;
PE[PP.VELOCITY] = 1;
PE[PP.VELOCITY_MULTIPLIER] = 0.05;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.EnergyJetFeet = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "glitter";
PE[PP.TTL] = 40;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.025;
PE[PP.SCALE] = 0.7;
PE[PP.SCALE_CHANGE] = -0.0175;
PE[PP.ANGULAR_RANDOM] = { min: -0.3, max: 0.6 };
PE[PP.VELOCITY] = 10;
PE[PP.FOREGROUND] = !1;
PE[PP.COLLIDE] = !0;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.EnergyJetFeet2 = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "jetboot2fx";
PE[PP.TTL] = 4;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.2;
PE[PP.SCALE] = -1;
PE[PP.SCALE_CHANGE] = 0.2;
PE[PP.ROTATION] = 6;
PE[PP.VELOCITY] = 12;
PE[PP.FOREGROUND] = !1;
PE[PP.COLLIDE] = !1;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.EnergyJetGlow = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "glitterglow";
PE[PP.TTL] = 10;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = -0.04;
PE[PP.VELOCITY_RANDOM] = { minX: -1.5, rangeX: 3, minY: -1.5, rangeY: 3 };
PE[PP.VELOCITY] = 12;
PE[PP.FOREGROUND] = !1;
PE[PP.COLLIDE] = !0;
PE[PP.GRAVITY_SCALE] = 0;
PE = ParticleEffects.EnergyVacuum = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "glitterglow";
PE[PP.TTL] = 30;
PE[PP.ALPHA] = 0.01;
PE[PP.ALPHA_CHANGE] = 0.032;
PE[PP.SCALE] = 0.8;
PE[PP.SCALE_CHANGE] = -0.026;
PE[PP.VELOCITY] = 11;
PE[PP.FOREGROUND] = !1;
PE[PP.COLLIDE] = !1;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.EnergyDragonball = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "glitterglow";
PE[PP.TTL] = 30;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.025;
PE[PP.SCALE] = 0.4;
PE[PP.SCALE_CHANGE] = -0.012;
PE[PP.VELOCITY] = 11;
PE[PP.FOREGROUND] = !1;
PE[PP.COLLIDE] = !1;
PE[PP.GRAVITY_SCALE] = 0;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.FireEyes = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "glitterglow";
PE[PP.TTL] = 14;
PE[PP.ALPHA] = 1.1;
PE[PP.ALPHA_CHANGE] = -0.065;
PE[PP.SCALE] = 0.22;
PE[PP.SCALE_CHANGE] = -0.013;
PE[PP.VELOCITY] = 11;
PE[PP.VELOCITY_RANDOM] = { minX: -0.6, rangeX: 1.2, minY: -0.3, rangeY: 0.6 };
PE[PP.FOREGROUND] = !0;
PE[PP.COLLIDE] = !1;
PE[PP.GRAVITY_SCALE] = -0.05;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.FireEyesCenter = {};
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "glitterglow";
PE[PP.TTL] = 5;
PE[PP.ALPHA] = 1.1;
PE[PP.ALPHA_CHANGE] = -0.15;
PE[PP.SCALE] = 0.125;
PE[PP.SCALE_CHANGE] = -0.015;
PE[PP.VELOCITY] = 11;
PE[PP.VELOCITY_RANDOM] = { minX: -0.6, rangeX: 1.2, minY: -0.3, rangeY: 0.6 };
PE[PP.FOREGROUND] = !0;
PE[PP.COLLIDE] = !1;
PE[PP.GRAVITY_SCALE] = -0.05;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.RopeParticle = {};
PE[PP.ROPE] = !0;
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "ray_gun_beam";
PE[PP.TTL] = 20;
PE[PP.ALPHA] = 1;
PE[PP.ALPHA_CHANGE] = -0.05;
PE[PP.SCALE] = 0.2;
PE[PP.SCALE_CHANGE] = -0.01;
PE[PP.VELOCITY_RANDOM] = { minX: -0.3, rangeX: 0.3, minY: -0.3, rangeY: 0.3 };
PE[PP.FOREGROUND] = !0;
PE[PP.COLLIDE] = !0;
PE[PP.GRAVITY_SCALE] = -0.01;
PE[PP.ROTATION] = 2;
PE = ParticleEffects.BulletTrailRope = {};
PE[PP.ROPE] = !0;
PE[PP.TEXTURE] = "bullettrail";
PE[PP.TTL] = -1;
PE = ParticleEffects.BandanaRope = {};
PE[PP.ROPE] = !0;
PE[PP.AMOUNT] = 1;
PE[PP.TEXTURE] = "bandana_team_juliett";
var bandanarope = {};
class BandanaRope extends PIXI.SimpleRope {
  constructor(a, b) {
    super(a, [new PIXI.Point(), new PIXI.Point(), new PIXI.Point(), new PIXI.Point()]);
    this.target = b;
    this.ttl = -1;
    this.scale.x = this.scale.y = 0.15;
    this.x = this.target.p.x;
    this.y = this.target.p.y;
    this.alphaDrop = this.vy = this.vx = 0;
    this.delta = 45;
    this.points = this.geometry.points;
  }
  update() {
    var a =
      this.target.facingDir === Player.FACING_LEFT
        ? this.target.head.p.r + 0.1
        : this.target.head.p.r - 0.1 + Math.PI;
    this.x = this.target.head.p.x - 6 * Math.cos(a);
    this.y = this.target.head.p.y - 6 * Math.sin(a);
    for (a = 1; 4 > a; a++) {
      let c = this.points[a],
        d = this.points[a - 1];
      c.x -= this.target.p.vx;
      c.y -= this.target.p.vy - PC.GRAVITY.y * (0.6 - 0.1 * a);
      var b = c.x - d.x;
      let e = c.y - d.y;
      b * b + e * e > this.delta * this.delta &&
        ((b = Math.atan2(e, b)),
        (c.x = d.x + this.delta * Math.cos(b)),
        (c.y = d.y + this.delta * Math.sin(b)));
    }
  }
}
BandanaRope.FX = ParticleEffects.BandanaRope;
var bullettrailrope = {};
class BulletTrailRope extends PIXI.SimpleRope {
  constructor(a, b) {
    super(a, [new PIXI.Point(), new PIXI.Point(), new PIXI.Point(), new PIXI.Point()]);
    this.target = b;
    this.ttl = -1;
    this.x = this.target.p.x;
    this.y = this.target.p.y;
    this.alphaDrop = 0;
    this.scale.x = 1.25;
    this.scale.y = 1.25;
    this.vy = this.vx = 0;
    this.delta = 20;
    this.points = this.geometry.points;
  }
  update() {
    this.x = this.target.p.x;
    this.y = this.target.p.y;
    for (let b = 1; 4 > b; b++) {
      let c = this.points[b],
        d = this.points[b - 1];
      c.x -= this.target.p.vx;
      c.y -= this.target.p.vy;
      var a = c.x - d.x;
      let e = c.y - d.y;
      a * a + e * e > this.delta * this.delta &&
        ((a = Math.atan2(e, a)),
        (c.x = d.x + this.delta * Math.cos(a)),
        (c.y = d.y + this.delta * Math.sin(a)));
    }
  }
}
BulletTrailRope.FX = ParticleEffects.BulletTrailRope;
function ShockwaveFilter() {
  PIXI.Filter.call(
    this,
    "precision mediump float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vVertexPosition;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vVertexPosition = aVertexPosition;\n}",
    "precision mediump float;\n#define M_PI 3.1415926535897932384626433832795\n#define WL 50.0\nvarying vec2 vVertexPosition;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float time;\nuniform float radius;\nuniform vec2 pos;\nuniform vec2 res;\nvoid main(void){\n   float radius = time * radius;\n   vec2 diff = vVertexPosition - pos;\n   float dist = length(diff);\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   if(dist < radius + WL * 0.5){\n       float delta = (dist + WL * 0.5) - radius;\n       if(abs(delta) < WL){\n           vec2 vShock = normalize(diff) * sin(M_PI / WL * delta) * 0.015 * (1.0 - time);\n           color = texture2D(uSampler, vTextureCoord - vShock);\n       }\n   }\n   gl_FragColor = color;\n}",
    {
      radius: ShockwaveFilter.DefaultRadius,
      time: 0,
      res: { x: App.ClientWidth, y: App.ClientHeight },
      pos: { x: 0, y: 0 },
    }
  );
}
ShockwaveFilter.prototype = Object.create(PIXI.Filter.prototype);
ShockwaveFilter.prototype.constructor = ShockwaveFilter;
Object.defineProperties(ShockwaveFilter.prototype, {
  time: {
    get: function () {
      return this.uniforms.time;
    },
    set: function (a) {
      this.uniforms.time = a;
    },
  },
  pos: {
    get: function () {
      return this.uniforms.pos;
    },
    set: function (a) {
      this.uniforms.pos = [a.x, a.y];
    },
  },
  res: {
    get: function () {
      return this.uniforms.res;
    },
    set: function (a) {
      this.uniforms.res = [a.x, a.y];
    },
  },
  radius: {
    get: function () {
      return this.uniforms.radius;
    },
    set: function (a) {
      this.uniforms.radius = a;
    },
  },
});
ShockwaveFilter.DefaultRadius = 200;
function VertexColorFilter(a) {
  PIXI.Shader.call(
    this,
    a,
    "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vVertexPosition;\nuniform mat3 uTransform;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n   vVertexPosition = aVertexPosition;\n}",
    "varying vec2 vTextureCoord;\nvarying vec2 vVertexPosition;\nuniform vec4 uColor;\nuniform sampler2D uSampler;\nuniform vec4 color;\nuniform vec2 v1;\nuniform vec2 v2;\nuniform vec2 v3;\nuniform vec4 v1c;\nuniform vec4 v2c;\nuniform vec4 v3c;\nfloat TriArea(vec2 s1, vec2 s2){\nfloat a = length(s1);\nfloat b = length(s2);\nfloat c = length(s1 - s2);\nfloat p = (a + b + c) * 0.5;\nreturn p * (p - a) * (p - b) * (p - c);\n}\nvoid main(void)\n{\n   vec4 pixel = texture2D(uSampler, vTextureCoord);\n   vec2 d1 = v1 - vVertexPosition;\n   vec2 d2 = v2 - vVertexPosition;\n   vec2 d3 = v3 - vVertexPosition;\n   float a1 = TriArea(d2, d3);\n   float a2 = TriArea(d1, d3);\n   float a3 = TriArea(d2, d1);\n   pixel *= (a1 * v1c + a2 * v2c + a3 * v3c) / (a1 + a2 + a3) * color * uColor;\n   gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}"
  );
}
VertexColorFilter.prototype = Object.create(PIXI.Shader.prototype);
VertexColorFilter.prototype.constructor = VertexColorFilter;
VertexColorFilter.VertexShader =
  "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vVertexPosition;\nuniform mat3 uTransform;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n   vVertexPosition = aVertexPosition;\n}";
VertexColorFilter.FragmentShader =
  "varying vec2 vTextureCoord;\nvarying vec2 vVertexPosition;\nuniform vec4 uColor;\nuniform sampler2D uSampler;\nuniform vec4 color;\nuniform vec2 v1;\nuniform vec2 v2;\nuniform vec2 v3;\nuniform vec4 v1c;\nuniform vec4 v2c;\nuniform vec4 v3c;\nfloat TriArea(vec2 s1, vec2 s2){\nfloat a = length(s1);\nfloat b = length(s2);\nfloat c = length(s1 - s2);\nfloat p = (a + b + c) * 0.5;\nreturn p * (p - a) * (p - b) * (p - c);\n}\nvoid main(void)\n{\n   vec4 pixel = texture2D(uSampler, vTextureCoord);\n   vec2 d1 = v1 - vVertexPosition;\n   vec2 d2 = v2 - vVertexPosition;\n   vec2 d3 = v3 - vVertexPosition;\n   float a1 = TriArea(d2, d3);\n   float a2 = TriArea(d1, d3);\n   float a3 = TriArea(d2, d1);\n   pixel *= (a1 * v1c + a2 * v2c + a3 * v3c) / (a1 + a2 + a3) * color * uColor;\n   gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
function ParticleEmitter(a, b, c, d, e, f, g, h, k, m, l) {
  this.parent = a;
  this.emits = b;
  this.offset = c || { x: 0, y: 0 };
  this.frequency = d || 0;
  this.count = e || 0;
  this.ttl = f || -1;
  this.probability = g || 1;
  this.width = h || 0;
  this.height = k || 0;
  if (0 !== this.width || 0 !== this.height) this.area = !0;
  void 0 !== m && (this.tint = m);
  void 0 !== l && (this.id = l);
}
function AnchorBase() {
  this.anchors = {};
  this.addAnchor = function (a, b) {
    this.anchors[a] = b;
    b.visible = !1;
    this.addChild(b);
  };
  this.getAnchorTransform = function (a) {
    a = this.anchors[a];
    a.visible = !0;
    a.updateTransform();
    a.visible = !1;
    return { x: a.worldTransform.tx, y: a.worldTransform.ty };
  };
}
var basesprite = {};
class BaseSprite extends PIXI.Container {
  constructor(a) {
    super();
    this.go = a;
    this.bounds = { x: 0, y: 0, width: 1, height: 1 };
  }
  update() {
    this.updateGraphics();
  }
  updateGraphics() {
    let a = this.go.g;
    this.removeChildren();
    this.scale.x = a.sx || 1;
    this.scale.y = a.sy || 1;
    if (void 0 === a.pf)
      1 === a.t
        ? this.constructColoredMesh("0x" + a.c)
        : 2 === a.t && this.constructTexturedMesh(App.CombinedTextures[a.tx]);
    else if (2 === a.t && App.CombinedTextures[a.tx]) {
      let b = new PIXI.Sprite(App.CombinedTextures[a.tx]);
      b.x = 0.5 * -b.width;
      b.y = 0.5 * -b.height;
      b.alpha = void 0 !== a.a ? a.a : 1;
      b.rotation = a.r || 0;
      a.c && (b.tint = "0x" + a.c);
      this.addChild(b);
    }
    this.go.bounds = this.getLocalBounds();
  }
  constructTexturedMesh(a) {
    let b = this.go.p.sh || [],
      c = this.go.g,
      d;
    for (let e = 0, f = b.length; e < f; e++) {
      let g = b[e];
      g.t === GameShape.POLYGON
        ? ((d = this.constructPolyMesh(a, c.uv, g, c)),
          (this.go.bounds = polyBounds(polyRotateCopy(g.v, this.rotation))))
        : g.t === GameShape.RECTANGLE
        ? ((d = this.constructRectMesh(a, c.uv, g, c)), (this.go.bounds = d.getBounds()))
        : g.t === GameShape.CIRCLE &&
          ((d = this.constructCircleMesh(a, c.uv, g, c)), (this.go.bounds = d.getBounds()));
      d &&
        ((d.alpha = void 0 !== c.a ? c.a : 1),
        (d.x = -(c.ox || 0)),
        (d.y = -(c.oy || 0)),
        (d.rotation = c.r || 0),
        this.addChild(d));
    }
  }
  constructPolyMesh(a, b, c, d) {
    var e = [c.v[0].x, c.v[0].y, c.v[1].x, c.v[1].y, c.v[2].x, c.v[2].y];
    if (void 0 === d.vc) {
      c = void 0 !== d.a ? d.a : 1;
      let f, g, h;
      void 0 === d.v
        ? (f = g = h = BaseSprite.DefaultColor)
        : ((f = d.v[0]
            ? uintToArr(d.v[0].c || "ffffffff", d.v[0].mu || 1)
            : BaseSprite.DefaultColor),
          (g = d.v[1]
            ? uintToArr(d.v[1].c || "ffffffff", d.v[1].mu || 1)
            : BaseSprite.DefaultColor),
          (h = d.v[2]
            ? uintToArr(d.v[2].c || "ffffffff", d.v[2].mu || 1)
            : BaseSprite.DefaultColor));
      b = new PIXI.Geometry()
        .addAttribute("aVertexPosition", e, 2)
        .addAttribute("aColor", f.concat(g, h), 4)
        .addAttribute("aUvs", b, 2);
      e = {};
      e.uSampler2 = a;
      e.color = uintToArr("ff" + (d.c || "ffffff"), 1);
      e.color[3] *= c;
      a = new PIXI.Shader(BaseSprite.Program, e);
      a = new PIXI.Mesh(b, a);
      a.alpha = c;
      return a;
    }
    return new PIXI.SimpleMesh(
      a,
      new Float32Array(e),
      new Float32Array(b),
      new Uint16Array([0, 1, 2]),
      PIXI.DRAW_MODES.TRIANGLE_STRIP
    );
  }
  constructRectMesh(a, b, c, d) {
    let e = c.o.x,
      f = c.o.y;
    var g = Math.sqrt(c.w * c.w + c.h * c.h),
      h = Math.atan2(c.h, c.w) + (c.r || 0);
    let k = Math.atan2(c.w, c.h) + (c.r || 0);
    c = Math.cos(h + Math.PI) * g + e;
    h = Math.sin(h + Math.PI) * g + f;
    let m = Math.cos(k + 0.5 * Math.PI) * g + e;
    g = Math.sin(k + 0.5 * Math.PI) * g + f;
    a = new PIXI.SimpleMesh(
      a,
      new Float32Array([
        c,
        h,
        m,
        g,
        -1 * c + 2 * e,
        -1 * h + 2 * f,
        -1 * m + 2 * e,
        -1 * g + 2 * f,
      ]),
      new Float32Array(b),
      new Uint16Array([0, 1, 3, 2]),
      PIXI.DRAW_MODES.TRIANGLE_STRIP
    );
    a.tint = parseInt(d.c || "ffffff", 16);
    return a;
  }
  constructCircleMesh(a, b, c, d) {
    let e = 8 + Math.ceil(c.radius / 3),
      f = (2 * Math.PI) / e,
      g = polyCenterArr(b),
      h = [],
      k = [],
      m = [g.x, g.y];
    var l = g.x - b[0],
      p = g.y - b[1];
    l = Math.sqrt(l * l + p * p);
    b = Math.atan2(b[3] - b[1], b[2] - b[0]);
    for (p = 0; p < e + 1; p++) {
      var n = f * p;
      h.push(Math.cos(n + (c.r || 0)) * c.radius, Math.sin(n + (c.r || 0)) * c.radius);
      var r = Math.atan2(h[2 * p] / c.radius, h[2 * p + 1] / c.radius);
      n = g.x + l * Math.cos(r + b);
      r = g.y + l * Math.sin(r + b);
      h[2 * p] += c.o.x;
      h[2 * p + 1] += c.o.y;
      m.push(n, r);
      0 < p && k.push(0, p);
    }
    h.unshift(c.o.x, c.o.y);
    k.push(0, 1);
    a = new PIXI.SimpleMesh(
      a,
      new Float32Array(h),
      new Float32Array(m),
      new Uint16Array(k),
      PIXI.DRAW_MODES.TRIANGLE_STRIP
    );
    a.tint = parseInt(d.c || "ffffff", 16);
    return a;
  }
  constructColoredMesh(a) {
    let b = new PIXI.Graphics();
    b.beginFill(parseInt(a, 16), 1);
    b.drawRect(0, 0, 128, 128);
    b.endFill();
    a = App.Renderer.generateTexture(b);
    this.constructTexturedMesh(a);
  }
}
BaseSprite.MeshIDMap = {};
BaseSprite.MeshIDGroups = [];
BaseSprite.TextureIDMap = [];
BaseSprite.Create = function (a) {
  var b = a.p.sh || [];
  a.g.tx = BaseSprite.TextureIDMap[a.g.tx];
  if (
    1 === b.length &&
    b[0].t === GameShape.POLYGON &&
    void 0 === a.g.pf &&
    App.CombinedTextures[a.g.tx]
  ) {
    if (void 0 !== a.g.g && "" !== a.g.g && void 0 !== BaseSprite.MeshIDGroups[a.g.g]) {
      var c = BaseSprite.MeshIDGroups[a.g.g];
      b = a.g.g;
      void 0 === BaseSprite.MeshIDMap[b] && (BaseSprite.MeshIDMap[b] = []);
      BaseSprite.MeshIDMap[b].push(a);
      a.transform &&
        (BaseSprite.MeshIDMap[b].transform = { type: a.transform, options: a.transformOptions });
      if (BaseSprite.MeshIDMap[b].length < c)
        return (a.bounds = polyBounds(polyRotateCopy(a.p.sh[0].v, a.p.r || 0))), null;
      c = BaseSprite.MeshIDMap[b];
      delete BaseSprite.MeshIDMap[b];
      return BaseSprite.CreateGroupedMesh(a, c);
    }
    return BaseSprite.CreateMesh(a);
  }
  return new BaseSprite(a);
};
BaseSprite.CreateMesh = function (a) {
  let b = a.g;
  var c = a.p.sh[0].v;
  c = [c[0].x, c[0].y, c[1].x, c[1].y, c[2].x, c[2].y];
  let d, e;
  if (void 0 === b.v) var f = (d = e = BaseSprite.DefaultColor);
  else
    (f = b.v[0] ? uintToArr(b.v[0].c || "ffffffff", b.v[0].mu || 1) : BaseSprite.DefaultColor),
      (d = b.v[1] ? uintToArr(b.v[1].c || "ffffffff", b.v[1].mu || 1) : BaseSprite.DefaultColor),
      (e = b.v[2] ? uintToArr(b.v[2].c || "ffffffff", b.v[2].mu || 1) : BaseSprite.DefaultColor);
  c = new PIXI.Geometry()
    .addAttribute("aVertexPosition", c, 2)
    .addAttribute("aColor", f.concat(d, e), 4)
    .addAttribute("aUvs", b.uv, 2);
  let g = void 0 !== b.a ? b.a : 1;
  f = { uSampler2: App.CombinedTextures[b.tx], color: uintToArr("ff" + (b.c || "ffffff"), 1) };
  f.color[3] *= g;
  f = new PIXI.Shader(BaseSprite.Program, f);
  let h = new PIXI.Mesh(c, f);
  a.bounds = polyBounds(polyRotateCopy(a.p.sh[0].v, a.p.r || 0));
  h.go = a;
  h.update = () => {
    h.scale.x = b.sx || 1;
    h.scale.y = b.sy || 1;
    h.alpha = g;
  };
  return h;
};
BaseSprite.CreateGroupedMesh = function (a, b) {
  var c = [],
    d = [];
  let e = b.length;
  for (let r = 0; r < e; r++) {
    var f = b[r],
      g = f.g,
      h = 0 !== f.p.r ? polyRotateCopy(f.p.sh[0].v, f.p.r || 0) : f.p.sh[0].v,
      k = a.p.x - f.p.x;
    f = a.p.y - f.p.y;
    h = [h[0].x - k, h[0].y - f, h[1].x - k, h[1].y - f, h[2].x - k, h[2].y - f];
    d.push(g.uv[0], g.uv[1], g.uv[2], g.uv[3], g.uv[4], g.uv[5]);
    void 0 === g.v
      ? (k = f = g = BaseSprite.DefaultColor)
      : ((k = g.v[0] ? uintToArr(g.v[0].c || "ffffffff", g.v[0].mu || 1) : BaseSprite.DefaultColor),
        (f = g.v[1] ? uintToArr(g.v[1].c || "ffffffff", g.v[1].mu || 1) : BaseSprite.DefaultColor),
        (g = g.v[2] ? uintToArr(g.v[2].c || "ffffffff", g.v[2].mu || 1) : BaseSprite.DefaultColor));
    c.push(
      new PIXI.Geometry()
        .addAttribute("aVertexPosition", h, 2)
        .addAttribute("aColor", k.concat(f, g), 4)
    );
  }
  let m = a.g;
  c = PIXI.Geometry.merge(c);
  c.addAttribute("aUvs", d);
  let l = void 0 !== m.a ? m.a : 1;
  d = { uSampler2: App.CombinedTextures[m.tx], color: uintToArr("ff" + (m.c || "ffffff"), 1) };
  d.color[3] *= l;
  if (b.transform)
    switch (((b = b.transform), b.type)) {
      case GameAttribute.T_TRANSFORM:
        d.t = Math.floor(1e4 * Math.random());
        a.g.updateUniforms = !0;
        d.va = [parseFloat(b.options.vha), parseFloat(b.options.vva)];
        d.vf = [parseFloat(b.options.vhf), parseFloat(b.options.vvf)];
        d.vl = [parseFloat(b.options.vlx), parseFloat(b.options.vly)];
        d.vo = [parseFloat(b.options.vox), parseFloat(b.options.voy)];
        var p = BaseSprite.TransformProgram;
        break;
      case GameAttribute.T_FLUID:
        d.t = Math.floor(1e4 * Math.random());
        a.g.updateUniforms = !0;
        d.w = b.options.w;
        p = BaseSprite.FluidProgram;
        break;
      case GameAttribute.T_UV_ROTATE:
        d.t = Math.floor(1e4 * Math.random());
        a.g.updateUniforms = !0;
        d.av = parseFloat(b.options.av);
        d.p = [parseFloat(b.options.px), parseFloat(b.options.py)];
        d.os = parseInt(b.options.os, 10);
        p = new PIXI.Program(
          BaseSprite.ColoredVertexSource,
          BaseSprite.UVRotateFragmentSource,
          "def_uv_rotate"
        );
        break;
      case GameAttribute.T_TRANSFORM | GameAttribute.T_UV_ROTATE:
        d.t = Math.floor(1e4 * Math.random());
        a.g.updateUniforms = !0;
        d.av = parseFloat(b.options.av);
        d.os = parseInt(b.options.os, 10);
        d.p = [parseFloat(b.options.px), parseFloat(b.options.py)];
        d.va = [parseFloat(b.options.vha), parseFloat(b.options.vva)];
        d.vf = [parseFloat(b.options.vhf), parseFloat(b.options.vvf)];
        d.vl = [parseFloat(b.options.vlx), parseFloat(b.options.vly)];
        d.vo = [parseFloat(b.options.vox), parseFloat(b.options.voy)];
        p = new PIXI.Program(
          BaseSprite.TransformVertexSource,
          BaseSprite.UVRotateFragmentSource,
          "tr_uv_rotate"
        );
        break;
      case GameAttribute.T_UV_TRANSLATE:
        d.t = Math.floor(1e4 * Math.random());
        a.g.updateUniforms = !0;
        d.v = [parseFloat(b.options.vx), parseFloat(b.options.vy)];
        p = new PIXI.Program(
          BaseSprite.ColoredVertexSource,
          BaseSprite.UVTranslateFragmentSource,
          "def_uv_translate"
        );
        break;
      case GameAttribute.T_TRANSFORM | GameAttribute.T_UV_TRANSLATE:
        (d.t = Math.floor(1e4 * Math.random())),
          (a.g.updateUniforms = !0),
          (d.v = [parseFloat(b.options.vx), parseFloat(b.options.vy)]),
          (d.va = [parseFloat(b.options.vha), parseFloat(b.options.vva)]),
          (d.vf = [parseFloat(b.options.vhf), parseFloat(b.options.vvf)]),
          (d.vl = [parseFloat(b.options.vlx), parseFloat(b.options.vly)]),
          (d.vo = [parseFloat(b.options.vox), parseFloat(b.options.voy)]),
          (p = new PIXI.Program(
            BaseSprite.TransformVertexSource,
            BaseSprite.UVTranslateFragmentSource,
            "tr_uv_translate"
          ));
    }
  else p = BaseSprite.Program;
  p = new PIXI.Shader(p, d);
  let n = new PIXI.Mesh(c, p);
  n.go = a;
  n.update = () => {
    n.scale.x = m.sx || 1;
    n.scale.y = m.sy || 1;
    n.alpha = l;
    n.rotation = 0;
    a.bounds = n.getLocalBounds();
  };
  return n;
};
BaseSprite.ExtractOutline = function (a) {
  let b = a.p.sh || [],
    c = [];
  for (let d = 0, e = b.length; d < e; d++)
    if (b[d].c == EntityCategory.STATIC_WORLD && b[d].t === GameShape.POLYGON) {
      let f = polyRotateCopy(b[d].v, a.p.r || 0);
      c.push({ x1: a.p.x + f[0].x, y1: a.p.y + f[0].y, x2: f[1].x - f[0].x, y2: f[1].y - f[0].y });
      c.push({ x1: a.p.x + f[1].x, y1: a.p.y + f[1].y, x2: f[2].x - f[1].x, y2: f[2].y - f[1].y });
      c.push({ x1: a.p.x + f[2].x, y1: a.p.y + f[2].y, x2: f[0].x - f[2].x, y2: f[0].y - f[2].y });
    }
  return c;
};
BaseSprite.ColoredVertexSource =
  "\nprecision highp float;\nattribute vec2 aVertexPosition;\nattribute vec4 aColor;\nattribute vec2 aUvs;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nvarying vec2 vUvs;\nvarying vec4 vColor;\nvoid main() {\n    vUvs = aUvs;\n    vColor = aColor;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n}";
BaseSprite.ColoredFragmentSource =
  "\nprecision highp float;\nvarying vec4 vColor;\nvarying vec2 vUvs;\nuniform vec4 color;\nuniform sampler2D uSampler2;\nvoid main() {\n\tvec4 pixel = texture2D(uSampler2, vUvs);\n\tpixel *= color * vColor;\n  gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
BaseSprite.DefaultColor = [1, 1, 1, 1];
BaseSprite.Program = new PIXI.Program(
  BaseSprite.ColoredVertexSource,
  BaseSprite.ColoredFragmentSource,
  "bsp"
);
BaseSprite.TransformVertexSource =
  "\nprecision highp float;\nattribute vec2 aVertexPosition;\nattribute vec4 aColor;\nattribute vec2 aUvs;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nuniform float t;\nuniform vec2 va;\nuniform vec2 vf;\nuniform vec2 vl;\nuniform vec2 vo;\nvarying vec2 vUvs;\nvarying vec4 vColor;\nvoid main() {\n    vUvs = aUvs;\n    vColor = aColor;\n    vec2 pos = vec2(aVertexPosition);\n    float dx = 0.0;\n    float dy = 0.0;\n    if (vo.x != 0.0 && vo.y != 0.0) {\n      dx = clamp(vo.x == 0.0 ? 100.0 : vo.x - pos.x, -100.0, 100.0);\n      dy = clamp(vo.y == 0.0 ? 100.0 : vo.y - pos.y, -100.0, 100.0);\n    } else if (vo.y == 0.0){\n      dx = clamp(vo.x == 0.0 ? 100.0 : vo.x - pos.x, -100.0, 100.0);\n      dy = 0.0;\n    } else if (vo.x == 0.0){\n      dx = 0.0;\n      dy = clamp(vo.y == 0.0 ? 100.0 : vo.y - pos.y, -100.0, 100.0);\n    }\n    pos.x += sin(t * 0.01 * vf.x + 1.0 / vl.x * pos.y) * va.x * dy * 0.01;\n    pos.y += sin(t * 0.01 * vf.y + 1.0 / vl.y * pos.x) * va.y * dx * 0.01;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(pos, 1.0)).xy, 0.0, 1.0);\n}";
BaseSprite.TransformFragmentSource =
  "\nprecision highp float;\nvarying vec4 vColor;\nvarying vec2 vUvs;\nuniform vec4 color;\nuniform vec2 vo;\nuniform sampler2D uSampler2;\nvoid main() {\n\tvec4 pixel = texture2D(uSampler2, vUvs);\n\tpixel *= color * vColor;\n  gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
BaseSprite.DefaultColor = [1, 1, 1, 1];
BaseSprite.TransformProgram = new PIXI.Program(
  BaseSprite.TransformVertexSource,
  BaseSprite.TransformFragmentSource,
  "transform"
);
BaseSprite.FluidVertexSource =
  "\nprecision highp float;\nattribute vec2 aVertexPosition;\nattribute vec4 aColor;\nattribute vec2 aUvs;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nuniform float t;\nuniform float w;\nvarying vec2 vUvs;\nvarying vec4 vColor;\nvarying vec2 vPos;\nvoid main() {\n    vUvs = aUvs;\n    vColor = aColor;\n    vPos = aVertexPosition;\n    vPos[1] -= 15.0 + sin(t * 0.04 + aVertexPosition.x * 0.1) * w;\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(vPos, 1.0)).xy, 0.0, 1.0);\n}";
BaseSprite.FluidFragmentSource =
  "\nprecision highp float;\nvarying vec4 vColor;\nvarying vec2 vUvs;\nvarying vec2 vPos;\nuniform vec4 color;\nuniform sampler2D uSampler2;\nuniform float t;\nvoid main() {\n\tvec4 pixel = texture2D(uSampler2, vUvs + vec2(sin(t * 0.01) * 0.1, cos(t * 0.001)));\n  float shine = -(sin(t * 0.04 + vPos.x * 0.004) + 0.4) * 0.2;\n\tpixel *= color * vColor + vec4(shine, shine, shine, 0.0);\n  gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
BaseSprite.FluidProgram = new PIXI.Program(
  BaseSprite.FluidVertexSource,
  BaseSprite.FluidFragmentSource,
  "fluid"
);
BaseSprite.UVTranslateFragmentSource =
  "\nprecision highp float;\nvarying vec4 vColor;\nvarying vec2 vUvs;\nuniform vec4 color;\nuniform float t;\nuniform vec2 v;\nuniform sampler2D uSampler2;\nvoid main() {\n\tvec4 pixel = texture2D(uSampler2, vUvs + t * 0.01 * v);\n\tpixel *= color * vColor;\n  gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
BaseSprite.UVRotateFragmentSource =
  "\nprecision highp float;\nvarying vec4 vColor;\nvarying vec2 vUvs;\nuniform vec4 color;\nuniform float t;\nuniform float av;\nuniform int os;\nuniform vec2 p;\nuniform sampler2D uSampler2;\nvoid main() {\n  vec2 diff = vUvs - p;\n  float theta = atan(diff.y, diff.x);\n  float delta = length(diff);\n  vec2 pos = vec2(delta * cos(theta + t * av), delta * sin(theta + t * av));\n\tvec4 pixel = texture2D(uSampler2, pos);\n\tpixel *= color * vColor;\n  gl_FragColor = vec4(pixel.rgb * pixel.a, pixel.a);\n}";
function GoldSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.gold);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.16;
  this.scale.y = 0.16;
}
GoldSprite.prototype = Object.create(PIXI.Sprite.prototype);
GoldSprite.prototype.constructor = GoldSprite;
GoldSprite.prototype.animate = function (a) {};
GoldSprite.prototype.init = function () {
  this.alpha = 1;
};
function BallSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.ball);
  this.rotation = Math.PI;
  this.anchor.x = 0.15;
  this.anchor.y = 0.5;
}
BallSprite.prototype = Object.create(PIXI.Sprite.prototype);
BallSprite.prototype.constructor = BallSprite;
BallSprite.prototype.pointLeft = function () {
  this.scale.x = -1.3;
  this.scale.y = -1.3;
};
BallSprite.prototype.pointRight = function () {
  this.scale.x = -1.3;
  this.scale.y = 1.3;
};
BallSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
BallSprite.prototype.init = function () {
  this.alpha = 1;
};
function FlagSprite(a) {
  PIXI.Sprite.call(this);
  this.flagPole = new PIXI.Sprite(App.CombinedTextures.flagpole);
  this.cloth = "flag_" + Team.Colors[a.team];
  this.flagPole.scale.x = 2;
  this.flagPole.scale.y = 2;
  this.flagPole.anchor.x = this.flagPole.anchor.y = 0.5;
  this.verts = [0, 10, 80, 10, 80, -50, 0, -115];
  this.mesh = this.constructMesh();
  this.p2v = { x: 0, y: 0 };
  this.p3v = { x: 0, y: 0 };
  this.p2 = { x: 0, y: 10 };
  this.p3 = { x: 0, y: -115 };
  this.flagStretch = 100;
  this.time = 0;
  this.d0s = Math.sqrt(100);
  this.a0s = Math.atan2(10, 0);
  this.d1s = Math.sqrt(13225);
  this.a1s = Math.atan2(-115, 0);
  this.addChild(this.flagPole);
  this.addChild(this.mesh);
}
FlagSprite.prototype = Object.create(PIXI.Sprite.prototype);
FlagSprite.prototype.constructor = FlagSprite;
FlagSprite.prototype.pointLeft = function () {
  this.scale.x = -0.5;
  this.scale.y = -0.5;
};
FlagSprite.prototype.pointRight = function () {
  this.scale.x = -0.5;
  this.scale.y = 0.5;
};
FlagSprite.prototype.animate = function (a) {
  var b = a.x,
    c = a.y,
    d = a.vx || 0,
    e = a.vy || 0,
    f = this.mesh,
    g = 0;
  0.01 < d * d + e * e && 0.5 < Math.abs(d)
    ? (this.time = 0)
    : 40 <= ++this.time && (g = Math.sin(0.05 * (this.time - 40)) * Math.PI * 0.7);
  f.rotation = -a.r + g;
  a = this.d0s * Math.cos(this.a0s - f.rotation);
  g = this.d0s * Math.sin(this.a0s - f.rotation);
  var h = this.d1s * Math.cos(this.a1s - f.rotation),
    k = this.d1s * Math.sin(this.a1s - f.rotation);
  this.p2v.x = 0.2 * (this.p2v.x + 0.5 * PC.GRAVITY.x);
  this.p2v.y = 0.2 * (this.p2v.y + 0.5 * PC.GRAVITY.y);
  var m = this.p2.x + this.p2v.x - (a + b),
    l = this.p2.y + this.p2v.y - (g + c),
    p = Math.atan2(l, m);
  m * m + l * l > this.flagStretch * this.flagStretch &&
    ((this.p2v.x = 0.5 * -d),
    (this.p2v.y = 0.5 * -e),
    (this.p2.x = a + b + (this.flagStretch - 1) * Math.cos(p)),
    (this.p2.y = g + c + (this.flagStretch - 1) * Math.sin(p)));
  this.p2.x += this.p2v.x;
  this.p2.y += this.p2v.y;
  this.p3v.x = 0.7 * (this.p3v.x + 0.5 * PC.GRAVITY.x);
  this.p3v.y = 0.7 * (this.p3v.y + 0.5 * PC.GRAVITY.y);
  m = this.p3.x + this.p3v.x - (h + b);
  l = this.p3.y + this.p3v.y - (k + c);
  p = Math.atan2(l, m);
  m * m + l * l > this.flagStretch * this.flagStretch &&
    ((this.p3v.x = 0.7 * -d),
    (this.p3v.y = 0.7 * -e),
    (this.p3.x = h + b + (this.flagStretch - 1) * Math.cos(p)),
    (this.p3.y = k + c + (this.flagStretch - 1) * Math.sin(p)));
  this.p3.x += this.p3v.x;
  this.p3.y += this.p3v.y;
  f.vertices[0] = a;
  f.vertices[1] = g;
  f.vertices[2] = this.p2.x - b;
  f.vertices[3] = this.p2.y - c;
  f.vertices[4] = this.p3.x - b;
  f.vertices[5] = this.p3.y - c;
  f.vertices[6] = h;
  f.vertices[7] = k;
};
FlagSprite.prototype.init = function (a) {
  this.alpha = 1;
  this.p2.x = a.x;
  this.p2.y = a.y + 10;
  this.p3.x = a.x;
  this.p3.y = a.y - 115;
};
FlagSprite.prototype.constructMesh = function () {
  return new PIXI.SimpleMesh(
    App.CombinedTextures[this.cloth],
    new Float32Array(this.verts),
    new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),
    new Uint16Array([0, 1, 2, 0, 2, 3]),
    PIXI.DRAW_MODES.TRIANGLE_STRIP
  );
};
function AK47AmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.ak47_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.56;
  this.scale.x = 0.3;
  this.scale.y = 0.3;
}
AK47AmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
AK47AmmoSprite.prototype.constructor = AK47AmmoSprite;
AK47AmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
AK47AmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function BarrettAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.barrett_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.38;
  this.scale.y = 0.38;
}
BarrettAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
BarrettAmmoSprite.prototype.constructor = BarrettAmmoSprite;
BarrettAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
BarrettAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function ChainsawAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.chainsaw_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.65;
  this.scale.x = 0.55;
  this.scale.y = 0.55;
}
ChainsawAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
ChainsawAmmoSprite.prototype.constructor = ChainsawAmmoSprite;
ChainsawAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ChainsawAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function ClusterNadeBoxSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.clusternadebox);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.32;
  this.scale.y = 0.32;
}
ClusterNadeBoxSprite.prototype = Object.create(PIXI.Sprite.prototype);
ClusterNadeBoxSprite.prototype.constructor = ClusterNadeBoxSprite;
ClusterNadeBoxSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ClusterNadeBoxSprite.prototype.init = function () {
  this.alpha = 1;
};
function DesertEagleAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.deagle_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.32;
  this.scale.y = 0.32;
}
DesertEagleAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
DesertEagleAmmoSprite.prototype.constructor = DesertEagleAmmoSprite;
DesertEagleAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
DesertEagleAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function FlameThrowerAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.flamethrower_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.5;
  this.scale.y = 0.5;
}
FlameThrowerAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
FlameThrowerAmmoSprite.prototype.constructor = FlameThrowerAmmoSprite;
FlameThrowerAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
FlameThrowerAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function HealthBoxSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.healthbox);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.32;
  this.scale.y = 0.32;
}
HealthBoxSprite.prototype = Object.create(PIXI.Sprite.prototype);
HealthBoxSprite.prototype.constructor = HealthBoxSprite;
HealthBoxSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
HealthBoxSprite.prototype.init = function () {
  this.alpha = 1;
};
function LaserGunAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.lasergun_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.37;
  this.scale.y = 0.37;
}
LaserGunAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
LaserGunAmmoSprite.prototype.constructor = LaserGunAmmoSprite;
LaserGunAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
LaserGunAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function LinkGunAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.linkgun_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.35;
  this.scale.y = 0.35;
}
LinkGunAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
LinkGunAmmoSprite.prototype.constructor = LinkGunAmmoSprite;
LinkGunAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
LinkGunAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function MAC10AmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.mac10_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.38;
  this.scale.y = 0.38;
}
MAC10AmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
MAC10AmmoSprite.prototype.constructor = MAC10AmmoSprite;
MAC10AmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
MAC10AmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function MinigunAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.minigun_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.4;
  this.scale.y = 0.4;
}
MinigunAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
MinigunAmmoSprite.prototype.constructor = MinigunAmmoSprite;
MinigunAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
MinigunAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function NadeBoxSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.nadebox);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.32;
  this.scale.y = 0.32;
}
NadeBoxSprite.prototype = Object.create(PIXI.Sprite.prototype);
NadeBoxSprite.prototype.constructor = NadeBoxSprite;
NadeBoxSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
NadeBoxSprite.prototype.init = function () {
  this.alpha = 1;
};
function NadeLauncherAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.m79_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.28;
  this.scale.y = 0.28;
}
NadeLauncherAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
NadeLauncherAmmoSprite.prototype.constructor = NadeLauncherAmmoSprite;
NadeLauncherAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
NadeLauncherAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function PulseGunAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.pulsegun_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.35;
  this.scale.y = 0.35;
}
PulseGunAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
PulseGunAmmoSprite.prototype.constructor = PulseGunAmmoSprite;
PulseGunAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
PulseGunAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function RifleAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.m16_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.38;
  this.scale.y = 0.38;
}
RifleAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
RifleAmmoSprite.prototype.constructor = RifleAmmoSprite;
RifleAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
RifleAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function RPGAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.rpg_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.4;
  this.scale.y = 0.4;
}
RPGAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
RPGAmmoSprite.prototype.constructor = RPGAmmoSprite;
RPGAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
RPGAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function ShockRifleAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shockrifle_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.4;
  this.scale.y = 0.4;
}
ShockRifleAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShockRifleAmmoSprite.prototype.constructor = ShockRifleAmmoSprite;
ShockRifleAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ShockRifleAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function ShotgunAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shotgun_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.25;
  this.scale.y = 0.25;
}
ShotgunAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShotgunAmmoSprite.prototype.constructor = ShotgunAmmoSprite;
ShotgunAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ShotgunAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function ShurikenBoxSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shurikenbox);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.35;
  this.scale.y = 0.35;
}
ShurikenBoxSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShurikenBoxSprite.prototype.constructor = ShurikenBoxSprite;
ShurikenBoxSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ShurikenBoxSprite.prototype.init = function () {
  this.alpha = 1;
};
function SMGAmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.smg_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.4;
  this.scale.y = 0.4;
}
SMGAmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
SMGAmmoSprite.prototype.constructor = SMGAmmoSprite;
SMGAmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
SMGAmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function SnowballBoxSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.snowballbox);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.4;
  this.scale.y = 0.4;
}
SnowballBoxSprite.prototype = Object.create(PIXI.Sprite.prototype);
SnowballBoxSprite.prototype.constructor = SnowballBoxSprite;
SnowballBoxSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
SnowballBoxSprite.prototype.init = function () {
  this.alpha = 1;
};
function X75AmmoSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.x75_ammo);
  this.rotation = Math.PI;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.3;
  this.scale.y = 0.3;
}
X75AmmoSprite.prototype = Object.create(PIXI.Sprite.prototype);
X75AmmoSprite.prototype.constructor = X75AmmoSprite;
X75AmmoSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
X75AmmoSprite.prototype.init = function () {
  this.alpha = 1;
};
function AK47Sprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.ak47);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.32;
  this.anchor.y = 0.36;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
AK47Sprite.prototype = Object.create(PIXI.Sprite.prototype);
AK47Sprite.prototype.constructor = AK47Sprite;
AnchorBase.call(AK47Sprite.prototype);
AK47Sprite.prototype.pointLeft = function () {
  this.scale.x = -1.45;
  this.scale.y = -1.45;
};
AK47Sprite.prototype.pointRight = function () {
  this.scale.x = -1.45;
  this.scale.y = 1.45;
};
AK47Sprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
AK47Sprite.prototype.init = function () {
  this.alpha = 1;
};
function BarrettSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.barrett);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.2;
  this.anchor.y = 0.7;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 200;
  this.fireAnchor.y = -15;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
BarrettSprite.prototype = Object.create(PIXI.Sprite.prototype);
BarrettSprite.prototype.constructor = BarrettSprite;
AnchorBase.call(BarrettSprite.prototype);
BarrettSprite.prototype.pointLeft = function () {
  this.scale.x = -1.1;
  this.scale.y = -1.1;
};
BarrettSprite.prototype.pointRight = function () {
  this.scale.x = -1.1;
  this.scale.y = 1.1;
};
BarrettSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
BarrettSprite.prototype.init = function () {
  this.alpha = 1;
};
function BowSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.bow_item);
  AnchorBase.call(this);
  this.activeTexture = "bow1";
  this.rotation = Math.PI;
  this.anchor.x = 0.22;
  this.anchor.y = 0.58;
  this.frame = 0;
  this.customOffset = !0;
  this.secondaryRotation = 0 * Math.PI;
  this.secondaryAnchor = { x: 0.7, y: 0.4 };
  this.secondaryScale = { x: -1.8, y: 1.8 };
  this.animateWhenUsing = !0;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 200;
  this.fireAnchor.y = -15;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: -4, y: -4 };
  this.gearArmOffsetAnimating = { x: 18, y: -36 };
}
BowSprite.prototype = Object.create(PIXI.Sprite.prototype);
BowSprite.prototype.constructor = BowSprite;
AnchorBase.call(BowSprite.prototype);
BowSprite.Textures = [2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4];
BowSprite.Anchor = [
  { x: 0, y: 0 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
  { x: -0.2, y: -0.11 },
];
BowSprite.prototype.pointLeft = function () {
  this.scale.x = -1.6;
  this.scale.y = -2;
};
BowSprite.prototype.pointRight = function () {
  this.scale.x = -1.6;
  this.scale.y = 2;
};
BowSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
BowSprite.prototype.animateUsage = function (a = !0) {
  this.activeTexture = "bow" + BowSprite.Textures[this.frame];
  this.texture = App.CombinedTextures[this.activeTexture];
  a
    ? ((this.anchor.x = 0.22 + BowSprite.Anchor[this.frame].x),
      (this.anchor.y = 0.58 - BowSprite.Anchor[this.frame].y))
    : ((this.anchor.x = 0.22), (this.anchor.y = 0.58));
  this.frame = this.frame + 1 === BowSprite.Textures.length ? 0 : this.frame + 1;
};
BowSprite.prototype.applyDefaultTexture = function () {
  this.activeTexture = "bow1";
  this.texture = App.CombinedTextures[this.activeTexture];
  this.anchor.x = 0.22;
  this.anchor.y = 0.58;
};
BowSprite.prototype.init = function () {
  this.alpha = 1;
};
function CarbineSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.m1carbine);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.26;
  this.anchor.y = 0.6;
  this.secondaryScale = { x: 0.85, y: 0.85 };
  this.secondaryRotation = 1.08 * Math.PI;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 140;
  this.fireAnchor.y = -15;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 30;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: -8, y: -4 };
}
CarbineSprite.prototype = Object.create(PIXI.Sprite.prototype);
CarbineSprite.prototype.constructor = CarbineSprite;
AnchorBase.call(CarbineSprite.prototype);
CarbineSprite.prototype.pointLeft = function () {
  this.scale.x = -1.1;
  this.scale.y = -1.1;
};
CarbineSprite.prototype.pointRight = function () {
  this.scale.x = -1.1;
  this.scale.y = 1.1;
};
CarbineSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
CarbineSprite.prototype.init = function () {
  this.alpha = 1;
};
function ChainsawSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.chainsaw);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.15;
  this.anchor.y = 0.6;
  this.origin = { x: 0.5, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 0;
  this.fireAnchor.y = 0;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
ChainsawSprite.prototype = Object.create(PIXI.Sprite.prototype);
ChainsawSprite.prototype.constructor = ChainsawSprite;
AnchorBase.call(ChainsawSprite.prototype);
ChainsawSprite.prototype.pointLeft = function () {
  this.scale.x = -1.6;
  this.scale.y = -1.6;
};
ChainsawSprite.prototype.pointRight = function () {
  this.scale.x = -1.6;
  this.scale.y = 1.6;
};
ChainsawSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ChainsawSprite.prototype.init = function () {
  this.alpha = 1;
};
ChainsawSprite.prototype.onUse = function () {
  this.anchor.x = 0.15 + (-0.015 + 0.03 * Math.random());
  this.anchor.y = 0.6 + (-0.015 + 0.03 * Math.random());
};
function DesertEagleSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.deagle);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.18;
  this.anchor.y = 0.4;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 50;
  this.fireAnchor.y = -7;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: -8, y: -2 };
}
DesertEagleSprite.prototype = Object.create(PIXI.Sprite.prototype);
DesertEagleSprite.prototype.constructor = DesertEagleSprite;
AnchorBase.call(DesertEagleSprite.prototype);
DesertEagleSprite.prototype.pointLeft = function () {
  this.scale.x = -1;
  this.scale.y = -1;
};
DesertEagleSprite.prototype.pointRight = function () {
  this.scale.x = -1;
  this.scale.y = 1;
};
DesertEagleSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
DesertEagleSprite.prototype.init = function () {
  this.alpha = 1;
};
function FistSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.fists);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.32;
  this.anchor.y = 0.36;
}
FistSprite.prototype = Object.create(PIXI.Sprite.prototype);
FistSprite.prototype.constructor = FistSprite;
AnchorBase.call(FistSprite.prototype);
FistSprite.prototype.pointLeft = function () {
  this.scale.x = -1.45;
  this.scale.y = -1.45;
};
FistSprite.prototype.pointRight = function () {
  this.scale.x = -1.45;
  this.scale.y = 1.45;
};
function FlameThrowerSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.flamethrower);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.27;
  this.anchor.y = 0.48;
  this.origin = { x: 0.5, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 1;
  this.fireAnchor.y = -10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
FlameThrowerSprite.prototype = Object.create(PIXI.Sprite.prototype);
FlameThrowerSprite.prototype.constructor = FlameThrowerSprite;
AnchorBase.call(FlameThrowerSprite.prototype);
FlameThrowerSprite.prototype.pointLeft = function () {
  this.scale.x = -1.7;
  this.scale.y = -1.7;
};
FlameThrowerSprite.prototype.pointRight = function () {
  this.scale.x = -1.7;
  this.scale.y = 1.7;
};
FlameThrowerSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
FlameThrowerSprite.prototype.init = function () {
  this.alpha = 1;
};
function LaserGunSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.lasergun);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.27;
  this.anchor.y = 0.7;
  this.origin = { x: 0.5, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: 0, y: -2 };
}
LaserGunSprite.prototype = Object.create(PIXI.Sprite.prototype);
LaserGunSprite.prototype.constructor = LaserGunSprite;
AnchorBase.call(LaserGunSprite.prototype);
LaserGunSprite.prototype.pointLeft = function () {
  this.scale.x = -1.05;
  this.scale.y = -1.05;
};
LaserGunSprite.prototype.pointRight = function () {
  this.scale.x = -1.05;
  this.scale.y = 1.05;
};
LaserGunSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
LaserGunSprite.prototype.init = function () {
  this.alpha = 1;
  this.scale.x = this.scale.y = 1.05;
};
function LinkGunSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.link_gun);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.29;
  this.anchor.y = 0.6;
  this.origin = { x: 0.5, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 70;
  this.fireAnchor.y = -8;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
LinkGunSprite.prototype = Object.create(PIXI.Sprite.prototype);
LinkGunSprite.prototype.constructor = LinkGunSprite;
AnchorBase.call(LinkGunSprite.prototype);
LinkGunSprite.prototype.pointLeft = function () {
  this.scale.x = -1.6;
  this.scale.y = -1.6;
};
LinkGunSprite.prototype.pointRight = function () {
  this.scale.x = -1.6;
  this.scale.y = 1.6;
};
LinkGunSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
LinkGunSprite.prototype.init = function () {
  this.alpha = 1;
};
LinkGunSprite.prototype.onUse = function () {};
function MAC10Sprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.mac10);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.24;
  this.anchor.y = 0.48;
  this.origin = { x: 0.5, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 83;
  this.fireAnchor.y = -8;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
MAC10Sprite.prototype = Object.create(PIXI.Sprite.prototype);
MAC10Sprite.prototype.constructor = MAC10Sprite;
AnchorBase.call(MAC10Sprite.prototype);
MAC10Sprite.prototype.pointLeft = function () {
  this.scale.x = -1.1;
  this.scale.y = -1.1;
};
MAC10Sprite.prototype.pointRight = function () {
  this.scale.x = -1.1;
  this.scale.y = 1.1;
};
MAC10Sprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
MAC10Sprite.prototype.init = function () {
  this.alpha = 1;
};
function MinigunSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.minigun);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.2;
  this.anchor.y = 0.48;
  this.origin = { x: 1, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 145;
  this.fireAnchor.y = 10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
MinigunSprite.prototype = Object.create(PIXI.Sprite.prototype);
MinigunSprite.prototype.constructor = MinigunSprite;
AnchorBase.call(MinigunSprite.prototype);
MinigunSprite.prototype.pointLeft = function () {
  this.scale.x = -1.13;
  this.scale.y = -1.13;
};
MinigunSprite.prototype.pointRight = function () {
  this.scale.x = -1.13;
  this.scale.y = 1.13;
};
MinigunSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
MinigunSprite.prototype.init = function () {
  this.alpha = 1;
};
function NadeLauncherSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.m79);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.3;
  this.anchor.y = 0.7;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -6;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
NadeLauncherSprite.prototype = Object.create(PIXI.Sprite.prototype);
NadeLauncherSprite.prototype.constructor = NadeLauncherSprite;
AnchorBase.call(NadeLauncherSprite.prototype);
NadeLauncherSprite.prototype.pointLeft = function () {
  this.scale.x = -1.4;
  this.scale.y = -1.8;
};
NadeLauncherSprite.prototype.pointRight = function () {
  this.scale.x = -1.4;
  this.scale.y = 1.8;
};
NadeLauncherSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
NadeLauncherSprite.prototype.init = function () {
  this.alpha = 1;
};
function PulseGunSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.pulsegun);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.15;
  this.anchor.y = 0.48;
  this.origin = { x: 0.3, y: 0.2 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 93;
  this.fireAnchor.y = -10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.scale.x = this.scale.y = 1.5;
}
PulseGunSprite.prototype = Object.create(PIXI.Sprite.prototype);
PulseGunSprite.prototype.constructor = PulseGunSprite;
AnchorBase.call(PulseGunSprite.prototype);
PulseGunSprite.prototype.pointLeft = function () {
  this.scale.x = -1.5;
  this.scale.y = -1.5;
};
PulseGunSprite.prototype.pointRight = function () {
  this.scale.x = -1.5;
  this.scale.y = 1.5;
};
PulseGunSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
PulseGunSprite.prototype.init = function () {
  this.alpha = 1;
};
function RifleSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.rifle_m16);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.27;
  this.anchor.y = 0.62;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: -8, y: -6 };
}
RifleSprite.prototype = Object.create(PIXI.Sprite.prototype);
RifleSprite.prototype.constructor = RifleSprite;
AnchorBase.call(RifleSprite.prototype);
RifleSprite.prototype.pointLeft = function () {
  this.scale.x = -1.7;
  this.scale.y = -1.7;
};
RifleSprite.prototype.pointRight = function () {
  this.scale.x = -1.7;
  this.scale.y = 1.7;
};
RifleSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
RifleSprite.prototype.init = function () {
  this.alpha = 1;
};
function RocketLauncherSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.rocketlauncher);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.3;
  this.anchor.y = 0.7;
  this.secondaryScale = { x: -0.7, y: 0.7 };
  this.secondaryAnchor = { x: 0.7, y: 0.4 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -6;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: 0, y: 2 };
}
RocketLauncherSprite.prototype = Object.create(PIXI.Sprite.prototype);
RocketLauncherSprite.prototype.constructor = RocketLauncherSprite;
AnchorBase.call(RocketLauncherSprite.prototype);
RocketLauncherSprite.prototype.pointLeft = function () {
  this.scale.x = -0.85;
  this.scale.y = -0.85;
};
RocketLauncherSprite.prototype.pointRight = function () {
  this.scale.x = -0.85;
  this.scale.y = 0.85;
};
RocketLauncherSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
RocketLauncherSprite.prototype.init = function () {
  this.alpha = 1;
};
function RPGSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.rpg);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.3;
  this.anchor.y = 0.7;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -6;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = -50;
  this.ejectionAnchor.y = -15;
  this.addAnchor(2, this.ejectionAnchor);
}
RPGSprite.prototype = Object.create(PIXI.Sprite.prototype);
RPGSprite.prototype.constructor = RPGSprite;
AnchorBase.call(RPGSprite.prototype);
RPGSprite.prototype.pointLeft = function () {
  this.scale.x = -1.4;
  this.scale.y = -1.4;
};
RPGSprite.prototype.pointRight = function () {
  this.scale.x = -1.4;
  this.scale.y = 1.4;
};
RPGSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
RPGSprite.prototype.init = function () {
  this.alpha = 1;
};
function ShockRifleSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shockrifle);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.2;
  this.anchor.y = 0.5;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -6;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.scale.x = 1;
  this.scale.y = 1;
}
ShockRifleSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShockRifleSprite.prototype.constructor = ShockRifleSprite;
AnchorBase.call(ShockRifleSprite.prototype);
ShockRifleSprite.prototype.pointLeft = function () {
  this.scale.x = -1;
  this.scale.y = -1;
};
ShockRifleSprite.prototype.pointRight = function () {
  this.scale.x = -1;
  this.scale.y = 1;
};
ShockRifleSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ShockRifleSprite.prototype.init = function () {
  this.alpha = 1;
};
function ShotgunSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shotgun_m2);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.3;
  this.anchor.y = 0.4;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 90;
  this.fireAnchor.y = -6;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: -10, y: 0 };
}
ShotgunSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShotgunSprite.prototype.constructor = ShotgunSprite;
AnchorBase.call(ShotgunSprite.prototype);
ShotgunSprite.prototype.pointLeft = function () {
  this.scale.x = -1.8;
  this.scale.y = -1.8;
};
ShotgunSprite.prototype.pointRight = function () {
  this.scale.x = -1.8;
  this.scale.y = 1.8;
};
ShotgunSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
ShotgunSprite.prototype.init = function () {
  this.alpha = 1;
};
function SubmachineGunSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.mp5);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.27;
  this.anchor.y = 0.48;
  this.origin = { x: 0.5, y: 0 };
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 65;
  this.fireAnchor.y = -10;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
  this.gearArmOffset = { x: -8, y: 2 };
}
SubmachineGunSprite.prototype = Object.create(PIXI.Sprite.prototype);
SubmachineGunSprite.prototype.constructor = SubmachineGunSprite;
AnchorBase.call(SubmachineGunSprite.prototype);
SubmachineGunSprite.prototype.pointLeft = function () {
  this.scale.x = -1.7;
  this.scale.y = -1.7;
};
SubmachineGunSprite.prototype.pointRight = function () {
  this.scale.x = -1.7;
  this.scale.y = 1.7;
};
SubmachineGunSprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
SubmachineGunSprite.prototype.init = function () {
  this.alpha = 1;
};
function X75Sprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.x75);
  AnchorBase.call(this);
  this.rotation = Math.PI;
  this.anchor.x = 0.35;
  this.anchor.y = 0.525;
  this.fireAnchor = new PIXI.Container();
  this.fireAnchor.x = 100;
  this.fireAnchor.y = -6;
  this.addAnchor(1, this.fireAnchor);
  this.ejectionAnchor = new PIXI.Container();
  this.ejectionAnchor.x = 20;
  this.ejectionAnchor.y = -4;
  this.addAnchor(2, this.ejectionAnchor);
}
X75Sprite.prototype = Object.create(PIXI.Sprite.prototype);
X75Sprite.prototype.constructor = X75Sprite;
AnchorBase.call(X75Sprite.prototype);
X75Sprite.prototype.pointLeft = function () {
  this.scale.x = -1.1;
  this.scale.y = -1.1;
};
X75Sprite.prototype.pointRight = function () {
  this.scale.x = -1.1;
  this.scale.y = 1.1;
};
X75Sprite.prototype.animate = function (a) {
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
X75Sprite.prototype.init = function () {
  this.alpha = 1;
};
Prefabs = {
  LINE_SPRITE: "line",
  CIRCLE_SPRITE: "circle",
  RECTANGLE_SPRITE: "rectangle",
  PLAYER_SPRITE: "player",
  NADE_SPRITE: "nadesprite",
  HEAD_SPRITE: "playerHead",
  TORSO_UPPER_SPRITE: "torsoUpper",
  TORSO_LOWER_SPRITE: "torsoLower",
  ARM_LEFTUPPER_SPRITE: "armLeftUpper",
  ARM_LEFTLOWER_SPRITE: "armLeftLower",
  ARM_RIGHTUPPER_SPRITE: "armRightUpper",
  ARM_RIGHTLOWER_SPRITE: "armRightLower",
  LEG_LEFTUPPER_SPRITE: "legLeftUpper",
  LEG_LEFTLOWER_SPRITE: "legLeftLower",
  LEG_RIGHTUPPER_SPRITE: "legRightUpper",
  LEG_RIGHTLOWER_SPRITE: "legRightLower",
  FIREBALL: "fireballsprite",
  TINYSHRAPNEL: "tinyshrapnelsprite",
};
function CircleSprite(a) {
  a = a.data.radius;
  var b = new PIXI.Graphics();
  b.beginFill(16777215, 1);
  b.drawCircle(0, 0, a);
  b.endFill();
  PIXI.Sprite.call(this, App.Renderer.generateTexture(b));
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.bounds = { x: -50, y: -50, width: 100, height: 100 };
}
CircleSprite.prototype = Object.create(PIXI.Sprite.prototype);
function LineSprite(a) {
  var b = Math.sqrt(a.data.dx * a.data.dx + a.data.dy * a.data.dy),
    c = a.data.size || 3;
  a = void 0 !== a.data.rounded ? a.data.rounded : !0;
  var d = new PIXI.Graphics();
  d.beginFill(16777215, 1);
  a && (d.drawCircle(0, 0.5 * c, 0.5 * c), d.drawCircle(b, 0.5 * c, 0.5 * c));
  d.drawRect(0, 0, b, c);
  d.endFill();
  PIXI.Sprite.call(this, App.Renderer.generateTexture(d));
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.alpha = 0.8;
  this.bounds = { x: -50, y: -50, width: 100, height: 100 };
}
LineSprite.prototype = Object.create(PIXI.Sprite.prototype);
function TinyShrapnelSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.debris1);
  this.anchor.x = 0.5;
  this.anchor.y = 0;
  this.scale.x = 0.1 + 0.5 * Math.random();
  this.scale.y = 0.1 + 0.5 * Math.random();
  this.alpha = 1;
}
TinyShrapnelSprite.prototype = Object.create(PIXI.Sprite.prototype);
TinyShrapnelSprite.TEXTURE = null;
TinyShrapnelSprite.prototype.animate = function (a) {
  this.rotation = a.rotation;
  this.alpha -= 0.01;
};
function TrailSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.trail);
  this.scale.x = this.scale.y = 0.3;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
}
TrailSprite.prototype = Object.create(PIXI.Sprite.prototype);
TrailSprite.prototype.constructor = TrailSprite;
function PlayerSprite() {
  PIXI.Container.call(this);
}
PlayerSprite.prototype = Object.create(PIXI.Container.prototype);
PlayerSprite.prototype.constructor = PlayerSprite;
function AK47BulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.25;
  this.anchor.y = 0.5;
  this.scale.y = 0.35;
  this.frame = this.alpha = 0;
}
AK47BulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
AK47BulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  5 < this.frame && ((this.scale.x = 0.02 + 0.01 * b), (this.alpha = 0.4));
};
function ArrowSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.arrow);
  this.anchor.x = 1;
  this.anchor.y = 0.5;
  this.scale.x = -0.6;
  this.scale.y = 0.6;
  this.lastRotation = this.currentRotation = this.rotation;
}
ArrowSprite.prototype = Object.create(PIXI.Sprite.prototype);
ArrowSprite.prototype.animate = function (a) {
  this.lastRotation = this.currentRotation;
  this.currentRotation = Math.atan2(a.vy, a.vx);
  this.rotation = this.currentRotation + Math.PI;
};
ArrowSprite.prototype.init = function () {};
function BarrettBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.y = 0.3;
  this.frame = this.alpha = 0;
}
BarrettBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
BarrettBulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame && ((this.scale.x = 0.09 + 0.005 * b), (this.alpha = 0.6));
};
function CarbineBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.y = 0.2;
  this.frame = this.alpha = 0;
}
CarbineBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
CarbineBulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  2 < this.frame && ((this.scale.x = 0.05 + 0.004 * b), (this.alpha = 0.6));
};
function DesertEagleBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.25;
  this.anchor.y = 0.5;
  this.scale.y = 0.45;
  this.frame = this.alpha = 0;
}
DesertEagleBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
DesertEagleBulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  5 < this.frame && ((this.scale.x = 0.02 + 0.01 * b), (this.alpha = 0.4));
};
function FlameThrowerLiquidSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.flame4);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.1;
  this.scale.y = 0.1;
  this.alpha = 0;
  this.lastY = this.lastX = null;
  this.frame = this.alpha = 0;
}
FlameThrowerLiquidSprite.prototype = Object.create(PIXI.Sprite.prototype);
FlameThrowerLiquidSprite.prototype.animate = function (a) {
  this.frame++;
  null === this.lastX && ((this.lastX = this.px - a.vx), (this.lastY = this.py - a.vy));
  this.rotation = Math.atan2(a.y - this.lastY, a.x - this.lastX) + Math.PI;
  4 < this.frame &&
    ((this.alpha = 40 < this.frame ? 0 : 1 - 0.04 * this.frame), (this.scale.x = 0.5));
  this.lastX = a.x;
  this.lastY = a.y;
  this.alpha = 0;
};
FlameThrowerLiquidSprite.prototype.init = function () {};
function LaserGunBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.laser_green);
  this.anchor.x = 0.2;
  this.anchor.y = 0.5;
  this.scale.y = 0.2;
  this.frame = this.alpha = 0;
}
LaserGunBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
LaserGunBulletSprite.prototype.animate = function (a) {
  this.frame++;
  this.rotation = Math.atan2(a.vy, a.vx) + Math.PI;
  4 < this.frame &&
    ((this.scale.x = 0.03 + 0.005 * Math.sqrt(a.vx * a.vx + a.vy * a.vy)), (this.alpha = 0.8));
};
LaserGunBulletSprite.prototype.init = function () {};
function LauncherNadeSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.launcher_nade);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.6;
  this.scale.y = 0.6;
  this.frame = this.alpha = 0;
}
LauncherNadeSprite.prototype = Object.create(PIXI.Sprite.prototype);
LauncherNadeSprite.TEXTURE = null;
LauncherNadeSprite.prototype.animate = function (a) {
  this.frame++;
  0.1 < Math.sqrt(a.vx * a.vx + a.vy * a.vy) &&
    (this.rotation = Math.atan2(a.vy, a.vx) + 0.5 * Math.PI);
  5 < this.frame && (this.alpha = 0.5);
};
LauncherNadeSprite.prototype.init = function () {};
function MAC10BulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.y = 0.2;
  this.frame = this.alpha = 0;
}
MAC10BulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
MAC10BulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  1 < this.frame && ((this.scale.x = 0.01 + 0.005 * b), (this.alpha = 0.6 - 0.015 * this.frame));
};
MAC10BulletSprite.prototype.init = function () {};
function MinigunBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.75;
  this.anchor.y = 0.5;
  this.scale.y = 0.16;
  this.frame = this.alpha = 0;
}
MinigunBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
MinigunBulletSprite.prototype.animate = function (a) {
  this.frame++;
  if (4 < this.frame) {
    let b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
    0.1 < b && (this.rotation = Math.atan2(a.vy, a.vx) + Math.PI);
    this.scale.x = 0.01 + 0.002 * b;
    this.alpha = 0.4;
  }
};
MinigunBulletSprite.prototype.init = function () {};
function PulseGunBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.pulsegun_orb_blue);
  this.anchor.x = 0.1;
  this.anchor.y = 0.5;
  this.scale.x = 0.2;
  this.scale.y = 0.3;
  this.frame = 0;
}
PulseGunBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
PulseGunBulletSprite.prototype.animate = function (a) {
  this.frame++;
  0.1 < Math.sqrt(a.vx * a.vx + a.vy * a.vy) && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame &&
    ((this.alpha = 1), (this.scale.x = 0.2 + 0.02 * (50 < this.frame ? 50 : this.frame)));
};
PulseGunBulletSprite.prototype.init = function () {
  this.frame = this.alpha = 0;
};
function RifleBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.25;
  this.anchor.y = 0.5;
  this.scale.y = 0.3;
  this.frame = this.alpha = 0;
}
RifleBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
RifleBulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  5 < this.frame && ((this.scale.x = 0.02 + 0.01 * b), (this.alpha = 0.4));
};
function RLRocketSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.rl_rocket);
  this.anchor.x = 1;
  this.anchor.y = 0.5;
  this.scale.x = 0.3;
  this.scale.y = 0.3;
  this.frame = this.alpha = this.rotation = 0;
}
RLRocketSprite.prototype = Object.create(PIXI.Sprite.prototype);
RLRocketSprite.TEXTURE = null;
RLRocketSprite.prototype.animate = function (a) {
  this.frame++;
  0.1 < Math.sqrt(a.vx * a.vx + a.vy * a.vy) && (this.rotation = Math.atan2(a.vy, a.vx));
  3 < this.frame && (this.alpha = 1);
};
RLRocketSprite.prototype.init = function () {};
function RPGRocketSprite() {
  PIXI.Sprite.call(this);
  this.graphic = new PIXI.Sprite(App.CombinedTextures.rpg_rocket);
  this.graphic.anchor.x = 1;
  this.graphic.anchor.y = 0.5;
  this.graphic.scale.x = 0.6;
  this.graphic.scale.y = 0.6;
  this.graphic.rotation = Math.PI;
  this.addChild(this.graphic);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
}
RPGRocketSprite.prototype = Object.create(PIXI.Sprite.prototype);
RPGRocketSprite.TEXTURE = null;
RPGRocketSprite.prototype.animate = function (a) {
  this.frame++;
  0.1 < Math.sqrt(a.vx * a.vx + a.vy * a.vy) && (this.rotation = fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame && (this.alpha = 1);
};
RPGRocketSprite.prototype.init = function () {
  this.frame = this.alpha = 0;
};
function ShockRifleBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shockrifle_orb);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.8;
  this.scale.y = 0.8;
  this.frame = this.alpha = 0;
}
ShockRifleBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShockRifleBulletSprite.prototype.animate = function (a) {
  this.frame++;
  this.rotation = a.r;
  this.scale.x = this.scale.y = 0.8 + 0.1 * Math.sin(0.5 * this.frame);
  4 < this.frame
    ? (this.alpha = 1)
    : ((this.alpha += 0.25), (this.scale.x += 0.1), (this.scale.y += 0.1));
};
function ShotgunPelletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.shotgun_pellet);
  this.anchor.x = 0.5;
  this.anchor.y = 0.2;
  this.scale.x = 0.4;
  this.frame = this.alpha = 0;
}
ShotgunPelletSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShotgunPelletSprite.TEXTURE = null;
ShotgunPelletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = a.vx * a.vx + a.vy * a.vy;
  this.rotation = fastAtan2(a.vy, a.vx) + 0.5 * Math.PI;
  7 < this.frame && ((this.scale.y = 0.02 + 0.02 * Math.sqrt(b)), (this.alpha = 0.5));
};
ShotgunPelletSprite.prototype.init = function () {};
function SubmachineGunBulletSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures.streak);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.y = 0.28;
  this.frame = this.alpha = 0;
}
SubmachineGunBulletSprite.prototype = Object.create(PIXI.Sprite.prototype);
SubmachineGunBulletSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.rotation = Math.atan2(a.vy, a.vx) + Math.PI);
  4 < this.frame && ((this.scale.x = 0.01 + 0.006 * b), (this.alpha = 0.4));
};
function X75NadeSprite() {
  PIXI.Sprite.call(this, App.CombinedTextures["green-exp"]);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.scale.x = 0.4;
  this.scale.y = 0.4;
  this.rotation = 0.5 * -Math.PI;
}
X75NadeSprite.prototype = Object.create(PIXI.Sprite.prototype);
X75NadeSprite.TEXTURE = null;
X75NadeSprite.prototype.animate = function (a) {
  this.frame++;
  this.rotation = Math.random() * Math.PI * 2;
  5 < this.frame && (this.alpha = 1);
};
X75NadeSprite.prototype.init = function () {
  this.frame = this.alpha = 0;
};
function RectangleSprite(a) {
  var b = new PIXI.Graphics();
  b.beginFill(16755200, 1);
  b.drawRect(0, 0, a.data.width, a.data.height);
  b.endFill();
  PIXI.Sprite.call(this, App.Renderer.generateTexture(b));
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.alpha = 0.8;
  this.bounds = { x: -50, y: -50, width: 100, height: 100 };
}
RectangleSprite.prototype = Object.create(PIXI.Sprite.prototype);
function ClusterNadeFragmentSprite() {
  PIXI.Sprite.call(this);
  this.trail = new TrailSprite();
  this.trail.alpha = 0.3;
  this.trail.x = 2;
  this.trail.anchor.x = 0.1;
  this.addChild(this.trail);
  this.nade = new PIXI.Sprite(App.CombinedTextures.clusternadefragment);
  this.nade.anchor.x = this.nade.anchor.y = 0.5;
  this.addChild(this.nade);
  this.scale.x = this.scale.y = 0.16;
  this.frame = 0;
}
ClusterNadeFragmentSprite.prototype = Object.create(PIXI.Sprite.prototype);
ClusterNadeFragmentSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.trail.rotation = -this.rotation + fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame &&
    ((this.trail.scale.x = 1.5 + 0.7 * b),
    (this.trail.scale.y = 2),
    (this.trail.alpha = 0.005 * b));
};
function ClusterNadeSprite() {
  PIXI.Sprite.call(this);
  this.trail = new TrailSprite();
  this.trail.alpha = 0.3;
  this.trail.x = 2;
  this.trail.anchor.x = 0.1;
  this.addChild(this.trail);
  this.nade = new PIXI.Sprite(App.CombinedTextures.clustergrenade);
  this.nade.anchor.x = this.nade.anchor.y = 0.5;
  this.nade.scale.x = this.nade.scale.y = 2.2;
  this.addChild(this.nade);
  this.scale.x = this.scale.y = 0.13;
  this.frame = 0;
}
ClusterNadeSprite.prototype = Object.create(PIXI.Sprite.prototype);
ClusterNadeSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.trail.rotation = -this.rotation + fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame &&
    ((this.trail.scale.x = 3.3 + 0.7 * b),
    (this.trail.scale.y = 3.5),
    (this.trail.alpha = 0.005 * b));
};
function NadeSprite() {
  PIXI.Sprite.call(this);
  this.trail = new TrailSprite();
  this.trail.alpha = 0.3;
  this.trail.x = 2;
  this.trail.anchor.x = 0.1;
  this.addChild(this.trail);
  this.nade = new PIXI.Sprite(App.CombinedTextures.handgrenade);
  this.nade.anchor.x = this.nade.anchor.y = 0.5;
  this.nade.scale.x = this.nade.scale.y = 2;
  this.addChild(this.nade);
  this.scale.x = this.scale.y = 0.13;
  this.frame = 0;
}
NadeSprite.prototype = Object.create(PIXI.Sprite.prototype);
NadeSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.trail.rotation = -this.rotation + fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame &&
    ((this.trail.scale.x = 3.3 + 0.7 * b),
    (this.trail.scale.y = 3.5),
    (this.trail.alpha = 0.005 * b));
};
function ShurikenBladeSprite() {
  PIXI.Sprite.call(this);
  this.trail = new TrailSprite();
  this.trail.alpha = 0.3;
  this.trail.x = 2;
  this.trail.anchor.x = 0.1;
  this.trail.anchor.y = 0.5;
  this.addChild(this.trail);
  this.shuriken = new PIXI.Sprite(App.CombinedTextures.shuriken);
  this.shuriken.anchor.x = this.shuriken.anchor.y = 0.5;
  this.shuriken.scale.x = this.shuriken.scale.y = 3;
  this.addChild(this.shuriken);
  this.scale.x = this.scale.y = 0.13;
  this.frame = 0;
}
ShurikenBladeSprite.prototype = Object.create(PIXI.Sprite.prototype);
ShurikenBladeSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.trail.rotation = -this.rotation + fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame &&
    ((this.trail.scale.x = 3.3 + 0.7 * b),
    (this.trail.scale.y = 3.5),
    (this.trail.alpha = 0.0025 * b));
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
function SnowballProjectileSprite() {
  PIXI.Sprite.call(this);
  this.trail = new TrailSprite();
  this.trail.alpha = 0.3;
  this.trail.x = 2;
  this.trail.anchor.x = 0.1;
  this.addChild(this.trail);
  this.snowball = new PIXI.Sprite(App.CombinedTextures.snowball);
  this.snowball.anchor.x = this.snowball.anchor.y = 0.5;
  this.snowball.scale.x = this.snowball.scale.y = 2.3;
  this.addChild(this.snowball);
  this.scale.x = this.scale.y = 0.11;
  this.frame = 0;
}
SnowballProjectileSprite.prototype = Object.create(PIXI.Sprite.prototype);
SnowballProjectileSprite.prototype.animate = function (a) {
  this.frame++;
  var b = Math.sqrt(a.vx * a.vx + a.vy * a.vy);
  0.1 < b && (this.trail.rotation = -this.rotation + fastAtan2(a.vy, a.vx) + Math.PI);
  3 < this.frame &&
    ((this.trail.scale.x = 3.3 + 0.7 * b),
    (this.trail.scale.y = 3.5),
    (this.trail.alpha = 0.0025 * b));
  200 > --a.ttl && (this.alpha = 0.7 + 0.3 * Math.sin(a.ttl / 5));
};
let rdScale = 0.26;
function HeadSprite(a) {
  void 0 === a.team && (a.team = "alpha");
  let b = "head_" + a.team,
    c,
    d = !1;
  if (a.customization) {
    var e = a.customization[Customization.FACE];
    if (e && 0 < e.texture.length) {
      let f = e.cdata,
        g = !0;
      f && (void 0 !== f.custom && !1 === f.sprite && (g = !1), !1 === f.hair && (d = !0));
      g &&
        ((c = new PIXI.Sprite(App.CombinedTextures["face_" + e.texture])),
        f &&
          (void 0 !== f.ax && ((c.anchor.x = f.ax), (c.anchor.y = f.ay)),
          void 0 !== f.ox ? ((c.x = 2 + f.ox), (c.y = 24 + f.oy)) : ((c.x = 2), (c.y = 24)),
          f.vr && (c.vr = 0)));
    }
    if (((e = a.customization[Customization.HAIR]) && 0 < e.texture.length) || d)
      b += "_" + (d ? "slick" : e.texture);
  }
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  void 0 !== c &&
    ((this.face = c),
    this.addChild(c),
    a.customization.face.cdata && (this.data = a.customization.face.cdata));
  this.decal = App.CombinedTextures.head_gore;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.z = 10;
  this.scale.x = -rdScale;
  this.scale.y = -rdScale;
}
HeadSprite.prototype = Object.create(PIXI.Sprite.prototype);
HeadSprite.prototype.animate = function (a) {
  this.face &&
    (this.data.fr && (this.face.rotation = 0 > this.scale.x ? -this.rotation : this.rotation),
    this.data.vr && ((this.face.vr += this.data.vr), (this.face.rotation += this.face.vr)));
};
HeadSprite.prototype.init = function (a) {
  this.alpha = 1;
};
function TorsoUpperSprite(a) {
  let b = "torsoupper";
  a.customization &&
    (a = a.customization[Customization.TORSO]) &&
    0 < a.texture.length &&
    (b += "_" + a.texture);
  PIXI.Sprite.call(this);
  this.sprite = new PIXI.Sprite(App.CombinedTextures[b]);
  this.sprite.anchor.x = this.sprite.anchor.y = 0.5;
  this.sprite.y = 8;
  this.addChild(this.sprite);
  this.decal = App.CombinedTextures.torsoupper_gore;
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  this.z = 10;
  this.scale.x = 1.35 * rdScale;
  this.scale.y = 1.35 * -rdScale;
}
TorsoUpperSprite.prototype = Object.create(PIXI.Sprite.prototype);
function TorsoLowerSprite(a) {
  let b = "torsolower",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.BELT] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax && ((this.anchor.x = 0 + c.cdata.ax), (this.anchor.y = 0 + c.cdata.ay)));
  this.decal = App.CombinedTextures.torsolower_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
TorsoLowerSprite.prototype = Object.create(PIXI.Sprite.prototype);
function ArmLeftUpperSprite(a) {
  let b = "armleftupper",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.ARMLEFTUPPER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.625;
  this.anchor.y = 0.25;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax && ((this.anchor.x = 0 + c.cdata.ax), (this.anchor.y = 0 + c.cdata.ay)));
  this.decal = App.CombinedTextures.armleftupper_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
ArmLeftUpperSprite.prototype = Object.create(PIXI.Sprite.prototype);
function ArmLeftLowerSprite(a) {
  let b = "armleftlower",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.ARMLEFTLOWER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.52;
  this.anchor.y = 0.17;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax && ((this.anchor.x = 0 + c.cdata.ax), (this.anchor.y = 0 + c.cdata.ay)));
  this.decal = App.CombinedTextures.armleftlower_gore;
  this.z = 10;
  this.scale.x = -rdScale;
  this.scale.y = -rdScale;
}
ArmLeftLowerSprite.prototype = Object.create(PIXI.Sprite.prototype);
function ArmRightUpperSprite(a) {
  let b = "armrightupper",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.ARMRIGHTUPPER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.343;
  this.anchor.y = 0.25;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax &&
      ((this.anchor.x = -0.1 + c.cdata.ax), (this.anchor.y = 0.05 + c.cdata.ay)));
  this.decal = App.CombinedTextures.armrightupper_gore;
  this.z = 10;
  this.scale.x = -rdScale;
  this.scale.y = -rdScale;
}
ArmRightUpperSprite.prototype = Object.create(PIXI.Sprite.prototype);
function ArmRightLowerSprite(a) {
  let b = "armrightlower",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.ARMRIGHTLOWER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.52;
  this.anchor.y = 0.17;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax && ((this.anchor.x = 0 + c.cdata.ax), (this.anchor.y = 0 + c.cdata.ay)));
  this.decal = App.CombinedTextures.armrightlower_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
ArmRightLowerSprite.prototype = Object.create(PIXI.Sprite.prototype);
function LegLeftUpperSprite(a) {
  let b = "legleftupper",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.LEGLEFTUPPER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax &&
      ((this.anchor.x = -0.05 + c.cdata.ax), (this.anchor.y = 0.2 + c.cdata.ay)));
  this.decal = App.CombinedTextures.legleftupper_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
LegLeftUpperSprite.prototype = Object.create(PIXI.Sprite.prototype);
function LegLeftLowerSprite(a) {
  let b = "legrightlower",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.LEGRIGHTLOWER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.58;
  this.anchor.y = 0.51;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax &&
      ((this.anchor.x = 0 + c.cdata.ax), (this.anchor.y = 0.15 + c.cdata.ay)));
  this.decal = App.CombinedTextures.legrightlower_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
LegLeftLowerSprite.prototype = Object.create(PIXI.Sprite.prototype);
function LegRightUpperSprite(a) {
  let b = "legrightupper",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.LEGRIGHTUPPER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.5;
  this.anchor.y = 0.5;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax &&
      ((this.anchor.x = -0.05 + c.cdata.ax), (this.anchor.y = 0.2 + c.cdata.ay)));
  this.decal = App.CombinedTextures.legrightupper_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
LegRightUpperSprite.prototype = Object.create(PIXI.Sprite.prototype);
function LegRightLowerSprite(a) {
  let b = "legleftlower",
    c = {};
  a.customization &&
    ((c = a.customization[Customization.LEGLEFTLOWER] || {}),
    c.texture && 0 < c.texture.length && (b += "_" + c.texture));
  PIXI.Sprite.call(this, App.CombinedTextures[b]);
  this.anchor.x = 0.58;
  this.anchor.y = 0.51;
  c.cdata &&
    ((this.x = c.cdata.ox ? c.cdata.ox : 0),
    (this.y = c.cdata.oy ? c.cdata.oy : 0),
    void 0 !== c.cdata.ax &&
      ((this.anchor.x = -0 + c.cdata.ax), (this.anchor.y = 0.15 + c.cdata.ay)));
  this.decal = App.CombinedTextures.legleftlower_gore;
  this.z = 10;
  this.scale.x = rdScale;
  this.scale.y = -rdScale;
}
LegRightLowerSprite.prototype = Object.create(PIXI.Sprite.prototype);
var itemlist = {},
  ItemList = {
    Fists: "i0",
    Shotgun: "i1",
    SubmachineGun: "i2",
    NadeLauncher: "i3",
    Barrett: "i4",
    ShockRifle: "i5",
    PulseGun: "i6",
    FlameThrower: "i7",
    RPG: "i8",
    Rifle: "i9",
    LaserGun: "i10",
    LinkGun: "i11",
    AK47: "i12",
    HandGrenade: "i20",
    ClusterGrenade: "i21",
    Shuriken: "i23",
    Snowball: "i25",
    Chainsaw: "i30",
    DesertEagle: "i31",
    Minigun: "i32",
    X75: "i33",
    MAC10: "i34",
    Bow: "i35",
    RocketLauncher: "i36",
    Carbine: "i37",
    Bouncyball: "i40",
    HealthBox: "i80",
    NadeBox: "i81",
    ClusterNadeBox: "i82",
    SnowballBox: "i83",
    ShurikenBox: "i84",
    Flag: "i100",
    ShotgunAmmo: "i700",
    RifleAmmo: "i701",
    AK47Ammo: "i702",
    BarrettAmmo: "i703",
    ChainsawAmmo: "i704",
    DesertEagleAmmo: "i705",
    FlameThrowerAmmo: "i706",
    LaserGunAmmo: "i707",
    LinkGunAmmo: "i708",
    MAC10Ammo: "i709",
    MinigunAmmo: "i710",
    NadeLauncherAmmo: "i711",
    PulseGunAmmo: "i712",
    RPGAmmo: "i713",
    ShockRifleAmmo: "i714",
    SMGAmmo: "i715",
    X75Ammo: "i716",
    Gold: "i800",
  },
  ItemMap = { Equip: { PRIMARY: 1, SECONDARY: 2, BELT: 3, OTHER: 4 } };
ItemMap[ItemList.Fists] = {
  title: "Fists",
  onUse: { visual: [], audio: [] },
  equip: ItemMap.Equip.OTHER,
};
ItemMap[ItemList.Rifle] = {
  title: "Rifle",
  onUse: {
    visual: [ParticleEffects.RifleMuzzleFlash, ParticleEffects.RifleCartridge],
    audio: [AudioEffects.RifleFire],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.LaserGun] = {
  title: "Lasergun",
  onUse: {
    visual: [ParticleEffects.LaserGunMuzzleFlash, ParticleEffects.RifleCartridge],
    audio: [AudioEffects.LaserGunShot1],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.Shotgun] = {
  title: "Shotgun",
  onUse: {
    visual: [ParticleEffects.ShotgunMuzzleFlash, ParticleEffects.ShotgunCartridge],
    audio: [AudioEffects.ShotgunFire],
    postUseAudio: [{ audio: AudioEffects.ShotgunPump, delay: 150 }],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.SubmachineGun] = {
  title: "SMG",
  onUse: {
    visual: [ParticleEffects.SMGMuzzleFlash, ParticleEffects.SMGCartridge],
    audio: [AudioEffects.SMGFire],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.PulseGun] = {
  title: "Pulse Gun",
  onUse: {
    visual: [ParticleEffects.PulseGunMuzzleFlash, ParticleEffects.SMGCartridge],
    audio: [AudioEffects.PulseGunShot],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.FlameThrower] = {
  title: "Flamer",
  onUse: { visual: [ParticleEffects.FlameThrowerPilot], audio: [AudioEffects.FlamethrowerFire] },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.NadeLauncher] = {
  title: "M79",
  onUse: {
    visual: [
      ParticleEffects.RifleMuzzleFlash,
      ParticleEffects.NadeLauncherCartridge,
      ParticleEffects.NadeLauncherFireSparks,
    ],
    audio: [AudioEffects.NadeLauncher],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.RocketLauncher] = {
  title: "Avenger",
  onUse: { visual: [ParticleEffects.RifleMuzzleFlash], audio: [AudioEffects.RLRocketFire] },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.Chainsaw] = {
  title: "Chainsaw",
  onUse: {
    visual: [ParticleEffects.ChainsawSmoke, ParticleEffects.ChainsawRaycast],
    audio: [AudioEffects.ChainsawEngaged],
  },
  equip: ItemMap.Equip.SECONDARY,
};
ItemMap[ItemList.DesertEagle] = {
  title: "Deagles",
  onUse: {
    visual: [
      ParticleEffects.RifleMuzzleFlash,
      ParticleEffects.RifleCartridge,
      ParticleEffects.RifleCartridge,
    ],
    audio: [AudioEffects.DeagleFire],
  },
  equip: ItemMap.Equip.SECONDARY,
};
ItemMap[ItemList.Minigun] = {
  title: "Minigun",
  onUse: {
    visual: [
      ParticleEffects.RifleMuzzleFlash,
      ParticleEffects.MinigunCartridge,
      ParticleEffects.MinigunSmoke,
    ],
    audio: [AudioEffects.MinigunEngaged],
  },
  onInitUse: { audio: [AudioEffects.MinigunEngaged] },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.LinkGun] = {
  title: "Link Gun",
  onUse: {
    visual: [ParticleEffects.LinkGunMuzzleFlash, ParticleEffects.LinkGunRaycast],
    audio: [AudioEffects.LinkGunEngaged],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.AK47] = {
  title: "AK-47",
  onUse: {
    visual: [ParticleEffects.RifleMuzzleFlash, ParticleEffects.RifleCartridge],
    audio: [AudioEffects.AK47Fire],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.X75] = {
  title: "X75",
  onUse: {
    visual: [ParticleEffects.X75MuzzleFlash, ParticleEffects.X75Cartridge],
    audio: [AudioEffects.X75Fire],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.MAC10] = {
  title: "MAC-10",
  onUse: {
    visual: [ParticleEffects.MAC10MuzzleFlash, ParticleEffects.MinigunCartridge],
    audio: [AudioEffects.MAC10Fire],
  },
  equip: ItemMap.Equip.SECONDARY,
};
ItemMap[ItemList.Bow] = {
  title: "Bow",
  onUse: { visual: [], audio: [AudioEffects.BowFire] },
  onInitUse: { audio: [] },
  equip: ItemMap.Equip.SECONDARY,
  reloadAudio: null,
};
ItemMap[ItemList.Barrett] = {
  title: "Barrett",
  onUse: {
    visual: [ParticleEffects.RifleMuzzleFlash, ParticleEffects.BarrettCartridge],
    audio: [AudioEffects.BarrettFire],
  },
  equip: ItemMap.Equip.PRIMARY,
  resizeReticle: { min: 1, max: 2 },
};
ItemMap[ItemList.Carbine] = {
  title: "Carbine",
  onUse: {
    visual: [ParticleEffects.RifleMuzzleFlash, ParticleEffects.BarrettCartridge],
    audio: [AudioEffects.CarbineFire],
  },
  equip: ItemMap.Equip.PRIMARY,
  resizeReticle: { min: 1, max: 1.3 },
};
ItemMap[ItemList.ShockRifle] = {
  title: "Shock Rifle",
  onUse: {
    visual: [ParticleEffects.ShockRifleMuzzleFlash, ParticleEffects.ShockRifleCartridge],
    audio: [AudioEffects.ShockrifleFire],
  },
  equip: ItemMap.Equip.PRIMARY,
};
ItemMap[ItemList.Bouncyball] = {
  title: "Ball",
  onUse: { visual: [], audio: [] },
  equip: ItemMap.Equip.SECONDARY,
};
ItemMap[ItemList.HealthBox] = { title: "Healthbox", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.NadeBox] = { title: "Nadebox", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.ClusterNadeBox] = { title: "ClusterNadebox", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.SnowballBox] = { title: "Snowballbox", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.ShurikenBox] = { title: "Shurikenbox", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.Flag] = { title: "Flag", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.RPG] = {
  title: "RPG",
  onUse: {
    visual: [
      ParticleEffects.RPG_MUZZLEBLAST,
      ParticleEffects.RPG_BACKBLAST,
      ParticleEffects.RPGBackBlastSmoke,
    ],
    audio: [AudioEffects.LawLaunch],
  },
  equip: ItemMap.Equip.SECONDARY,
};
ItemMap[ItemList.HandGrenade] = {
  title: "Hand grenade",
  onUse: { visual: [], audio: [] },
  equip: ItemMap.Equip.BELT,
  amount: 2,
};
ItemMap[ItemList.ClusterGrenade] = {
  title: "Cluster grenade",
  onUse: { visual: [], audio: [] },
  equip: ItemMap.Equip.BELT,
  amount: 2,
};
ItemMap[ItemList.Shuriken] = {
  title: "Shuriken",
  onUse: { visual: [], audio: [] },
  equip: ItemMap.Equip.BELT,
  amount: 3,
};
ItemMap[ItemList.Snowball] = {
  title: "Snowball",
  onUse: { visual: [], audio: [] },
  equip: ItemMap.Equip.BELT,
  amount: 5,
};
ItemMap[ItemList.AK47Ammo] = { title: "AK-47 ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.BarrettAmmo] = { title: "Barrett ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.ChainsawAmmo] = { title: "Chainsaw ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.DesertEagleAmmo] = {
  title: "Desert Eagle ammo",
  onUse: { visual: [], audio: [] },
};
ItemMap[ItemList.FlameThrowerAmmo] = { title: "Flamer ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.LaserGunAmmo] = { title: "Lasergun ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.LinkGunAmmo] = { title: "Link Gun ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.MAC10Ammo] = { title: "MAC-10 ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.MinigunAmmo] = { title: "Minigun ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.NadeLauncherAmmo] = {
  title: "Nadelauncher ammo",
  onUse: { visual: [], audio: [] },
};
ItemMap[ItemList.PulseGunAmmo] = { title: "Pulse Gun ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.RifleAmmo] = { title: "Rifle ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.RPGAmmo] = { title: "RPG ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.ShockRifleAmmo] = { title: "Schockrifle ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.ShotgunAmmo] = { title: "Shotgun ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.SMGAmmo] = { title: "SMG ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.X75Ammo] = { title: "X75 ammo", onUse: { visual: [], audio: [] } };
ItemMap[ItemList.Gold] = { title: "Gold", onUse: { visual: [], audio: [] } };
var shurikenicon = {};
class ShurikenIcon extends PIXI.Sprite {
  constructor() {
    super(App.CombinedTextures.shuriken);
    this.anchor.x = this.anchor.y = 0.5;
  }
}
var clustergrenadeicon = {};
class ClusterGrenadeIcon extends PIXI.Sprite {
  constructor() {
    super(App.CombinedTextures.clustergrenade);
    this.anchor.x = this.anchor.y = 0.5;
  }
}
var handgrenadeicon = {};
class HandGrenadeIcon extends PIXI.Sprite {
  constructor() {
    super(App.CombinedTextures.handgrenade);
    this.anchor.x = this.anchor.y = 0.5;
  }
}
var snowballicon = {};
class SnowballIcon extends PIXI.Sprite {
  constructor() {
    super(App.CombinedTextures.snowball);
    this.anchor.x = this.anchor.y = 0.5;
  }
}
class SpriteFactory {}
SpriteFactory.CreateSprite = function (a) {
  let b = new SpriteMap[a.type](a);
  void 0 !== a.scale && ((b.scale.x = a.scale.x), (b.scale.y = a.scale.y));
  void 0 !== a.offset && ((b.anchor.x = a.offset.x), (b.anchor.y = a.offset.y));
  return b;
};
let SpriteMap = {};
SpriteMap.i0 = FistSprite;
SpriteMap[PrefabList.RifleBullet] = RifleBulletSprite;
SpriteMap[PrefabList.AK47Bullet] = AK47BulletSprite;
SpriteMap[PrefabList.DesertEagleBullet] = DesertEagleBulletSprite;
SpriteMap[PrefabList.ShockRifleBullet] = ShockRifleBulletSprite;
SpriteMap[PrefabList.ShotgunPellet] = ShotgunPelletSprite;
SpriteMap[PrefabList.SubmachineGunBullet] = SubmachineGunBulletSprite;
SpriteMap[PrefabList.PulseGunBullet] = PulseGunBulletSprite;
SpriteMap[PrefabList.FlameThrowerLiquid] = FlameThrowerLiquidSprite;
SpriteMap[PrefabList.RPGRocket] = RPGRocketSprite;
SpriteMap[PrefabList.RLRocket] = RLRocketSprite;
SpriteMap[PrefabList.LauncherNade] = LauncherNadeSprite;
SpriteMap[PrefabList.BarrettBullet] = BarrettBulletSprite;
SpriteMap[PrefabList.CarbineBullet] = CarbineBulletSprite;
SpriteMap[PrefabList.LaserGunBullet] = LaserGunBulletSprite;
SpriteMap[PrefabList.MinigunBullet] = MinigunBulletSprite;
SpriteMap[PrefabList.X75Nade] = X75NadeSprite;
SpriteMap[PrefabList.MAC10Bullet] = MAC10BulletSprite;
SpriteMap[PrefabList.Nade] = NadeSprite;
SpriteMap[PrefabList.ShurikenBlade] = ShurikenBladeSprite;
SpriteMap[PrefabList.SnowballProjectile] = SnowballProjectileSprite;
SpriteMap[PrefabList.ClusterNade] = ClusterNadeSprite;
SpriteMap[PrefabList.ClusterNadeFragment] = ClusterNadeFragmentSprite;
SpriteMap[PrefabList.TinyShrapnel] = TinyShrapnelSprite;
SpriteMap[PrefabList.Rifle] = RifleSprite;
SpriteMap[PrefabList.AK47] = AK47Sprite;
SpriteMap[PrefabList.DesertEagle] = DesertEagleSprite;
SpriteMap[PrefabList.Shotgun] = ShotgunSprite;
SpriteMap[PrefabList.NadeLauncher] = NadeLauncherSprite;
SpriteMap[PrefabList.RPG] = RPGSprite;
SpriteMap[PrefabList.SubmachineGun] = SubmachineGunSprite;
SpriteMap[PrefabList.LaserGun] = LaserGunSprite;
SpriteMap[PrefabList.PulseGun] = PulseGunSprite;
SpriteMap[PrefabList.Minigun] = MinigunSprite;
SpriteMap[PrefabList.X75] = X75Sprite;
SpriteMap[PrefabList.MAC10] = MAC10Sprite;
SpriteMap[PrefabList.FlameThrower] = FlameThrowerSprite;
SpriteMap[PrefabList.Chainsaw] = ChainsawSprite;
SpriteMap[PrefabList.LinkGun] = LinkGunSprite;
SpriteMap[PrefabList.Barrett] = BarrettSprite;
SpriteMap[PrefabList.Carbine] = CarbineSprite;
SpriteMap[PrefabList.Bow] = BowSprite;
SpriteMap[PrefabList.RocketLauncher] = RocketLauncherSprite;
SpriteMap[PrefabList.ShockRifle] = ShockRifleSprite;
SpriteMap[PrefabList.HealthBox] = HealthBoxSprite;
SpriteMap[PrefabList.NadeBox] = NadeBoxSprite;
SpriteMap[PrefabList.ClusterNadeBox] = ClusterNadeBoxSprite;
SpriteMap[PrefabList.ShurikenBox] = ShurikenBoxSprite;
SpriteMap[PrefabList.SnowballBox] = SnowballBoxSprite;
SpriteMap[PrefabList.Bouncyball] = BallSprite;
SpriteMap[PrefabList.Flag] = FlagSprite;
SpriteMap[ItemList.Shotgun] = ShotgunSprite;
SpriteMap[ItemList.NadeLauncher] = NadeLauncherSprite;
SpriteMap[ItemList.Chainsaw] = ChainsawSprite;
SpriteMap[ItemList.LinkGun] = LinkGunSprite;
SpriteMap[ItemList.SubmachineGun] = SubmachineGunSprite;
SpriteMap[ItemList.LaserGun] = LaserGunSprite;
SpriteMap[ItemList.PulseGun] = PulseGunSprite;
SpriteMap[ItemList.FlameThrower] = FlameThrowerSprite;
SpriteMap[ItemList.Rifle] = RifleSprite;
SpriteMap[ItemList.AK47] = AK47Sprite;
SpriteMap[ItemList.DesertEagle] = DesertEagleSprite;
SpriteMap[ItemList.Barrett] = BarrettSprite;
SpriteMap[ItemList.Carbine] = CarbineSprite;
SpriteMap[ItemList.Bow] = BowSprite;
SpriteMap[ItemList.RocketLauncher] = RocketLauncherSprite;
SpriteMap[ItemList.ShockRifle] = ShockRifleSprite;
SpriteMap[ItemList.RPG] = RPGSprite;
SpriteMap[ItemList.Minigun] = MinigunSprite;
SpriteMap[ItemList.X75] = X75Sprite;
SpriteMap[ItemList.MAC10] = MAC10Sprite;
SpriteMap[ItemList.Shuriken + "_"] = ShurikenIcon;
SpriteMap[ItemList.ClusterGrenade + "_"] = ClusterGrenadeIcon;
SpriteMap[ItemList.HandGrenade + "_"] = HandGrenadeIcon;
SpriteMap[ItemList.Snowball + "_"] = SnowballIcon;
SpriteMap[PrefabList.ShotgunAmmo] = ShotgunAmmoSprite;
SpriteMap[PrefabList.AK47Ammo] = AK47AmmoSprite;
SpriteMap[PrefabList.BarrettAmmo] = BarrettAmmoSprite;
SpriteMap[PrefabList.ChainsawAmmo] = ChainsawAmmoSprite;
SpriteMap[PrefabList.DesertEagleAmmo] = DesertEagleAmmoSprite;
SpriteMap[PrefabList.FlameThrowerAmmo] = FlameThrowerAmmoSprite;
SpriteMap[PrefabList.LaserGunAmmo] = LaserGunAmmoSprite;
SpriteMap[PrefabList.LinkGunAmmo] = LinkGunAmmoSprite;
SpriteMap[PrefabList.MAC10Ammo] = MAC10AmmoSprite;
SpriteMap[PrefabList.MinigunAmmo] = MinigunAmmoSprite;
SpriteMap[PrefabList.NadeLauncherAmmo] = NadeLauncherAmmoSprite;
SpriteMap[PrefabList.PulseGunAmmo] = PulseGunAmmoSprite;
SpriteMap[PrefabList.RifleAmmo] = RifleAmmoSprite;
SpriteMap[PrefabList.RPGAmmo] = RPGAmmoSprite;
SpriteMap[PrefabList.ShockRifleAmmo] = ShockRifleAmmoSprite;
SpriteMap[PrefabList.SMGAmmo] = SMGAmmoSprite;
SpriteMap[PrefabList.X75Ammo] = X75AmmoSprite;
SpriteMap[PrefabList.Arrow] = ArrowSprite;
SpriteMap[ItemList.Bouncyball] = BallSprite;
SpriteMap[ItemList.Flag] = FlagSprite;
SpriteMap[PrefabList.Gold] = GoldSprite;
SpriteMap[Prefabs.LINE_SPRITE] = LineSprite;
SpriteMap[Prefabs.CIRCLE_SPRITE] = CircleSprite;
SpriteMap[Prefabs.RECTANGLE_SPRITE] = RectangleSprite;
SpriteMap[Prefabs.PLAYER_SPRITE] = PlayerSprite;
SpriteMap[Prefabs.HEAD_SPRITE] = HeadSprite;
SpriteMap[Prefabs.TORSO_UPPER_SPRITE] = TorsoUpperSprite;
SpriteMap[Prefabs.TORSO_LOWER_SPRITE] = TorsoLowerSprite;
SpriteMap[Prefabs.ARM_LEFTUPPER_SPRITE] = ArmLeftUpperSprite;
SpriteMap[Prefabs.ARM_LEFTLOWER_SPRITE] = ArmLeftLowerSprite;
SpriteMap[Prefabs.ARM_RIGHTUPPER_SPRITE] = ArmRightUpperSprite;
SpriteMap[Prefabs.ARM_RIGHTLOWER_SPRITE] = ArmRightLowerSprite;
SpriteMap[Prefabs.LEG_LEFTUPPER_SPRITE] = LegLeftUpperSprite;
SpriteMap[Prefabs.LEG_LEFTLOWER_SPRITE] = LegLeftLowerSprite;
SpriteMap[Prefabs.LEG_RIGHTUPPER_SPRITE] = LegRightUpperSprite;
SpriteMap[Prefabs.LEG_RIGHTLOWER_SPRITE] = LegRightLowerSprite;
var label = {};
class Label extends PIXI.Container {
  constructor(a, b, c, d) {
    super();
    this.id = a;
    this.go = b;
    this.attached = c;
    this.edge = !1;
    this.team = -1;
    this.chatBubble = void 0;
    b.isPlayer &&
      ((b.onRequestDisplayChatBubble = () => this.displayChatBubble()),
      (b.onRequestHideChatBubble = () => this.hideChatBubble()));
    this.marker = null;
    this.tintColor = Team.LabelColors[b.team];
    this.text = new PIXI.BitmapText(d, Label.FontText);
    this.hw = 0.5 * this.text.width + 10;
    this.hh = 0.5 * this.text.height + 10;
    -1 !== b.team && (this.text.tint = this.tintColor);
    this.subText = new PIXI.BitmapText("", Label.FontSubText);
    a = Math.max(Math.floor((b.level / 160) * 10) + 1);
    this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + (16 < a ? 16 : a)]);
    this.skillTag.scale.x = this.skillTag.scale.y = 0.4;
    this.skillTag.x = 0.5 * -this.skillTag.width;
    this.skillTag.y = -85;
    this.skillTag.visible = !1;
    this.addChild(this.skillTag);
    this.text.x = 0.5 * -this.text.width;
    this.text.y = -60;
    this.time = 0;
    if ((this.inClan = -1 !== b.clanId && void 0 !== b.clanId && null !== b.clanId))
      (this.clanTag = new PIXI.BitmapText(b.clanName, Label.FontClanTag)),
        (this.clanTag.alpha = 0.2),
        (this.clanTag.x = 0.5 * -this.clanTag.width),
        (this.clanTag.y = -100),
        (this.clanTag.tint = 10040012),
        this.addChild(this.clanTag);
    b.isLocal
      ? ((this.marker = new PIXI.Sprite(App.CombinedTextures.marker)),
        (this.marker.x = 0),
        (this.marker.y = -40),
        (this.marker.alpha = 0.5),
        (this.marker.scale.x = this.marker.scale.y = 0.5),
        (this.marker.anchor.x = this.marker.anchor.y = 0.5),
        this.addChild(this.marker),
        (this.markerTime = 0))
      : (this.skillTag.alpha = 0.8);
  }
  displayChatBubble() {
    void 0 === this.chatBubble &&
      ((this.chatBubble = new PIXI.Sprite(App.CombinedTextures["chat-ingame"])),
      (this.chatBubble.anchor.x = 0.5),
      (this.chatBubble.anchor.y = 0.5),
      (this.chatBubble.scale.x = this.chatBubble.scale.y = 0.6),
      (this.chatBubble.alpha = 0.6),
      (this.chatBubble.y = -40));
    this.chatBubble.parent ||
      (this.addChild(this.chatBubble),
      (this.chatBubble.scale.x = this.go.facingDir === Player.FACING_RIGHT ? -0.6 : 0.6));
  }
  hideChatBubble() {
    void 0 !== this.chatBubble && this.chatBubble.parent && this.removeChild(this.chatBubble);
  }
  setText(a) {
    this.text.text = a;
    this.hw = 0.5 * this.text.width + 10;
    this.hh = 0.5 * this.text.height + 10;
    this.text.x = 0.5 * -this.text.width;
    this.text.y = -60;
  }
  setSubText(a) {
    this.time = 90 + 5 * a.length;
    this.subText.text = a;
    this.subText.x = 0.5 * -this.subText.width;
    this.subText.y = -80;
    this.subText.alpha = 1;
  }
  showTitle() {
    this.inClan && !this.clanTag.parent && this.addChild(this.clanTag);
    this.text.parent || this.addChild(this.text);
  }
  hideTitle() {
    this.inClan && this.clanTag.parent && this.removeChild(this.clanTag);
    this.text.parent && this.removeChild(this.text);
  }
  showSubTitle() {
    this.subText.parent || this.addChild(this.subText);
  }
  hideSubTitle() {
    this.subText.parent && this.removeChild(this.subText);
  }
  update(a, b, c) {
    this.x = this.attached.p.x + a.x;
    this.y = this.attached.p.y + a.y;
    this.go.isLocal ||
      (this.x - 10 > (App.ClientWidth - this.hw) / a.scale
        ? ((this.x = (App.ClientWidth - this.hw) / a.scale - 10), (this.edge = !0))
        : this.x < this.hw
        ? ((this.x = this.hw), (this.edge = !0))
        : (this.edge = !1),
      this.y - 16 > (App.ClientHeight - this.hh) / a.scale
        ? ((this.y = (App.ClientHeight - this.hh) / a.scale - 16), (this.edge = !0))
        : 60 > this.y && ((this.y = 60), (this.edge = !0)));
    this.edge && -1 !== this.go.team
      ? this.go.team !== this.team
        ? (this.visible = !1)
        : ((this.visible = !0),
          this.showTitle(),
          (this.text.alpha = this.skillTag.alpha = 0.5),
          this.inClan && (this.clanTag.alpha = 0.5),
          this.hideSubTitle(),
          (this.text.tint = this.go.alive ? this.tintColor : 6710886),
          this.inClan && this.clanTag.parent && this.removeChild(this.clanTag))
      : ((this.visible = !0),
        40 > Math.abs(b - this.x) && 50 > Math.abs(c - this.y)
          ? (this.showTitle(),
            (this.text.alpha = this.skillTag.alpha = 0.2),
            this.inClan &&
              ((this.clanTag.alpha = 0.2), this.clanTag.parent || this.addChild(this.clanTag)),
            (this.text.tint = this.go.alive ? this.tintColor : 6710886),
            (this.skillTag.visible = !0))
          : (this.hideTitle(), (this.skillTag.visible = !1)),
        this.marker &&
          ((a = Math.sin(this.markerTime)),
          (this.marker.y = -40 + 5 * a),
          (this.marker.alpha = 0.5 + 0.25 * a),
          (this.markerTime += 0.05)));
    0 < this.time &&
      (this.edge || this.showSubTitle(),
      this.time--,
      20 > this.time && (this.subText.alpha = 1 - 0.05 * (20 - this.time)),
      (0 === this.time || this.edge) && this.hideSubTitle());
  }
}
Label.FontText = { fontName: "Open Sans", fontSize: 22 };
Label.FontSubText = { fontName: "Open Sans", fontSize: 20 };
Label.FontClanTag = { fontName: "Open Sans", fontSize: 22 };
var labelcontainer = {};
class LabelContainer extends PIXI.Container {
  constructor() {
    super();
    this.labels = {};
    this.visibleTeam = -1;
  }
  update(a, b, c) {
    for (let d in this.labels) this.labels[d].update(a, b, c);
  }
  clear() {
    this.labels = {};
    this.children.forEach((a) => a.destroy({ children: !0 }));
    this.removeChildren();
  }
  onUpdateLabel(a) {
    let b = this.labels[a.id];
    void 0 !== a.text && b.setText(a.text);
    void 0 !== a.subText && b.setSubText(a.subText);
  }
  addLabel(a, b, c, d) {
    b = new Label(a, b, c, d.text || "");
    this.labels[a] = b;
    this.addChild(b);
    -1 !== this.visibleTeam && (b.team = this.visibleTeam);
  }
  onRemoveLabel(a) {
    a = a.id;
    let b = this.labels[a];
    b.parent && this.removeChild(b);
    delete this.labels[a];
  }
  setVisibleTeam(a) {
    this.visibleTeam = a;
    for (let b in this.labels) this.labels[b].team = a;
  }
}
var parallax = {};
class Parallax extends PIXI.ParticleContainer {
  constructor() {
    super(160, { position: !0, rotation: !0, batchSize: 160 });
    this.maxParticles = 160;
    this.minParticles = 20;
    this.count = 0;
    this.particles = [];
    this.intensity = 1;
    this.margin = 100;
    this._facedirection = this.rotate = !1;
    this._rotation = 0;
    this._drop = { min: 1, max: 2 };
    this._scale = { min: 1, max: 1 };
    this._alpha = { min: 1, max: 1 };
    this._direction = { min: -0.2, max: 0.2 };
    this._angular = { min: -0.05, max: 0.05 };
    this._dirOffset = { min: -5, max: 5 };
    this.lastY = this.lastX = this._dir = 0;
    this.type = "rain";
  }
  clear() {
    this.particles = [];
    this.children.forEach((a) => a.destroy({ children: !0 }));
    this.removeChildren();
  }
  initialize(a) {
    this.type = a.precipitation.type;
    this.rotate = !1;
    this._drop = { min: 1, max: 2 };
    this._scale = { min: 1, max: 1 };
    this._alpha = { min: 1, max: 1 };
    this._direction = { min: -0.2, max: 0.2 };
    this._offset = { min: -0.2, max: 0.2 };
    this._dir = this._rotation = 0;
    this.children.forEach((c) => c.destroy({ children: !0 }));
    this.removeChildren();
    switch (this.type) {
      case "dust":
        var b = App.CombinedTextures.precip_dust;
        this.rotate = !0;
        this._drop.min = 0.05;
        this._drop.max = 0.1;
        this._scale.min = 2.1;
        this._scale.max = 3.3;
        this._alpha.min = 0.01;
        this._alpha.max = 0.05;
        this._direction.min = -0.1;
        this._direction.max = 0.1;
        this._angular = { min: -0.01, max: 0.01 };
        this._dir = 0;
        this._dirOffset =
          this._dirOffset.min + (this._dirOffset.max - this._dirOffset.min) * Math.random();
        break;
      case "rain":
        b = App.CombinedTextures.precip_rain;
        this.rotate = !1;
        this._drop.min = 5;
        this._drop.max = 8;
        this._scale.min = 0.3;
        this._scale.max = 1;
        this._alpha.min = 0.1;
        this._alpha.max = 0.3;
        this._direction.min = -0.3;
        this._direction.max = 0.3;
        this._dirOffset = { min: -5, max: 5 };
        this._dir =
          this._dirOffset.min + (this._dirOffset.max - this._dirOffset.min) * Math.random();
        this._facedirection = !0;
        break;
      case "snow":
        b = App.CombinedTextures.precip_snow;
        this.rotate = !0;
        this._drop.min = 1.5;
        this._drop.max = 4;
        this._scale.min = 0.1;
        this._scale.max = 0.3;
        this._alpha.min = 0.1;
        this._alpha.max = 0.3;
        this._direction.min = -0.4;
        this._direction.max = 0.8;
        this._angular.min = -0.2;
        this._angular.min = 0.2;
        this._dir = 0;
        this._dirOffset =
          this._dirOffset.min + (this._dirOffset.max - this._dirOffset.min) * Math.random();
        break;
      case "stars":
        b = App.CombinedTextures.precip_star;
        this._drop.min = 0;
        this._drop.max = 0;
        this._scale.min = 0.9;
        this._scale.max = 2.5;
        this._direction.min = -1e-7;
        this._direction.max = -5e-7;
        this._angular.min = -0.02;
        this._angular.min = 0.02;
        this.rotate = !0;
        this._dir = 0;
        this._dirOffset =
          this._dirOffset.min + (this._dirOffset.max - this._dirOffset.min) * Math.random();
        break;
      case "matrix":
        break;
      default:
        this.count = 0;
        return;
    }
    this.count = Math.round(a.precipitation.intensity * this.maxParticles);
    this.count > this.maxParticles
      ? (this.count = this.maxParticles)
      : this.count < this.minParticles && (this.count = this.minParticles);
    for (let c = 0, d = this.count; c < d; c++)
      (a = new PIXI.Sprite(b)),
        (a.x = -this.margin + Math.random() * (App.ClientWidth + 2 * this.margin)),
        (a.y = -this.margin + Math.random() * (App.ClientHeight + 2 * this.margin)),
        (a.alpha = this._alpha.min + (this._alpha.max - this._alpha.min) * Math.random()),
        (a.speed = this._drop.min + (this._drop.max - this._drop.min) * Math.random()),
        (a.scale.x = a.scale.y =
          this._scale.min + (this._scale.max - this._scale.min) * Math.random()),
        (a.direction =
          this._direction.min + (this._direction.max - this._direction.min) * Math.random()),
        this.rotate
          ? ((a.rotation = Math.random() * Math.PI * 2),
            (a.anchor.x = a.anchor.y = 0.5),
            (a.angular =
              this._angular.min + (this._angular.max - this._angular.min) * Math.random()))
          : (a.rotation = this._facedirection
              ? Math.atan2(-a.direction - this._dir, a.speed)
              : this._rotation),
        this.addChild(a);
  }
  distribute() {
    for (let a = 0, b = this.children.length; a < b; a++) {
      let c = this.children[a];
      c.x = -this.margin + Math.random() * (App.ClientWidth + 2 * this.margin);
      c.y = -this.margin + Math.random() * (App.ClientHeight + 2 * this.margin);
    }
  }
  update(a) {
    let b = a.x - this.lastX,
      c = a.y - this.lastY;
    "stars" === this.type && ((b *= 0.2), (c *= 0.2));
    this.lastX = a.x;
    this.lastY = a.y;
    a = this.children.length;
    let d = App.ClientWidth + 2 * this.margin,
      e = App.ClientHeight + 2 * this.margin;
    for (; 0 < a--; ) {
      let f = this.children[a];
      f.x += (f.direction + this._dir) * f.scale.x * 3 + 0.5 * b;
      f.y += f.speed * f.scale.x * 3 + 0.5 * c;
      this.rotate && (f.rotation += f.angular);
      f.y > App.ClientHeight + this.margin
        ? (f.y -= e)
        : f.y < -this.margin
        ? (f.y += e)
        : f.x < -this.margin
        ? (f.x += d)
        : f.x > App.ClientWidth + this.margin && (f.x -= d);
    }
  }
}
var Customization = {
  HAIR: "hair",
  ENERGY: "energy",
  TORSO: "torso",
  FACE: "face",
  BELT: "belt",
  ARMLEFTLOWER: "armleftlower",
  ARMLEFTUPPER: "armleftupper",
  ARMRIGHTLOWER: "armrightlower",
  ARMRIGHTUPPER: "armrightupper",
  LEGLEFTLOWER: "legleftlower",
  LEGLEFTUPPER: "legleftupper",
  LEGRIGHTLOWER: "legrightlower",
  LEGRIGHTUPPER: "legrightupper",
};
const GameCommands = {
  CLEAR: "clear",
  MESSAGE: "say",
  SHUTDOWN: "shutdown",
  LOAD: "load",
  SPAWN: "spawn",
  PAUSE: "pause",
  SPECTATE: "spec",
  JOIN: "join",
  PREFERENCE: "pref",
  KILL: "kill",
  LOGIN: "login",
  CLIENTS: "clients",
  COMMANDS: "commands",
  KICK: "kick",
  BAN: "ban",
  BALANCE: "balance",
  PARAMS: "params",
  MEMSTATS: "memstats",
  WAVE: "wave",
  SALUTE: "salute",
  BUSY: "busy",
  DONE: "done",
};
function GameStatus(a, b) {
  this.t = a;
  this.s = b;
}
GameStatus.Player = { JOIN: 0, LEAVE: 1, SPEC: 2, LIST: 3 };
GameStatus.Game = { RUNNING: 20, PAUSED: 21, GAMEOVER: 22, COUNTDOWN: 23, LEADER: 24, TEAM: 25 };
GameStatus.Settings = { WORLD: 40 };
class ActionTable extends PIXI.Container {
  constructor() {
    super();
    this.tableWidth = 420;
    this.tableHeight = 200;
    this.maxChars = 50;
    for (this.spaceStr = ""; this.spaceStr.length < this.maxChars; ) this.spaceStr += " ";
    this.maxLines = 7;
    this.textFields = [];
    this.icons = [];
    this.bravoFlagCount = this.alphaFlagCount = null;
  }
  register(a, b) {
    this.addRow(a, b || null);
  }
  setMode(a) {
    switch (a) {
      case Game.MODE_CTF:
        this.displayCTFUI();
        break;
      case Game.MODE_DM:
        this.displayDMUI();
        break;
      case Game.MODE_TDM:
        this.displayTDMUI();
        break;
      case Game.MODE_DB:
        this.displayDBUI();
    }
  }
  displayCTFUI() {
    var a = new PIXI.Sprite(App.CombinedTextures.flag_alpha);
    a.x = this.tableWidth - 80;
    a.y = 300;
    a.scale.x = a.scale.y = 0.4;
    a.alpha = 0.6;
    this.addChild(a);
    this.alphaFlagCount = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16711680,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.alphaFlagCount.x = a.x + a.width + 8;
    this.alphaFlagCount.y = a.y + 5;
    this.alphaFlagCount.alpha = 0.7;
    this.addChild(this.alphaFlagCount);
    a = new PIXI.Sprite(App.CombinedTextures.flag_bravo);
    a.x = this.tableWidth - 80;
    a.y = 350;
    a.scale.x = a.scale.y = 0.4;
    a.alpha = 0.6;
    this.addChild(a);
    this.bravoFlagCount = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 22,
      fill: 255,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.bravoFlagCount.x = a.x + a.width + 8;
    this.bravoFlagCount.y = a.y + 5;
    this.bravoFlagCount.alpha = 0.7;
    this.addChild(this.bravoFlagCount);
  }
  updateFlagScore(a) {
    this.alphaFlagCount.text = a.alphaPoints;
    this.bravoFlagCount.text = a.bravoPoints;
  }
  updateTDMScore(a) {
    this.alphaFlagCount.text = a.alphaPoints;
    this.bravoFlagCount.text = a.bravoPoints;
  }
  updateDBScore(a) {
    this.alphaFlagCount.text = a.alphaPoints;
    this.bravoFlagCount.text = a.bravoPoints;
  }
  updateTRScore(a) {}
  displayDMUI() {
    for (var a = 0; 5 > a; a++) {
      this["p" + (a + 1)] = new PIXI.BitmapText(a + 1 + ". empty", {
        fontName: "Open Sans",
        fontSize: 25,
      });
      var b = this["p" + (a + 1)];
      b.tint = 11184810;
      b.alpha = 0.9;
      b.x = 240;
      b.y = 160 + 25 * a;
      this.addChild(b);
      this["ps" + (a + 1)] = new PIXI.BitmapText("", { fontName: "Open Sans", fontSize: 25 });
      b = this["ps" + (a + 1)];
      b.tint = 11184810;
      b.alpha = 0.9;
      b.x = 400;
      b.y = 160 + 25 * a;
      this.addChild(b);
    }
    this.pLocal = new PIXI.BitmapText("..", { fontName: "Open Sans", fontSize: 25 });
    this.pLocal.tint = 8765929;
    this.pLocal.x = 240;
    this.pLocal.y = 295;
    this.addChild(this.pLocal);
  }
  displayTDMUI() {
    var a = new PIXI.Sprite(App.CombinedTextures.tdm_alpha);
    a.x = this.tableWidth - 80;
    a.y = 300;
    a.scale.x = a.scale.y = 0.35;
    a.alpha = 0.6;
    this.addChild(a);
    this.alphaFlagCount = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16711680,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.alphaFlagCount.x = a.x + a.width + 8;
    this.alphaFlagCount.y = a.y + 7;
    this.alphaFlagCount.alpha = 0.7;
    this.addChild(this.alphaFlagCount);
    a = new PIXI.Sprite(App.CombinedTextures.tdm_bravo);
    a.x = this.tableWidth - 80;
    a.y = 350;
    a.scale.x = a.scale.y = 0.35;
    a.alpha = 0.6;
    this.addChild(a);
    this.bravoFlagCount = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 22,
      fill: 255,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.bravoFlagCount.x = a.x + a.width + 8;
    this.bravoFlagCount.y = a.y + 7;
    this.bravoFlagCount.alpha = 0.7;
    this.addChild(this.bravoFlagCount);
  }
  displayDBUI() {
    var a = new PIXI.Sprite(App.CombinedTextures.db_alpha);
    a.x = this.tableWidth - 80;
    a.y = 300;
    a.scale.x = a.scale.y = 0.35;
    a.alpha = 0.6;
    this.addChild(a);
    this.alphaFlagCount = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16711680,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.alphaFlagCount.x = a.x + a.width + 8;
    this.alphaFlagCount.y = a.y + 7;
    this.alphaFlagCount.alpha = 0.7;
    this.addChild(this.alphaFlagCount);
    a = new PIXI.Sprite(App.CombinedTextures.db_bravo);
    a.x = this.tableWidth - 80;
    a.y = 350;
    a.scale.x = a.scale.y = 0.35;
    a.alpha = 0.6;
    this.addChild(a);
    this.bravoFlagCount = new PIXI.Text("0", {
      fontName: "Arial",
      fontSize: 22,
      fill: 255,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.bravoFlagCount.x = a.x + a.width + 8;
    this.bravoFlagCount.y = a.y + 7;
    this.bravoFlagCount.alpha = 0.7;
    this.addChild(this.bravoFlagCount);
  }
  updateTopListing(a) {
    for (var b = 0; 5 > b; b++) {
      var c = this["p" + (b + 1)],
        d = this["ps" + (b + 1)];
      b < a.top.length
        ? ((c.text = b + 1 + ". " + a.top[b].name.substr(0, 12) + ".. "),
          (c.tint = a.top[b].color),
          (d.text = a.top[b].kills),
          (d.tint = a.top[b].color))
        : ((c.text = b + 1 + " empty"), (c.tint = 11184810), (d.text = ""), (d.tint = 11184810));
    }
    a.local &&
      ((this.pLocal.visible = 5 > a.local.index ? !1 : !0),
      (this.pLocal.text = a.local.index + 1 + ". You       .. " + a.local.kills));
  }
  addRow(a, b) {
    var c = this.spaceStr.substr(0, this.maxChars - a.length) + a;
    a = this.textFields.length;
    this.icons.push(b);
    c = new PIXI.BitmapText(c, ActionTable.FontRow);
    c.anchor.x = 1;
    c.x = this.tableWidth - 58;
    c.y = 5 + 21 * a;
    c.alpha = 0.6;
    this.addChild(c);
    this.textFields.push(c);
    b &&
      ((b.x = this.tableWidth - 34),
      (b.y = 16 + 21 * a),
      (b.rotation = 1.9 * Math.PI),
      this.addChild(b));
    if (a === this.maxLines) {
      this.removeChild(this.textFields.splice(0, 1)[0]);
      b = this.icons[0];
      this.icons.splice(0, 1);
      b && this.removeChild(b);
      for (b = 0; b < this.textFields.length; b++) this.textFields[b].y -= 21;
      for (b = 0; b < this.icons.length; b++) null !== this.icons[b] && (this.icons[b].y -= 21);
    }
  }
  getWidth() {
    return this.tableWidth;
  }
  getHeight() {
    return this.tableHeight;
  }
}
ActionTable.FontRow = { fontName: "Open Sans", fontSize: 21 };
function AmmoBar() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.barWidth = 348;
  this.barHeight = 36;
  this.value = this.maxValue = AmmoBar.MAX_VALUE;
  this.itemTitle = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    fontSize: 38,
    align: "center",
  });
  this.itemTitle.x = 3;
  this.itemTitle.y = -34;
  this.addChild(this.itemTitle);
  this.ammoCount = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    fontSize: 38,
    align: "center",
  });
  this.ammoCount.x = 240;
  this.ammoCount.y = 0;
  this.addChild(this.ammoCount);
  this.ammoIcon = new PIXI.Sprite(App.CombinedTextures.ammo_icon);
  this.ammoIcon.x = 6;
  this.ammoIcon.y = 2;
  this.addChild(this.ammoIcon);
  this.beltItemTitle = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    fontSize: 38,
    align: "center",
  });
  this.beltItemTitle.x = 366;
  this.beltItemTitle.y = -34;
  this.addChild(this.beltItemTitle);
  this.beltAmmoCount = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    fontSize: 38,
    align: "center",
  });
  this.beltAmmoCount.x = 385;
  this.beltAmmoCount.y = 1;
  this.beltAmmoCount.text = "Empty";
  this.addChild(this.beltAmmoCount);
  this.beltItemTitle.visible = !1;
  this.beltAmmoAmount = 0;
  this.beltIcon = null;
  this.background = new PIXI.Graphics();
  this.background.beginFill(3355443, 0.1);
  this.background.drawRect(0, 0, this.barWidth, this.barHeight);
  this.background.drawRect(this.barWidth + 24, 0, 100, this.barHeight);
  this.background.endFill();
  this.bar = new PIXI.Container();
  this.addChild(this.background);
  this.addChild(this.bar);
  this.numElements = 10;
  this.elements = [];
  for (var a = 0; a < this.numElements; a++) {
    var b = new PIXI.Sprite(App.CombinedTextures.ammo_bar_element);
    b.x = 42 + 20 * a;
    b.y = 2;
    this.elements.push(b);
    this.bar.addChild(b);
  }
  this.margin = 4;
}
AmmoBar.prototype = Object.create(PIXI.Container.prototype);
AmmoBar.prototype.constructor = AmmoBar;
AmmoBar.MAX_VALUE = 100;
AmmoBar.prototype.setValue = function (a) {
  this.value = a;
  this.update();
  0 >= this.value
    ? ((this.ammoCount.tint = 16724736), (this.ammoCount.text = "reload.."))
    : (this.value > 0.35 * this.maxValue
        ? (this.ammoCount.tint = 16777215)
        : this.value <= 0.35 * this.maxValue && (this.ammoCount.tint = 16755200),
      (this.ammoCount.text = "x" + this.value));
  this.ammoCount.x = 298 - 0.5 * this.ammoCount.width;
};
AmmoBar.prototype.getValue = function () {
  return this.value;
};
AmmoBar.prototype.setMaxValue = function (a) {
  this.maxValue = a;
  this.setValue(this.maxValue);
};
AmmoBar.prototype.subtract = function () {
  this.setValue(this.getValue() - 1);
};
AmmoBar.prototype.update = function () {
  for (
    var a = Math.ceil((this.numElements / this.maxValue) * this.value), b = 0;
    b < this.numElements;
    b++
  )
    this.elements[b].alpha = b < a ? 1 : 0.2;
};
AmmoBar.prototype.setItem = function (a) {
  a
    ? (this.itemTitle.text = ItemMap[a.t].title)
    : ((this.itemTitle.text = "Fists"),
      (this.ammoCount.tint = 16777215),
      (this.ammoCount.text = ""),
      (this.value = 0),
      this.update());
};
AmmoBar.prototype.setBeltItem = function (a) {
  this.beltIcon && (this.removeChild(this.beltIcon), (this.beltIcon = null));
  a
    ? ((this.beltIcon = new SpriteMap[a.t.substr(1)]()),
      (this.beltIcon.x = this.beltItemTitle.x + 18),
      (this.beltIcon.y = this.beltItemTitle.y + 50),
      (this.beltIcon.width = 0.45),
      (this.beltIcon.height = 0.45),
      this.addChild(this.beltIcon),
      (this.beltItemTitle.text = ItemMap[a.t].title),
      (this.beltAmmoCount.text = "x" + ItemMap[a.t].amount),
      (this.beltAmmoCount.x = 420),
      (this.beltAmmoAmount = parseInt(ItemMap[a.t].amount)),
      (this.beltItemTitle.visible = !0))
    : ((this.beltItemTitle.text = ""),
      (this.beltAmmoCount.text = "Empty"),
      (this.itemTitle.text = ""));
};
AmmoBar.prototype.decrementBeltValue = function (a) {
  this.beltAmmoAmount--;
  0 >= this.beltAmmoAmount
    ? ((this.beltItemTitle.visible = !1),
      (this.beltAmmoCount.text = "Empty"),
      this.beltIcon && (this.beltIcon.visible = !1),
      (this.beltAmmoCount.x = 395))
    : (this.beltAmmoCount.text = "x" + this.beltAmmoAmount.toString());
};
AmmoBar.prototype.getWidth = function () {
  return this.barWidth;
};
AmmoBar.prototype.getHeight = function () {
  return this.barHeight;
};
var escapemenu = {};
class EscapeMenu extends PIXI.Graphics {
  constructor() {
    super();
    this.mute = Registry.Instance[Registry.Key.SETTINGS].sound.enabled
      ? EscapeMenu.MUTE_NO
      : EscapeMenu.MUTE_YES;
    this.interactive = !0;
    this.lineStyle(1, 16777215, 0.1, 0);
    this.beginFill(3355443, 0.9);
    this.drawRect(0, 0, 360, 324);
    this.endFill();
    this.beginFill(0, 0.3);
    this.drawRect(10, 10, 340, 304);
    this.endFill();
    this.drawRect(15, 42, 330, 2);
    this.closeButton = new PIXI.Sprite(App.CombinedTextures.exit);
    this.closeButton.x = this.width - 44;
    this.closeButton.y = 12;
    this.closeButton.interactive = !0;
    this.closeButton.on("mouseover", () => AudioEffects.ButtonHover.audio.play());
    this.closeButton.on("mousedown", () => {
      AudioEffects.ButtonClick.audio.play();
      this.emit(EscapeMenu.CLOSE);
    });
    this.closeButton.on("touchstart", () => {
      AudioEffects.ButtonClick.audio.play();
      this.emit(EscapeMenu.CLOSE);
    });
    this.addChild(this.closeButton);
    this.title = new PIXI.Text("Menu (ESC)", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16763904,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.resolution = 1.5 * App.DevicePixelRatio;
    this.title.x = 0.5 * (this.width - this.title.width);
    this.title.y = 16;
    this.addChild(this.title);
    this.muteButton = new EscapeMenuButton(
      this.mute === EscapeMenu.MUTE_YES ? EscapeMenu.MUTE_NO : EscapeMenu.MUTE_YES,
      16777215,
      this.mute === EscapeMenu.MUTE_YES ? "mute_icon" : "unmute_icon"
    );
    this.muteButton.x = 0.5 * (this.width - this.muteButton.width);
    this.muteButton.y = 60;
    this.muteButton.on("mousedown", () => this.onMute());
    this.muteButton.on("touchstart", () => this.onMute());
    this.addChild(this.muteButton);
    this.controlsButton = new EscapeMenuButton("Controls (H)", 16777215);
    this.controlsButton.x = 0.5 * (this.width - this.controlsButton.width);
    this.controlsButton.y = 120;
    this.controlsButton.on("mousedown", () => this.emit(EscapeMenu.CONTROLS));
    this.controlsButton.on("touchstart", () => this.emit(EscapeMenu.CONTROLS));
    this.addChild(this.controlsButton);
    this.weaponMenuButton = new EscapeMenuButton("Weapons (G)", 16777215);
    this.weaponMenuButton.x = 0.5 * (this.width - this.weaponMenuButton.width);
    this.weaponMenuButton.y = 180;
    this.weaponMenuButton.on("mousedown", () => this.emit(EscapeMenu.WEAPONS));
    this.weaponMenuButton.on("touchstart", () => this.emit(EscapeMenu.WEAPONS));
    this.addChild(this.weaponMenuButton);
    this.escapeButton = new EscapeMenuButton("Leave / Exit", 16711680);
    this.escapeButton.x = 0.5 * (this.width - this.escapeButton.width);
    this.escapeButton.y = 250;
    this.escapeButton.on("mousedown", () => this.emit(EscapeMenu.EXIT));
    this.escapeButton.on("touchstart", () => this.emit(EscapeMenu.EXIT));
    this.addChild(this.escapeButton);
  }
  onMute() {
    this.mute = this.mute === EscapeMenu.MUTE_NO ? EscapeMenu.MUTE_YES : EscapeMenu.MUTE_NO;
    this.muteButton.setTitle(
      this.mute === EscapeMenu.MUTE_YES ? EscapeMenu.MUTE_NO : EscapeMenu.MUTE_YES
    );
    this.muteButton.setIcon(this.mute === EscapeMenu.MUTE_YES ? "mute_icon" : "unmute_icon");
    this.emit(EscapeMenu.MUTE, this.mute === EscapeMenu.MUTE_YES);
  }
  setMuted(a) {
    this.mute = a ? EscapeMenu.MUTE_YES : EscapeMenu.MUTE_NO;
    this.muteButton.setTitle(
      this.mute === EscapeMenu.MUTE_YES ? EscapeMenu.MUTE_NO : EscapeMenu.MUTE_YES
    );
    this.muteButton.setIcon(this.mute === EscapeMenu.MUTE_YES ? "mute_icon" : "unmute_icon");
  }
}
EscapeMenu.CLOSE = "close";
EscapeMenu.MUTE = "mute";
EscapeMenu.CONTROLS = "controls";
EscapeMenu.SETTINGS = "settings";
EscapeMenu.WEAPONS = "weapons";
EscapeMenu.EXIT = "exit";
EscapeMenu.MUTE_NO = "Sound OFF";
EscapeMenu.MUTE_YES = "Sound ON";
class EscapeMenuButton extends PIXI.Graphics {
  constructor(a, b = 16777215, c = null) {
    super();
    this.beginFill(16777215, 0.2);
    this.drawRect(0, 0, 180, 30);
    this.endFill();
    this.interactive = !0;
    this.title = new PIXI.Text(a, {
      fontName: "Arial",
      fontSize: 20,
      fill: b,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.resolution = 1.5 * App.DevicePixelRatio;
    this.title.x = 0.5 * (this.width - this.title.width);
    this.title.y = 0.5 * (this.height - this.title.height) + 1;
    this.addChild(this.title);
    this.tint = 10066329;
    c &&
      ((this.icon = new PIXI.Sprite(App.CombinedTextures[c])),
      (this.icon.x = this.title.x + this.title.width + 4),
      this.addChild(this.icon));
    this.on("mouseover", () => this.onMouseOver());
    this.on("mouseout", () => this.onMouseOut());
    this.on("mousedown", () => this.onMouseDown());
  }
  setTitle(a) {
    this.title.text = a;
    this.title.x = 0.5 * (this.width - this.title.width);
    this.icon && (this.icon.x = this.title.x + this.title.width + 4);
  }
  onMouseOver() {
    this.tint = 16777215;
    AudioEffects.ButtonHover.audio.play();
  }
  onMouseOut() {
    this.tint = 10066329;
  }
  onMouseDown() {
    AudioEffects.ButtonClick.audio.play();
  }
  setIcon(a) {
    this.icon.texture = App.CombinedTextures[a];
  }
}
function GameoverDisplay() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._width = App.ClientWidth;
  this._height = 100;
  this.gameoverTitle = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    fontSize: 40,
    fill: "#FFD700",
    align: "center",
    dropShadow: !0,
    dropShadowColor: "#000000",
    dropShadowDistance: 2,
    dropShadowAngle: 0.25 * Math.PI,
  });
  this.addChild(this.gameoverTitle);
  this.countdownClock = new PIXI.BitmapText("", {
    fontName: "Open Sans",
    fontSize: 40,
    fill: "#DDDDDD",
    align: "center",
    dropShadow: !0,
    dropShadowColor: "#000000",
    dropShadowDistance: 2,
    dropShadowAngle: 0.25 * Math.PI,
  });
  this.addChild(this.countdownClock);
}
GameoverDisplay.prototype = Object.create(PIXI.Container.prototype);
GameoverDisplay.prototype.constructor = GameoverDisplay;
GameoverDisplay.prototype.setContent = function (a) {
  this.gameoverTitle.text = a.msg;
  this.gameoverTitle.tint = 16766720;
  this.gameoverTitle.x = 0.5 * (this._width - this.gameoverTitle.width);
  this.gameoverTitle.y = -30;
  this.countdownClock.y = 10;
  this.count = a.countdown;
  a.completed ? this.hideClock() : this.showClock();
};
GameoverDisplay.prototype.updateCountdown = function (a) {
  this.count--;
  this.countdownClock.text = "New game starting in .. " + a;
  this.countdownClock.x = 0.5 * (this._width - this.countdownClock.width);
};
GameoverDisplay.prototype.getWidth = function () {
  return this._width;
};
GameoverDisplay.prototype.getHeight = function () {
  return this._height;
};
GameoverDisplay.prototype.showClock = function () {
  this.countdownClock.visible = !0;
};
GameoverDisplay.prototype.hideClock = function () {
  this.countdownClock.visible = !1;
};
var goldcount = {};
class GoldCount extends PIXI.Container {
  constructor() {
    super();
    this.background = new PIXI.Graphics();
    this.background.beginFill(3355443, 0.1);
    this.background.drawRect(0, 0, 116, 36);
    this.background.endFill();
    this.addChild(this.background);
    this.goldIcon = new PIXI.Sprite(App.CombinedTextures.gold1);
    this.goldIcon.x = 6;
    this.goldIcon.y = -1;
    this.goldIcon.scale.x = this.goldIcon.scale.y = 0.65;
    this.addChild(this.goldIcon);
    this.goldText = new PIXI.BitmapText("0", { fontName: "Open Sans", fontSize: 38 });
    this.goldText.x = this.goldIcon.x + this.goldIcon.width + 10;
    this.goldText.y = this.goldIcon.y + 2;
    this.addChild(this.goldText);
    this.gold = 0;
  }
  increment(a) {
    this.gold += a;
    this.goldText.text = this.gold.toString();
  }
  setValue(a) {
    this.gold = a;
    this.goldText.text = this.gold.toString();
  }
}
function HealthBar() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.barWidth = 262;
  this.barHeight = 36;
  this.value = 100;
  this.healthIcon = new PIXI.Sprite(App.CombinedTextures.health_icon);
  this.healthIcon.x = 6;
  this.healthIcon.y = 2;
  this.addChild(this.healthIcon);
  this.maxValue = HealthBar.MAX_VALUE;
  this.background = new PIXI.Graphics();
  this.background.beginFill(3355443, 0.1);
  this.background.drawRect(0, 0, this.barWidth, this.barHeight);
  this.background.endFill();
  this.bar = new PIXI.Container();
  this.addChild(this.background);
  this.addChild(this.bar);
  this.numElements = 10;
  this.elements = [];
  for (var a = 0; a < this.numElements; a++) {
    var b = new PIXI.Sprite(App.CombinedTextures.health_bar_element);
    b.x = 42 + 20 * a;
    b.y = 2;
    this.elements.push(b);
    this.bar.addChild(b);
  }
  this.margin = 4;
}
HealthBar.prototype = Object.create(PIXI.Container.prototype);
HealthBar.prototype.constructor = HealthBar;
HealthBar.MAX_VALUE = 100;
HealthBar.prototype.setValue = function (a) {
  this.value = a;
  this.update();
};
HealthBar.prototype.getValue = function () {
  return this.value;
};
HealthBar.prototype.update = function () {
  for (
    var a = Math.ceil((this.numElements / this.maxValue) * this.value), b = 0;
    b < this.numElements;
    b++
  )
    this.elements[b].alpha = b < a ? 1 : 0.2;
};
HealthBar.prototype.getWidth = function () {
  return this.barWidth;
};
HealthBar.prototype.getHeight = function () {
  return this.barHeight;
};
var playerdropdown = {};
class PlayerDropdown extends PIXI.Container {
  constructor() {
    super();
    this.target = null;
    this.interactive = !0;
    this.background = new PIXI.Graphics();
    this.background.lineStyle(1, 16777215, 0.1, 0);
    this.background.beginFill(3355443, 0.9);
    this.background.drawRoundedRect(0, 0, 210, 72, 4);
    this.background.endFill();
    this.muteRow = new PlayerDropdownActionRow("Mute", PlayerDropdown.Action.MUTE, 15597568);
    this.unmuteRow = new PlayerDropdownActionRow("Unmute", PlayerDropdown.Action.UNMUTE, 15597568);
    this.inviteRow = new PlayerDropdownActionRow(
      "Send friend invitation",
      PlayerDropdown.Action.INVITE,
      16763904
    );
    this.inviteRow.on("mousedown", () => this.onInvite());
    this.muteRow.on("mousedown", () => this.onMute());
    this.unmuteRow.on("mousedown", () => this.onUnmute());
    this.inviteRow.on("touchstart", () => this.onInvite());
    this.muteRow.on("touchstart", () => this.onMute());
    this.unmuteRow.on("touchstart", () => this.onUnmute());
    this.on("mouseout", () => {
      this.parent && this.parent.removeChild(this);
    });
    this.muteRow.x = 10;
    this.unmuteRow.x = 10;
    this.inviteRow.x = 10;
    this.muteRow.y = 7;
    this.unmuteRow.y = 7;
    this.inviteRow.y = 43;
    this.unmuteRow.visible = !1;
    this.addChild(this.background);
    this.addChild(this.muteRow);
    this.addChild(this.unmuteRow);
    this.addChild(this.inviteRow);
  }
  async onInvite() {
    this.parent && this.parent.removeChild(this);
    let a = await APIClient.postInviteFriend(this.target.name, App.Credential.id);
    a.success
      ? App.Console.log("Friend invitation sent to " + this.target.name)
      : App.Console.log(a.error);
  }
  onMute() {
    -1 === Game.Muted.indexOf(this.target.sid) &&
      (Game.Muted.push(this.target.sid),
      (this.muteRow.visible = !1),
      (this.unmuteRow.visible = !0));
  }
  onUnmute() {
    -1 !== Game.Muted.indexOf(this.target.sid) &&
      (Game.Muted.splice(Game.Muted.indexOf(this.target.sid), 1),
      (this.muteRow.visible = !0),
      (this.unmuteRow.visible = !1));
  }
  show() {
    -1 !== Game.Muted.indexOf(this.target.sid)
      ? ((this.muteRow.visible = !1), (this.unmuteRow.visible = !0))
      : ((this.muteRow.visible = !0), (this.unmuteRow.visible = !1));
  }
}
PlayerDropdown.Action = { MUTE: "mute", UNMUTE: "unmute", INVITE: "invite" };
class PlayerDropdownActionRow extends PIXI.Container {
  constructor(a, b, c) {
    super();
    this.actionText = new PIXI.Text(a, {
      fontName: "Arial",
      fontSize: 18,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.interactive = !0;
    this.hitArea = new PIXI.Rectangle(0, 0, 200, 30);
    this.actionText.tint = c;
    this.actionText.alpha = 0.7;
    this.on("mouseover", () => {
      this.actionText.alpha = 1;
    });
    this.on("mouseout", () => {
      this.actionText.alpha = 0.7;
    });
    this.addChild(this.actionText);
  }
}
var dm_leaderboard = {};
function LeaderboardDM() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._width = App.ClientWidth - 400;
  this._height = 560;
  this.invalidated = !0;
  this.dropdown = new PlayerDropdown();
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.3);
  this.background.drawRoundedRect(0, 0, 590, 420, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.titleField = new PIXI.Text("Leaderboard", {
    fontName: "Arial",
    fontSize: 22,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField.x = 230;
  this.titleField.y = 12;
  this.titleField.resolution = 1.5 * App.DevicePixelRatio;
  this.addChild(this.titleField);
  this.killsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.deathsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.ratioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.skillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.table = new PIXI.Container();
  this.addChild(this.table);
  this.killsTitleField.x = 264;
  this.killsTitleField.y = 42;
  this.deathsTitleField.x = 340;
  this.deathsTitleField.y = 42;
  this.ratioTitleField.x = 434;
  this.ratioTitleField.y = 42;
  this.skillTitleField.x = 524;
  this.skillTitleField.y = 42;
  this.addChild(this.killsTitleField);
  this.addChild(this.deathsTitleField);
  this.addChild(this.ratioTitleField);
  this.addChild(this.skillTitleField);
  this.rows = new OrderedContainer();
  this.rowLabel = new DMRowLabel();
}
LeaderboardDM.prototype = Object.create(PIXI.Container.prototype);
LeaderboardDM.prototype.constructor = LeaderboardDM;
LeaderboardDM.prototype.validate = function () {
  this.invalidated &&
    (this.rows.sortMethodMultiple(-1, "getDeaths", 1, "getKills"),
    this.update(),
    (this.invalidated = !1));
};
LeaderboardDM.prototype.reset = function () {
  this.rows.iterate(function (a, b) {
    b.setDeaths(0);
    b.setKills(0);
    return !0;
  });
};
LeaderboardDM.prototype.hide = function () {
  this.hideDropdown();
  this.hideClientInfo();
  for (var a = 0, b = this.rows.getSize(); a < b; a++) this.rows.getIndex(a).unmark();
};
LeaderboardDM.prototype.updateTeamPoints = function () {};
LeaderboardDM.prototype.addClient = function (a) {
  if (this.rows.getById(a.sid)) this.updateClient(a);
  else {
    var b = new DMLeaderboardRow(a);
    b.on("mouseover", (c) => {
      this.displayClientInfo(c);
      b.mark();
      AudioEffects.ButtonHover.audio.play();
    });
    b.on("mouseout", () => {
      this.hideClientInfo();
      b.unmark();
    });
    b.on("mousemove", (c) => this.moveClientInfo(c));
    b.on("rightdown", (c) => this.displayDropdown(c));
    b.on("mousedown", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    b.on("touchstart", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    this.rows.add(b, a.sid);
    this.table.addChild(b);
    this.visible
      ? (this.rows.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
      : (this.invalidated = !0);
  }
};
LeaderboardDM.prototype.displayDropdown = function (a) {
  const b = a.target;
  "guest" !== App.Credential.accounttype &&
    b.name !== App.Credential.username &&
    (this.dropdown.target === b && this.dropdown.parent
      ? this.hideDropdown()
      : ((this.dropdown.target = b),
        this.addChild(this.dropdown),
        this.dropdown.show(),
        (this.dropdown.x = a.data.global.x - this.x - 10),
        (this.dropdown.y = a.data.global.y - this.y - 4)));
};
LeaderboardDM.prototype.hideDropdown = function () {
  this.dropdown.parent && this.removeChild(this.dropdown);
};
LeaderboardDM.prototype.removeClient = function (a) {
  var b = this.rows.getById(a.sid);
  b && this.table.removeChild(b);
  this.rows.getById(a.sid) && this.rows.remove(a.sid);
  this.update();
};
LeaderboardDM.prototype.displayClientInfo = function (a) {
  this.rowLabel.update(
    a.target.name,
    a.target.title,
    a.target.level,
    a.target.skill,
    a.target.skillIndex,
    a.target.clanName
  );
  this.rowLabel.parent || this.addChild(this.rowLabel);
};
LeaderboardDM.prototype.hideClientInfo = function () {
  this.rowLabel.parent && this.removeChild(this.rowLabel);
};
LeaderboardDM.prototype.moveClientInfo = function (a) {
  this.rowLabel.parent &&
    ((this.rowLabel.x = a.data.global.x - this.x),
    (this.rowLabel.y = a.data.global.y - (this.y + this.rowLabel.height)));
};
LeaderboardDM.prototype.updateClient = function (a) {
  var b = this.rows.getIndexById(a.sid);
  if ((b = this.rows.getIndex(b)))
    void 0 !== a.kills && b.setKills(b.getKills() + a.kills),
      void 0 !== a.deaths && b.setDeaths(b.getDeaths() + a.deaths),
      void 0 !== a.level && b.setSkill(a.level);
  this.visible
    ? (this.rows.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
    : (this.invalidated = !0);
};
LeaderboardDM.prototype.update = function () {
  for (var a = [], b = null, c = 0, d = this.rows.getSize(); c < d; c++) {
    var e = this.rows.getIndex(c);
    5 > c && a.push({ name: e.name, color: Team.HexColors[e.team], kills: e.kills });
    e.local && (b = { name: e.name, index: c, kills: e.kills });
    e.x = 135;
    e.y = 68 + 28 * c;
  }
  this.dispatchEvent(new HudEvent(HudEvent.LEADERBOARD_UPDATE, { top: a, local: b }));
};
LeaderboardDM.prototype.getWidth = function () {
  return this._width;
};
LeaderboardDM.prototype.getHeight = function () {
  return this._height;
};
function DMLeaderboardRow(a) {
  PIXI.Sprite.call(this);
  this.sid = a.sid;
  this.name = a.name;
  this.local = a.local || !1;
  this.title = a.title;
  this.clanId = a.clan_id;
  this.clanName = a.clan_name;
  this.skill = a.skill;
  this.team = a.team;
  this.ratio = 0;
  this.interactive = !0;
  this.background = new PIXI.Graphics();
  this.background.beginFill(16777215, 0.05);
  this.background.drawRect(-130, -4, 580, 28, 4);
  this.background.beginFill(16777215, 0.2);
  this.background.drawRect(-128, -2, 576, 24, 4);
  this.background.endFill();
  this.hitArea = new PIXI.Rectangle(-130, 0, 580, 20);
  a
    ? (a.record
        ? ((this.kills = a.record.kills || 0), (this.deaths = a.record.deaths || 0))
        : (this.deaths = this.kills = 0),
      (this.level = a.level || 0),
      (this.title = a.title || "guest"))
    : ((this.kills = this.deaths = this.damage = this.level = 0), (this.title = "guest"));
  this.leaderboardRow = new PIXI.Sprite(App.CombinedTextures.leaderboard_row);
  this.leaderboardRow.anchor.x = 0.5;
  this.leaderboardRow.anchor.y = 0.5;
  this.leaderboardRow.x = 150;
  this.leaderboardRow.y = 8;
  this.leaderboardRow.scale.x = 2.8;
  this.nameField = new PIXI.Text(this.name, {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsField = new PIXI.Text(this.kills.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsField = new PIXI.Text(this.deaths.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioField = new PIXI.Text(this.ratio.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text(this.level.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.tint = Team.HexColors[a.team];
  this.nameField.resolution = 1.5 * App.DevicePixelRatio;
  this.nameField.anchor.x = 0.5;
  this.killsField.anchor.x = 0.5;
  this.deathsField.anchor.x = 0.5;
  this.ratioField.anchor.x = 0.5;
  this.skillField.anchor.x = 0.5;
  this.nameField.x = 10;
  this.killsField.x = 145;
  this.deathsField.x = 230;
  this.ratioField.x = 320;
  this.skillField.x = 410;
  this.addChild(this.leaderboardRow);
  this.addChild(this.nameField);
  this.addChild(this.killsField);
  this.addChild(this.deathsField);
  this.addChild(this.ratioField);
  this.addChild(this.skillField);
  this.skillIndex = Math.max(Math.floor((this.level / 160) * 10) + 1);
  this.skillIndex = 16 < this.skillIndex ? 16 : this.skillIndex;
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + this.skillIndex]);
  this.skillTag.x = -130;
  this.skillTag.y = -10;
  this.skillTag.scale.x = this.skillTag.scale.y = 0.5;
  this.addChild(this.skillTag);
  this.updateRatio();
}
DMLeaderboardRow.prototype = Object.create(PIXI.Sprite.prototype);
DMLeaderboardRow.prototype.setName = function (a) {
  this.name = a;
  this.nameField.text = this.name;
};
DMLeaderboardRow.prototype.setKills = function (a) {
  this.kills = a;
  this.killsField.text = this.kills.toString();
  this.updateRatio();
};
DMLeaderboardRow.prototype.setDeaths = function (a) {
  this.deaths = a;
  this.deathsField.text = this.deaths.toString();
  this.updateRatio();
};
DMLeaderboardRow.prototype.setSkill = function (a) {
  this.level = a;
  this.skillField.text = this.level.toString();
};
DMLeaderboardRow.prototype.updateRatio = function () {
  this.ratio = this.kills / (0 < this.deaths ? this.deaths : 1);
  this.ratioField.text = this.ratio.toPrecision(2).toString();
};
DMLeaderboardRow.prototype.getKills = function () {
  return this.kills;
};
DMLeaderboardRow.prototype.getDeaths = function () {
  return this.deaths;
};
DMLeaderboardRow.prototype.getDamage = function () {
  return this.damage;
};
DMLeaderboardRow.prototype.getRatio = function () {
  return this.ratio;
};
DMLeaderboardRow.prototype.getskill = function () {
  return this.level;
};
DMLeaderboardRow.prototype.mark = function () {
  this.background.parent || this.addChildAt(this.background, 0);
};
DMLeaderboardRow.prototype.unmark = function () {
  this.background.parent && this.removeChild(this.background);
};
function DMRowLabel() {
  PIXI.Container.call(this);
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.8);
  this.background.drawRoundedRect(0, 0, 300, 130, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.nameFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.descTitle = new PIXI.Text(
    "Left-click to view full profile.\nRight-click to display additional options.",
    {
      fontName: "Arial",
      fontSize: 14,
      fill: 13412864,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 280,
    }
  );
  this.nameField = new PIXI.Text("Name:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField = new PIXI.Text("Title:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text("Level & skill:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanField = new PIXI.Text("Clan:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.addChild(this.nameFieldTitle);
  this.addChild(this.titleFieldTitle);
  this.addChild(this.skillFieldTitle);
  this.addChild(this.clanFieldTitle);
  this.addChild(this.descTitle);
  this.addChild(this.nameField);
  this.addChild(this.titleField);
  this.addChild(this.skillField);
  this.addChild(this.clanField);
  this.nameField.x = 70;
  this.titleField.x = 70;
  this.skillField.x = 70;
  this.clanField.x = 70;
  this.descTitle.x = 10;
  this.nameField.y = 5;
  this.titleField.y = 25;
  this.skillField.y = 45;
  this.clanField.y = 65;
  this.descTitle.y = 85;
  this.nameFieldTitle.x = 125;
  this.titleFieldTitle.x = 125;
  this.skillFieldTitle.x = 165;
  this.clanFieldTitle.x = 125;
  this.nameFieldTitle.y = 5;
  this.titleFieldTitle.y = 25;
  this.skillFieldTitle.y = 45;
  this.clanFieldTitle.y = 65;
  this.skillTag = null;
}
DMRowLabel.prototype = Object.create(PIXI.Container.prototype);
DMRowLabel.prototype.constructor = DMRowLabel;
DMRowLabel.prototype.update = function (a, b, c, d, e, f) {
  this.nameFieldTitle.text = a;
  this.titleFieldTitle.text = b;
  this.skillFieldTitle.text = c + " - " + Game.MapSkillToTitle(d);
  this.clanFieldTitle.text = f;
  null !== this.skillTag && this.skillTag.parent && this.removeChild(this.skillTag);
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + e]);
  this.addChild(this.skillTag);
};
var tdm_leaderboard = {};
function LeaderboardTDM() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._width = App.ClientWidth - 300;
  this._height = 600;
  this.invalidated = !0;
  this.dropdown = new PlayerDropdown();
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.3);
  this.background.drawRoundedRect(0, 0, 1010, 300, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.alphaTitleField = new PIXI.Text("Alpha", {
    fontName: "Arial",
    fontSize: 22,
    fill: 16711680,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoTitleField = new PIXI.Text("Bravo", {
    fontName: "Arial",
    fontSize: 22,
    fill: 255,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaKillsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaDeathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaRatioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaSkillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoKillsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoDeathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoRatioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoSkillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaKillsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaDeathsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaRatioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaSkillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoKillsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoRatioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoSkillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaTitleField.tint = 15597568;
  this.bravoTitleField.tint = 238;
  this.alphaTitleField.x = 20;
  this.alphaTitleField.y = 20;
  this.bravoTitleField.x = 520;
  this.bravoTitleField.y = 20;
  this.alphaKillsTitleField.x = 210;
  this.alphaKillsTitleField.y = 66;
  this.alphaKillsTitleField.tint = 13421568;
  this.alphaDeathsTitleField.x = 280;
  this.alphaDeathsTitleField.y = 66;
  this.alphaDeathsTitleField.tint = 13421568;
  this.alphaRatioTitleField.x = 370;
  this.alphaRatioTitleField.y = 66;
  this.alphaRatioTitleField.tint = 13421568;
  this.alphaSkillTitleField.x = 450;
  this.alphaSkillTitleField.y = 66;
  this.alphaSkillTitleField.tint = 13421568;
  this.bravoKillsTitleField.x = 715;
  this.bravoKillsTitleField.y = 66;
  this.bravoKillsTitleField.tint = 13421568;
  this.bravoDeathsTitleField.x = 785;
  this.bravoDeathsTitleField.y = 66;
  this.bravoDeathsTitleField.tint = 13421568;
  this.bravoRatioTitleField.x = 875;
  this.bravoRatioTitleField.y = 66;
  this.bravoRatioTitleField.tint = 13421568;
  this.bravoSkillTitleField.x = 955;
  this.bravoSkillTitleField.y = 66;
  this.bravoSkillTitleField.tint = 13421568;
  this.alphaFlag = new PIXI.Sprite(App.CombinedTextures.tdm_alpha);
  this.alphaFlag.scale.x = this.alphaFlag.scale.y = 0.4;
  this.bravoFlag = new PIXI.Sprite(App.CombinedTextures.tdm_bravo);
  this.bravoFlag.scale.x = this.bravoFlag.scale.y = 0.4;
  this.alphaPoints = new PIXI.Text("0 x", {
    fontName: "Arial",
    fontSize: 22,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaPoints.x = 42;
  this.alphaPoints.y = 50;
  this.alphaFlag.x = this.alphaPoints.x + 40;
  this.alphaFlag.y = this.alphaPoints.y - 5;
  this.bravoPoints = new PIXI.Text("0 x", {
    fontName: "Arial",
    fontSize: 22,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoPoints.x = 545;
  this.bravoPoints.y = 50;
  this.bravoFlag.x = this.bravoPoints.x + 40;
  this.bravoFlag.y = this.bravoPoints.y - 5;
  this.bravoPointsTotal = this.alphaPointsTotal = 0;
  this.addChild(this.alphaPoints);
  this.addChild(this.bravoPoints);
  this.addChild(this.alphaFlag);
  this.addChild(this.bravoFlag);
  this.addChild(this.alphaTitleField);
  this.addChild(this.bravoTitleField);
  this.addChild(this.alphaKillsTitleField);
  this.addChild(this.alphaDeathsTitleField);
  this.addChild(this.alphaRatioTitleField);
  this.addChild(this.alphaSkillTitleField);
  this.addChild(this.bravoKillsTitleField);
  this.addChild(this.bravoDeathsTitleField);
  this.addChild(this.bravoRatioTitleField);
  this.addChild(this.bravoSkillTitleField);
  this.table = new PIXI.Container();
  this.addChild(this.table);
  this.rowsAlpha = new OrderedContainer();
  this.rowsBravo = new OrderedContainer();
  this.rowLabel = new TDMRowLabel();
}
LeaderboardTDM.prototype = Object.create(PIXI.Container.prototype);
LeaderboardTDM.prototype.constructor = LeaderboardTDM;
LeaderboardTDM.TEAM_ALPHA = 0;
LeaderboardTDM.TEAM_BRAVO = 1;
LeaderboardTDM.prototype.validate = function () {
  this.invalidated &&
    (this.rowsAlpha.sortMethodMultiple(-1, "getDeaths", 1, "getKills"),
    this.rowsBravo.sortMethodMultiple(-1, "getDeaths", 1, "getKills"),
    this.update(),
    (this.invalidated = !1));
};
LeaderboardTDM.prototype.reset = function () {
  this.rowsAlpha.iterate(function (a, b) {
    b.setDeaths(0);
    b.setKills(0);
    b.setSkill(0);
    return !0;
  });
  this.rowsBravo.iterate(function (a, b) {
    b.setDeaths(0);
    b.setKills(0);
    b.setSkill(0);
    return !0;
  });
  this.bravoPointsTotal = this.alphaPointsTotal = 0;
  this.alphaPoints.text = "0 x";
  this.bravoPoints.text = "0 x";
};
LeaderboardTDM.prototype.getTeamRows = function (a) {
  switch (parseInt(a.team, 10)) {
    case LeaderboardTDM.TEAM_ALPHA:
      return this.rowsAlpha;
    case LeaderboardTDM.TEAM_BRAVO:
      return this.rowsBravo;
  }
};
LeaderboardTDM.prototype.hide = function () {
  this.hideDropdown();
  this.hideClientInfo();
  for (var a = 0, b = this.rowsAlpha.getSize(); a < b; a++) {
    var c = this.rowsAlpha.getIndex(a);
    c.unmark();
  }
  a = 0;
  for (b = this.rowsBravo.getSize(); a < b; a++) (c = this.rowsBravo.getIndex(a)), c.unmark();
};
LeaderboardTDM.prototype.addClient = function (a) {
  var b = this.getTeamRows(a);
  if (b.getById(a.sid)) this.updateClient(a, !0);
  else {
    var c = new LeaderboardTDMRow(a);
    c.on("mouseover", (d) => {
      this.displayClientInfo(d);
      c.mark();
      AudioEffects.ButtonHover.audio.play();
    });
    c.on("mouseout", () => {
      this.hideClientInfo();
      c.unmark();
    });
    c.on("mousemove", (d) => this.moveClientInfo(d));
    c.on("rightdown", (d) => this.displayDropdown(d));
    c.on("mousedown", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    c.on("touchstart", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    b.add(c, a.sid);
    this.table.addChild(c);
    this.updateClient(a, !0);
    this.visible
      ? (b.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
      : (this.invalidated = !0);
  }
};
LeaderboardTDM.prototype.displayDropdown = function (a) {
  const b = a.target;
  "guest" !== App.Credential.accounttype &&
    b.name !== App.Credential.username &&
    (this.dropdown.target === b && this.dropdown.parent
      ? this.hideDropdown()
      : ((this.dropdown.target = b),
        this.addChild(this.dropdown),
        this.dropdown.show(),
        (this.dropdown.x = a.data.global.x - this.x),
        (this.dropdown.y = a.data.global.y - this.y)));
};
LeaderboardTDM.prototype.hideDropdown = function () {
  this.dropdown.parent && this.removeChild(this.dropdown);
};
LeaderboardTDM.prototype.removeClient = function (a) {
  var b = this.getTeamRows(a);
  if (b) {
    var c = b.getById(a.sid);
    c && this.table.removeChild(c);
    b.getById(a.sid) && b.remove(a.sid);
    this.update();
  }
};
LeaderboardTDM.prototype.displayClientInfo = function (a) {
  this.rowLabel.update(
    a.target.name,
    a.target.title,
    a.target.level,
    a.target.skill,
    a.target.skillIndex,
    a.target.clanName
  );
  this.rowLabel.parent || this.addChild(this.rowLabel);
};
LeaderboardTDM.prototype.hideClientInfo = function () {
  this.rowLabel.parent && this.removeChild(this.rowLabel);
};
LeaderboardTDM.prototype.moveClientInfo = function (a) {
  this.rowLabel.parent &&
    ((this.rowLabel.x = a.data.global.x - this.x), (this.rowLabel.y = a.data.global.y - this.y));
};
LeaderboardTDM.prototype.updateTeamPoints = function (a) {
  this.alphaPointsTotal = a[0];
  this.bravoPointsTotal = a[1];
  this.alphaPoints.text = this.alphaPointsTotal + " x";
  this.bravoPoints.text = this.bravoPointsTotal + " x";
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardTDM.prototype.updateClient = function (a, b) {
  var c = this.getTeamRows(a),
    d = c.getIndexById(a.sid);
  if ((d = c.getIndex(d))) {
    if (void 0 !== a.kills && (d.setKills(d.getKills() + a.kills), !b && 0 < a.kills))
      switch (a.team) {
        case LeaderboardTDM.TEAM_ALPHA:
          this.alphaPointsTotal++;
          this.alphaPoints.text = this.alphaPointsTotal + " x";
          break;
        case LeaderboardTDM.TEAM_BRAVO:
          this.bravoPointsTotal++, (this.bravoPoints.text = this.bravoPointsTotal + " x");
      }
    void 0 !== a.deaths && d.setDeaths(d.getDeaths() + a.deaths);
    void 0 !== a.damage && d.setDamage(d.getDamage() + a.damage);
    void 0 !== a.level && d.setSkill(a.level);
  }
  this.visible
    ? (c.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
    : (this.invalidated = !0);
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardTDM.prototype.update = function () {
  for (var a = 0, b = this.rowsAlpha.getSize(); a < b; a++) {
    var c = this.rowsAlpha.getIndex(a);
    c.x = 100;
    c.y = 90 + 28 * a;
  }
  a = 0;
  for (b = this.rowsBravo.getSize(); a < b; a++)
    (c = this.rowsBravo.getIndex(a)), (c.x = 605), (c.y = 90 + 28 * a);
};
LeaderboardTDM.prototype.getWidth = function () {
  return this._width;
};
LeaderboardTDM.prototype.getHeight = function () {
  return this._height;
};
function LeaderboardTDMRow(a) {
  PIXI.Sprite.call(this);
  this.sid = a.sid;
  this.name = a.name;
  this.local = a.local || !1;
  this.title = a.title;
  this.clanId = a.clan_id;
  this.clanName = a.clan_name;
  this.skill = a.skill;
  this.ratio = 0;
  this.interactive = !0;
  this.background = new PIXI.Graphics();
  this.background.beginFill(16777215, 0.05);
  this.background.drawRect(-90, -4, 480, 28, 4);
  this.background.beginFill(16777215, 0.2);
  this.background.drawRect(-88, -2, 476, 24, 4);
  this.background.endFill();
  this.hitArea = new PIXI.Rectangle(-90, 0, 480, 20);
  a
    ? (a.record
        ? ((this.kills = a.record.kills || 0), (this.deaths = a.record.deaths || 0))
        : (this.deaths = this.kills = 0),
      (this.damage = a.damage || 0),
      (this.level = a.level || 0),
      (this.title = a.title || "guest"))
    : ((this.kills = this.deaths = this.damage = this.level = 0), (this.title = "guest"));
  this.leaderboardRow = new PIXI.Sprite(App.CombinedTextures.leaderboard_row);
  this.leaderboardRow.anchor.x = 0.5;
  this.leaderboardRow.anchor.y = 0.5;
  this.leaderboardRow.x = 150;
  this.leaderboardRow.y = 8;
  this.leaderboardRow.scale.x = 2.8;
  this.nameField = new PIXI.Text(this.name, {
    fontName: "Arial",
    fontSize: 16,
    fill: this.local ? 15658496 : 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsField = new PIXI.Text(this.kills.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsField = new PIXI.Text(this.deaths.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioField = new PIXI.Text(this.ratio.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text(this.level.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.resolution = 1.5 * App.DevicePixelRatio;
  this.level = a.level;
  this.skillIndex = Math.max(Math.floor((this.level / 160) * 10) + 1);
  this.skillIndex = 16 < this.skillIndex ? 16 : this.skillIndex;
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + this.skillIndex]);
  this.skillTag.x = -100;
  this.skillTag.y = -10;
  this.skillTag.scale.x = this.skillTag.scale.y = 0.5;
  this.addChild(this.skillTag);
  this.nameField.anchor.x = 0;
  this.killsField.anchor.x = 0.5;
  this.deathsField.anchor.x = 0.5;
  this.ratioField.anchor.x = 0.5;
  this.skillField.anchor.x = 0.5;
  this.nameField.x = -65;
  this.killsField.x = 125;
  this.deathsField.x = 210;
  this.ratioField.x = 290;
  this.skillField.x = 370;
  this.addChild(this.leaderboardRow);
  this.addChild(this.nameField);
  this.addChild(this.killsField);
  this.addChild(this.deathsField);
  this.addChild(this.ratioField);
  this.addChild(this.skillField);
  this.updateRatio();
}
LeaderboardTDMRow.prototype = Object.create(PIXI.Sprite.prototype);
LeaderboardTDMRow.prototype.setName = function (a) {
  this.name = a;
  this.nameField.text = this.name;
};
LeaderboardTDMRow.prototype.setKills = function (a) {
  this.kills = a;
  this.killsField.text = this.kills.toString();
  this.updateRatio();
};
LeaderboardTDMRow.prototype.setDeaths = function (a) {
  this.deaths = a;
  this.deathsField.text = this.deaths.toString();
  this.updateRatio();
};
LeaderboardTDMRow.prototype.setDamage = function (a) {
  this.damage = a;
};
LeaderboardTDMRow.prototype.setSkill = function (a) {
  this.level = a;
  this.skillField.text = this.level.toString();
};
LeaderboardTDMRow.prototype.updateRatio = function () {
  this.ratio = this.kills / (0 < this.deaths ? this.deaths : 1);
  this.ratioField.text = this.ratio.toPrecision(2).toString();
};
LeaderboardTDMRow.prototype.getKills = function () {
  return this.kills;
};
LeaderboardTDMRow.prototype.getDeaths = function () {
  return this.deaths;
};
LeaderboardTDMRow.prototype.getDamage = function () {
  return this.damage;
};
LeaderboardTDMRow.prototype.getRatio = function () {
  return this.ratio;
};
LeaderboardTDMRow.prototype.getSkill = function () {
  return this.level;
};
LeaderboardTDMRow.prototype.mark = function () {
  this.background.parent || this.addChildAt(this.background, 0);
};
LeaderboardTDMRow.prototype.unmark = function () {
  this.background.parent && this.removeChild(this.background);
};
function TDMRowLabel() {
  PIXI.Container.call(this);
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.7);
  this.background.drawRoundedRect(0, 0, 300, 130, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.nameFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.descTitle = new PIXI.Text(
    "Left-click to view full profile.\nRight-click to display additional options.",
    {
      fontName: "Arial",
      fontSize: 14,
      fill: 13412864,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 280,
    }
  );
  this.nameField = new PIXI.Text("Name:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField = new PIXI.Text("Title:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text("Level & skill:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanField = new PIXI.Text("Clan:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.tint = 13421568;
  this.titleField.tint = 13421568;
  this.skillField.tint = 13421568;
  this.clanField.tint = 13421568;
  this.addChild(this.nameFieldTitle);
  this.addChild(this.titleFieldTitle);
  this.addChild(this.skillFieldTitle);
  this.addChild(this.clanFieldTitle);
  this.addChild(this.descTitle);
  this.addChild(this.nameField);
  this.addChild(this.titleField);
  this.addChild(this.skillField);
  this.addChild(this.clanField);
  this.nameField.x = 70;
  this.titleField.x = 70;
  this.skillField.x = 70;
  this.clanField.x = 70;
  this.descTitle.x = 10;
  this.nameField.y = 5;
  this.titleField.y = 25;
  this.skillField.y = 45;
  this.clanField.y = 65;
  this.descTitle.y = 85;
  this.nameFieldTitle.x = 125;
  this.titleFieldTitle.x = 125;
  this.skillFieldTitle.x = 165;
  this.clanFieldTitle.x = 125;
  this.nameFieldTitle.y = 5;
  this.titleFieldTitle.y = 25;
  this.skillFieldTitle.y = 45;
  this.clanFieldTitle.y = 65;
  this.skillTag = null;
}
TDMRowLabel.prototype = Object.create(PIXI.Container.prototype);
TDMRowLabel.prototype.constructor = TDMRowLabel;
TDMRowLabel.prototype.update = function (a, b, c, d, e, f) {
  this.nameFieldTitle.text = a;
  this.titleFieldTitle.text = b;
  this.skillFieldTitle.text = c + " - " + Game.MapSkillToTitle(d);
  this.clanFieldTitle.text = f;
  null !== this.skillTag && this.skillTag.parent && this.removeChild(this.skillTag);
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + e]);
  this.addChild(this.skillTag);
};
var ctf_leaderboard = {};
function LeaderboardCTF() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._width = App.ClientWidth - 300;
  this._height = 600;
  this.invalidated = !0;
  this.dropdown = new PlayerDropdown();
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.3);
  this.background.drawRoundedRect(0, 0, 1010, 300, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.alphaTitleField = new PIXI.Text("Alpha", {
    fontName: "Arial",
    fontSize: 22,
    fill: 16711680,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoTitleField = new PIXI.Text("Bravo", {
    fontName: "Arial",
    fontSize: 22,
    fill: 255,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaKillsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaDeathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaRatioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaPointsTitleField = new PIXI.Text("Points", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaSkillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoKillsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoDeathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoRatioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoPointsTitleField = new PIXI.Text("Points", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoSkillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaKillsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaDeathsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaRatioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaPointsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaSkillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoKillsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoRatioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoPointsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoSkillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaTitleField.x = 20;
  this.alphaTitleField.y = 20;
  this.bravoTitleField.x = 520;
  this.bravoTitleField.y = 20;
  this.alphaKillsTitleField.x = 210;
  this.alphaKillsTitleField.y = 66;
  this.alphaDeathsTitleField.x = 260;
  this.alphaDeathsTitleField.y = 66;
  this.alphaRatioTitleField.x = 330;
  this.alphaRatioTitleField.y = 66;
  this.alphaPointsTitleField.x = 390;
  this.alphaPointsTitleField.y = 66;
  this.alphaSkillTitleField.x = 450;
  this.alphaSkillTitleField.y = 66;
  this.bravoKillsTitleField.x = 713;
  this.bravoKillsTitleField.y = 66;
  this.bravoDeathsTitleField.x = 767;
  this.bravoDeathsTitleField.y = 66;
  this.bravoRatioTitleField.x = 835;
  this.bravoRatioTitleField.y = 66;
  this.bravoPointsTitleField.x = 895;
  this.bravoPointsTitleField.y = 66;
  this.bravoSkillTitleField.x = 955;
  this.bravoSkillTitleField.y = 66;
  this.alphaFlag = new PIXI.Sprite(App.CombinedTextures.flag_alpha);
  this.alphaFlag.scale.x = this.alphaFlag.scale.y = 0.4;
  this.bravoFlag = new PIXI.Sprite(App.CombinedTextures.flag_bravo);
  this.bravoFlag.scale.x = this.bravoFlag.scale.y = 0.4;
  this.alphaPoints = new PIXI.Text("0 x", {
    fontName: "Arial",
    fontSize: 22,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaPoints.x = 42;
  this.alphaPoints.y = 50;
  this.alphaFlag.x = this.alphaPoints.x + 40;
  this.alphaFlag.y = this.alphaPoints.y - 5;
  this.bravoPoints = new PIXI.Text("0 x", {
    fontName: "Arial",
    fontSize: 22,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoPoints.x = 545;
  this.bravoPoints.y = 50;
  this.bravoFlag.x = this.bravoPoints.x + 40;
  this.bravoFlag.y = this.bravoPoints.y - 5;
  this.bravoPointsTotal = this.alphaPointsTotal = 0;
  this.addChild(this.alphaPoints);
  this.addChild(this.bravoPoints);
  this.addChild(this.alphaFlag);
  this.addChild(this.bravoFlag);
  this.addChild(this.alphaTitleField);
  this.addChild(this.bravoTitleField);
  this.addChild(this.alphaKillsTitleField);
  this.addChild(this.alphaDeathsTitleField);
  this.addChild(this.alphaRatioTitleField);
  this.addChild(this.alphaPointsTitleField);
  this.addChild(this.alphaSkillTitleField);
  this.addChild(this.bravoKillsTitleField);
  this.addChild(this.bravoDeathsTitleField);
  this.addChild(this.bravoRatioTitleField);
  this.addChild(this.bravoPointsTitleField);
  this.addChild(this.bravoSkillTitleField);
  this.table = new PIXI.Container();
  this.addChild(this.table);
  this.rowsAlpha = new OrderedContainer();
  this.rowsBravo = new OrderedContainer();
  this.rowLabel = new CTFRowLabel();
}
LeaderboardCTF.prototype = Object.create(PIXI.Container.prototype);
LeaderboardCTF.prototype.constructor = LeaderboardCTF;
LeaderboardCTF.TEAM_ALPHA = 0;
LeaderboardCTF.TEAM_BRAVO = 1;
LeaderboardCTF.prototype.validate = function () {
  this.invalidated &&
    (this.rowsAlpha.sortMethodMultiple(-1, "getDeaths", 1, "getKills", 1, "getPoints"),
    this.rowsBravo.sortMethodMultiple(-1, "getDeaths", 1, "getKills", 1, "getPoints"),
    this.update(),
    (this.invalidated = !1));
};
LeaderboardCTF.prototype.reset = function () {
  this.rowsAlpha.iterate(function (a, b) {
    b.setDeaths(0);
    b.setPoints(0);
    b.setKills(0);
    b.setSkill(0);
    return !0;
  });
  this.rowsBravo.iterate(function (a, b) {
    b.setDeaths(0);
    b.setPoints(0);
    b.setKills(0);
    b.setSkill(0);
    return !0;
  });
  this.bravoPointsTotal = this.alphaPointsTotal = 0;
  this.alphaPoints.text = "0 x";
  this.bravoPoints.text = "0 x";
};
LeaderboardCTF.prototype.hide = function () {
  this.hideDropdown();
  this.hideClientInfo();
  for (var a = 0, b = this.rowsAlpha.getSize(); a < b; a++) {
    var c = this.rowsAlpha.getIndex(a);
    c.unmark();
  }
  a = 0;
  for (b = this.rowsBravo.getSize(); a < b; a++) (c = this.rowsBravo.getIndex(a)), c.unmark();
};
LeaderboardCTF.prototype.getTeamRows = function (a) {
  switch (parseInt(a.team, 10)) {
    case LeaderboardCTF.TEAM_ALPHA:
      return this.rowsAlpha;
    case LeaderboardCTF.TEAM_BRAVO:
      return this.rowsBravo;
  }
};
LeaderboardCTF.prototype.addClient = function (a) {
  var b = this.getTeamRows(a);
  if (b.getById(a.sid)) this.updateClient(a, !0);
  else {
    var c = new LeaderboardRow(a);
    c.on("mouseover", (d) => {
      this.displayClientInfo(d);
      c.mark();
      AudioEffects.ButtonHover.audio.play();
    });
    c.on("mouseout", () => {
      this.hideClientInfo();
      c.unmark();
    });
    c.on("mousemove", (d) => this.moveClientInfo(d));
    c.on("rightdown", (d) => this.displayDropdown(d));
    c.on("mousedown", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    c.on("touchstart", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    b.add(c, a.sid);
    this.table.addChild(c);
    this.updateClient(a, !0);
    this.visible
      ? (b.sortMethodMultiple(-1, "getDeaths", 1, "getKills", 1, "getPoints"), this.update())
      : (this.invalidated = !0);
  }
};
LeaderboardCTF.prototype.displayDropdown = function (a) {
  const b = a.target;
  "guest" !== App.Credential.accounttype &&
    b.name !== App.Credential.username &&
    (this.dropdown.target === b && this.dropdown.parent
      ? this.hideDropdown()
      : ((this.dropdown.target = b),
        this.addChild(this.dropdown),
        this.dropdown.show(),
        (this.dropdown.x = a.data.global.x - this.x),
        (this.dropdown.y = a.data.global.y - this.y)));
};
LeaderboardCTF.prototype.hideDropdown = function () {
  this.dropdown.parent && this.removeChild(this.dropdown);
};
LeaderboardCTF.prototype.removeClient = function (a) {
  var b = this.getTeamRows(a);
  if (b) {
    var c = b.getById(a.sid);
    c && this.table.removeChild(c);
    b.getById(a.sid) && b.remove(a.sid);
    this.update();
  }
};
LeaderboardCTF.prototype.displayClientInfo = function (a) {
  this.rowLabel.update(
    a.target.name,
    a.target.title,
    a.target.level,
    a.target.skill,
    a.target.skillIndex,
    a.target.clanName
  );
  this.rowLabel.parent || this.addChild(this.rowLabel);
};
LeaderboardCTF.prototype.hideClientInfo = function () {
  this.rowLabel.parent && this.removeChild(this.rowLabel);
};
LeaderboardCTF.prototype.moveClientInfo = function (a) {
  this.rowLabel.parent &&
    ((this.rowLabel.x = a.data.global.x - this.x), (this.rowLabel.y = a.data.global.y - this.y));
};
LeaderboardCTF.prototype.updateTeamPoints = function (a) {
  this.alphaPointsTotal = a[0];
  this.bravoPointsTotal = a[1];
  this.alphaPoints.text = this.alphaPointsTotal + " x";
  this.bravoPoints.text = this.bravoPointsTotal + " x";
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardCTF.prototype.updateClient = function (a, b) {
  var c = this.getTeamRows(a),
    d = c.getIndexById(a.sid);
  if ((d = c.getIndex(d))) {
    void 0 !== a.kills && d.setKills(d.getKills() + a.kills);
    void 0 !== a.deaths && d.setDeaths(d.getDeaths() + a.deaths);
    if (void 0 !== a.points && (d.setPoints(d.getPoints() + a.points), !b))
      switch (a.team) {
        case LeaderboardCTF.TEAM_ALPHA:
          this.alphaPointsTotal++;
          this.alphaPoints.text = this.alphaPointsTotal + " x";
          break;
        case LeaderboardCTF.TEAM_BRAVO:
          this.bravoPointsTotal++, (this.bravoPoints.text = this.bravoPointsTotal + " x");
      }
    void 0 !== a.damage && d.setDamage(d.getDamage() + a.damage);
    void 0 !== a.level && d.setSkill(a.level);
  }
  this.visible
    ? (c.sortMethodMultiple(-1, "getDeaths", 1, "getKills", 1, "getPoints"), this.update())
    : (this.invalidated = !0);
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardCTF.prototype.update = function () {
  for (var a = 0, b = this.rowsAlpha.getSize(); a < b; a++) {
    var c = this.rowsAlpha.getIndex(a);
    c.x = 100;
    c.y = 90 + 28 * a;
  }
  a = 0;
  for (b = this.rowsBravo.getSize(); a < b; a++)
    (c = this.rowsBravo.getIndex(a)), (c.x = 605), (c.y = 90 + 28 * a);
};
LeaderboardCTF.prototype.getWidth = function () {
  return this._width;
};
LeaderboardCTF.prototype.getHeight = function () {
  return this._height;
};
function LeaderboardRow(a) {
  PIXI.Sprite.call(this);
  this.sid = a.sid;
  this.name = a.name;
  this.local = a.local || !1;
  this.title = a.title;
  this.clanId = a.clan_id;
  this.clanName = a.clan_name;
  this.skill = a.skill;
  this.ratio = 0;
  this.interactive = !0;
  this.background = new PIXI.Graphics();
  this.background.beginFill(16777215, 0.05);
  this.background.drawRect(-94, -4, 488, 28, 4);
  this.background.beginFill(16777215, 0.2);
  this.background.drawRect(-92, -2, 484, 24, 4);
  this.background.endFill();
  this.hitArea = new PIXI.Rectangle(-90, 0, 480, 20);
  a
    ? (a.record
        ? ((this.kills = a.record.kills || 0),
          (this.deaths = a.record.deaths || 0),
          (this.points = a.record.points || 0))
        : (this.points = this.deaths = this.kills = 0),
      (this.damage = a.damage || 0),
      (this.level = a.level || 0),
      (this.title = a.title || "guest"))
    : ((this.kills = this.deaths = this.points = this.damage = this.level = 0),
      (this.title = "guest"));
  this.leaderboardRow = new PIXI.Sprite(App.CombinedTextures.leaderboard_row);
  this.leaderboardRow.anchor.x = 0.5;
  this.leaderboardRow.anchor.y = 0.5;
  this.leaderboardRow.x = 150;
  this.leaderboardRow.y = 8;
  this.leaderboardRow.scale.x = 2.8;
  this.nameField = new PIXI.Text(this.name, {
    fontName: "Arial",
    fontSize: 16,
    fill: this.local ? 15658496 : 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsField = new PIXI.Text(this.kills.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsField = new PIXI.Text(this.deaths.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioField = new PIXI.Text(this.ratio.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.pointsField = new PIXI.Text(this.points.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text(this.level.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.resolution = 1.5 * App.DevicePixelRatio;
  this.level = a.level;
  this.skillIndex = Math.max(Math.floor((this.level / 160) * 10) + 1);
  this.skillIndex = 16 < this.skillIndex ? 16 : this.skillIndex;
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + this.skillIndex]);
  this.skillTag.x = -100;
  this.skillTag.y = -10;
  this.skillTag.scale.x = this.skillTag.scale.y = 0.5;
  this.addChild(this.skillTag);
  this.nameField.anchor.x = 0;
  this.killsField.anchor.x = 0.5;
  this.deathsField.anchor.x = 0.5;
  this.ratioField.anchor.x = 0.5;
  this.pointsField.anchor.x = 0.5;
  this.skillField.anchor.x = 0.5;
  this.nameField.x = -65;
  this.killsField.x = 125;
  this.deathsField.x = 190;
  this.ratioField.x = 250;
  this.pointsField.x = 310;
  this.skillField.x = 370;
  this.addChild(this.leaderboardRow);
  this.addChild(this.nameField);
  this.addChild(this.killsField);
  this.addChild(this.deathsField);
  this.addChild(this.ratioField);
  this.addChild(this.pointsField);
  this.addChild(this.skillField);
  this.updateRatio();
}
LeaderboardRow.prototype = Object.create(PIXI.Sprite.prototype);
LeaderboardRow.prototype.setName = function (a) {
  this.name = a;
  this.nameField.text = this.name;
};
LeaderboardRow.prototype.setKills = function (a) {
  this.kills = a;
  this.killsField.text = this.kills.toString();
  this.updateRatio();
};
LeaderboardRow.prototype.setDeaths = function (a) {
  this.deaths = a;
  this.deathsField.text = this.deaths.toString();
  this.updateRatio();
};
LeaderboardRow.prototype.setPoints = function (a) {
  this.points = a;
  this.pointsField.text = this.points.toString();
};
LeaderboardRow.prototype.setDamage = function (a) {
  this.damage = a;
};
LeaderboardRow.prototype.setSkill = function (a) {
  this.level = a;
  this.skillField.text = this.level.toString();
};
LeaderboardRow.prototype.updateRatio = function () {
  this.ratio = this.kills / (0 < this.deaths ? this.deaths : 1);
  this.ratioField.text = this.ratio.toPrecision(2).toString();
};
LeaderboardRow.prototype.getKills = function () {
  return this.kills;
};
LeaderboardRow.prototype.getDeaths = function () {
  return this.deaths;
};
LeaderboardRow.prototype.getPoints = function () {
  return this.points;
};
LeaderboardRow.prototype.getDamage = function () {
  return this.damage;
};
LeaderboardRow.prototype.getRatio = function () {
  return this.ratio;
};
LeaderboardRow.prototype.getSkill = function () {
  return this.level;
};
LeaderboardRow.prototype.mark = function () {
  this.background.parent || this.addChildAt(this.background, 0);
};
LeaderboardRow.prototype.unmark = function () {
  this.background.parent && this.removeChild(this.background);
};
function CTFRowLabel() {
  PIXI.Container.call(this);
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.7);
  this.background.drawRoundedRect(0, 0, 300, 130, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.nameFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.descTitle = new PIXI.Text(
    "Left-click to view full profile.\nRight-click to display additional options.",
    {
      fontName: "Arial",
      fontSize: 14,
      fill: 13412864,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 280,
    }
  );
  this.nameField = new PIXI.Text("Name:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField = new PIXI.Text("Title:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text("Level & skill:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanField = new PIXI.Text("Clan:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.addChild(this.nameFieldTitle);
  this.addChild(this.titleFieldTitle);
  this.addChild(this.skillFieldTitle);
  this.addChild(this.clanFieldTitle);
  this.addChild(this.descTitle);
  this.addChild(this.nameField);
  this.addChild(this.titleField);
  this.addChild(this.skillField);
  this.addChild(this.clanField);
  this.nameField.x = 70;
  this.titleField.x = 70;
  this.skillField.x = 70;
  this.clanField.x = 70;
  this.descTitle.x = 10;
  this.nameField.y = 5;
  this.titleField.y = 25;
  this.skillField.y = 45;
  this.clanField.y = 65;
  this.descTitle.y = 85;
  this.nameFieldTitle.x = 125;
  this.titleFieldTitle.x = 125;
  this.skillFieldTitle.x = 165;
  this.clanFieldTitle.x = 125;
  this.nameFieldTitle.y = 5;
  this.titleFieldTitle.y = 25;
  this.skillFieldTitle.y = 45;
  this.clanFieldTitle.y = 65;
  this.skillTag = null;
}
CTFRowLabel.prototype = Object.create(PIXI.Container.prototype);
CTFRowLabel.prototype.constructor = CTFRowLabel;
CTFRowLabel.prototype.update = function (a, b, c, d, e, f) {
  this.nameFieldTitle.text = a;
  this.titleFieldTitle.text = b;
  this.skillFieldTitle.text = c + " - " + Game.MapSkillToTitle(d);
  this.clanFieldTitle.text = f;
  null !== this.skillTag && this.skillTag.parent && this.removeChild(this.skillTag);
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + e]);
  this.addChild(this.skillTag);
};
var db_leaderboard = {};
function LeaderboardDB() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._width = App.ClientWidth - 300;
  this._height = 600;
  this.invalidated = !0;
  this.dropdown = new PlayerDropdown();
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.3);
  this.background.drawRoundedRect(0, 0, 1010, 300, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.alphaTitleField = new PIXI.Text("Alpha", {
    fontName: "Arial",
    fontSize: 22,
    fill: 16711680,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoTitleField = new PIXI.Text("Bravo", {
    fontName: "Arial",
    fontSize: 22,
    fill: 255,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaKillsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaDeathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaRatioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaSkillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoKillsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoDeathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoRatioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoSkillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaKillsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaDeathsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaRatioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaSkillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoKillsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoRatioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.bravoSkillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.alphaTitleField.tint = 15597568;
  this.bravoTitleField.tint = 238;
  this.alphaTitleField.x = 20;
  this.alphaTitleField.y = 20;
  this.bravoTitleField.x = 520;
  this.bravoTitleField.y = 20;
  this.alphaKillsTitleField.x = 210;
  this.alphaKillsTitleField.y = 66;
  this.alphaKillsTitleField.tint = 13421568;
  this.alphaDeathsTitleField.x = 280;
  this.alphaDeathsTitleField.y = 66;
  this.alphaDeathsTitleField.tint = 13421568;
  this.alphaRatioTitleField.x = 370;
  this.alphaRatioTitleField.y = 66;
  this.alphaRatioTitleField.tint = 13421568;
  this.alphaSkillTitleField.x = 450;
  this.alphaSkillTitleField.y = 66;
  this.alphaSkillTitleField.tint = 13421568;
  this.bravoKillsTitleField.x = 715;
  this.bravoKillsTitleField.y = 66;
  this.bravoKillsTitleField.tint = 13421568;
  this.bravoDeathsTitleField.x = 785;
  this.bravoDeathsTitleField.y = 66;
  this.bravoDeathsTitleField.tint = 13421568;
  this.bravoRatioTitleField.x = 875;
  this.bravoRatioTitleField.y = 66;
  this.bravoRatioTitleField.tint = 13421568;
  this.bravoSkillTitleField.x = 955;
  this.bravoSkillTitleField.y = 66;
  this.bravoSkillTitleField.tint = 13421568;
  this.alphaFlag = new PIXI.Sprite(App.CombinedTextures.db_alpha);
  this.alphaFlag.scale.x = this.alphaFlag.scale.y = 0.4;
  this.bravoFlag = new PIXI.Sprite(App.CombinedTextures.db_bravo);
  this.bravoFlag.scale.x = this.bravoFlag.scale.y = 0.4;
  this.alphaPoints = new PIXI.Text("0 x", {
    fontName: "Arial",
    fontSize: 22,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.alphaPoints.x = 42;
  this.alphaPoints.y = 50;
  this.alphaFlag.x = this.alphaPoints.x + 40;
  this.alphaFlag.y = this.alphaPoints.y - 5;
  this.bravoPoints = new PIXI.Text("0 x", {
    fontName: "Arial",
    fontSize: 22,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.bravoPoints.x = 545;
  this.bravoPoints.y = 50;
  this.bravoFlag.x = this.bravoPoints.x + 40;
  this.bravoFlag.y = this.bravoPoints.y - 5;
  this.bravoPointsTotal = this.alphaPointsTotal = 0;
  this.addChild(this.alphaPoints);
  this.addChild(this.bravoPoints);
  this.addChild(this.alphaFlag);
  this.addChild(this.bravoFlag);
  this.addChild(this.alphaTitleField);
  this.addChild(this.bravoTitleField);
  this.addChild(this.alphaKillsTitleField);
  this.addChild(this.alphaDeathsTitleField);
  this.addChild(this.alphaRatioTitleField);
  this.addChild(this.alphaSkillTitleField);
  this.addChild(this.bravoKillsTitleField);
  this.addChild(this.bravoDeathsTitleField);
  this.addChild(this.bravoRatioTitleField);
  this.addChild(this.bravoSkillTitleField);
  this.table = new PIXI.Container();
  this.addChild(this.table);
  this.rowsAlpha = new OrderedContainer();
  this.rowsBravo = new OrderedContainer();
  this.rowLabel = new DBRowLabel();
}
LeaderboardDB.prototype = Object.create(PIXI.Container.prototype);
LeaderboardDB.prototype.constructor = LeaderboardDB;
LeaderboardDB.TEAM_ALPHA = 0;
LeaderboardDB.TEAM_BRAVO = 1;
LeaderboardDB.prototype.validate = function () {
  this.invalidated &&
    (this.rowsAlpha.sortMethodMultiple(-1, "getDeaths", 1, "getKills"),
    this.rowsBravo.sortMethodMultiple(-1, "getDeaths", 1, "getKills"),
    this.update(),
    (this.invalidated = !1));
};
LeaderboardDB.prototype.reset = function () {
  this.rowsAlpha.iterate(function (a, b) {
    b.setDeaths(0);
    b.setKills(0);
    b.setSkill(0);
    return !0;
  });
  this.rowsBravo.iterate(function (a, b) {
    b.setDeaths(0);
    b.setKills(0);
    b.setSkill(0);
    return !0;
  });
  this.bravoPointsTotal = this.alphaPointsTotal = 0;
  this.alphaPoints.text = "0 x";
  this.bravoPoints.text = "0 x";
};
LeaderboardDB.prototype.getTeamRows = function (a) {
  switch (parseInt(a.team, 10)) {
    case LeaderboardDB.TEAM_ALPHA:
      return this.rowsAlpha;
    case LeaderboardDB.TEAM_BRAVO:
      return this.rowsBravo;
  }
};
LeaderboardDB.prototype.hide = function () {
  this.hideDropdown();
  this.hideClientInfo();
  for (var a = 0, b = this.rowsAlpha.getSize(); a < b; a++) {
    var c = this.rowsAlpha.getIndex(a);
    c.unmark();
  }
  a = 0;
  for (b = this.rowsBravo.getSize(); a < b; a++) (c = this.rowsBravo.getIndex(a)), c.unmark();
};
LeaderboardDB.prototype.addClient = function (a) {
  var b = this.getTeamRows(a);
  if (b.getById(a.sid)) this.updateClient(a, !0);
  else {
    var c = new LeaderboardDBRow(a);
    c.on("mouseover", (d) => {
      this.displayClientInfo(d);
      c.mark();
      AudioEffects.ButtonHover.audio.play();
    });
    c.on("mouseout", () => {
      this.hideClientInfo();
      c.unmark();
    });
    c.on("mousemove", (d) => this.moveClientInfo(d));
    c.on("rightdown", (d) => this.displayDropdown(d));
    c.on("mousedown", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    c.on("touchstart", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    b.add(c, a.sid);
    this.table.addChild(c);
    this.updateClient(a, !0);
    this.visible
      ? (b.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
      : (this.invalidated = !0);
  }
};
LeaderboardDB.prototype.displayDropdown = function (a) {
  const b = a.target;
  "guest" !== App.Credential.accounttype &&
    b.name !== App.Credential.username &&
    (this.dropdown.target === b && this.dropdown.parent
      ? this.hideDropdown()
      : ((this.dropdown.target = b),
        this.addChild(this.dropdown),
        this.dropdown.show(),
        (this.dropdown.x = a.data.global.x - this.x),
        (this.dropdown.y = a.data.global.y - this.y)));
};
LeaderboardDB.prototype.hideDropdown = function () {
  this.dropdown.parent && this.removeChild(this.dropdown);
};
LeaderboardDB.prototype.removeClient = function (a) {
  var b = this.getTeamRows(a);
  if (b) {
    var c = b.getById(a.sid);
    c && this.table.removeChild(c);
    b.getById(a.sid) && b.remove(a.sid);
    this.update();
  }
};
LeaderboardDB.prototype.displayClientInfo = function (a) {
  this.rowLabel.update(
    a.target.name,
    a.target.title,
    a.target.level,
    a.target.skill,
    a.target.skillIndex,
    a.target.clanName
  );
  this.rowLabel.parent || this.addChild(this.rowLabel);
};
LeaderboardDB.prototype.hideClientInfo = function () {
  this.rowLabel.parent && this.removeChild(this.rowLabel);
};
LeaderboardDB.prototype.moveClientInfo = function (a) {
  this.rowLabel.parent &&
    ((this.rowLabel.x = a.data.global.x - this.x), (this.rowLabel.y = a.data.global.y - this.y));
};
LeaderboardDB.prototype.registerTeamPoint = function (a) {
  0 === a ? this.alphaPointsTotal++ : 1 === a && this.bravoPointsTotal++;
  this.alphaPoints.text = this.alphaPointsTotal + " x";
  this.bravoPoints.text = this.bravoPointsTotal + " x";
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardDB.prototype.updateTeamPoints = function (a) {
  this.alphaPointsTotal = a[0];
  this.bravoPointsTotal = a[1];
  this.alphaPoints.text = this.alphaPointsTotal + " x";
  this.bravoPoints.text = this.bravoPointsTotal + " x";
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardDB.prototype.updateClient = function (a, b) {
  b = this.getTeamRows(a);
  var c = b.getIndexById(a.sid);
  if ((c = b.getIndex(c)))
    void 0 !== a.kills && c.setKills(c.getKills() + a.kills),
      void 0 !== a.deaths && c.setDeaths(c.getDeaths() + a.deaths),
      void 0 !== a.damage && c.setDamage(c.getDamage() + a.damage),
      void 0 !== a.level && c.setSkill(a.level);
  this.visible
    ? (b.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
    : (this.invalidated = !0);
  this.dispatchEvent(
    new HudEvent(HudEvent.LEADERBOARD_UPDATE, {
      alphaPoints: this.alphaPointsTotal,
      bravoPoints: this.bravoPointsTotal,
    })
  );
};
LeaderboardDB.prototype.update = function () {
  for (var a = 0, b = this.rowsAlpha.getSize(); a < b; a++) {
    var c = this.rowsAlpha.getIndex(a);
    c.x = 100;
    c.y = 90 + 28 * a;
  }
  a = 0;
  for (b = this.rowsBravo.getSize(); a < b; a++)
    (c = this.rowsBravo.getIndex(a)), (c.x = 605), (c.y = 90 + 28 * a);
};
LeaderboardDB.prototype.getWidth = function () {
  return this._width;
};
LeaderboardDB.prototype.getHeight = function () {
  return this._height;
};
function LeaderboardDBRow(a) {
  PIXI.Sprite.call(this);
  this.sid = a.sid;
  this.name = a.name;
  this.local = a.local || !1;
  this.title = a.title;
  this.clanId = a.clan_id;
  this.clanName = a.clan_name;
  this.skill = a.skill;
  this.ratio = 0;
  this.interactive = !0;
  this.background = new PIXI.Graphics();
  this.background.beginFill(16777215, 0.05);
  this.background.drawRect(-94, -4, 488, 28, 4);
  this.background.beginFill(16777215, 0.2);
  this.background.drawRect(-92, -2, 484, 24, 4);
  this.background.endFill();
  this.hitArea = new PIXI.Rectangle(-90, 0, 480, 20);
  a
    ? (a.record
        ? ((this.kills = a.record.kills || 0), (this.deaths = a.record.deaths || 0))
        : (this.deaths = this.kills = 0),
      (this.damage = a.damage || 0),
      (this.level = a.level || 0),
      (this.title = a.title || "guest"))
    : ((this.kills = this.deaths = this.damage = this.level = 0), (this.title = "guest"));
  this.leaderboardRow = new PIXI.Sprite(App.CombinedTextures.leaderboard_row);
  this.leaderboardRow.anchor.x = 0.5;
  this.leaderboardRow.anchor.y = 0.5;
  this.leaderboardRow.x = 150;
  this.leaderboardRow.y = 8;
  this.leaderboardRow.scale.x = 2.8;
  this.nameField = new PIXI.Text(this.name, {
    fontName: "Arial",
    fontSize: 16,
    fill: this.local ? 15658496 : 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsField = new PIXI.Text(this.kills.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsField = new PIXI.Text(this.deaths.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioField = new PIXI.Text(this.ratio.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text(this.level.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.resolution = 1.5 * App.DevicePixelRatio;
  this.level = a.level;
  this.skillIndex = Math.max(Math.floor((this.level / 160) * 10) + 1);
  this.skillIndex = 16 < this.skillIndex ? 16 : this.skillIndex;
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + this.skillIndex]);
  this.skillTag.x = -100;
  this.skillTag.y = -10;
  this.skillTag.scale.x = this.skillTag.scale.y = 0.5;
  this.addChild(this.skillTag);
  this.nameField.anchor.x = 0;
  this.killsField.anchor.x = 0.5;
  this.deathsField.anchor.x = 0.5;
  this.ratioField.anchor.x = 0.5;
  this.skillField.anchor.x = 0.5;
  this.nameField.x = -65;
  this.killsField.x = 125;
  this.deathsField.x = 210;
  this.ratioField.x = 290;
  this.skillField.x = 370;
  this.addChild(this.leaderboardRow);
  this.addChild(this.nameField);
  this.addChild(this.killsField);
  this.addChild(this.deathsField);
  this.addChild(this.ratioField);
  this.addChild(this.skillField);
  this.updateRatio();
}
LeaderboardDBRow.prototype = Object.create(PIXI.Sprite.prototype);
LeaderboardDBRow.prototype.setName = function (a) {
  this.name = a;
  this.nameField.text = this.name;
};
LeaderboardDBRow.prototype.setKills = function (a) {
  this.kills = a;
  this.killsField.text = this.kills.toString();
  this.updateRatio();
};
LeaderboardDBRow.prototype.setDeaths = function (a) {
  this.deaths = a;
  this.deathsField.text = this.deaths.toString();
  this.updateRatio();
};
LeaderboardDBRow.prototype.setDamage = function (a) {
  this.damage = a;
};
LeaderboardDBRow.prototype.setSkill = function (a) {
  this.level = a;
  this.skillField.text = this.level.toString();
};
LeaderboardDBRow.prototype.updateRatio = function () {
  this.ratio = this.kills / (0 < this.deaths ? this.deaths : 1);
  this.ratioField.text = this.ratio.toPrecision(2).toString();
};
LeaderboardDBRow.prototype.getKills = function () {
  return this.kills;
};
LeaderboardDBRow.prototype.getDeaths = function () {
  return this.deaths;
};
LeaderboardDBRow.prototype.getDamage = function () {
  return this.damage;
};
LeaderboardDBRow.prototype.getRatio = function () {
  return this.ratio;
};
LeaderboardDBRow.prototype.getSkill = function () {
  return this.level;
};
LeaderboardDBRow.prototype.mark = function () {
  this.background.parent || this.addChildAt(this.background, 0);
};
LeaderboardDBRow.prototype.unmark = function () {
  this.background.parent && this.removeChild(this.background);
};
function DBRowLabel() {
  PIXI.Container.call(this);
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.7);
  this.background.drawRoundedRect(0, 0, 300, 130, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.nameFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.descTitle = new PIXI.Text(
    "Left-click to view full profile.\nRight-click to display additional options.",
    {
      fontName: "Arial",
      fontSize: 14,
      fill: 13412864,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 280,
    }
  );
  this.nameField = new PIXI.Text("Name:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField = new PIXI.Text("Title:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text("Level & skill:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanField = new PIXI.Text("Clan:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.tint = 13421568;
  this.titleField.tint = 13421568;
  this.skillField.tint = 13421568;
  this.clanField.tint = 13421568;
  this.addChild(this.nameFieldTitle);
  this.addChild(this.titleFieldTitle);
  this.addChild(this.skillFieldTitle);
  this.addChild(this.clanFieldTitle);
  this.addChild(this.descTitle);
  this.addChild(this.nameField);
  this.addChild(this.titleField);
  this.addChild(this.skillField);
  this.addChild(this.clanField);
  this.nameField.x = 70;
  this.titleField.x = 70;
  this.skillField.x = 70;
  this.clanField.x = 70;
  this.descTitle.x = 10;
  this.nameField.y = 5;
  this.titleField.y = 25;
  this.skillField.y = 45;
  this.clanField.y = 65;
  this.descTitle.y = 85;
  this.nameFieldTitle.x = 125;
  this.titleFieldTitle.x = 125;
  this.skillFieldTitle.x = 165;
  this.clanFieldTitle.x = 125;
  this.nameFieldTitle.y = 5;
  this.titleFieldTitle.y = 25;
  this.skillFieldTitle.y = 45;
  this.clanFieldTitle.y = 65;
  this.skillTag = null;
}
DBRowLabel.prototype = Object.create(PIXI.Container.prototype);
DBRowLabel.prototype.constructor = DBRowLabel;
DBRowLabel.prototype.update = function (a, b, c, d, e, f) {
  this.nameFieldTitle.text = a;
  this.titleFieldTitle.text = b;
  this.skillFieldTitle.text = c + " - " + Game.MapSkillToTitle(d);
  this.clanFieldTitle.text = f;
  null !== this.skillTag && this.skillTag.parent && this.removeChild(this.skillTag);
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + e]);
  this.addChild(this.skillTag);
};
var tr_leaderboard = {};
function LeaderboardTR() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._width = App.ClientWidth - 400;
  this._height = 560;
  this.invalidated = !0;
  this.dropdown = new PlayerDropdown();
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.3);
  this.background.drawRoundedRect(0, 0, 590, 420, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.titleField = new PIXI.Text("Leaderboard", {
    fontName: "Arial",
    fontSize: 22,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField.x = 230;
  this.titleField.y = 12;
  this.titleField.resolution = 1.5 * App.DevicePixelRatio;
  this.addChild(this.titleField);
  this.killsTitleField = new PIXI.Text("Kills", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsTitleField = new PIXI.Text("Deaths", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioTitleField = new PIXI.Text("Ratio", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillTitleField = new PIXI.Text("Level", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.deathsTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.ratioTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.skillTitleField.resolution = 1.5 * App.DevicePixelRatio;
  this.table = new PIXI.Container();
  this.addChild(this.table);
  this.killsTitleField.x = 264;
  this.killsTitleField.y = 42;
  this.deathsTitleField.x = 340;
  this.deathsTitleField.y = 42;
  this.ratioTitleField.x = 434;
  this.ratioTitleField.y = 42;
  this.skillTitleField.x = 524;
  this.skillTitleField.y = 42;
  this.addChild(this.killsTitleField);
  this.addChild(this.deathsTitleField);
  this.addChild(this.ratioTitleField);
  this.addChild(this.skillTitleField);
  this.rows = new OrderedContainer();
  this.rowLabel = new TRRowLabel();
}
LeaderboardTR.prototype = Object.create(PIXI.Container.prototype);
LeaderboardTR.prototype.constructor = LeaderboardTR;
LeaderboardTR.prototype.validate = function () {
  this.invalidated &&
    (this.rows.sortMethodMultiple(-1, "getDeaths", 1, "getKills"),
    this.update(),
    (this.invalidated = !1));
};
LeaderboardTR.prototype.reset = function () {
  this.rows.iterate(function (a, b) {
    b.setDeaths(0);
    b.setKills(0);
    return !0;
  });
};
LeaderboardTR.prototype.hide = function () {
  this.hideDropdown();
  this.hideClientInfo();
  for (var a = 0, b = this.rows.getSize(); a < b; a++) this.rows.getIndex(a).unmark();
};
LeaderboardTR.prototype.updateTeamPoints = function () {};
LeaderboardTR.prototype.addClient = function (a) {
  if (this.rows.getById(a.sid)) this.updateClient(a);
  else {
    var b = new TRLeaderboardRow(a);
    b.on("mouseover", (c) => {
      this.displayClientInfo(c);
      b.mark();
      AudioEffects.ButtonHover.audio.play();
    });
    b.on("mouseout", () => {
      this.hideClientInfo();
      b.unmark();
    });
    b.on("mousemove", (c) => this.moveClientInfo(c));
    b.on("rightdown", (c) => this.displayDropdown(c));
    b.on("mousedown", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    b.on("touchstart", () => {
      a.guest || this.dispatchEvent(new HudEvent(HudEvent.DISPLAY_PROFILE, { name: a.name }));
    });
    this.rows.add(b, a.sid);
    this.table.addChild(b);
    this.visible
      ? (this.rows.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
      : (this.invalidated = !0);
  }
};
LeaderboardTR.prototype.displayDropdown = function (a) {
  const b = a.target;
  "guest" !== App.Credential.accounttype &&
    b.name !== App.Credential.username &&
    (this.dropdown.target === b && this.dropdown.parent
      ? this.hideDropdown()
      : ((this.dropdown.target = b),
        this.addChild(this.dropdown),
        this.dropdown.show(),
        (this.dropdown.x = a.data.global.x - this.x - 10),
        (this.dropdown.y = a.data.global.y - this.y - 4)));
};
LeaderboardTR.prototype.hideDropdown = function () {
  this.dropdown.parent && this.removeChild(this.dropdown);
};
LeaderboardTR.prototype.removeClient = function (a) {
  var b = this.rows.getById(a.sid);
  b && this.table.removeChild(b);
  this.rows.getById(a.sid) && this.rows.remove(a.sid);
  this.update();
};
LeaderboardTR.prototype.displayClientInfo = function (a) {
  this.rowLabel.update(
    a.target.name,
    a.target.title,
    a.target.level,
    a.target.skill,
    a.target.skillIndex,
    a.target.clanName
  );
  this.rowLabel.parent || this.addChild(this.rowLabel);
};
LeaderboardTR.prototype.hideClientInfo = function () {
  this.rowLabel.parent && this.removeChild(this.rowLabel);
};
LeaderboardTR.prototype.moveClientInfo = function (a) {
  this.rowLabel.parent &&
    ((this.rowLabel.x = a.data.global.x - this.x),
    (this.rowLabel.y = a.data.global.y - (this.y + this.rowLabel.height)));
};
LeaderboardTR.prototype.updateClient = function (a) {
  var b = this.rows.getIndexById(a.sid);
  if ((b = this.rows.getIndex(b)))
    void 0 !== a.kills && b.setKills(b.getKills() + a.kills),
      void 0 !== a.deaths && b.setDeaths(b.getDeaths() + a.deaths),
      void 0 !== a.level && b.setSkill(a.level);
  this.visible
    ? (this.rows.sortMethodMultiple(-1, "getDeaths", 1, "getKills"), this.update())
    : (this.invalidated = !0);
};
LeaderboardTR.prototype.update = function () {
  for (var a = [], b = null, c = 0, d = this.rows.getSize(); c < d; c++) {
    var e = this.rows.getIndex(c);
    5 > c && a.push({ name: e.name, color: Team.HexColors[e.team], kills: e.kills });
    e.local && (b = { name: e.name, index: c, kills: e.kills });
    e.x = 135;
    e.y = 68 + 28 * c;
  }
  this.dispatchEvent(new HudEvent(HudEvent.LEADERBOARD_UPDATE, { top: a, local: b }));
};
LeaderboardTR.prototype.getWidth = function () {
  return this._width;
};
LeaderboardTR.prototype.getHeight = function () {
  return this._height;
};
function TRLeaderboardRow(a) {
  PIXI.Sprite.call(this);
  this.sid = a.sid;
  this.name = a.name;
  this.local = a.local || !1;
  this.title = a.title;
  this.clanId = a.clan_id;
  this.clanName = a.clan_name;
  this.skill = a.skill;
  this.team = a.team;
  this.ratio = 0;
  this.interactive = !0;
  this.background = new PIXI.Graphics();
  this.background.beginFill(16777215, 0.05);
  this.background.drawRect(-130, -4, 580, 28, 4);
  this.background.beginFill(16777215, 0.2);
  this.background.drawRect(-128, -2, 576, 24, 4);
  this.background.endFill();
  this.hitArea = new PIXI.Rectangle(-130, 0, 580, 20);
  a
    ? (a.record
        ? ((this.kills = a.record.kills || 0), (this.deaths = a.record.deaths || 0))
        : (this.deaths = this.kills = 0),
      (this.level = a.level || 0),
      (this.title = a.title || "guest"))
    : ((this.kills = this.deaths = this.damage = this.level = 0), (this.title = "guest"));
  this.leaderboardRow = new PIXI.Sprite(App.CombinedTextures.leaderboard_row);
  this.leaderboardRow.anchor.x = 0.5;
  this.leaderboardRow.anchor.y = 0.5;
  this.leaderboardRow.x = 150;
  this.leaderboardRow.y = 8;
  this.leaderboardRow.scale.x = 2.8;
  this.nameField = new PIXI.Text(this.name, {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.killsField = new PIXI.Text(this.kills.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.deathsField = new PIXI.Text(this.deaths.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.ratioField = new PIXI.Text(this.ratio.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text(this.level.toString(), {
    fontName: "Arial",
    fontSize: 16,
    fill: 15658734,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.nameField.tint = Team.HexColors[a.team];
  this.nameField.resolution = 1.5 * App.DevicePixelRatio;
  this.nameField.anchor.x = 0.5;
  this.killsField.anchor.x = 0.5;
  this.deathsField.anchor.x = 0.5;
  this.ratioField.anchor.x = 0.5;
  this.skillField.anchor.x = 0.5;
  this.nameField.x = 10;
  this.killsField.x = 145;
  this.deathsField.x = 230;
  this.ratioField.x = 320;
  this.skillField.x = 410;
  this.addChild(this.leaderboardRow);
  this.addChild(this.nameField);
  this.addChild(this.killsField);
  this.addChild(this.deathsField);
  this.addChild(this.ratioField);
  this.addChild(this.skillField);
  this.skillIndex = Math.max(Math.floor((this.level / 160) * 10) + 1);
  this.skillIndex = 16 < this.skillIndex ? 16 : this.skillIndex;
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + this.skillIndex]);
  this.skillTag.x = -130;
  this.skillTag.y = -10;
  this.skillTag.scale.x = this.skillTag.scale.y = 0.5;
  this.addChild(this.skillTag);
  this.updateRatio();
}
TRLeaderboardRow.prototype = Object.create(PIXI.Sprite.prototype);
TRLeaderboardRow.prototype.setName = function (a) {
  this.name = a;
  this.nameField.text = this.name;
};
TRLeaderboardRow.prototype.setKills = function (a) {
  this.kills = a;
  this.killsField.text = this.kills.toString();
  this.updateRatio();
};
TRLeaderboardRow.prototype.setDeaths = function (a) {
  this.deaths = a;
  this.deathsField.text = this.deaths.toString();
  this.updateRatio();
};
TRLeaderboardRow.prototype.setSkill = function (a) {
  this.level = a;
  this.skillField.text = this.level.toString();
};
TRLeaderboardRow.prototype.updateRatio = function () {
  this.ratio = this.kills / (0 < this.deaths ? this.deaths : 1);
  this.ratioField.text = this.ratio.toPrecision(2).toString();
};
TRLeaderboardRow.prototype.getKills = function () {
  return this.kills;
};
TRLeaderboardRow.prototype.getDeaths = function () {
  return this.deaths;
};
TRLeaderboardRow.prototype.getDamage = function () {
  return this.damage;
};
TRLeaderboardRow.prototype.getRatio = function () {
  return this.ratio;
};
TRLeaderboardRow.prototype.getskill = function () {
  return this.level;
};
TRLeaderboardRow.prototype.mark = function () {
  this.background.parent || this.addChildAt(this.background, 0);
};
TRLeaderboardRow.prototype.unmark = function () {
  this.background.parent && this.removeChild(this.background);
};
function TRRowLabel() {
  PIXI.Container.call(this);
  this.background = new PIXI.Graphics();
  this.background.beginFill(0, 0.8);
  this.background.drawRoundedRect(0, 0, 300, 130, 5, 5);
  this.background.endFill();
  this.addChild(this.background);
  this.nameFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanFieldTitle = new PIXI.Text("", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421772,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.descTitle = new PIXI.Text(
    "Left-click to view full profile.\nRight-click to display additional options.",
    {
      fontName: "Arial",
      fontSize: 14,
      fill: 13412864,
      strokeThickness: 3,
      lineJoin: "round",
      wordWrap: !0,
      wordWrapWidth: 280,
    }
  );
  this.nameField = new PIXI.Text("Name:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.titleField = new PIXI.Text("Title:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.skillField = new PIXI.Text("Level & skill:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.clanField = new PIXI.Text("Clan:", {
    fontName: "Arial",
    fontSize: 16,
    fill: 13421568,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.addChild(this.nameFieldTitle);
  this.addChild(this.titleFieldTitle);
  this.addChild(this.skillFieldTitle);
  this.addChild(this.clanFieldTitle);
  this.addChild(this.descTitle);
  this.addChild(this.nameField);
  this.addChild(this.titleField);
  this.addChild(this.skillField);
  this.addChild(this.clanField);
  this.nameField.x = 70;
  this.titleField.x = 70;
  this.skillField.x = 70;
  this.clanField.x = 70;
  this.descTitle.x = 10;
  this.nameField.y = 5;
  this.titleField.y = 25;
  this.skillField.y = 45;
  this.clanField.y = 65;
  this.descTitle.y = 85;
  this.nameFieldTitle.x = 125;
  this.titleFieldTitle.x = 125;
  this.skillFieldTitle.x = 165;
  this.clanFieldTitle.x = 125;
  this.nameFieldTitle.y = 5;
  this.titleFieldTitle.y = 25;
  this.skillFieldTitle.y = 45;
  this.clanFieldTitle.y = 65;
  this.skillTag = null;
}
TRRowLabel.prototype = Object.create(PIXI.Container.prototype);
TRRowLabel.prototype.constructor = TRRowLabel;
TRRowLabel.prototype.update = function (a, b, c, d, e, f) {
  this.nameFieldTitle.text = a;
  this.titleFieldTitle.text = b;
  this.skillFieldTitle.text = c + " - " + Game.MapSkillToTitle(d);
  this.clanFieldTitle.text = f;
  null !== this.skillTag && this.skillTag.parent && this.removeChild(this.skillTag);
  this.skillTag = new PIXI.Sprite(App.CombinedTextures["skill_icon_" + e]);
  this.addChild(this.skillTag);
};
class Hud extends PIXI.Container {
  constructor(a) {
    super();
    EventDispatcher.call(this);
    this.manager = a;
    this.manager.on(ModelEvent.PLAYER_STATE, this.onPlayerState.bind(this));
    this.manager.on(ModelEvent.PLAYER_SPAWN, this.onPlayerSpawn.bind(this));
    this.manager.on(ModelEvent.PLAYER_DEATH, this.onPlayerDeath.bind(this));
    this.manager.on(ModelEvent.PLAYER_COMBO, this.onPlayerCombo.bind(this));
    this.manager.on(ModelEvent.FOCUS, this.onFocus.bind(this));
    this.manager.on(ModelEvent.UPDATE_ENVIRONMENT, this.onUpdateEnvironment.bind(this));
    this.keyboardMapping = InputState.InvertMapping(
      Registry.Instance[Registry.Key.SETTINGS].controls.keyBindings
    );
    this.textBar = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 32,
      fill: "#FF0000",
      align: "center",
    });
    this.textBar.x = 0.5 * App.ClientWidth;
    this.textBar.y = App.ClientHeight - 170;
    this.textBar.alpha = 1;
    this.textBar.visible = !1;
    this.textBarInterval = this.textBarTimeout = null;
    this.comboBar = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 32,
      fill: "#FF0000",
      align: "center",
    });
    this.comboBar.x = 0.5 * App.ClientWidth;
    this.comboBar.y = App.ClientHeight - 95;
    this.comboBar.alpha = 1;
    this.comboBar.visible = !1;
    this.onKeyDownListener = this.onKeyDown.bind(this);
    this.onKeyUpListener = this.onKeyUp.bind(this);
    UserInput.addListener(UserInput.KEY_DOWN, this.onKeyDownListener);
    UserInput.addListener(UserInput.KEY_UP, this.onKeyUpListener);
    this.mode = null;
    this.helpImageFirstDisplay = !1;
    this.damageGraphic = new PIXI.Sprite(App.CombinedTextures.damage);
    this.addChild(this.damageGraphic);
    this.damageGraphic.visible = !1;
    this.damageGraphic.width = App.ClientWidth;
    this.damageGraphic.height = App.ClientHeight;
    this.healthBar = new HealthBar();
    this.healthBar.interactiveChildren = !1;
    this.healthBar.x = 20;
    this.healthBar.y = App.ClientHeight - 32;
    this.healthBar.scale.x = 0.6;
    this.healthBar.scale.y = 0.6;
    this.addChild(this.healthBar);
    this.jetBar = new JetBar();
    this.jetBar.interactiveChildren = !1;
    this.jetBar.x = this.healthBar.x + this.healthBar.width + 20;
    this.jetBar.y = App.ClientHeight - 32;
    this.jetBar.scale.x = 0.6;
    this.jetBar.scale.y = 0.6;
    this.addChild(this.jetBar);
    this.ammoBar = new AmmoBar();
    this.ammoBar.interactiveChildren = !1;
    this.ammoBar.x = this.jetBar.x + this.jetBar.width + 20;
    this.ammoBar.y = App.ClientHeight - 32;
    this.ammoBar.scale.x = 0.6;
    this.ammoBar.scale.y = 0.6;
    this.addChild(this.ammoBar);
    this.goldCount = new GoldCount();
    this.goldCount.interactiveChildren = !1;
    this.goldCount.x = this.ammoBar.x + this.ammoBar.width + 20;
    this.goldCount.y = App.ClientHeight - 32;
    this.goldCount.scale.x = 0.6;
    this.goldCount.scale.y = 0.6;
    this.addChild(this.goldCount);
    this.actionTable = new ActionTable();
    this.actionTable.interactiveChildren = !1;
    1200 > App.ClientWidth && 1e3 <= App.ClientWidth
      ? ((this.actionTable.scale.x = 0.8),
        (this.actionTable.scale.y = 0.8),
        (App.Console.scale.x = 0.8),
        (App.Console.scale.y = 0.8))
      : 1e3 > App.ClientWidth
      ? ((this.actionTable.scale.x = 0.74),
        (this.actionTable.scale.y = 0.74),
        (App.Console.scale.x = 0.74),
        (App.Console.scale.y = 0.74))
      : ((this.actionTable.scale.x = 1),
        (this.actionTable.scale.y = 1),
        (App.Console.scale.x = 1),
        (App.Console.scale.y = 1));
    this.actionTable.x =
      App.ClientWidth - this.actionTable.getWidth() * this.actionTable.scale.x - 12;
    this.actionTable.y = 60;
    this.addChild(this.actionTable);
    this.gameoverDisplay = new GameoverDisplay();
    this.gameoverDisplay.interactiveChildren = !1;
    this.gameoverDisplay.visible = !1;
    this.gameoverDisplay.isActive = !1;
    this.gameoverDisplay.x = 0.5 * (App.ClientWidth - this.gameoverDisplay.getWidth());
    this.gameoverDisplay.y = 40;
    this.weaponMenu = new WeaponMenu();
    this.weaponMenu.x = 0.5 * (App.ClientWidth - this.weaponMenu.width);
    this.weaponMenu.y = 0.5 * (App.ClientHeight - this.weaponMenu.height);
    this.weaponMenu.visible = !1;
    this.weaponMenu.on(HudEvent.SELECT_ITEM, (b) => this.emit(HudEvent.SELECT_ITEM, b));
    this.weaponMenu.on(HudEvent.CLOSE_WEAPON_MENU, () => {
      this.displayWeaponMenu(!1);
      this.emit(HudEvent.SELECT_ITEM, null);
    });
    this.leaderboardUpdateInterval = setInterval(() => this.leaderboard.validate(), 1e3);
    this.addChild(this.textBar);
    this.addChild(this.comboBar);
    this.hideHelpImageInterval = this.displayHelpImageInterval = null;
    this.helpImage = new PIXI.Sprite(App.CombinedTextures.help);
    this.helpImage.interactive = !0;
    this.helpImage.scale.x = this.helpImage.scale.y = 0.05;
    this.helpImage.anchor.x = this.helpImage.anchor.y = 0.5;
    this.helpImage.x = 0.5 * App.ClientWidth;
    this.helpImage.y = 0.5 * App.ClientHeight;
    this.helpImage.on("mousedown", () => this.hideHelpImage());
    this.helpImage.on("touchstart", () => this.hideHelpImage());
    this.closeHelpImageButton = new PIXI.Sprite(App.CombinedTextures.exit);
    this.closeHelpImageButton.x = 252;
    this.closeHelpImageButton.y = -178;
    this.helpImage.addChild(this.closeHelpImageButton);
    this.escapeMenu = new EscapeMenu();
    this.escapeMenu.x = 0.5 * (App.ClientWidth - this.escapeMenu.width);
    this.escapeMenu.y = 0.5 * (App.ClientHeight - this.escapeMenu.height);
    this.escapeMenu.on(EscapeMenu.EXIT, () => this.emit(HudEvent.EXIT));
    this.escapeMenu.on(EscapeMenu.MUTE, (b) => this.emit(HudEvent.MUTE_SOUND, b));
    this.escapeMenu.on(EscapeMenu.CLOSE, () => this.hideEscapeMenu());
    this.escapeMenu.on(EscapeMenu.WEAPONS, () => {
      this.hideEscapeMenu();
      this.displayWeaponMenu(!0);
    });
    this.escapeMenu.on(EscapeMenu.CONTROLS, () => {
      this.hideEscapeMenu();
      this.displayHelpImage();
    });
    App.FirstRun &&
      !App.HelpDisplayed &&
      ((this.helpImageFirstDisplay = !0), this.displayHelpImage(), (App.HelpDisplayed = !0));
  }
  displayHelpImage() {
    if (!this.escapeMenu.parent && this.helpImage.interactive) {
      if (null !== this.displayHelpImageInterval)
        clearInterval(this.displayHelpImageInterval), (this.displayHelpImageInterval = null);
      else if (this.helpImage.parent) {
        this.hideHelpImage();
        return;
      }
      this.helpImage.parent ||
        ((this.helpImage.interactive = !1),
        this.addChild(this.helpImage),
        (this.helpImage.scale.x = this.helpImage.scale.y = 0.05),
        (this.helpImage.x = App.ClientWidth - 180),
        (this.helpImage.y = 13),
        (this.displayHelpImageInterval = setInterval(() => {
          this.helpImage.scale.x += 0.05;
          this.helpImage.scale.y += 0.05;
          let a = this.helpImage.y - 0.5 * App.ClientHeight;
          this.helpImage.x -= 0.25 * (this.helpImage.x - 0.5 * App.ClientWidth);
          this.helpImage.y -= 0.25 * a;
          this.helpImage.scale.x >= App.Scale - 0.05 &&
            (clearInterval(this.displayHelpImageInterval),
            (this.displayHelpImageInterval = null),
            (this.helpImage.scale.x = this.helpImage.scale.y = App.Scale),
            (this.helpImage.x = 0.5 * App.ClientWidth),
            (this.helpImage.y = 0.5 * App.ClientHeight),
            (this.helpImage.interactive = !0));
        }, 17)));
    }
  }
  hideHelpImage() {
    null !== this.hideHelpImageInterval &&
      (clearInterval(this.hideHelpImageInterval), (this.hideHelpImageInterval = null));
    this.helpImage.scale.x = this.helpImage.scale.y = App.Scale;
    this.helpImage.interactive = !1;
    this.hideHelpImageInterval = setInterval(() => {
      this.helpImage.scale.x -= 0.05;
      this.helpImage.scale.y -= 0.05;
      let a = -this.helpImage.y + 13;
      this.helpImage.x += 0.25 * (App.ClientWidth - (this.helpImage.x + 150));
      this.helpImage.y += 0.25 * a;
      0.05 >= this.helpImage.scale.x &&
        (this.helpImage.parent && this.removeChild(this.helpImage),
        this.helpImageFirstDisplay &&
          (this.displayWeaponMenu(!0), (this.helpImageFirstDisplay = !1)),
        clearInterval(this.hideHelpImageInterval),
        (this.hideHelpImageInterval = null),
        (this.helpImage.interactive = !0));
    }, 17);
  }
  displayEscapeMenu() {
    this.escapeMenu.parent || (this.addChild(this.escapeMenu), (App.UIVisible = !0));
  }
  hideEscapeMenu() {
    this.escapeMenu.parent && (this.removeChild(this.escapeMenu), (App.UIVisible = !1));
  }
  setMuted(a) {
    this.escapeMenu.setMuted(a);
  }
  onKeyDown(a) {
    a = a.data;
    if (void 0 !== a.char) {
      var b = a.char.toUpperCase();
      if (27 === a.code) this.escapeMenu.parent ? this.hideEscapeMenu() : this.displayEscapeMenu();
      else
        switch (
          (characterMapCTRL[a.code] && (b = characterMapCTRL[a.code]),
          (b = InputState.GetMappedCharacter(b, this.keyboardMapping)),
          b)
        ) {
          case "G":
            this.displayWeaponMenu(!0);
            break;
          case "H":
            this.displayHelpImage();
            break;
          case "V":
            this.leaderboard.visible ||
              this.escapeMenu.parent ||
              (this.addChild(this.leaderboard),
              (this.leaderboard.visible = !0),
              this.leaderboard.validate()),
              (App.UIVisible = !0);
        }
    }
  }
  onKeyUp(a) {
    a = a.data;
    if (void 0 !== a.char) {
      var b = a.char.toUpperCase();
      characterMapCTRL[a.code] && (b = characterMapCTRL[a.code]);
      b = InputState.GetMappedCharacter(b, this.keyboardMapping);
      switch (b) {
        case "F":
          this.weaponMenu.itemSelected && this.displayWeaponMenu(!1);
          break;
        case "V":
          this.leaderboard.visible &&
            (this.removeChild(this.leaderboard),
            (this.leaderboard.visible = !1),
            this.leaderboard.hide()),
            (App.UIVisible = !1);
      }
    }
  }
  setGameMode(a) {
    this.mode = a;
    if (!this.leaderboard)
      switch (a) {
        case Game.MODE_CTF:
          this.leaderboard = new LeaderboardCTF();
          this.actionTable.setMode(Game.MODE_CTF);
          this.leaderboard.addListener(
            HudEvent.LEADERBOARD_UPDATE,
            this.updateFlagScore.bind(this)
          );
          break;
        case Game.MODE_DM:
          this.leaderboard = new LeaderboardDM();
          this.actionTable.setMode(Game.MODE_DM);
          this.leaderboard.addListener(
            HudEvent.LEADERBOARD_UPDATE,
            this.updateTopListing.bind(this)
          );
          break;
        case Game.MODE_TDM:
          this.leaderboard = new LeaderboardTDM();
          this.actionTable.setMode(Game.MODE_TDM);
          this.leaderboard.addListener(HudEvent.LEADERBOARD_UPDATE, this.updateTDMScore.bind(this));
          break;
        case Game.MODE_DB:
          this.leaderboard = new LeaderboardDB();
          this.actionTable.setMode(Game.MODE_DB);
          this.leaderboard.addListener(HudEvent.LEADERBOARD_UPDATE, this.updateDBScore.bind(this));
          break;
        case Game.MODE_TR:
          (this.leaderboard = new LeaderboardTR()),
            this.actionTable.setMode(Game.MODE_TR),
            this.leaderboard.addListener(
              HudEvent.LEADERBOARD_UPDATE,
              this.updateTRScore.bind(this)
            );
      }
    this.leaderboard.addListener(HudEvent.DISPLAY_PROFILE, this.onDisplayProfile.bind(this));
    this.leaderboard.visible = !1;
    this.onFocus();
  }
  onDisplayProfile(a) {
    App.Layer.onUserAccess(a.data.name, "name");
    AudioEffects.ButtonClick.audio.play();
  }
  updateFlagScore(a) {
    this.actionTable.updateFlagScore(a.data);
  }
  updateTopListing(a) {
    this.actionTable.updateTopListing(a.data);
  }
  updateTDMScore(a) {
    this.actionTable.updateTDMScore(a.data);
  }
  updateDBScore(a) {
    this.actionTable.updateDBScore(a.data);
  }
  updateTRScore(a) {
    this.actionTable.updateTRScore(a.data);
  }
  onPlayerState(a) {
    let b = a.agent;
    switch (a.state.s) {
      case StateChange.Agent.JET:
        this.setJet(b, a.state);
        break;
      case StateChange.Agent.HEALTH:
        this.setHealth(b);
        break;
      case StateChange.Agent.GOLD:
        this.goldCount.increment(a.state.v);
        break;
      case StateChange.Item.RELOAD:
      case StateChange.Item.USE:
        ItemMap[a.state.t].equip !== ItemMap.Equip.BELT
          ? this.setItemStatus(b, a.state)
          : this.ammoBar.decrementBeltValue(a.state);
        break;
      case StateChange.Item.EQUIP:
        this.setItemStatus(b, a.state);
        break;
      case StateChange.Item.CARRY_PRIMARY:
        this.ammoBar.setItem(a.state);
        break;
      case StateChange.Item.CARRY_BELT:
        this.ammoBar.setBeltItem(a.state);
        break;
      case StateChange.Item.DROP:
      case StateChange.Item.REMOVE_PRIMARY:
        this.ammoBar.setItem(null);
    }
  }
  setAvailableItems(a) {
    for (let b = 0, c = a.length; b < c; b++) this.weaponMenu.addItem(a[b]);
    this.weaponMenu.rearrange();
  }
  displayWeaponMenu(a) {
    null === this.mode ||
      this.mode === Game.MODE_DB ||
      this.weaponMenu.isEmpty ||
      this.helpImage.parent ||
      this.escapeMenu.parent ||
      (a
        ? this.weaponMenu.visible ||
          this.gameoverDisplay.isActive ||
          (this.addChild(this.weaponMenu), (this.weaponMenu.visible = !0))
        : this.weaponMenu.visible &&
          (this.removeChild(this.weaponMenu), (this.weaponMenu.visible = !1)),
      (App.UIVisible = a));
  }
  onPlayerSpawn() {
    this.jetBar.setValue(this.jetBar.maxValue);
    this.weaponMenu.essentialItemSelected ? this.displayWeaponMenu(!1) : this.displayWeaponMenu(!0);
    this.textBar.visible = !1;
  }
  onPlayerDeath(a) {
    let b = a.victim,
      c = a.killer,
      d = a.local,
      e = null;
    a.wep && (e = Game.MapEventWepToIcon(a.wep));
    b === c
      ? (b.sid === d && this.displaySuicide(Game.MapEventWepToIcon(a.wep)),
        this.actionTable.register(c.name + " suicide", e),
        this.leaderboard.updateClient({ sid: c.sid, kills: -1, team: c.team }))
      : (b.sid === d
          ? this.displayKilledBy(c, Game.MapEventWepToIcon(a.wep))
          : c.sid === d && this.displayKilled(b, Game.MapEventWepToIcon(a.wep)),
        this.leaderboard.updateClient({ sid: c.sid, kills: 1, team: c.team }),
        this.actionTable.register(c.name + " killed " + b.name, e));
    this.leaderboard.updateClient({ sid: b.sid, deaths: 1, team: b.team });
    b.sid === d &&
      (this.ammoBar.setBeltItem(null),
      !1 === this.gameoverDisplay.visible &&
        (this.weaponMenuTimeout && clearTimeout(this.weaponMenuTimeout),
        (this.weaponMenuTimeout = setTimeout(() => this.displayWeaponMenu(!0), 1500))));
  }
  onPlayerCombo(a) {
    this.displayCombo(a.type);
  }
  setJet(a, b) {
    this.jetBar.setValue(b.v);
  }
  setHealth(a) {
    this.healthBar.setValue(a.health);
    a.alive
      ? 30 > a.health
        ? ((this.damageGraphic.visible = !0),
          (this.damageGraphic.alpha = (1 / 30) * (30 - a.health)))
        : (this.damageGraphic.visible = !1)
      : (this.damageGraphic.visible = !0);
  }
  setItemStatus(a, b) {
    a.primaryItem &&
      b.t === a.primaryItem.itemType &&
      (void 0 !== b.c
        ? (void 0 !== b.m ? this.ammoBar.setMaxValue(b.m) : this.ammoBar.setValue(0),
          this.ammoBar.setValue(b.c))
        : this.ammoBar.subtract());
  }
  registerKill() {}
  registerScore(a) {
    this.displayScoredBy(a);
    this.leaderboard.updateClient({ sid: a.sid, points: 1, team: a.team });
  }
  registerDbRoundWin(a) {
    this.displayDbRoundWon(a);
    this.leaderboard.registerTeamPoint(a);
  }
  onGameobjectAdded() {}
  updateTeamStats(a) {
    a && this.leaderboard.updateTeamPoints(a.teams);
  }
  onModelState() {
    this.gameoverDisplay.x = 0.5 * (App.ClientWidth - this.gameoverDisplay.getWidth());
    this.gameoverDisplay.y = 4;
  }
  setGameoverState(a) {
    this.gameoverDisplay.visible ||
      (this.addChild(this.gameoverDisplay),
      (this.gameoverDisplay.visible = !0),
      (this.gameoverDisplay.isActive = !0));
    this.displayWeaponMenu(!1);
    this.gameoverDisplay.setContent(a);
  }
  setLeaderboard() {
    this.leaderboard.visible ||
      this.escapeMenu.parent ||
      (this.addChild(this.leaderboard),
      (this.leaderboard.visible = !0),
      this.leaderboard.validate());
    this.displayWeaponMenu(!1);
  }
  reset() {
    this.goldCount.setValue(0);
  }
  emptyLeaderboard() {
    this.leaderboard.reset();
    this.textBarInterval && clearInterval(this.textBarInterval);
  }
  setGameoverCount(a) {
    this.gameoverDisplay.updateCountdown(a);
  }
  setSpecMode() {
    this.damageGraphic.visible = !1;
    this.damageGraphic.alpha = 0;
    this.gameoverDisplay.visible &&
      (this.removeChild(this.gameoverDisplay),
      (this.gameoverDisplay.visible = !1),
      (this.gameoverDisplay.isActive = !1));
    this.leaderboard.visible &&
      (this.removeChild(this.leaderboard), (this.leaderboard.visible = !1));
  }
  setPlayMode() {
    this.gameoverDisplay.visible &&
      (this.removeChild(this.gameoverDisplay),
      (this.gameoverDisplay.visible = !1),
      (this.gameoverDisplay.isActive = !1));
    this.leaderboard.visible &&
      (this.removeChild(this.leaderboard), (this.leaderboard.visible = !1));
    this.weaponMenu.essentialItemSelected = !1;
    this.damageGraphic.visible = !0;
    this.damageGraphic.alpha = 0;
  }
  textBarMessage(a, b) {
    this.textBar.text = a;
    this.textBar.tint = b;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar();
  }
  displayScoredBy(a) {
    let b = a.name + " scores for " + Team.Names[a.team] + " team!";
    this.textBar.tint = Team.HexColors[a.team];
    this.textBar.text = b;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar(new PIXI.Sprite(App.CombinedTextures["flag_" + Team.Names[a.team]]));
    this.actionTable.register(b);
  }
  displayDbRoundWon(a) {
    let b;
    -1 !== a
      ? ((b = Team.Names[a] + " team has won this round!"), (this.textBar.tint = Team.HexColors[a]))
      : ((b = "The rounded ended in a draw!"), (this.textBar.tint = 13421772));
    this.textBar.text = b;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar();
    this.actionTable.register(b);
  }
  displayTeamKilledBy(a) {
    this.textBar.tint = 16711680;
    this.textBar.text = "Teamkilled by " + a.name;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar();
  }
  displayTeamKilled(a) {
    this.textBar.tint = 16711680;
    this.textBar.text = "Warning! You teamkilled " + a.name;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar();
  }
  displayKilledBy(a, b) {
    this.textBar.tint = 16711680;
    this.textBar.text = "Killed by " + a.name;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar(b);
  }
  displayKilled(a, b) {
    this.textBar.tint = 65280;
    this.textBar.text = "You killed " + a.name;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar(b);
  }
  displaySuicide(a) {
    this.textBar.tint = 16711680;
    this.textBar.text = "You killed yourself!";
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.showTextBar(a);
  }
  displayCombo(a) {
    let b = "";
    switch (a) {
      case PlayerEvent.DOUBLE:
        b = "Double kill!";
        break;
      case PlayerEvent.TRIPLE:
        b = "Triple kill!";
        break;
      case PlayerEvent.QUAD:
        b = "Quadruple kill!";
        break;
      case PlayerEvent.PENTA:
        b = "Penta kill!";
        break;
      case PlayerEvent.MEGA:
        b = "Mega kill!";
        break;
      case PlayerEvent.MONSTER:
        b = "Monster kill!";
        break;
      case PlayerEvent.GOD:
        b = "Godlike!";
    }
    this.comboBar.tint = 16711680;
    this.comboBar.text = b;
    this.comboBar.x = 0.5 * (App.ClientWidth - this.comboBar.width);
    this.comboBar.visible = !0;
    this.showTextBar(!1);
  }
  showTextBar(a) {
    this.textBar.visible = !0;
    this.textBarTimeout && clearTimeout(this.textBarTimeout);
    this.textBarInterval && clearInterval(this.textBarInterval);
    this.textBar.alpha = 1;
    this.comboBar.alpha = 1;
    this.textBarTimeout = setTimeout(() => this.hideTextBar(), 2500);
    this.textBar._icon &&
      !1 !== a &&
      (this.textBar.removeChild(this.textBar._icon), (this.textBar._icon = null));
    if (a) {
      let b = a.width,
        c = a.height,
        d = b >= c ? (30 < b ? 30 / b : 1) : 30 < c ? 30 / c : 1;
      b === c && (d = 1);
      a.scale.x = a.scale.y = 0.9 * d;
      a.anchor.x = 0.5;
      a.anchor.y = 0.5;
      a.rotation = 1.9 * Math.PI;
      a.x = 0.5 * this.textBar.width;
      a.y = 54;
      this.textBar._icon = a;
      this.textBar.addChild(a);
    }
  }
  hideTextBar() {
    this.textBarInterval && clearInterval(this.textBarInterval);
    this.textBar.alpha = 1;
    this.comboBar.alpha = 1;
    this.textBarInterval = setInterval(() => this._reduceTextBarAlpha(), 100);
  }
  _reduceTextBarAlpha() {
    0.1 >= this.textBar.alpha
      ? ((this.textBar.visible = !1),
        (this.textBar.alpha = 1),
        (this.comboBar.alpha = 1),
        (this.comboBar.visible = !1),
        clearInterval(this.textBarInterval))
      : ((this.textBar.alpha -= 0.1), (this.comboBar.alpha -= 0.1));
  }
  addClient(a) {
    this.leaderboard.addClient(a);
  }
  removeClient(a) {
    this.leaderboard.removeClient(a);
  }
  cleanup() {
    UserInput.removeListener(UserInput.KEY_DOWN, this.onKeyDownListener);
    UserInput.removeListener(UserInput.KEY_UP, this.onKeyUpListener);
    this.textBarInterval && clearInterval(this.textBarInterval);
    this.textBarTimeout && clearTimeout(this.textBarTimeout);
    this.weaponMenuTimeout && clearTimeout(this.weaponMenuTimeout);
    this.leaderboardUpdateInterval && clearInterval(this.leaderboardUpdateInterval);
  }
  onFocus() {
    1200 > App.ClientWidth && 1e3 <= App.ClientWidth
      ? ((this.actionTable.scale.x = 0.8),
        (this.actionTable.scale.y = 0.8),
        (this.leaderboard.scale.x = 0.8),
        (this.leaderboard.scale.y = 0.8),
        (this.comboBar.scale.x = 0.8),
        (this.comboBar.scale.y = 0.8),
        (this.textBar.scale.x = 0.8),
        (this.textBar.scale.y = 0.8),
        (this.escapeMenu.scale.x = 0.8),
        (this.escapeMenu.scale.y = 0.8),
        (App.Console.scale.x = 0.7),
        (App.Console.scale.y = 0.7),
        (this.weaponMenu.scale.x = this.weaponMenu.scale.y = 0.8),
        (this.healthBar.scale.x = this.healthBar.scale.y = 0.6),
        (this.ammoBar.scale.x = this.ammoBar.scale.y = 0.6),
        (this.jetBar.scale.x = this.jetBar.scale.y = 0.6),
        (this.goldCount.scale.x = this.goldCount.scale.y = 0.6),
        (this.textBar.y = App.ClientHeight - 120),
        (this.healthBar.y = App.ClientHeight - 26),
        (this.ammoBar.y = App.ClientHeight - 26),
        (this.jetBar.y = App.ClientHeight - 26),
        (this.goldCount.y = App.ClientHeight - 26))
      : 1e3 > App.ClientWidth
      ? ((this.actionTable.scale.x = 0.74),
        (this.actionTable.scale.y = 0.74),
        (this.leaderboard.scale.x = 0.74),
        (this.leaderboard.scale.y = 0.74),
        (this.comboBar.scale.x = 0.74),
        (this.comboBar.scale.y = 0.74),
        (this.textBar.scale.x = 0.74),
        (this.textBar.scale.y = 0.74),
        (this.escapeMenu.scale.x = 0.74),
        (this.escapeMenu.scale.y = 0.74),
        (App.Console.scale.x = 0.64),
        (App.Console.scale.y = 0.64),
        (this.weaponMenu.scale.x = this.weaponMenu.scale.y = 0.74),
        (this.healthBar.scale.x = this.healthBar.scale.y = 0.45),
        (this.ammoBar.scale.x = this.ammoBar.scale.y = 0.45),
        (this.jetBar.scale.x = this.jetBar.scale.y = 0.45),
        (this.goldCount.scale.x = this.goldCount.scale.y = 0.45),
        (this.textBar.y = App.ClientHeight - 100),
        (this.healthBar.y = App.ClientHeight - 20),
        (this.ammoBar.y = App.ClientHeight - 20),
        (this.jetBar.y = App.ClientHeight - 20),
        (this.goldCount.y = App.ClientHeight - 20))
      : ((this.actionTable.scale.x = 1),
        (this.actionTable.scale.y = 1),
        (this.leaderboard.scale.x = 1),
        (this.leaderboard.scale.y = 1),
        (this.comboBar.scale.x = 1),
        (this.comboBar.scale.y = 1),
        (this.textBar.scale.x = 1),
        (this.textBar.scale.y = 1),
        (this.escapeMenu.scale.x = 1),
        (this.escapeMenu.scale.y = 1),
        (App.Console.scale.x = 1),
        (App.Console.scale.y = 1),
        (this.weaponMenu.scale.x = this.weaponMenu.scale.y = 1),
        (this.healthBar.scale.x = this.healthBar.scale.y = 0.6),
        (this.ammoBar.scale.x = this.ammoBar.scale.y = 0.6),
        (this.jetBar.scale.x = this.jetBar.scale.y = 0.6),
        (this.goldCount.scale.x = this.goldCount.scale.y = 0.6),
        (this.textBar.y = App.ClientHeight - 170),
        (this.healthBar.y = App.ClientHeight - 32),
        (this.ammoBar.y = App.ClientHeight - 32),
        (this.jetBar.y = App.ClientHeight - 32),
        (this.goldCount.y = App.ClientHeight - 32));
    this.helpImage.scale.x = App.Scale;
    this.helpImage.scale.y = App.Scale;
    this.damageGraphic.width = App.ClientWidth;
    this.damageGraphic.height = App.ClientHeight;
    this.actionTable.x = App.ClientWidth - this.actionTable.getWidth() - 12;
    this.gameoverDisplay.x = 0.5 * (App.ClientWidth - this.gameoverDisplay.getWidth());
    this.weaponMenu.x = 0.5 * (App.ClientWidth - this.weaponMenu.width);
    this.weaponMenu.y = 0.5 * (App.ClientHeight - this.weaponMenu.height);
    this.comboBar.x = 0.5 * (App.ClientWidth - this.comboBar.width);
    this.comboBar.y = App.ClientHeight - 90;
    this.textBar.x = 0.5 * (App.ClientWidth - this.textBar.width);
    this.leaderboard.x = 0.5 * (App.ClientWidth - this.leaderboard.width) + 40;
    this.leaderboard.y = 0.45 * (App.ClientHeight - this.leaderboard.height);
    this.actionTable.x =
      App.ClientWidth - this.actionTable.getWidth() * this.actionTable.scale.x - 12;
    this.escapeMenu.x = 0.5 * (App.ClientWidth - this.escapeMenu.width);
    this.escapeMenu.y = 0.5 * (App.ClientHeight - this.escapeMenu.height);
    this.healthBar.x = 20;
    this.jetBar.x = this.healthBar.x + this.healthBar.width + 20;
    this.ammoBar.x = this.jetBar.x + this.jetBar.width + 20;
    this.goldCount.x = this.ammoBar.x + this.ammoBar.width + 20;
    this.helpImage &&
      ((this.helpImage.x = 0.5 * App.ClientWidth), (this.helpImage.y = 0.5 * App.ClientHeight));
  }
  onUpdateEnvironment(a) {
    a.settings && this.jetBar.setMaxValue(a.settings.energy);
  }
}
function HudEvent(a, b) {
  CustomEvent.call(this, a, b);
}
HudEvent.SELECT_ITEM = "selectItem";
HudEvent.CHANGE_KEYBOARD_LAYOUT = "changeKeyboardLayout";
HudEvent.MUTE_SOUND = "muteSound";
HudEvent.EXIT = "exit";
HudEvent.LEADERBOARD_UPDATE = "leaderboardUpdate";
HudEvent.DISPLAY_PROFILE = "displayProfile";
HudEvent.CLOSE_WEAPON_MENU = "closeWeaponMenu";
function JetBar() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.barWidth = 262;
  this.barHeight = 36;
  this.maxValue = JetBar.MAX_VALUE;
  this.healthIcon = new PIXI.Sprite(App.CombinedTextures.energy_icon);
  this.healthIcon.x = 6;
  this.healthIcon.y = 2;
  this.addChild(this.healthIcon);
  this.background = new PIXI.Graphics();
  this.background.beginFill(3355443, 0.1);
  this.background.drawRect(0, 0, this.barWidth, this.barHeight);
  this.background.endFill();
  this.bar = new PIXI.Container();
  this.addChild(this.background);
  this.addChild(this.bar);
  this.numElements = 10;
  this.elements = [];
  for (var a = 0; a < this.numElements; a++) {
    var b = new PIXI.Sprite(App.CombinedTextures.jet_bar_element);
    b.x = 42 + 20 * a;
    b.y = 2;
    this.elements.push(b);
    this.bar.addChild(b);
  }
  this.margin = 4;
}
JetBar.prototype = Object.create(PIXI.Container.prototype);
JetBar.prototype.constructor = JetBar;
JetBar.MAX_VALUE = 200;
JetBar.prototype.setValue = function (a) {
  this.value = a;
  this.update();
};
JetBar.prototype.getValue = function () {
  return this.value;
};
JetBar.prototype.setMaxValue = function (a) {
  this.maxValue = a;
  this.setValue(this.maxValue);
};
JetBar.prototype.update = function () {
  for (
    var a = Math.ceil((this.numElements / this.maxValue) * this.value), b = 0;
    b < this.numElements;
    b++
  )
    this.elements[b].alpha = b < a ? 1 : 0.2;
};
JetBar.prototype.getWidth = function () {
  return this.barWidth;
};
JetBar.prototype.getHeight = function () {
  return this.barHeight;
};
function Minimap() {
  PIXI.Container.call(this);
}
Minimap.prototype = Object.create(PIXI.Container.prototype);
Minimap.prototype.constructor = Minimap;
Minimap.prototype.addObject = function (a) {};
class WeaponMenu extends PIXI.Graphics {
  constructor() {
    super();
    this.isEmpty = !0;
    this.beginFill(0, 0.3);
    this.drawRoundedRect(0, 0, 510, 480, 5, 5);
    this.endFill();
    this.primaryTitle = new PIXI.Text("Primary weapons", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16755200,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.primaryTitle.x = 26;
    this.primaryTitle.y = 16;
    this.addChild(this.primaryTitle);
    this.secondaryTitle = new PIXI.Text("Secondary weapons", {
      fontName: "Arial",
      fontSize: 22,
      fill: 16755200,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.secondaryTitle.x = 26;
    this.secondaryTitle.y = 290;
    this.addChild(this.secondaryTitle);
    this.closeButton = new PIXI.Sprite(App.CombinedTextures.exit);
    this.closeButton.x = this.width - 44;
    this.closeButton.y = 12;
    this.closeButton.interactive = !0;
    this.closeButton.on("mouseover", () => AudioEffects.ButtonHover.audio.play());
    this.closeButton.on("mousedown", () => {
      AudioEffects.ButtonClick.audio.play();
      this.emit(HudEvent.CLOSE_WEAPON_MENU);
    });
    this.closeButton.on("touchstart", () => {
      AudioEffects.ButtonClick.audio.play();
      this.emit(HudEvent.CLOSE_WEAPON_MENU);
    });
    this.addChild(this.closeButton);
    this.primaryItems = {};
    this.interactive = !0;
    this.essentialItemSelected = !1;
    this.primaryItemId = null;
    this.disabledCount = this.secondaryCount = this.primaryCount = 0;
    this.secondaryItems = {};
    this.secondaryItemSelected = !1;
    this.secondaryItemId = null;
    this.touchstart = function (c) {
      c.stopPropagation();
    };
    this.mousedown = function (c) {
      c.stopPropagation();
    };
    this.adblockEnabled = !0;
    App.WhiteLabel === App.WhiteLabel_NONE || App.AdblockDetected || (this.adblockEnabled = !1);
    if (this.adblockEnabled) {
      this.adblockTitle = new PIXI.Text("- Disable AdBlock to access all weapons -", {
        fontName: "Arial",
        fontSize: 22,
        fill: 16733440,
        strokeThickness: 3,
        lineJoin: "round",
      });
      this.adblockTitle.resolution = 1.5 * App.DevicePixelRatio;
      this.adblockTitle.x = 0.5 * (this.width - this.adblockTitle.width);
      this.adblockTitle.y = -24;
      this.addChild(this.adblockTitle);
      let c = Math.round(Date.now() / 6e5);
      var a = navigator.language || navigator.userLanguage,
        b = new Date().getTimezoneOffset() / 60;
      a += b.toString();
      for (b = 0; b < a.length; b++) c += a.charCodeAt(b);
      xorshift128_seed(c);
    }
  }
  addItem(a) {
    this.isEmpty = !1;
    let b = ItemMap[a].equip,
      c = new WeaponButton(a, b),
      d = { type: a, sprite: c, equip: b };
    c.on("touchstart", () => {
      c.enabled &&
        (this.emit(HudEvent.SELECT_ITEM, { itemId: a, equip: b }), this.selectItem(b, a));
    });
    c.on("mousedown", () => {
      c.enabled &&
        (this.emit(HudEvent.SELECT_ITEM, { itemId: a, equip: b }), this.selectItem(b, a));
    });
    b === ItemMap.Equip.PRIMARY
      ? ((this.primaryItems[d.type] = d), this.primaryCount++)
      : ((this.secondaryItems[d.type] = d), this.secondaryCount++);
  }
  rearrange() {
    var a = 0,
      b = 0;
    for (var c in this.primaryItems)
      this.primaryItems[c].parent && this.removeChild(this.primaryItems[c]);
    for (let d in this.secondaryItems)
      this.secondaryItems[d].parent && this.removeChild(this.secondaryItems[d]);
    for (let d in this.primaryItems)
      (c = this.primaryItems[d]),
        this.adblockEnabled &&
          this.disabledCount < this.primaryCount - 1 &&
          ((c.enabled = 1 === xorshift128() % 3),
          c.enabled || (this.disabledCount++, (c.sprite.enabled = !1), (c.sprite.alpha = 0.3))),
        this.addChild(c.sprite),
        (c.sprite.x = a + 50),
        (c.sprite.y = b + 75),
        (a += 96),
        480 <= a && ((a = 0), (b += 76));
    this.essentialItemSelected = !1;
    a = 0;
    for (let d in this.secondaryItems)
      (b = this.secondaryItems[d]),
        this.addChild(b.sprite),
        (b.sprite.x = ((96 * a) % 480) + 50),
        (b.sprite.y = 76 * Math.floor((a + 1) / 6) + 345),
        a++;
    this.secondaryItemSelected = !1;
  }
  selectItem(a, b) {
    AudioEffects.ButtonClick.audio.play();
    if (a === ItemMap.Equip.PRIMARY) {
      for (var c in this.primaryItems) {
        var d = this.primaryItems[c];
        c === b ? d.sprite.select() : d.sprite.deselect();
      }
      setTimeout(() => {
        this.visible = App.UIVisible = !1;
        this.parent && this.parent.removeChild(this);
      }, 100);
      this.essentialItemSelected = !0;
      this.primaryItemId = b;
    } else {
      for (d in this.secondaryItems)
        (c = this.secondaryItems[d]), d === b ? c.sprite.select() : c.sprite.deselect();
      this.essentialItemSelected &&
        setTimeout(() => {
          this.visible = App.UIVisible = !1;
          this.parent && this.parent.removeChild(this);
        }, 100);
      this.secondaryItemSelected = !0;
      this.secondaryItemId = b;
      0 === this.primaryCount &&
        setTimeout(() => {
          this.visible = App.UIVisible = !1;
          this.parent && this.parent.removeChild(this);
        }, 100);
    }
    0 === this.primaryCount && (this.essentialItemSelected = !0);
  }
}
class WeaponButton extends PIXI.Container {
  constructor(a, b) {
    super();
    this.itemId = a;
    this.equip = b;
    this.hover = !1;
    this.graphics = new PIXI.Graphics();
    this.graphics.beginFill(this.equip === ItemMap.Equip.SECONDARY ? 16763904 : 16777215, 0.4);
    this.graphics.drawRect(0, 0, 90, 70, 5);
    this.graphics.x = -30;
    this.graphics.y = -20;
    this.graphics.alpha = 0.5;
    this.addChild(this.graphics);
    this.lineGraphic = new PIXI.Graphics();
    this.lineGraphic.lineStyle(2, 16777215, 1);
    this.lineGraphic.drawRect(0, 0, 90, 70, 5);
    this.lineGraphic.x = -30;
    this.lineGraphic.y = -20;
    this.lineGraphic.alpha = 0.4;
    this.equip === ItemMap.Equip.SECONDARY && (this.lineGraphic.tint = 16763904);
    this.icon = new SpriteMap[a]();
    b = this.icon.width;
    let c = this.icon.height,
      d = b >= c ? (60 < b ? 60 / b : 1) : 40 < c ? 40 / c : 1;
    b === c && (d = 0.4);
    this.initialScale = 1.4 * d;
    this.icon.rotation = 0;
    this.icon.anchor.x = this.icon.anchor.y = 0;
    this.icon.scale.x = this.icon.scale.y = this.initialScale;
    this.icon.x = 0.5 * (60 - this.icon.width) - 16;
    this.icon.y = 15;
    this.icon.rotation = -0.2;
    this.addChild(this.icon);
    this.selected = !1;
    this.title = new PIXI.Text(ItemMap[a].title, {
      fontName: "Arial",
      fontSize: 16,
      fill: 16777215,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.title.resolution = 1.5 * App.DevicePixelRatio;
    this.title.x = -24;
    this.title.y = -18;
    this.addChild(this.title);
    82 < this.title.width && (this.title.scale.x = this.title.scale.y = 82 / this.title.width);
    this.enabled = this.interactive = !0;
    this.mouseover = this.onMouseOver.bind(this);
    this.mouseout = this.onMouseOut.bind(this);
  }
  onMouseOver(a) {
    this.addChildAt(this.lineGraphic, 1);
    this.lineGraphic.alpha = this.selected ? 0.7 : 0.4;
    this.graphics.alpha = 1;
    this.hover = !0;
    this.equip === ItemMap.Equip.SECONDARY && (this.graphics.tint = 16763904);
    this.scale.x = this.scale.y = 1.3;
    this.parent.setChildIndex(this, this.parent.children.length - 1);
    AudioEffects.ButtonHover.audio.play();
  }
  onMouseOut() {
    this.hover = !1;
    this.selected ? this.select() : (this.deselect(), (this.graphics.tint = 16777215));
    this.scale.x = this.scale.y = 1;
  }
  select() {
    this.selected = !0;
    this.graphics.alpha = 1;
    this.hover && (this.lineGraphic.alpha = 0.7);
  }
  deselect() {
    this.selected = !1;
    this.graphics.alpha = 0.5;
    this.hover ? (this.lineGraphic.alpha = 0.6) : (this.graphics.tint = 16777215);
    this.lineGraphic.parent && this.removeChild(this.lineGraphic);
  }
}
var gamemodes = {},
  GAME_MODES = {
    DEATHMATCH: "deathmatch",
    TEAM_DEATHMATCH: "teamDeathmatch",
    CAPTURE_THE_FLAG: "captureTheFlag",
    DODGEBALL: "dodgeball",
  };
var gameobject = {};
class GameObject {
  constructor(a) {
    this.id = a.id;
    this.p = a.p;
    this.g = a.g ?? {};
    this.p.id = a.id;
    this.audio = a.audio;
    this.contact = a.contact;
    this.visual = void 0;
  }
  update() {
    this.visual.x = this.p.x;
    this.visual.y = this.p.y;
    this.visual.rotation = this.p.r;
    this.visual.animate && this.visual.animate(this.p);
  }
}
var agent = {};
class Agent extends GameObject {
  constructor(a, b, c, d, e) {
    super({ id: a, p: { x: 0, y: 0, r: 0, vx: 0, vy: 0 } });
    this.visual = new PIXI.Container();
    this.animations = { _: !1 };
    this.prevFacing = this.facing = 0;
    this.health = 1;
    this.alive = !0;
    this.name = b;
    this.team = void 0 !== c ? c : -1;
    this.level = d;
    this.customization = e;
    this.onJet =
      this.onRequestHideChatBubble =
      this.onRequestDisplayChatBubble =
      this.onRequestRemoveEmitter =
      this.onRequestCreateEmitter =
      this.onRequestCreateEffect =
      this.onRequestCreateRope =
      this.extraRope =
      this.extra =
      this.bandana =
      this.face =
      this.energy =
        null;
    this.stateChangeMap = {
      [StateChange.Agent.ALIVE]: (f) => this.setAlive(f),
      [StateChange.Agent.TELEPORT]: (f) => this.teleport(f),
      [StateChange.Agent.JET_START]: () => this.startJetting(),
      [StateChange.Agent.JET_STOP]: () => this.stopJetting(),
      [StateChange.Agent.HEALTH]: (f) => this.setHealth(f),
      [StateChange.Item.RELOAD]: () => {},
      [StateChange.Item.EQUIP]: (f) => this.equip(f.t),
      [StateChange.Item.CARRY_PRIMARY]: (f) => this.carryPrimary(f.t),
      [StateChange.Item.CARRY_SECONDARY]: (f) => this.carrySecondary(f.t),
      [StateChange.Item.CARRY_BELT]: (f) => this.carryBelt(f.t),
      [StateChange.Item.DROP]: (f) => this.drop(f.t),
      [StateChange.Item.REMOVE_PRIMARY]: (f) => this.removePrimary(f),
      [StateChange.Item.REMOVE_SECONDARY]: (f) => this.removeSecondary(f),
      [StateChange.Item.REMOVE_BELT]: (f) => this.removBelt(f),
    };
  }
  init() {
    let a = 16777215,
      b = "energy_shell",
      c = "energy_trail_electric",
      d = Energy;
    this.customization &&
      (void 0 !== this.customization.orb &&
        (this.customization.orb.data &&
          void 0 !== this.customization.orb.data.energy &&
          (a = this.customization.orb.data.energy),
        this.customization.orb.cdata && void 0 !== this.customization.orb.cdata.custom
          ? ((d = Energy.Map[this.customization.orb.cdata.custom]),
            (b = "energy_shell_" + this.customization.orb.texture))
          : ((b = "energy_shell_" + this.customization.orb.texture),
            (c = "energy_trail_" + this.customization.orb.cdata.trail))),
      void 0 !== this.customization.face &&
        this.customization.face.cdata &&
        void 0 !== this.customization.face.cdata.custom &&
        (this.face = new CustomFace.Map[this.customization.face.cdata.custom](this)),
      void 0 !== this.customization.extra &&
        this.customization.extra.cdata &&
        void 0 !== this.customization.extra.cdata.custom &&
        (this.extra = Extra.Map[this.customization.extra.cdata.custom]));
    this.energy = new d(this, b, c, a);
  }
  applyState(a) {
    let b = this.stateChangeMap[a.s];
    return b ? b(a) : null;
  }
  setAnimations(a) {
    if (void 0 !== this.animations[Animation.CHAT]) {
      if (void 0 === a[Animation.CHAT]) this.onRequestHideChatBubble();
    } else if (void 0 !== a[Animation.CHAT]) this.onRequestDisplayChatBubble();
    this.animations = a;
    this.animations._ = !0;
  }
  equip(a) {}
  carryPrimary(a) {}
  carrySecondary(a) {}
  carryBelt(a) {}
  removePrimary(a) {}
  removeSecondary(a) {}
  removeBelt(a) {}
  drop(a) {}
  onSpawn() {
    null !== this.extra &&
      this.extra.prototype instanceof FastRope &&
      (this.extraRope = this.onRequestCreateRope(this, this.extra, this.torsoupper.id));
    ParticleEffects.BandanaRope.tex = "bandana_team_" + Team.Names[this.team];
    this.bandana = this.onRequestCreateRope(this, BandanaRope);
    null !== this.face &&
      (this.head.visual.addChild(this.face), this.addEmitter(this.face.emitter));
  }
  onDissolve() {
    this.bandana.alphaDrop = 0.01;
    this.bandana.ttl = 100;
    null !== this.extraRope && ((this.extraRope.ttl = 100), (this.extraRope.alphaDrop = 0.01));
  }
  update() {
    this.jetting && this.energy.update(this.torsolower.p);
    this.face && this.face.update(this.head.p);
  }
  setHealth(a) {
    this.health = a.v;
    a.exp && this.addInjury();
  }
  setAlive(a) {
    0 === a.v ? ((this.alive = !1), (this.health = 0)) : (this.alive = !0);
    return { i: a.id };
  }
  startJetting() {
    this.addEmitter(this.energy.emitter);
    this.jetting = !0;
    this.visual && !this.energy.parent && this.visual.parent.addChild(this.energy);
  }
  stopJetting() {
    this.jetting && this.removeEmitter(this.energy.emitter);
    this.jetting = !1;
    this.visual && this.energy.parent && this.visual.parent.removeChild(this.energy);
  }
  teleport(a) {
    var b = new ParticleEmitter(this.torsolower, [ParticleEffects.EnergyTrail]);
    b.frequency = 1;
    b.ttl = 100;
    this.onRequestCreateEmitter(b);
    b = new ParticleEmitter(a.from, [ParticleEffects.EnergyTrail]);
    b.frequency = 1;
    b.ttl = 100;
    this.onRequestCreateEmitter(b);
    a = new ParticleEmitter(a.to, [ParticleEffects.EnergyTrail]);
    a.frequency = 1;
    a.ttl = 100;
    this.onRequestCreateEmitter(a);
  }
  addEmitter(a) {
    if (this.onRequestCreateEmitter)
      if (Array.isArray(a)) for (let b = 0; b < a.length; b++) this.onRequestCreateEmitter(a[b]);
      else this.onRequestCreateEmitter(a);
  }
  removeEmitter(a) {
    if (this.onRequestRemoveEmitter)
      if (Array.isArray(a)) for (let b = 0; b < a.length; b++) this.onRequestRemoveEmitter(a[b]);
      else this.onRequestRemoveEmitter(a);
  }
}
var gameattribute = {};
function GameAttribute() {
  this.type = 0;
}
GameAttribute.SPAWN_PLAYER = 1;
GameAttribute.EMITTER = 2;
GameAttribute.BOUNDARY = 3;
GameAttribute.LETHAL = 4;
GameAttribute.DAMAGE = 5;
GameAttribute.HEAL = 6;
GameAttribute.ITEM = 7;
GameAttribute.REVOLUTE_JOINT = 8;
GameAttribute.WELD_JOINT = 9;
GameAttribute.GRAVITY_SCALE = 10;
GameAttribute.FLAG = 11;
GameAttribute.ACCELERATOR = 12;
GameAttribute.TELEPORT = 13;
GameAttribute.ANIMATION = 14;
GameAttribute.WAYPOINT = 15;
GameAttribute.INSERTION = 16;
GameAttribute.LABEL = 17;
GameAttribute.IMMORTAL = 18;
GameAttribute.FLUID = 19;
GameAttribute.TRANSFORM = 20;
GameAttribute.UV_TRANSLATE = 21;
GameAttribute.UV_ROTATE = 22;
GameAttribute.prototype.copyState = function (a) {
  void 0 !== a.type && (this.type = a.type);
};
GameAttribute.T_TRANSFORM = 1;
GameAttribute.T_FLUID = 2;
GameAttribute.T_UV_ROTATE = 4;
GameAttribute.T_UV_TRANSLATE = 8;
function EntityCategory() {}
EntityCategory = {
  STATIC_WORLD: 1,
  DYNAMIC_WORLD: 2,
  OPEN_WORLD: 4,
  BARRIER: 8,
  AGENT: 16,
  BULLET: 32,
  LIMB: 64,
  ITEM: 128,
  LOCAL: 256,
  ZONE: 512,
  ENTITY: 1024,
  GRENADE: 2048,
  BRIDGE: 4096,
  PARTICLE: 8192,
  OBJECTIVE: 16384,
  THROWN: 32768,
};
MaskBits = {};
MaskBits[EntityCategory.STATIC_WORLD] = 65535;
MaskBits[EntityCategory.DYNAMIC_WORLD] = 65535;
MaskBits[EntityCategory.OPEN_WORLD] = 0;
MaskBits[EntityCategory.BARRIER] =
  EntityCategory.STATIC_WORLD | EntityCategory.BULLET | EntityCategory.GRENADE;
MaskBits[EntityCategory.AGENT] =
  EntityCategory.DYNAMIC_WORLD |
  EntityCategory.STATIC_WORLD |
  EntityCategory.ITEM |
  EntityCategory.GRENADE |
  EntityCategory.BRIDGE;
MaskBits[EntityCategory.BULLET] =
  EntityCategory.LOCAL |
  EntityCategory.LIMB |
  EntityCategory.DYNAMIC_WORLD |
  EntityCategory.STATIC_WORLD |
  EntityCategory.BARRIER |
  EntityCategory.GRENADE |
  EntityCategory.ITEM |
  EntityCategory.THROWN;
MaskBits[EntityCategory.LIMB] = EntityCategory.BULLET | EntityCategory.GRENADE;
MaskBits[EntityCategory.ITEM] =
  EntityCategory.DYNAMIC_WORLD |
  EntityCategory.STATIC_WORLD |
  EntityCategory.AGENT |
  EntityCategory.BRIDGE |
  EntityCategory.BULLET |
  EntityCategory.GRENADE |
  EntityCategory.ITEM |
  EntityCategory.THROWN;
MaskBits[EntityCategory.LOCAL] =
  EntityCategory.BULLET | EntityCategory.LOCAL | EntityCategory.STATIC_WORLD;
MaskBits[EntityCategory.ZONE] = EntityCategory.ENTITY;
MaskBits[EntityCategory.ENTITY] = EntityCategory.ZONE | EntityCategory.OBJECTIVE;
MaskBits[EntityCategory.GRENADE] =
  EntityCategory.GRENADE |
  EntityCategory.DYNAMIC_WORLD |
  EntityCategory.BULLET |
  EntityCategory.STATIC_WORLD |
  EntityCategory.AGENT |
  EntityCategory.ITEM |
  EntityCategory.BARRIER |
  EntityCategory.LIMB;
MaskBits[EntityCategory.BRIDGE] =
  EntityCategory.STATIC_WORLD |
  EntityCategory.DYNAMIC_WORLD |
  EntityCategory.AGENT |
  EntityCategory.ITEM;
MaskBits[EntityCategory.PARTICLE] = EntityCategory.STATIC_WORLD;
MaskBits[EntityCategory.OBJECTIVE] =
  EntityCategory.STATIC_WORLD | EntityCategory.DYNAMIC_WORLD | EntityCategory.ENTITY;
MaskBits[EntityCategory.THROWN] =
  EntityCategory.STATIC_WORLD |
  EntityCategory.DYNAMIC_WORLD |
  EntityCategory.ITEM |
  EntityCategory.BULLET |
  EntityCategory.THROWN;
function Gold(a) {
  this.id = a.id;
  this.prefab = PrefabList.Gold;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: 1e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    contact: [this.id],
    gs: 0.3,
    wd: 4,
    bu: -5,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 4,
        h: 4,
        fr: 0.9,
        re: 2e-4,
        s: !1,
        d: 1,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Gold,
    onAdd: [],
    onRemove: [ParticleEffects.GoldPickupParticles],
    emitters: [
      new ParticleEmitter(null, [ParticleEffects.Glitter], { x: 0, y: 0 }, 4, 0, -1, 0.2, 8, 8),
      new ParticleEmitter(null, [ParticleEffects.GlitterTail], { x: 0, y: 0 }, 2, 0, -1, 1, 8, 8),
    ],
    animate: !0,
  };
  this.audio = Gold.Audio;
}
Gold.Audio = {
  onAdded: [AudioEffects.GoldPickup],
  onRemove: [AudioEffects.GoldPickup],
  onContact: [AudioEffects.GoldDrop],
};
function Bouncyball(a) {
  this.id = a.id;
  this.prefab = PrefabList.Bouncyball;
  this.p = {
    contact: [this.id],
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    fixedRotation: !1,
    sleepingAllowed: !0,
    wd: 5,
    bu: 20,
    sh: [
      {
        t: GameShape.CIRCLE,
        c: EntityCategory.ITEM,
        radius: 10.125,
        fr: 0.5,
        re: 0.7,
        s: !1,
        d: 0.3,
      },
    ],
  };
  a.p &&
    (a.p.x && (this.p.x = a.p.x),
    a.p.y && (this.p.y = a.p.y),
    a.p.vx && (this.p.vx = a.p.vx),
    a.p.vy && (this.p.vy = a.p.vy),
    a.p.gi && (this.p.gi = a.p.gi));
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Bouncyball,
    scale: { x: 0.34 * (a.l ? -1 : 1), y: 0.34 },
    offset: { x: 0.5, y: 0.5 },
    emitters: [],
  };
  this.audio = Bouncyball.Audio;
}
Bouncyball.Audio = { onContact: [AudioEffects.BallBounce] };
var gameshape = {};
GameShape = { BASE: 0, CIRCLE: 1, POLYGON: 2, RECTANGLE: 3 };
var flag = {};
function Flag(a) {
  this.id = a.id;
  this.prefab = PrefabList.Flag;
  this.team = a.team;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: -1,
    ld: 1,
    ad: 3,
    sh: Flag.Shapes,
    gs: 0.6,
    noCache: !0,
  };
  a.p &&
    (a.p.x && (this.p.x = a.p.x),
    a.p.y && (this.p.y = a.p.y),
    a.p.vx && (this.p.vx = a.p.vx),
    a.p.vy && (this.p.vy = a.p.vy),
    a.p.gi && (this.p.gi = a.p.gi));
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Flag,
    team: this.team,
    scale: { x: 0.25, y: 0.25 },
    offset: { x: 0.5, y: 0.5 },
    emitters: [new ParticleEmitter(null, [ParticleEffects.Flag1], { x: 0, y: 22 }, 4, 0, -1, 1)],
    z: 1,
    animate: !0,
  };
}
Flag.Sprites = Flag.Shapes = [
  {
    t: GameShape.RECTANGLE,
    c: EntityCategory.OBJECTIVE,
    radius: 20,
    w: 3,
    h: 20,
    fr: 0.1,
    re: 0.8,
    s: !1,
    d: 0.01,
  },
  {
    t: GameShape.CIRCLE,
    c: EntityCategory.OBJECTIVE,
    radius: 12,
    fr: 0.1,
    re: 0.8,
    s: !1,
    d: 0.01,
    o: { x: 0, y: 17 },
  },
  {
    t: GameShape.CIRCLE,
    c: EntityCategory.OBJECTIVE,
    radius: 3,
    fr: 0.1,
    re: 0.8,
    s: !1,
    d: 1,
    o: { x: 0, y: 25 },
  },
  {
    t: GameShape.CIRCLE,
    c: EntityCategory.ZONE,
    radius: 35,
    fr: 0.1,
    re: 0.6,
    s: !1,
    d: 1e-4,
    o: { x: 0, y: 0 },
  },
];
function AK47Ammo(a) {
  this.id = a.id;
  this.prefab = PrefabList.AK47Ammo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 6, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.AK47Ammo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = AK47Ammo.Audio;
}
AK47Ammo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function BarrettAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.BarrettAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 10,
        h: 6,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.BarrettAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = BarrettAmmo.Audio;
}
BarrettAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function ChainsawAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.ChainsawAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 7,
        h: 10,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ChainsawAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = ChainsawAmmo.Audio;
}
ChainsawAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function ClusterNadeBox(a) {
  this.id = a.id;
  this.prefab = PrefabList.ClusterNadeBox;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 10,
        h: 10,
        fr: 0.5,
        re: 0.6,
        s: !1,
        d: 0.5,
      },
    ],
    wd: 10,
    bu: -1,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ClusterNadeBox,
    onAdd: [ParticleEffects.ItemSpawnParticles],
    onRemove: [ParticleEffects.ClusterNadeParticles],
    animate: !0,
  };
  this.audio = ClusterNadeBox.Audio;
}
ClusterNadeBox.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.Powerup] };
function DesertEagleAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.DesertEagleAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 6, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.DesertEagleAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = DesertEagleAmmo.Audio;
}
DesertEagleAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function FlameThrowerAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.FlameThrowerAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 7,
        h: 11,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.FlameThrowerAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = FlameThrowerAmmo.Audio;
}
FlameThrowerAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function HealthBox(a) {
  this.id = a.id;
  this.prefab = PrefabList.HealthBox;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 10,
        h: 10,
        fr: 0.5,
        re: 0.6,
        s: !1,
        d: 0.5,
      },
    ],
    wd: 10,
    bu: -1,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.HealthBox,
    onAdd: [ParticleEffects.ItemSpawnParticles],
    onRemove: [ParticleEffects.HealParticles],
    animate: !0,
  };
  this.audio = HealthBox.Audio;
}
HealthBox.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.Powerup] };
function LaserGunAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.LaserGunAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 9, h: 6, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.LaserGunAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = LaserGunAmmo.Audio;
}
LaserGunAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function LinkGunAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.LinkGunAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 9.5,
        h: 7.5,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.LinkGunAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = LinkGunAmmo.Audio;
}
LinkGunAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function MAC10Ammo(a) {
  this.id = a.id;
  this.prefab = PrefabList.MAC10Ammo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 5, h: 8, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.MAC10Ammo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = MAC10Ammo.Audio;
}
MAC10Ammo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function MinigunAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.MinigunAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 10,
        h: 8,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.MinigunAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = MinigunAmmo.Audio;
}
MinigunAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function NadeBox(a) {
  this.id = a.id;
  this.prefab = PrefabList.NadeBox;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 10,
        h: 10,
        fr: 0.5,
        re: 0.6,
        s: !1,
        d: 0.5,
      },
    ],
    wd: 10,
    bu: -1,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.NadeBox,
    onAdd: [ParticleEffects.ItemSpawnParticles],
    onRemove: [ParticleEffects.NadeParticles],
    animate: !0,
  };
  this.audio = NadeBox.Audio;
}
NadeBox.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.Powerup] };
function NadeLauncherAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.NadeLauncherAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 6, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.NadeLauncherAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = NadeLauncherAmmo.Audio;
}
NadeLauncherAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function PulseGunAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.PulseGunAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 5, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.PulseGunAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = PulseGunAmmo.Audio;
}
PulseGunAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function RifleAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.RifleAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 9, h: 7, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.RifleAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = RifleAmmo.Audio;
}
RifleAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function RPGAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.RPGAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 16,
        h: 6,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.RPGAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = RPGAmmo.Audio;
}
RPGAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function ShockRifleAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.ShockRifleAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.RECTANGLE,
        c: EntityCategory.ITEM,
        w: 10,
        h: 5,
        fr: 0.9,
        re: 0.2,
        s: !1,
        d: 2,
      },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ShockRifleAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = ShockRifleAmmo.Audio;
}
ShockRifleAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function ShotgunAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.ShotgunAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 6, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ShotgunAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = ShotgunAmmo.Audio;
}
ShotgunAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function ShurikenBox(a) {
  this.id = a.id;
  this.prefab = PrefabList.ShurikenBox;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.POLYGON,
        c: EntityCategory.ITEM,
        v: [
          { x: -9, y: 9 },
          { x: 9, y: 9 },
          { x: 0, y: -9 },
        ],
        d: 0.5,
        fr: 0.5,
        re: 0.6,
        s: !1,
      },
    ],
    wd: 10,
    bu: -1,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ShurikenBox,
    onAdd: [ParticleEffects.ItemSpawnParticles],
    onRemove: [ParticleEffects.GoldPickupParticles],
    animate: !0,
  };
  this.audio = ShurikenBox.Audio;
}
ShurikenBox.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.Powerup] };
function SMGAmmo(a) {
  this.id = a.id;
  this.prefab = PrefabList.SMGAmmo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 8, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.SMGAmmo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = SMGAmmo.Audio;
}
SMGAmmo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function SnowballBox(a) {
  this.id = a.id;
  this.prefab = PrefabList.SnowballBox;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      {
        t: GameShape.POLYGON,
        c: EntityCategory.ITEM,
        v: [
          { x: -10, y: 10 },
          { x: 10, y: 10 },
          { x: 0, y: -10 },
        ],
        fr: 0.5,
        re: 0.6,
        s: !1,
        d: 0.5,
      },
    ],
    wd: 10,
    bu: -1,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.SnowballBox,
    onAdd: [ParticleEffects.ItemSpawnParticles],
    onRemove: [ParticleEffects.ItemSpawnParticles],
    animate: !0,
  };
  this.audio = SnowballBox.Audio;
}
SnowballBox.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.Powerup] };
function X75Ammo(a) {
  this.id = a.id;
  this.prefab = PrefabList.X75Ammo;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 5e3,
    fixedRotation: !1,
    sleepingAllowed: !0,
    sh: [
      { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 8, h: 6, fr: 0.9, re: 0.2, s: !1, d: 2 },
    ],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.X75Ammo,
    onAdd: [],
    onRemove: [ParticleEffects.AmmoPickupParticles],
    animate: !0,
  };
  this.audio = X75Ammo.Audio;
}
X75Ammo.Audio = { onAdded: [AudioEffects.ItemSpawn], onRemove: [AudioEffects.AmmoPickup] };
function AK47(a) {
  this.id = a.id;
  this.prefab = PrefabList.AK47;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: AK47.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.AK47,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = AK47.Audio;
}
AK47.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 18, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
AK47.Audio = { onContact: [AudioEffects.Tap] };
function Barrett(a) {
  this.id = a.id;
  this.prefab = PrefabList.Barrett;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Barrett.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Barrett,
    scale: { x: 0.26 * (a.l ? -1 : 1), y: 0.26 },
    offset: { x: 0.5, y: 0.5 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Barrett.Audio;
}
Barrett.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 22, h: 4, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
Barrett.Audio = { onContact: [AudioEffects.Tap] };
function Bow(a) {
  this.id = a.id;
  this.prefab = PrefabList.Bow;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Bow.Shapes,
    contact: [this.id],
    bu: 1,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Bow,
    scale: { x: 0.52 * (a.l ? -1 : 1), y: 0.52 },
    offset: { x: 0.5, y: 0.5 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Bow.Audio;
}
Bow.Shapes = [
  {
    t: GameShape.POLYGON,
    c: EntityCategory.ITEM,
    v: [
      { x: -20, y: 4 },
      { x: 20, y: 4 },
      { x: 0, y: -7 },
    ],
    fr: 0.7,
    re: 0.3,
    s: !1,
    d: 1,
  },
];
Bow.Audio = { onContact: [AudioEffects.Tap] };
function Carbine(a) {
  this.id = a.id;
  this.prefab = PrefabList.Carbine;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Carbine.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Carbine,
    scale: { x: 0.286 * (a.l ? -1 : 1), y: 0.286 },
    offset: { x: 0.5, y: 0.5 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Carbine.Audio;
}
Carbine.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 22, h: 4, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
Carbine.Audio = { onContact: [AudioEffects.Tap] };
function Chainsaw(a) {
  this.id = a.id;
  this.prefab = PrefabList.Chainsaw;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Chainsaw.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Chainsaw,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.5 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Chainsaw.Audio;
}
Chainsaw.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 18, h: 6, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
Chainsaw.Audio = { onContact: [AudioEffects.Tap] };
function DesertEagle(a) {
  this.id = a.id;
  this.prefab = PrefabList.DesertEagle;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: DesertEagle.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.DesertEagle,
    scale: { x: 0.25 * (a.l ? -1 : 1), y: 0.25 },
    offset: { x: 0.5, y: 0.3 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Rifle.Audio;
}
DesertEagle.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 7, h: 2, fr: 0.7, re: 0.3, s: !1, d: 5 },
];
DesertEagle.Audio = { onContact: [AudioEffects.Tap] };
function FlameThrower(a) {
  this.id = a.id;
  this.prefab = PrefabList.FlameThrower;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: FlameThrower.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.FlameThrower,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = FlameThrower.Audio;
}
FlameThrower.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 16, h: 8, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
FlameThrower.Audio = { onContact: [AudioEffects.Tap] };
function LaserGun(a) {
  this.id = a.id;
  this.prefab = PrefabList.LaserGun;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: LaserGun.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.LaserGun,
    scale: { x: 0.28 * (a.l ? -1 : 1), y: 0.28 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = LaserGun.Audio;
}
LaserGun.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 12, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
LaserGun.Audio = { onContact: [AudioEffects.Tap], checkAltContact: !0 };
function LinkGun(a) {
  this.id = a.id;
  this.prefab = PrefabList.LinkGun;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: LinkGun.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.LinkGun,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = LinkGun.Audio;
}
LinkGun.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 18, h: 6, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
LinkGun.Audio = { onContact: [AudioEffects.Tap] };
function MAC10(a) {
  this.id = a.id;
  this.prefab = PrefabList.MAC10;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: MAC10.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.MAC10,
    scale: { x: 0.28 * (a.l ? -1 : 1), y: 0.28 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = MAC10.Audio;
}
MAC10.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 12, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
MAC10.Audio = { onContact: [AudioEffects.Tap] };
function Minigun(a) {
  this.id = a.id;
  this.prefab = PrefabList.Minigun;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Minigun.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Minigun,
    scale: { x: 0.28 * (a.l ? -1 : 1), y: 0.28 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Minigun.Audio;
}
Minigun.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 22, h: 4, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
Minigun.Audio = { onContact: [AudioEffects.Tap] };
function NadeLauncher(a) {
  this.id = a.id;
  this.prefab = PrefabList.NadeLauncher;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: NadeLauncher.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.NadeLauncher,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = NadeLauncher.Audio;
}
NadeLauncher.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 20, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
NadeLauncher.Audio = { onContact: [AudioEffects.Tap] };
function PulseGun(a) {
  this.id = a.id;
  this.prefab = PrefabList.PulseGun;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: PulseGun.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.PulseGun,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = PulseGun.Audio;
}
PulseGun.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 12, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
PulseGun.Audio = { onContact: [AudioEffects.Tap] };
function Rifle(a) {
  this.id = a.id;
  this.prefab = PrefabList.Rifle;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Rifle.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Rifle,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Rifle.Audio;
}
Rifle.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 18, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
Rifle.Audio = { onContact: [AudioEffects.Tap] };
function RocketLauncher(a) {
  this.id = a.id;
  this.prefab = PrefabList.RocketLauncher;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: RocketLauncher.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.RocketLauncher,
    scale: { x: 0.24 * (a.l ? -1 : 1), y: 0.24 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = NadeLauncher.Audio;
}
RocketLauncher.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 20, h: 5, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
RocketLauncher.Audio = { onContact: [AudioEffects.Tap] };
function RPG(a) {
  this.id = a.id;
  this.prefab = PrefabList.RPG;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: RPG.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.RPG,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.6 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = RPG.Audio;
}
RPG.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 20, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
RPG.Audio = { onContact: [AudioEffects.Tap] };
function ShockRifle(a) {
  this.id = a.id;
  this.prefab = PrefabList.ShockRifle;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: ShockRifle.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ShockRifle,
    scale: { x: 0.25 * (a.l ? -1 : 1), y: 0.25 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = ShockRifle.Audio;
}
ShockRifle.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 18, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
ShockRifle.Audio = { onContact: [AudioEffects.Tap] };
function Shotgun(a) {
  this.id = a.id;
  this.prefab = PrefabList.Shotgun;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: Shotgun.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Shotgun,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = Shotgun.Audio;
}
Shotgun.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 18, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
Shotgun.Audio = { onContact: [AudioEffects.Tap] };
function SubmachineGun(a) {
  this.id = a.id;
  this.prefab = PrefabList.SubmachineGun;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: SubmachineGun.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.SubmachineGun,
    scale: { x: 0.36 * (a.l ? -1 : 1), y: 0.4 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = SubmachineGun.Audio;
}
SubmachineGun.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 12, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
SubmachineGun.Audio = { onContact: [AudioEffects.Tap] };
function X75(a) {
  this.id = a.id;
  this.prefab = PrefabList.X75;
  this.p = {
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    id: this.id,
    ttl: a.p.ttl || 1500,
    sh: X75.Shapes,
    contact: [this.id],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.X75,
    scale: { x: 0.28 * (a.l ? -1 : 1), y: 0.28 },
    offset: { x: 0.5, y: 0.4 },
    animate: !0,
    onContact: [ParticleEffects.SparkTrail2],
  };
  this.audio = X75.Audio;
}
X75.Shapes = [
  { t: GameShape.RECTANGLE, c: EntityCategory.ITEM, w: 20, h: 3, fr: 0.7, re: 0.3, s: !1, d: 1 },
];
X75.Audio = { onContact: [AudioEffects.Tap] };
var player = {};
class Player extends Agent {
  constructor(a, b, c, d, e, f, g) {
    super(a, b, c, d, e);
    this.g = { z: 10, onImpact: [], onAdd: [ParticleEffects.PlayerSpawn], animate: !0 };
    this.p.sub = !1;
    this.clanId = f;
    this.clanName = g;
    this.audio = Player.Audio;
    this.input = Player.Input;
    this.gearContainer = new PIXI.Container();
    this.gearContainer.scale.x = this.gearContainer.scale.y = 0.74;
    this.secondaryGearContainer = new PIXI.Container();
    this.secondaryGearContainer.rotation = 90;
    this.secondaryGearContainer.y = 10;
    this.primaryItem = null;
    this.facingDir = Player.FACING_LEFT;
    this.animations[
      this.facingDir === Player.FACING_LEFT ? Animation.HOLD_GUN_LEFT : Animation.HOLD_GUN_RIGHT
    ] = 0;
    this.facing = Math.PI;
    this.health = Player.FULL_HEALTH;
    this.hasTurned = !0;
    this.isLocal = !1;
    this.facingChanged = this.isPlayer = !0;
    this.lastInjuredTime = this.age = 0;
    this.head = new GameObject({
      id: this.id + "_head",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.torsoupper = new GameObject({
      id: this.id + "_torsoupper",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.torsolower = new GameObject({
      id: this.id + "_torsolower",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.armleftupper = new GameObject({
      id: this.id + "_armleftupper",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.armleftlower = new GameObject({
      id: this.id + "_armleftlower",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.armrightupper = new GameObject({
      id: this.id + "_armrightupper",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.armrightlower = new GameObject({
      id: this.id + "_armrightlower",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.legleftupper = new GameObject({
      id: this.id + "_legleftupper",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.legleftlower = new GameObject({
      id: this.id + "_legleftlower",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.legrightupper = new GameObject({
      id: this.id + "_legrightupper",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.legrightlower = new GameObject({
      id: this.id + "_legrightlower",
      p: { prefab: -1, x: 0, y: 0, r: 0, vx: 0, vy: 0 },
    });
    this.head.sensitivity = 1.5;
    this.torsoupper.sensitivity = 1;
    this.torsolower.sensitivity = 1;
    this.armleftupper.sensitivity = 0.8;
    this.armleftlower.sensitivity = 0.7;
    this.armrightupper.sensitivity = 0.8;
    this.armrightlower.sensitivity = 0.7;
    this.legleftupper.sensitivity = 0.8;
    this.legleftlower.sensitivity = 0.6;
    this.legrightupper.sensitivity = 0.8;
    this.legrightlower.sensitivity = 0.6;
    this.jetFuel = this.maxJetFuel = Player.ENERGY;
    this.proneRight = this.proneLeft = this.prone = this.crouching = this.jetting = !1;
    this.gearArmOffsetY =
      this.gearArmOffsetX =
      this.reloadCount =
      this.breathing =
      this.moveTimer =
      this.punchCount =
        0;
    this.gearArmRight = SpriteFactory.CreateSprite({
      type: Prefabs.ARM_RIGHTLOWER_SPRITE,
      customization: this.customization,
    });
    this.gearArmLeft = SpriteFactory.CreateSprite({
      type: Prefabs.ARM_LEFTLOWER_SPRITE,
      customization: this.customization,
    });
    this.gearArmRight.visible = !1;
    this.gearArmLeft.visible = !1;
    this.gearArmLeft.scale.x = -0.8;
    this.gearArmRight.scale.x = -0.8;
    this.gearArmLeft.scale.y = 0.8;
    this.gearArmRight.scale.y = 0.8;
    this.gearArmLeft.anchor.y = 0.9;
    this.gearArmRight.anchor.y = 0.9;
    this.gearArmLeft.y = 4;
    this.gearArmRight.y = -4;
    this._delay = 20;
    this.gearArmLeft.rotation = 1.6 * Math.PI;
    this.gearArmRight.rotation = 1.4 * Math.PI;
    this.gearContainer.addChild(this.gearArmRight);
    this.gearContainer.addChild(this.gearArmLeft);
    this.head.visual = SpriteFactory.CreateSprite({
      type: Prefabs.HEAD_SPRITE,
      team: Team.Names[c],
      teamIndex: c,
      customization: this.customization,
    });
    this.torsoupper.visual = SpriteFactory.CreateSprite({
      type: Prefabs.TORSO_UPPER_SPRITE,
      team: Team.Names[c],
      teamIndex: c,
      customization: this.customization,
    });
    this.torsoupper.audio = {
      onContact: [AudioEffects.LightThud],
      altContact: [AudioEffects.BodyImpact],
    };
    this.head.audio =
      this.torsolower.audio =
      this.armleftupper.audio =
      this.armleftlower.audio =
      this.armrightupper.audio =
      this.armrightlower.audio =
      this.legleftupper.audio =
      this.legleftlower.audio =
      this.legrightupper.audio =
      this.legrightlower.audio =
        { altContact: [AudioEffects.BodyImpact] };
    a = SpriteFactory.CreateSprite({
      type: Prefabs.TORSO_LOWER_SPRITE,
      customization: this.customization,
    });
    this.torsolower.visual = new PIXI.Container();
    this.torsolower.visual.scale.x = a.scale.x;
    this.torsolower.visual.scale.y = a.scale.y;
    a.scale.x = a.scale.y = 1;
    this.torsolower.visual.addChild(a);
    this.armleftupper.visual = SpriteFactory.CreateSprite({
      type: Prefabs.ARM_LEFTUPPER_SPRITE,
      customization: this.customization,
    });
    this.armleftlower.visual = SpriteFactory.CreateSprite({
      type: Prefabs.ARM_LEFTLOWER_SPRITE,
      customization: this.customization,
    });
    this.armrightupper.visual = SpriteFactory.CreateSprite({
      type: Prefabs.ARM_RIGHTUPPER_SPRITE,
      customization: this.customization,
    });
    this.armrightlower.visual = SpriteFactory.CreateSprite({
      type: Prefabs.ARM_RIGHTLOWER_SPRITE,
      customization: this.customization,
    });
    this.legleftupper.visual = SpriteFactory.CreateSprite({
      type: Prefabs.LEG_LEFTUPPER_SPRITE,
      customization: this.customization,
    });
    this.legleftlower.visual = SpriteFactory.CreateSprite({
      type: Prefabs.LEG_LEFTLOWER_SPRITE,
      customization: this.customization,
    });
    this.legrightupper.visual = SpriteFactory.CreateSprite({
      type: Prefabs.LEG_RIGHTUPPER_SPRITE,
      customization: this.customization,
    });
    this.legrightlower.visual = SpriteFactory.CreateSprite({
      type: Prefabs.LEG_RIGHTLOWER_SPRITE,
      customization: this.customization,
    });
    this.armleftupper.visual.scale.x = -0.26;
    this.armrightupper.visual.scale.x = -0.26;
    this.head.attached = !0;
    this.torsoupper.attached = !0;
    this.torsolower.attached = !0;
    this.armleftupper.attached = !0;
    this.armleftlower.attached = !0;
    this.armrightupper.attached = !0;
    this.armrightlower.attached = !0;
    this.legleftupper.attached = !0;
    this.legleftlower.attached = !0;
    this.legrightupper.attached = !0;
    this.legrightlower.attached = !0;
    this.ragdoll = {
      head: this.head,
      armrightlower: this.armrightlower,
      armrightupper: this.armrightupper,
      torsoupper: this.torsoupper,
      torsolower: this.torsolower,
      armleftlower: this.armleftlower,
      armleftupper: this.armleftupper,
      legrightlower: this.legrightlower,
      legrightupper: this.legrightupper,
      legleftlower: this.legleftlower,
      legleftupper: this.legleftupper,
    };
    this.bodyparts = [
      this.legleftlower,
      this.legleftupper,
      this.legrightlower,
      this.legrightupper,
      this.armleftupper,
      this.armleftlower,
      this.torsolower,
      this.torsoupper,
      this.head,
      this.armrightupper,
      this.armrightlower,
    ];
    this.torsoupper.visual.ref = this.head.visual;
    this.torsoupper.visual.addChild(this.gearContainer);
    this.torsolower.visual.addChildAt(this.secondaryGearContainer, 0);
    this.init();
  }
  init() {
    super.init();
  }
  equip(a) {
    super.equip();
    this.primaryItem && this.gearContainer.removeChild(this.primaryItem);
    this.primaryItem = SpriteFactory.CreateSprite({ type: a });
    this.primaryItem.gearArmOffset
      ? ((this.gearArmOffsetX = this.primaryItem.gearArmOffset.x),
        (this.gearArmOffsetY = this.primaryItem.gearArmOffset.y))
      : (this.gearArmOffsetY = this.gearArmOffsetX = 0);
    this.gearArmLeft.y = 4 + this.gearArmOffsetY;
    this.gearArmRight.y = -(4 + this.gearArmOffsetY);
    this.primaryItem.itemType = a;
    this.gearContainer.addChild(this.primaryItem);
    this.update(!0, !0);
    return null;
  }
  carryPrimary(a) {
    super.carryPrimary();
    this.alive && this.update(!0, !0);
    return null;
  }
  carrySecondary(a) {
    super.carrySecondary();
    this.secondaryItem = SpriteFactory.CreateSprite({ type: a });
    this.secondaryItem.itemType = a;
    this.secondaryItem.pivot.x = this.secondaryItem.pivot.y = 0.5;
    this.secondaryItem.secondaryRotation &&
      (this.secondaryItem.rotation = this.secondaryItem.secondaryRotation);
    this.secondaryItem.secondaryAnchor &&
      ((this.secondaryItem.anchor.x = this.secondaryItem.secondaryAnchor.x),
      (this.secondaryItem.anchor.y = this.secondaryItem.secondaryAnchor.y));
    this.secondaryItem.secondaryScale &&
      ((this.secondaryItem.scale.x = this.secondaryItem.secondaryScale.x),
      (this.secondaryItem.scale.y = this.secondaryItem.secondaryScale.y));
    this.secondaryGearContainer.removeChildren();
    this.secondaryGearContainer.addChild(this.secondaryItem);
    this.alive && this.update(!0, !0);
    return null;
  }
  carryBelt(a) {
    super.carryBelt();
    this.alive && this.update(!0, !0);
    return null;
  }
  removePrimary(a) {
    super.removePrimary();
    this.drop();
    this.alive && this.update(!0, !0);
    return null;
  }
  removeSecondary(a) {
    super.removeSecondary();
    this.secondaryGearContainer.removeChildren();
    this.alive && this.update(!0, !0);
    return null;
  }
  removeBelt(a) {
    super.removeBelt();
    this.alive && this.update(!0, !0);
    return null;
  }
  drop(a) {
    super.drop();
    this.gearContainer.removeChild(this.primaryItem);
    this.primaryItem = null;
    this.armleftlower.visual.alpha = 1;
    this.armrightlower.visual.alpha = 1;
    this.gearArmLeft.visible = !1;
    this.gearArmRight.visible = !1;
  }
  setHealth(a) {
    let b = Math.min(this.health - a.v, 100);
    0 > b
      ? this.removeInjuries(a.v === Player.FULL_HEALTH ? 1 : 0.03)
      : 0 < b && void 0 === a.bid && this.addInjury(null, 0.0025 * b);
    super.setHealth(a);
  }
  setAnimations(a) {
    super.setAnimations(a);
  }
  setLimbGoreTexture(a, b) {
    b.decal &&
      ((a = new PIXI.Sprite(b.decal)), (a.anchor.x = 0.5), (a.anchor.y = 0.5), b.addChild(a));
  }
  setAlive(a) {
    let b = super.setAlive(a);
    b.active = 0;
    if (a.amp) {
      var c = Player.AMP_TABLE[a.amp];
      let d;
      if ("_" === a.amp[0])
        (c = a.amp.substr(1)), (d = Player.AMP_TABLE[c]), (this.ragdoll[c].attached = !1);
      else {
        d = [];
        for (let e = 0, f = c.length; e < f; e++)
          if (0.5 < Math.random()) {
            d.push(c[e]);
            let g = Player.REV_AMP_TABLE[c[e]];
            for (let h = 0, k = g.length; h < k; h++)
              (this.ragdoll[g[h]].attached = !1),
                this.setLimbGoreTexture(g[h], this.ragdoll[g[h]].visual);
          }
      }
      0 < d.length && (b.detach = d);
    }
    a.bid && (b.bid = a.bid);
    this.stopJetting();
    this.armleftlower.visual.alpha = 1;
    this.armrightlower.visual.alpha = 1;
    this.armleftupper.visual.alpha = 1;
    this.armrightupper.visual.alpha = 1;
    return b;
  }
  addInjury(a, b) {
    var c = [];
    this.lastInjuredTime = App.Time;
    if (a) {
      b = this.ragdoll[a].visual;
      if (!b.injured) {
        b.injured = !0;
        var d = new PIXI.Sprite(App.CombinedTextures["injury" + (Math.round(Math.random()) + 1)]);
        d.decal = !0;
        d.anchor.x = 0.5;
        d.anchor.y = 0.5;
        d.scale.x = 0.3 + 0.3 * Math.random();
        d.scale.y = 0.3 + 0.3 * Math.random();
        d.y = -5 + 10 * Math.random();
        d.rotation = Math.random() * Math.PI * 2;
        b.addChild(d);
        0.2 > Math.random() && c.push(a);
      }
      if (0 < c.length) {
        a = [];
        for (let e = 0, f = c.length; e < f; e++)
          (b = this.ragdoll[c[e]]),
            b.emitter ||
              ((d = new ParticleEmitter(null, [
                this.p.sub ? ParticleEffects.BleedingInWater : ParticleEffects.Bleeding,
              ])),
              (d.parent = b),
              (d.probability = 0.05),
              (b.emitter = d),
              a.push(d));
        return a;
      }
    } else
      for (c = Math.ceil(11 * b), a = 0; a < c; a++)
        (b = this.bodyparts[Math.floor(11 * Math.random())].visual),
          b.injured ||
            ((b.injured = !0),
            (d = new PIXI.Sprite(App.CombinedTextures["injury" + (Math.round(Math.random()) + 1)])),
            (d.decal = !0),
            (d.anchor.x = 0.5),
            (d.anchor.y = 0.5),
            (d.scale.x = 0.3 + 0.3 * Math.random()),
            (d.scale.y = 0.3 + 0.3 * Math.random()),
            (d.y = -5 + 10 * Math.random()),
            (d.rotation = Math.random() * Math.PI * 2),
            b.addChild(d));
    return !1;
  }
  removeInjuries(a) {
    for (let b in this.ragdoll) {
      let c = this.ragdoll[b].visual;
      if (c.injured) {
        this.ragdoll[b].emitter &&
          ((this.ragdoll[b].emitter.ttl = 0), delete this.ragdoll[b].emitter);
        for (let d = 0, e = c.children.length; d < e; d++) {
          let f = c.children[d];
          !0 === f.decal &&
            (0.1 >= f.alpha ? ((c.injured = !1), c.removeChild(f), e--, d--) : (f.alpha -= a));
        }
      }
    }
  }
  hideLeftArm() {
    this.armleftlower.visual.alpha = 0;
    this.armrightlower.visual.alpha = 1;
    this.gearArmLeft.x = 70 + this.gearArmOffsetX;
    this.gearArmLeft.y = this.gearArmOffsetY;
    this.gearArmLeft.visible = !0;
    this.gearArmRight.visible = !1;
  }
  hideRightArm() {
    this.armrightlower.visual.alpha = 0;
    this.armleftlower.visual.alpha = 1;
    this.gearArmRight.x = 70 + this.gearArmOffsetX;
    this.gearArmRight.y = -this.gearArmOffsetY;
    this.gearArmLeft.visible = !1;
    this.gearArmRight.visible = !0;
  }
  update(a, b, c) {
    super.update();
    this.visual.x = this.p.x;
    this.visual.y = this.p.y;
    if (this.alive) {
      a && (this.hasTurned = !0);
      this.animations._ && this.updateBodyOrientation();
      a = this.facingDir === Player.FACING_LEFT;
      this.breathing += 0.07;
      this.breathDisplace = 0.4 * Math.sin(this.breathing);
      this.head.visual.x += this.breathDisplace;
      this.head.visual.y += this.breathDisplace;
      this.torsoupper.visual.x +=
        -this.breathDisplace - 1 * Math.sin(this.torsoupper.visual.rotation);
      if (this.hasTurned || c) {
        c && this.updateFacingDir(this.facing);
        var d = this.visual.parent.getChildIndex(this.armleftupper.visual),
          e = this.visual.parent.getChildIndex(this.armrightupper.visual);
        if (a) {
          this.secondaryGearContainer.rotation = 0.4 * Math.PI;
          this.secondaryGearContainer.x = -20;
          this.secondaryGearContainer.scale.y = 1.2;
          if (!b && d > e) {
            var f = this.head.visual.scale.x;
            this.head.visual.scale.x *= 0 < f ? -1 : 1;
            this.armleftlower.visual.scale.x *= 0 < f ? -1 : 1;
            this.armrightlower.visual.scale.x *= 0 < f ? -1 : 1;
            this.armleftupper.visual.scale.x = -0.26;
            this.armrightupper.visual.scale.x = -0.26;
            this.visual.parent.swapChildren(this.armleftupper.visual, this.armrightupper.visual);
            this.visual.parent.swapChildren(this.armleftlower.visual, this.armrightlower.visual);
            this.armleftupper.visual.z = e;
            this.armrightupper.visual.z = d;
            this.torsoupper.visual.sprite.scale.x = -1;
          }
          this.primaryItem && (this.primaryItem.pointLeft(), this.hideLeftArm());
        } else
          (this.secondaryGearContainer.rotation = 0.6 * Math.PI),
            (this.secondaryGearContainer.x = 20),
            (this.secondaryGearContainer.scale.y = -1.2),
            !b &&
              d < e &&
              ((f = this.head.visual.scale.x),
              (this.head.visual.scale.x *= 0 > f ? -1 : 1),
              (this.armleftlower.visual.scale.x *= 0 > f ? -1 : 1),
              (this.armrightlower.visual.scale.x *= 0 > f ? -1 : 1),
              (this.armleftupper.visual.scale.x = -0.26),
              (this.armrightupper.visual.scale.x = -0.26),
              this.visual.parent.swapChildren(this.armleftupper.visual, this.armrightupper.visual),
              this.visual.parent.swapChildren(this.armleftlower.visual, this.armrightlower.visual),
              (this.armleftupper.visual.z = e),
              (this.armrightupper.visual.z = d),
              (this.torsoupper.visual.sprite.scale.x = 1)),
            this.primaryItem && (this.primaryItem.pointRight(), this.hideRightArm());
      }
      if (!b) {
        this.primaryItem
          ? (void 0 !== this.animations[Animation.PRONE_LEFT]
              ? (this.proneLeft = this.prone = !0)
              : (this.proneRight =
                  void 0 !== this.animations[Animation.PRONE_RIGHT]
                    ? (this.prone = !0)
                    : (this.proneLeft = this.prone = !1)),
            this.alive
              ? this.prone
                ? this.proneLeft
                  ? (this.gearContainer.rotation = this.p.r - 0.65 * Math.PI - this.facing)
                  : this.proneRight &&
                    (this.gearContainer.rotation = this.p.r - 2.35 * Math.PI - this.facing)
                : (this.gearContainer.rotation = -this.facing)
              : (this.gearContainer.rotation = -this.gearContainer.parent.rotation - this.facing),
            (this.crouching = !0),
            this.prone
              ? void 0 !== this.animations[Animation.PRONE_SCOPE_LEFT]
                ? (this.primaryItem.customOffset ||
                    ((this.gearContainer.x = ProneScopeGunLeftAnimation.gearOffset.x + 35),
                    (this.gearContainer.y = ProneScopeGunLeftAnimation.gearOffset.y + 10)),
                  (this.armleftupper.visual.alpha = 0))
                : void 0 !== this.animations[Animation.PRONE_SCOPE_RIGHT] &&
                  (this.primaryItem.customOffset ||
                    ((this.gearContainer.x = ProneScopeGunRightAnimation.gearOffset.x - 35),
                    (this.gearContainer.y = ProneScopeGunRightAnimation.gearOffset.y + 10)),
                  (this.armrightupper.visual.alpha = 0))
              : (void 0 === this.animations[Animation.SCOPE_GUN_LEFT] ||
                this.primaryItem.customOffset
                  ? void 0 === this.animations[Animation.SCOPE_GUN_RIGHT] ||
                    this.primaryItem.customOffset
                    ? ((this.gearContainer.x = 0),
                      (this.gearContainer.y = 25),
                      (this.crouching = !1))
                    : ((this.gearContainer.x = ScopeGunRightAnimation.gearOffset.x),
                      (this.gearContainer.y = ScopeGunRightAnimation.gearOffset.y + 25))
                  : ((this.gearContainer.x = ScopeGunLeftAnimation.gearOffset.x),
                    (this.gearContainer.y = ScopeGunLeftAnimation.gearOffset.y + 25)),
                (this.armleftupper.visual.alpha = 1),
                (this.armrightupper.visual.alpha = 1)),
            (d = Math.abs(this.gearContainer.rotation + 0.5 * Math.PI)),
            (b = !1),
            d < 0.5 * Math.PI
              ? ((d = 0.5 * Math.PI - d), (b = !0))
              : (d = 0.5 * Math.PI - Math.abs(Math.PI - d)),
            (e = !1),
            this.primaryItem &&
              this.primaryItem.animateWhenUsing &&
              (this.primaryItem.applyDefaultTexture(),
              (this.gearArmOffsetX = this.primaryItem.gearArmOffset.x),
              (this.gearArmOffsetY = this.primaryItem.gearArmOffset.y),
              void 0 !== this.animations[Animation.SHOOT_BOW_LEFT] ||
                void 0 !== this.animations[Animation.SHOOT_BOW_RIGHT]) &&
              ((e = !0),
              c || this.primaryItem.animateUsage(!this.crouching),
              (this.gearArmOffsetX = this.primaryItem.gearArmOffsetAnimating.x),
              (this.gearArmOffsetY = this.primaryItem.gearArmOffsetAnimating.y),
              a
                ? (this.armleftupper.visual.rotation = 1.2 * this.facing + 1.4 * Math.PI)
                : (this.armrightupper.visual.rotation =
                    1.2 * this.facing + 1.41 * Math.PI + (b ? 0 : 1.25))),
            a
              ? (b
                  ? this.crouching
                    ? ((this.gearArmLeft.rotation = 1.5 * Math.PI - 0.05 * d),
                      (this.gearArmLeft.x = 70 + this.gearArmOffsetX),
                      (this.gearArmLeft.y = this.gearArmOffsetY),
                      this.primaryItem.customOffset || (this.primaryItem.x = 0),
                      e || (this.armleftupper.visual.rotation = -this.gearContainer.rotation - 1.8))
                    : ((this.gearArmLeft.x = 70 + 5 * d + this.gearArmOffsetX),
                      (this.gearArmLeft.y = this.gearArmOffsetY),
                      (this.primaryItem.x = 5 * d),
                      e
                        ? (this.gearArmLeft.rotation = 1.5 * Math.PI)
                        : ((this.armleftupper.visual.rotation = -this.gearContainer.rotation - 3),
                          (this.gearArmLeft.rotation = 1.5 * Math.PI - 0.15 * d)))
                  : ((this.gearArmLeft.x = 70 + this.gearArmOffsetX),
                    (this.gearArmLeft.y = this.gearArmOffsetY),
                    this.crouching
                      ? ((this.gearArmLeft.rotation = 1.5 * Math.PI + 0.05 * d),
                        e ||
                          (this.armleftupper.visual.rotation = -this.gearContainer.rotation - 1.8))
                      : e ||
                        ((this.armleftupper.visual.rotation = -this.gearContainer.rotation - 3),
                        (this.gearArmLeft.rotation = 1.5 * Math.PI + 0.1 * d))),
                this.prone && (this.gearArmLeft.rotation += 0.3))
              : (b
                  ? this.crouching
                    ? ((this.gearArmRight.rotation = -(0.5 * Math.PI - 0.05 * d)),
                      (this.gearArmRight.x = 70 + this.gearArmOffsetX),
                      (this.gearArmRight.y = -this.gearArmOffsetY),
                      this.primaryItem.customOffset || (this.primaryItem.x = 0),
                      e ||
                        (this.armrightupper.visual.rotation = -this.gearContainer.rotation - 1.3))
                    : ((this.gearArmRight.x = 70 + 5 * d + this.gearArmOffsetX),
                      (this.gearArmRight.y = -this.gearArmOffsetY),
                      (this.primaryItem.x = 5 * d),
                      e
                        ? (this.gearArmRight.rotation = 0.5 * -Math.PI)
                        : ((this.armrightupper.visual.rotation = -this.gearContainer.rotation),
                          (this.gearArmRight.rotation = -(0.5 * Math.PI - 0.15 * d))))
                  : ((this.gearArmRight.x = 70 + this.gearArmOffsetX),
                    (this.gearArmRight.y = -this.gearArmOffsetY),
                    this.crouching
                      ? ((this.gearArmRight.rotation = -(0.5 * Math.PI - 0.05 * d)),
                        e ||
                          (this.armrightupper.visual.rotation = -this.gearContainer.rotation - 1.3))
                      : e ||
                        ((this.armrightupper.visual.rotation = -this.gearContainer.rotation),
                        (this.gearArmRight.rotation = -(0.5 * Math.PI + -0.05 * d)))),
                this.prone && (this.gearArmRight.rotation -= 0.3)),
            void 0 !== this.animations[Animation.THROW_LEFT] ||
            void 0 !== this.animations[Animation.THROW_RIGHT]
              ? ((this.gearArmRight.visible = !1),
                (this.gearArmLeft.visible = !1),
                (this.armleftlower.visual.alpha = 1),
                (this.armrightlower.visual.alpha = 1))
              : c ||
                (void 0 !== this.animations[Animation.RELOAD_LEFT]
                  ? ((this.reloadCount += 0.05 + 0.1 * Math.random()),
                    (this.gearContainer.rotation += 0.07 * Math.cos(this.reloadCount)))
                  : void 0 !== this.animations[Animation.RELOAD_RIGHT]
                  ? ((this.reloadCount += 0.05 + 0.1 * Math.random()),
                    (this.gearContainer.rotation -= 0.07 * Math.cos(this.reloadCount)))
                  : (this.reloadCount = 0)),
            void 0 !== this.animations[Animation.SWITCH_LEFT]
              ? (this.gearContainer.rotation = -this.armrightupper.visual.rotation + 1 * Math.PI)
              : void 0 !== this.animations[Animation.SWITCH_RIGHT]
              ? (this.gearContainer.rotation = -this.armleftupper.visual.rotation)
              : this.prone
              ? a
                ? ((this.gearArmLeft.x -= 14), (this.gearContainer.rotation += 0.33 * Math.PI))
                : ((this.gearArmRight.x -= 14), (this.gearContainer.rotation -= 0.33 * Math.PI))
              : (this.gearContainer.rotation +=
                  this.gearContainer.parent.rotation - Math.PI - this.p.r + 0.5 * Math.PI))
          : (this.prone &&
              ((this.armleftupper.visual.alpha = 1), (this.armrightupper.visual.alpha = 1)),
            void 0 !== this.animations[Animation.PUNCH_LEFT] ||
            void 0 !== this.animations[Animation.PUNCH_RIGHT]
              ? 10 === this.punchCount++ &&
                (this.onRequestCreateEffect(ParticleEffects.FistRaycast, this),
                (this.punchCount = 0))
              : (this.punchCount = 0));
        if (this.jetting) {
          if ((0 <= this.jetFuel - 1 ? --this.jetFuel : (this.jetFuel = 0), this.isLocal))
            this.onJet(this, this.jetFuel);
        } else if (
          !this.input.RM &&
          this.jetFuel < Player.ENERGY &&
          ((this.jetFuel += 0.5), this.isLocal)
        )
          this.onJet(this, this.jetFuel);
        if (100 > this.age) {
          c = 50 < this.age ? 0.02 * (this.age - 50) : 0.05;
          for (let g in this.ragdoll) this.ragdoll[g].visual && (this.ragdoll[g].visual.alpha = c);
          this.bandana.alpha = c;
          this.extraRope && (this.extraRope.alpha = c);
          this.age++;
          if (100 === this.age) {
            for (let g in this.ragdoll)
              this.ragdoll[g].visual && (this.ragdoll[g].visual.alpha = 1);
            this.bandana.alpha = 1;
            this.extraRope && (this.extraRope.alpha = 1);
          }
          this.primaryItem &&
            (this.facingDir === Player.FACING_LEFT
              ? (this.armleftlower.visual.alpha = 0)
              : (this.armrightlower.visual.alpha = 0));
        }
      }
    }
  }
  updateFacingDir(a) {
    if (!(0 < this._delay--)) {
      var b = this.facingDir;
      a < Math.PI05 && a > -Math.PI05
        ? (this.prone && this.facingDir !== Player.FACING_LEFT && (this._delay = 10),
          (this.facingDir = Player.FACING_LEFT))
        : (this.prone && this.facingDir !== Player.FACING_RIGHT && (this._delay = 10),
          (this.facingDir = Player.FACING_RIGHT));
      this.hasTurned = b !== this.facingDir;
    }
  }
  updateBodyOrientation() {
    let a = this.animations,
      b,
      c = this.legleftlower.visual.scale.x;
    void 0 !== a[Animation.WALK_LEFT] || void 0 !== a[Animation.CROUCH_MOVE_LEFT]
      ? (this.moveTimer++,
        (this.secondaryGearContainer.rotation += 0.01 * Math.sin(0.2 * this.moveTimer)),
        (b = 0 > c ? 1 : -1))
      : void 0 !== a[Animation.WALK_RIGHT] || void 0 !== a[Animation.CROUCH_MOVE_RIGHT]
      ? (this.moveTimer++,
        (this.secondaryGearContainer.rotation += 0.01 * Math.sin(0.2 * this.moveTimer)),
        (b = 0 > c ? -1 : 1))
      : (b = this.facingDir === Player.FACING_LEFT ? (0 > c ? 1 : -1) : 0 > c ? -1 : 1);
    c * b !== c &&
      ((this.legleftlower.visual.scale.x *= b),
      (this.legleftupper.visual.scale.x *= b),
      (this.legrightlower.visual.scale.x *= b),
      (this.legrightupper.visual.scale.x *= b));
    a._ = !1;
  }
  getWeaponRotation() {
    return this.gearContainer.rotation - this.gearContainer.parent.rotation;
  }
  getPrimaryAnchor(a) {
    return this.primaryItem
      ? this.primaryItem.getAnchorTransform(a)
      : this.facingDir === Player.FACING_LEFT
      ? {
          x: this.armrightlower.visual.worldTransform.tx,
          y: this.armrightlower.visual.worldTransform.ty,
        }
      : {
          x: this.armleftlower.visual.worldTransform.tx,
          y: this.armleftlower.visual.worldTransform.ty,
        };
  }
  updateInput(a) {
    for (let b = 0, c = a.length; b < c; b += 2)
      this.input[a[b]] !== a[b + 1] && (this.input[a[b]] = a[b + 1]);
  }
  getOffset() {
    let a, b;
    this.prone
      ? ((a = this.facingDir === Player.FACING_LEFT ? -18 : 18), (b = 1))
      : this.crouching
      ? ((a = 0), (b = -7))
      : ((a = 0), (b = -12));
    return { x: a, y: b };
  }
}
Player.Audio = { onContact: [AudioEffects.Thud], onAdded: [AudioEffects.Spawn] };
Player.Input = {
  LM: { x: 0, y: 0, d: 0 },
  RM: 0,
  W: 0,
  A: 0,
  S: 0,
  D: 0,
  SP: 0,
  E: 0,
  F: 0,
  R: 0,
  X: 0,
  Q: 0,
};
Player.FACING_LEFT = 0;
Player.FACING_RIGHT = 1;
Player.FULL_HEALTH = 100;
Player.ENERGY = 200;
Player.AMP_TABLE = {
  head: ["neckjoint"],
  torsoupper: ["neckjoint", "torsojoint", "rightshoulderjoint", "leftshoulderjoint"],
  torsolower: ["torsojoint", "righthipjoint", "lefthipjoint"],
  armleftupper: ["leftshoulderjoint", "leftelbowjoint"],
  armleftlower: ["leftelbowjoint"],
  armrightupper: ["rightshoulderjoint", "rightelbowjoint"],
  armrightlower: ["rightelbowjoint"],
  legleftupper: ["lefthipjoint", "leftkneejoint"],
  legleftlower: ["leftkneejoint"],
  legrightupper: ["righthipjoint", "rightkneejoint"],
  legrightlower: ["rightkneejoint"],
  all: "neckjoint torsojoint rightshoulderjoint leftshoulderjoint rightelbowjoint leftelbowjoint righthipjoint lefthipjoint rightkneejoint leftkneejoint".split(
    " "
  ),
};
Player.REV_AMP_TABLE = {
  neckjoint: ["head", "torsoupper"],
  torsojoint: ["torsoupper", "torsolower"],
  rightshoulderjoint: ["armrightupper", "torsoupper"],
  leftshoulderjoint: ["armleftupper", "torsoupper"],
  rightelbowjoint: ["armrightlower", "armrightupper"],
  leftelbowjoint: ["armleftlower", "armleftupper"],
  righthipjoint: ["legrightupper", "torsolower"],
  lefthipjoint: ["legleftupper", "torsolower"],
  rightkneejoint: ["legrightlower", "legrightupper"],
  leftkneejoint: ["legleftlower", "legleftupper"],
};
var b2Body = Box2D.b2Body;
function TinyShrapnel(a) {
  this.id = a.id;
  this.type = PrefabList.TinyShrapnel;
  this.p = {
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    ld: 0,
    local: !0,
    allowSleep: !1,
    gs: 0.5,
    sh: [{ c: EntityCategory.PARTICLE, radius: 1, fr: 0.001, re: 0.5, s: !1 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.SmokeTrail1]);
  a.probability = 0.3;
  this.g = { type: PrefabList.TinyShrapnel, emitters: [a] };
}
function Prefab(a) {
  a &&
    a.p &&
    (a.p.x && (this.p.x = a.p.x),
    a.p.y && (this.p.y = a.p.y),
    a.p.vx && (this.p.vx = a.p.vx),
    a.p.vy && (this.p.vy = a.p.vy),
    a.p.vr && (this.p.vr = a.p.vr),
    a.p.gi && (this.p.gi = a.p.gi));
}
b2Body = Box2D.b2Body;
function AK47Bullet(a) {
  this.id = a.id;
  this.type = PrefabList.AK47Bullet;
  this.contact = { damage: 0.1 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.3,
    ricoAngle: 87,
    rico: 2,
    gs: 2,
    bu: -3,
    wd: 5,
    pen: 2,
    decay: 0.3,
    id: this.id,
    contact: [this.id],
    sh: AK47Bullet.Shapes,
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.TinyBulletTrail]);
  this.g = {
    type: PrefabList.AK47Bullet,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
  };
  this.audio = AK47Bullet.Audio;
}
AK47Bullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }];
AK47Bullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function Arrow(a) {
  this.id = a.id;
  this.type = PrefabList.Arrow;
  this.contact = { damage: 1 };
  this.p = {
    ttl: 500,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.7,
    ricoAngle: 80,
    rico: 0,
    pen: 0,
    wd: 4,
    bu: -1,
    decay: 0.5,
    gs: 2.5,
    id: this.id,
    contact: [this.id],
    track: !1,
    sh: [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.ArrowTrail]);
  this.g = {
    type: PrefabList.Arrow,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.ArrowImpactStatic],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
    onRemoveContact: [ParticleEffects.ArrowImpactDynamic],
  };
  this.audio = Arrow.Audio;
}
Arrow.Audio = { onContact: [AudioEffects.ArrowImpact], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function BarrettBullet(a) {
  this.id = a.id;
  this.type = PrefabList.BarrettBullet;
  this.contact = { damage: 0.75 };
  this.p = {
    ttl: 180,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.3,
    gs: 1,
    wd: 5,
    bu: -3,
    ricoAngle: 80,
    rico: 2,
    pen: 3,
    decay: 0.5,
    id: this.id,
    contact: [this.id],
    track: !0,
    sh: [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.BulletTrail]);
  this.g = {
    type: PrefabList.BarrettBullet,
    onContact: [
      ParticleEffects.SmallRicochet,
      ParticleEffects.LargeRicochet,
      ParticleEffects.SparkTrail1,
    ],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
  };
  this.audio = BarrettBullet.Audio;
}
BarrettBullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function CarbineBullet(a) {
  this.id = a.id;
  this.type = PrefabList.CarbineBullet;
  this.contact = { damage: 0 };
  this.p = {
    ttl: 180,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.3,
    ricoAngle: 80,
    gs: 1,
    wd: 5,
    bu: -3,
    rico: 2,
    pen: 0,
    decay: 0.5,
    id: this.id,
    contact: [this.id],
    track: !0,
    sh: [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }],
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.CarbineBullet,
    onContact: [
      ParticleEffects.SmallRicochet,
      ParticleEffects.LargeRicochet,
      ParticleEffects.SparkTrail1,
    ],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
  };
  this.audio = CarbineBullet.Audio;
}
CarbineBullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function DesertEagleBullet(a) {
  this.id = a.id;
  this.type = PrefabList.DesertEagleBullet;
  this.contact = { damage: 0.418 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.9,
    gs: 3,
    wd: 4,
    bu: -3,
    ricoAngle: 87,
    rico: 2,
    pen: 0,
    decay: 0.2,
    id: this.id,
    contact: [this.id],
    sh: DesertEagleBullet.Shapes,
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.TinyBulletTrail]);
  this.g = {
    type: PrefabList.DesertEagleBullet,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
  };
  this.audio = RifleBullet.Audio;
}
DesertEagleBullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }];
DesertEagleBullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function FlameThrowerLiquid(a) {
  this.id = a.id;
  this.type = PrefabList.FlameThrowerLiquid;
  this.contact = { damage: 1.6, triggerRatio: 0.01 };
  this.p = {
    ttl: 100,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !1,
    fixedRotation: !0,
    allowSleep: !1,
    gs: 1,
    id: this.id,
    ricoAngle: 0,
    rico: 5,
    wd: 100,
    pen: 100,
    decay: 0.99,
    knockback: 0.001,
    contact: [this.id],
    sh: FlameThrowerLiquid.Shapes,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.FlameThrowerLiquid,
    onContact: [ParticleEffects.FlameThrowerTrail],
    onAgentContact: [ParticleEffects.FlameBlast1, ParticleEffects.SmokeTrail1],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [new ParticleEmitter(null, [ParticleEffects.FlameThrowerTrail], null, 3, 0, -1, 1)],
    onImpact: [new ParticleEmitter(null, [ParticleEffects.FlameTrail2], null, 4, 1, 200, 0.2)],
  };
}
FlameThrowerLiquid.Shapes = [
  { c: EntityCategory.BULLET, radius: 10, d: 0.1, fr: 0.4, re: 0.01, minRestitution: !0 },
];
b2Body = Box2D.b2Body;
function LaserGunBullet(a) {
  this.id = a.id;
  this.type = PrefabList.LaserGunBullet;
  this.contact = { damage: 0.085 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.5,
    gs: 0,
    wd: 100,
    id: this.id,
    ricoAngle: 0,
    rico: 0,
    contact: [this.id],
    sh: LaserGunBullet.Shapes,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.LaserGunBullet,
    onContact: [ParticleEffects.TinyRicochet, ParticleEffects.GreenLaserImpact],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.GreenLaserImpact],
  };
  this.audio = LaserGunBullet.Audio;
}
LaserGunBullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 0.5, fr: 1, re: 1 }];
LaserGunBullet.Audio = { onContact: [AudioEffects.LaserGunImpact], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function LauncherNade(a) {
  this.id = a.id;
  this.prefab = PrefabList.LauncherNade;
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.2,
    gs: 2,
    ricoAngle: 82,
    rico: 3,
    wd: 2,
    bu: 2,
    id: this.id,
    explosive: { damage: 5, radius: 3, blast: 2 },
    contact: [this.id],
    sh: [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.5 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.LauncherNadeSparkTrail]);
  a.probability = 1;
  let b = new ParticleEmitter(null, [ParticleEffects.LauncherNadeSmokeTrail]);
  this.g = {
    type: PrefabList.LauncherNade,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail1],
    onRemove: [
      ParticleEffects.NadeExplosionSmoke,
      ParticleEffects.NadeExplosionParticles,
      ParticleEffects.TinyShrapnel,
      ParticleEffects.LauncherNadeExplosion,
      ParticleEffects.NadeShockWave,
    ],
    emitters: [a, b],
  };
  this.audio = LauncherNade.Audio;
}
LauncherNade.Audio = { onRemove: [AudioEffects.ExplosionNadeLauncher] };
b2Body = Box2D.b2Body;
function MAC10Bullet(a) {
  this.id = a.id;
  this.type = PrefabList.MAC10Bullet;
  this.contact = { damage: 0.25 };
  this.p = {
    ttl: 25,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 10,
    wd: 15,
    bu: 0,
    gs: 1,
    id: this.id,
    rico: 0,
    contact: [this.id],
    sh: MAC10Bullet.Shapes,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.MAC10Bullet,
    onContact: [ParticleEffects.TinyRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
  };
  this.audio = MAC10Bullet.Audio;
}
MAC10Bullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 0.1, fr: 0.99, re: 0.2 }];
MAC10Bullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function MinigunBullet(a) {
  this.id = a.id;
  this.type = PrefabList.MinigunBullet;
  this.contact = { damage: 0.15 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.5,
    gs: 1.2,
    wd: 5,
    bu: -3,
    id: this.id,
    ricoAngle: 85,
    rico: 1,
    contact: [this.id],
    sh: MinigunBullet.Shapes,
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.TinyBulletTrail]);
  this.g = {
    type: PrefabList.MinigunBullet,
    onContact: [ParticleEffects.TinyRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
  };
  this.audio = MinigunBullet.Audio;
}
MinigunBullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.99, re: 0.2 }];
MinigunBullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function PulseGunBullet(a) {
  this.id = a.id;
  this.type = PrefabList.PulseGunBullet;
  this.contact = { damage: 0.4 };
  this.p = {
    ttl: 80,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    update: PulseGunBullet.Update,
    gs: 0,
    id: this.id,
    ricoAngle: 0,
    wd: 5,
    rico: 3,
    knockback: 5,
    contact: [this.id],
    sh: PulseGunBullet.Shapes,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.PulseGunBullet,
    onContact: [
      ParticleEffects.TinyRicochet,
      ParticleEffects.FlameBlast1,
      ParticleEffects.SmokeTrail1,
    ],
    onAgentContact: [ParticleEffects.FlameBlast1, ParticleEffects.SmokeTrail1],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [new ParticleEmitter(null, [ParticleEffects.PulseGunOrbTrail])],
  };
  this.audio = PulseGunBullet.Audio;
}
PulseGunBullet.Update = (a) => {
  var b = a.body.GetLinearVelocity();
  let c = a.ref.sub ? 60 : 120;
  b.x * b.x + b.y * b.y < c * c &&
    ((b = Math.atan2(b.y, b.x)),
    a.body.SetLinearVelocity({ x: c * Math.cos(b), y: c * Math.sin(b) }));
};
PulseGunBullet.Shapes = [{ c: EntityCategory.BULLET, radius: 5, d: 2, fr: 0, re: 1 }];
PulseGunBullet.Audio = { onContact: [AudioEffects.PulseGunImpact], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function RifleBullet(a) {
  this.id = a.id;
  this.type = PrefabList.RifleBullet;
  this.contact = { damage: 0.1 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.3,
    ricoAngle: 87,
    rico: 2,
    wd: 5,
    bu: -3,
    pen: 2,
    decay: 0.3,
    id: this.id,
    contact: [this.id],
    sh: RifleBullet.Shapes,
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.TinyBulletTrail]);
  this.g = {
    type: PrefabList.RifleBullet,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
  };
  this.audio = RifleBullet.Audio;
}
RifleBullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }];
RifleBullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function RLRocket(a) {
  this.id = a.id;
  this.prefab = PrefabList.RLRocket;
  this.p = {
    ttl: 150,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    continuous: !0,
    ld: 0.2,
    gs: 0,
    ricoAngle: 82,
    update: RLRocket.Update,
    fuel: 150,
    rico: 5,
    wd: 5,
    id: this.id,
    explosive: { damage: 3.5, radius: 3, blast: 1 },
    contact: [this.id],
    sh: [{ c: EntityCategory.BULLET, radius: 1, d: 2, fr: 0.001, re: 0.2 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.RLRocketSmokeTrail]);
  let b = new ParticleEmitter(null, [ParticleEffects.RLRocketFlameTrail]);
  b.probability = 1;
  this.g = {
    type: PrefabList.RLRocket,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail1],
    onRemove: [
      ParticleEffects.RLSmoke,
      ParticleEffects.RLNadeExplosion,
      ParticleEffects.NadeShockWave,
    ],
    emitters: [a, b],
  };
  this.audio = RLRocket.Audio;
}
RLRocket.Update = (a) => {
  if (!(0 >= a.ref.fuel)) {
    a.ref.fuel--;
    var b = a.body.GetAngle();
    a.body.ApplyForce({ x: 2 * Math.cos(b), y: 2 * Math.sin(b) }, a.body.GetWorldCenter());
  }
};
RLRocket.Audio = { onRemove: [AudioEffects.RLImpact], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function RPGRocket(a) {
  this.id = a.id;
  this.prefab = PrefabList.RPGRocket;
  this.p = {
    ttl: 240,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.2,
    gs: 5,
    ricoAngle: 82,
    update: RPGRocket.Update,
    wd: 3,
    bu: 10,
    rico: 3,
    id: this.id,
    explosive: { damage: 5, radius: 3, blast: 2 },
    contact: [this.id],
    sh: [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.5 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.RPGFlameTrail]);
  a.probability = 1;
  let b = new ParticleEmitter(null, [ParticleEffects.RPGNadeSmokeTrail]);
  this.g = {
    type: PrefabList.RPGRocket,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail1],
    onRemove: [
      ParticleEffects.NadeExplosionSmoke,
      ParticleEffects.NadeExplosionParticles,
      ParticleEffects.TinyShrapnel,
      ParticleEffects.LauncherNadeExplosion,
      ParticleEffects.NadeShockWave,
    ],
    emitters: [a, b],
  };
  this.audio = RPGRocket.Audio;
}
RPGRocket.Update = (a) => {
  let b = a.body.GetAngle();
  a.body.ApplyForce({ x: 3 * Math.cos(b), y: 3 * Math.sin(b) }, a.body.GetWorldCenter());
};
RPGRocket.Audio = { onRemove: [AudioEffects.ExplosionNadeLauncher], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function ShockRifleBullet(a) {
  this.id = a.id;
  this.type = PrefabList.ShockRifleBullet;
  this.contact = { damage: 10, constant: !0 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    update: ShockRifleBullet.Update,
    ld: 0,
    gs: 0,
    wd: 5,
    bu: 0,
    ricoAngle: 50,
    rico: 1,
    pen: 50,
    decay: 1,
    knockback: 10,
    id: this.id,
    contact: [this.id],
    sh: [{ c: EntityCategory.BULLET, radius: 5 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.Electricity1]);
  var b = new ParticleEmitter(null, [ParticleEffects.Electricity2]);
  b.probability = 1;
  this.g = {
    type: PrefabList.ShockRifleBullet,
    onContact: [new ParticleEmitter(null, [ParticleEffects.Electricity1], null, 1, 1, 200, 0.2)],
    onImpact: [new ParticleEmitter(null, [ParticleEffects.Electricity1], null, 1, 1, 200, 0.2)],
    onRemove: [ParticleEffects.ShockRifleOrbImpact],
    emitters: [a, b],
  };
  this.audio = ShockRifleBullet.Audio;
}
ShockRifleBullet.Update = (a) => {
  var b = a.body.GetLinearVelocity();
  let c = a.ref.sub ? 30 : 60;
  b.x * b.x + b.y * b.y < c * c &&
    ((b = Math.atan2(b.y, b.x)),
    a.body.SetLinearVelocity({ x: c * Math.cos(b), y: c * Math.sin(b) }));
};
ShockRifleBullet.Audio = { onContact: [AudioEffects.LaserImpact1] };
b2Body = Box2D.b2Body;
function ShotgunPellet(a) {
  this.type = PrefabList.ShotgunPellet;
  this.id = a.id;
  this.contact = ShotgunPellet.Contact;
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.4,
    gs: 2,
    wd: 5,
    bu: -3,
    ricoAngle: 85,
    rico: 2,
    pen: 2,
    decay: 0.3,
    id: this.id,
    contact: [this.id],
    sh: ShotgunPellet.Shapes,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ShotgunPellet,
    onContact: [ParticleEffects.TinyRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
  };
  this.audio = ShotgunPellet.Audio;
}
ShotgunPellet.Contact = { damage: 0.1 };
ShotgunPellet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.1, re: 0.2 }];
ShotgunPellet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function SubmachineGunBullet(a) {
  this.id = a.id;
  this.type = PrefabList.SubmachineGunBullet;
  this.contact = { damage: 0.357 };
  this.p = {
    ttl: 350,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ld: 0.5,
    gs: 1.2,
    wd: 5,
    bu: -3,
    id: this.id,
    ricoAngle: 85,
    rico: 1,
    contact: [this.id],
    sh: SubmachineGunBullet.Shapes,
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.TinyBulletTrail]);
  this.g = {
    type: PrefabList.SubmachineGunBullet,
    onContact: [ParticleEffects.TinyRicochet, ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    emitters: [a],
  };
  this.audio = SubmachineGunBullet.Audio;
}
SubmachineGunBullet.Shapes = [{ c: EntityCategory.BULLET, radius: 2, d: 2, fr: 0.99, re: 0.2 }];
SubmachineGunBullet.Audio = { onContact: [AudioEffects.Rico], checkAltContact: !0 };
b2Body = Box2D.b2Body;
function X75Nade(a) {
  this.id = a.id;
  this.prefab = PrefabList.X75Nade;
  this.p = {
    ttl: 60,
    prefab: ShapeOptions.CIRCLE,
    type: Box2D.b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !0,
    allowSleep: !1,
    ignoreExp: !0,
    ld: 0.5,
    fr: 0.999,
    gs: 0,
    re: 0.001,
    wd: 1,
    bu: 6,
    id: this.id,
    explosive: { damage: 6, radius: 2, blast: 1.5, mod: "x75" },
    contact: [this.id],
    sh: [{ c: EntityCategory.BULLET, radius: 10, d: 0.05, fr: 0.999, ld: 2, re: 0.001 }],
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.X75NadeSparkTrail]);
  a.probability = 1;
  this.g = {
    type: PrefabList.X75Nade,
    onContact: [ParticleEffects.SmallRicochet, ParticleEffects.SparkTrail1],
    onRemove: [
      ParticleEffects.PlasmaNadeExplosion,
      ParticleEffects.NadeShockWave,
      ParticleEffects.X75NadeShrapnel,
    ],
    emitters: [a],
  };
  this.audio = X75Nade.Audio;
}
X75Nade.Audio = { onRemove: [AudioEffects.X75Impact] };
b2Body = Box2D.b2Body;
function ClusterNade(a) {
  this.id = a.id;
  this.type = PrefabList.ClusterNade;
  this.p = {
    ttl: 100,
    prime: 98,
    prefab: ShapeOptions.CIRCLE,
    type: b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !1,
    ld: 0.3,
    id: this.id,
    explosive: { damage: 3, radius: 3, blast: 0 },
    sh: [{ c: EntityCategory.THROWN, radius: 3.9, d: 4, fr: 0.1, re: 0.6 }],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ClusterNade,
    onContact: [ParticleEffects.SparkTrail2],
    onRemove: [
      ParticleEffects.ClusterNadeExplosionSmoke,
      ParticleEffects.NadeExplosionParticles,
      ParticleEffects.TinyShrapnel,
      ParticleEffects.ClusterNadeExplosion,
    ],
  };
  this.audio = ClusterNade.Audio;
}
ClusterNade.Audio = { onAdded: [AudioEffects.Throw], onRemove: [AudioEffects.ExplosionCluster] };
b2Body = Box2D.b2Body;
function ClusterNadeFragment(a) {
  this.id = a.id;
  this.type = PrefabList.ClusterNadeFragment;
  this.udContact = !0;
  this.p = {
    ttl: 160,
    prefab: ShapeOptions.CIRCLE,
    type: b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !1,
    ld: 0.05,
    instant: !0,
    ignoreExp: !0,
    id: this.id,
    gs: 2,
    explosive: { damage: 4, radius: 2, blast: 1.8 },
    sh: [{ c: EntityCategory.BULLET, radius: 1.5, d: 4, fr: 0.1, re: 0.6 }],
    bu: -1,
    wd: 2,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ClusterNadeFragment,
    onRemove: [
      ParticleEffects.ClusterNadeExplosionSmoke,
      ParticleEffects.NadeExplosionParticles,
      ParticleEffects.TinyShrapnel,
      ParticleEffects.ClusterNadeExplosion,
      ParticleEffects.NadeShockWave,
    ],
  };
  this.audio = ClusterNadeFragment.Audio;
}
ClusterNadeFragment.Audio = { onRemove: [AudioEffects.ExplosionCluster] };
b2Body = Box2D.b2Body;
function Nade(a) {
  this.id = a.id;
  this.type = PrefabList.Nade;
  this.p = {
    ttl: 220,
    prime: 218,
    prefab: ShapeOptions.CIRCLE,
    type: b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !1,
    ld: 0.3,
    contact: [this.id],
    id: this.id,
    explosive: { damage: 5, radius: 4.25, blast: 2 },
    sh: [{ c: EntityCategory.THROWN, radius: 3.9, d: 4, fr: 0.1, re: 0.6 }],
    bu: -5,
    wd: 4,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.Nade,
    onContact: [ParticleEffects.SparkTrail2],
    onRemove: [
      ParticleEffects.NadeExplosionSmoke,
      ParticleEffects.NadeExplosionParticles,
      ParticleEffects.TinyShrapnel,
      ParticleEffects.NadeExplosion,
      ParticleEffects.NadeShockWave,
    ],
  };
  this.audio = Nade.Audio;
}
Nade.Audio = {
  onAdded: [AudioEffects.Throw],
  onContact: [AudioEffects.HeavyThud],
  onRemove: [AudioEffects.ExplosionNade],
};
b2Body = Box2D.b2Body;
function ShurikenBlade(a) {
  this.id = a.id;
  this.type = PrefabList.ShurikenBlade;
  this.p = {
    ttl: 500,
    prime: 499,
    prefab: ShapeOptions.COMPOUND,
    type: b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !1,
    id: this.id,
    contact: [this.id],
    wd: 3,
    bu: 0,
    ad: 0.5,
    sh: [
      {
        t: GameShape.POLYGON,
        c: EntityCategory.THROWN,
        v: [
          { x: -5, y: 5 },
          { x: 5, y: 5 },
          { x: 0, y: -5 },
        ],
        radius: 3.9,
        d: 4,
        fr: 0.8,
        re: 0.1,
      },
    ],
    contactInterval: 750,
    lastContactCheck: 0,
  };
  Prefab.call(this, a);
  this.g = {
    type: PrefabList.ShurikenBlade,
    onContact: [ParticleEffects.SparkTrail2],
    onAgentContact: [ParticleEffects.Bloodsplat1, ParticleEffects.Bloodsplat3],
    onAgentContactSubmerged: [ParticleEffects.GoreTrailWater],
    onRemove: [],
  };
  this.audio = ShurikenBlade.Audio;
}
ShurikenBlade.Audio = {
  onAdded: [AudioEffects.Throw],
  onContact: [AudioEffects.ShurikenDrop],
  checkAltContact: !0,
};
b2Body = Box2D.b2Body;
function SnowballProjectile(a) {
  this.id = a.id;
  this.type = PrefabList.SnowballProjectile;
  this.p = {
    ttl: 600,
    prime: 597,
    prefab: ShapeOptions.CIRCLE,
    type: b2BodyType.b2_dynamicBody,
    bullet: !0,
    fixedRotation: !1,
    ld: 0.3,
    id: this.id,
    contact: [this.id],
    sh: [{ c: EntityCategory.THROWN, radius: 3.5, d: 4, fr: 0.1, re: 0.6 }],
    wd: 100,
  };
  Prefab.call(this, a);
  a = new ParticleEmitter(null, [ParticleEffects.SnowballTrail]);
  a.probability = 0.2;
  this.g = {
    type: PrefabList.SnowballProjectile,
    onContact: [ParticleEffects.SnowPuff],
    onAgentContact: [ParticleEffects.SnowPuff],
    onRemove: [ParticleEffects.SnowPuff],
    emitters: [a],
    hideOnContact: !1,
  };
  this.audio = SnowballProjectile.Audio;
}
SnowballProjectile.Audio = {
  onAdded: [AudioEffects.Throw],
  onContact: [AudioEffects.SnowballImpact],
  checkAltContact: !1,
};
var physicsmessage = {},
  PhysicsMessage = {
    ADD: 0,
    REMOVE: 1,
    UPDATE: 2,
    UPDATE_OBJECT: 3,
    ADDED: 4,
    REMOVED: 5,
    UPDATED: 6,
    START: 7,
    STOP: 8,
    FASTER: 9,
    SLOWER: 10,
    RESET: 11,
    APPLY: 12,
    APPLIED: 13,
    SUBMERGE: 14,
    SURFACE: 15,
  };
var physicsconstants = {},
  PC = { GRAVITY: { x: 0, y: 25 }, PM_RATIO: 20 };
var manager = {};
class Manager extends PIXI.utils.EventEmitter {
  constructor(a) {
    super();
    this.sid = a;
    this.p = new PhysicsWorker(this.onPhysicsMessage.bind(this));
    this.localUidPool = new UIDpool(16384);
    this.inBuffer = [];
    this.bodies = {};
    this.explosions = [];
    this.animated = {};
    this.animAttribs = [];
    this.localPlayer = null;
    this.players = {};
    this.teams = [];
    this.audioManager = new AudioManager(this);
    this.suspended = !1;
    this.lastScoringPlayerId = this.onPlayerSpawn = null;
    this.physicsMessageMap = {
      [PhysicsMessage.UPDATE_OBJECT]: this.onUpdateObject.bind(this),
      [PhysicsMessage.UPDATED]: this.onUpdated.bind(this),
      [PhysicsMessage.ADDED]: this.onAdded.bind(this),
      [PhysicsMessage.REMOVED]: this.onRemoved.bind(this),
      [PhysicsMessage.SUBMERGE]: (b) => {
        let c = this.bodies[b.id];
        c.p.sub = !0;
        let d = 8 < c.p.vx * c.p.vx + c.p.vy * c.p.vy;
        d &&
          AudioManager.PlayEffect(
            AudioEffects.WaterSplash[Math.floor(Math.random() * AudioEffects.WaterSplash.length)],
            c,
            !1
          );
        this.emit(ModelEvent.SUBMERGE, { go: c, ss: b.ss, splash: d });
      },
      [PhysicsMessage.SURFACE]: (b) => {
        b = this.bodies[b.id];
        b.p.sub = !1;
        let c = 8 < b.p.vx * b.p.vx + b.p.vy * b.p.vy;
        c &&
          AudioManager.PlayEffect(
            AudioEffects.WaterSplash[Math.floor(Math.random() * AudioEffects.WaterSplash.length)],
            b,
            !1
          );
        this.emit(ModelEvent.SURFACE, { go: b, splash: c });
      },
    };
    this.localObjectMap = {
      saw: (b) => {
        let c = this.bodies[b.id],
          d = this.p.raycast(c, b.p.p1, b.p.p2);
        d &&
          this.emit(ModelEvent.CREATE_EFFECT, {
            type: b.type,
            go: c,
            point: d.p,
            c: d.c,
            normal: d.normal,
          });
      },
      punch: (b) => {
        let c = this.bodies[b.id],
          d = this.p.raycast(c, b.p.p1, b.p.p2);
        d &&
          this.emit(ModelEvent.CREATE_EFFECT, {
            type: b.type,
            go: c,
            point: d.p,
            c: d.c,
            normal: d.normal,
          });
      },
      exp: (b) => {
        let c = this.bodies[b.id];
        b.pos = { x: c.p.x, y: c.p.y };
        this.explosions.push(b);
      },
      linkgun: (b) => {
        let c = this.bodies[b.id],
          d = this.p.raycast(c, b.p.p1, b.p.p2);
        if (d) {
          let e = null;
          null !== d.id && (e = this.bodies[d.id]);
          this.emit(ModelEvent.CREATE_EFFECT, {
            type: b.type,
            origin: b.p.p1,
            point: d.p,
            c: d.c,
            impact: !0,
            target: e,
            go: c,
          });
        } else
          this.emit(ModelEvent.CREATE_EFFECT, {
            type: b.type,
            origin: b.p.p1,
            point: b.p.p2,
            c: d.c,
            impact: !1,
            go: c,
          });
      },
    };
    this.stateChangeAgentMap = {
      [StateChange.Agent.COMBO]: (b, c) => {
        c.isLocal && this.emit(ModelEvent.PLAYER_COMBO, { type: b.t, player: c });
        return !1;
      },
      [StateChange.Agent.TELEPORT]: (b, c) => {
        b.to = this.bodies[b.to];
        b.from = this.bodies[b.from];
        AudioManager.PlayEffect(AudioEffects.Teleport, c);
        return !1;
      },
      [StateChange.Agent.INSERTION]: (b, c) => {
        AudioManager.PlayEffect(AudioEffects.Teleport, c);
        return !1;
      },
    };
    this.stateChangeModelMap = {
      [StateChange.Model.KILL]: (b) => {
        var c = this.bodies[b.kid];
        if (!c) return !1;
        c = this.players[c.sid];
        var d = this.bodies[b.tid];
        if (!d) return !1;
        d = this.players[d.sid];
        c &&
          d &&
          (this.emit(ModelEvent.MODEL_STATE, { state: b.s, killer: c, target: d }),
          this.emit(ModelEvent.PLAYER_DEATH, {
            killer: c,
            victim: d,
            local: this.localPlayer ? this.localPlayer.sid : !1,
            wep: b.w,
          }));
        return !1;
      },
      [StateChange.Model.ENVIRONMENT]: (b) => {
        this.applyEnvironment(b.env);
        return !1;
      },
      [StateChange.Model.ENERGY_RADIUS]: (b) => {
        this.emit(ModelEvent.ENERGY_RADIUS, b.v);
        return !1;
      },
      [StateChange.Model.END_DB_MATCH]: (b) => {
        this.emit(ModelEvent.DB_ROUND_END, b);
        return !1;
      },
      [StateChange.Model.INITIAL]: (b) => {
        this.emit(ModelEvent.INITIAL, b);
        return !1;
      },
    };
    this.stateChangeItemMap = {
      [StateChange.Item.CARRY_OBJECTIVE]: (b) => {
        let c = this.players[this.bodies[b.id].sid];
        void 0 !== c &&
          c.alive &&
          (this.p.connectBodies({ idA: b.id, idB: b.oid }), (b = this.bodies[b.oid])) &&
          (this.emit(ModelEvent.MESSAGE, {
            text: c.name + " captured the " + Team.Colors[b.g.team] + " flag!",
            color: Team.HexColors[c.team],
          }),
          AudioManager.PlayEffect(AudioEffects.GrabObjective, c));
        return !1;
      },
      [StateChange.Item.DROP_OBJECTIVE]: (b) => {
        this.p.disconnectBodies({ idA: b.id, idB: b.oid });
        let c = this.players[this.bodies[b.id].sid];
        b = this.bodies[b.oid];
        c && b
          ? (AudioManager.PlayEffect(AudioEffects.Throw, c),
            this.emit(ModelEvent.MESSAGE, {
              text: c.name + " dropped the " + Team.Colors[b.g.team] + " flag!",
              color: Team.HexColors[c.team],
            }))
          : console.log("Error: missing player or objective (StateChange.Item.DROP_OBJECTIVE)");
        return !1;
      },
      [StateChange.Item.SCORE_OBJECTIVE]: (b) => {
        this.p.disconnectBodies({ idA: b.id, idB: b.oid });
        b = this.bodies[b.id];
        let c = this.players[b.sid];
        this.lastScoringPlayerId = b.sid;
        this.emit(ModelEvent.PLAYER_SCORE, { player: c });
        App.HasFocus && AudioEffects.Objective.audio.play();
        return !1;
      },
      [StateChange.Item.RETURN_OBJECTIVE]: (b) => {
        (b = this.players[this.bodies[b.id].sid]) &&
          this.emit(ModelEvent.MESSAGE, {
            text: b.name + " returned the flag!",
            color: Team.HexColors[b.team],
          });
        return !1;
      },
    };
    this.stateChangeMap = {
      [StateChange.Agent.RANGE]: (b, c) => {
        let d = this.stateChangeAgentMap[b.s];
        d && d(b, c);
        c = c.applyState(b) || {};
        c.i = b.id;
        return c;
      },
      [StateChange.Model.RANGE]: (b, c) => {
        let d = this.stateChangeModelMap[b.s],
          e = !1;
        d && (e = d(b, c));
        return e;
      },
      [StateChange.Item.RANGE]: (b, c) => {
        let d = this.stateChangeItemMap[b.s];
        return d ? d(b, c) : c.applyState(b);
      },
    };
  }
  preContact(a, b) {
    if (a.contact && void 0 !== a.contact.triggerRatio)
      Math.random() < a.contact.triggerRatio &&
        this.emit(ModelEvent.GAMEOBJECT_CONTACT, { go: a, contact: b });
    else {
      if (a.p.contactInterval)
        if (App.Time > a.p.lastContactCheck + a.p.contactInterval) a.p.lastContactCheck = App.Time;
        else return !1;
      this.emit(ModelEvent.GAMEOBJECT_CONTACT, { go: a, contact: b });
    }
    return !1;
  }
  contact(a, b) {
    if (a.p.contactInterval)
      if (App.Time > a.p.lastContactCheck + a.p.contactInterval) a.p.lastContactCheck = App.Time;
      else return !1;
    let c = null;
    if (void 0 !== a.p.ricoAngle) {
      var d = Math.abs(Math.atan2(b.normal.y, b.normal.x) - Math.atan2(a.p.vy, a.p.vx));
      d = d > Math.PI ? 2 * Math.PI - d : d;
      if (!b.local && (0 >= a.p.rico-- || d < (a.p.ricoAngle * Math.PI) / 180))
        void 0 === a.p.explosive && (c = { id: a.id, type: 2 });
      else {
        let e;
        void 0 !== b.a.body._parent
          ? (e = this.bodies[b.a.body._parent])
          : void 0 !== b.b.body._parent && (e = this.bodies[b.b.body._parent]);
        if (void 0 !== e && e.alive) {
          if (void 0 === b.pen || 0 === b.pen) c = { id: a.id, type: 2 };
          void 0 !== b.o && (d = this.bodies[b.o]) && ((b.o = d), (b.tr = e));
        }
      }
    } else a.p.instant && (c = { id: a.id, type: 2 });
    this.emit(ModelEvent.GAMEOBJECT_CONTACT, { go: a, contact: b });
    return c ? (this.p.remove(c), !0) : !1;
  }
  processBuffer() {
    for (var a = 0; a < this.inBuffer.length; a++) {
      var b = this.inBuffer[a];
      if (1 === b[""])
        if (b.s) (b = this.applyStateChange(b)) && this.p.update(b);
        else {
          var c = this.instantiate(b);
          if (null !== c && (this.p.add(c.p), b.sharedState))
            for (c = b.sharedState.length; 0 < c--; ) this.applyStateChange(b.sharedState[c]);
        }
      else if (0 === b[""]) {
        if ((c = this.bodies[b.id])) {
          let d = !0;
          void 0 === c.p.rico
            ? ((b.type = c.p.type),
              this.localPlayer && c.id === this.localPlayer.id && (this.localPlayer = null))
            : (c.p.explosive ? (b.type = c.p.type) : ((c.p.ttl = 2), (d = !1)), (c.p.rico = 0));
          d && this.p.remove(b);
        }
      } else this.p.update(b);
    }
    if (0 < this.explosions.length) {
      for (let d = 0, e = this.explosions.length; d < e; d++) {
        a = this.explosions[d];
        b = this.p.explosion(a.pos, a.p.exp);
        for (let f = 0, g = b.length; f < g; f++)
          this.emit(ModelEvent.CREATE_EFFECT, { type: "exp", go: this.bodies[b[f]], exp: a });
      }
      this.explosions = [];
    }
    this.inBuffer = [];
    this.localPlayer && this.p.updateFacing(this.localPlayer.id, this.localPlayer.facing);
  }
  createPlayer(a, b) {
    this.localPlayer = new Player(
      a.id,
      a.name,
      a.team,
      b.level,
      b.customization,
      b.clan_id,
      b.clan_name
    );
    this.localPlayer.p.type = a.p.type;
    this.localPlayer.p.gi = a.id;
    this.localPlayer.isLocal = !0;
    a.p.a = a.a;
    a.p.local = 1;
    this.localPlayer.facing = a.z;
    this.bodies[this.localPlayer.id] = this.localPlayer;
    a.p.ragdoll = { id: {} };
    this.localPlayer.sid = a.sid;
    for (let c in this.localPlayer.ragdoll)
      (b = this.localPlayer.ragdoll[c]), (this.bodies[b.id] = b), (a.p.ragdoll.id[c] = b.id);
    this.localPlayer.onJet = this.onPlayerJet.bind(this);
    a.p.smooth = !0;
    this.animated[a.id] = this.localPlayer;
    return a;
  }
  createAgent(a, b) {
    if (a.player) {
      b = new Player(a.id, a.name, a.team, b.level, b.customization, b.clan_id, b.clan_name);
      b.sid = a.sid;
      b.facing = a.z;
      b.p.gi = a.id;
      a.p.ragdoll = { id: {} };
      a.p.z = a.z;
      a.p.a = a.a;
      this.bodies[b.id] = b;
      for (let c in b.ragdoll)
        (this.bodies[b.ragdoll[c].id] = b.ragdoll[c]), (a.p.ragdoll.id[c] = b.ragdoll[c].id);
    } else b = new Agent(a.id, a.name);
    b.p.type = a.p.type;
    this.animated[a.id] = b;
    return a;
  }
  setCamera(a) {
    this.camera = a;
    AudioManager.Cam = a;
  }
  instantiate(a) {
    if (void 0 !== this.bodies[a.id]) return null;
    if (a.pr) {
      var b = new PrefabClasses[a.pr](a);
      b.p.cid = a.pr;
      a.p.s && (b.p.s = 1);
      void 0 !== a.p.j && (b.p.j = a.p.j);
      void 0 !== a.p.o && (a = this.players[a.p.o]) && (b.p.origin = a.id);
      return this.createGameObject(b);
    }
    return a.player
      ? ((a.p.id = a.id),
        (b = this.onPlayerSpawn(a.sid))
          ? a.sid === this.sid
            ? this.createPlayer(a, b)
            : this.createAgent(a, b)
          : null)
      : this.createGameObject(a);
  }
  createGameObject(a) {
    let b = new GameObject(a);
    this.bodies[b.id] = b;
    b.p.track &&
      this.localPlayer &&
      b.p.origin === this.localPlayer.id &&
      (this.localPlayer.crouching || this.localPlayer.prone) &&
      this.localPlayer.input.LM.d &&
      this.setTrackObject(b.id, !0);
    b.g.animate && (this.animated[b.id] = b);
    if (a.at) {
      b.at = a.at;
      for (let c = 0; c < a.at.length; c++) {
        let d = a.at[c],
          e = !1;
        switch (d.type) {
          case GameAttribute.WELD_JOINT:
          case GameAttribute.REVOLUTE_JOINT:
          case GameAttribute.GRAVITY_SCALE:
            e = !0;
            break;
          case GameAttribute.TRANSFORM:
            e = !0;
            b.transform =
              void 0 === b.transform
                ? GameAttribute.T_TRANSFORM
                : b.transform | GameAttribute.T_TRANSFORM;
            b.transformOptions = { ...b.transformOptions, ...d };
            break;
          case GameAttribute.FLUID:
            e = !0;
            b.transform =
              void 0 === b.transform ? GameAttribute.T_FLUID : b.transform | GameAttribute.T_FLUID;
            b.transformOptions = { ...b.transformOptions, ...d };
            break;
          case GameAttribute.UV_ROTATE:
            b.transform =
              void 0 === b.transform
                ? GameAttribute.T_UV_ROTATE
                : b.transform | GameAttribute.T_UV_ROTATE;
            b.transformOptions = { ...b.transformOptions, ...d };
            break;
          case GameAttribute.UV_TRANSLATE:
            (b.transform =
              void 0 === b.transform
                ? GameAttribute.T_UV_TRANSLATE
                : b.transform | GameAttribute.T_UV_TRANSLATE),
              (b.transformOptions = { ...b.transformOptions, ...d });
        }
        e && (void 0 === b.p.attr && (b.p.attr = []), b.p.attr.push(d));
      }
    }
    return b;
  }
  applySettings(a) {
    this.teams = [];
    for (let b = 0; b < a.teams; b++) this.teams.push(b);
  }
  getLocalPlayer() {
    return this.localPlayer;
  }
  pushUpdates(a) {
    this.inBuffer = this.inBuffer.concat(a);
  }
  requestLocalObject(a) {
    a.p = a.p;
    var b = this.localObjectMap[a.type];
    b
      ? b(a)
      : ((a.id = "L" + this.localUidPool.get()),
        (b = this.instantiate(a)),
        null !== b && ((b.p.ttl = a.ttl), (b.p.local = a.p.l), (b.p.id = a.id), this.p.add(b.p)));
  }
  applyStateChange(a) {
    let b;
    if (void 0 !== a.id && ((b = this.bodies[a.id]), void 0 === b || !b.isPlayer))
      return console.log("[applyStateChange] warning: player does not exist"), null;
    var c = this.stateChangeMap[Math.floor(a.s / 100)];
    c = c ? c(a, b) : null;
    if (!1 === c) return !1;
    void 0 !== a.id &&
      (b === this.localPlayer && this.emit(ModelEvent.PLAYER_STATE, { agent: b, state: a }),
      this.emit(ModelEvent.AGENT_STATE, { agent: b, state: a }));
    return c;
  }
  clear() {
    this.worldInitialized = !1;
    this.wayoints = {};
    this.inBuffer = [];
    this.bodies = {};
    this.explosions = [];
    this.animated = {};
    this.animAttribs = [];
    this.localPlayer = null;
    this.players = {};
    this.teams = [];
    this.audioManager.clear();
    this.p.pushMessage({ t: PhysicsMessage.RESET });
    this.emit(ModelEvent.CLEAR, {});
  }
  destroy() {
    this.clear();
  }
  getPlayerById(a) {
    return this.players[a];
  }
  getLastScoringPlayer() {
    return null !== this.lastScoringPlayerId ? this.players[this.lastScoringPlayerId] : null;
  }
  trackPlayer(a) {
    (a = this.players[a]) && this.setTrackObject(a.id);
  }
  setTrackObject(a, b = !1) {
    this.camera.target = a;
    this.camera.tracking = b;
  }
  update(a) {
    this.suspended
      ? this.processBuffer()
      : (this.localPlayer && this.updatePlayerFacing(),
        this.processBuffer(),
        this.p.simulate(Math.min(a, 50)),
        this.audioManager.update(a));
  }
  updatePlayerFacing() {
    var a = this.localPlayer.getOffset();
    a = Math.atan2(
      this.localPlayer.p.y + a.y + (this.camera.y - App.TransformedMouseY),
      this.localPlayer.p.x + a.x + (this.camera.x - App.TransformedMouseX)
    );
    Math.round(400 * this.localPlayer.facing) !== Math.round(400 * a) &&
      ((this.localPlayer.facing = a.toPrecision(3)), (this.localPlayer.facingChanged = !0));
  }
  updatePlayerInput(a) {
    this.localPlayer && this.localPlayer.updateInput(a);
  }
  showPlayerChat(a, b) {
    (a = this.players[a]) && this.emit(ModelEvent.UPDATE_LABEL, { id: a.id, subText: b });
  }
  onPlayerJet(a, b) {
    this.emit(ModelEvent.PLAYER_STATE, { agent: a, state: { s: StateChange.Agent.JET, v: b } });
  }
  resume() {
    this.lastScoringPlayer = null;
    this.suspended = !1;
  }
  suspend() {
    App.HasFocus && AudioEffects.Victory.audio.play();
    this.suspended = !0;
  }
  applyEnvironment(a) {
    Player.ENERGY = a.settings ? a.settings.energy : Manager.DefaultEnvironment.settings.energy;
    PC.GRAVITY.x = parseFloat(a.gravity.x);
    PC.GRAVITY.y = parseFloat(a.gravity.y);
    BaseSprite.MeshIDGroups = void 0 !== a.groups ? a.groups : [];
    BaseSprite.TextureIDMap = void 0 !== a.textures ? a.textures : [];
    this.p.pushMessage({ t: PhysicsMessage.RESET });
    this.emit(ModelEvent.UPDATE_ENVIRONMENT, a);
  }
  focus() {
    this.emit(ModelEvent.FOCUS);
  }
  mute(a) {
    a ? this.audioManager.mute() : this.audioManager.unmute();
  }
  onPhysicsMessage(a) {
    this.physicsMessageMap[a.type](a.data);
  }
  onAdded(a) {
    let b = this.bodies[a.id];
    b.p.x = a.x;
    b.p.y = a.y;
    b.p.r = a.r;
    this.emit(ModelEvent.GAMEOBJECT_ADDED, b);
    if (b.isPlayer) this.onPlayerAdded(b, a);
  }
  onPlayerAdded(a, b) {
    this.players[a.sid] = a;
    this.localPlayer &&
      this.localPlayer.sid === a.sid &&
      (this.emit(ModelEvent.PLAYER_SPAWN, a),
      (this.camera.target = this.localPlayer.torsoupper.id),
      this.setTrackObject(this.localPlayer.torsoupper.id));
    a.setAnimations(b.anims);
  }
  processContacts(a) {
    let b = a.p.c;
    for (let c = 0, d = b.length; c < d; c++) {
      let e = b[c];
      if (e.t === PhysicsWorker.Contact.CON) {
        if (this.contact(a, e)) return !0;
      } else if (e.t === PhysicsWorker.Contact.PRE && this.preContact(a, e)) return !0;
    }
    return !1;
  }
  onUpdateObject(a) {
    let b = this.bodies[a.id];
    if (b) {
      b.p.x = a.x;
      b.p.y = a.y;
      b.p.r = a.r;
      b.p.vx = a.vx;
      b.p.vy = a.vy;
      if (a.c) {
        if (((b.p.c = a.c), this.processContacts(b))) return;
      } else b.p.c && (b.p.c = []);
      if (void 0 !== b.p.rico && 0 >= b.p.ttl) this.p.remove({ id: a.id, type: 2 });
      else {
        if (void 0 !== a.ax || void 0 !== a.ay) (b.p.ax = a.ax || 0), (b.p.ay = a.ay || 0);
        b.isPlayer &&
          (a.a && b.setAnimations(a.a),
          b.p.ax || b.p.ay
            ? 0.01 !== b.p.fr &&
              ((b.p.fr = 0.01), this.p.update({ i: b.id, fr: b.p.fr, type: b.p.type, local: !0 }))
            : 50 !== b.p.fr &&
              ((b.p.fr = 50), this.p.update({ i: b.id, fr: b.p.fr, type: b.p.type, local: !0 })),
          void 0 !== a.z &&
            (this.localPlayer
              ? a.id !== this.localPlayer.id
                ? ((b.facing = a.z), b.updateFacingDir(a.z))
                : this.localPlayer.updateFacingDir(a.z)
              : ((b.facing = a.z), b.updateFacingDir(a.z))));
        b.g.animate || b.update(null, null, this.suspended);
      }
    }
  }
  onUpdated() {
    for (let a in this.animated) this.animated[a].visual && this.animated[a].update();
  }
  onRemoved(a) {
    let b = a.id,
      c = this.bodies[b];
    if (void 0 === c) console.log("body does not exist: " + b);
    else {
      c.isPlayer
        ? (delete this.players[c.sid],
          c === this.localPlayer && (this.localPlayer = null),
          c.sid === this.lastScoringPlayerId && (this.lastScoringPlayerId = null),
          this.emit(ModelEvent.REMOVE_LABEL, { id: b }))
        : this.camera.target === b &&
          this.localPlayer &&
          this.setTrackObject(this.localPlayer.torsoupper.id);
      a.tr && (c.triggered = !0);
      this.emit(ModelEvent.GAMEOBJECT_DELETED, c);
      if (c.ragdoll) for (let d in c.ragdoll) delete this.bodies[c.ragdoll[d].id];
      c.p.local && this.localUidPool.drop(b.substr(1));
      void 0 !== this.bodies[b] && delete this.bodies[b];
      void 0 !== this.animated[b] && delete this.animated[b];
    }
  }
}
Manager.DefaultEnvironment = {
  weather: { precipitation: { type: "none", intensity: 0 } },
  gravity: PC.GRAVITY,
  gradient: { topColor: "b0e0e6", bottomColor: "3d4e50", topY: -2e3, bottomY: 2e3 },
  settings: { energy: 200 },
};
var modelevent = {};
function ModelEvent(a, b) {
  CustomEvent.call(this, a, b);
}
ModelEvent.ENTER_FRAME = "m_ef";
ModelEvent.GAMEOBJECT_ADDED = "m_goa";
ModelEvent.GAMEOBJECT_UPDATED = "m_gou";
ModelEvent.GAMEOBJECT_DELETED = "m_god";
ModelEvent.GAMEOBJECT_CONTACT = "m_goc";
ModelEvent.UPDATE_LABEL = "m_ul";
ModelEvent.REMOVE_LABEL = "m_rl";
ModelEvent.SAVE_MAP = "m_sm";
ModelEvent.PLAYER_STATE = "m_ps";
ModelEvent.AGENT_STATE = "m_as";
ModelEvent.PLAYER_ACTION = "m_pa";
ModelEvent.PLAYER_TELEPORT = "m_pt";
ModelEvent.MODEL_STATE = "m_ms";
ModelEvent.ENERGY_RADIUS = "m_er";
ModelEvent.PLAYER_DEATH = "m_pd";
ModelEvent.PLAYER_SPAWN = "m_pls";
ModelEvent.CLEAR = "m_cm";
ModelEvent.PLAYER_KILL = "m_pk";
ModelEvent.PLAYER_SCORE = "m_psc";
ModelEvent.CREATE_EFFECT = "m_ce";
ModelEvent.PLAYER_COMBO = "m_pc";
ModelEvent.PLAYER_SPREE = "m_spr";
ModelEvent.UPDATE_ENVIRONMENT = "m_ue";
ModelEvent.FOCUS = "m_fc";
ModelEvent.MESSAGE = "m_m";
ModelEvent.DB_ROUND_END = "m_n";
ModelEvent.INITIAL = "m_i";
ModelEvent.SUBMERGE = "m_sb";
ModelEvent.SURFACE = "m_sr";
var shapeoptions = {};
ShapeOptions = { CIRCLE: 1, RECTANGLE: 2, ROUNDED_RECT: 3, PLAYER: 4, COMPOUND: 5 };
var bodyfactory = {},
  b2Vec2 = Box2D.b2Vec2,
  b2AABB = Box2D.b2AABB,
  b2BodyDef = Box2D.b2BodyDef;
b2Body = Box2D.b2Body;
var b2FixtureDef = Box2D.b2FixtureDef,
  b2FilterData = Box2D.b2FilterData,
  b2Fixture = Box2D.b2Fixture,
  b2World = Box2D.b2World,
  b2PolygonShape = Box2D.b2PolygonShape,
  b2CircleShape = Box2D.b2CircleShape,
  b2Joint = Box2D.b2Joint,
  b2RevoluteJointDef = Box2D.b2RevoluteJointDef,
  b2WeldJointDef = Box2D.b2WeldJointDef;
BodyFactory = {
  world: null,
  free: function (a) {
    this.world.DestroyBody(a);
  },
  createBody: function (a) {
    if (0 === a.type && (a.c === EntityCategory.OPEN_WORLD || void 0 === a.sh))
      return {
        GetPosition: () => ({ x: a.x, y: a.y }),
        GetUserData: () => a.id.toString(),
        GetAngle: () => a.r,
        GetType: () => 0,
      };
    let b,
      c = this.world.CreateBody(this.getBodyDef(a));
    void 0 !== a.gs && c.SetGravityScale(a.gs);
    void 0 !== a.ld && c.SetLinearDamping(a.ld);
    void 0 !== a.ad && c.SetAngularDamping(a.ad);
    switch (a.prefab) {
      case ShapeOptions.CIRCLE:
        b = ShapeCircle;
        break;
      case ShapeOptions.RECTANGLE:
        b = ShapeRectangle;
        break;
      case ShapeOptions.PLAYER:
        b = ShapePlayer;
        break;
      default:
        b = ShapeCompound;
    }
    return b.call(c, a);
  },
  getBodyDef: function (a) {
    let b = new b2BodyDef();
    b.userData = a.id.toString();
    a.fixedRotation && (b.fixedRotation = !0);
    a.bullet && (b.bullet = !0);
    a.vr && (b.angularVelocity = a.vr);
    (a.vx || a.vy) && b.linearVelocity.Set(a.vx || 0, a.vy || 0);
    (a.x || a.y) && b.position.Set(a.x || 0, a.y || 0);
    a.r && (b.angle = a.r);
    0 == a.allowSleep && (b.allowSleep = !1);
    void 0 !== a.type && (b.type = a.type);
    return b;
  },
  applyDef: function (a, b) {
    if (void 0 !== b.gi && a._gi !== b.gi) {
      for (let c = a.m_fixtureList; c; c = c.m_next) {
        let d = c.GetFilterData();
        d.groupIndex = b.gi;
        c.SetFilterData(d);
      }
      a._gi = b.gi;
    }
    a.SetUserData(b.id.toString());
    a.SetLinearVelocity(new b2Vec2(b.vx || 0, b.vy || 0));
    a.SetPosition(new b2Vec2(b.x || 0, b.y || 0));
    void 0 !== b.r && a.SetAngle(b.r || 0);
    void 0 !== b.vr && a.SetAngularVelocity(b.vr || 0);
  },
  createRagdoll: function (a, b) {
    let c = { scale: 0.62 };
    c.head = this.createBody({
      prefab: ShapeOptions.CIRCLE,
      gi: b,
      sh: [{ c: EntityCategory.LIMB, isSensor: !1, radius: 6.2, d: 0.6, fr: 0.99, re: 0.1 }],
      allowSleep: !0,
      id: a.head,
      type: 2,
      x: 0,
      y: 0,
      r: 0,
      ad: 0.9,
    });
    c.torsoupper = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 6.2,
          height: 6.2,
          d: 0.8,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.torsoupper,
      type: 2,
      x: 0,
      y: 0,
      r: 0,
    });
    c.torsolower = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 6.2,
          height: 6.2,
          d: 0.8,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.torsolower,
      type: 2,
      x: 0,
      y: -3.1,
      r: 0,
    });
    c.armleftupper = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 6.2,
          d: 0.6,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.armleftupper,
      type: 2,
      x: 3.1,
      y: 0,
      r: 0.5 * Math.PI,
    });
    c.armleftlower = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 6.2,
          d: 0.3,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.armleftlower,
      type: 2,
      x: 3.1,
      y: 0.62,
      r: 0.5 * Math.PI,
    });
    c.armrightupper = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 6.2,
          d: 0.6,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.armrightupper,
      type: 2,
      x: -3.1,
      y: 0,
      r: 2.8 * Math.PI,
    });
    c.armrightlower = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 6.2,
          d: 0.3,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.armrightlower,
      type: 2,
      x: -3.1,
      y: 0.62,
      r: 3.6 * Math.PI,
    });
    c.legleftupper = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 8.68,
          d: 0.6,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.legleftupper,
      type: 2,
      x: 3.1,
      y: -3 * 0.62,
      r: 1.5 * Math.PI,
    });
    c.legleftlower = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 6.2,
          d: 0.3,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.legleftlower,
      type: 2,
      x: 3.1,
      y: -6 * 0.62,
      r: 0.5 * Math.PI,
    });
    c.legrightupper = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 8.68,
          d: 0.6,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.legrightupper,
      type: 2,
      x: -3.1,
      y: -3 * 0.62,
      r: 1.5 * Math.PI,
    });
    c.legrightlower = this.createBody({
      prefab: ShapeOptions.RECTANGLE,
      gi: b,
      sh: [
        {
          c: EntityCategory.LIMB,
          isSensor: !1,
          width: 1.24,
          height: 6.2,
          d: 0.3,
          fr: 0.99,
          re: 0.1,
        },
      ],
      allowSleep: !0,
      id: a.legrightlower,
      type: 2,
      x: -3.1,
      y: -6 * 0.62,
      r: 0.5 * Math.PI,
    });
    c.torsoupper.contact = !0;
    a = new b2Vec2(0, -0.2852);
    b = new b2Vec2(0, 0.2852);
    c.neckjoint = this.joinBodies(c.head, c.torsoupper, a, b, !1, !1, 0, 2 * Math.PI);
    a = new b2Vec2(0, -0.217);
    b = new b2Vec2(0, 0.217);
    c.torsojoint = this.joinBodies(
      c.torsoupper,
      c.torsolower,
      a,
      b,
      !1,
      !0,
      0.25 * -Math.PI,
      0.25 * Math.PI
    );
    a = new b2Vec2(0, 0);
    b = new b2Vec2(0.248, 0.0868);
    c.leftshoulderjoint = this.joinBodies(
      c.armleftupper,
      c.torsoupper,
      a,
      b,
      !1,
      !1,
      0.5 * -Math.PI,
      0 * Math.PI
    );
    c.leftshoulderjoint.EnableMotor(!0);
    c.leftshoulderjoint.SetMaxMotorTorque(100);
    a = new b2Vec2(0.0899, -0.78 * 0.62);
    b = new b2Vec2(0, 0);
    c.leftelbowjoint = this.joinBodies(
      c.armleftupper,
      c.armleftlower,
      a,
      b,
      !1,
      !1,
      0.5 * -Math.PI,
      0
    );
    c.leftelbowjoint.EnableMotor(!0);
    c.leftelbowjoint.SetMaxMotorTorque(100);
    a = new b2Vec2(0, 0);
    b = new b2Vec2(-0.248, 0.0868);
    c.rightshoulderjoint = this.joinBodies(
      c.armrightupper,
      c.torsoupper,
      a,
      b,
      !1,
      !1,
      2 * -Math.PI,
      1.5 * -Math.PI
    );
    c.rightshoulderjoint.EnableMotor(!0);
    c.rightshoulderjoint.SetMaxMotorTorque(100);
    a = new b2Vec2(-0.0899, -0.78 * 0.62);
    b = new b2Vec2(0, 0);
    c.rightelbowjoint = this.joinBodies(
      c.armrightupper,
      c.armrightlower,
      a,
      b,
      !1,
      !1,
      0,
      0.5 * Math.PI
    );
    c.rightelbowjoint.EnableMotor(!0);
    c.rightelbowjoint.SetMaxMotorTorque(100);
    a = new b2Vec2(0, 0.279);
    b = new b2Vec2(0.0868, -0.36 * 0.62);
    c.lefthipjoint = this.joinBodies(
      c.legleftupper,
      c.torsolower,
      a,
      b,
      !1,
      !1,
      0.5 * -Math.PI,
      0.5 * Math.PI
    );
    c.lefthipjoint.EnableMotor(!0);
    c.lefthipjoint.SetMaxMotorTorque(100);
    a = new b2Vec2(0, -0.248);
    b = new b2Vec2(0, 0.3038);
    c.leftkneejoint = this.joinBodies(
      c.legleftupper,
      c.legleftlower,
      a,
      b,
      !1,
      !1,
      0.5 * -Math.PI,
      0.5 * Math.PI
    );
    c.leftkneejoint.EnableMotor(!0);
    c.leftkneejoint.SetMaxMotorTorque(100);
    a = new b2Vec2(0, 0.279);
    b = new b2Vec2(-0.0868, -0.36 * 0.62);
    c.righthipjoint = this.joinBodies(
      c.legrightupper,
      c.torsolower,
      a,
      b,
      !1,
      !1,
      0.5 * -Math.PI,
      0.5 * Math.PI
    );
    c.righthipjoint.EnableMotor(!0);
    c.righthipjoint.SetMaxMotorTorque(100);
    a = new b2Vec2(0, -0.248);
    b = new b2Vec2(0, 0.3038);
    c.rightkneejoint = this.joinBodies(
      c.legrightupper,
      c.legrightlower,
      a,
      b,
      !1,
      !1,
      0.5 * -Math.PI,
      0.5 * Math.PI
    );
    c.rightkneejoint.EnableMotor(!0);
    c.rightkneejoint.SetMaxMotorTorque(100);
    c.bodies = [
      c.head,
      c.torsoupper,
      c.torsolower,
      c.armleftupper,
      c.armleftlower,
      c.armrightupper,
      c.armrightlower,
      c.legleftupper,
      c.legleftlower,
      c.legrightupper,
      c.legrightlower,
    ];
    c.joints = [
      c.neckjoint,
      c.torsojoint,
      c.leftshoulderjoint,
      c.leftelbowjoint,
      c.rightshoulderjoint,
      c.rightelbowjoint,
      c.lefthipjoint,
      c.leftkneejoint,
      c.righthipjoint,
      c.rightkneejoint,
    ];
    c.animations = Animations;
    return c;
  },
  joinBodies: function (a, b, c, d, e, f, g, h) {
    let k = new b2RevoluteJointDef();
    k.bodyA = a;
    k.bodyB = b;
    k.enableLimit = f || !1;
    k.lowerAngle = g || 0;
    k.upperAngle = h || 0;
    k.localAnchorA = c;
    k.localAnchorB = d;
    k.collideConnected = e;
    return this.world.CreateJoint(k);
  },
  weldJoinBodies: function (a, b, c, d, e) {
    let f = new b2WeldJointDef();
    f.bodyA = a;
    f.bodyB = b;
    f.localAnchorA = c;
    f.localAnchorB = d;
    f.referenceAngle = void 0 !== e ? e : b.GetAngle() - a.GetAngle();
    return this.world.CreateJoint(f);
  },
  createJoint: function (a, b, c) {
    let d = new b2Vec2(b.x / PC.PM_RATIO, b.y / PC.PM_RATIO),
      e = new b2Vec2(c.x / PC.PM_RATIO, c.y / PC.PM_RATIO),
      f;
    switch (a.type) {
      case GameAttribute.REVOLUTE_JOINT:
        f = this.joinBodies(
          b.owner,
          c.owner,
          d,
          e,
          parseInt(a.collide, 10),
          parseInt(a.limit, 10),
          parseFloat(a.lowerAngle),
          parseFloat(a.upperAngle)
        );
        parseInt(a.motor, 10) && f.EnableMotor(!0);
        0 !== parseFloat(a.motorTorque) && f.SetMaxMotorTorque(parseFloat(a.motorTorque));
        f.SetUserData(a.id);
        break;
      case GameAttribute.WELD_JOINT:
        (f = this.weldJoinBodies(b.owner, c.owner, d, e, a.angle)), f.SetUserData(a.id);
    }
    return f;
  },
};
var animations = {};
function Animation(a, b) {
  this.timeline = [];
  this.frames = a;
  this.frequency = b;
  this.delay = this.frame = 0;
  this.offsets = [{ x: 0, y: 0 }];
  this.frameRepeat = !0;
  this.motorSpeed = 8;
}
Animation.STAND = "0";
Animation.WALK_LEFT = "1";
Animation.WALK_RIGHT = "2";
Animation.CROUCH_LEFT = "3";
Animation.CROUCH_RIGHT = "4";
Animation.CROUCH_MOVE_LEFT = "5";
Animation.CROUCH_MOVE_RIGHT = "6";
Animation.HOLD_GUN_LEFT = "7";
Animation.HOLD_GUN_RIGHT = "8";
Animation.SCOPE_GUN_LEFT = "9";
Animation.SCOPE_GUN_RIGHT = "10";
Animation.THROW_NADE_LEFT = "11";
Animation.THROW_NADE_RIGHT = "12";
Animation.ROLL_LEFT = "13";
Animation.ROLL_RIGHT = "14";
Animation.JUMP_LEFT = "15";
Animation.JUMP_RIGHT = "16";
Animation.THROW_LEFT = "17";
Animation.THROW_RIGHT = "18";
Animation.JET_LEFT = "19";
Animation.JET_RIGHT = "20";
Animation.RELOAD_LEFT = "21";
Animation.RELOAD_RIGHT = "22";
Animation.PUNCH_LEFT = "23";
Animation.PUNCH_RIGHT = "24";
Animation.FALL_LEFT = "25";
Animation.FALL_RIGHT = "26";
Animation.PRONE_LEFT = "27";
Animation.PRONE_RIGHT = "28";
Animation.PRONE_SCOPE_LEFT = "29";
Animation.PRONE_SCOPE_RIGHT = "30";
Animation.PRONE_END = "31";
Animation.PRONE_MOVE_LEFT = "32";
Animation.PRONE_MOVE_RIGHT = "33";
Animation.SWITCH_LEFT = "34";
Animation.SWITCH_RIGHT = "35";
Animation.JUMP_LEFT_2 = "36";
Animation.JUMP_RIGHT_2 = "37";
Animation.SHOOT_BOW_LEFT = "38";
Animation.SHOOT_BOW_RIGHT = "39";
Animation.WAVE_LEFT = "40";
Animation.WAVE_RIGHT = "41";
Animation.SALUTE_LEFT = "42";
Animation.SALUTE_RIGHT = "43";
Animation.CHAT = "44";
Animation.CHAT_END = "45";
Animation.DURATIONS = {};
Animation.DURATIONS[Animation.STAND] = 1;
Animation.DURATIONS[Animation.WALK_LEFT] = 10;
Animation.DURATIONS[Animation.WALK_RIGHT] = 10;
Animation.DURATIONS[Animation.CROUCH_LEFT] = 8;
Animation.DURATIONS[Animation.CROUCH_RIGHT] = 8;
Animation.DURATIONS[Animation.CROUCH_MOVE_LEFT] = 10;
Animation.DURATIONS[Animation.CROUCH_MOVE_RIGHT] = 10;
Animation.DURATIONS[Animation.HOLD_GUN_LEFT] = 1;
Animation.DURATIONS[Animation.HOLD_GUN_RIGHT] = 1;
Animation.DURATIONS[Animation.SCOPE_GUN_LEFT] = 1;
Animation.DURATIONS[Animation.SCOPE_GUN_RIGHT] = 1;
Animation.DURATIONS[Animation.THROW_NADE_LEFT] = 13;
Animation.DURATIONS[Animation.THROW_NADE_RIGHT] = 13;
Animation.DURATIONS[Animation.ROLL_LEFT] = 1;
Animation.DURATIONS[Animation.ROLL_RIGHT] = 1;
Animation.DURATIONS[Animation.JUMP_LEFT] = 4;
Animation.DURATIONS[Animation.JUMP_RIGHT] = 4;
Animation.DURATIONS[Animation.THROW_LEFT] = 4;
Animation.DURATIONS[Animation.THROW_RIGHT] = 4;
Animation.DURATIONS[Animation.JET_LEFT] = 4;
Animation.DURATIONS[Animation.JET_RIGHT] = 4;
Animation.DURATIONS[Animation.RELOAD_LEFT] = 10;
Animation.DURATIONS[Animation.RELOAD_RIGHT] = 10;
Animation.DURATIONS[Animation.PUNCH_LEFT] = 16;
Animation.DURATIONS[Animation.PUNCH_RIGHT] = 16;
Animation.DURATIONS[Animation.FALL_LEFT] = 1;
Animation.DURATIONS[Animation.FALL_RIGHT] = 1;
Animation.DURATIONS[Animation.PRONE_LEFT] = 8;
Animation.DURATIONS[Animation.PRONE_RIGHT] = 8;
Animation.DURATIONS[Animation.PRONE_SCOPE_LEFT] = 1;
Animation.DURATIONS[Animation.PRONE_SCOPE_RIGHT] = 1;
Animation.DURATIONS[Animation.PRONE_END] = 18;
Animation.DURATIONS[Animation.PRONE_MOVE_LEFT] = 24;
Animation.DURATIONS[Animation.PRONE_MOVE_RIGHT] = 24;
Animation.DURATIONS[Animation.SWITCH_LEFT] = 13;
Animation.DURATIONS[Animation.SWITCH_RIGHT] = 13;
Animation.DURATIONS[Animation.JUMP_LEFT_2] = 4;
Animation.DURATIONS[Animation.JUMP_RIGHT_2] = 4;
Animation.DURATIONS[Animation.SHOOT_BOW_LEFT] = 16;
Animation.DURATIONS[Animation.SHOOT_BOW_RIGHT] = 16;
Animation.DURATIONS[Animation.WAVE_LEFT] = 20;
Animation.DURATIONS[Animation.WAVE_RIGHT] = 20;
Animation.DURATIONS[Animation.SALUTE_LEFT] = 1;
Animation.DURATIONS[Animation.SALUTE_RIGHT] = 1;
Animation.DURATIONS[Animation.CHAT] = 1;
Animation.DURATIONS[Animation.CHAT_END] = 1;
Animation.REPEAT = {};
Animation.REPEAT[Animation.STAND] = !1;
Animation.REPEAT[Animation.WALK_LEFT] = !0;
Animation.REPEAT[Animation.WALK_RIGHT] = !0;
Animation.REPEAT[Animation.CROUCH_LEFT] = !1;
Animation.REPEAT[Animation.CROUCH_RIGHT] = !1;
Animation.REPEAT[Animation.CROUCH_MOVE_LEFT] = !0;
Animation.REPEAT[Animation.CROUCH_MOVE_RIGHT] = !0;
Animation.REPEAT[Animation.HOLD_GUN_LEFT] = !1;
Animation.REPEAT[Animation.HOLD_GUN_RIGHT] = !1;
Animation.REPEAT[Animation.SCOPE_GUN_LEFT] = !1;
Animation.REPEAT[Animation.SCOPE_GUN_RIGHT] = !1;
Animation.REPEAT[Animation.THROW_NADE_LEFT] = !1;
Animation.REPEAT[Animation.THROW_NADE_RIGHT] = !1;
Animation.REPEAT[Animation.ROLL_LEFT] = !1;
Animation.REPEAT[Animation.ROLL_RIGHT] = !1;
Animation.REPEAT[Animation.JUMP_LEFT] = !1;
Animation.REPEAT[Animation.JUMP_RIGHT] = !1;
Animation.REPEAT[Animation.THROW_LEFT] = !1;
Animation.REPEAT[Animation.THROW_RIGHT] = !1;
Animation.REPEAT[Animation.JET_LEFT] = !1;
Animation.REPEAT[Animation.JET_RIGHT] = !1;
Animation.REPEAT[Animation.RELOAD_LEFT] = !0;
Animation.REPEAT[Animation.RELOAD_RIGHT] = !0;
Animation.REPEAT[Animation.PUNCH_LEFT] = !0;
Animation.REPEAT[Animation.PUNCH_RIGHT] = !0;
Animation.REPEAT[Animation.FALL_LEFT] = !1;
Animation.REPEAT[Animation.FALL_RIGHT] = !1;
Animation.REPEAT[Animation.PRONE_LEFT] = !1;
Animation.REPEAT[Animation.PRONE_RIGHT] = !1;
Animation.REPEAT[Animation.PRONE_SCOPE_LEFT] = !1;
Animation.REPEAT[Animation.PRONE_SCOPE_RIGHT] = !1;
Animation.REPEAT[Animation.PRONE_END] = !1;
Animation.REPEAT[Animation.PRONE_MOVE_LEFT] = !0;
Animation.REPEAT[Animation.PRONE_MOVE_RIGHT] = !0;
Animation.REPEAT[Animation.SWITCH_LEFT] = !1;
Animation.REPEAT[Animation.SWITCH_RIGHT] = !1;
Animation.REPEAT[Animation.JUMP_LEFT_2] = !1;
Animation.REPEAT[Animation.JUMP_RIGHT_2] = !1;
Animation.REPEAT[Animation.SHOOT_BOW_LEFT] = !0;
Animation.REPEAT[Animation.SHOOT_BOW_RIGHT] = !0;
Animation.REPEAT[Animation.WAVE_LEFT] = !0;
Animation.REPEAT[Animation.WAVE_RIGHT] = !0;
Animation.REPEAT[Animation.SALUTE_LEFT] = !1;
Animation.REPEAT[Animation.SALUTE_RIGHT] = !1;
Animation.REPEAT[Animation.CHAT] = !1;
Animation.REPEAT[Animation.CHAT_END] = !1;
function StandAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.STAND], 0);
  this.timeline.push(
    StandAnimation.tlLeftHip,
    StandAnimation.tlLeftKnee,
    StandAnimation.tlRightHip,
    StandAnimation.tlRightKnee
  );
  this.motorSpeed = 50;
}
StandAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [-0.21] };
StandAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [-0.21] };
StandAnimation.tlRightHip = { joint: "righthipjoint", frames: [0.21] };
StandAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [0.21] };
function WalkLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.WALK_LEFT], 3);
  this.motorSpeed = 10;
  this.timeline.push(
    WalkLeftAnimation.tlLeftHip,
    WalkLeftAnimation.tlLeftKnee,
    WalkLeftAnimation.tlRightHip,
    WalkLeftAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.01 },
    { x: 0, y: 0.03 },
    { x: 0, y: 0.05 },
    { x: 0, y: 0.07 },
    { x: 0, y: 0.09 },
    { x: 0, y: 0.09 },
    { x: 0, y: 0.07 },
    { x: 0, y: 0.05 },
    { x: 0, y: 0.03 },
    { x: 0, y: 0.01 },
  ];
  this.soundFx = { 0: AudioEffects.Walk, 5: AudioEffects.Walk };
}
WalkLeftAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-0.1, 0.5, 1.3, 0.9, 0.3, -0.3, -0.9, -1.3, -1, -0.6],
};
WalkLeftAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [-0.5, -0.9, -1.3, -1.5, -1.3, -1, -0.9, -0.3, -0.1, -0.2],
};
WalkLeftAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [-0.3, -0.9, -1.3, -1, -0.6, -0.1, 0.5, 1.3, 0.9, 0.3],
};
WalkLeftAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [-1.3, -1, -0.9, -0.3, -0.1, -0.2, -0.5, -0.9, -1.3, -1.5],
};
function WalkRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.WALK_RIGHT], 3);
  this.motorSpeed = 10;
  this.timeline.push(
    WalkRightAnimation.tlLeftHip,
    WalkRightAnimation.tlLeftKnee,
    WalkRightAnimation.tlRightHip,
    WalkRightAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.01 },
    { x: 0, y: 0.03 },
    { x: 0, y: 0.05 },
    { x: 0, y: 0.07 },
    { x: 0, y: 0.09 },
    { x: 0, y: 0.09 },
    { x: 0, y: 0.07 },
    { x: 0, y: 0.05 },
    { x: 0, y: 0.03 },
    { x: 0, y: 0.01 },
  ];
  this.soundFx = { 0: AudioEffects.Walk, 5: AudioEffects.Walk };
}
WalkRightAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [0.3, 0.9, 1.3, 1, 0.6, 0.1, -0.5, -1.3, -0.9, -0.3],
};
WalkRightAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [1.3, 1, 0.9, 0.3, 0.1, 0.2, 0.5, 0.9, 1.3, 1.5],
};
WalkRightAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [0.1, -0.5, -1.3, -0.9, -0.3, 0.3, 0.9, 1.3, 1, 0.6],
};
WalkRightAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [0.5, 0.9, 1.3, 1.5, 1.3, 1, 0.9, 0.3, 0.1, 0.2],
};
WalkRightAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [0.1, -0.5, -1.3, -0.9, -0.3, 0.3, 0.9, 1.3, 1, 0.6],
};
function CrouchLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.CROUCH_LEFT], 0);
  this.timeline.push(
    CrouchLeftAnimation.tlLeftHip,
    CrouchLeftAnimation.tlLeftKnee,
    CrouchLeftAnimation.tlRightHip,
    CrouchLeftAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.08 },
    { x: 0, y: 0.16 },
    { x: 0, y: 0.24 },
    { x: 0, y: 0.32 },
    { x: 0, y: 0.4 },
    { x: 0, y: 0.48 },
    { x: 0, y: 0.56 },
    { x: 0, y: 0.64 },
  ];
  this.frameRepeat = !1;
  this.motorSpeed = 10;
}
CrouchLeftAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-1, -1, -1.5, -1.5, -1.6, -1.7, -1.8, -1.8],
};
CrouchLeftAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [-0.8, -0.8, -1.3, -1.3, -1.9, -1.9, -1.9, -1.9],
};
CrouchLeftAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [0.2, 0.2, 0.2, 0.2, 0.2, 0.3, 0.4, 0.5],
};
CrouchLeftAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [-0.7, -0.7, -1.2, -1.2, -1.4, -1.6, -1.8, -1.8],
};
function CrouchRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.CROUCH_RIGHT], 0);
  this.timeline.push(
    CrouchRightAnimation.tlLeftHip,
    CrouchRightAnimation.tlLeftKnee,
    CrouchRightAnimation.tlRightHip,
    CrouchRightAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.08 },
    { x: 0, y: 0.16 },
    { x: 0, y: 0.24 },
    { x: 0, y: 0.32 },
    { x: 0, y: 0.4 },
    { x: 0, y: 0.48 },
    { x: 0, y: 0.56 },
    { x: 0, y: 0.64 },
  ];
  this.frameRepeat = !1;
  this.motorSpeed = 10;
}
CrouchRightAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-0.2, -0.2, -0.2, -0.2, -0.2, -0.3, -0.4, -0.5],
};
CrouchRightAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [0.7, 0.7, 1.2, 1.2, 1.4, 1.6, 1.8, 1.8],
};
CrouchRightAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [1, 1, 1.5, 1.5, 1.6, 1.7, 1.8, 1.8],
};
CrouchRightAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [0.8, 0.8, 1.3, 1.3, 1.9, 1.9, 1.9, 1.9],
};
function CrouchMoveLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.CROUCH_MOVE_LEFT], 4);
  this.timeline.push(
    CrouchMoveLeftAnimation.tlLeftHip,
    CrouchMoveLeftAnimation.tlLeftKnee,
    CrouchMoveLeftAnimation.tlRightHip,
    CrouchMoveLeftAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
  ];
}
CrouchMoveLeftAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-1.4, -1.1, -0.7, -0.2, 0.3, -0.1, -0.6, -1.1, -1.4, -1.7],
};
CrouchMoveLeftAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [-1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5],
};
CrouchMoveLeftAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [0.1, -0.5, -0.7, -1.4, -1.7, -1.4, -0.7, -0.5, -0, 0.5],
};
CrouchMoveLeftAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [-1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5, -1.5],
};
function CrouchMoveRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.CROUCH_MOVE_RIGHT], 4);
  this.timeline.push(
    CrouchMoveRightAnimation.tlLeftHip,
    CrouchMoveRightAnimation.tlLeftKnee,
    CrouchMoveRightAnimation.tlRightHip,
    CrouchMoveRightAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
    { x: 0, y: 0.34 },
  ];
}
CrouchMoveRightAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-0.1, 0.5, 0.7, 1.4, 1.7, 1.4, 0.7, 0.5, 0, -0.5],
};
CrouchMoveRightAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5],
};
CrouchMoveRightAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [1.4, 1.1, 0.7, 0.2, -0.3, 0.1, 0.6, 1.1, 1.4, 1.7],
};
CrouchMoveRightAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5],
};
function HoldGunLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.HOLD_GUN_LEFT], 0);
  this.timeline.push(
    HoldGunLeftAnimation.tlLeftShoulder,
    HoldGunLeftAnimation.tlLeftElbow,
    HoldGunLeftAnimation.tlRightShoulder,
    HoldGunLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
  this.frameRepeat = !1;
}
HoldGunLeftAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [0.1] };
HoldGunLeftAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [1] };
HoldGunLeftAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [0.1] };
HoldGunLeftAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [1.5] };
function HoldGunRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.HOLD_GUN_RIGHT], 0);
  this.timeline.push(
    HoldGunRightAnimation.tlLeftShoulder,
    HoldGunRightAnimation.tlLeftElbow,
    HoldGunRightAnimation.tlRightShoulder,
    HoldGunRightAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
  this.frameRepeat = !1;
}
HoldGunRightAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [-0.1] };
HoldGunRightAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [-1.5] };
HoldGunRightAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [0.1] };
HoldGunRightAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [-1] };
function ScopeGunLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SCOPE_GUN_LEFT], 0);
  this.timeline.push(
    ScopeGunLeftAnimation.tlLeftShoulder,
    ScopeGunLeftAnimation.tlLeftElbow,
    ScopeGunLeftAnimation.tlRightShoulder,
    ScopeGunLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
}
ScopeGunLeftAnimation.gearOffset = { x: 8, y: -26 };
ScopeGunLeftAnimation.gearOffsetSteps = 2;
ScopeGunLeftAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [-0.1] };
ScopeGunLeftAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [1.6] };
ScopeGunLeftAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [0.1] };
ScopeGunLeftAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [2.2] };
function ScopeGunRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SCOPE_GUN_RIGHT], 0);
  this.timeline.push(
    ScopeGunRightAnimation.tlLeftShoulder,
    ScopeGunRightAnimation.tlLeftElbow,
    ScopeGunRightAnimation.tlRightShoulder,
    ScopeGunRightAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
}
ScopeGunRightAnimation.gearOffset = { x: -8, y: -26 };
ScopeGunRightAnimation.gearOffsetSteps = 2;
ScopeGunRightAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [-0.1] };
ScopeGunRightAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [-2.2] };
ScopeGunRightAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [0.1] };
ScopeGunRightAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [-1.6] };
function ThrowNadeLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.THROW_NADE_LEFT], 0);
  this.timeline.push(
    ThrowNadeLeftAnimation.tlLeftShoulder,
    ThrowNadeLeftAnimation.tlLeftElbow,
    ThrowNadeLeftAnimation.tlRightShoulder,
    ThrowNadeLeftAnimation.tlRightElbow
  );
  this.frameRepeat = !1;
  this.motorSpeed = 25;
}
ThrowNadeLeftAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [
    -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1,
  ],
};
ThrowNadeLeftAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1],
};
ThrowNadeLeftAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [-0, -0.3, -0.6, -0.9, -1.2, -1.5, -1.8, -1.5, -1.2, -0.9, -0.6, -0.3, -0],
};
ThrowNadeLeftAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1],
};
function ThrowNadeRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.THROW_NADE_RIGHT], 0);
  this.timeline.push(
    ThrowNadeRightAnimation.tlLeftShoulder,
    ThrowNadeRightAnimation.tlLeftElbow,
    ThrowNadeRightAnimation.tlRightShoulder,
    ThrowNadeRightAnimation.tlRightElbow
  );
  this.frameRepeat = !1;
  this.motorSpeed = 25;
}
ThrowNadeRightAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 1.5, 1.2, 0.9, 0.6, 0.3, 0],
};
ThrowNadeRightAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [-1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1],
};
ThrowNadeRightAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
};
ThrowNadeRightAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [-1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1],
};
function RollLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.ROLL_LEFT], 0);
  this.soundFx = { 0: AudioEffects.Flip, finish: !0 };
}
function RollRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.ROLL_RIGHT], 0);
  this.soundFx = { 0: AudioEffects.Flip, finish: !0 };
}
function JumpLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.JUMP_LEFT], 0);
  this.timeline.push(
    JumpLeftAnimation.tlLeftHip,
    JumpLeftAnimation.tlLeftKnee,
    JumpLeftAnimation.tlRightHip,
    JumpLeftAnimation.tlRightKnee
  );
  this.frameRepeat = !1;
  this.motorSpeed = 20;
  this.soundFx = { 0: AudioEffects.Jump, finish: !0 };
}
JumpLeftAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [-2, -2.55, -2.55, -2] };
JumpLeftAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [-2, -2.55, -2.55, -2.6] };
JumpLeftAnimation.tlRightHip = { joint: "righthipjoint", frames: [-2, -2.55, -2.55, -2] };
JumpLeftAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [-2, -2.55, -2.55, -2.6] };
function JumpRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.JUMP_RIGHT], 0);
  this.timeline.push(
    JumpRightAnimation.tlLeftHip,
    JumpRightAnimation.tlLeftKnee,
    JumpRightAnimation.tlRightHip,
    JumpRightAnimation.tlRightKnee
  );
  this.frameRepeat = !1;
  this.motorSpeed = 20;
  this.soundFx = { 0: AudioEffects.Jump, finish: !0 };
}
JumpRightAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [2, 2.55, 2.55, 2] };
JumpRightAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [2, 2.55, 2.55, 2.6] };
JumpRightAnimation.tlRightHip = { joint: "righthipjoint", frames: [2, 2.55, 2.55, 2] };
JumpRightAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [2, 2.55, 2.55, 2.6] };
function ThrowLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.THROW_LEFT], 0);
  this.timeline.push(
    ThrowLeftAnimation.tlLeftShoulder,
    ThrowLeftAnimation.tlLeftElbow,
    ThrowLeftAnimation.tlRightShoulder,
    ThrowLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 14;
}
ThrowLeftAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [-1.5, -1.5, -1.5, -1.5],
};
ThrowLeftAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [1.5, 1.5, 1.5, 1.5] };
ThrowLeftAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [-2, -2, -2, -2] };
ThrowLeftAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [1.1, 1.1, 1.1, 1.1] };
function ThrowRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.THROW_RIGHT], 0);
  this.timeline.push(
    ThrowRightAnimation.tlLeftShoulder,
    ThrowRightAnimation.tlLeftElbow,
    ThrowRightAnimation.tlRightShoulder,
    ThrowRightAnimation.tlRightElbow
  );
  this.motorSpeed = 14;
}
ThrowRightAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [2, 2, 2, 2] };
ThrowRightAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [-1.1, -1.1, -1.1, -1.1] };
ThrowRightAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [1.5, 1.5, 1.5, 1.5] };
ThrowRightAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [-1.5, -1.5, -1.5, -1.5] };
function JetLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.JET_LEFT], 0);
  this.timeline.push(
    JetLeftAnimation.tlLeftHip,
    JetLeftAnimation.tlLeftKnee,
    JetLeftAnimation.tlRightHip,
    JetLeftAnimation.tlRightKnee
  );
  this.frameRepeat = !1;
}
JetLeftAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [-0.55, -0.65, -0.75, -0.85] };
JetLeftAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [-0.57, -0.9, -1.4, -1.87] };
JetLeftAnimation.tlRightHip = { joint: "righthipjoint", frames: [0, 0, 0, 0] };
JetLeftAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [-0.55, -0.65, -0.75, -0.85] };
function JetRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.JET_RIGHT], 0);
  this.timeline.push(
    JetRightAnimation.tlLeftHip,
    JetRightAnimation.tlLeftKnee,
    JetRightAnimation.tlRightHip,
    JetRightAnimation.tlRightKnee
  );
  this.frameRepeat = !1;
}
JetRightAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [0, 0, 0, 0] };
JetRightAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [0.55, 0.65, 0.75, 0.85] };
JetRightAnimation.tlRightHip = { joint: "righthipjoint", frames: [0.55, 0.65, 0.75, 0.85] };
JetRightAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [0.57, 0.9, 1.4, 1.87] };
function ReloadLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.RELOAD_LEFT], 4);
  this.timeline.push(
    ReloadLeftAnimation.tlLeftShoulder,
    ReloadLeftAnimation.tlLeftElbow,
    ReloadLeftAnimation.tlRightShoulder,
    ReloadLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 6;
}
ReloadLeftAnimation.gearOffset = { x: 0, y: -40 };
ReloadLeftAnimation.gearOffsetSteps = 2;
ReloadLeftAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [-0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1],
};
ReloadLeftAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [1.85, 1.85, 1.85, 1.85, 1.85, 1.85, 1.85, 1.85, 1.85, 1.85],
};
ReloadLeftAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [0.3, 0.1, -0.1, 0.3, 0.6, 0.9, 0.6, 0.3, 0.1, 0.3],
};
ReloadLeftAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [2.2, 2.2, 2.2, 2.2, 2.2, 2.2, 2.2, 2.2, 2.2, 2.2],
};
function ReloadRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.RELOAD_RIGHT], 4);
  this.timeline.push(
    ReloadRightAnimation.tlLeftShoulder,
    ReloadRightAnimation.tlLeftElbow,
    ReloadRightAnimation.tlRightShoulder,
    ReloadRightAnimation.tlRightElbow
  );
  this.motorSpeed = 6;
}
ReloadRightAnimation.gearOffset = { x: 0, y: -40 };
ReloadRightAnimation.gearOffsetSteps = 2;
ReloadRightAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [-0.3, -0.1, 0.1, -0.3, -0.6, -0.9, -0.6, -0.3, -0.1, -0.3],
};
ReloadRightAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [-2.2, -2.2, -2.2, -2.2, -2.2, -2.2, -2.2, -2.2, -2.2, -2.2],
};
ReloadRightAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
};
ReloadRightAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [-1.85, -1.85, -1.85, -1.85, -1.85, -1.85, -1.85, -1.85, -1.85, -1.85],
};
function PunchLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PUNCH_LEFT], 0);
  this.timeline.push(
    PunchLeftAnimation.tlLeftShoulder,
    PunchLeftAnimation.tlLeftElbow,
    PunchLeftAnimation.tlRightShoulder,
    PunchLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
}
PunchLeftAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [
    -2.1, -1.8, -1.5, -1.2, -0.9, -0.6, -0.3, -0.3, -0.3, -0.3, -0.3, -0.6, -0.9, -1.2, -1.5, -1.8,
  ],
};
PunchLeftAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [-0.4, -0.2, -0, 0.2, 0.4, 0.7, 1, 1, 1.7, 1.7, 1.7, 1.7, 1, 0.4, 0.1, -0.2],
};
PunchLeftAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [
    -0.3, -0.3, -0.6, -0.9, -1.2, -1.5, -1.8, -2.1, -1.8, -1.5, -1.2, -0.9, -0.6, -0.3, -0.3, -0.3,
  ],
};
PunchLeftAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [1.7, 1.7, 1, 0.4, 0.1, -0.2, -0.4, -0.2, -0, 0.2, 0.4, 0.7, 1, 1, 1.7, 1.7],
};
function PunchRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PUNCH_RIGHT], 0);
  this.timeline.push(
    PunchRightAnimation.tlLeftShoulder,
    PunchRightAnimation.tlLeftElbow,
    PunchRightAnimation.tlRightShoulder,
    PunchRightAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
}
PunchRightAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [0.3, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1, 1.8, 1.5, 1.2, 0.9, 0.6, 0.3, 0.3, 0.3],
};
PunchRightAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [-1.7, -1.7, -1, -0.4, -0.1, 0.2, 0.4, 0.2, 0, -0.2, -0.4, -0.7, -1, -1, -1.7, -1.7],
};
PunchRightAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [2.1, 1.8, 1.5, 1.2, 0.9, 0.6, 0.3, 0.3, 0.3, 0.3, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8],
};
PunchRightAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [0.4, 0.2, 0, -0.2, -0.4, -0.7, -1, -1, -1.7, -1.7, -1.7, -1.7, -1, -0.4, -0.1, 0.2],
};
function FallLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.FALL_LEFT], 0);
  this.timeline.push(
    FallLeftAnimation.tlLeftHip,
    FallLeftAnimation.tlLeftKnee,
    FallLeftAnimation.tlRightHip,
    FallLeftAnimation.tlRightKnee
  );
  this.motorSpeed = 16;
}
FallLeftAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [-0.3] };
FallLeftAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [-0.6] };
FallLeftAnimation.tlRightHip = { joint: "righthipjoint", frames: [0.1] };
FallLeftAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [-0.3] };
function FallRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.FALL_RIGHT], 0);
  this.timeline.push(
    FallRightAnimation.tlLeftHip,
    FallRightAnimation.tlLeftKnee,
    FallRightAnimation.tlRightHip,
    FallRightAnimation.tlRightKnee
  );
  this.motorSpeed = 16;
}
FallRightAnimation.tlLeftHip = { joint: "lefthipjoint", frames: [-0.1] };
FallRightAnimation.tlLeftKnee = { joint: "leftkneejoint", frames: [0.3] };
FallRightAnimation.tlRightHip = { joint: "righthipjoint", frames: [0.3] };
FallRightAnimation.tlRightKnee = { joint: "rightkneejoint", frames: [0.6] };
function ProneLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_LEFT], 0);
  this.timeline.push(
    ProneLeftAnimation.tlLeftHip,
    ProneLeftAnimation.tlLeftKnee,
    ProneLeftAnimation.tlRightHip,
    ProneLeftAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.04 },
    { x: 0, y: 0.8 },
    { x: 0, y: 0.12 },
    { x: 0, y: 0.16 },
    { x: 0, y: 0.2 },
    { x: 0, y: 0.24 },
    { x: 0, y: 0.28 },
    { x: 0, y: 0.32 },
  ];
  this.frameRepeat = !1;
  this.motorSpeed = 20;
}
ProneLeftAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-0.1, -0.15, -0.2, -0.25, -0.3, -0.35, -0.35, -0.35],
};
ProneLeftAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [-0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3, -0.3],
};
ProneLeftAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [0.1, 0.1, -0, -0.1, -0.2, -0.3, -0.4, -0.5],
};
ProneLeftAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [0.1, 0.05, 0, -0.05, -0.1, -0.15, -0.2, -0.25],
};
function ProneRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_RIGHT], 0);
  this.timeline.push(
    ProneRightAnimation.tlLeftHip,
    ProneRightAnimation.tlLeftKnee,
    ProneRightAnimation.tlRightHip,
    ProneRightAnimation.tlRightKnee
  );
  this.offsets = [
    { x: 0, y: 0.04 },
    { x: 0, y: 0.8 },
    { x: 0, y: 0.12 },
    { x: 0, y: 0.16 },
    { x: 0, y: 0.2 },
    { x: 0, y: 0.24 },
    { x: 0, y: 0.28 },
    { x: 0, y: 0.32 },
  ];
  this.frameRepeat = !1;
  this.motorSpeed = 20;
}
ProneRightAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [-0.1, -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5],
};
ProneRightAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [-0.1, -0.05, -0, 0.05, 0.1, 0.15, 0.2, 0.25],
};
ProneRightAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.35, 0.35],
};
ProneRightAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3],
};
function ProneScopeGunLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_SCOPE_LEFT], 0);
  this.timeline.push(
    ProneScopeGunLeftAnimation.tlLeftShoulder,
    ProneScopeGunLeftAnimation.tlLeftElbow,
    ProneScopeGunLeftAnimation.tlRightShoulder,
    ProneScopeGunLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
}
ProneScopeGunLeftAnimation.gearOffset = { x: -15, y: -25 };
ProneScopeGunLeftAnimation.gearOffsetSteps = 2;
ProneScopeGunLeftAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [-1.5] };
ProneScopeGunLeftAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [1.5] };
ProneScopeGunLeftAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [-1] };
ProneScopeGunLeftAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [1.8] };
function ProneScopeGunRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_SCOPE_RIGHT], 0);
  this.timeline.push(
    ProneScopeGunRightAnimation.tlLeftShoulder,
    ProneScopeGunRightAnimation.tlLeftElbow,
    ProneScopeGunRightAnimation.tlRightShoulder,
    ProneScopeGunRightAnimation.tlRightElbow
  );
  this.motorSpeed = 30;
}
ProneScopeGunRightAnimation.gearOffset = { x: 15, y: -25 };
ProneScopeGunRightAnimation.gearOffsetSteps = 2;
ProneScopeGunRightAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [1] };
ProneScopeGunRightAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [-1.8] };
ProneScopeGunRightAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [1.5] };
ProneScopeGunRightAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [-1.5] };
function ProneEndAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_END], 0);
}
function ProneMoveLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_MOVE_LEFT], 1);
  this.timeline.push(
    ProneMoveLeftAnimation.tlLeftHip,
    ProneMoveLeftAnimation.tlLeftKnee,
    ProneMoveLeftAnimation.tlRightHip,
    ProneMoveLeftAnimation.tlRightKnee
  );
  this.frameRepeat = !0;
  this.motorSpeed = 7;
}
ProneMoveLeftAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [
    -0.35, -0.37, -0.39, -0.42, -0.44, -0.46, -0.48, -0.5, -0.52, -0.55, -0.57, -0.59, -0.61, -0.63,
    -0.66, -0.68, -0.7, -0.7, -0.66, -0.61, -0.57, -0.52, -0.48, -0.44, -0.39, -0.35,
  ],
};
ProneMoveLeftAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [
    -1, -0.94, -0.88, -0.82, -0.77, -0.71, -0.65, -0.59, -0.53, -0.48, -0.42, -0.36, -0.3, -0.3,
    -0.36, -0.42, -0.47, -0.53, -0.59, -0.65, -0.71, -0.77, -0.82, -0.88, -0.94, -1,
  ],
};
ProneMoveLeftAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [
    -1.5, -1.42, -1.33, -1.25, -1.17, -1.08, -1, -0.92, -0.83, -0.75, -0.67, -0.58, -0.5, -0.5,
    -0.58, -0.67, -0.75, -0.83, -0.92, -1, -1.08, -1.17, -1.25, -1.33, -1.42, -1.5,
  ],
};
ProneMoveLeftAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [
    -0.5, -0.54, -0.58, -0.62, -0.67, -0.71, -0.75, -0.79, -0.83, -0.87, -0.92, -0.96, -1, -1,
    -0.96, -0.92, -0.87, -0.83, -0.79, -0.75, -0.71, -0.67, -0.62, -0.58, -0.54, -0.5,
  ],
};
function ProneMoveRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.PRONE_MOVE_RIGHT], 1);
  this.timeline.push(
    ProneMoveRightAnimation.tlLeftHip,
    ProneMoveRightAnimation.tlLeftKnee,
    ProneMoveRightAnimation.tlRightHip,
    ProneMoveRightAnimation.tlRightKnee
  );
  this.frameRepeat = !0;
  this.motorSpeed = 7;
}
ProneMoveRightAnimation.tlLeftHip = {
  joint: "lefthipjoint",
  frames: [
    1.5, 1.42, 1.33, 1.25, 1.17, 1.08, 1, 0.92, 0.83, 0.75, 0.67, 0.58, 0.5, 0.5, 0.58, 0.67, 0.75,
    0.83, 0.92, 1, 1.08, 1.17, 1.25, 1.33, 1.42, 1.5,
  ],
};
ProneMoveRightAnimation.tlLeftKnee = {
  joint: "leftkneejoint",
  frames: [
    0.5, 0.54, 0.58, 0.63, 0.67, 0.71, 0.75, 0.79, 0.83, 0.88, 0.92, 0.96, 1, 1, 0.96, 0.92, 0.88,
    0.83, 0.79, 0.75, 0.71, 0.67, 0.63, 0.58, 0.54, 0.5,
  ],
};
ProneMoveRightAnimation.tlRightHip = {
  joint: "righthipjoint",
  frames: [
    0.35, 0.38, 0.41, 0.44, 0.47, 0.5, 0.52, 0.55, 0.58, 0.61, 0.64, 0.67, 0.7, 0.7, 0.67, 0.64,
    0.61, 0.58, 0.55, 0.52, 0.5, 0.47, 0.44, 0.41, 0.38, 0.35,
  ],
};
ProneMoveRightAnimation.tlRightKnee = {
  joint: "rightkneejoint",
  frames: [
    1, 0.94, 0.88, 0.83, 0.77, 0.71, 0.65, 0.59, 0.53, 0.48, 0.42, 0.36, 0.3, 0.3, 0.36, 0.42, 0.48,
    0.53, 0.59, 0.65, 0.71, 0.77, 0.83, 0.88, 0.94, 1,
  ],
};
function SwitchLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SWITCH_LEFT], 0);
  this.timeline.push(
    SwitchLeftAnimation.tlLeftShoulder,
    SwitchLeftAnimation.tlLeftElbow,
    SwitchLeftAnimation.tlRightShoulder,
    SwitchLeftAnimation.tlRightElbow
  );
  this.frameRepeat = !1;
  this.motorSpeed = 15;
}
SwitchLeftAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, -0.1],
};
SwitchLeftAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1],
};
SwitchLeftAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [-2, -2, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -0.5, -0],
};
SwitchLeftAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [2.9, 2.9, 2.9, 2.9, 2.9, 2.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1],
};
function SwitchRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SWITCH_RIGHT], 0);
  this.timeline.push(
    SwitchRightAnimation.tlLeftShoulder,
    SwitchRightAnimation.tlLeftElbow,
    SwitchRightAnimation.tlRightShoulder,
    SwitchRightAnimation.tlRightElbow
  );
  this.frameRepeat = !1;
  this.motorSpeed = 15;
}
SwitchRightAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [2, 2, 1.9, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.1, 0.5, 0],
};
SwitchRightAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [-2.9, -2.9, -2.9, -2.9, -2.9, -2.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1],
};
SwitchRightAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [-1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, 0.1],
};
SwitchRightAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [-1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1, -1.1],
};
function JumpLeft2Animation() {
  Animation.call(this, Animation.DURATIONS[Animation.JUMP_LEFT_2], 0);
  this.timeline.push(
    JumpLeft2Animation.tlLeftHip,
    JumpLeft2Animation.tlLeftKnee,
    JumpLeft2Animation.tlRightHip,
    JumpLeft2Animation.tlRightKnee
  );
  this.frameRepeat = !1;
  this.motorSpeed = 20;
}
JumpLeft2Animation.tlLeftHip = { joint: "lefthipjoint", frames: [-0.85, -0.85, -0.85, -0.85] };
JumpLeft2Animation.tlLeftKnee = { joint: "leftkneejoint", frames: [-1.1, -1.1, -1.1, -1.1] };
JumpLeft2Animation.tlRightHip = { joint: "righthipjoint", frames: [0.8, 0.8, 0.8, 0.8] };
JumpLeft2Animation.tlRightKnee = { joint: "rightkneejoint", frames: [-0, -0, -0, -0] };
function JumpRight2Animation() {
  Animation.call(this, Animation.DURATIONS[Animation.JUMP_RIGHT_2], 0);
  this.timeline.push(
    JumpRight2Animation.tlLeftHip,
    JumpRight2Animation.tlLeftKnee,
    JumpRight2Animation.tlRightHip,
    JumpRight2Animation.tlRightKnee
  );
  this.frameRepeat = !1;
  this.motorSpeed = 20;
}
JumpRight2Animation.tlLeftHip = { joint: "lefthipjoint", frames: [-0.8, -0.8, -0.8, -0.8] };
JumpRight2Animation.tlLeftKnee = { joint: "leftkneejoint", frames: [0, 0, 0, 0] };
JumpRight2Animation.tlRightHip = { joint: "righthipjoint", frames: [0.85, 0.85, 0.85, 0.85] };
JumpRight2Animation.tlRightKnee = { joint: "rightkneejoint", frames: [1.1, 1.1, 1.1, 1.1] };
function ShootBowLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SHOOT_BOW_LEFT], 0);
  this.timeline.push(
    ShootBowLeftAnimation.tlLeftShoulder,
    ShootBowLeftAnimation.tlLeftElbow,
    ShootBowLeftAnimation.tlRightShoulder,
    ShootBowLeftAnimation.tlRightElbow
  );
  this.motorSpeed = 40;
}
ShootBowLeftAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
};
ShootBowLeftAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
};
ShootBowLeftAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [
    -0.3, -0.3, -0.6, -0.9, -1.2, -1.5, -1.8, -2.1, -1.8, -1.5, -1.2, -0.9, -0.6, -0.3, -0.3, -0.3,
  ],
};
ShootBowLeftAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [1.7, 1.7, 1, 0.4, 0.1, -0.2, -0.4, -0.2, -0, 0.2, 0.4, 0.7, 1, 1, 1.7, 1.7],
};
function ShootBowRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SHOOT_BOW_RIGHT], 0);
  this.timeline.push(
    ShootBowRightAnimation.tlLeftShoulder,
    ShootBowRightAnimation.tlLeftElbow,
    ShootBowRightAnimation.tlRightShoulder,
    ShootBowRightAnimation.tlRightElbow
  );
  this.motorSpeed = 40;
}
ShootBowRightAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [0.3, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1, 1.8, 1.5, 1.2, 0.9, 0.6, 0.3, 0.3, 0.3],
};
ShootBowRightAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [-1.7, -1.7, -1, -0.4, -0.1, 0.2, 0.4, 0.2, 0, -0.2, -0.4, -0.7, -1, -1, -1.7, -1.7],
};
ShootBowRightAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
};
ShootBowRightAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
};
function WaveLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.WAVE_LEFT], 0);
  this.timeline.push(WaveLeftAnimation.tlRightShoulder, WaveLeftAnimation.tlRightElbow);
  this.motorSpeed = 10;
}
WaveLeftAnimation.tlRightShoulder = {
  joint: "rightshoulderjoint",
  frames: [-4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4],
};
WaveLeftAnimation.tlRightElbow = {
  joint: "rightelbowjoint",
  frames: [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0],
};
function WaveRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.WAVE_RIGHT], 0);
  this.timeline.push(WaveRightAnimation.tlLeftShoulder, WaveRightAnimation.tlLeftElbow);
  this.motorSpeed = 10;
}
WaveRightAnimation.tlLeftShoulder = {
  joint: "leftshoulderjoint",
  frames: [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
};
WaveRightAnimation.tlLeftElbow = {
  joint: "leftelbowjoint",
  frames: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
};
function SaluteLeftAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SALUTE_LEFT], 0);
  this.timeline.push(SaluteLeftAnimation.tlRightShoulder, SaluteLeftAnimation.tlRightElbow);
  this.motorSpeed = 30;
}
SaluteLeftAnimation.tlRightShoulder = { joint: "rightshoulderjoint", frames: [-3] };
SaluteLeftAnimation.tlRightElbow = { joint: "rightelbowjoint", frames: [-1] };
function SaluteRightAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.SALUTE_RIGHT], 0);
  this.timeline.push(SaluteRightAnimation.tlLeftShoulder, SaluteRightAnimation.tlLeftElbow);
  this.motorSpeed = 30;
}
SaluteRightAnimation.tlLeftShoulder = { joint: "leftshoulderjoint", frames: [3] };
SaluteRightAnimation.tlLeftElbow = { joint: "leftelbowjoint", frames: [1] };
function ChatAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.CHAT], 0);
}
function ChatEndAnimation() {
  Animation.call(this, Animation.DURATIONS[Animation.CHAT_END], 0);
}
var Animations = {};
Animations[Animation.STAND] = new StandAnimation();
Animations[Animation.WALK_LEFT] = new WalkLeftAnimation();
Animations[Animation.WALK_RIGHT] = new WalkRightAnimation();
Animations[Animation.CROUCH_LEFT] = new CrouchLeftAnimation();
Animations[Animation.CROUCH_RIGHT] = new CrouchRightAnimation();
Animations[Animation.CROUCH_MOVE_LEFT] = new CrouchMoveLeftAnimation();
Animations[Animation.CROUCH_MOVE_RIGHT] = new CrouchMoveRightAnimation();
Animations[Animation.HOLD_GUN_LEFT] = new HoldGunLeftAnimation();
Animations[Animation.HOLD_GUN_RIGHT] = new HoldGunRightAnimation();
Animations[Animation.SCOPE_GUN_LEFT] = new ScopeGunLeftAnimation();
Animations[Animation.SCOPE_GUN_RIGHT] = new ScopeGunRightAnimation();
Animations[Animation.THROW_NADE_LEFT] = new ThrowNadeLeftAnimation();
Animations[Animation.THROW_NADE_RIGHT] = new ThrowNadeRightAnimation();
Animations[Animation.ROLL_LEFT] = new RollLeftAnimation();
Animations[Animation.ROLL_RIGHT] = new RollRightAnimation();
Animations[Animation.JUMP_LEFT] = new JumpLeftAnimation();
Animations[Animation.JUMP_RIGHT] = new JumpRightAnimation();
Animations[Animation.THROW_LEFT] = new ThrowLeftAnimation();
Animations[Animation.THROW_RIGHT] = new ThrowRightAnimation();
Animations[Animation.JET_LEFT] = new JetLeftAnimation();
Animations[Animation.JET_RIGHT] = new JetRightAnimation();
Animations[Animation.RELOAD_LEFT] = new ReloadLeftAnimation();
Animations[Animation.RELOAD_RIGHT] = new ReloadRightAnimation();
Animations[Animation.PUNCH_LEFT] = new PunchLeftAnimation();
Animations[Animation.PUNCH_RIGHT] = new PunchRightAnimation();
Animations[Animation.FALL_LEFT] = new FallLeftAnimation();
Animations[Animation.FALL_RIGHT] = new FallRightAnimation();
Animations[Animation.PRONE_LEFT] = new ProneLeftAnimation();
Animations[Animation.PRONE_RIGHT] = new ProneRightAnimation();
Animations[Animation.PRONE_SCOPE_LEFT] = new ProneScopeGunLeftAnimation();
Animations[Animation.PRONE_SCOPE_RIGHT] = new ProneScopeGunRightAnimation();
Animations[Animation.PRONE_END] = new ProneEndAnimation();
Animations[Animation.PRONE_MOVE_LEFT] = new ProneMoveLeftAnimation();
Animations[Animation.PRONE_MOVE_RIGHT] = new ProneMoveRightAnimation();
Animations[Animation.SWITCH_LEFT] = new SwitchLeftAnimation();
Animations[Animation.SWITCH_RIGHT] = new SwitchRightAnimation();
Animations[Animation.JUMP_LEFT_2] = new JumpLeft2Animation();
Animations[Animation.JUMP_RIGHT_2] = new JumpRight2Animation();
Animations[Animation.SHOOT_BOW_LEFT] = new ShootBowLeftAnimation();
Animations[Animation.SHOOT_BOW_RIGHT] = new ShootBowRightAnimation();
Animations[Animation.WAVE_LEFT] = new WaveLeftAnimation();
Animations[Animation.WAVE_RIGHT] = new WaveRightAnimation();
Animations[Animation.SALUTE_LEFT] = new SaluteLeftAnimation();
Animations[Animation.SALUTE_RIGHT] = new SaluteRightAnimation();
Animations[Animation.CHAT] = new ChatAnimation();
Animations[Animation.CHAT_END] = new ChatEndAnimation();
var physicsworker = {};
b2Vec2 = Box2D.b2Vec2;
b2AABB = Box2D.b2AABB;
b2BodyDef = Box2D.b2BodyDef;
b2Body = Box2D.b2Body;
b2FixtureDef = Box2D.b2FixtureDef;
b2Fixture = Box2D.b2Fixture;
b2World = Box2D.b2World;
var b2WorldManifold = Box2D.Collision.b2WorldManifold;
b2PolygonShape = Box2D.b2PolygonShape;
b2CircleShape = Box2D.b2CircleShape;
var b2ContactListener = Box2D.b2ContactListener,
  b2DestructionListener = Box2D.b2DestructionListener,
  b2Filter = Box2D.b2Filter,
  b2BodyType = Box2D.b2BodyType || Box2D.b2_dynamicBody;
class PhysicsWorker {
  constructor(a) {
    this.onMessage = a;
    this.timeWarp = 0.25;
    this.deltatime = (1 - this.timeWarp) / 60;
    this.continuous = {};
    this.contact = {};
    this.solved = {};
    this.containsFluid = !1;
    this.anchors = {};
    this.joints = {};
    this.fluids = {};
    this.submerged = {};
    this.hasSurfaced = {};
    this.hasSubmerged = {};
    this.entities = {};
    this.dynamics = {};
    this.kinematics = {};
    this.world = new b2World(new b2Vec2(PC.GRAVITY.x, PC.GRAVITY.y), !0);
    this.contactListener = new b2ContactListener();
    this.destructionListener = new b2DestructionListener();
    this.destructionListener.SayGoodbyeJoint = this.onDestroyJoint.bind(this);
    this.beginManifold = new b2WorldManifold();
    this.preManifold = new b2WorldManifold();
    this.postManifold = new b2WorldManifold();
    this.contactListener.BeginContact = this.beginContact.bind(this);
    this.contactListener.EndContact = this.endContact.bind(this);
    this.contactListener.PreSolve = this.preSolve.bind(this);
    this.world.SetContactListener(this.contactListener);
    this.world.SetDestructionListener(this.destructionListener);
    BodyFactory.world = this.world;
    this.MsgMap = [];
    this.MsgMap[PhysicsMessage.RESET] = this.resetSimulation.bind(this);
  }
  pushMessage(a) {
    this.MsgMap[a.t](a.d);
  }
  raycast(a, b, c) {
    var d = new RaycastCallback(b, a);
    this.world.RayCast(d, b, c);
    if (d.fix && d.pt) {
      b = d.fix.GetFilterData().categoryBits;
      c = d.fix.m_body;
      if (b === EntityCategory.LOCAL) {
        for (
          var e = c.GetPosition().x - a.p.x / PC.PM_RATIO,
            f = c.GetPosition().y - a.p.y / PC.PM_RATIO,
            g = Math.sqrt(e * e + f * f),
            h = c.m_jointList;
          h;
          h = h.m_next
        )
          this.world.DestroyJoint(h.joint);
        c.ApplyImpulse(
          {
            x: 0.5 * a.p.vx + (e / g) * 4 + -4 + 8 * Math.random(),
            y: 0.5 * a.p.vy + (f / g) * 4 + -4 + 8 * Math.random(),
          },
          { x: d.pt.x, y: d.pt.y }
        );
      }
      return { p: d.pt, c: b, normal: d.normal, id: c ? c.GetUserData() : null };
    }
    return !1;
  }
  explosion(a, b) {
    var c = [],
      d = [];
    a = { x: a.x / PC.PM_RATIO, y: a.y / PC.PM_RATIO };
    var e = new b2AABB();
    e.lowerBound.Set(a.x - b.radius, a.y - b.radius);
    e.upperBound.Set(a.x + b.radius, a.y + b.radius);
    this.world.QueryAABB(function (l) {
      0 ===
        (l.GetFilterData().categoryBits &
          (EntityCategory.PARTICLE |
            EntityCategory.OBJECTIVE |
            EntityCategory.ZONE |
            EntityCategory.AGENT |
            EntityCategory.ENTITY)) && d.push(l.m_body);
      return !0;
    }, e);
    for (e = d.length; 0 < e; ) {
      var f = d[--e],
        g = f.GetPosition(),
        h = g.x - a.x,
        k = g.y - a.y - 1,
        m = new ExplosionRayCallback(a, f);
      this.world.RayCast(m, a, g);
      f.GetType() === b2BodyType.b2_dynamicBody &&
        void 0 !== this.dynamics[f.GetUserData()] &&
        !this.dynamics[f.GetUserData()].ignoreExp &&
        (0 === m.frac || (m.fix && m.fix.m_body === f)) &&
        ((g = Math.sqrt(h * h + k * k)),
        (h = Math.atan2(k, h)),
        (k = (1 / g.clamp(1, g)) * b.radius),
        (k = b.blast * k.clamp(0, 1.6)),
        (h = new b2Vec2(k * Math.cos(h), k * Math.sin(h))),
        f.ApplyImpulse({ x: h.x, y: h.y }, m.pt),
        c.push(f.GetUserData()));
    }
    return c;
  }
  resetSimulation() {
    this.world = new b2World(new b2Vec2(PC.GRAVITY.x, PC.GRAVITY.y), !0);
    this.world.SetGravity(new b2Vec2(PC.GRAVITY.x, PC.GRAVITY.y));
    this.world.SetContactListener(this.contactListener);
    this.world.SetDestructionListener(this.destructionListener);
    BodyFactory.world = this.world;
    this.anchors = {};
    this.joints = {};
    this.continuous = {};
    this.contact = {};
    this.solved = {};
    this.fluids = {};
    this.containsFluid = !1;
    this.submerged = {};
    this.hasSurfaced = {};
    this.hasSubmerged = {};
    this.dynamics = {};
    this.kinematics = {};
    this.entities = {};
  }
  onDestroyJoint(a) {
    a = a.GetUserData();
    this.joints[a] && (this.joints[a].GetBodyB().SetGravityScale(0.6), delete this.joints[a]);
  }
  connectBodies(a) {
    let b = this.dynamics[a.idA];
    var c = this.dynamics[a.idB];
    if (b && c) {
      var d = {
          type: GameAttribute.REVOLUTE_JOINT,
          motor: 0,
          motorTorque: 0,
          collide: 0,
          limit: 0,
          lowerAngle: 1.5 * Math.PI - 0.9,
          upperAngle: 1.5 * Math.PI + 0.9,
          angle: 0.6 * -Math.PI,
          id: a.idB,
        },
        e = new b2Vec2(-10, 0),
        f = new b2Vec2(0, 30);
      c = c.body;
      e.owner = b.body;
      f.owner = c;
      c.SetGravityScale(-1);
      this.joints[a.idB] = BodyFactory.createJoint(d, e, f);
      d = this.entities[a.idB];
      d.smooth = !0;
      d.slave = !0;
      b.connected = a.idB;
    } else console.log("## warning: cannot join bodies");
  }
  disconnectBodies(a) {
    var b = this.dynamics[a.idB];
    b && b.body
      ? (this.joints[a.idB] && this.world.DestroyJoint(this.joints[a.idB]),
        delete this.joints[a.idB],
        b.body.SetGravityScale(0.6),
        (b = this.entities[a.idB]),
        (b.smooth = !1),
        (b.slave = !1))
      : console.log("## warning: cannot break bodies");
    this.dynamics[a.idA] && delete this.dynamics[a.idA].connected;
  }
  add(a) {
    let b = BodyFactory.createBody(a);
    var c = b.GetType(),
      d = b.GetPosition();
    d = { id: b.GetUserData(), x: d.x * PC.PM_RATIO, y: d.y * PC.PM_RATIO, r: b.GetAngle() };
    let e = (this.entities[d.id] = { body: b });
    e.ref = a;
    if (a.anchors)
      for (let k = 0, m = a.anchors.length; k < m; k++) {
        var f = a.anchors[k];
        f.owner = b;
        this.anchors[f.id] = f;
        if (this.joints[f.id]) {
          var g = this.anchors[this.joints[f.id].attr.anchorA];
          let l = this.anchors[this.joints[f.id].attr.anchorB];
          g && l && BodyFactory.createJoint(this.joints[f.id].attr, g, l);
        }
      }
    if (c === b2BodyType.b2_dynamicBody) {
      this.dynamics[d.id] = e;
      a.ttl && (e.ref._ttl = a.ttl);
      a.ignoreExp && (e.ignoreExp = a.ignoreExp);
      a.contact &&
        ((this.contact[d.id] = { body: b, fixtures: a.contact }),
        void 0 !== a.origin && (this.contact[d.id].origin = a.origin));
      a.continuous && (this.continuous[d.id] = { body: b, f: { x: 0, y: 0 }, changed: !1 });
      1 === a.local && ((e.local = 1), (e.ttl = a.ttl));
      if (a.ragdoll) {
        this.continuous[d.id].isPlayer = !0;
        e.facing = a.z / 10;
        e.active = 1;
        e.outOfTolerance = 1.1;
        e.ragdoll = BodyFactory.createRagdoll(a.ragdoll.id, a.gi);
        e.animating = {};
        e.animate = a.a || { 0: 0, 8: 0 };
        d.anims = e.animate;
        if (void 0 !== a.fr) for (c = b.m_fixtureList; c; c = c.m_next) c.m_friction = a.fr;
        e.newAnims = !0;
        for (var h in a.ragdoll.id)
          (c = e.ragdoll[h]),
            (c._parent = d.id),
            c.SetPosition(e.body.GetPosition()),
            (f = c.GetUserData()),
            c.contact
              ? ((g = { pen: -1 }), (this.contact[f] = { body: c, fixtures: [f] }))
              : (g = { wd: 6, bu: 0, id: h }),
            (this.entities[f] = this.dynamics[f] = { body: c, ref: g });
      }
      a.smooth && (e.smooth = !0);
      a.s ? b.SetAwake(!1) : b.SetAwake(!0);
    } else c === b2BodyType.b2_kinematicBody && (this.kinematics[d.id] = e);
    if (a.attr)
      for (h = 0; h < a.attr.length; h++)
        switch (((c = a.attr[h]), c.type)) {
          case GameAttribute.GRAVITY_SCALE:
            e.gOffset = parseFloat(c.offset) / PC.PM_RATIO;
            e.gRatio = parseFloat(c.ratio);
            e.gScale = b.GetGravityScale();
            break;
          case GameAttribute.FLUID:
            this.fluids[d.id] = e;
            e.density = c.d;
            e.ref.wa = parseFloat(c.w);
            this.containsFluid || (this.containsFluid = !0);
            break;
          default:
            (f = { owner: b, attr: c }),
              (this.joints[c.anchorA] = this.joints[c.anchorB] = f),
              this.anchors[c.anchorA] &&
                this.anchors[c.anchorB] &&
                BodyFactory.createJoint(f.attr, this.anchors[c.anchorA], this.anchors[c.anchorB]);
        }
    this.onMessage({ type: PhysicsMessage.ADDED, data: d });
  }
  update(a) {
    let b;
    var c = this.dynamics[a.i];
    var d = !1;
    if (!c) {
      c = this.kinematics[a.i];
      if (!c) return;
      d = !0;
    }
    b = c.body;
    a.j || b.IsAwake() || b.SetAwake(!0);
    if (a.a) (c.animate = a.a), (c.newAnims = !0);
    else if (
      c.ragdoll &&
      (!a.local && c.animate && (c.newAnims = !1),
      void 0 !== a.active && ((c.active = a.active), !c.active))
    ) {
      b.SetActive(!1);
      var e = { x: 0, y: 0 },
        f = 0;
      if (void 0 !== a.bid) {
        c.ref.killId = a.bid;
        var g = this.dynamics[a.bid];
        g &&
          ((e = g.body.GetLinearVelocity().Copy()),
          (e.x *= 0.1),
          (e.y *= 0.1),
          g.ref.knockback && ((e.x *= g.ref.knockback), (e.y *= g.ref.knockback)),
          (f = g.body.GetPosition()),
          (g = { x: f.x + g.ref.vx, y: f.y + g.ref.vy }),
          (f = Math.sqrt(e.x * e.x + e.y * e.y) * getDir(b.GetPosition(), f, g)));
      } else
        a.exp
          ? ((e = b.GetLinearVelocity()),
            (e.x *= -0.5),
            (e.y *= -0.5),
            (f = -0.3 + 0.6 * Math.random()))
          : ((e = b.GetLinearVelocity()), (e.x *= 0.1), (e.y *= 0.1), (f = 0));
      c.ragdoll.leftelbowjoint.EnableLimit(!0);
      c.ragdoll.rightelbowjoint.EnableLimit(!0);
      if (void 0 !== a.detach)
        for (let k = 0, m = a.detach.length; k < m; k++) {
          g = c.ragdoll[a.detach[k]];
          var h = g.GetBodyA();
          let l = g.GetBodyB();
          this.world.DestroyJoint(g);
          h.m_linearVelocity.x += e.x - 1 + 2 * Math.random();
          h.m_linearVelocity.y += e.y - 1 + 2 * Math.random();
          l.m_linearVelocity.x += e.x - 1 + 2 * Math.random();
          l.m_linearVelocity.y += e.y - 1 + 2 * Math.random();
          h.SetAngularVelocity(f);
          l.SetAngularVelocity(f);
        }
      for (g = c.ragdoll.joints.length; 0 < g--; ) c.ragdoll.joints[g].EnableMotor(!1);
      for (g = c.ragdoll.bodies.length; 0 < g--; )
        (h = c.ragdoll.bodies[g]),
          (h.m_linearVelocity.x += e.x),
          (h.m_linearVelocity.y += e.y),
          h.SetAngularVelocity(f),
          (h = h.m_fixtureList),
          (h.m_filter.categoryBits = EntityCategory.LOCAL),
          (h.m_filter.maskBits = MaskBits[EntityCategory.LOCAL]),
          (h.m_filter.groupIndex = 0);
    }
    void 0 !== a.z && (c.facing = a.z / 10);
    if (void 0 !== a.x && void 0 !== a.y)
      if (d) b.SetPosition({ x: a.x, y: a.y });
      else if (
        ((f = b.GetPosition()),
        (d = a.x - f.x),
        (e = a.y - f.y),
        (g = Math.sqrt(d * d + e * e)),
        !c.slave)
      )
        if (c.smooth && c.local)
          if (2.5 < g) {
            if (
              (b.SetPosition({ x: f.x + d, y: f.y + e }),
              void 0 !== c.connected &&
                ((f = this.dynamics[c.connected].body), f.SetPosition(b.GetPosition())),
              c.ragdoll)
            )
              for (g = c.ragdoll.bodies.length; 0 < g--; )
                (h = c.ragdoll.bodies[g]),
                  (f = h.GetPosition()),
                  h.SetPosition({ x: f.x + d, y: f.y + e });
          } else
            (g = 1 - Math.sqrt(d * d + e * e).clamp(0.85, 0.98)),
              b.SetPosition({ x: f.x + d * g, y: f.y + e * g }),
              c.ragdoll &&
                ((f = c.ragdoll.head.GetPosition()),
                c.ragdoll.head.SetPosition({ x: f.x + d * g, y: f.y + e * g }));
        else if (1 < g) {
          if (
            (b.SetPosition({ x: f.x + d, y: f.y + e }),
            void 0 !== c.connected &&
              ((f = this.dynamics[c.connected].body), f.SetPosition(b.GetPosition())),
            c.ragdoll)
          )
            for (g = c.ragdoll.bodies.length; 0 < g--; )
              (h = c.ragdoll.bodies[g]),
                (f = h.GetPosition()),
                c.ragdoll.bodies[g].SetPosition({ x: f.x + d, y: f.y + e });
        } else b.SetPosition({ x: f.x + 0.4 * d, y: f.y + 0.4 * e });
    void 0 !== a.r && b.SetAngle(a.r);
    if (void 0 !== a.fr)
      for (d = b.m_fixtureList; d; d = d.m_next)
        if ("-u" !== d.m_userData || c.prone || c.flipping) d.m_friction = a.fr;
    !a.local &&
      (c = this.continuous[a.i]) &&
      ((d = c.f.x),
      (e = c.f.y),
      (void 0 !== a.n ||
        void 0 !== a.m ||
        (void 0 === a.n && 0 !== d) ||
        (void 0 === a.m && 0 !== e)) &&
        c.f.x !== a.n &&
        c.f.y !== a.m &&
        ((c.changed = !0), (c.f.x = a.n || 0), (c.f.y = a.m || 0), (c.count = 3)));
    (0 !== a.u && void 0 !== a.u) || (0 !== a.v && void 0 !== a.v)
      ? (a.u || a.v) && b.SetLinearVelocity({ x: a.u || 0, y: a.v || 0 })
      : b.SetLinearVelocity({ x: 0, y: 0 });
    a.w && b.SetAngularVelocity(a.w || 0);
  }
  updateFacing(a, b) {
    this.dynamics[a] && (this.dynamics[a].facing = b);
  }
  remove(a) {
    let b = a.id,
      c = this.entities[b];
    if (void 0 !== c) {
      if (c.ragdoll) {
        let d = c.ragdoll.bodies.length;
        for (; 0 < d--; ) {
          let e = c.ragdoll.bodies[d].GetUserData();
          delete this.entities[e];
          delete this.dynamics[e];
          this.world.DestroyBody(c.ragdoll.bodies[d]);
          this.submerged[e] && delete this.submerged[e];
        }
      }
      delete this.entities[b];
      this.continuous[b] && delete this.continuous[b];
      this.contact[b] && delete this.contact[b];
      this.dynamics[b] ? delete this.dynamics[b] : this.kinematics[b] && delete this.kinematics[b];
      this.submerged[b] && delete this.submerged[b];
      BodyFactory.free(c.body);
      this.onMessage({ type: PhysicsMessage.REMOVED, data: a });
    }
  }
  simulate(a) {
    for (d in this.continuous) {
      var b = this.continuous[d];
      if (b.isPlayer) {
        var c = b.body.GetLinearVelocity();
        0 === b.count || (5 < Math.abs(c.x) && 1 > Math.abs(c.y))
          ? b.body.ApplyForce({ x: b.f.x, y: b.f.y }, b.body.GetWorldCenter())
          : b.count--;
      } else b.body.ApplyForce({ x: b.f.x, y: b.f.y }, b.body.GetWorldCenter());
    }
    this.deltatime = 0.001 * a * (1 - this.timeWarp);
    0 >= this.deltatime ? (this.deltatime = 0.001) : 1 < this.deltatime && (this.deltatime = 1);
    this.world.Step(this.deltatime, 4, 2);
    this.world.ClearForces();
    if (this.containsFluid) {
      for (d in this.submerged)
        this.dynamics[d] &&
          ((a = this.fluids[this.submerged[d][0]].density),
          (b = this.dynamics[d].body),
          (c = b.GetWorldCenter()),
          b.ApplyForce({ x: 0, y: -a * (this.dynamics[d].ref.bu ?? 0.5) }, c));
      for (d in this.hasSubmerged)
        (a = this.dynamics[d]),
          void 0 !== a &&
            ((b = a.body),
            void 0 === b._gs &&
              ((b._gs = b.GetGravityScale()),
              (b._ld = b.GetLinearDamping()),
              (b._ad = b.GetAngularDamping()),
              void 0 === a.ref.bu && b.SetGravityScale(0.1 * b._gs),
              b.SetLinearDamping(void 0 === a.ref.wd ? 2 * b._ld : a.ref.wd),
              b.SetAngularDamping(0.5 + 5 * b._ad),
              (a.ref.sub = !0),
              this.onMessage({
                type: PhysicsMessage.SUBMERGE,
                data: {
                  id: d,
                  ss: void 0 !== a.ref.ttl && 0 < a.ref.ttl && a.ref.ttl === a.ref._ttl,
                },
              }),
              100 === a.ref.wd && (a.ref.ttl = 0)));
      for (d in this.hasSurfaced)
        (a = this.dynamics[d]),
          void 0 !== a &&
            ((b = a.body),
            void 0 !== b._gs &&
              (b.SetGravityScale(b._gs),
              b.SetLinearDamping(b._ld),
              b.SetAngularDamping(b._ad),
              delete b._gs,
              delete b._ld,
              delete b._ad,
              (a.ref.sub = !1),
              this.onMessage({ type: PhysicsMessage.SURFACE, data: { id: d } })));
      this.hasSubmerged = {};
      this.hasSurfaced = {};
    }
    for (var d in this.kinematics) {
      b = this.kinematics[d].body;
      c = b.GetPosition();
      var e = b.GetLinearVelocity();
      this.onMessage({
        type: PhysicsMessage.UPDATE_OBJECT,
        data: {
          id: d,
          x: c.x * PC.PM_RATIO,
          y: c.y * PC.PM_RATIO,
          r: b.GetAngle(),
          vx: e.x,
          vy: e.y,
        },
      });
    }
    for (d in this.dynamics)
      if (((b = this.dynamics[d].body), b.IsAwake())) {
        a = this.dynamics[d];
        c = b.GetPosition();
        e = b.GetLinearVelocity();
        e = {
          id: d,
          x: c.x * PC.PM_RATIO,
          y: c.y * PC.PM_RATIO,
          r: b.GetAngle(),
          vx: e.x,
          vy: e.y,
        };
        if (void 0 !== a.ref.ttl && 0 <= a.ref.ttl) {
          a.ref.ttl -= App.FrameTime;
          if (a.ref.prime && a.ref.ttl < a.ref.prime) {
            let f = void 0 !== a.ref.explosive ? EntityCategory.GRENADE : EntityCategory.BULLET;
            a.body.m_fixtureList.m_filter.categoryBits = f;
            a.body.m_fixtureList.m_filter.maskBits = MaskBits[f];
            a.ref.prime = 0;
          }
          if (0 >= a.ref.ttl) {
            this.remove({ type: b2BodyType.b2_dynamicBody, id: d });
            continue;
          }
        }
        void 0 !== a.ref.update && a.ref.update(a);
        this.continuous[d] &&
          this.continuous[d].changed &&
          ((e.ax = this.continuous[d].f.x),
          (e.ay = this.continuous[d].f.y),
          (this.continuous[d].changed = !1));
        a.gRatio && b.SetGravityScale(a.gScale - (c.y - a.gOffset) * a.gRatio);
        void 0 !== a.facing &&
          a.active &&
          (this.animate(a), a.animate && a.newAnims && (e.a = a.animate), (e.z = a.facing));
        this.solved[d] && (e.c = this.solved[d]);
        this.contact[d] && this.contact[d].fr && (e.fr = this.contact[d].fr);
        this.onMessage({ type: PhysicsMessage.UPDATE_OBJECT, data: e });
      }
    this.solved = {};
    this.onMessage({ type: PhysicsMessage.UPDATED });
  }
  submerge(a, b) {
    void 0 !== this.dynamics[b] &&
      (void 0 === this.submerged[b] &&
        ((this.submerged[b] = []), this.hasSurfaced[b] || (this.hasSubmerged[b] = !0)),
      this.hasSurfaced[b] && delete this.hasSurfaced[b],
      this.submerged[b].push(a));
  }
  surface(a, b) {
    if (void 0 !== this.dynamics[b]) {
      var c = this.submerged[b];
      void 0 !== c &&
        (c.splice(c.indexOf(a), 1),
        0 === c.length &&
          (delete this.submerged[b], this.hasSubmerged[b] || (this.hasSurfaced[b] = !0)),
        this.hasSubmerged[b] && delete this.hasSubmerged[b]);
    }
  }
  beginContact(a) {
    if (a.m_isSensor) {
      var b = a.m_fixtureA.m_body.m_userData,
        c = a.m_fixtureB.m_body.m_userData;
      this.fluids[b]
        ? (this.submerge(b, c), a.SetEnabled(!1))
        : this.fluids[c] && (this.submerge(c, b), a.SetEnabled(!1));
    } else if (a.IsTouching()) {
      b = a.m_fixtureA.m_body.m_userData;
      c = a.m_fixtureB.m_body.m_userData;
      if (b && this.contact[b] && !a.m_fixtureA.IsSensor()) {
        var d = a.m_fixtureA.m_filter.categoryBits,
          e = a.m_fixtureB.m_filter.categoryBits;
        a.GetWorldManifold(this.beginManifold);
        var f = 0 === a.m_fixtureA.GetType();
        f = {
          t: PhysicsWorker.Contact.CON,
          a: this.entities[b],
          b: this.entities[c],
          p: this.beginManifold.m_points[0].Copy(),
          normal: f
            ? { x: -this.beginManifold.m_normal.x, y: -this.beginManifold.m_normal.y }
            : this.beginManifold.m_normal.Copy(),
          pen: this.dynamics[b].ref.pen,
          local:
            d === EntityCategory.LOCAL ||
            e === EntityCategory.LOCAL ||
            d === EntityCategory.OBJECTIVE ||
            e === EntityCategory.OBJECTIVE,
        };
        this.solved[b] || (this.solved[b] = []);
        void 0 !== this.contact[b].origin && (f.o = this.contact[b].origin);
        this.solved[b].push(f);
      }
      c &&
        this.contact[c] &&
        !a.m_fixtureB.IsSensor() &&
        ((d = a.m_fixtureA.m_filter.categoryBits),
        (e = a.m_fixtureB.m_filter.categoryBits),
        void 0 === f &&
          (a.GetWorldManifold(this.beginManifold),
          (a = 0 === a.m_fixtureA.GetType()),
          (f = {
            t: PhysicsWorker.Contact.CON,
            a: this.entities[b],
            b: this.entities[c],
            p: this.beginManifold.m_points[0].Copy(),
            normal: a
              ? { x: -this.beginManifold.m_normal.x, y: -this.beginManifold.m_normal.y }
              : this.beginManifold.m_normal.Copy(),
            pen: this.dynamics[c].ref.pen,
            local:
              d === EntityCategory.LOCAL ||
              e === EntityCategory.LOCAL ||
              d === EntityCategory.OBJECTIVE ||
              e === EntityCategory.OBJECTIVE,
          })),
        this.solved[c] || (this.solved[c] = []),
        void 0 !== this.contact[c].origin && (f.o = this.contact[c].origin),
        this.solved[c].push(f));
    }
  }
  endContact(a) {
    if (a.m_isSensor) {
      let b = a.m_fixtureA.m_body.m_userData;
      a = a.m_fixtureB.m_body.m_userData;
      this.fluids[b] ? this.surface(b, a) : this.fluids[a] && this.surface(a, b);
    }
  }
  preSolve(a) {
    if (a.IsTouching()) {
      var b = a.m_fixtureA.m_filter.categoryBits,
        c = a.m_fixtureB.m_filter.categoryBits;
      if (
        (b !== EntityCategory.ITEM && c !== EntityCategory.ITEM) ||
        (b !== EntityCategory.AGENT && c !== EntityCategory.AGENT)
      ) {
        var d = a.m_fixtureA.m_body.m_userData,
          e = a.m_fixtureB.m_body.m_userData;
        if (this.contact[e]) {
          if (-1 !== this.contact[e].fixtures.indexOf(e))
            if (
              (b === EntityCategory.LOCAL && c === EntityCategory.BULLET) ||
              (c === EntityCategory.LOCAL && b === EntityCategory.BULLET) ||
              b === EntityCategory.OBJECTIVE ||
              c === EntityCategory.OBJECTIVE
            ) {
              b = a.m_fixtureB.m_body;
              c = b.GetLinearVelocity().Copy();
              a.m_fixtureA.m_body.ApplyForce(c, b.GetWorldCenter());
              a.GetWorldManifold(this.preManifold);
              var f = 0 === a.m_fixtureA.GetType();
              this.solved[e] || (this.solved[e] = []);
              this.solved[e].push({
                t: PhysicsWorker.Contact.PRE,
                a: this.entities[d],
                b: this.entities[e],
                p: this.preManifold.m_points[0].Copy(),
                normal: f
                  ? { x: -this.preManifold.m_normal.x, y: -this.preManifold.m_normal.y }
                  : this.preManifold.m_normal.Copy(),
              });
              f = b._parent ?? d;
              this.dynamics[f] &&
                (this.dynamics[f].active || this.dynamics[f].ref.killId === e
                  ? ((d = this.dynamics[e].ref),
                    (e = !1),
                    0 < d.pen &&
                      (d.lastHit !== f &&
                        ((b = a.m_fixtureB.m_body),
                        (c = b.GetLinearVelocity().Copy()),
                        (c.x *= d.decay),
                        (c.y *= d.decay),
                        b.SetLinearVelocity(c),
                        d.pen--,
                        (d.lastHit = f),
                        1e3 > c.x * c.x + c.y * c.y && ((d.pen = 0), (e = !0))),
                      e || a.SetEnabled(!1)))
                  : a.SetEnabled(!1));
            } else
              (f = a.m_fixtureB.m_body._parent ?? d),
                this.dynamics[f] &&
                  ((d = this.dynamics[e].ref),
                  0 < d.pen &&
                    (b === EntityCategory.LIMB || c === EntityCategory.LIMB) &&
                    ((e = !1),
                    d.lastHit !== f &&
                      ((b = a.m_fixtureB.m_body),
                      (c = b.GetLinearVelocity().Copy()),
                      (c.x *= d.decay),
                      (c.y *= d.decay),
                      b.SetLinearVelocity(c),
                      d.pen--,
                      (d.lastHit = f),
                      1e3 > c.x * c.x + c.y * c.y && ((d.pen = 0), (e = !0))),
                    e || a.SetEnabled(!1)));
        } else
          this.contact[d] &&
            -1 !== this.contact[d].fixtures.indexOf(d) &&
            ((b === EntityCategory.LOCAL && c === EntityCategory.BULLET) ||
            (c === EntityCategory.LOCAL && b === EntityCategory.BULLET) ||
            b === EntityCategory.OBJECTIVE ||
            c === EntityCategory.OBJECTIVE
              ? ((b = a.m_fixtureA.m_body),
                (c = b.GetLinearVelocity().Copy()),
                a.m_fixtureB.m_body.ApplyForce(c, b.GetWorldCenter()),
                a.GetWorldManifold(this.preManifold),
                (f = 0 === a.m_fixtureA.GetType()),
                this.solved[d] || (this.solved[d] = []),
                this.solved[d].push({
                  t: PhysicsWorker.Contact.PRE,
                  a: this.entities[d],
                  b: this.entities[e],
                  p: this.preManifold.m_points[0].Copy(),
                  normal: f
                    ? { x: -this.preManifold.m_normal.x, y: -this.preManifold.m_normal.y }
                    : this.preManifold.m_normal.Copy(),
                }),
                (f = b._parent ?? e),
                this.dynamics[f] &&
                  (this.dynamics[f].active || this.dynamics[f].ref.killId === d
                    ? ((d = this.dynamics[d].ref),
                      (e = !1),
                      0 < d.pen &&
                        (d.lastHit !== f &&
                          ((b = a.m_fixtureA.m_body),
                          (c = b.GetLinearVelocity().Copy()),
                          (c.x *= d.decay),
                          (c.y *= d.decay),
                          b.SetLinearVelocity(c),
                          d.pen--,
                          (d.lastHit = f),
                          1e3 > c.x * c.x + c.y * c.y && ((d.pen = 0), (e = !0))),
                        e || a.SetEnabled(!1)))
                    : a.SetEnabled(!1)))
              : ((f = a.m_fixtureB.m_body._parent ?? e),
                this.dynamics[f] &&
                  ((d = this.dynamics[d].ref),
                  (e = !1),
                  0 < d.pen &&
                    (b === EntityCategory.LIMB || c === EntityCategory.LIMB) &&
                    (d.lastHit !== f &&
                      ((b = a.m_fixtureA.m_body),
                      (c = b.GetLinearVelocity().Copy()),
                      (c.x *= d.decay),
                      (c.y *= d.decay),
                      b.SetLinearVelocity(c),
                      d.pen--,
                      (d.lastHit = f),
                      1e3 > c.x * c.x + c.y * c.y && ((d.pen = 0), (e = !0))),
                    e || a.SetEnabled(!1)))));
      } else a.SetEnabled(!1);
    }
  }
  animate(a) {
    var b = a.ragdoll,
      c = b.animations,
      d = a.body.GetPosition(),
      e = 0,
      f = a.flipping ? 0.3 * -Math.sin(0.5 * (a.flipAngle - Math.PI05)) * a.flipDir : 0;
    if (c) {
      var g = a.body.GetUserData(),
        h = {},
        k =
          AudioManager.CamDistance({ x: d.x * PC.PM_RATIO, y: d.y * PC.PM_RATIO }) <
          0.75 * App.ClientWidth,
        m;
      for (m in a.animate)
        if ("_" !== m) {
          a.animating[m] = h[m] = !0;
          var l = c[m];
          var p = l.offsets.length;
          l[g] || (l[g] = { frame: 0, delay: 0 });
          var n = l[g].frame;
          e += l.offsets[n % p].x;
          f += l.offsets[n % p].y;
          if (l[g].delay === l.frequency) {
            for (var r = l.timeline.length; 0 < r--; ) {
              var q = l.timeline[r];
              p = b[q.joint];
              var t = p.GetJointAngle();
              q = q.frames[n];
              p.SetMotorSpeed(q.shortAngle(t) * l.motorSpeed);
            }
            App.HasFocus &&
              k &&
              l.soundFx &&
              l.soundFx[n] &&
              (l.soundFx.finish
                ? l.soundFx[n].audio.playing() || l.soundFx[n].audio.play()
                : l.soundFx[n].audio.play());
            l[g].delay = 0;
            l[g].frame = n === l.frames - 1 ? (l.frameRepeat ? 0 : n) : n + 1;
          } else l[g].delay++;
        }
      for (m in a.animating) h[m] || (delete c[m][g], delete a.animating[m]);
    }
    l = a.body.GetLinearVelocity();
    c = a.body.GetAngle();
    for (g = b.bodies.length; 0 < g--; ) b.bodies[g].SetLinearVelocity({ x: l.x, y: l.y });
    a.prone
      ? void 0 !== a.animate[Animation.PRONE_END]
        ? 0.1 < Math.abs(a.proneAngle) &&
          (void 0 !== a.animate[Animation.PRONE_LEFT]
            ? (a.proneAngle += (0.47 * Math.PI) / 14)
            : void 0 !== a.animate[Animation.PRONE_RIGHT] &&
              (a.proneAngle -= (0.47 * Math.PI) / 14))
        : void 0 === a.animate[Animation.PRONE_LEFT] &&
          void 0 === a.animate[Animation.PRONE_RIGHT] &&
          ((a.proneAngle = 0),
          (a.prone = !1),
          a.body.SetAngle(Math.PI05),
          b.torsolower.SetAngle(t - Math.PI05))
      : void 0 !== a.animate[Animation.PRONE_LEFT]
      ? ((a.prone = !0), (a.proneInLeft = 14), (a.proneAngle = 0))
      : void 0 !== a.animate[Animation.PRONE_RIGHT] &&
        ((a.prone = !0), (a.proneInRight = 14), (a.proneAngle = 0));
    a.prone
      ? ((l = a.facing - (c - Math.PI05 - a.proneAngle)),
        (g = !1),
        l <= Math.PI05 && l >= -Math.PI05 && (g = !0),
        (l = (g ? l - Math.PI : l) + 0.35 * Math.PI),
        (t = c + Math.PI),
        void 0 !== a.animate[Animation.PRONE_LEFT]
          ? b.head.SetAngle(l + a.proneAngle - 2 * Math.PI)
          : void 0 !== a.animate[Animation.PRONE_RIGHT] &&
            b.head.SetAngle(l + a.proneAngle - 0.75 * Math.PI),
        (c = Math.abs(1.3 * b.scale)),
        (h = Math.abs(0.7 * b.scale)),
        0 < a.proneInLeft
          ? (a.proneInLeft--,
            (a.proneAngle -= (0.45 * Math.PI) / 14),
            b.head.SetAngle(l + a.proneAngle - 2.2 * Math.PI))
          : 0 < a.proneInRight
          ? (a.proneInRight--,
            (a.proneAngle += (0.45 * Math.PI) / 14),
            b.head.SetAngle(l + a.proneAngle - 0.55 * Math.PI))
          : ((a.proneInLeft = 0),
            (a.proneInRight = 0),
            void 0 === a.animate[Animation.PRONE_END]
              ? (a.proneAngle =
                  void 0 === a.animate[Animation.PRONE_LEFT] ? 0.45 * Math.PI : 0.45 * -Math.PI)
              : ((d.y -= 0.1),
                a.body.SetPosition({ x: d.x, y: d.y }),
                g
                  ? b.head.SetAngle(l + a.proneAngle - 2.2 * Math.PI)
                  : b.head.SetAngle(l + a.proneAngle - 0.55 * Math.PI))),
        a.body.SetAngle(Math.PI05 + a.proneAngle),
        b.torsolower.SetAngle(t - Math.PI05 + 0.4 * a.proneAngle),
        b.torsoupper.SetAngle(t - Math.PI05 - 0.4 * a.proneAngle))
      : ((l = a.facing - (c - Math.PI05)),
        (g = !1),
        l <= Math.PI05 && l >= -Math.PI05 && (g = !0),
        (l = g ? l - Math.PI : l),
        (h = l + Math.PI),
        (h = 0.8 * (h > Math.PI05 ? h - 2 * Math.PI : h)),
        (t = c + Math.PI),
        a.flipping
          ? ((c =
              (!a.flipFacingLeft && 1 === a.flipDir) || (a.flipFacingLeft && -1 === a.flipDir)
                ? 1
                : -1),
            (
              1 === a.flipDir
                ? a.flipAngle < 2 * Math.PI + Math.PI05
                : a.flipAngle > -(2 * Math.PI - Math.PI05)
            )
              ? ((a.flipAngle += 0.18 * a.flipDir),
                (l = a.flipAngle + 0.5 * Math.PI),
                b.armrightupper.SetAngle(l),
                b.armleftupper.SetAngle(l),
                b.legrightupper.SetAngle(l),
                b.legleftupper.SetAngle(l),
                b.legrightlower.SetAngle(l + 2.5 * Math.sin(0.5 * (a.flipAngle - Math.PI05)) * c),
                b.legleftlower.SetAngle(l + 1.5 * Math.sin(0.5 * (a.flipAngle - Math.PI05)) * c),
                b.head.SetAngle(
                  a.flipAngle + Math.PI05 + 2 * Math.sin(0.5 * (a.flipAngle - Math.PI05))
                ),
                b.torsoupper.SetAngle(a.flipAngle + Math.PI05),
                a.body.SetAngle(a.flipAngle))
              : ((l = 2 * Math.PI * a.flipDir),
                (a.flipping = !1),
                (a.flipAngle = Math.PI05),
                b.legrightupper.SetAngle(b.legrightupper.GetAngle() - l),
                b.legleftupper.SetAngle(b.legleftupper.GetAngle() - l),
                b.legrightlower.SetAngle(b.legrightlower.GetAngle() - l),
                b.legleftlower.SetAngle(b.legleftlower.GetAngle() - l),
                b.armrightupper.SetAngle(b.armrightupper.GetAngle() - l),
                b.armleftupper.SetAngle(b.armleftupper.GetAngle() - l),
                b.armrightlower.SetAngle(b.armrightlower.GetAngle() - l),
                b.armleftlower.SetAngle(b.armleftlower.GetAngle() - l),
                a.body.SetAngle(Math.PI05)))
          : (void 0 !== a.animate[Animation.ROLL_LEFT]
              ? ((a.flipping = !0),
                (a.flipDir = -1),
                (a.flipFacingLeft = g),
                (a.flipAngle = Math.PI05))
              : void 0 !== a.animate[Animation.ROLL_RIGHT] &&
                ((a.flipping = !0),
                (a.flipDir = 1),
                (a.flipFacingLeft = g),
                (a.flipAngle = Math.PI05)),
            b.torsoupper.SetAngle(t + h - Math.PI05),
            b.head.SetAngle(l)),
        (c = Math.abs(1.3 * b.scale)),
        (h = Math.abs(0.7 * b.scale)),
        b.torsolower.SetAngle(t - Math.PI05));
    b.torsoupper.SetPosition({ x: c * Math.cos(t) + d.x + e, y: c * Math.sin(t) + d.y + f });
    b.torsolower.SetPosition({ x: h * Math.cos(t) + d.x + e, y: h * Math.sin(t) + d.y + f });
  }
}
class ExplosionRayCallback {
  constructor(a, b) {
    this.fix = null;
    this.frac = 0;
    this.pt = a;
    this.body = b;
  }
  ReportFixture(a, b, c, d) {
    c = a.m_body;
    if (
      a.IsSensor() ||
      0 !==
        (a.GetFilterData().categoryBits &
          (EntityCategory.OPEN_WORLD | EntityCategory.BRIDGE | EntityCategory.BARRIER)) ||
      (c.GetType() !== b2BodyType.b2_staticBody && c !== this.body)
    )
      return -1;
    this.fix = a;
    this.frac = d;
    this.pt = b;
    return d;
  }
}
class RaycastCallback {
  constructor(a, b) {
    this.fix = null;
    this.frac = 0;
    this.pt = a;
    this.origin = b;
  }
  ReportFixture(a, b, c, d) {
    if (
      a.IsSensor() ||
      a.GetFilterData().groupIndex === -Base62Decode(this.origin.p.gi) ||
      0 !==
        (a.GetFilterData().categoryBits &
          (EntityCategory.OPEN_WORLD |
            EntityCategory.BRIDGE |
            EntityCategory.ZONE |
            EntityCategory.OBJECTIVE))
    )
      return -1;
    this.fix = a;
    this.frac = d;
    this.pt = b;
    this.normal = c;
    return d;
  }
}
PhysicsWorker.Contact = { PRE: 0, CON: 1, PST: 2 };
var shapecircle = {};
function ShapeCircle(a) {
  let b = a.sh[0],
    c = new b2FixtureDef();
  c.filter.categoryBits = b.c;
  c.filter.maskBits = MaskBits[c.filter.categoryBits];
  c.filter.groupIndex = void 0 !== a.gi ? a.gi : 0;
  c.density = b.d || 1;
  c.friction = void 0 !== b.fr ? b.fr : 0.9;
  c.restitution = void 0 !== b.re ? b.re : 0.3;
  c.isSensor = b.isSensor || !1;
  c.shape = new b2CircleShape(b.radius / PC.PM_RATIO);
  a = this.CreateFixture(c);
  b.minRestitution && (a.minRestitution = !0);
  return this;
}
var shapecompound = {};
function ShapeCompound(a) {
  let b = a.sh || [];
  for (let d = 0, e = b.length; d < e; d++) {
    let f = b[d],
      g = new b2FixtureDef();
    g.density = void 0 !== f.d ? f.d : a.d || 1;
    g.friction = void 0 !== f.fr ? f.fr : a.fr || 0.9;
    g.restitution = void 0 !== f.re ? f.re : a.re || 0.3;
    g.isSensor = void 0 !== f.s ? f.s : a.s;
    g.filter.categoryBits =
      2 == a.type && f.c === EntityCategory.STATIC_WORLD ? EntityCategory.DYNAMIC_WORLD : f.c;
    g.filter.maskBits = MaskBits[g.filter.categoryBits];
    g.filter.groupIndex = a.gi || 0;
    if (f.t === GameShape.CIRCLE) {
      var c = new b2CircleShape();
      c.m_radius = f.radius / PC.PM_RATIO;
      f.o && c.m_p.Set(f.o.x / PC.PM_RATIO, f.o.y / PC.PM_RATIO);
      g.shape = c;
    } else
      f.t === GameShape.POLYGON
        ? ((c = new b2PolygonShape()),
          0 < polyAreaTri(f.v[0], f.v[1], f.v[2])
            ? c.SetAsArray(
                [
                  new b2Vec2(f.v[2].x / PC.PM_RATIO, f.v[2].y / PC.PM_RATIO),
                  new b2Vec2(f.v[1].x / PC.PM_RATIO, f.v[1].y / PC.PM_RATIO),
                  new b2Vec2(f.v[0].x / PC.PM_RATIO, f.v[0].y / PC.PM_RATIO),
                ],
                3
              )
            : c.SetAsArray(
                [
                  new b2Vec2(f.v[0].x / PC.PM_RATIO, f.v[0].y / PC.PM_RATIO),
                  new b2Vec2(f.v[1].x / PC.PM_RATIO, f.v[1].y / PC.PM_RATIO),
                  new b2Vec2(f.v[2].x / PC.PM_RATIO, f.v[2].y / PC.PM_RATIO),
                ],
                3
              ),
          (g.shape = c))
        : ((c = new b2PolygonShape()),
          c.SetAsOrientedBox(
            f.w / PC.PM_RATIO,
            f.h / PC.PM_RATIO,
            f.o ? new b2Vec2(f.o.x / PC.PM_RATIO, f.o.y / PC.PM_RATIO) : new b2Vec2(0, 0),
            f.r
          ),
          (g.shape = c));
    this.CreateFixture(g);
  }
  return this;
}
var shapeplayer = {};
function ShapePlayer(a) {
  var b = new b2PolygonShape(),
    c = new b2CircleShape(),
    d = new b2FixtureDef(),
    e = new b2FixtureDef(),
    f = 0.65 * 0.9;
  e.filter.categoryBits = EntityCategory.AGENT;
  e.filter.maskBits = MaskBits[EntityCategory.AGENT];
  e.filter.groupIndex = a.gi || 0;
  e.density = 2.5;
  e.friction = 30;
  e.restitution = 0.01;
  e.shape = b;
  b.SetAsBox(f, 0.27);
  e.userData = "-m";
  this.CreateFixture(e);
  e.density = 0;
  e.filter.categoryBits = EntityCategory.ENTITY;
  e.filter.maskBits = MaskBits[EntityCategory.ENTITY];
  e.filter.groupIndex = a.gi || 0;
  e.isSensor = !0;
  this.CreateFixture(e);
  c.m_radius = 0.5 * f;
  c.m_p.Set(-f, 0);
  d.filter.categoryBits = EntityCategory.AGENT;
  d.filter.maskBits = MaskBits[EntityCategory.AGENT];
  d.filter.groupIndex = a.gi || 0;
  d.userData = "-u";
  d.shape = c;
  d.density = 2.5;
  d.friction = 0.1;
  d.restitution = 0.01;
  this.CreateFixture(d);
  d.friction = 30;
  c.m_p.Set(f + 0.1, 0);
  d.userData = "-l";
  this.CreateFixture(d).minRestitution = !0;
  this.SetFixedRotation(!0);
  this.SetLinearDamping(0.9);
  this.SetSleepingAllowed(!1);
  a = new b2FixtureDef();
  a.density = 0;
  a.isSensor = !0;
  a.userData = "-feet";
  a.filter.categoryBits = EntityCategory.AGENT;
  a.filter.maskBits = MaskBits[EntityCategory.ITEM];
  b.SetAsOrientedBox(0.5, 0.2, new b2Vec2(1.5 * f, 0));
  a.shape = b;
  this.CreateFixture(a);
  this.SetGravityScale(1);
  this.SetBullet(!1);
  return this;
}
var shaperectangle = {};
function ShapeRectangle(a) {
  var b = a.sh[0],
    c = new b2PolygonShape(),
    d = new b2FixtureDef();
  d.filter.categoryBits = b.c;
  d.filter.maskBits = MaskBits[d.filter.categoryBits];
  d.filter.groupIndex = a.gi || 0;
  d.density = b.d || 1;
  d.friction = b.fr || 0.9;
  d.restitution = b.re || 0.3;
  d.isSensor = b.isSensor || !1;
  c.SetAsBox(b.width / PC.PM_RATIO, b.height / PC.PM_RATIO);
  d.shape = c;
  this.CreateFixture(d);
  return this;
}
var shaperoundedrect = {};
function ShapeRoundedRect(a) {
  var b = a.sh[0],
    c = new b2PolygonShape(),
    d = new b2CircleShape(),
    e = new b2FixtureDef(),
    f = new b2FixtureDef();
  f.filter.categoryBits = b.c;
  f.filter.maskBits = MaskBits[f.filter.categoryBits];
  f.filter.groupIndex = a.gi || 0;
  f.density = b.d || 1;
  f.friction = b.fr || 0.9;
  f.restitution = b.re || 0.3;
  f.isSensor = b.isSensor || !1;
  c.SetAsBox(b.width / PC.PM_RATIO, b.height / PC.PM_RATIO);
  f.shape = c;
  this.CreateFixture(f);
  d.m_radius = (b.height * (1.075 - 0.1 * b.height)) / PC.PM_RATIO;
  d.m_p.Set(-b.width / PC.PM_RATIO, 0);
  e.filter.categoryBits = b.c;
  e.filter.maskBits = MaskBits[e.filter.categoryBits];
  e.filter.groupIndex = a.gi || 0;
  e.shape = d;
  e.density = b.d || 1;
  e.friction = b.fr || 0.9;
  e.restitution = b.re || 0.3;
  e.isSensor = b.isSensor || !1;
  this.CreateFixture(e);
  d.m_p.Set(b.width / PC.PM_RATIO, 0);
  this.CreateFixture(e);
  return this;
}
var playerevent = {},
  PlayerEvent = {
    WIN_DM: "win_dm",
    WIN_CTF: "win_ctf",
    LOSE_DM: "lose_dm",
    LOSE_CTF: "lose_ctf",
    WIN_TDM: "win_tdm",
    LOSE_TDM: "lose_tdm",
    WIN_DB: "win_db",
    LOSE_DB: "lose_db",
    WIN_BR: "win_br",
    LOSE_BR: "lose_br",
    KILL: "kill",
    DEATH: "death",
    SCORE: "score",
    DOUBLE: "double",
    TRIPLE: "triple",
    QUAD: "quad",
    PENTA: "penta",
    MEGA: "mega",
    MONSTER: "monster",
    GOD: "god",
    SPREE: "spree",
    SELF: "self",
    TEAM: "team",
    HEAD: "head",
    FIRST: "first",
    GOLD: "gold",
    WIN_DB_MATCH: "win_db_match",
  };
var statechange = {},
  StateChange = {
    ADD: 0,
    Item: {
      RANGE: 1,
      EQUIP: 101,
      CARRY_PRIMARY: 102,
      CARRY_SECONDARY: 103,
      CARRY_BELT: 104,
      REMOVE_PRIMARY: 105,
      REMOVE_SECONDARY: 106,
      REMOVE_BELT: 107,
      DROP: 108,
      USE: 109,
      RELOAD: 110,
      CARRY_OBJECTIVE: 111,
      DROP_OBJECTIVE: 112,
      SCORE_OBJECTIVE: 113,
      RETURN_OBJECTIVE: 114,
      INIT_USE: 115,
    },
    Agent: {
      RANGE: 2,
      HEALTH: 201,
      ALIVE: 202,
      ACTIVE: 203,
      JET_START: 204,
      JET_STOP: 205,
      COMBO: 206,
      TELEPORT: 207,
      INSERTION: 208,
      IDLE: 209,
      GOLD: 210,
      JET: 211,
    },
    Model: {
      RANGE: 3,
      SPAWN: 301,
      KILL: 302,
      SCORE: 303,
      END: 304,
      CLEAR: 305,
      LEADER: 306,
      TEAM: 307,
      EVENT: 308,
      ENVIRONMENT: 309,
      ENERGY_RADIUS: 310,
      END_DB_MATCH: 311,
      MESSAGE: 312,
      INITIAL: 313,
    },
  };
var team = {};
function Team(a) {
  this.index = a;
  this.name = Team.Names[this.index];
  this.color = Team.Colors[this.index];
  this.kills = this.points = 0;
  this.players = new OrderedContainer();
}
Team.Names = "alpha bravo charlie delta echo foxtrot gamma hotel india juliett kilo lima".split(
  " "
);
Team.Colors = "red blue green yellow orange purple lightblue teal brown grey darkgreen pink".split(
  " "
);
Team.HexColors = [
  16711680, 255, 65280, 16776960, 16753408, 9766884, 41460, 50286, 7941126, 9605778, 22528,
  13259256,
];
Team.LabelColors = [
  16733525, 5592575, 5635925, 16777045, 16753408, 9766884, 41460, 50286, 7941126, 9605778, 22528,
  13259256,
];
var controlstab = {};
function ControlsTab(a) {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.settings = a;
  void 0 === this.settings && (this.settings = { keyBindings: InputState.DefaultBindings.QWERTY });
  this.forceRefresh = !1;
  this.marginLeft = 40;
  this.marginTop = 52;
  this.kbMarginTop = this.marginTop + 120;
  this.keyboardTitle = new PIXI.Text("Key bindings", {
    fontName: "Arial",
    fontSize: 18,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.keyboardTitle.x = this.marginLeft - 5;
  this.keyboardTitle.y = this.marginTop + 6;
  this.keyboardTitle.resolution = 1.5 * App.DevicePixelRatio;
  this.addChild(this.keyboardTitle);
  this.qwertyButton = new Button("QWERTY");
  this.qwertyButton.setText("Reset default QWERTY");
  this.qwertyButton.x = this.marginLeft + 8;
  this.qwertyButton.y = this.marginTop + 40;
  this.qwertyButton.scale.x = this.qwertyButton.scale.y = 0.8;
  this.addChild(this.qwertyButton);
  this.qwertyButton.addListener(
    Button.BUTTON_RELEASED,
    this.applyDefaultBindings.bind(this, "QWERTY")
  );
  this.azertyButton = new Button("QWERTY");
  this.azertyButton.setText("Reset default AZERTY");
  this.azertyButton.x = this.qwertyButton.x + this.qwertyButton.width + 28;
  this.azertyButton.y = this.marginTop + 40;
  this.azertyButton.scale.x = this.azertyButton.scale.y = 0.8;
  this.addChild(this.azertyButton);
  this.azertyButton.addListener(
    Button.BUTTON_RELEASED,
    this.applyDefaultBindings.bind(this, "AZERTY")
  );
  this.keyboardTitle = new PIXI.Text(
    "Click on a key below and then press a new key to override it.",
    {
      fontName: "Arial",
      fontSize: 16,
      lineHeight: 18,
      fill: 16777215,
      strokeThickness: 2,
      lineJoin: "round",
    }
  );
  this.keyboardTitle.resolution = 1.5 * App.DevicePixelRatio;
  this.keyboardTitle.x = this.marginLeft - 5;
  this.keyboardTitle.y = this.marginTop + 86;
  this.addChild(this.keyboardTitle);
  a = this.settings.keyBindings;
  this.bindingFn = (b) => (this.settings.keyBindings[b.binding] = b.key);
  this.jumpControl = new KeyInput("ctrl_jump", "Jump", a.ctrl_jump, "binding_group");
  this.jumpControl.x = this.marginLeft;
  this.jumpControl.y = this.kbMarginTop;
  this.jumpControl.on(KeyInput.CHANGE, this.bindingFn);
  this.moveLeftControl = new KeyInput(
    "ctrl_move_left",
    "Move left",
    a.ctrl_move_left,
    "binding_group"
  );
  this.moveLeftControl.x = this.marginLeft;
  this.moveLeftControl.y = this.kbMarginTop + 30;
  this.moveLeftControl.on(KeyInput.CHANGE, this.bindingFn);
  this.moveRightControl = new KeyInput(
    "ctrl_move_right",
    "Move right",
    a.ctrl_move_right,
    "binding_group"
  );
  this.moveRightControl.x = this.marginLeft;
  this.moveRightControl.y = this.kbMarginTop + 60;
  this.moveRightControl.on(KeyInput.CHANGE, this.bindingFn);
  this.crouchControl = new KeyInput("ctrl_crouch", "Crouch", a.ctrl_crouch, "binding_group");
  this.crouchControl.x = this.marginLeft;
  this.crouchControl.y = this.kbMarginTop + 90;
  this.crouchControl.on(KeyInput.CHANGE, this.bindingFn);
  this.proneControl = new KeyInput("ctrl_prone", "Prone", a.ctrl_prone, "binding_group");
  this.proneControl.x = this.marginLeft;
  this.proneControl.y = this.kbMarginTop + 120;
  this.proneControl.on(KeyInput.CHANGE, this.bindingFn);
  this.fireControl = new KeyInput("ctrl_fire", "Fire [Left mouse]", a.ctrl_fire, "binding_group");
  this.fireControl.x = this.marginLeft;
  this.fireControl.y = this.kbMarginTop + 150;
  this.fireControl.setFixed();
  this.flyControl = new KeyInput("ctrl_fly", "Fly [Right mouse]", a.ctrl_fly, "binding_group");
  this.flyControl.x = this.marginLeft;
  this.flyControl.y = this.kbMarginTop + 180;
  this.flyControl.setFixed();
  this.reloadControl = new KeyInput("ctrl_reload", "Reload", a.ctrl_reload, "binding_group");
  this.reloadControl.x = this.marginLeft;
  this.reloadControl.y = this.kbMarginTop + 210;
  this.reloadControl.on(KeyInput.CHANGE, this.bindingFn);
  this.throwControl = new KeyInput(
    "ctrl_throw",
    "Throw nade / item",
    a.ctrl_throw,
    "binding_group"
  );
  this.throwControl.x = this.marginLeft + 260;
  this.throwControl.y = this.kbMarginTop;
  this.throwControl.on(KeyInput.CHANGE, this.bindingFn);
  this.dropControl = new KeyInput("ctrl_drop", "Throw weapon", a.ctrl_drop, "binding_group");
  this.dropControl.x = this.marginLeft + 260;
  this.dropControl.y = this.kbMarginTop + 30;
  this.dropControl.on(KeyInput.CHANGE, this.bindingFn);
  this.swapControl = new KeyInput("ctrl_swap", "Swap weapon", a.ctrl_swap, "binding_group");
  this.swapControl.x = this.marginLeft + 260;
  this.swapControl.y = this.kbMarginTop + 60;
  this.swapControl.on(KeyInput.CHANGE, this.bindingFn);
  this.throwFlagControl = new KeyInput(
    "ctrl_flag",
    "Throw flag [Jump + Crouch]",
    a.ctrl_flag,
    "binding_group"
  );
  this.throwFlagControl.x = this.marginLeft + 260;
  this.throwFlagControl.y = this.kbMarginTop + 90;
  this.throwFlagControl.setFixed();
  this.chatControl = new KeyInput("ctrl_chat", "Chat [or ENTER]", a.ctrl_chat, "binding_group");
  this.chatControl.x = this.marginLeft + 260;
  this.chatControl.y = this.kbMarginTop + 120;
  this.chatControl.on(KeyInput.CHANGE, this.bindingFn);
  this.helpControl = new KeyInput("ctrl_help", "Help", a.ctrl_help, "binding_group");
  this.helpControl.x = this.marginLeft + 260;
  this.helpControl.y = this.kbMarginTop + 150;
  this.helpControl.on(KeyInput.CHANGE, this.bindingFn);
  this.weaponMenuControl = new KeyInput(
    "ctrl_weapon",
    "Display weapons",
    a.ctrl_weapon,
    "binding_group"
  );
  this.weaponMenuControl.x = this.marginLeft + 260;
  this.weaponMenuControl.y = this.kbMarginTop + 180;
  this.weaponMenuControl.on(KeyInput.CHANGE, this.bindingFn);
  this.leaderBoardControl = new KeyInput(
    "ctrl_leader",
    "Display leaderboard",
    a.ctrl_leader,
    "binding_group"
  );
  this.leaderBoardControl.x = this.marginLeft + 260;
  this.leaderBoardControl.y = this.kbMarginTop + 210;
  this.leaderBoardControl.on(KeyInput.CHANGE, this.bindingFn);
  this.addChild(this.throwControl);
  this.addChild(this.dropControl);
  this.addChild(this.swapControl);
  this.addChild(this.throwFlagControl);
  this.addChild(this.chatControl);
  this.addChild(this.helpControl);
  this.addChild(this.weaponMenuControl);
  this.addChild(this.leaderBoardControl);
  this.addChild(this.jumpControl);
  this.addChild(this.moveLeftControl);
  this.addChild(this.moveRightControl);
  this.addChild(this.crouchControl);
  this.addChild(this.proneControl);
  this.addChild(this.fireControl);
  this.addChild(this.flyControl);
  this.addChild(this.reloadControl);
  try {
    this.applyBindings(this.settings.keyBindings);
  } catch (b) {
    this.applyBindings(InputState.DefaultBindings.QWERTY);
  }
}
ControlsTab.prototype = Object.create(PIXI.Container.prototype);
ControlsTab.prototype.constructor = ControlsTab;
EventDispatcher.call(ControlsTab.prototype);
ControlsTab.prototype.applyBindings = function (a) {
  this.jumpControl.setKey(a.ctrl_jump, !0);
  this.moveLeftControl.setKey(a.ctrl_move_left, !0);
  this.moveRightControl.setKey(a.ctrl_move_right, !0);
  this.crouchControl.setKey(a.ctrl_crouch, !0);
  this.proneControl.setKey(a.ctrl_prone, !0);
  this.fireControl.setKey(a.ctrl_fire, !0);
  this.flyControl.setKey(a.ctrl_fly, !0);
  this.reloadControl.setKey(a.ctrl_reload, !0);
  this.throwControl.setKey(a.ctrl_throw, !0);
  this.dropControl.setKey(a.ctrl_drop, !0);
  this.swapControl.setKey(a.ctrl_swap, !0);
  this.throwFlagControl.setKey(a.ctrl_flag, !0);
  this.chatControl.setKey(a.ctrl_chat, !0);
  this.helpControl.setKey(a.ctrl_help, !0);
  this.weaponMenuControl.setKey(a.ctrl_weapon, !0);
  this.leaderBoardControl.setKey(a.ctrl_leader, !0);
};
ControlsTab.prototype.applyDefaultBindings = function (a) {
  this.applyBindings(InputState.DefaultBindings[a]);
};
ControlsTab.prototype.getSettings = function () {
  return this.settings;
};
ControlsTab.prototype.enableInput = function () {
  this.jumpControl.enable();
  this.moveLeftControl.enable();
  this.moveRightControl.enable();
  this.crouchControl.enable();
  this.proneControl.enable();
  this.fireControl.enable();
  this.flyControl.enable();
  this.reloadControl.enable();
  this.throwControl.enable();
  this.dropControl.enable();
  this.swapControl.enable();
  this.throwFlagControl.enable();
  this.chatControl.enable();
  this.helpControl.enable();
  this.weaponMenuControl.enable();
  this.leaderBoardControl.enable();
};
ControlsTab.prototype.disableInput = function () {
  this.jumpControl.disable();
  this.moveLeftControl.disable();
  this.moveRightControl.disable();
  this.crouchControl.disable();
  this.proneControl.disable();
  this.fireControl.disable();
  this.flyControl.disable();
  this.reloadControl.disable();
  this.throwControl.disable();
  this.dropControl.disable();
  this.swapControl.disable();
  this.throwFlagControl.disable();
  this.chatControl.disable();
  this.helpControl.disable();
  this.weaponMenuControl.disable();
  this.leaderBoardControl.disable();
};
var dropdown = {};
function Dropdown(a, b, c, d) {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.id = a;
  this.selectWidth = c;
  this.dropWidth = d;
  this.title = new PIXI.Text(b || "", {
    fontSize: 18,
    fontFamily: "Arial",
    fill: 16763904,
    lineJoin: "round",
    strokeThickness: 3,
    align: "left",
  });
  this.title.x = 4;
  this.title.y = 0;
  this.hover = !1;
  this.title.tint = 16755200;
  this.title.resolution = 1.5 * App.DevicePixelRatio;
  this.itemContainer = new PIXI.Container();
  this.itemContainer.x = 82;
  this.itemContainer.y = 28;
  this.itemWidth = 180;
  this.background = new PIXI.Graphics();
  this.background.x = 74;
  this.background.y = -4;
  this.background.alpha = 0.75;
  this.itemContainerBackground = new PIXI.Graphics();
  this.itemContainer.addChild(this.itemContainerBackground);
  this.itemContainer.visible = !1;
  this.items = new OrderedContainer();
  this.selected = new PIXI.Text("none", {
    fontSize: 18,
    fontFamily: "Arial",
    fill: 16763904,
    lineJoin: "round",
    strokeThickness: 3,
    align: "left",
  });
  this.selected.resolution = 1.5 * App.DevicePixelRatio;
  this.selected.x = 80;
  this.selected.y = 0;
  this.selectedId = null;
  this.interactive = !0;
  this.on("mousedown", () => this.onMouseDown());
  this.on("touchstart", () => this.onMouseDown());
  this.on("mouseover", () => this.onMouseOver());
  this.on("mouseout", () => this.onMouseOut());
  this.expanded = !1;
  this.addChild(this.background);
  this.addChild(this.title);
  this.addChild(this.selected);
  this.addChild(this.itemContainer);
  this.dropdownIcon = new PIXI.Graphics();
  this.dropdownIcon.lineStyle(1, 16777215, 0, 0);
  this.dropdownIcon.beginFill(14540253, 0.5);
  this.dropdownIcon.drawPolygon([-6, 0, 6, 0, 0, 10]);
  this.dropdownIcon.endFill();
  this.dropdownIcon.x = this.itemContainer.x + this.selectWidth - 20;
  this.dropdownIcon.y = 6;
  this.addChild(this.dropdownIcon);
  Dropdown.Instances.push(this);
}
Dropdown.prototype = Object.create(PIXI.Container.prototype);
Dropdown.prototype.constructor = Dropdown;
EventDispatcher.call(Dropdown.prototype);
Dropdown.Instances = [];
Dropdown.CollapseInstances = () => {
  for (let a = 0; a < Dropdown.Instances.length; a++) {
    let b = Dropdown.Instances[a];
    b.hover || b.collapse();
  }
};
Dropdown.RemoveInstances = () => {
  Dropdown.Instances = [];
};
Dropdown.AddInstance = (a) => {
  for (let b = 0; b < Dropdown.Instances.length; b++) if (Dropdown.Instances[b] === a) return;
  Dropdown.Instances.push(a);
};
Dropdown.RemoveInstance = (a) => {
  for (let b = 0; b < Dropdown.Instances.length; b++)
    if (Dropdown.Instances[b] === a) {
      Dropdown.Instances.splice(b, 1);
      break;
    }
};
Dropdown.prototype.clear = function () {
  this.selected.text = "none";
  this.items.clear();
  this.itemContainerBackground.clear();
  this.itemContainer.removeChildren();
  this.itemContainer.addChild(this.itemContainerBackground);
};
Dropdown.prototype.addItem = function (a, b, c, d, e, f) {
  c = this.getItem(a, b, c, d, e, f);
  c.x = 0;
  c.y = 30 * this.items.getSize();
  this.items.add(c, b);
  this.itemContainer.addChild(c);
  1 === this.items.getSize() &&
    ((this.selected.fontName = "Arial"),
    (this.selected.fontSize = 12 < a.length ? 24 : 26),
    (this.selected.text = a),
    (this.selectedId = b));
  this.draw();
};
Dropdown.prototype.onMouseDown = function () {
  this.expanded ? this.collapse() : this.expand();
  AudioEffects.ButtonClick.audio.play();
};
Dropdown.prototype.setTint = function (a) {
  this.title.tint = a;
};
Dropdown.prototype.onMouseOver = function () {
  this.hover = !0;
  this.background.alpha = 1;
  AudioEffects.ButtonHover.audio.play();
};
Dropdown.prototype.onMouseOut = function () {
  this.hover = !1;
  this.background.alpha = 0.75;
};
Dropdown.prototype.getValue = function () {
  return this.selectedId;
};
Dropdown.prototype.setValue = function (a) {
  this.items.iterate(
    function (b, c) {
      return b === a
        ? ((this.selected.text = this.items.getById(b).title), (this.selectedId = b), !1)
        : !0;
    }.bind(this)
  );
};
Dropdown.prototype.expand = function () {
  0 < this.items.getSize() && (this.expanded = this.itemContainer.visible = !0);
};
Dropdown.prototype.collapse = function () {
  this.expanded = this.itemContainer.visible = !1;
};
Dropdown.prototype.onItemSelected = function (a) {
  let b = this.items.getById(a),
    c = b.title;
  this.icon && void 0 !== this.icon.parent && this.removeChild(this.icon);
  0 === c.length &&
    b.iconSprite &&
    ((this.icon = new PIXI.Sprite(b.iconSprite.texture)),
    (this.icon.x = this.selected.x),
    (this.icon.y = this.selected.y - 2),
    this.addChild(this.icon));
  this.selected.text = c;
  this.selectedId = a;
  this.collapse();
  this.dispatchEvent(
    new CustomEvent(Button.BUTTON_RELEASED, { id: this.id, value: this.selectedId })
  );
  this.draw();
};
Dropdown.prototype.getItem = function (a, b, c, d, e = 1, f = 0) {
  let g = new PIXI.Container(),
    h = new PIXI.Text(a, {
      fontSize: 18,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 3,
      align: "left",
    });
  h.resolution = 1.5 * App.DevicePixelRatio;
  h.x = 4;
  h.y = 2;
  g.interactive = !0;
  g.mousedown = (m) => {
    m.stopPropagation();
    this.onItemSelected(b);
  };
  g.touchstart = (m) => {
    m.stopPropagation();
    this.onItemSelected(b);
  };
  var k = new PIXI.Graphics();
  k.interactive = !0;
  k.beginFill(6710886, 1);
  k.drawRect(-6, -1, this.dropWidth - 4, 28);
  k.endFill();
  k.alpha = 0.4;
  k.on("mouseover", function () {
    k.alpha = 0.8;
    AudioEffects.ButtonHover.audio.play();
  });
  k.on("mouseout", function () {
    k.alpha = 0.4;
  });
  g.title = a;
  g.addChild(k);
  g.addChild(h);
  a = new PIXI.Text(c, {
    fontSize: 16,
    fontFamily: "Arial",
    fill: 13421772,
    lineJoin: "round",
    strokeThickness: 3,
    align: "left",
  });
  a.resolution = 1.5 * App.DevicePixelRatio;
  a.x = this.dropWidth - (a.width + 14);
  a.y = 3;
  g.addChild(a);
  void 0 !== d &&
    ((d = new PIXI.Sprite(d)),
    (d.x = 0),
    (d.y = -3 + f),
    (d.scale.x = d.scale.y = e),
    (g.iconSprite = d),
    g.addChild(d),
    (h.x = 34));
  return g;
};
Dropdown.prototype.draw = function () {
  this.background.clear();
  this.background.lineStyle(2, 2236962, 0.2, 0);
  this.background.beginFill(5592405, 1);
  this.background.drawRect(0, 0, this.selectWidth, 28);
  this.background.endFill();
  this.itemContainerBackground.x = -8;
  this.itemContainerBackground.y = -3;
  this.itemContainerBackground.clear();
  this.itemContainerBackground.lineStyle(2, 5592405, 0.2, 0);
  this.itemContainerBackground.beginFill(2236962, 1);
  this.itemContainerBackground.drawRect(0, 0, this.dropWidth, 30 * this.items.getSize() + 2);
  this.itemContainerBackground.endFill();
};
var graphicstab = {};
function GraphicsTab(a) {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.settings = a;
  void 0 === this.settings
    ? (this.settings = { reticleLine: !0, aa: !1, fxaa: !1, chatLines: 20, chatOpacity: 1 })
    : (void 0 === this.settings.chatLines && (this.settings.chatLines = 20),
      void 0 === this.settings.chatOpacity && (this.settings.chatOpacity = 1));
  this.aaUpdated = this.forceRefresh = !1;
  this.marginLeft = 40;
  this.marginTop = 52;
  this.graphicsTitle = new PIXI.Text("Display settings", {
    fontName: "Arial",
    fontSize: 18,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.graphicsTitle.x = this.marginLeft - 5;
  this.graphicsTitle.y = this.marginTop + 6;
  this.addChild(this.graphicsTitle);
  this.reticleLine = new Checkbox("reticle", "Display reticle line", !0);
  this.reticleLine.x = this.marginLeft;
  this.reticleLine.y = this.marginTop + 40;
  this.reticleLine.on(Checkbox.CHANGE, (b) => (this.settings.reticleLine = b));
  this.addChild(this.reticleLine);
  this.enableShockwaves = new Checkbox(
    "shockwaveFx",
    "Enable shockwave effects. Prettier but slower!",
    !1
  );
  this.enableShockwaves.x = this.marginLeft;
  this.enableShockwaves.y = this.marginTop + 90;
  this.enableShockwaves.on(Checkbox.CHANGE, (b) => {
    this.settings.shockwaveFx = b;
  });
  this.addChild(this.enableShockwaves);
  this.chatLinesSlider = new Slider("chatLines", "Console lines", 20, 30, 2);
  this.chatLinesSlider.round = !0;
  this.chatLinesSlider.x = this.marginLeft;
  this.chatLinesSlider.y = this.marginTop + 140;
  this.chatLinesSlider.on(Slider.CHANGE, (b) => (this.settings.chatLines = b));
  this.addChild(this.chatLinesSlider);
  this.chatOpacitySlider = new Slider("chatOpacity", "Console opacity", 0.8, 1);
  this.chatOpacitySlider.x = this.marginLeft + 290;
  this.chatOpacitySlider.y = this.marginTop + 140;
  this.chatOpacitySlider.on(Slider.CHANGE, (b) => (this.settings.chatOpacity = b));
  this.addChild(this.chatOpacitySlider);
  this.enableAA = new Checkbox(
    "aa",
    "Enable anti-aliasing(AA). Prettier but slower!\n(Window will refresh on save)",
    !1
  );
  this.enableAA.x = this.marginLeft;
  this.enableAA.y = this.marginTop + 230;
  this.enableAA.on(Checkbox.CHANGE, (b) => {
    this.settings.aa = b;
    this.aaUpdated = !this.aaUpdated;
    this.forceRefresh = this.checkIfRefreshNeeded();
  });
  this.addChild(this.enableAA);
  try {
    this.reticleLine.setChecked(this.settings.reticleLine),
      this.chatLinesSlider.setValue(
        void 0 !== this.settings.chatLines ? this.settings.chatLines : 20
      ),
      this.chatOpacitySlider.setValue(
        void 0 !== this.settings.chatOpacity ? this.settings.chatOpacity : 1
      ),
      this.enableAA.setChecked(this.settings.aa, !1),
      this.enableShockwaves.setChecked(
        void 0 !== this.settings.shockwaveFx ? this.settings.shockwaveFx : !0
      );
  } catch (b) {
    this.reticleLine.setChecked(!0),
      this.chatLinesSlider.setValue(20),
      this.chatOpacitySlider.setValue(1),
      this.enableAA.setChecked(!1),
      this.enableShockwaves.setChecked(!0);
  }
}
GraphicsTab.prototype = Object.create(PIXI.Container.prototype);
GraphicsTab.prototype.constructor = GraphicsTab;
EventDispatcher.call(GraphicsTab.prototype);
GraphicsTab.prototype.getSettings = function () {
  return this.settings;
};
GraphicsTab.prototype.checkIfRefreshNeeded = function () {
  return this.aaUpdated;
};
var keyinput = {};
function KeyInput(a, b, c, d) {
  PIXI.Container.call(this);
  this.id = a;
  this.labelText = b;
  this.key = c;
  this.group = d;
  this.hasFocus = this.fixed = !1;
  this.hitArea = new PIXI.Rectangle(0, 0, 200, 30);
  this.icon = new PIXI.Sprite(App.CombinedTextures.key_input);
  this.icon.scale.x = this.icon.scale.y = 0.4;
  this.interactive = !0;
  this._mousedownListener = this.onMouseDown.bind(this);
  this.on("mousedown", this._mousedownListener);
  this.keyField = new PIXI.Text(this.key, {
    fontName: "Arial",
    fontSize: 16,
    lineHeight: 18,
    fill: 16777215,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.keyField.resolution = 1.5 * App.DevicePixelRatio;
  this.keyField.x = this.icon.x + 0.5 * (this.icon.width - this.keyField.width);
  this.keyField.y = this.icon.y + 2;
  this.label = new PIXI.Text(this.labelText, {
    fontName: "Arial",
    fontSize: 15,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 2,
    lineJoin: "round",
  });
  this.label.resolution = 1.5 * App.DevicePixelRatio;
  this.label.x = this.icon.x + 40;
  this.label.y = this.icon.y + 3;
  this.keyDownListener = this.onKeyDown.bind(this);
  this.on("mouseover", () => (this.scale.x = this.scale.y = this.fixed ? 1 : 1.1));
  this.on("mouseout", () => (this.scale.x = this.scale.y = 1));
  this.addChild(this.icon);
  this.addChild(this.keyField);
  this.addChild(this.label);
  KeyInput.RegisterInput(this);
}
KeyInput.prototype = Object.create(PIXI.Container.prototype);
KeyInput.prototype.constructor = KeyInput;
KeyInput.CHANGE = "keyinput_change";
KeyInput.RegisterInput = function (a) {
  void 0 === KeyInput.RegisteredGroups[a.group] && (KeyInput.RegisteredGroups[a.group] = []);
  KeyInput.RegisteredGroups[a.group].push(a);
};
KeyInput.DisableAll = function () {
  for (var a in KeyInput.RegisteredGroups)
    for (var b = 0; b < KeyInput.RegisteredGroups[a].length; b++)
      KeyInput.RegisteredGroups[a][b].setFocus(!1);
};
KeyInput.RegisteredGroups = {};
KeyInput.prototype.onMouseDown = function (a) {
  this.setFocus(!this.hasFocus);
};
KeyInput.prototype.setFocus = function (a) {
  if ((this.hasFocus = a))
    for (
      this.keyField.text = "...", this.label.text = "[PRESS A KEY] " + this.labelText, a = 0;
      a < KeyInput.RegisteredGroups[this.group].length;
      a++
    )
      KeyInput.RegisteredGroups[this.group][a] !== this &&
        KeyInput.RegisteredGroups[this.group][a].setFocus(!1);
  else (this.keyField.text = this.key), (this.label.text = this.labelText);
};
KeyInput.prototype.onKeyDown = function (a) {
  this.hasFocus &&
    ((this.key =
      void 0 !== characterMapCTRL[a.data.code]
        ? characterMapCTRL[a.data.code]
        : a.data.char.toUpperCase()),
    this.setKey(this.key, !0));
};
KeyInput.prototype.setFixed = function () {
  this.removeListener("mousedown", this._mousedownListener);
  this.icon.tint = 16711680;
  this.fixed = !0;
};
KeyInput.prototype.enable = function () {
  UserInput.addListener(UserInput.KEY_DOWN, this.keyDownListener);
};
KeyInput.prototype.disable = function () {
  UserInput.removeListener(UserInput.KEY_DOWN, this.keyDownListener);
};
KeyInput.prototype.setKey = function (a, b) {
  this.key = a;
  this.keyField.text = a;
  this.keyField.x = this.icon.x + 0.5 * (this.icon.width - this.keyField.width);
  this.setFocus(!1);
  b && this.emit(KeyInput.CHANGE, { binding: this.id, key: this.key });
};
var settingspanel = {};
function SettingsPanel(a, b) {
  PIXI.Container.call(this);
  this.settings = Registry.Instance[Registry.Key.SETTINGS];
  this.interactive = !0;
  this.panelWidth = a;
  this.panelHeight = b;
  this.background = new PIXI.Graphics();
  this.background.x = 0;
  this.background.y = 0;
  this.background.lineStyle(1, 16777215, 0.1, 0);
  this.background.beginFill(3355443, 1);
  this.background.drawRect(0, 0, 660, 524);
  this.background.endFill();
  this.background.beginFill(0, 0.3);
  this.background.drawRect(10, 10, 640, 504);
  this.background.endFill();
  this.background.drawRect(15, 42, 630, 2);
  this.addChild(this.background);
  this.applyButton = new Button("save");
  this.applyButton.x = this.panelWidth - 134;
  this.applyButton.y = this.panelHeight - 46;
  this.applyButton.setText("Save & close");
  this.applyButton.scale.x = this.applyButton.scale.y = 0.8;
  this.applyButton.addListener(Button.BUTTON_RELEASED, this.onApplyButtonReleased.bind(this));
  this.applyButton.setTint(16763904);
  this.addChild(this.applyButton);
  this.closeButton = new ImgButton();
  this.closeButton.x = this.panelWidth - 40;
  this.closeButton.y = 14;
  this.closeButton.scale.x = this.closeButton.scale.y = 0.8;
  this.closeButton.on(ImgButton.CLICK, () => this.onCloseButtonReleased());
  this.addChild(this.closeButton);
  this.controlsTab = new ControlsTab(this.settings.controls);
  this.controlsTabButton = new PIXI.Text("Controls", {
    fontName: "Arial",
    fontSize: 18,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.controlsTabButton.resolution = 1.5 * App.DevicePixelRatio;
  this.controlsTabButton.anchor.x = this.controlsTabButton.anchor.y = 0.5;
  this.controlsTabButton.x = 60;
  this.controlsTabButton.y = 28;
  this.addChild(this.controlsTabButton);
  this.controlsTabButtonBackground = new PIXI.Graphics();
  this.controlsTabButtonBackground.beginFill(16777215, 0.1);
  this.controlsTabButtonBackground.drawRoundedRect(0, 0, 92, 30, 2);
  this.controlsTabButtonBackground.endFill();
  this.controlsTabButtonBackground.x = 14;
  this.controlsTabButtonBackground.y = 12;
  this.controlsTabButtonBackground.interactive = !0;
  this.controlsTabButtonBackground.on(
    "touchstart",
    this.displayTab.bind(this, SettingsPanel.Tabs.CONTROLS)
  );
  this.controlsTabButtonBackground.on(
    "mousedown",
    this.displayTab.bind(this, SettingsPanel.Tabs.CONTROLS)
  );
  this.controlsTabButtonBackground.on("mouseover", () => {
    this.controlsTabButtonBackground.tint = 11184810;
  });
  this.controlsTabButtonBackground.on("mouseout", () => {
    this.controlsTabButtonBackground.tint = 16777215;
  });
  this.addChild(this.controlsTabButtonBackground);
  this.graphicsTab = new GraphicsTab(this.settings.graphics);
  this.graphicsTabButton = new PIXI.Text("Display", {
    fontName: "Arial",
    fontSize: 18,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.graphicsTabButton.resolution = 1.5 * App.DevicePixelRatio;
  this.graphicsTabButton.anchor.x = this.graphicsTabButton.anchor.y = 0.5;
  this.graphicsTabButton.x = 154;
  this.graphicsTabButton.y = 28;
  this.addChild(this.graphicsTabButton);
  this.graphicsTabButtonBackground = new PIXI.Graphics();
  this.graphicsTabButtonBackground.beginFill(16777215, 0.1);
  this.graphicsTabButtonBackground.drawRoundedRect(0, 0, 92, 30, 2);
  this.graphicsTabButtonBackground.endFill();
  this.graphicsTabButtonBackground.x = 110;
  this.graphicsTabButtonBackground.y = 12;
  this.graphicsTabButtonBackground.interactive = !0;
  this.graphicsTabButtonBackground.on(
    "touchstart",
    this.displayTab.bind(this, SettingsPanel.Tabs.GRAPHICS)
  );
  this.graphicsTabButtonBackground.on(
    "mousedown",
    this.displayTab.bind(this, SettingsPanel.Tabs.GRAPHICS)
  );
  this.graphicsTabButtonBackground.on("mouseover", () => {
    this.graphicsTabButtonBackground.tint = 11184810;
  });
  this.graphicsTabButtonBackground.on("mouseout", () => {
    this.graphicsTabButtonBackground.tint = 16777215;
  });
  this.addChild(this.graphicsTabButtonBackground);
  this.soundTab = new SoundTab(this.settings.sound);
  this.soundTabButton = new PIXI.Text("Sound", {
    fontName: "Arial",
    fontSize: 18,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.soundTabButton.resolution = 1.5 * App.DevicePixelRatio;
  this.soundTabButton.anchor.x = this.soundTabButton.anchor.y = 0.5;
  this.soundTabButton.x = 250;
  this.soundTabButton.y = 28;
  this.addChild(this.soundTabButton);
  this.soundTabButtonBackground = new PIXI.Graphics();
  this.soundTabButtonBackground.beginFill(16777215, 0.1);
  this.soundTabButtonBackground.drawRoundedRect(0, 0, 92, 30, 2);
  this.soundTabButtonBackground.endFill();
  this.soundTabButtonBackground.x = 206;
  this.soundTabButtonBackground.y = 12;
  this.soundTabButtonBackground.interactive = !0;
  this.soundTabButtonBackground.on(
    "touchstart",
    this.displayTab.bind(this, SettingsPanel.Tabs.SOUND)
  );
  this.soundTabButtonBackground.on(
    "mousedown",
    this.displayTab.bind(this, SettingsPanel.Tabs.SOUND)
  );
  this.soundTabButtonBackground.on("mouseover", () => {
    this.soundTabButtonBackground.tint = 11184810;
  });
  this.soundTabButtonBackground.on("mouseout", () => {
    this.soundTabButtonBackground.tint = 16777215;
  });
  this.addChild(this.soundTabButtonBackground);
  this.displayTab(SettingsPanel.Tabs.CONTROLS);
}
SettingsPanel.prototype = Object.create(PIXI.Container.prototype);
SettingsPanel.prototype.constructor = SettingsPanel;
SettingsPanel.Tabs = { GRAPHICS: "graphics", CONTROLS: "controls", SOUND: "sound" };
SettingsPanel.CLOSE = "close";
SettingsPanel.prototype.show = function () {
  this.controlsTab.enableInput();
};
SettingsPanel.prototype.displayTab = function (a) {
  AudioEffects.ButtonClick.audio.play();
  switch (a) {
    case SettingsPanel.Tabs.GRAPHICS:
      this.controlsTab.parent && this.removeChild(this.controlsTab);
      this.soundTab.parent && this.removeChild(this.soundTab);
      this.addChild(this.graphicsTab);
      this.soundTabButtonBackground.alpha = 1;
      this.graphicsTabButtonBackground.alpha = 0;
      this.controlsTabButtonBackground.alpha = 1;
      break;
    case SettingsPanel.Tabs.CONTROLS:
      this.graphicsTab.parent && this.removeChild(this.graphicsTab);
      this.soundTab.parent && this.removeChild(this.soundTab);
      this.soundTabButtonBackground.alpha = 1;
      this.graphicsTabButtonBackground.alpha = 1;
      this.controlsTabButtonBackground.alpha = 0;
      this.addChild(this.controlsTab);
      break;
    case SettingsPanel.Tabs.SOUND:
      this.graphicsTab.parent && this.removeChild(this.graphicsTab),
        this.controlsTab.parent && this.removeChild(this.controlsTab),
        (this.soundTabButtonBackground.alpha = 0),
        (this.graphicsTabButtonBackground.alpha = 1),
        (this.controlsTabButtonBackground.alpha = 1),
        this.addChild(this.soundTab);
  }
};
SettingsPanel.prototype.onApplyButtonReleased = function () {
  var a = {
    controls: this.controlsTab.getSettings(),
    graphics: this.graphicsTab.getSettings(),
    sound: this.soundTab.getSettings(),
  };
  this.applySettings(a);
  (this.controlsTab.forceRefresh || this.soundTab.forceRefresh || this.graphicsTab.forceRefresh) &&
    location.reload();
  App.Layer.onSettingsHide();
};
SettingsPanel.prototype.applySettings = function (a) {
  KeyInput.DisableAll();
  Registry.Instance.store(Registry.Key.SETTINGS, a);
  Howler.mute(!a.sound.enabled);
  Howler.volume(a.sound.volume);
  App.Console.reset();
  App.Console.maxLines = a.graphics.chatLines;
  App.Console.targetAlpha = a.graphics.chatOpacity;
  this.controlsTab.disableInput();
};
SettingsPanel.prototype.onCloseButtonReleased = function () {
  KeyInput.DisableAll();
  App.Layer.onSettingsHide();
  this.controlsTab.disableInput();
};
var slider = {};
function Slider(a, b, c, d, e) {
  PIXI.Container.call(this);
  this.id = a;
  this.labelText = b;
  this.range = d;
  this.min = void 0 !== e ? e : 0;
  this.value = (c - this.min) / (this.range - this.min);
  this.size = 200;
  this.round = !1;
  this.onMouseMoveListener = null;
  this.background = new PIXI.Graphics();
  this.background.lineStyle(4, 16777215, 0.2);
  this.background.beginFill(16777215, 0.3);
  this.background.drawRoundedRect(0, 0, this.size, 30, 15);
  this.background.endFill();
  this.background.x = 0;
  this.background.y = 26;
  this.background.on("mousedown", this.onMouseDown.bind(this));
  this.background.on("mouseout", this.onMouseOut.bind(this));
  this.background.on("mouseup", this.onMouseUp.bind(this));
  this.background.interactive = !0;
  this.background.lineStyle(0, 16777215, 0);
  this.background.beginFill(13421772, 0.2);
  this.background.drawPolygon([this.size - 10, 7, this.size - 10, 23, 10, 15]);
  this.background.endFill();
  this.sliderButton = new PIXI.Graphics();
  this.sliderButton.beginFill(16777215, 0.6);
  this.sliderButton.drawRoundedRect(0, 0, 24, 24, 12);
  this.sliderButton.endFill();
  this.sliderButton.x = 4;
  this.sliderButton.y = 29;
  this.label = new PIXI.Text(this.labelText, {
    fontName: "Arial",
    fontSize: 16,
    lineHeight: 18,
    fill: 16777215,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.label.resolution = 1.5 * App.DevicePixelRatio;
  this.label.x = 0.5 * this.size - 2;
  this.label.y = 0;
  this.label.anchor.x = 0.5;
  this.valueLabel = new PIXI.BitmapText(c ? c.toString() : "0", {
    fontName: "Open Sans",
    fontSize: 22,
    fill: "#CCCCCC",
  });
  this.valueLabel.x = this.size + 16;
  this.valueLabel.y = 29;
  this.valueLabel.anchor.x = 0;
  this.volumeMinLabel = new PIXI.Text("min", {
    fontName: "Arial",
    fontSize: 14,
    lineHeight: 18,
    fill: 16777215,
    strokeThickness: 2,
    lineJoin: "round",
  });
  this.volumeMinLabel.resolution = 1.5 * App.DevicePixelRatio;
  this.volumeMinLabel.x = 10;
  this.volumeMinLabel.y = 5;
  this.volumeMinLabel.tint = 16777215;
  this.volumeMinLabel.alpha = 0.8;
  this.volumeMaxLabel = new PIXI.Text("max", {
    fontName: "Arial",
    fontSize: 14,
    lineHeight: 18,
    fill: 16777215,
    strokeThickness: 2,
    lineJoin: "round",
  });
  this.volumeMaxLabel.resolution = 1.5 * App.DevicePixelRatio;
  this.volumeMaxLabel.x = this.size - 40;
  this.volumeMaxLabel.y = 5;
  this.volumeMaxLabel.tint = 16777215;
  this.volumeMaxLabel.alpha = 0.8;
  this.mouseDownListener = null;
  this.addChild(this.label);
  this.addChild(this.background);
  this.addChild(this.volumeMinLabel);
  this.addChild(this.volumeMaxLabel);
  this.addChild(this.sliderButton);
  this.addChild(this.valueLabel);
  this.updateSliderButtonPosition(this.value);
}
Slider.prototype = Object.create(PIXI.Container.prototype);
Slider.prototype.constructor = Slider;
Slider.CHANGE = "slider_change";
Slider.prototype.onMouseDown = function (a) {
  null === this.onMouseMoveListener &&
    ((this.onMouseMoveListener = this.onMouseMove.bind(this)),
    this.background.on("mousemove", this.onMouseMoveListener));
  this.value = this.globalToValue(a.data.global);
  this.updateSliderButtonPosition();
  a = this.getOutputValue();
  this.valueLabel.text = this.round ? a.toString() : (Math.round(10 * a) / 10).toString();
  this.emit(Slider.CHANGE, a);
};
Slider.prototype.onMouseMove = function (a) {
  this.value = this.globalToValue(a.data.global);
  this.updateSliderButtonPosition();
  a = this.getOutputValue();
  this.valueLabel.text = this.round ? a.toString() : (Math.round(10 * a) / 10).toString();
  this.emit(Slider.CHANGE, a);
};
Slider.prototype.getOutputValue = function () {
  var a = this.min + this.value * (this.range - this.min);
  return this.round ? Math.round(a) : a;
};
Slider.prototype.onMouseOut = function (a) {
  null !== this.onMouseMoveListener &&
    (this.background.removeListener("mousemove", this.onMouseMoveListener),
    (this.onMouseMoveListener = null));
};
Slider.prototype.onMouseUp = function (a) {
  null !== this.onMouseMoveListener &&
    (this.background.removeListener("mousemove", this.onMouseMoveListener),
    (this.onMouseMoveListener = null));
};
Slider.prototype.updateSliderButtonPosition = function () {
  this.sliderButton.x = 4 + this.value * (this.size - (this.sliderButton.width + 8));
};
Slider.prototype.setValue = function (a) {
  this.value = (a - this.min) / (this.range - this.min);
  this.updateSliderButtonPosition();
  a = this.getOutputValue();
  this.valueLabel.text = this.round ? a.toString() : (Math.round(10 * a) / 10).toString();
};
Slider.prototype.globalToValue = function (a) {
  a = this.background.toLocal(a);
  a = (0.5 * this.size + 1.1 * (a.x - 0.5 * this.size)) / this.size;
  return 1 < a ? 1 : 0 > a ? 0 : a;
};
var soundtab = {};
function SoundTab(a) {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this.settings = a;
  void 0 === this.settings && (this.settings = { enabled: !0, volume: 1 });
  this.forceRefresh = !1;
  this.marginLeft = 40;
  this.marginTop = 52;
  this.soundTitle = new PIXI.Text("Sound settings", {
    fontName: "Arial",
    fontSize: 18,
    lineHeight: 18,
    fill: 16763904,
    strokeThickness: 3,
    lineJoin: "round",
  });
  this.soundTitle.x = this.marginLeft - 5;
  this.soundTitle.y = this.marginTop + 6;
  this.addChild(this.soundTitle);
  this.soundCheck = new Checkbox("enabled", "Enable sound", !0);
  this.soundCheck.x = this.marginLeft;
  this.soundCheck.y = this.marginTop + 40;
  this.soundCheck.on(Checkbox.CHANGE, (b) => (this.settings.enabled = b));
  this.addChild(this.soundCheck);
  this.volumeSlider = new Slider("volume", "Volume", 1, 1);
  this.volumeSlider.x = this.marginLeft;
  this.volumeSlider.y = this.marginTop + 80;
  this.volumeSlider.on(Slider.CHANGE, (b) => (this.settings.volume = b));
  this.addChild(this.volumeSlider);
  try {
    this.soundCheck.setChecked(this.settings.enabled),
      this.volumeSlider.setValue(this.settings.volume);
  } catch (b) {
    this.soundCheck.setChecked(!0), this.volumeSlider.setValue(1);
  }
}
SoundTab.prototype = Object.create(PIXI.Container.prototype);
SoundTab.prototype.constructor = SoundTab;
EventDispatcher.call(SoundTab.prototype);
SoundTab.prototype.getSettings = function () {
  return this.settings;
};
var table = {};
function Table() {
  PIXI.Container.call(this);
  EventDispatcher.call(this);
  this._titleContainer = new PIXI.Graphics();
  this._rowContainer = new PIXI.Graphics();
  this._titles = [];
  this._rows = [];
  this._colWidth = 200;
  this._rowHeight = 30;
  this.addChild(this._titleContainer);
  this.addChild(this._rowContainer);
  this._rowContainer.x = 0;
  this._rowContainer.y = 40;
}
Table.ROW_SELECTED = "rowSelected";
Table.prototype = Object.create(PIXI.Container.prototype);
Table.prototype.constructor = Table;
EventDispatcher.call(Table.prototype);
Table.prototype.setTitles = function (a) {
  for (var b, c = 0, d = 0, e = a.length; d < e; d++)
    this._titleContainer.beginFill(3355443, 0.5),
      this._titleContainer.drawRect(c * this._colWidth, 0, this._colWidth, this._rowHeight),
      this._titleContainer.endFill(),
      this._titles.push(b),
      (b = new PIXI.BitmapText(a[d], { fontName: "Open Sans", fontSize: 20, fill: "#CCCCCC" })),
      this._titleContainer.addChild(b),
      (b.x = c * this._colWidth + 0.5 * (this._colWidth - b.width)),
      (b.y = 5),
      c++;
};
Table.prototype.addRow = function (a) {
  for (var b = this._rows.length, c = new PIXI.Container(), d, e = 1, f = a.length; e < f; e++)
    (d = new PIXI.BitmapText(a[e], { fontName: "Open Sans", fontSize: 20, fill: "#CCCCCC" })),
      (d.x = this._colWidth * (e - 1) + 0.5 * (this._colWidth - d.width)),
      (d.y = 0),
      c.addChild(d);
  c.id = a[0];
  c.interactive = !0;
  c.touchstart = c.mousedown = this.onRowSelected.bind(this);
  this._rowContainer.lineStyle(1, 13421772, 0.5);
  this._rowContainer.moveTo(0, b * this._rowHeight - 10);
  this._rowContainer.lineTo(this._titles.length * this._colWidth, b * this._rowHeight - 10);
  c.y = b * this._rowHeight;
  this._rows.push(c);
  this._rowContainer.addChild(c);
};
Table.prototype.onRowSelected = function (a) {
  this.dispatchEvent(new CustomEvent(Table.ROW_SELECTED, { id: a.target.id }));
};
Table.prototype.clear = function () {
  for (var a = 0, b = this._rows.length; a < b; a++) this._rowContainer.removeChild(this._rows[a]);
  this._rows.splice(0, this._rows.length);
  this._rowContainer.clear();
};
var textinput = {};
function _typeof(a) {
  "@babel/helpers - typeof";
  _typeof =
    "function" === typeof Symbol && "symbol" === typeof Symbol.iterator
      ? function (b) {
          return typeof b;
        }
      : function (b) {
          return b &&
            "function" === typeof Symbol &&
            b.constructor === Symbol &&
            b !== Symbol.prototype
            ? "symbol"
            : typeof b;
        };
  return _typeof(a);
}
function _instanceof(a, b) {
  return null != b && "undefined" !== typeof Symbol && b[Symbol.hasInstance]
    ? !!b[Symbol.hasInstance](a)
    : a instanceof b;
}
function _defineProperties(a, b) {
  for (var c = 0; c < b.length; c++) {
    var d = b[c];
    d.enumerable = d.enumerable || !1;
    d.configurable = !0;
    "value" in d && (d.writable = !0);
    Object.defineProperty(a, d.key, d);
  }
}
function _createClass(a, b, c) {
  b && _defineProperties(a.prototype, b);
  c && _defineProperties(a, c);
  return a;
}
function _inheritsLoose(a, b) {
  a.prototype = Object.create(b.prototype);
  a.prototype.constructor = a;
  a.__proto__ = b;
}
(function (a) {
  function b(e) {
    e = e || { fill: 13421772 };
    if (e.default) (e.focused = e.focused || e.default), (e.disabled = e.disabled || e.default);
    else {
      var f = e;
      e = {};
      e.default = e.focused = e.disabled = f;
    }
    return function (g, h, k) {
      if ("function" !== typeof k.toLowerCase) console.log("invalid textinput state");
      else {
        k = e[k.toLowerCase()];
        var m = new c.Graphics();
        k.fill && m.beginFill(k.fill);
        k.stroke && m.lineStyle(k.stroke.width || 1, k.stroke.color || 0, k.stroke.alpha || 1);
        k.rounded ? m.drawRoundedRect(0, 0, g, h, k.rounded) : m.drawRect(0, 0, g, h);
        m.endFill();
        m.closePath();
        return m;
      }
    };
  }
  var c = a.PIXI,
    d = (function (e) {
      function f(h) {
        var k = e.call(this) || this;
        k._input_style = Object.assign(
          {
            position: "absolute",
            background: "none",
            border: "none",
            outline: "none",
            transformOrigin: "0 0",
            lineHeight: "1",
          },
          h.input
        );
        k._box_generator = h.box ? ("function" === typeof h.box ? h.box : new b(h.box)) : null;
        k._input_style.hasOwnProperty("multiline")
          ? ((k._multiline = !!k._input_style.multiline), delete k._input_style.multiline)
          : (k._multiline = !1);
        k._box_cache = {};
        k._previous = {};
        k._dom_added = !1;
        k._dom_visible = !0;
        k._placeholder = "";
        k._placeholderColor = 11119017;
        k._selection = [0, 0];
        k._restrict_value = "";
        k._createDOMInput();
        k.substituteText = !0;
        k._setState("DEFAULT");
        k._addListeners();
        return k;
      }
      _inheritsLoose(f, e);
      var g = f.prototype;
      g.markValid = function () {
        0 < this.children.length && (this.children[0].tint = 65280);
      };
      g.markInvalid = function () {
        0 < this.children.length && (this.children[0].tint = 16711680);
      };
      g.markNone = function () {
        0 < this.children.length && (this.children[0].tint = 16777215);
      };
      g.focus = function () {
        this._substituted && !this.dom_visible && this._setDOMInputVisible(!0);
        0 < this.children.length && (this.children[0].tint = 16777215);
        this._dom_input.focus();
      };
      g.blur = function () {
        this._dom_input.blur();
      };
      g.select = function () {
        this.focus();
        this._dom_input.select();
      };
      g.setInputStyle = function (h, k) {
        this._input_style[h] = k;
        this._dom_input.style[h] = k;
        !this._substituted || ("fontFamily" !== h && "fontSize" !== h) || this._updateFontMetrics();
        this._last_renderer && this._update();
      };
      g.destroy = function (h) {
        this._destroyBoxCache();
        e.prototype.destroy.call(this, h);
      };
      g._createDOMInput = function () {
        this._multiline
          ? ((this._dom_input = document.createElement("textarea")),
            (this._dom_input.style.resize = "none"))
          : ((this._dom_input = document.createElement("input")), (this._dom_input.type = "text"));
        for (var h in this._input_style) this._dom_input.style[h] = this._input_style[h];
      };
      g._addListeners = function () {
        this.on("added", this._onAdded.bind(this));
        this.on("removed", this._onRemoved.bind(this));
        this._dom_input.addEventListener("keydown", this._onInputKeyDown.bind(this));
        this._dom_input.addEventListener("input", this._onInputInput.bind(this));
        this._dom_input.addEventListener("keyup", this._onInputKeyUp.bind(this));
        this._dom_input.addEventListener("focus", this._onFocused.bind(this));
        this._dom_input.addEventListener("blur", this._onBlurred.bind(this));
      };
      g._onInputKeyDown = function (h) {
        this._selection = [this._dom_input.selectionStart, this._dom_input.selectionEnd];
        this.emit("keydown", h.keyCode);
      };
      g._onInputInput = function (h) {
        this._restrict_regex && this._applyRestriction();
        this._substituted && this._updateSubstitution();
        this.emit("input", this.text);
      };
      g._onInputKeyUp = function (h) {
        this.emit("keyup", h.keyCode);
      };
      g._onFocused = function () {
        this._setState("FOCUSED");
        App.FieldHasFocus = !0;
        this.emit("focus");
      };
      g._onBlurred = function () {
        this._setState("DEFAULT");
        App.FieldHasFocus = !1;
        this.emit("blur");
      };
      g._onAdded = function () {
        document.body.appendChild(this._dom_input);
        this._dom_input.style.display = "none";
        this._dom_added = !0;
      };
      g._onRemoved = function () {
        document.body.removeChild(this._dom_input);
        this._dom_added = !1;
      };
      g._setState = function (h) {
        this.state = h;
        this._updateBox();
        this._substituted && this._updateSubstitution();
      };
      g.renderWebGL = function (h) {
        e.prototype.renderWebGL.call(this, h);
        this._renderInternal(h);
      };
      g.renderCanvas = function (h) {
        e.prototype.renderCanvas.call(this, h);
        this._renderInternal(h);
      };
      g.render = function (h) {
        e.prototype.render.call(this, h);
        this._renderInternal(h);
      };
      g._renderInternal = function (h) {
        this._resolution = h.resolution;
        this._last_renderer = h;
        this._canvas_bounds = this._getCanvasBounds();
        this._needsUpdate() && this._update();
      };
      g._update = function () {
        this._updateDOMInput();
        this._substituted && this._updateSurrogate();
        this._updateBox();
      };
      g._updateBox = function () {
        this._box_generator &&
          (this._needsNewBoxCache() && this._buildBoxCache(),
          this.state != this._previous.state || this._box != this._box_cache[this.state]) &&
          (this._box && this.removeChild(this._box),
          (this._box = this._box_cache[this.state]),
          this.addChildAt(this._box, 0),
          (this._previous.state = this.state));
      };
      g._updateSubstitution = function () {
        "FOCUSED" === this.state
          ? ((this._dom_visible = !0), (this._surrogate.visible = 0 === this.text.length))
          : ((this._dom_visible = !1), (this._surrogate.visible = !0));
        this._updateDOMInput();
        this._updateSurrogate();
      };
      g._updateDOMInput = function () {
        this._canvas_bounds &&
          ((this._dom_input.style.top = (this._canvas_bounds.top || 0) + "px"),
          (this._dom_input.style.left = (this._canvas_bounds.left || 0) + "px"),
          (this._dom_input.style.transform = this._pixiMatrixToCSS(
            this._getDOMRelativeWorldTransform()
          )),
          (this._dom_input.style.opacity = this.worldAlpha),
          this._setDOMInputVisible(this.worldVisible && this._dom_visible),
          (this._previous.canvas_bounds = this._canvas_bounds),
          (this._previous.world_transform = this.worldTransform.clone()),
          (this._previous.world_alpha = this.worldAlpha),
          (this._previous.world_visible = this.worldVisible));
      };
      g._applyRestriction = function () {
        this._restrict_regex.test(this.text)
          ? (this._restrict_value = this.text)
          : ((this.text = this._restrict_value),
            this._dom_input.setSelectionRange(this._selection[0], this._selection[1]));
      };
      g._needsUpdate = function () {
        return (
          !this._comparePixiMatrices(this.worldTransform, this._previous.world_transform) ||
          !this._compareClientRects(this._canvas_bounds, this._previous.canvas_bounds) ||
          this.worldAlpha != this._previous.world_alpha ||
          this.worldVisible != this._previous.world_visible
        );
      };
      g._needsNewBoxCache = function () {
        var h = this._getDOMInputBounds();
        return (
          !this._previous.input_bounds ||
          h.width != this._previous.input_bounds.width ||
          h.height != this._previous.input_bounds.height
        );
      };
      g._createSurrogate = function () {
        this._surrogate_hitbox = new c.Graphics();
        this._surrogate_hitbox.alpha = 0;
        this._surrogate_hitbox.interactive = !0;
        this._surrogate_hitbox.cursor = "text";
        this._surrogate_hitbox.on("pointerdown", this._onSurrogateFocus.bind(this));
        this.addChild(this._surrogate_hitbox);
        this._surrogate_mask = new c.Graphics();
        this.addChild(this._surrogate_mask);
        this._surrogate = new c.Text("", {});
        this.addChild(this._surrogate);
        this._surrogate.mask = this._surrogate_mask;
        this._updateFontMetrics();
        this._updateSurrogate();
      };
      g._updateSurrogate = function () {
        var h = this._deriveSurrogatePadding(),
          k = this._getDOMInputBounds();
        this._surrogate.style = this._deriveSurrogateStyle();
        this._surrogate.style.padding = Math.max.apply(Math, h);
        this._surrogate.y = this._multiline ? h[0] : (k.height - this._surrogate.height) / 2;
        this._surrogate.x = h[3];
        this._surrogate.text = this._deriveSurrogateText();
        switch (this._surrogate.style.align) {
          case "left":
            this._surrogate.x = h[3];
            break;
          case "center":
            this._surrogate.x = 0.5 * k.width - 0.5 * this._surrogate.width;
            break;
          case "right":
            this._surrogate.x = k.width - h[1] - this._surrogate.width;
        }
        this._updateSurrogateHitbox(k);
        this._updateSurrogateMask(k, h);
      };
      g._updateSurrogateHitbox = function (h) {
        this._surrogate_hitbox.clear();
        this._surrogate_hitbox.beginFill(0);
        this._surrogate_hitbox.drawRect(0, 0, h.width, h.height);
        this._surrogate_hitbox.endFill();
        this._surrogate_hitbox.interactive = !this._disabled;
      };
      g._updateSurrogateMask = function (h, k) {
        this._surrogate_mask.clear();
        this._surrogate_mask.beginFill(0);
        this._surrogate_mask.drawRect(k[3], 0, h.width - k[3] - k[1], h.height);
        this._surrogate_mask.endFill();
      };
      g._destroySurrogate = function () {
        this._surrogate &&
          (this.removeChild(this._surrogate),
          this.removeChild(this._surrogate_hitbox),
          this._surrogate.destroy(),
          this._surrogate_hitbox.destroy(),
          (this._surrogate_hitbox = this._surrogate = null));
      };
      g._onSurrogateFocus = function () {
        this._setDOMInputVisible(!0);
        setTimeout(this._ensureFocus.bind(this), 10);
      };
      g._ensureFocus = function () {
        this._hasFocus() || this.focus();
      };
      g._deriveSurrogateStyle = function () {
        var h = new c.TextStyle(),
          k;
        for (k in this._input_style)
          switch (k) {
            case "color":
              h.fill = this._input_style.color;
              break;
            case "fontFamily":
            case "fontSize":
            case "fontWeight":
            case "fontVariant":
            case "fontStyle":
              h[k] = this._input_style[k];
              break;
            case "letterSpacing":
              h.letterSpacing = parseFloat(this._input_style.letterSpacing);
              break;
            case "textAlign":
              h.align = this._input_style.textAlign;
          }
        this._multiline &&
          ((h.lineHeight = parseFloat(h.fontSize)),
          (h.wordWrap = !0),
          (h.wordWrapWidth = this._getDOMInputBounds().width));
        0 === this._dom_input.value.length && (h.fill = this._placeholderColor);
        return h;
      };
      g._deriveSurrogatePadding = function () {
        var h = this._input_style.textIndent ? parseFloat(this._input_style.textIndent) : 0;
        if (this._input_style.padding && 0 < this._input_style.padding.length) {
          var k = this._input_style.padding.trim().split(" ");
          if (1 == k.length) {
            var m = parseFloat(k[0]);
            return [m, m, m, m + h];
          }
          if (2 == k.length)
            return (m = parseFloat(k[0])), (k = parseFloat(k[1])), [m, k, m, k + h];
          if (4 == k.length)
            return (
              (m = k.map(function (l) {
                return parseFloat(l);
              })),
              (m[3] += h),
              m
            );
        }
        return [0, 0, 0, h];
      };
      g._deriveSurrogateText = function () {
        return 0 === this._dom_input.value.length ? this._placeholder : this._dom_input.value;
      };
      g._updateFontMetrics = function () {
        var h = this._deriveSurrogateStyle().toFontString();
        this._font_metrics = c.TextMetrics.measureFont(h);
      };
      g._buildBoxCache = function () {
        this._destroyBoxCache();
        var h = ["DEFAULT", "FOCUSED", "DISABLED"],
          k = this._getDOMInputBounds(),
          m;
        for (m in h) this._box_cache[h[m]] = this._box_generator(k.width, k.height, h[m]);
        this._previous.input_bounds = k;
      };
      g._destroyBoxCache = function () {
        this._box && (this.removeChild(this._box), (this._box = null));
        for (var h in this._box_cache)
          this._box_cache[h].destroy(), (this._box_cache[h] = null), delete this._box_cache[h];
      };
      g._hasFocus = function () {
        return document.activeElement === this._dom_input;
      };
      g._setDOMInputVisible = function (h) {
        this._dom_input.style.display = h ? "block" : "none";
      };
      g._getCanvasBounds = function () {
        var h = this._last_renderer.view.getBoundingClientRect();
        h = { top: h.top, left: h.left, width: h.width, height: h.height };
        h.left += window.scrollX;
        h.top += window.scrollY;
        return h;
      };
      g._getDOMInputBounds = function () {
        var h = !1;
        this._dom_added || (document.body.appendChild(this._dom_input), (h = !0));
        var k = this._dom_input.style.transform,
          m = this._dom_input.style.display;
        this._dom_input.style.transform = "";
        this._dom_input.style.display = "block";
        var l = this._dom_input.getBoundingClientRect();
        this._dom_input.style.transform = k;
        this._dom_input.style.display = m;
        h && document.body.removeChild(this._dom_input);
        return l;
      };
      g._getDOMRelativeWorldTransform = function () {
        var h = this._last_renderer.view.getBoundingClientRect(),
          k = this.worldTransform.clone();
        k.scale(this._resolution, this._resolution);
        k.scale(h.width / this._last_renderer.width, h.height / this._last_renderer.height);
        return k;
      };
      g._pixiMatrixToCSS = function (h) {
        return "matrix(" + [h.a, h.b, h.c, h.d, h.tx, h.ty].join() + ")";
      };
      g._comparePixiMatrices = function (h, k) {
        return h && k
          ? h.a == k.a && h.b == k.b && h.c == k.c && h.d == k.d && h.tx == k.tx && h.ty == k.ty
          : !1;
      };
      g._compareClientRects = function (h, k) {
        return h && k
          ? h.left == k.left && h.top == k.top && h.width == k.width && h.height == k.height
          : !1;
      };
      _createClass(f, [
        {
          key: "substituteText",
          get: function () {
            return this._substituted;
          },
          set: function (h) {
            this._substituted != h &&
              ((this._substituted = h)
                ? (this._createSurrogate(), (this._dom_visible = !1))
                : (this._destroySurrogate(), (this._dom_visible = !0)),
              (this.placeholder = this._placeholder),
              this._update());
          },
        },
        {
          key: "placeholder",
          get: function () {
            return this._placeholder;
          },
          set: function (h) {
            this._placeholder = h;
            this._substituted
              ? (this._updateSurrogate(), (this._dom_input.placeholder = ""))
              : (this._dom_input.placeholder = h);
          },
        },
        {
          key: "disabled",
          get: function () {
            return this._disabled;
          },
          set: function (h) {
            this._disabled = h;
            this._dom_input.disabled = h;
            this._setState(h ? "DISABLED" : "DEFAULT");
          },
        },
        {
          key: "maxLength",
          get: function () {
            return this._max_length;
          },
          set: function (h) {
            this._max_length = h;
            this._dom_input.setAttribute("maxlength", h);
          },
        },
        {
          key: "restrict",
          get: function () {
            return this._restrict_regex;
          },
          set: function (h) {
            _instanceof(h, RegExp)
              ? ((h = h.toString().slice(1, -1)),
                "^" !== h.charAt(0) && (h = "^" + h),
                "$" !== h.charAt(h.length - 1) && (h += "$"),
                (h = new RegExp(h)))
              : (h = new RegExp("^[" + h + "]*$"));
            this._restrict_regex = h;
          },
        },
        {
          key: "text",
          get: function () {
            return this._dom_input.value;
          },
          set: function (h) {
            this._dom_input.value = h;
            this._substituted && this._updateSurrogate();
          },
        },
        {
          key: "htmlInput",
          get: function () {
            return this._dom_input;
          },
        },
      ]);
      return f;
    })(c.Container);
  a.exportTo[0][a.exportTo[1]] = d;
})({ PIXI, exportTo: [PIXI, "TextInput"] });
var menu = {};
class Menu extends PIXI.Container {
  constructor() {
    super();
    this.container = new PIXI.Container();
    this.active = !0;
    this.updating = this.guestMode = !1;
    this.backgroundImage = new PIXI.Graphics();
    this.backgroundImage.y = 40;
    this.backgroundImage.lineStyle(1, 16777215, 0.1, 0);
    this.backgroundImage.beginFill(3355443, 0.9);
    this.backgroundImage.drawRect(0, 0, 660, 524, 10);
    this.backgroundImage.endFill();
    this.backgroundImage.interactive = !0;
    this.container.addChild(this.backgroundImage);
    this.backgroundGraphics = new PIXI.Graphics();
    this.backgroundGraphics.lineStyle(1, 16777215, 0.1, 0);
    this.backgroundGraphics.beginFill(0, 0.3);
    this.backgroundGraphics.drawRect(-8, 0, 408, 292, 10);
    this.backgroundGraphics.endFill();
    this.backgroundGraphics.beginFill(0, 0.05);
    this.backgroundGraphics.lineStyle(3, 16777215, 0.05, 0);
    this.backgroundGraphics.drawRect(-8, 0, 408, 74, 10);
    this.backgroundGraphics.endFill();
    this.backgroundGraphics.beginFill(16777215, 0.02);
    this.backgroundGraphics.lineStyle(1, 16777215, 0.05, 0);
    this.backgroundGraphics.drawRect(-7, 82, 406, 40, 10);
    this.backgroundGraphics.endFill();
    this.backgroundGraphics.beginFill(16777215, 0.02);
    this.backgroundGraphics.lineStyle(1, 16777215, 0.05, 0);
    this.backgroundGraphics.drawRect(-7, 122, 406, 40, 10);
    this.backgroundGraphics.endFill();
    this.container.addChild(this.backgroundGraphics);
    this.backgroundGraphics.y = 48;
    this.settingsBackgroundGraphics = new PIXI.Graphics();
    this.settingsBackgroundGraphics.lineStyle(1, 16777215, 0.1, 0);
    this.settingsBackgroundGraphics.beginFill(0, 0.3);
    this.settingsBackgroundGraphics.drawRect(0, 0, 220, 290, 10);
    this.settingsBackgroundGraphics.endFill();
    this.container.addChild(this.settingsBackgroundGraphics);
    this.settingsBackgroundGraphics.y = 48;
    this.settingsPanel = new SettingsPanel(660, 524);
    this.settingsPanel.y = 40;
    this.backgroundNewsGraphics = new PIXI.Graphics();
    this.backgroundNewsGraphics.lineStyle(1, 16777215, 0.1, 0);
    this.backgroundNewsGraphics.beginFill(0, 0.3);
    this.backgroundNewsGraphics.drawRect(-8, 0, 640, 204, 10);
    this.backgroundNewsGraphics.endFill();
    this.container.addChild(this.backgroundNewsGraphics);
    this.backgroundNewsGraphics.x = 0.5 * App.ClientWidth - 290;
    this.backgroundNewsGraphics.y = 350;
    this.snowman = new PIXI.Sprite(App.CombinedTextures.ship);
    this.snowman.y = 375;
    this.snowman.interactive = !0;
    this.container.addChild(this.snowman);
    this.snowman.tint = 11184810;
    this.snowman.scale.x = this.snowman.scale.y = 0.7;
    this.poseImage = new PIXI.Sprite(App.CombinedTextures.pose);
    this.poseImage.y = 350;
    this.poseImage.anchor.x = 0.5;
    this.poseImage.scale.x = this.poseImage.scale.y = 0.775;
    this.poseImage.alpha = 0.7;
    this.container.addChild(this.poseImage);
    this.newsIcon = new PIXI.Sprite(App.CombinedTextures.menu_icon_news);
    this.newsIcon.y = 520;
    this.newsIcon.interactive = !0;
    this.container.addChild(this.newsIcon);
    this.newsIcon.tint = 11184810;
    this.newsIcon.scale.x = this.newsIcon.scale.y = 0.5;
    this.newsText = new PIXI.Text("News", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 3,
      align: "left",
    });
    this.newsText.tint = 11184810;
    this.newsText.resolution = 1.5 * App.DevicePixelRatio;
    this.newsText.y = this.newsIcon.y + 4;
    this.newsText.interactive = !0;
    this.container.addChild(this.newsText);
    this.versionText = new PIXI.Text("v" + App.ClientVersion, {
      fontSize: 12,
      fontFamily: "Arial",
      fill: 8947848,
      lineJoin: "round",
      strokeThickness: 2,
      align: "left",
    });
    this.versionText.y = 514;
    this.versionText.anchor.x = 1;
    this.versionText.resolution = 1.5 * App.DevicePixelRatio;
    this.container.addChild(this.versionText);
    this.newsDescription = new PIXI.Text("", {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 11184810,
      lineJoin: "round",
      strokeThickness: 2,
      align: "left",
    });
    this.newsDescription.y = 493;
    this.newsDescription.resolution = 1.5 * App.DevicePixelRatio;
    this.newsDescription.interactive = !0;
    this.newsIcon.on("mousedown", () => {
      this.emit(Menu.NEWS_ACCESS);
    });
    this.newsText.on("mousedown", () => {
      this.emit(Menu.NEWS_ACCESS);
    });
    this.newsText.on("mouseover", () => {
      this.newsIcon.tint = 16777215;
      this.newsText.tint = 16777215;
    });
    this.newsText.on("mouseout", () => {
      this.newsIcon.tint = 11184810;
      this.newsText.tint = 11184810;
    });
    this.newsIcon.on("mouseover", () => {
      this.newsIcon.tint = 16777215;
      this.newsText.tint = 16777215;
    });
    this.newsIcon.on("mouseout", () => {
      this.newsIcon.tint = 11184810;
      this.newsText.tint = 11184810;
    });
    this.newsDescription.tint = 11184810;
    this.newsDescription.on("mouseover", () => {
      this.newsIcon.tint = 16777215;
      this.newsDescription.tint = 16777215;
    });
    this.newsDescription.on("mouseout", () => {
      this.newsIcon.tint = 11184810;
      this.newsDescription.tint = 11184810;
    });
    this.newsDescription.on("mousedown", () => {
      this.emit(Menu.NEWS_ACCESS);
    });
    this.icon = new PIXI.Sprite(App.CombinedTextures.gamelogo);
    this.icon.y = 46;
    this.icon.scale.x = this.icon.scale.y = 1;
    this.container.addChild(this.icon);
    this.contactInfo = new PIXI.Text("Contact: dev@ninja.io", {
      fontSize: 15,
      fontFamily: "Arial",
      fill: 13421772,
      lineJoin: "round",
      strokeThickness: 4,
      align: "left",
    });
    this.contactInfo.resolution = 1.5 * App.DevicePixelRatio;
    this.contactInfo.anchor.x = 1;
    this.contactInfo.y = 531;
    this.contactInfo.interactive = !0;
    App.WhiteLabel !== App.WhiteLabel_POKI &&
      (this.contactInfo.on("mousedown", () => (location.href = "mailto:dev@ninja.io")),
      this.contactInfo.on("touchstart", () => (location.href = "mailto:dev@ninja.io")),
      this.contactInfo.on(
        "mouseover",
        () => (this.contactInfo.scale.x = this.contactInfo.scale.y = 1.1)
      ),
      this.contactInfo.on(
        "mouseout",
        () => (this.contactInfo.scale.x = this.contactInfo.scale.y = 1)
      ));
    this.contactInfo.alpha = 0.8;
    this.container.addChild(this.contactInfo);
    this.gameStatsTitle = new PIXI.Text("Status", {
      fontSize: 15,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 2,
      align: "right",
    });
    this.gameStatsTitle.resolution = 1.5 * App.DevicePixelRatio;
    this.gameStatsTitle.y = 60;
    this.gameStatsTitle.anchor.x = 1;
    this.container.addChild(this.gameStatsTitle);
    this.gameStats = new PIXI.Text("", {
      fontSize: 13,
      fontFamily: "Arial",
      fill: 13421772,
      lineJoin: "round",
      strokeThickness: 2,
      align: "right",
    });
    this.gameStats.resolution = 1.5 * App.DevicePixelRatio;
    this.gameStats.y = 78;
    this.gameStats.anchor.x = 1;
    this.container.addChild(this.gameStats);
    this.newsFlash = new PIXI.Text("Initializing...", {
      fontSize: 14,
      fontFamily: "Arial",
      fill: 16777215,
      lineJoin: "round",
      strokeThickness: 3,
      align: "left",
    });
    this.newsFlash.y = 12;
    this.newsFlash.resolution = 1.5 * App.DevicePixelRatio;
    this.newsFlash.anchor.x = 0.5;
    this.container.addChild(this.newsFlash);
    this.registerHintTitle = new PIXI.Text("Register to customize", {
      fontName: "Arial",
      fontSize: 17,
      lineHeight: 16,
      fill: 16755200,
      strokeThickness: 3,
      lineJoin: "round",
    });
    this.registerHintTitle.y = 230;
    this.registerHintTitle.resolution = 1.5 * App.DevicePixelRatio;
    this.registerHintTitle.visible = !1;
    this.visualizer = new Visualizer(200, 200, !0, !0, !1);
    this.visualizer.y = 56;
    this.visualizer.interactive = !0;
    this.visualizer.on("mousedown", () => {
      this.guestMode ||
        (this.emit(Menu.CUSTOMIZATION_ACCESS), AudioEffects.ButtonClick.audio.play());
    });
    this.visualizer.on("touchstart", () => {
      this.guestMode ||
        (this.emit(Menu.CUSTOMIZATION_ACCESS), AudioEffects.ButtonClick.audio.play());
    });
    this.visualizer.on("mouseover", () => {
      this.registerHintTitle.visible = !0;
      AudioEffects.ButtonHover.audio.play();
    });
    this.visualizer.on("mouseout", () => (this.registerHintTitle.visible = !1));
    this.container.addChild(this.visualizer);
    this.modeTitle = new PIXI.BitmapText("", {
      fontName: "Open Sans",
      fontSize: 22,
      align: "left",
    });
    this.modeTitle.y = 106;
    this.modeTitle.tint = 16755200;
    this.container.addChild(this.modeTitle);
    this.modeTitle.visible = !1;
    this.rewardButton = new PIXI.Sprite(App.CombinedTextures.claim_reward);
    this.rewardButton.y = 210;
    this.rewardButton.interactive = !0;
    this.rewardButton.hitArea = new PIXI.Rectangle(
      -5,
      -5,
      this.rewardButton.width + 10,
      this.rewardButton.height + 13
    );
    this.container.addChild(this.rewardButton);
    this.treasureIcon = new PIXI.Sprite(App.CombinedTextures.treasure);
    this.treasureIcon.y = 200;
    this.treasureIcon.interactive = !1;
    this.container.addChild(this.treasureIcon);
    this.rewardButton.on("mouseover", () => {
      this.rewardButton.scale.x = this.rewardButton.scale.y = 1.04;
      this.treasureIcon.scale.x = this.treasureIcon.scale.y = 1.04;
    });
    this.rewardButton.on("mouseout", () => {
      this.rewardButton.scale.x = this.rewardButton.scale.y = 1;
      this.treasureIcon.scale.x = this.treasureIcon.scale.y = 1;
    });
    this.rewardButton.on("mousedown", () => {
      this.emit(Menu.REWARDS_ACCESS);
    });
    this.rewardButton.on("touchstart", () => {
      this.emit(Menu.REWARDS_ACCESS);
    });
    this.serverListButton = new Button(
      "list",
      App.CombinedTextures.gamelist,
      App.CombinedTextures.gamelist_hover
    );
    this.serverListButton.y = 280;
    this.serverListButton.selected = !0;
    this.serverListButton.setText("");
    this.serverListButton.setTint(16763904);
    this.serverListButton.scale.x = this.serverListButton.scale.y = 1;
    this.serverListButton.addListener(
      Button.BUTTON_RELEASED,
      this.onServerListButtonReleased.bind(this)
    );
    this.container.addChild(this.serverListButton);
    this.serverCreateButton = new Button(
      "create",
      App.CombinedTextures.creategame,
      App.CombinedTextures.creategame_hover
    );
    this.serverCreateButton.y = 280;
    this.serverCreateButton.selected = !0;
    this.serverCreateButton.setText("");
    this.serverCreateButton.disable();
    this.serverCreateButton.setTint(16763904);
    this.serverCreateButton.scale.x = this.serverCreateButton.scale.y = 1;
    this.serverCreateButton.addListener(
      Button.BUTTON_RELEASED,
      this.onServerCreateButtonReleased.bind(this)
    );
    this.container.addChild(this.serverCreateButton);
    this.regionData = new PIXI.Text("Loading..", {
      fontSize: 15,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 2,
      align: "left",
    });
    this.regionData.resolution = 1.5 * App.DevicePixelRatio;
    this.regionData.pivot.x = 0.5 * this.regionData.width;
    this.regionData.y = 142;
    this.container.addChild(this.regionData);
    this.modeData = new PIXI.Text("Loading..", {
      fontSize: 15,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 2,
      align: "left",
    });
    this.modeData.resolution = 1.5 * App.DevicePixelRatio;
    this.modeData.pivot.x = 0.5 * this.modeData.width;
    this.modeData.y = 182;
    this.container.addChild(this.modeData);
    this.interactive = !0;
    this.nameTitle = new PIXI.Text("", {
      fontSize: 18,
      fontFamily: "Arial",
      fill: 16763904,
      lineJoin: "round",
      strokeThickness: 3,
      align: "center",
    });
    this.nameTitle.anchor.x = 0.5;
    this.nameTitle.resolution = 2;
    this.nameTitle.y = 264;
    this.container.addChild(this.nameTitle);
    this.levelIcon = new PIXI.Sprite();
    this.levelIcon.y = 48;
    this.levelIcon.scale.x = this.levelIcon.scale.y = 0.8;
    this.container.addChild(this.levelIcon);
    this.levelText = new PIXI.Text("", {
      fontSize: 20,
      fontFamily: "Arial",
      fill: 13421772,
      lineJoin: "round",
      strokeThickness: 3,
      align: "center",
    });
    this.levelText.y = this.levelIcon.y + 23;
    this.levelText.anchor.x = 0.5;
    this.levelText.resolution = 1.5 * App.DevicePixelRatio;
    this.container.addChild(this.levelText);
    this.nameField = new InputField("guest_name", !1, 32, !1);
    this.nameField.setDimensions(210, 35);
    this.nameField.forceLowerCase = !1;
    this.nameField.setMaxChars(18);
    this.nameField.hideBorders();
    this.nameField.y = 294;
    this.nameField.centerInput = !0;
    this.nameField.on(InputField.FOCUS, (a) => this.onNamefieldFocus(a));
    this.nameField.setFilter(
      "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-().[]"
    );
    this.skillText = new PIXI.Text("", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 13421772,
      lineJoin: "round",
      strokeThickness: 3,
      align: "center",
    });
    this.skillText.resolution = 1.5 * App.DevicePixelRatio;
    this.skillText.y = 290;
    this.skillText.anchor.x = 0.5;
    this.container.addChild(this.skillText);
    this.clanText = new PIXI.Text("", {
      fontSize: 16,
      fontFamily: "Arial",
      fill: 16755200,
      lineJoin: "round",
      strokeThickness: 3,
      align: "center",
    });
    this.clanText.resolution = 1.5 * App.DevicePixelRatio;
    this.clanText.y = 310;
    this.clanText.anchor.x = 0.5;
    this.container.addChild(this.clanText);
    this.joinButton = new Button(
      "join",
      App.CombinedTextures.playbutton,
      App.CombinedTextures.playbutton_hover,
      1e3
    );
    this.joinButton.y = 216;
    this.joinButton.selected = !0;
    this.joinButton.setText("");
    this.container.addChild(this.joinButton);
    this.joinButton.scale.x = this.joinButton.scale.y = 1;
    this.joinButton.addListener(Button.BUTTON_RELEASED, this.onJoinButtonReleased.bind(this));
    this.joinButton.setTint(16763904);
    this.joinButton.disable();
    this.modeContainer = new PIXI.Container();
    this.modeContainer.y = 116;
    this.container.addChild(this.modeContainer);
    this.serverContainer = new PIXI.Container();
    this.serverContainer.y = 80;
    this.container.addChild(this.serverContainer);
    this.serverList = new Dropdown("serverSelect", "Region", 186, 256);
    this.modeList = new Dropdown("modeSelect", "Mode", 186, 220);
    this.playerIsReady = !1;
    this.setMode(Menu.MODE_MAIN);
    this.addChild(this.container);
    this.particleContainer = new ParticleContainer();
    this.container.addChild(this.particleContainer);
    this.resize();
  }
  showSettings() {
    this.container.addChild(this.settingsPanel);
    this.settingsPanel.show();
  }
  hideSettings() {
    this.settingsPanel.parent && this.container.removeChild(this.settingsPanel);
  }
  setServerHeadline(a) {
    this.newsDescription.text !== a.description && (this.newsDescription.text = a.description);
  }
  setServerStatus(a) {
    a.message !== this.newsFlash.text && (this.newsFlash.text = a.message);
    (this.updating = a.updating) && 360 !== parseInt(App.Credential.playerid)
      ? (this.serverCreateButton.disable(), (this.newsFlash.tint = 16711680))
      : ((this.newsFlash.tint = 16777215), this.guestMode || this.serverCreateButton.enable());
  }
  setServerData(a) {
    null === this.joinButton.clickTimeout && this.joinButton.enable();
    this.serverList.clear();
    let b = 0,
      c = 0,
      d = a.length;
    for (var e = 0; e < d; e++) {
      let f = a[e];
      b += parseInt(f.games);
      c += parseInt(f.players);
      this.serverList.addItem(f.title, f.id, f.players + " players");
      ((null !== App.SelectedServer && f.uid === App.SelectedServer.uid) ||
        null === App.SelectedServer) &&
        this.serverList.setValue(f.id);
    }
    this.gameStats.text = b + " games in progress\n" + c + " players online";
    0 < d && this.setLobbyDataText();
    this.serverList.draw();
  }
  setLobbyDataText() {
    if (null === App.SelectedServer)
      (this.regionData.text = "Loading..."), (this.modeData.text = "Loading...");
    else {
      var a = App.SelectedServer.modes[App.SelectedMode];
      this.regionData.text =
        (void 0 !== App.SelectedServer ? App.SelectedServer.players : "0") + " players";
      this.modeData.text = (void 0 !== a ? a.toString() : "0") + " players";
    }
  }
  selectServer(a) {
    this.serverList.setValue(a);
  }
  onServerListButtonReleased() {
    this.emit(Menu.SERVER_LISTING_ACCESS);
  }
  onServerCreateButtonReleased() {
    this.emit(Menu.SERVER_CREATION_ACCESS);
  }
  setPlayerData(a) {
    var b = App.Autogen && null !== App.Credential.id;
    a.guest
      ? ((this.guestMode = !0),
        (this.levelIcon.visible = !1),
        (this.levelText.visible = !1),
        (this.skillText.visible = !1),
        (this.clanText.visible = !1),
        (this.nameTitle.text = "Playing as guest"),
        (this.nameTitle.scale.x = this.nameTitle.scale.y = 1),
        (this.nameTitle.y = 264),
        this.nameField.parent || this.container.addChild(this.nameField),
        this.nameField.setText(a.name),
        this.registerHintTitle.parent || this.container.addChild(this.registerHintTitle),
        this.serverCreateButton.disable())
      : ((this.guestMode = !1),
        (this.levelIcon.visible = !0),
        (this.levelText.visible = !0),
        b
          ? ((this.clanText.visible = !1),
            (this.skillText.visible = !1),
            (this.nameTitle.text = "Playing as"),
            (this.nameTitle.scale.x = this.nameTitle.scale.y = 1),
            (this.nameTitle.y = 264),
            this.nameField.parent || this.container.addChild(this.nameField),
            this.nameField.setText(a.name))
          : ((this.skillText.visible = !0),
            (this.clanText.visible = !0),
            this.nameField.parent && this.container.removeChild(this.nameField),
            (this.nameTitle.text = a.name),
            (this.nameTitle.scale.x = this.nameTitle.scale.y = 1.3),
            (this.nameTitle.y = 260)),
        this.registerHintTitle.parent && this.container.removeChild(this.registerHintTitle),
        (this.updating && 360 !== parseInt(App.Credential.playerid)) ||
          this.serverCreateButton.enable(),
        (App.Credential && void 0 !== App.Credential.level) ||
          console.error("credential is invalid: ", App.Credential),
        (this.levelIcon.texture =
          App.CombinedTextures[
            "skill_icon_" + Math.max(Math.floor((App.Credential.level / 160) * 10) + 1)
          ]),
        (this.levelText.text = App.Credential.level.toString()),
        (b = Game.MapSkillToTitle(App.Credential.skill)),
        (this.skillText.text = b + ", level " + App.Credential.level),
        (this.clanText.text =
          -1 !== App.Credential.clan_id && null !== App.Credential.clan_id
            ? "Clan " + App.Credential.clan_role + " of " + App.Credential.clan_name
            : "Freelancer"));
    this.visualizer.applyCustomization(a.customization);
  }
  init() {
    this.modeList.addItem(
      Game.MODE_TITLES[Game.MODE_DM],
      Game.MODE_DM,
      "",
      App.CombinedTextures.dm_icon_notxt
    );
    this.modeList.addItem(
      Game.MODE_TITLES[Game.MODE_TDM],
      Game.MODE_TDM,
      "",
      App.CombinedTextures.tdm_icon_notxt
    );
    this.modeList.addItem(
      Game.MODE_TITLES[Game.MODE_CTF],
      Game.MODE_CTF,
      "",
      App.CombinedTextures.ctf_icon_notxt
    );
    this.modeList.addItem(
      Game.MODE_TITLES[Game.MODE_DB],
      Game.MODE_DB,
      "",
      App.CombinedTextures.db_icon_notxt
    );
    this.modeList.addListener(Button.BUTTON_RELEASED, this.onModeButtonReleased.bind(this));
    this.modeList.draw();
    this.modeList.setValue(App.SelectedMode);
    this.modeContainer.addChild(this.modeList);
    this.modeContainer.x = 0.5 * App.ClientWidth - 224;
    this.modeList.x = -90;
    this.modeList.y = 65;
    this.serverContainer.addChild(this.serverList);
    this.serverList.addListener(Button.BUTTON_RELEASED, this.onServerButtonReleased.bind(this));
    this.serverList.draw();
    this.serverList.x = -90;
    this.serverList.y = 60;
    this.serverContainer.x = 0.5 * App.ClientWidth - 224;
    this.checkRewards();
  }
  showRewardButton() {
    this.rewardButton.visible = !0;
    this.treasureIcon.visible = !0;
  }
  hideRewardButton() {
    this.rewardButton.visible = !1;
    this.treasureIcon.visible = !1;
  }
  async checkRewards(a = !1) {
    App.HadRewards || this.hideRewardButton();
    "guest" === App.Credential.accounttype
      ? this.hideRewardButton()
      : (!a && 6e4 > Date.now() - App.LastRewardCheck) ||
        ((a = await APIClient.getRewardsAvailable(App.Credential.id)),
        (App.LastRewardCheck = Date.now()),
        (App.HadRewards = !1),
        a &&
          a.available &&
          0 < parseInt(a.available, 10) &&
          (this.showRewardButton(), (App.HadRewards = !0)));
  }
  setMode(a, b) {
    if (void 0 === b || !1 !== b.success)
      (this.mode = a),
        (this.serverList.visible = !0),
        (this.regionData.visible = !0),
        (this.modeData.visible = !0),
        (this.joinButton.visible = !0),
        (this.modeContainer.visible = !0),
        (this.serverContainer.visible = !0),
        (this.modeTitle.visible = !1);
  }
  onJoinButtonReleased() {
    this.emit(Menu.JOIN_GAME_MODE, App.SelectedMode);
  }
  onMainMenuButtonReleased() {
    this.setMode(Menu.MODE_MAIN);
  }
  onModeButtonReleased(a) {
    App.SelectedMode = a.data.value;
    this.setLobbyDataText();
  }
  onServerButtonReleased(a) {
    a = a.data.value;
    let b = { modes: {} };
    for (let c = 0; c < App.Servers.length; c++)
      if (App.Servers[c].id === a) {
        b = App.Servers[c];
        break;
      }
    this.emit(Menu.JOIN_SERVER, b, this.setLobbyDataText.bind(this));
  }
  resize() {
    this.nameTitle.x = 0.5 * App.ClientWidth + 208;
    this.nameField.x = 0.5 * App.ClientWidth + 100;
    this.skillText.x = 0.5 * App.ClientWidth + 208;
    this.clanText.x = 0.5 * App.ClientWidth + 208;
    this.levelIcon.x = 0.5 * App.ClientWidth + 106;
    this.levelText.x = this.levelIcon.x + 31;
    this.regionData.x = 0.5 * App.ClientWidth - 14;
    this.modeData.x = 0.5 * App.ClientWidth - 14;
    this.modeContainer.x = 0.5 * App.ClientWidth - 224;
    this.serverContainer.x = 0.5 * App.ClientWidth - 224;
    this.icon.x = 0.5 * App.ClientWidth - 316;
    this.gameStats.x = 0.5 * App.ClientWidth + 78;
    this.gameStatsTitle.x = this.gameStats.x;
    this.newsFlash.x = 0.5 * App.ClientWidth;
    this.joinButton.x = this.modeContainer.x - 20;
    this.modeTitle.x = 0.5 * App.ClientWidth - 302;
    this.backgroundGraphics.x = 0.5 * App.ClientWidth - 312;
    this.backgroundNewsGraphics.x = 0.5 * App.ClientWidth - 312;
    this.settingsBackgroundGraphics.x = 0.5 * App.ClientWidth + 100;
    this.contactInfo.x = 0.5 * App.ClientWidth + 314;
    this.poseImage.x = 0.5 * App.ClientWidth;
    this.snowman.x = 0.5 * App.ClientWidth - 320;
    this.newsIcon.x = 0.5 * App.ClientWidth - 318;
    this.newsText.x = this.newsIcon.x + this.newsIcon.width;
    this.newsDescription.x = 0.5 * App.ClientWidth - 250;
    this.versionText.x = 0.5 * App.ClientWidth + 313;
    this.serverListButton.x = 0.5 * App.ClientWidth - 243;
    this.serverCreateButton.x = this.serverListButton.x + this.serverListButton.width + 3;
    this.visualizer.x = 0.5 * App.ClientWidth + 110;
    this.rewardButton.x = this.visualizer.x + 24;
    this.treasureIcon.x = this.visualizer.x + 8;
    this.registerHintTitle.x =
      this.visualizer.x + 0.5 * (this.visualizer.width - this.registerHintTitle.width);
    1e3 <= App.ClientWidth
      ? ((App.Console.scale.x = 0.8), (App.Console.scale.y = 0.8))
      : 1e3 > App.ClientWidth && ((App.Console.scale.x = 0.74), (App.Console.scale.y = 0.74));
    this.backgroundImage.x = 0.5 * App.ClientWidth - 0.5 * this.backgroundImage.width;
    this.settingsPanel.x = 0.5 * App.ClientWidth - 330;
  }
  hideItems() {
    this.removeChild(this.container);
  }
  showItems() {
    this.addChild(this.container);
  }
  onNamefieldFocus(a) {
    a && App.Autogen && null !== App.Credential.id
      ? (this.nameField.setFocus(!1), this.emit(Menu.RENAME_ACCESS))
      : a ||
        ((a = this.nameField.getText()),
        4 > a.length && this.nameField.setText("Ninja" + Math.floor(1e3 * Math.random())),
        this.nameField.previousText !== a &&
          this.emit(Menu.GUEST_NAME_CHANGE, this.nameField.getText()));
  }
  step() {
    if (this.treasureIcon.visible) {
      var a = ParticleEffects.GoldGlitter;
      a.x = this.treasureIcon.x + 0.5 * this.treasureIcon.width;
      a.y = this.treasureIcon.y + 0.5 * this.treasureIcon.height;
      a.vx = -0.5 + 1 * Math.random();
      a.vy = -0.5 + 1 * Math.random();
      a.vr = -0.3 + 0.6 * Math.random();
      a.a = 1;
      this.particleContainer.spawn(a);
    }
    0.6 > Math.random() &&
      ((a = ParticleEffects.SnowFlake),
      (a.x = 12 + (this.snowman.x - 10) + 630 * Math.random()),
      (a.y = 354),
      (a.vx = -0.01 + 0.02 * Math.random()),
      (a.vy = 0.5 + 0.1 * Math.random()),
      (a.alpha = 0.5 + 0.5 * Math.random()),
      (a.s = 0.05 + 0.05 * Math.random()),
      (a.vr = -0.02 + 0.04 * Math.random()),
      this.particleContainer.spawn(a));
    this.visualizer.update();
    this.particleContainer.update();
  }
}
Menu.JOIN_GAME_MODE = "JoinGameMode";
Menu.JOIN_SERVER = "joinServer";
Menu.MODE_MAIN = "mainMenu";
Menu.GUEST_NAME_CHANGE = "guestNameChange";
Menu.PROFILE_ACCESS = "profileAccess";
Menu.RENAME_ACCESS = "renameAccess";
Menu.CUSTOMIZATION_ACCESS = "customizationAccess";
Menu.SERVER_LISTING_ACCESS = "serverListingAccess";
Menu.SERVER_CREATION_ACCESS = "serverCreationAccess";
Menu.REWARDS_ACCESS = "rewardsAccess";
Menu.NEWS_ACCESS = "newsAccess";
function User() {
  this.name = "anonymous";
  this.skill = 0;
  this.premium = this.admin = !1;
  this.team = 0;
  this.customization = { hair: "original", energy: "#ffffff" };
}
var commandconsole = {};
class CommandConsole extends PIXI.Container {
  constructor() {
    super();
    this.settings = Registry.Instance[Registry.Key.SETTINGS].graphics;
    this.maxLines = void 0 !== this.settings.chatLines ? this.settings.chatLines : 20;
    this.alpha = this.targetAlpha =
      void 0 !== this.settings.chatOpacity ? this.settings.chatOpacity : 1;
    this.interactiveChildren = !1;
    this.messages = [];
    this.lines = [];
    this.interpreters = [];
    this.active = !1;
    this.consoleInput = new InputField("consoleInput", !0);
    this.consoleInput.filterEnabled = !1;
    this.consoleInput.setDimensions(0.8 * App.ClientWidth, 26);
    this.consoleInput.setMaxChars(80);
    this.consoleInput.x = 5;
    this.consoleInput.y = 200;
    this.onConsoleInputFocus(!1);
    this.consoleInput.addListener(InputField.SUBMIT, this.onConsoleInput.bind(this));
    this.addChild(this.consoleInput);
    this.fadeInterval = this.fadeTimeout = null;
    this.setActive(!1);
  }
  log(a, b) {
    this.cancelFade();
    a = new PIXI.BitmapText(a, CommandConsole.FontMessage);
    a.tint = void 0 === b ? 15658734 : b;
    this.messages.length === this.maxLines &&
      0 < this.maxLines &&
      (this.removeChild(this.messages[0]), this.messages.shift());
    this.messages.push(a);
    this.addChild(a);
    this.update();
    this.consoleInput.visible
      ? (this.consoleInput.y =
          0 < this.messages.length ? this.messages[this.messages.length - 1].y + 20 : 200)
      : this.startFade();
    this.active || ((b = this.messages.length), (this.y = 200 < 20 * b ? 200 - 20 * b : 0));
  }
  cancelFade(a = !0) {
    null !== this.fadeTimeout && (clearTimeout(this.fadeTimeout), (this.fadeTimeout = null));
    null !== this.fadeInterval && (clearInterval(this.fadeInterval), (this.fadeInterval = null));
    a && (this.alpha = this.targetAlpha);
  }
  update() {
    var a = this.messages.length;
    let b = 20 * a - 20,
      c = 0;
    for (--a; 0 <= a; a--) {
      let d = this.messages[a];
      d.x = 5;
      d.y = b - 20 * c;
      c++;
    }
  }
  startFade() {
    this.alpha = this.targetAlpha;
    null !== this.fadeTimeout && clearTimeout(this.fadeTimeout);
    this.fadeTimeout = setTimeout(() => this.startInterval(), 3e3);
  }
  startInterval() {
    clearTimeout(this.fadeTimeout);
    this.fadeTimeout = null;
    this.fadeDelay = 0;
    null !== this.fadeInterval && clearInterval(this.fadeInterval);
    this.fadeInterval = setInterval(() => this.step(), 100);
  }
  step() {
    this.fadeDelay--;
    0.21 < this.alpha && (this.alpha -= 0.1);
    -8 >= this.fadeDelay &&
      (clearInterval(this.fadeInterval),
      (this.fadeInterval = null),
      (this.alpha = 0.2 > this.targetAlpha ? this.targetAlpha : 0.2));
  }
  isActive() {
    return this.active;
  }
  setActive(a) {
    let b = this.messages.length;
    a
      ? ((this.consoleInput.visible = !0),
        this.emit(CommandConsole.SHOW),
        this.onConsoleInputFocus(!0),
        (this.y = 0),
        (this.consoleInput.y =
          0 < this.messages.length ? this.messages[this.messages.length - 1].y + 20 : 200),
        this.cancelFade(!1),
        (this.alpha = 1))
      : ((this.consoleInput.visible = !1),
        this.emit(CommandConsole.HIDE),
        this.onConsoleInputFocus(!1),
        (this.y = 200 < 20 * b ? 200 - 20 * b : 0),
        this.startFade());
    this.active = a;
    this.consoleInput.setFocus(a);
  }
  onConsoleInputFocus(a) {}
  onConsoleInput(a) {
    this.consoleInput.setText("");
    for (var b = 0, c = this.interpreters.length; b < c; b++)
      this.interpreters[b].parse(a.data.value);
    this.onConsoleInputFocus(!1);
    this.setActive(!1);
  }
  addInputString(a) {
    this.consoleInput.setText(this.consoleInput.getText() + a);
  }
  reset() {}
  linkInterpreter(a) {
    this.interpreters.push(a);
  }
  unlinkInterpreter(a) {
    for (var b = 0, c = this.interpreters.length; b < c; b++)
      this.interpreters[b] === a && this.interpreters.splice(b, 1);
  }
}
CommandConsole.FontMessage = { fontName: "Open Sans", fontSize: 25 };
CommandConsole.INPUT = "input";
CommandConsole.SHOW = "show";
CommandConsole.HIDE = "hide;";
function DevLog() {
  this.log = function (a) {
    App.Console.log("\t :: " + this.constructor.name + " :: " + a);
  };
}
var orderedcontainer = {};
function OrderedContainer() {
  this._items = {};
  this._order = [];
}
OrderedContainer.Storage = {};
OrderedContainer.prototype = {
  add: function (a, b) {
    return this._items[b]
      ? null
      : ((this._items[b] = { id: b, item: a }), (this._order[this._order.length] = b), a);
  },
  remove: function (a) {
    delete this._items[a];
    this._order.splice(this._order.indexOf(a), 1);
  },
  removeIndex: function (a) {
    delete this._items[this._order[a]];
    this._order.splice(a, 1);
  },
  getLast: function () {
    return 0 < this._order.length ? this._items[this._order[this._order.length - 1]].item : null;
  },
  getIndex: function (a) {
    return void 0 !== this._order[a] ? this._items[this._order[a]].item : null;
  },
  getIdByIndex: function (a) {
    return 0 < this._order.length && void 0 !== this._order[a]
      ? this._items[this._order[a]].id
      : null;
  },
  moveToIndex: function (a, b) {
    var c = this._order[a];
    this._order.splice(a, 1);
    this._order.splice(b, 0, c);
  },
  getIndexById: function (a) {
    for (var b = 0, c = this.getSize(); b < c; b++)
      if (this._items[this._order[b]].id === a) return b;
    return -1;
  },
  swapByIndex: function (a, b) {
    var c = this._order[a];
    this._order[a] = this._order[b];
    this._order[b] = c;
  },
  getById: function (a) {
    return void 0 !== this._items[a] ? this._items[a].item : null;
  },
  setById: function (a, b) {
    void 0 !== this._items[b] ? (this._items[b] = a) : this.add(a, b);
  },
  getSize: function () {
    return this._order.length;
  },
  iterate: function (a) {
    for (
      var b = 0, c = this._order.length;
      b < c && a(this._items[this._order[b]].id, this._items[this._order[b]].item);
      b++
    );
  },
  clear: function () {
    this._items = {};
    this._order = [];
  },
  sortMethod: function (a) {
    this._order.sort((b, c) => this._items[b].item[a]() < this._items[c].item[a]());
  },
  sortMethodMultiple: function () {
    OrderedContainer.Storage.Instance = this;
    OrderedContainer.Storage.Arguments = arguments;
    this._order.sort(this._compareMethodMultiple);
  },
  _compareMethodMultiple: function (a, b) {
    var c = OrderedContainer.Storage.Instance,
      d = OrderedContainer.Storage.Arguments;
    a = c._items[a].item;
    b = c._items[b].item;
    for (c = d.length - 1; 0 < c; ) {
      var e = d[c],
        f = d[c - 1],
        g = a[e]() * f;
      e = b[e]() * f;
      if (g < e) return 1;
      if (g > e) return -1;
      c -= 2;
    }
    return 0;
  },
  sortMember: function (a) {
    this._order.sort((b, c) => this._items[b].item[a] < this._items[c].item[a]);
  },
  sortMemberMultiple: function () {
    OrderedContainer.Storage.Instance = this;
    OrderedContainer.Storage.Arguments = arguments;
    this._order.sort(this._compareMemberMultiple);
  },
  _compareMemberMultiple: function (a, b) {
    var c = OrderedContainer.Storage.Instance,
      d = OrderedContainer.Storage.Arguments;
    a = c._items[a].item;
    b = c._items[b].item;
    for (c = d.length - 1; 0 < c; ) {
      var e = d[c],
        f = d[c - 1],
        g = a[e] * f;
      e = b[e] * f;
      if (g < e) return 1;
      if (g > e) return -1;
      c -= 2;
    }
    return 0;
  },
};
class Interpreter extends PIXI.utils.EventEmitter {
  constructor(a) {
    super();
    this._target = a || null;
    this._commands = {};
    this._default = null;
    this._validate = function (b) {
      var c = !0;
      if (0 === b.length || 2 > b.length) c = !1;
      0 !== b.indexOf("/") && (c = !1);
      "/" === b.trim() && (c = !1);
      return c;
    };
    this._process = function (b) {
      var c = b.slice(1),
        d = c.indexOf(" "),
        e = null;
      -1 !== d ? ((b = c.substr(0, d)), (e = c.substr(d + 1))) : (b = c);
      (c = this._commands[b])
        ? this._target
          ? c.call(this._target, e)
          : c(e)
        : this.emit(Interpreter.INVALID_COMMAND, { value: b });
    };
    this._dispatchDefault = function (b) {
      if (this._default) {
        var c = this._commands[this._default];
        this._target ? c.call(this._target, b) : c(b);
      }
    };
  }
  parse(a) {
    this._validate(a)
      ? ((a = a.trim()), this._process(a))
      : 0 < a.length && this._dispatchDefault(a);
  }
  addCommand(a, b) {
    this._commands[a] = b;
  }
  removeCommand(a) {
    delete this._commands[a];
    a === this._default && (this._default = null);
  }
  setDefaultCommand(a) {
    this._default = a;
  }
}
Interpreter.INVALID_COMMAND = "invalidCommand";
var stats = {};
class Stats extends PIXI.Sprite {
  constructor() {
    super();
    this.textures = [];
    for (var a = 0; 5 > a; a++) this.textures.push(App.CombinedTextures["ping_" + a]);
    this.anchor.x = this.anchor.y = 0.5;
    this.texture = this.textures[0];
  }
  setPing(a) {
    this.texture =
      this.textures[
        0 <= a && 32 > a
          ? 0
          : 32 <= a && 64 > a
          ? 1
          : 64 <= a && 128 > a
          ? 2
          : 128 <= a && 256 > a
          ? 3
          : 4
      ];
  }
}
let app = new App();
app.load();
var customevent = {};
function CustomEvent(a, b) {
  this.type = a;
  this.data = b || null;
}
var timer = {};
function Timer(a, b) {
  this.callback = a;
  this.delay = b;
  this.expired = !1;
  this.timeoutId = null;
  this.remainingTime = this.initialTime = 0;
}
Timer.prototype.start = function () {
  this.expired = !1;
  this.initialTime = Date.now();
  this.remainingTime = this.delay;
  this.timeoutId = setTimeout(this.onExpire.bind(this), this.delay);
  return this;
};
Timer.prototype.resume = function () {
  this.expired
    ? this.start()
    : ((this.initialTime = Date.now()),
      (this.timeoutId = setTimeout(this.onExpire.bind(this), this.remainingTime)));
};
Timer.prototype.pause = function () {
  this.timeoutId &&
    (clearTimeout(this.timeoutId), (this.remainingTime -= Date.now() - this.initialTime));
};
Timer.prototype.onExpire = function () {
  this.expired = !0;
  this.callback();
};
var uidpool = {};
function UIDpool(a, b) {
  this.taken = 0;
  this.uids = [];
  this.buffered = [[], []];
  this.index = 0;
  for (let c = a - 1; 0 < c; c--) {
    let d = c,
      e = "";
    for (; 0 < d; ) (e = UIDpool.CHARSET[d % 62] + e), (d = Math.floor(d / 62));
    this.uids.push(e);
  }
  0 < a && this.uids.push(UIDpool.CHARSET[0]);
  void 0 !== b &&
    setInterval(() => {
      this.index ^= 1;
      let c = this.buffered[this.index];
      for (let d = 0, e = c.length; d < e; d++) this.uids.push(c[d]);
      this.buffered[this.index] = [];
    }, b);
}
UIDpool.CHARSET = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
UIDpool.prototype.get = function () {
  return this.uids.pop();
};
UIDpool.prototype.dropBuffered = function (a) {
  this.buffered[this.index].push(a);
};
UIDpool.prototype.drop = function (a) {
  this.uids.push(a);
};
